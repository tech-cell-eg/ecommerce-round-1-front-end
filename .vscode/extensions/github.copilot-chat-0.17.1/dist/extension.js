"use strict";var mDe=Object.create;var nE=Object.defineProperty;var Wte=Object.getOwnPropertyDescriptor;var hDe=Object.getOwnPropertyNames;var gDe=Object.getPrototypeOf,vDe=Object.prototype.hasOwnProperty;var R=(t,e)=>()=>(t&&(e=t(t=0)),e);var L=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),dn=(t,e)=>{for(var r in e)nE(t,r,{get:e[r],enumerable:!0})},Kte=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of hDe(e))!vDe.call(t,o)&&o!==r&&nE(t,o,{get:()=>e[o],enumerable:!(n=Wte(e,o))||n.enumerable});return t};var W=(t,e,r)=>(r=t!=null?mDe(gDe(t)):{},Kte(e||!t||!t.__esModule?nE(r,"default",{value:t,enumerable:!0}):r,t)),Gi=t=>Kte(nE({},"__esModule",{value:!0}),t),B=(t,e,r,n)=>{for(var o=n>1?void 0:n?Wte(e,r):e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(o=(n?a(e,r,o):a(o))||o);return n&&o&&nE(e,r,o),o},T=(t,e)=>(r,n)=>e(r,n,t);var Tr=L((eut,Jte)=>{"use strict";var E7=Object.defineProperty,yDe=Object.getOwnPropertyDescriptor,bDe=Object.getOwnPropertyNames,_De=Object.prototype.hasOwnProperty,xDe=(t,e)=>{for(var r in e)E7(t,r,{get:e[r],enumerable:!0})},SDe=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of bDe(e))!_De.call(t,o)&&o!==r&&E7(t,o,{get:()=>e[o],enumerable:!(n=yDe(e,o))||n.enumerable});return t},IDe=t=>SDe(E7({},"__esModule",{value:!0}),t),Qte={};xDe(Qte,{config:()=>RDe,t:()=>Xte});Jte.exports=IDe(Qte);var CDe=require("fs"),TDe=require("fs/promises");async function EDe(t){if(t.protocol==="file:")return await(0,TDe.readFile)(t,"utf8");if(t.protocol==="http:"||t.protocol==="https:"){let e=await fetch(t.toString(),{headers:{"Accept-Encoding":"gzip, deflate",Accept:"application/json"},redirect:"follow"});if(!e.ok){let n=`Unexpected ${e.status} response while trying to read ${t}`;try{n+=`: ${await e.text()}`}catch{}throw new Error(n)}return await e.text()}throw new Error("Unsupported protocol")}function wDe(t){return(0,CDe.readFileSync)(t,"utf8")}var iE;function RDe(t){if("contents"in t){typeof t.contents=="string"?iE=JSON.parse(t.contents):iE=t.contents;return}if("fsPath"in t){let e=wDe(t.fsPath),r=JSON.parse(e);iE=Yte(r)?r.contents.bundle:r;return}if(t.uri){let e=t.uri;return typeof t.uri=="string"&&(e=new URL(t.uri)),new Promise((r,n)=>{let o=EDe(e).then(s=>{try{let a=JSON.parse(s);iE=Yte(a)?a.contents.bundle:a}catch(a){n(a)}}).catch(s=>{n(s)});r(o)})}}function Xte(...t){let e=t[0],r,n,o;if(typeof e=="string")r=e,n=e,t.splice(0,1),o=!t||typeof t[0]!="object"?t:t[0];else if(e instanceof Array){let a=t.slice(1);if(e.length!==a.length+1)throw new Error("expected a string as the first argument to l10n.t");let c=e[0];for(let u=1;u<e.length;u++)c+=`{${u-1}}`+e[u];return Xte(c,...a)}else n=e.message,r=n,e.comment&&e.comment.length>0&&(r+=`/${Array.isArray(e.comment)?e.comment.join(""):e.comment}`),o=e.args??{};let s=iE?.[r];return s?typeof s=="string"?BA(s,o):s.comment?BA(s.message,o):BA(n,o):BA(n,o)}var kDe=/{([^}]+)}/g;function BA(t,e){return Object.keys(e).length===0?t:t.replace(kDe,(r,n)=>e[n]??r)}function Yte(t){return typeof t?.contents?.bundle=="object"&&typeof t?.version=="string"}});var pne=L(Vl=>{"use strict";Object.defineProperty(Vl,"__esModule",{value:!0});Vl.bytePairEncode=Vl.BinaryMap=Vl.binaryMapKey=void 0;var XNe=(t,e,r)=>{let n=r-e,o=16777215>>>Math.max(0,(3-n)*8),s=(t[e+0]|t[e+1]<<8|t[e+2]<<16)&o,a=16777215>>>Math.min(31,Math.max(0,(6-n)*8)),c=(t[e+3]|t[e+4]<<8|t[e+5]<<16)&a;return s+16777216*c};Vl.binaryMapKey=XNe;var lU=class t{constructor(){this.nested=new Map,this.final=new Map}get(e,r=0,n=e.length){let o=n<6+r,s=(0,Vl.binaryMapKey)(e,r,n);return o?this.final.get(s):this.nested.get(s)?.get(e,6+r,n)}set(e,r){let n=(0,Vl.binaryMapKey)(e,0,e.length);if(e.length<6){this.final.set(n,r);return}let s=this.nested.get(n);if(s instanceof t)s.set(e.subarray(6),r);else{let a=new t;a.set(e.subarray(6),r),this.nested.set(n,a)}}};Vl.BinaryMap=lU;var Gl=new Int32Array(128),ea=new Int32Array(128);function JNe(t,e,r){if(r===1)return[e.get(t)];let n=2147483647,o=-1;for(;Gl.length<r*2;)ea=new Int32Array(ea.length*2),Gl=new Int32Array(Gl.length*2);for(let u=0;u<r-1;u++){let l=e.get(t,u,u+2)??2147483647;l<n&&(n=l,o=u),ea[u]=u,Gl[u]=l}ea[r-1]=r-1,Gl[r-1]=2147483647,ea[r]=r,Gl[r]=2147483647;let s=r+1;function a(u,l=0){if(u+l+2<s){let d=e.get(t,ea[u],ea[u+l+2]);if(d!==void 0)return d}return 2147483647}for(;n!==2147483647;){Gl[ea[o]]=a(o,1),o>0&&(Gl[ea[o-1]]=a(o-1,1));for(let u=o+1;u<s-1;u++)ea[u]=ea[u+1];s--,o=-1,n=2147483647;for(let u=0;u<s-1;u++){let l=Gl[ea[u]];Gl[ea[u]]<n&&(n=l,o=u)}}let c=[];for(let u=0;u<s-1;u++)c.push(e.get(t,ea[u],ea[u+1]));return c}Vl.bytePairEncode=JNe});var fne=L(qP=>{"use strict";Object.defineProperty(qP,"__esModule",{value:!0});qP.makeTextEncoder=void 0;var dU=class{constructor(){this.length=0,this.encoder=new TextEncoder}encode(e){let r=this.encoder.encode(e);return this.length=r.length,r}},pU=class{constructor(){this.buffer=Buffer.alloc(256),this.length=0}encode(e){for(;;){if(this.length=this.buffer.write(e,"utf8"),this.length<this.buffer.length-4)return this.buffer;this.buffer=Buffer.alloc(this.length*2),this.length=this.buffer.write(e)}}},ZNe=()=>typeof Buffer<"u"?new pU:new dU;qP.makeTextEncoder=ZNe});var mne=L(HP=>{"use strict";Object.defineProperty(HP,"__esModule",{value:!0});HP.LRUCache=void 0;var fU=class{constructor(e){this.size=e,this.nodes=new Map}get(e){let r=this.nodes.get(e);if(r)return this.moveToHead(r),r.value}set(e,r){let n=this.nodes.get(e);if(n)n.value=r,this.moveToHead(n);else{let o=new mU(e,r);this.nodes.set(e,o),this.addNode(o),this.nodes.size>this.size&&(this.nodes.delete(this.tail.key),this.removeNode(this.tail))}}moveToHead(e){this.removeNode(e),this.addNode(e)}addNode(e){this.head&&(this.head.prev=e,e.next=this.head),this.tail||(this.tail=e),this.head=e}removeNode(e){e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev}};HP.LRUCache=fU;var mU=class{constructor(e,r){this.key=e,this.value=r}}});var gU=L(zP=>{"use strict";Object.defineProperty(zP,"__esModule",{value:!0});zP.TikTokenizer=void 0;var eLe=require("fs"),tLe=require("util"),jP=pne(),rLe=fne(),nLe=mne();function iLe(t){let e=new Map;try{let n=eLe.readFileSync(t,"utf-8");return r(n),e}catch(n){throw new Error(`Failed to load from BPE encoder file stream: ${n}`)}function r(n){for(let o of n.split(/[\r\n]+/)){if(o.trim()==="")continue;let s=o.split(" ");if(s.length!==2)throw new Error("Invalid format in the BPE encoder file stream");let a=new Uint8Array(Buffer.from(s[0],"base64")),c=parseInt(s[1]);if(!isNaN(c))e.set(a,c);else throw new Error(`Can't parse ${s[1]} to integer`)}}}function oLe(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var hU=class{constructor(e,r,n,o=8192){this.textEncoder=(0,rLe.makeTextEncoder)(),this.textDecoder=new tLe.TextDecoder("utf-8"),this.cache=new nLe.LRUCache(o);let s=iLe(e);this.init(s,r,n)}init(e,r,n){this.encoder=new jP.BinaryMap;for(let[o,s]of e)this.encoder.set(o,s);this.regex=new RegExp(n,"gu"),this.specialTokensRegex=new RegExp(Array.from(r.keys()).map(o=>oLe(o)).join("|")),this.specialTokensEncoder=r,this.decoder=new Map;for(let[o,s]of e)this.decoder.set(s,o);if(e.size!==this.decoder.size)throw new Error("Encoder and decoder sizes do not match");this.specialTokensDecoder=new Map;for(let[o,s]of r)this.specialTokensDecoder.set(s,o)}findNextSpecialToken(e,r,n){let o=r,s=null;if(n&&this.specialTokensRegex)for(;s=e.slice(o).match(this.specialTokensRegex),!(!s||n&&n.includes(s[0]));)o+=s.index+1;let a=s?o+s.index:e.length;return[s,a]}encode(e,r){let n=[],o=0;for(;;){let s,a;if([s,a]=this.findNextSpecialToken(e,o,r),a>o&&this.encodeByIndex(e,n,o,a),s){if(o=o+this.encodeSpecialToken(n,s),o>=e.length)break}else break}return n}encodeSpecialToken(e,r){let n=this.specialTokensEncoder?.get(r[0]);return e.push(n),r.index+r[0].length}encodeByIndex(e,r,n,o){let s,a=e.substring(n,o);for(this.regex.lastIndex=0;s=this.regex.exec(a);){let c=this.cache.get(s[0]);if(c)for(let u of c)r.push(u);else{let u=this.textEncoder.encode(s[0]),l=this.encoder.get(u,0,this.textEncoder.length);if(l!==void 0)r.push(l),this.cache.set(s[0],[l]);else{let d=(0,jP.bytePairEncode)(u,this.encoder,this.textEncoder.length);for(let p of d)r.push(p);this.cache.set(s[0],d)}}}}encodeTrimSuffixByIndex(e,r,n,o,s,a,c){let u,l=e.substring(n,o);for(this.regex.lastIndex=0;u=this.regex.exec(l);){let d=u[0],p=this.cache.get(d);if(p)if(a+p.length<=s)a+=p.length,c+=d.length,r.push(...p);else{let f=s-a;a+=f,c+=d.length,r.push(...p.slice(0,f));break}else{let f=this.textEncoder.encode(d),m=this.encoder.get(f,0,f.length);if(m!==void 0)if(this.cache.set(d,[m]),a+1<=s)a++,c+=d.length,r.push(m);else break;else{let h=(0,jP.bytePairEncode)(f,this.encoder,this.textEncoder.length);if(this.cache.set(d,h),a+h.length<=s){a+=h.length,c+=d.length;for(let g of h)r.push(g)}else{let g=s-a;a+=g,c+=d.length;for(let v=0;v<g;v++)r.push(h[v]);break}}}if(a>=s)break}return{tokenCount:a,encodeLength:c}}encodeTrimSuffix(e,r,n){let o=[],s=0,a=0,c=0;for(;;){let l,d;if([l,d]=this.findNextSpecialToken(e,s,n),d>s){let{tokenCount:p,encodeLength:f}=this.encodeTrimSuffixByIndex(e,o,s,d,r,a,c);if(a=p,c=f,a>=r)break}if(l!==null){if(a++,a<=r&&(s=s+this.encodeSpecialToken(o,l),c+=l[0].length,s>=e.length)||a>=r)break}else break}let u=c===e.length?e:e.slice(0,c);return{tokenIds:o,text:u}}encodeTrimPrefix(e,r,n){let o=[],s=0,a=0,c=0,u=new Map;for(u.set(a,c);;){let f,m;if([f,m]=this.findNextSpecialToken(e,s,n),m>s){let h,g=e.substring(s,m);for(this.regex.lastIndex=0;h=this.regex.exec(g);){let v=h[0],y=this.cache.get(v);if(y)a+=y.length,c+=v.length,o.push(...y),u.set(a,c);else{let _=this.textEncoder.encode(v),b=this.encoder.get(_);if(b!==void 0)this.cache.set(v,[b]),a++,c+=v.length,o.push(b),u.set(a,c);else{let S=(0,jP.bytePairEncode)(_,this.encoder,this.textEncoder.length);this.cache.set(v,S),a+=S.length,c+=v.length;for(let I of S)o.push(I);u.set(a,c)}}}}if(f!==null){if(s=s+this.encodeSpecialToken(o,f),a++,c+=f[0].length,u.set(a,c),s>=e.length)break}else break}if(a<=r)return{tokenIds:o,text:e};let l=a-r,d=0,p=0;for(let[f,m]of u)if(f>=l){d=f,p=m;break}if(d>r){let f=this.encode(e,n),m=f.slice(f.length-r);return{tokenIds:m,text:this.decode(m)}}return{tokenIds:o.slice(d),text:e.slice(p)}}decode(e){let r=[];for(let n of e){let o=[],s=this.decoder?.get(n);if(s!==void 0)o=Array.from(s);else{let a=this.specialTokensDecoder?.get(n);if(a!==void 0){let c=this.textEncoder.encode(a);o=Array.from(c.subarray(0,this.textEncoder.length))}}r.push(...o)}return this.textDecoder.decode(new Uint8Array(r))}};zP.TikTokenizer=hU});var Cne=L(Yi=>{"use strict";Object.defineProperty(Yi,"__esModule",{value:!0});Yi.createTokenizer=Yi.createByEncoderName=Yi.createByModelName=Yi.getRegexByModel=Yi.getRegexByEncoder=Yi.getSpecialTokensByModel=Yi.getSpecialTokensByEncoder=Yi.MODEL_TO_ENCODING=void 0;var VP=require("fs"),vU=require("path"),sLe=gU(),aLe=new Map([["gpt-4o-","o200k_base"],["gpt-4-","cl100k_base"],["gpt-3.5-turbo-","cl100k_base"],["gpt-35-turbo-","cl100k_base"]]);Yi.MODEL_TO_ENCODING=new Map([["gpt-4o","o200k_base"],["gpt-4","cl100k_base"],["gpt-3.5-turbo","cl100k_base"],["text-davinci-003","p50k_base"],["text-davinci-002","p50k_base"],["text-davinci-001","r50k_base"],["text-curie-001","r50k_base"],["text-babbage-001","r50k_base"],["text-ada-001","r50k_base"],["davinci","r50k_base"],["curie","r50k_base"],["babbage","r50k_base"],["ada","r50k_base"],["code-davinci-002","p50k_base"],["code-davinci-001","p50k_base"],["code-cushman-002","p50k_base"],["code-cushman-001","p50k_base"],["davinci-codex","p50k_base"],["cushman-codex","p50k_base"],["text-davinci-edit-001","p50k_edit"],["code-davinci-edit-001","p50k_edit"],["text-embedding-ada-002","cl100k_base"],["text-similarity-davinci-001","r50k_base"],["text-similarity-curie-001","r50k_base"],["text-similarity-babbage-001","r50k_base"],["text-similarity-ada-001","r50k_base"],["text-search-davinci-doc-001","r50k_base"],["text-search-curie-doc-001","r50k_base"],["text-search-babbage-doc-001","r50k_base"],["text-search-ada-doc-001","r50k_base"],["code-search-babbage-code-001","r50k_base"],["code-search-ada-code-001","r50k_base"],["gpt2","gpt2"]]);var GP="<|endoftext|>",hne="<|fim_prefix|>",gne="<|fim_middle|>",vne="<|fim_suffix|>",yne="<|endofprompt|>",AE="'s|'t|'re|'ve|'m|'ll|'d| ?\\p{L}+| ?\\p{N}+| ?[^\\s\\p{L}\\p{N}]+|\\s+(?!\\S)|\\s+",bne="(?:'s|'S|'t|'T|'re|'RE|'Re|'eR|'ve|'VE|'vE|'Ve|'m|'M|'ll|'lL|'Ll|'LL|'d|'D)|[^\\r\\n\\p{L}\\p{N}]?\\p{L}+|\\p{N}{1,3}| ?[^\\s\\p{L}\\p{N}]+[\\r\\n]*|\\s*[\\r\\n]+|\\s+(?!\\S)|\\s+",cLe=[`[^\r
\\p{L}\\p{N}]?[\\p{Lu}\\p{Lt}\\p{Lm}\\p{Lo}\\p{M}]*[\\p{Ll}\\p{Lm}\\p{Lo}\\p{M}]+(?:'s|'S|'t|'T|'re|'RE|'Re|'eR|'ve|'VE|'vE|'Ve|'m|'M|'ll|'lL|'Ll|'LL|'d|'D)?`,`[^\r
\\p{L}\\p{N}]?[\\p{Lu}\\p{Lt}\\p{Lm}\\p{Lo}\\p{M}]+[\\p{Ll}\\p{Lm}\\p{Lo}\\p{M}]*(?:'s|'S|'t|'T|'re|'RE|'Re|'eR|'ve|'VE|'vE|'Ve|'m|'M|'ll|'lL|'Ll|'LL|'d|'D)?`,"\\p{N}{1,3}"," ?[^\\s\\p{L}\\p{N}]+[\\r\\n/]*","\\s*[\\r\\n]+","\\s+(?!\\S)","\\s+"],_ne=cLe.join("|");function yU(t){let e="";if(Yi.MODEL_TO_ENCODING.has(t))e=Yi.MODEL_TO_ENCODING.get(t);else for(let[r,n]of aLe)if(t.startsWith(r)){e=n;break}return e}async function uLe(t,e){let r=await fetch(t);if(!r.ok)throw new Error(`Failed to fetch file from ${t}. Status code: ${r.status}`);let n=await r.text();VP.writeFileSync(e,n)}function bU(t){let e=new Map([[GP,50256]]);switch(t){case"o200k_base":e=new Map([[GP,199999],[yne,200018]]);break;case"cl100k_base":e=new Map([[GP,100257],[hne,100258],[gne,100259],[vne,100260],[yne,100276]]);break;case"p50k_edit":e=new Map([[GP,50256],[hne,50281],[gne,50282],[vne,50283]]);break;default:break}return e}Yi.getSpecialTokensByEncoder=bU;function lLe(t){let e=yU(t);return bU(e)}Yi.getSpecialTokensByModel=lLe;function xne(t){switch(t){case"o200k_base":return _ne;case"cl100k_base":return bne;default:break}return AE}Yi.getRegexByEncoder=xne;function dLe(t){let e=yU(t);return xne(e)}Yi.getRegexByModel=dLe;async function pLe(t,e=null){return Sne(yU(t),e)}Yi.createByModelName=pLe;async function Sne(t,e=null){let r,n,o=bU(t);switch(t){case"o200k_base":r=_ne,n="https://openaipublic.blob.core.windows.net/encodings/o200k_base.tiktoken";break;case"cl100k_base":r=bne,n="https://openaipublic.blob.core.windows.net/encodings/cl100k_base.tiktoken";break;case"p50k_base":r=AE,n="https://openaipublic.blob.core.windows.net/encodings/p50k_base.tiktoken";break;case"p50k_edit":r=AE,n="https://openaipublic.blob.core.windows.net/encodings/p50k_base.tiktoken";break;case"r50k_base":r=AE,n="https://openaipublic.blob.core.windows.net/encodings/r50k_base.tiktoken";break;case"gpt2":r=AE,n="https://pythia.blob.core.windows.net/public/encoding/gpt2.tiktoken";break;default:throw new Error(`Doesn't support this encoder [${t}]`)}e!==null&&(o=new Map([...o,...e]));let s=vU.basename(n),a=vU.resolve(__dirname,"..","model");VP.existsSync(a)||VP.mkdirSync(a,{recursive:!0});let c=vU.resolve(a,s);return VP.existsSync(c)||(console.log(`Downloading file from ${n}`),await uLe(n,c),console.log(`Saved file to ${c}`)),Ine(c,o,r)}Yi.createByEncoderName=Sne;function Ine(t,e,r,n=8192){return new sLe.TikTokenizer(t,e,r,n)}Yi.createTokenizer=Ine});var Tne=L(Qi=>{"use strict";Object.defineProperty(Qi,"__esModule",{value:!0});Qi.createTokenizer=Qi.createByEncoderName=Qi.createByModelName=Qi.getSpecialTokensByModel=Qi.getSpecialTokensByEncoder=Qi.getRegexByModel=Qi.getRegexByEncoder=Qi.MODEL_TO_ENCODING=Qi.TikTokenizer=void 0;var fLe=gU();Object.defineProperty(Qi,"TikTokenizer",{enumerable:!0,get:function(){return fLe.TikTokenizer}});var Qm=Cne();Object.defineProperty(Qi,"MODEL_TO_ENCODING",{enumerable:!0,get:function(){return Qm.MODEL_TO_ENCODING}});Object.defineProperty(Qi,"getRegexByEncoder",{enumerable:!0,get:function(){return Qm.getRegexByEncoder}});Object.defineProperty(Qi,"getRegexByModel",{enumerable:!0,get:function(){return Qm.getRegexByModel}});Object.defineProperty(Qi,"getSpecialTokensByEncoder",{enumerable:!0,get:function(){return Qm.getSpecialTokensByEncoder}});Object.defineProperty(Qi,"getSpecialTokensByModel",{enumerable:!0,get:function(){return Qm.getSpecialTokensByModel}});Object.defineProperty(Qi,"createByModelName",{enumerable:!0,get:function(){return Qm.createByModelName}});Object.defineProperty(Qi,"createByEncoderName",{enumerable:!0,get:function(){return Qm.createByEncoderName}});Object.defineProperty(Qi,"createTokenizer",{enumerable:!0,get:function(){return Qm.createTokenizer}})});var mie=L((exports,module)=>{var Module=Module!==void 0?Module:{},TreeSitter=function(){var initPromise,document=typeof window=="object"?{currentScript:window.document.currentScript}:null;class Parser{constructor(){this.initialize()}initialize(){throw new Error("cannot construct a Parser before calling `init()`")}static init(moduleOptions){return initPromise||(Module=Object.assign({},Module,moduleOptions),initPromise=new Promise(resolveInitPromise=>{var moduleOverrides=Object.assign({},Module),arguments_=[],thisProgram="./this.program",quit_=(t,e)=>{throw e},ENVIRONMENT_IS_WEB=typeof window=="object",ENVIRONMENT_IS_WORKER=typeof importScripts=="function",ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",scriptDirectory="",read_,readAsync,readBinary;function locateFile(t){return Module.locateFile?Module.locateFile(t,scriptDirectory):scriptDirectory+t}if(ENVIRONMENT_IS_NODE){var fs=require("fs"),nodePath=require("path");scriptDirectory=ENVIRONMENT_IS_WORKER?nodePath.dirname(scriptDirectory)+"/":__dirname+"/",read_=(t,e)=>(t=isFileURI(t)?new URL(t):nodePath.normalize(t),fs.readFileSync(t,e?void 0:"utf8")),readBinary=t=>{var e=read_(t,!0);return e.buffer||(e=new Uint8Array(e)),e},readAsync=(t,e,r,n=!0)=>{t=isFileURI(t)?new URL(t):nodePath.normalize(t),fs.readFile(t,n?void 0:"utf8",(o,s)=>{o?r(o):e(n?s.buffer:s)})},!Module.thisProgram&&process.argv.length>1&&(thisProgram=process.argv[1].replace(/\\/g,"/")),arguments_=process.argv.slice(2),typeof module<"u"&&(module.exports=Module),quit_=(t,e)=>{throw process.exitCode=t,e}}else(ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER)&&(ENVIRONMENT_IS_WORKER?scriptDirectory=self.location.href:document!==void 0&&document.currentScript&&(scriptDirectory=document.currentScript.src),scriptDirectory=scriptDirectory.startsWith("blob:")?"":scriptDirectory.substr(0,scriptDirectory.replace(/[?#].*/,"").lastIndexOf("/")+1),read_=t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),e.responseText},ENVIRONMENT_IS_WORKER&&(readBinary=t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}),readAsync=(t,e,r)=>{var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer",n.onload=()=>{n.status==200||n.status==0&&n.response?e(n.response):r()},n.onerror=r,n.send(null)});var out=Module.print||console.log.bind(console),err=Module.printErr||console.error.bind(console);Object.assign(Module,moduleOverrides),moduleOverrides=null,Module.arguments&&(arguments_=Module.arguments),Module.thisProgram&&(thisProgram=Module.thisProgram),Module.quit&&(quit_=Module.quit);var dynamicLibraries=Module.dynamicLibraries||[],wasmBinary,wasmMemory;Module.wasmBinary&&(wasmBinary=Module.wasmBinary),typeof WebAssembly!="object"&&abort("no native wasm support detected");var ABORT=!1,EXITSTATUS,HEAP8,HEAPU8,HEAP16,HEAPU16,HEAP32,HEAPU32,HEAPF32,HEAPF64;function updateMemoryViews(){var t=wasmMemory.buffer;Module.HEAP8=HEAP8=new Int8Array(t),Module.HEAP16=HEAP16=new Int16Array(t),Module.HEAPU8=HEAPU8=new Uint8Array(t),Module.HEAPU16=HEAPU16=new Uint16Array(t),Module.HEAP32=HEAP32=new Int32Array(t),Module.HEAPU32=HEAPU32=new Uint32Array(t),Module.HEAPF32=HEAPF32=new Float32Array(t),Module.HEAPF64=HEAPF64=new Float64Array(t)}var INITIAL_MEMORY=Module.INITIAL_MEMORY||33554432;wasmMemory=Module.wasmMemory?Module.wasmMemory:new WebAssembly.Memory({initial:INITIAL_MEMORY/65536,maximum:32768}),updateMemoryViews(),INITIAL_MEMORY=wasmMemory.buffer.byteLength;var __ATPRERUN__=[],__ATINIT__=[],__ATMAIN__=[],__ATPOSTRUN__=[],__RELOC_FUNCS__=[],runtimeInitialized=!1;function preRun(){if(Module.preRun)for(typeof Module.preRun=="function"&&(Module.preRun=[Module.preRun]);Module.preRun.length;)addOnPreRun(Module.preRun.shift());callRuntimeCallbacks(__ATPRERUN__)}function initRuntime(){runtimeInitialized=!0,callRuntimeCallbacks(__RELOC_FUNCS__),callRuntimeCallbacks(__ATINIT__)}function preMain(){callRuntimeCallbacks(__ATMAIN__)}function postRun(){if(Module.postRun)for(typeof Module.postRun=="function"&&(Module.postRun=[Module.postRun]);Module.postRun.length;)addOnPostRun(Module.postRun.shift());callRuntimeCallbacks(__ATPOSTRUN__)}function addOnPreRun(t){__ATPRERUN__.unshift(t)}function addOnInit(t){__ATINIT__.unshift(t)}function addOnPostRun(t){__ATPOSTRUN__.unshift(t)}var runDependencies=0,runDependencyWatcher=null,dependenciesFulfilled=null;function getUniqueRunDependency(t){return t}function addRunDependency(t){runDependencies++,Module.monitorRunDependencies?.(runDependencies)}function removeRunDependency(t){if(runDependencies--,Module.monitorRunDependencies?.(runDependencies),runDependencies==0&&(runDependencyWatcher!==null&&(clearInterval(runDependencyWatcher),runDependencyWatcher=null),dependenciesFulfilled)){var e=dependenciesFulfilled;dependenciesFulfilled=null,e()}}function abort(t){throw Module.onAbort?.(t),err(t="Aborted("+t+")"),ABORT=!0,EXITSTATUS=1,t+=". Build with -sASSERTIONS for more info.",new WebAssembly.RuntimeError(t)}var dataURIPrefix="data:application/octet-stream;base64,",isDataURI=t=>t.startsWith(dataURIPrefix),isFileURI=t=>t.startsWith("file://"),wasmBinaryFile;function getBinarySync(t){if(t==wasmBinaryFile&&wasmBinary)return new Uint8Array(wasmBinary);if(readBinary)return readBinary(t);throw"both async and sync fetching of the wasm failed"}function getBinaryPromise(t){if(!wasmBinary&&(ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER)){if(typeof fetch=="function"&&!isFileURI(t))return fetch(t,{credentials:"same-origin"}).then(e=>{if(!e.ok)throw`failed to load wasm binary file at '${t}'`;return e.arrayBuffer()}).catch(()=>getBinarySync(t));if(readAsync)return new Promise((e,r)=>{readAsync(t,n=>e(new Uint8Array(n)),r)})}return Promise.resolve().then(()=>getBinarySync(t))}function instantiateArrayBuffer(t,e,r){return getBinaryPromise(t).then(n=>WebAssembly.instantiate(n,e)).then(r,n=>{err(`failed to asynchronously prepare wasm: ${n}`),abort(n)})}function instantiateAsync(t,e,r,n){return t||typeof WebAssembly.instantiateStreaming!="function"||isDataURI(e)||isFileURI(e)||ENVIRONMENT_IS_NODE||typeof fetch!="function"?instantiateArrayBuffer(e,r,n):fetch(e,{credentials:"same-origin"}).then(o=>WebAssembly.instantiateStreaming(o,r).then(n,function(s){return err(`wasm streaming compile failed: ${s}`),err("falling back to ArrayBuffer instantiation"),instantiateArrayBuffer(e,r,n)}))}function createWasm(){var t={env:wasmImports,wasi_snapshot_preview1:wasmImports,"GOT.mem":new Proxy(wasmImports,GOTHandler),"GOT.func":new Proxy(wasmImports,GOTHandler)};function e(r,n){wasmExports=r.exports,wasmExports=relocateExports(wasmExports,1024);var o=getDylinkMetadata(n);return o.neededDynlibs&&(dynamicLibraries=o.neededDynlibs.concat(dynamicLibraries)),mergeLibSymbols(wasmExports,"main"),LDSO.init(),loadDylibs(),addOnInit(wasmExports.__wasm_call_ctors),__RELOC_FUNCS__.push(wasmExports.__wasm_apply_data_relocs),removeRunDependency("wasm-instantiate"),wasmExports}if(addRunDependency("wasm-instantiate"),Module.instantiateWasm)try{return Module.instantiateWasm(t,e)}catch(r){return err(`Module.instantiateWasm callback failed with error: ${r}`),!1}return instantiateAsync(wasmBinary,wasmBinaryFile,t,function(r){e(r.instance,r.module)}),{}}wasmBinaryFile="tree-sitter.wasm",isDataURI(wasmBinaryFile)||(wasmBinaryFile=locateFile(wasmBinaryFile));var ASM_CONSTS={};function ExitStatus(t){this.name="ExitStatus",this.message=`Program terminated with exit(${t})`,this.status=t}var GOT={},currentModuleWeakSymbols=new Set([]),GOTHandler={get(t,e){var r=GOT[e];return r||(r=GOT[e]=new WebAssembly.Global({value:"i32",mutable:!0})),currentModuleWeakSymbols.has(e)||(r.required=!0),r}},callRuntimeCallbacks=t=>{for(;t.length>0;)t.shift()(Module)},UTF8Decoder=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,UTF8ArrayToString=(t,e,r)=>{for(var n=e+r,o=e;t[o]&&!(o>=n);)++o;if(o-e>16&&t.buffer&&UTF8Decoder)return UTF8Decoder.decode(t.subarray(e,o));for(var s="";e<o;){var a=t[e++];if(128&a){var c=63&t[e++];if((224&a)!=192){var u=63&t[e++];if((a=(240&a)==224?(15&a)<<12|c<<6|u:(7&a)<<18|c<<12|u<<6|63&t[e++])<65536)s+=String.fromCharCode(a);else{var l=a-65536;s+=String.fromCharCode(55296|l>>10,56320|1023&l)}}else s+=String.fromCharCode((31&a)<<6|c)}else s+=String.fromCharCode(a)}return s},getDylinkMetadata=t=>{var e=0,r=0;function n(){for(var y=0,_=1;;){var b=t[e++];if(y+=(127&b)*_,_*=128,!(128&b))break}return y}function o(){var y=n();return UTF8ArrayToString(t,(e+=y)-y,y)}function s(y,_){if(y)throw new Error(_)}var a="dylink.0";if(t instanceof WebAssembly.Module){var c=WebAssembly.Module.customSections(t,a);c.length===0&&(a="dylink",c=WebAssembly.Module.customSections(t,a)),s(c.length===0,"need dylink section"),r=(t=new Uint8Array(c[0])).length}else{s(new Uint32Array(new Uint8Array(t.subarray(0,24)).buffer)[0]!=1836278016,"need to see wasm magic number"),s(t[8]!==0,"need the dylink section to be first"),e=9;var u=n();r=e+u,a=o()}var l={neededDynlibs:[],tlsExports:new Set,weakImports:new Set};if(a=="dylink"){l.memorySize=n(),l.memoryAlign=n(),l.tableSize=n(),l.tableAlign=n();for(var d=n(),p=0;p<d;++p){var f=o();l.neededDynlibs.push(f)}}else for(s(a!=="dylink.0");e<r;){var m=t[e++],h=n();if(m===1)l.memorySize=n(),l.memoryAlign=n(),l.tableSize=n(),l.tableAlign=n();else if(m===2)for(d=n(),p=0;p<d;++p)f=o(),l.neededDynlibs.push(f);else if(m===3)for(var g=n();g--;){var v=o();256&n()&&l.tlsExports.add(v)}else if(m===4)for(g=n();g--;)o(),v=o(),(3&n())==1&&l.weakImports.add(v);else e+=h}return l};function getValue(t,e="i8"){switch(e.endsWith("*")&&(e="*"),e){case"i1":case"i8":return HEAP8[t];case"i16":return HEAP16[t>>1];case"i32":return HEAP32[t>>2];case"i64":abort("to do getValue(i64) use WASM_BIGINT");case"float":return HEAPF32[t>>2];case"double":return HEAPF64[t>>3];case"*":return HEAPU32[t>>2];default:abort(`invalid type for getValue: ${e}`)}}var newDSO=(t,e,r)=>{var n={refcount:1/0,name:t,exports:r,global:!0};return LDSO.loadedLibsByName[t]=n,e!=null&&(LDSO.loadedLibsByHandle[e]=n),n},LDSO={loadedLibsByName:{},loadedLibsByHandle:{},init(){newDSO("__main__",0,wasmImports)}},___heap_base=78096,zeroMemory=(t,e)=>(HEAPU8.fill(0,t,t+e),t),alignMemory=(t,e)=>Math.ceil(t/e)*e,getMemory=t=>{if(runtimeInitialized)return zeroMemory(_malloc(t),t);var e=___heap_base,r=e+alignMemory(t,16);return ___heap_base=r,GOT.__heap_base.value=r,e},isInternalSym=t=>["__cpp_exception","__c_longjmp","__wasm_apply_data_relocs","__dso_handle","__tls_size","__tls_align","__set_stack_limits","_emscripten_tls_init","__wasm_init_tls","__wasm_call_ctors","__start_em_asm","__stop_em_asm","__start_em_js","__stop_em_js"].includes(t)||t.startsWith("__em_js__"),uleb128Encode=(t,e)=>{t<128?e.push(t):e.push(t%128|128,t>>7)},sigToWasmTypes=t=>{for(var e={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},r={parameters:[],results:t[0]=="v"?[]:[e[t[0]]]},n=1;n<t.length;++n)r.parameters.push(e[t[n]]);return r},generateFuncType=(t,e)=>{var r=t.slice(0,1),n=t.slice(1),o={i:127,p:127,j:126,f:125,d:124,e:111};e.push(96),uleb128Encode(n.length,e);for(var s=0;s<n.length;++s)e.push(o[n[s]]);r=="v"?e.push(0):e.push(1,o[r])},convertJsFunctionToWasm=(t,e)=>{if(typeof WebAssembly.Function=="function")return new WebAssembly.Function(sigToWasmTypes(e),t);var r=[1];generateFuncType(e,r);var n=[0,97,115,109,1,0,0,0,1];uleb128Encode(r.length,n),n.push(...r),n.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0);var o=new WebAssembly.Module(new Uint8Array(n));return new WebAssembly.Instance(o,{e:{f:t}}).exports.f},wasmTableMirror=[],wasmTable=new WebAssembly.Table({initial:27,element:"anyfunc"}),getWasmTableEntry=t=>{var e=wasmTableMirror[t];return e||(t>=wasmTableMirror.length&&(wasmTableMirror.length=t+1),wasmTableMirror[t]=e=wasmTable.get(t)),e},updateTableMap=(t,e)=>{if(functionsInTableMap)for(var r=t;r<t+e;r++){var n=getWasmTableEntry(r);n&&functionsInTableMap.set(n,r)}},functionsInTableMap,getFunctionAddress=t=>(functionsInTableMap||(functionsInTableMap=new WeakMap,updateTableMap(0,wasmTable.length)),functionsInTableMap.get(t)||0),freeTableIndexes=[],getEmptyTableSlot=()=>{if(freeTableIndexes.length)return freeTableIndexes.pop();try{wasmTable.grow(1)}catch(t){throw t instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":t}return wasmTable.length-1},setWasmTableEntry=(t,e)=>{wasmTable.set(t,e),wasmTableMirror[t]=wasmTable.get(t)},addFunction=(t,e)=>{var r=getFunctionAddress(t);if(r)return r;var n=getEmptyTableSlot();try{setWasmTableEntry(n,t)}catch(s){if(!(s instanceof TypeError))throw s;var o=convertJsFunctionToWasm(t,e);setWasmTableEntry(n,o)}return functionsInTableMap.set(t,n),n},updateGOT=(t,e)=>{for(var r in t)if(!isInternalSym(r)){var n=t[r];r.startsWith("orig$")&&(r=r.split("$")[1],e=!0),GOT[r]||=new WebAssembly.Global({value:"i32",mutable:!0}),(e||GOT[r].value==0)&&(typeof n=="function"?GOT[r].value=addFunction(n):typeof n=="number"?GOT[r].value=n:err(`unhandled export type for '${r}': ${typeof n}`))}},relocateExports=(t,e,r)=>{var n={};for(var o in t){var s=t[o];typeof s=="object"&&(s=s.value),typeof s=="number"&&(s+=e),n[o]=s}return updateGOT(n,r),n},isSymbolDefined=t=>{var e=wasmImports[t];return!(!e||e.stub)},dynCallLegacy=(t,e,r)=>(0,Module["dynCall_"+t])(e,...r),dynCall=(t,e,r=[])=>t.includes("j")?dynCallLegacy(t,e,r):getWasmTableEntry(e)(...r),createInvokeFunction=t=>function(){var e=stackSave();try{return dynCall(t,arguments[0],Array.prototype.slice.call(arguments,1))}catch(r){if(stackRestore(e),r!==r+0)throw r;_setThrew(1,0)}},resolveGlobalSymbol=(t,e=!1)=>{var r;return e&&"orig$"+t in wasmImports&&(t="orig$"+t),isSymbolDefined(t)?r=wasmImports[t]:t.startsWith("invoke_")&&(r=wasmImports[t]=createInvokeFunction(t.split("_")[1])),{sym:r,name:t}},UTF8ToString=(t,e)=>t?UTF8ArrayToString(HEAPU8,t,e):"",loadWebAssemblyModule=(binary,flags,libName,localScope,handle)=>{var metadata=getDylinkMetadata(binary);function loadModule(){var firstLoad=!handle||!HEAP8[handle+8];if(firstLoad){var memAlign=Math.pow(2,metadata.memoryAlign),memoryBase=metadata.memorySize?alignMemory(getMemory(metadata.memorySize+memAlign),memAlign):0,tableBase=metadata.tableSize?wasmTable.length:0;handle&&(HEAP8[handle+8]=1,HEAPU32[handle+12>>2]=memoryBase,HEAP32[handle+16>>2]=metadata.memorySize,HEAPU32[handle+20>>2]=tableBase,HEAP32[handle+24>>2]=metadata.tableSize)}else memoryBase=HEAPU32[handle+12>>2],tableBase=HEAPU32[handle+20>>2];var tableGrowthNeeded=tableBase+metadata.tableSize-wasmTable.length,moduleExports;function resolveSymbol(t){var e=resolveGlobalSymbol(t).sym;return!e&&localScope&&(e=localScope[t]),e||(e=moduleExports[t]),e}tableGrowthNeeded>0&&wasmTable.grow(tableGrowthNeeded);var proxyHandler={get(t,e){switch(e){case"__memory_base":return memoryBase;case"__table_base":return tableBase}if(e in wasmImports&&!wasmImports[e].stub)return wasmImports[e];var r;return e in t||(t[e]=(...n)=>(r||=resolveSymbol(e),r(...n))),t[e]}},proxy=new Proxy({},proxyHandler),info={"GOT.mem":new Proxy({},GOTHandler),"GOT.func":new Proxy({},GOTHandler),env:proxy,wasi_snapshot_preview1:proxy};function postInstantiation(module,instance){function addEmAsm(addr,body){for(var args=[],arity=0;arity<16&&body.indexOf("$"+arity)!=-1;arity++)args.push("$"+arity);args=args.join(",");var func=`(${args}) => { ${body} };`;ASM_CONSTS[start]=eval(func)}if(updateTableMap(tableBase,metadata.tableSize),moduleExports=relocateExports(instance.exports,memoryBase),flags.allowUndefined||reportUndefinedSymbols(),"__start_em_asm"in moduleExports)for(var start=moduleExports.__start_em_asm,stop=moduleExports.__stop_em_asm;start<stop;){var jsString=UTF8ToString(start);addEmAsm(start,jsString),start=HEAPU8.indexOf(0,start)+1}function addEmJs(name,cSig,body){var jsArgs=[];if(cSig=cSig.slice(1,-1),cSig!="void")for(var i in cSig=cSig.split(","),cSig){var jsArg=cSig[i].split(" ").pop();jsArgs.push(jsArg.replace("*",""))}var func=`(${jsArgs}) => ${body};`;moduleExports[name]=eval(func)}for(var name in moduleExports)if(name.startsWith("__em_js__")){var start=moduleExports[name],jsString=UTF8ToString(start),parts=jsString.split("<::>");addEmJs(name.replace("__em_js__",""),parts[0],parts[1]),delete moduleExports[name]}var applyRelocs=moduleExports.__wasm_apply_data_relocs;applyRelocs&&(runtimeInitialized?applyRelocs():__RELOC_FUNCS__.push(applyRelocs));var init=moduleExports.__wasm_call_ctors;return init&&(runtimeInitialized?init():__ATINIT__.push(init)),moduleExports}if(flags.loadAsync){if(binary instanceof WebAssembly.Module){var instance=new WebAssembly.Instance(binary,info);return Promise.resolve(postInstantiation(binary,instance))}return WebAssembly.instantiate(binary,info).then(t=>postInstantiation(t.module,t.instance))}var module=binary instanceof WebAssembly.Module?binary:new WebAssembly.Module(binary),instance=new WebAssembly.Instance(module,info);return postInstantiation(module,instance)}return currentModuleWeakSymbols=metadata.weakImports,flags.loadAsync?metadata.neededDynlibs.reduce((t,e)=>t.then(()=>loadDynamicLibrary(e,flags)),Promise.resolve()).then(loadModule):(metadata.neededDynlibs.forEach(t=>loadDynamicLibrary(t,flags,localScope)),loadModule())},mergeLibSymbols=(t,e)=>{for(var[r,n]of Object.entries(t)){let o=a=>{isSymbolDefined(a)||(wasmImports[a]=n)};o(r);let s="__main_argc_argv";r=="main"&&o(s),r==s&&o("main"),r.startsWith("dynCall_")&&!Module.hasOwnProperty(r)&&(Module[r]=n)}},asyncLoad=(t,e,r,n)=>{var o=n?"":`al ${t}`;readAsync(t,s=>{e(new Uint8Array(s)),o&&removeRunDependency(o)},s=>{if(!r)throw`Loading data file "${t}" failed.`;r()}),o&&addRunDependency(o)};function loadDynamicLibrary(t,e={global:!0,nodelete:!0},r,n){var o=LDSO.loadedLibsByName[t];if(o)return e.global?o.global||(o.global=!0,mergeLibSymbols(o.exports,t)):r&&Object.assign(r,o.exports),e.nodelete&&o.refcount!==1/0&&(o.refcount=1/0),o.refcount++,n&&(LDSO.loadedLibsByHandle[n]=o),!e.loadAsync||Promise.resolve(!0);function s(){if(n){var u=HEAPU32[n+28>>2],l=HEAPU32[n+32>>2];if(u&&l){var d=HEAP8.slice(u,u+l);return e.loadAsync?Promise.resolve(d):d}}var p=locateFile(t);if(e.loadAsync)return new Promise(function(f,m){asyncLoad(p,f,m)});if(!readBinary)throw new Error(`${p}: file not found, and synchronous loading of external files is not available`);return readBinary(p)}function a(){return e.loadAsync?s().then(u=>loadWebAssemblyModule(u,e,t,r,n)):loadWebAssemblyModule(s(),e,t,r,n)}function c(u){o.global?mergeLibSymbols(u,t):r&&Object.assign(r,u),o.exports=u}return(o=newDSO(t,n,"loading")).refcount=e.nodelete?1/0:1,o.global=e.global,e.loadAsync?a().then(u=>(c(u),!0)):(c(a()),!0)}var reportUndefinedSymbols=()=>{for(var[t,e]of Object.entries(GOT))if(e.value==0){var r=resolveGlobalSymbol(t,!0).sym;if(!r&&!e.required)continue;if(typeof r=="function")e.value=addFunction(r,r.sig);else{if(typeof r!="number")throw new Error(`bad export type for '${t}': ${typeof r}`);e.value=r}}},loadDylibs=()=>{dynamicLibraries.length?(addRunDependency("loadDylibs"),dynamicLibraries.reduce((t,e)=>t.then(()=>loadDynamicLibrary(e,{loadAsync:!0,global:!0,nodelete:!0,allowUndefined:!0})),Promise.resolve()).then(()=>{reportUndefinedSymbols(),removeRunDependency("loadDylibs")})):reportUndefinedSymbols()},noExitRuntime=Module.noExitRuntime||!0;function setValue(t,e,r="i8"){switch(r.endsWith("*")&&(r="*"),r){case"i1":case"i8":HEAP8[t]=e;break;case"i16":HEAP16[t>>1]=e;break;case"i32":HEAP32[t>>2]=e;break;case"i64":abort("to do setValue(i64) use WASM_BIGINT");case"float":HEAPF32[t>>2]=e;break;case"double":HEAPF64[t>>3]=e;break;case"*":HEAPU32[t>>2]=e;break;default:abort(`invalid type for setValue: ${r}`)}}var ___memory_base=new WebAssembly.Global({value:"i32",mutable:!1},1024),___stack_pointer=new WebAssembly.Global({value:"i32",mutable:!0},78096),___table_base=new WebAssembly.Global({value:"i32",mutable:!1},1),nowIsMonotonic=1,__emscripten_get_now_is_monotonic=()=>nowIsMonotonic;__emscripten_get_now_is_monotonic.sig="i";var _abort=()=>{abort("")};_abort.sig="v";var _emscripten_date_now=()=>Date.now(),_emscripten_get_now;_emscripten_date_now.sig="d",_emscripten_get_now=()=>performance.now(),_emscripten_get_now.sig="d";var _emscripten_memcpy_js=(t,e,r)=>HEAPU8.copyWithin(t,e,e+r);_emscripten_memcpy_js.sig="vppp";var getHeapMax=()=>2147483648,growMemory=t=>{var e=(t-wasmMemory.buffer.byteLength+65535)/65536;try{return wasmMemory.grow(e),updateMemoryViews(),1}catch{}},_emscripten_resize_heap=t=>{var e=HEAPU8.length;t>>>=0;var r=getHeapMax();if(t>r)return!1;for(var n,o,s=1;s<=4;s*=2){var a=e*(1+.2/s);a=Math.min(a,t+100663296);var c=Math.min(r,(n=Math.max(t,a))+((o=65536)-n%o)%o);if(growMemory(c))return!0}return!1};_emscripten_resize_heap.sig="ip";var _fd_close=t=>52;_fd_close.sig="ii";var convertI32PairToI53Checked=(t,e)=>e+2097152>>>0<4194305-!!t?(t>>>0)+4294967296*e:NaN;function _fd_seek(t,e,r,n,o){return convertI32PairToI53Checked(e,r),70}_fd_seek.sig="iiiiip";var printCharBuffers=[null,[],[]],printChar=(t,e)=>{var r=printCharBuffers[t];e===0||e===10?((t===1?out:err)(UTF8ArrayToString(r,0)),r.length=0):r.push(e)},SYSCALLS={varargs:void 0,get(){var t=HEAP32[+SYSCALLS.varargs>>2];return SYSCALLS.varargs+=4,t},getp:()=>SYSCALLS.get(),getStr:t=>UTF8ToString(t)},_fd_write=(t,e,r,n)=>{for(var o=0,s=0;s<r;s++){var a=HEAPU32[e>>2],c=HEAPU32[e+4>>2];e+=8;for(var u=0;u<c;u++)printChar(t,HEAPU8[a+u]);o+=c}return HEAPU32[n>>2]=o,0};function _tree_sitter_log_callback(t,e){if(currentLogCallback){let r=UTF8ToString(e);currentLogCallback(r,t!==0)}}function _tree_sitter_parse_callback(t,e,r,n,o){let s=currentParseCallback(e,{row:r,column:n});typeof s=="string"?(setValue(o,s.length,"i32"),stringToUTF16(s,t,10240)):setValue(o,0,"i32")}_fd_write.sig="iippp";var runtimeKeepaliveCounter=0,keepRuntimeAlive=()=>noExitRuntime||runtimeKeepaliveCounter>0,_proc_exit=t=>{EXITSTATUS=t,keepRuntimeAlive()||(Module.onExit?.(t),ABORT=!0),quit_(t,new ExitStatus(t))};_proc_exit.sig="vi";var exitJS=(t,e)=>{EXITSTATUS=t,_proc_exit(t)},handleException=t=>{if(t instanceof ExitStatus||t=="unwind")return EXITSTATUS;quit_(1,t)},lengthBytesUTF8=t=>{for(var e=0,r=0;r<t.length;++r){var n=t.charCodeAt(r);n<=127?e++:n<=2047?e+=2:n>=55296&&n<=57343?(e+=4,++r):e+=3}return e},stringToUTF8Array=(t,e,r,n)=>{if(!(n>0))return 0;for(var o=r,s=r+n-1,a=0;a<t.length;++a){var c=t.charCodeAt(a);if(c>=55296&&c<=57343&&(c=65536+((1023&c)<<10)|1023&t.charCodeAt(++a)),c<=127){if(r>=s)break;e[r++]=c}else if(c<=2047){if(r+1>=s)break;e[r++]=192|c>>6,e[r++]=128|63&c}else if(c<=65535){if(r+2>=s)break;e[r++]=224|c>>12,e[r++]=128|c>>6&63,e[r++]=128|63&c}else{if(r+3>=s)break;e[r++]=240|c>>18,e[r++]=128|c>>12&63,e[r++]=128|c>>6&63,e[r++]=128|63&c}}return e[r]=0,r-o},stringToUTF8=(t,e,r)=>stringToUTF8Array(t,HEAPU8,e,r),stringToUTF8OnStack=t=>{var e=lengthBytesUTF8(t)+1,r=stackAlloc(e);return stringToUTF8(t,r,e),r},stringToUTF16=(t,e,r)=>{if(r??=2147483647,r<2)return 0;for(var n=e,o=(r-=2)<2*t.length?r/2:t.length,s=0;s<o;++s){var a=t.charCodeAt(s);HEAP16[e>>1]=a,e+=2}return HEAP16[e>>1]=0,e-n},AsciiToString=t=>{for(var e="";;){var r=HEAPU8[t++];if(!r)return e;e+=String.fromCharCode(r)}},wasmImports={__heap_base:___heap_base,__indirect_function_table:wasmTable,__memory_base:___memory_base,__stack_pointer:___stack_pointer,__table_base:___table_base,_emscripten_get_now_is_monotonic:__emscripten_get_now_is_monotonic,abort:_abort,emscripten_get_now:_emscripten_get_now,emscripten_memcpy_js:_emscripten_memcpy_js,emscripten_resize_heap:_emscripten_resize_heap,fd_close:_fd_close,fd_seek:_fd_seek,fd_write:_fd_write,memory:wasmMemory,tree_sitter_log_callback:_tree_sitter_log_callback,tree_sitter_parse_callback:_tree_sitter_parse_callback},wasmExports=createWasm(),___wasm_call_ctors=()=>(___wasm_call_ctors=wasmExports.__wasm_call_ctors)(),___wasm_apply_data_relocs=()=>(___wasm_apply_data_relocs=wasmExports.__wasm_apply_data_relocs)(),_malloc=Module._malloc=t=>(_malloc=Module._malloc=wasmExports.malloc)(t),_calloc=Module._calloc=(t,e)=>(_calloc=Module._calloc=wasmExports.calloc)(t,e),_realloc=Module._realloc=(t,e)=>(_realloc=Module._realloc=wasmExports.realloc)(t,e),_free=Module._free=t=>(_free=Module._free=wasmExports.free)(t),_ts_language_symbol_count=Module._ts_language_symbol_count=t=>(_ts_language_symbol_count=Module._ts_language_symbol_count=wasmExports.ts_language_symbol_count)(t),_ts_language_state_count=Module._ts_language_state_count=t=>(_ts_language_state_count=Module._ts_language_state_count=wasmExports.ts_language_state_count)(t),_ts_language_version=Module._ts_language_version=t=>(_ts_language_version=Module._ts_language_version=wasmExports.ts_language_version)(t),_ts_language_field_count=Module._ts_language_field_count=t=>(_ts_language_field_count=Module._ts_language_field_count=wasmExports.ts_language_field_count)(t),_ts_language_next_state=Module._ts_language_next_state=(t,e,r)=>(_ts_language_next_state=Module._ts_language_next_state=wasmExports.ts_language_next_state)(t,e,r),_ts_language_symbol_name=Module._ts_language_symbol_name=(t,e)=>(_ts_language_symbol_name=Module._ts_language_symbol_name=wasmExports.ts_language_symbol_name)(t,e),_ts_language_symbol_for_name=Module._ts_language_symbol_for_name=(t,e,r,n)=>(_ts_language_symbol_for_name=Module._ts_language_symbol_for_name=wasmExports.ts_language_symbol_for_name)(t,e,r,n),_strncmp=Module._strncmp=(t,e,r)=>(_strncmp=Module._strncmp=wasmExports.strncmp)(t,e,r),_ts_language_symbol_type=Module._ts_language_symbol_type=(t,e)=>(_ts_language_symbol_type=Module._ts_language_symbol_type=wasmExports.ts_language_symbol_type)(t,e),_ts_language_field_name_for_id=Module._ts_language_field_name_for_id=(t,e)=>(_ts_language_field_name_for_id=Module._ts_language_field_name_for_id=wasmExports.ts_language_field_name_for_id)(t,e),_ts_lookahead_iterator_new=Module._ts_lookahead_iterator_new=(t,e)=>(_ts_lookahead_iterator_new=Module._ts_lookahead_iterator_new=wasmExports.ts_lookahead_iterator_new)(t,e),_ts_lookahead_iterator_delete=Module._ts_lookahead_iterator_delete=t=>(_ts_lookahead_iterator_delete=Module._ts_lookahead_iterator_delete=wasmExports.ts_lookahead_iterator_delete)(t),_ts_lookahead_iterator_reset_state=Module._ts_lookahead_iterator_reset_state=(t,e)=>(_ts_lookahead_iterator_reset_state=Module._ts_lookahead_iterator_reset_state=wasmExports.ts_lookahead_iterator_reset_state)(t,e),_ts_lookahead_iterator_reset=Module._ts_lookahead_iterator_reset=(t,e,r)=>(_ts_lookahead_iterator_reset=Module._ts_lookahead_iterator_reset=wasmExports.ts_lookahead_iterator_reset)(t,e,r),_ts_lookahead_iterator_next=Module._ts_lookahead_iterator_next=t=>(_ts_lookahead_iterator_next=Module._ts_lookahead_iterator_next=wasmExports.ts_lookahead_iterator_next)(t),_ts_lookahead_iterator_current_symbol=Module._ts_lookahead_iterator_current_symbol=t=>(_ts_lookahead_iterator_current_symbol=Module._ts_lookahead_iterator_current_symbol=wasmExports.ts_lookahead_iterator_current_symbol)(t),_memset=Module._memset=(t,e,r)=>(_memset=Module._memset=wasmExports.memset)(t,e,r),_memcpy=Module._memcpy=(t,e,r)=>(_memcpy=Module._memcpy=wasmExports.memcpy)(t,e,r),_ts_parser_delete=Module._ts_parser_delete=t=>(_ts_parser_delete=Module._ts_parser_delete=wasmExports.ts_parser_delete)(t),_ts_parser_reset=Module._ts_parser_reset=t=>(_ts_parser_reset=Module._ts_parser_reset=wasmExports.ts_parser_reset)(t),_ts_parser_set_language=Module._ts_parser_set_language=(t,e)=>(_ts_parser_set_language=Module._ts_parser_set_language=wasmExports.ts_parser_set_language)(t,e),_ts_parser_timeout_micros=Module._ts_parser_timeout_micros=t=>(_ts_parser_timeout_micros=Module._ts_parser_timeout_micros=wasmExports.ts_parser_timeout_micros)(t),_ts_parser_set_timeout_micros=Module._ts_parser_set_timeout_micros=(t,e,r)=>(_ts_parser_set_timeout_micros=Module._ts_parser_set_timeout_micros=wasmExports.ts_parser_set_timeout_micros)(t,e,r),_ts_parser_set_included_ranges=Module._ts_parser_set_included_ranges=(t,e,r)=>(_ts_parser_set_included_ranges=Module._ts_parser_set_included_ranges=wasmExports.ts_parser_set_included_ranges)(t,e,r),_memmove=Module._memmove=(t,e,r)=>(_memmove=Module._memmove=wasmExports.memmove)(t,e,r),_memcmp=Module._memcmp=(t,e,r)=>(_memcmp=Module._memcmp=wasmExports.memcmp)(t,e,r),_ts_query_new=Module._ts_query_new=(t,e,r,n,o)=>(_ts_query_new=Module._ts_query_new=wasmExports.ts_query_new)(t,e,r,n,o),_ts_query_delete=Module._ts_query_delete=t=>(_ts_query_delete=Module._ts_query_delete=wasmExports.ts_query_delete)(t),_iswspace=Module._iswspace=t=>(_iswspace=Module._iswspace=wasmExports.iswspace)(t),_iswalnum=Module._iswalnum=t=>(_iswalnum=Module._iswalnum=wasmExports.iswalnum)(t),_ts_query_pattern_count=Module._ts_query_pattern_count=t=>(_ts_query_pattern_count=Module._ts_query_pattern_count=wasmExports.ts_query_pattern_count)(t),_ts_query_capture_count=Module._ts_query_capture_count=t=>(_ts_query_capture_count=Module._ts_query_capture_count=wasmExports.ts_query_capture_count)(t),_ts_query_string_count=Module._ts_query_string_count=t=>(_ts_query_string_count=Module._ts_query_string_count=wasmExports.ts_query_string_count)(t),_ts_query_capture_name_for_id=Module._ts_query_capture_name_for_id=(t,e,r)=>(_ts_query_capture_name_for_id=Module._ts_query_capture_name_for_id=wasmExports.ts_query_capture_name_for_id)(t,e,r),_ts_query_string_value_for_id=Module._ts_query_string_value_for_id=(t,e,r)=>(_ts_query_string_value_for_id=Module._ts_query_string_value_for_id=wasmExports.ts_query_string_value_for_id)(t,e,r),_ts_query_predicates_for_pattern=Module._ts_query_predicates_for_pattern=(t,e,r)=>(_ts_query_predicates_for_pattern=Module._ts_query_predicates_for_pattern=wasmExports.ts_query_predicates_for_pattern)(t,e,r),_ts_query_disable_capture=Module._ts_query_disable_capture=(t,e,r)=>(_ts_query_disable_capture=Module._ts_query_disable_capture=wasmExports.ts_query_disable_capture)(t,e,r),_ts_tree_copy=Module._ts_tree_copy=t=>(_ts_tree_copy=Module._ts_tree_copy=wasmExports.ts_tree_copy)(t),_ts_tree_delete=Module._ts_tree_delete=t=>(_ts_tree_delete=Module._ts_tree_delete=wasmExports.ts_tree_delete)(t),_ts_init=Module._ts_init=()=>(_ts_init=Module._ts_init=wasmExports.ts_init)(),_ts_parser_new_wasm=Module._ts_parser_new_wasm=()=>(_ts_parser_new_wasm=Module._ts_parser_new_wasm=wasmExports.ts_parser_new_wasm)(),_ts_parser_enable_logger_wasm=Module._ts_parser_enable_logger_wasm=(t,e)=>(_ts_parser_enable_logger_wasm=Module._ts_parser_enable_logger_wasm=wasmExports.ts_parser_enable_logger_wasm)(t,e),_ts_parser_parse_wasm=Module._ts_parser_parse_wasm=(t,e,r,n,o)=>(_ts_parser_parse_wasm=Module._ts_parser_parse_wasm=wasmExports.ts_parser_parse_wasm)(t,e,r,n,o),_ts_parser_included_ranges_wasm=Module._ts_parser_included_ranges_wasm=t=>(_ts_parser_included_ranges_wasm=Module._ts_parser_included_ranges_wasm=wasmExports.ts_parser_included_ranges_wasm)(t),_ts_language_type_is_named_wasm=Module._ts_language_type_is_named_wasm=(t,e)=>(_ts_language_type_is_named_wasm=Module._ts_language_type_is_named_wasm=wasmExports.ts_language_type_is_named_wasm)(t,e),_ts_language_type_is_visible_wasm=Module._ts_language_type_is_visible_wasm=(t,e)=>(_ts_language_type_is_visible_wasm=Module._ts_language_type_is_visible_wasm=wasmExports.ts_language_type_is_visible_wasm)(t,e),_ts_tree_root_node_wasm=Module._ts_tree_root_node_wasm=t=>(_ts_tree_root_node_wasm=Module._ts_tree_root_node_wasm=wasmExports.ts_tree_root_node_wasm)(t),_ts_tree_root_node_with_offset_wasm=Module._ts_tree_root_node_with_offset_wasm=t=>(_ts_tree_root_node_with_offset_wasm=Module._ts_tree_root_node_with_offset_wasm=wasmExports.ts_tree_root_node_with_offset_wasm)(t),_ts_tree_edit_wasm=Module._ts_tree_edit_wasm=t=>(_ts_tree_edit_wasm=Module._ts_tree_edit_wasm=wasmExports.ts_tree_edit_wasm)(t),_ts_tree_included_ranges_wasm=Module._ts_tree_included_ranges_wasm=t=>(_ts_tree_included_ranges_wasm=Module._ts_tree_included_ranges_wasm=wasmExports.ts_tree_included_ranges_wasm)(t),_ts_tree_get_changed_ranges_wasm=Module._ts_tree_get_changed_ranges_wasm=(t,e)=>(_ts_tree_get_changed_ranges_wasm=Module._ts_tree_get_changed_ranges_wasm=wasmExports.ts_tree_get_changed_ranges_wasm)(t,e),_ts_tree_cursor_new_wasm=Module._ts_tree_cursor_new_wasm=t=>(_ts_tree_cursor_new_wasm=Module._ts_tree_cursor_new_wasm=wasmExports.ts_tree_cursor_new_wasm)(t),_ts_tree_cursor_delete_wasm=Module._ts_tree_cursor_delete_wasm=t=>(_ts_tree_cursor_delete_wasm=Module._ts_tree_cursor_delete_wasm=wasmExports.ts_tree_cursor_delete_wasm)(t),_ts_tree_cursor_reset_wasm=Module._ts_tree_cursor_reset_wasm=t=>(_ts_tree_cursor_reset_wasm=Module._ts_tree_cursor_reset_wasm=wasmExports.ts_tree_cursor_reset_wasm)(t),_ts_tree_cursor_reset_to_wasm=Module._ts_tree_cursor_reset_to_wasm=(t,e)=>(_ts_tree_cursor_reset_to_wasm=Module._ts_tree_cursor_reset_to_wasm=wasmExports.ts_tree_cursor_reset_to_wasm)(t,e),_ts_tree_cursor_goto_first_child_wasm=Module._ts_tree_cursor_goto_first_child_wasm=t=>(_ts_tree_cursor_goto_first_child_wasm=Module._ts_tree_cursor_goto_first_child_wasm=wasmExports.ts_tree_cursor_goto_first_child_wasm)(t),_ts_tree_cursor_goto_last_child_wasm=Module._ts_tree_cursor_goto_last_child_wasm=t=>(_ts_tree_cursor_goto_last_child_wasm=Module._ts_tree_cursor_goto_last_child_wasm=wasmExports.ts_tree_cursor_goto_last_child_wasm)(t),_ts_tree_cursor_goto_first_child_for_index_wasm=Module._ts_tree_cursor_goto_first_child_for_index_wasm=t=>(_ts_tree_cursor_goto_first_child_for_index_wasm=Module._ts_tree_cursor_goto_first_child_for_index_wasm=wasmExports.ts_tree_cursor_goto_first_child_for_index_wasm)(t),_ts_tree_cursor_goto_first_child_for_position_wasm=Module._ts_tree_cursor_goto_first_child_for_position_wasm=t=>(_ts_tree_cursor_goto_first_child_for_position_wasm=Module._ts_tree_cursor_goto_first_child_for_position_wasm=wasmExports.ts_tree_cursor_goto_first_child_for_position_wasm)(t),_ts_tree_cursor_goto_next_sibling_wasm=Module._ts_tree_cursor_goto_next_sibling_wasm=t=>(_ts_tree_cursor_goto_next_sibling_wasm=Module._ts_tree_cursor_goto_next_sibling_wasm=wasmExports.ts_tree_cursor_goto_next_sibling_wasm)(t),_ts_tree_cursor_goto_previous_sibling_wasm=Module._ts_tree_cursor_goto_previous_sibling_wasm=t=>(_ts_tree_cursor_goto_previous_sibling_wasm=Module._ts_tree_cursor_goto_previous_sibling_wasm=wasmExports.ts_tree_cursor_goto_previous_sibling_wasm)(t),_ts_tree_cursor_goto_descendant_wasm=Module._ts_tree_cursor_goto_descendant_wasm=(t,e)=>(_ts_tree_cursor_goto_descendant_wasm=Module._ts_tree_cursor_goto_descendant_wasm=wasmExports.ts_tree_cursor_goto_descendant_wasm)(t,e),_ts_tree_cursor_goto_parent_wasm=Module._ts_tree_cursor_goto_parent_wasm=t=>(_ts_tree_cursor_goto_parent_wasm=Module._ts_tree_cursor_goto_parent_wasm=wasmExports.ts_tree_cursor_goto_parent_wasm)(t),_ts_tree_cursor_current_node_type_id_wasm=Module._ts_tree_cursor_current_node_type_id_wasm=t=>(_ts_tree_cursor_current_node_type_id_wasm=Module._ts_tree_cursor_current_node_type_id_wasm=wasmExports.ts_tree_cursor_current_node_type_id_wasm)(t),_ts_tree_cursor_current_node_state_id_wasm=Module._ts_tree_cursor_current_node_state_id_wasm=t=>(_ts_tree_cursor_current_node_state_id_wasm=Module._ts_tree_cursor_current_node_state_id_wasm=wasmExports.ts_tree_cursor_current_node_state_id_wasm)(t),_ts_tree_cursor_current_node_is_named_wasm=Module._ts_tree_cursor_current_node_is_named_wasm=t=>(_ts_tree_cursor_current_node_is_named_wasm=Module._ts_tree_cursor_current_node_is_named_wasm=wasmExports.ts_tree_cursor_current_node_is_named_wasm)(t),_ts_tree_cursor_current_node_is_missing_wasm=Module._ts_tree_cursor_current_node_is_missing_wasm=t=>(_ts_tree_cursor_current_node_is_missing_wasm=Module._ts_tree_cursor_current_node_is_missing_wasm=wasmExports.ts_tree_cursor_current_node_is_missing_wasm)(t),_ts_tree_cursor_current_node_id_wasm=Module._ts_tree_cursor_current_node_id_wasm=t=>(_ts_tree_cursor_current_node_id_wasm=Module._ts_tree_cursor_current_node_id_wasm=wasmExports.ts_tree_cursor_current_node_id_wasm)(t),_ts_tree_cursor_start_position_wasm=Module._ts_tree_cursor_start_position_wasm=t=>(_ts_tree_cursor_start_position_wasm=Module._ts_tree_cursor_start_position_wasm=wasmExports.ts_tree_cursor_start_position_wasm)(t),_ts_tree_cursor_end_position_wasm=Module._ts_tree_cursor_end_position_wasm=t=>(_ts_tree_cursor_end_position_wasm=Module._ts_tree_cursor_end_position_wasm=wasmExports.ts_tree_cursor_end_position_wasm)(t),_ts_tree_cursor_start_index_wasm=Module._ts_tree_cursor_start_index_wasm=t=>(_ts_tree_cursor_start_index_wasm=Module._ts_tree_cursor_start_index_wasm=wasmExports.ts_tree_cursor_start_index_wasm)(t),_ts_tree_cursor_end_index_wasm=Module._ts_tree_cursor_end_index_wasm=t=>(_ts_tree_cursor_end_index_wasm=Module._ts_tree_cursor_end_index_wasm=wasmExports.ts_tree_cursor_end_index_wasm)(t),_ts_tree_cursor_current_field_id_wasm=Module._ts_tree_cursor_current_field_id_wasm=t=>(_ts_tree_cursor_current_field_id_wasm=Module._ts_tree_cursor_current_field_id_wasm=wasmExports.ts_tree_cursor_current_field_id_wasm)(t),_ts_tree_cursor_current_depth_wasm=Module._ts_tree_cursor_current_depth_wasm=t=>(_ts_tree_cursor_current_depth_wasm=Module._ts_tree_cursor_current_depth_wasm=wasmExports.ts_tree_cursor_current_depth_wasm)(t),_ts_tree_cursor_current_descendant_index_wasm=Module._ts_tree_cursor_current_descendant_index_wasm=t=>(_ts_tree_cursor_current_descendant_index_wasm=Module._ts_tree_cursor_current_descendant_index_wasm=wasmExports.ts_tree_cursor_current_descendant_index_wasm)(t),_ts_tree_cursor_current_node_wasm=Module._ts_tree_cursor_current_node_wasm=t=>(_ts_tree_cursor_current_node_wasm=Module._ts_tree_cursor_current_node_wasm=wasmExports.ts_tree_cursor_current_node_wasm)(t),_ts_node_symbol_wasm=Module._ts_node_symbol_wasm=t=>(_ts_node_symbol_wasm=Module._ts_node_symbol_wasm=wasmExports.ts_node_symbol_wasm)(t),_ts_node_field_name_for_child_wasm=Module._ts_node_field_name_for_child_wasm=(t,e)=>(_ts_node_field_name_for_child_wasm=Module._ts_node_field_name_for_child_wasm=wasmExports.ts_node_field_name_for_child_wasm)(t,e),_ts_node_children_by_field_id_wasm=Module._ts_node_children_by_field_id_wasm=(t,e)=>(_ts_node_children_by_field_id_wasm=Module._ts_node_children_by_field_id_wasm=wasmExports.ts_node_children_by_field_id_wasm)(t,e),_ts_node_first_child_for_byte_wasm=Module._ts_node_first_child_for_byte_wasm=t=>(_ts_node_first_child_for_byte_wasm=Module._ts_node_first_child_for_byte_wasm=wasmExports.ts_node_first_child_for_byte_wasm)(t),_ts_node_first_named_child_for_byte_wasm=Module._ts_node_first_named_child_for_byte_wasm=t=>(_ts_node_first_named_child_for_byte_wasm=Module._ts_node_first_named_child_for_byte_wasm=wasmExports.ts_node_first_named_child_for_byte_wasm)(t),_ts_node_grammar_symbol_wasm=Module._ts_node_grammar_symbol_wasm=t=>(_ts_node_grammar_symbol_wasm=Module._ts_node_grammar_symbol_wasm=wasmExports.ts_node_grammar_symbol_wasm)(t),_ts_node_child_count_wasm=Module._ts_node_child_count_wasm=t=>(_ts_node_child_count_wasm=Module._ts_node_child_count_wasm=wasmExports.ts_node_child_count_wasm)(t),_ts_node_named_child_count_wasm=Module._ts_node_named_child_count_wasm=t=>(_ts_node_named_child_count_wasm=Module._ts_node_named_child_count_wasm=wasmExports.ts_node_named_child_count_wasm)(t),_ts_node_child_wasm=Module._ts_node_child_wasm=(t,e)=>(_ts_node_child_wasm=Module._ts_node_child_wasm=wasmExports.ts_node_child_wasm)(t,e),_ts_node_named_child_wasm=Module._ts_node_named_child_wasm=(t,e)=>(_ts_node_named_child_wasm=Module._ts_node_named_child_wasm=wasmExports.ts_node_named_child_wasm)(t,e),_ts_node_child_by_field_id_wasm=Module._ts_node_child_by_field_id_wasm=(t,e)=>(_ts_node_child_by_field_id_wasm=Module._ts_node_child_by_field_id_wasm=wasmExports.ts_node_child_by_field_id_wasm)(t,e),_ts_node_next_sibling_wasm=Module._ts_node_next_sibling_wasm=t=>(_ts_node_next_sibling_wasm=Module._ts_node_next_sibling_wasm=wasmExports.ts_node_next_sibling_wasm)(t),_ts_node_prev_sibling_wasm=Module._ts_node_prev_sibling_wasm=t=>(_ts_node_prev_sibling_wasm=Module._ts_node_prev_sibling_wasm=wasmExports.ts_node_prev_sibling_wasm)(t),_ts_node_next_named_sibling_wasm=Module._ts_node_next_named_sibling_wasm=t=>(_ts_node_next_named_sibling_wasm=Module._ts_node_next_named_sibling_wasm=wasmExports.ts_node_next_named_sibling_wasm)(t),_ts_node_prev_named_sibling_wasm=Module._ts_node_prev_named_sibling_wasm=t=>(_ts_node_prev_named_sibling_wasm=Module._ts_node_prev_named_sibling_wasm=wasmExports.ts_node_prev_named_sibling_wasm)(t),_ts_node_descendant_count_wasm=Module._ts_node_descendant_count_wasm=t=>(_ts_node_descendant_count_wasm=Module._ts_node_descendant_count_wasm=wasmExports.ts_node_descendant_count_wasm)(t),_ts_node_parent_wasm=Module._ts_node_parent_wasm=t=>(_ts_node_parent_wasm=Module._ts_node_parent_wasm=wasmExports.ts_node_parent_wasm)(t),_ts_node_descendant_for_index_wasm=Module._ts_node_descendant_for_index_wasm=t=>(_ts_node_descendant_for_index_wasm=Module._ts_node_descendant_for_index_wasm=wasmExports.ts_node_descendant_for_index_wasm)(t),_ts_node_named_descendant_for_index_wasm=Module._ts_node_named_descendant_for_index_wasm=t=>(_ts_node_named_descendant_for_index_wasm=Module._ts_node_named_descendant_for_index_wasm=wasmExports.ts_node_named_descendant_for_index_wasm)(t),_ts_node_descendant_for_position_wasm=Module._ts_node_descendant_for_position_wasm=t=>(_ts_node_descendant_for_position_wasm=Module._ts_node_descendant_for_position_wasm=wasmExports.ts_node_descendant_for_position_wasm)(t),_ts_node_named_descendant_for_position_wasm=Module._ts_node_named_descendant_for_position_wasm=t=>(_ts_node_named_descendant_for_position_wasm=Module._ts_node_named_descendant_for_position_wasm=wasmExports.ts_node_named_descendant_for_position_wasm)(t),_ts_node_start_point_wasm=Module._ts_node_start_point_wasm=t=>(_ts_node_start_point_wasm=Module._ts_node_start_point_wasm=wasmExports.ts_node_start_point_wasm)(t),_ts_node_end_point_wasm=Module._ts_node_end_point_wasm=t=>(_ts_node_end_point_wasm=Module._ts_node_end_point_wasm=wasmExports.ts_node_end_point_wasm)(t),_ts_node_start_index_wasm=Module._ts_node_start_index_wasm=t=>(_ts_node_start_index_wasm=Module._ts_node_start_index_wasm=wasmExports.ts_node_start_index_wasm)(t),_ts_node_end_index_wasm=Module._ts_node_end_index_wasm=t=>(_ts_node_end_index_wasm=Module._ts_node_end_index_wasm=wasmExports.ts_node_end_index_wasm)(t),_ts_node_to_string_wasm=Module._ts_node_to_string_wasm=t=>(_ts_node_to_string_wasm=Module._ts_node_to_string_wasm=wasmExports.ts_node_to_string_wasm)(t),_ts_node_children_wasm=Module._ts_node_children_wasm=t=>(_ts_node_children_wasm=Module._ts_node_children_wasm=wasmExports.ts_node_children_wasm)(t),_ts_node_named_children_wasm=Module._ts_node_named_children_wasm=t=>(_ts_node_named_children_wasm=Module._ts_node_named_children_wasm=wasmExports.ts_node_named_children_wasm)(t),_ts_node_descendants_of_type_wasm=Module._ts_node_descendants_of_type_wasm=(t,e,r,n,o,s,a)=>(_ts_node_descendants_of_type_wasm=Module._ts_node_descendants_of_type_wasm=wasmExports.ts_node_descendants_of_type_wasm)(t,e,r,n,o,s,a),_ts_node_is_named_wasm=Module._ts_node_is_named_wasm=t=>(_ts_node_is_named_wasm=Module._ts_node_is_named_wasm=wasmExports.ts_node_is_named_wasm)(t),_ts_node_has_changes_wasm=Module._ts_node_has_changes_wasm=t=>(_ts_node_has_changes_wasm=Module._ts_node_has_changes_wasm=wasmExports.ts_node_has_changes_wasm)(t),_ts_node_has_error_wasm=Module._ts_node_has_error_wasm=t=>(_ts_node_has_error_wasm=Module._ts_node_has_error_wasm=wasmExports.ts_node_has_error_wasm)(t),_ts_node_is_error_wasm=Module._ts_node_is_error_wasm=t=>(_ts_node_is_error_wasm=Module._ts_node_is_error_wasm=wasmExports.ts_node_is_error_wasm)(t),_ts_node_is_missing_wasm=Module._ts_node_is_missing_wasm=t=>(_ts_node_is_missing_wasm=Module._ts_node_is_missing_wasm=wasmExports.ts_node_is_missing_wasm)(t),_ts_node_is_extra_wasm=Module._ts_node_is_extra_wasm=t=>(_ts_node_is_extra_wasm=Module._ts_node_is_extra_wasm=wasmExports.ts_node_is_extra_wasm)(t),_ts_node_parse_state_wasm=Module._ts_node_parse_state_wasm=t=>(_ts_node_parse_state_wasm=Module._ts_node_parse_state_wasm=wasmExports.ts_node_parse_state_wasm)(t),_ts_node_next_parse_state_wasm=Module._ts_node_next_parse_state_wasm=t=>(_ts_node_next_parse_state_wasm=Module._ts_node_next_parse_state_wasm=wasmExports.ts_node_next_parse_state_wasm)(t),_ts_query_matches_wasm=Module._ts_query_matches_wasm=(t,e,r,n,o,s,a,c,u,l)=>(_ts_query_matches_wasm=Module._ts_query_matches_wasm=wasmExports.ts_query_matches_wasm)(t,e,r,n,o,s,a,c,u,l),_ts_query_captures_wasm=Module._ts_query_captures_wasm=(t,e,r,n,o,s,a,c,u,l)=>(_ts_query_captures_wasm=Module._ts_query_captures_wasm=wasmExports.ts_query_captures_wasm)(t,e,r,n,o,s,a,c,u,l),_iswalpha=Module._iswalpha=t=>(_iswalpha=Module._iswalpha=wasmExports.iswalpha)(t),_iswblank=Module._iswblank=t=>(_iswblank=Module._iswblank=wasmExports.iswblank)(t),_iswdigit=Module._iswdigit=t=>(_iswdigit=Module._iswdigit=wasmExports.iswdigit)(t),_iswlower=Module._iswlower=t=>(_iswlower=Module._iswlower=wasmExports.iswlower)(t),_iswupper=Module._iswupper=t=>(_iswupper=Module._iswupper=wasmExports.iswupper)(t),_iswxdigit=Module._iswxdigit=t=>(_iswxdigit=Module._iswxdigit=wasmExports.iswxdigit)(t),_memchr=Module._memchr=(t,e,r)=>(_memchr=Module._memchr=wasmExports.memchr)(t,e,r),_strlen=Module._strlen=t=>(_strlen=Module._strlen=wasmExports.strlen)(t),_strcmp=Module._strcmp=(t,e)=>(_strcmp=Module._strcmp=wasmExports.strcmp)(t,e),_strncat=Module._strncat=(t,e,r)=>(_strncat=Module._strncat=wasmExports.strncat)(t,e,r),_strncpy=Module._strncpy=(t,e,r)=>(_strncpy=Module._strncpy=wasmExports.strncpy)(t,e,r),_towlower=Module._towlower=t=>(_towlower=Module._towlower=wasmExports.towlower)(t),_towupper=Module._towupper=t=>(_towupper=Module._towupper=wasmExports.towupper)(t),_setThrew=(t,e)=>(_setThrew=wasmExports.setThrew)(t,e),stackSave=()=>(stackSave=wasmExports.stackSave)(),stackRestore=t=>(stackRestore=wasmExports.stackRestore)(t),stackAlloc=t=>(stackAlloc=wasmExports.stackAlloc)(t),dynCall_jiji=Module.dynCall_jiji=(t,e,r,n,o)=>(dynCall_jiji=Module.dynCall_jiji=wasmExports.dynCall_jiji)(t,e,r,n,o),_orig$ts_parser_timeout_micros=Module._orig$ts_parser_timeout_micros=t=>(_orig$ts_parser_timeout_micros=Module._orig$ts_parser_timeout_micros=wasmExports.orig$ts_parser_timeout_micros)(t),_orig$ts_parser_set_timeout_micros=Module._orig$ts_parser_set_timeout_micros=(t,e)=>(_orig$ts_parser_set_timeout_micros=Module._orig$ts_parser_set_timeout_micros=wasmExports.orig$ts_parser_set_timeout_micros)(t,e),calledRun;function callMain(t=[]){var e=resolveGlobalSymbol("main").sym;if(e){t.unshift(thisProgram);var r=t.length,n=stackAlloc(4*(r+1)),o=n;t.forEach(a=>{HEAPU32[o>>2]=stringToUTF8OnStack(a),o+=4}),HEAPU32[o>>2]=0;try{var s=e(r,n);return exitJS(s,!0),s}catch(a){return handleException(a)}}}function run(t=arguments_){function e(){calledRun||(calledRun=!0,Module.calledRun=!0,ABORT||(initRuntime(),preMain(),Module.onRuntimeInitialized&&Module.onRuntimeInitialized(),shouldRunNow&&callMain(t),postRun()))}runDependencies>0||(preRun(),runDependencies>0||(Module.setStatus?(Module.setStatus("Running..."),setTimeout(function(){setTimeout(function(){Module.setStatus("")},1),e()},1)):e()))}if(Module.AsciiToString=AsciiToString,Module.stringToUTF16=stringToUTF16,dependenciesFulfilled=function t(){calledRun||run(),calledRun||(dependenciesFulfilled=t)},Module.preInit)for(typeof Module.preInit=="function"&&(Module.preInit=[Module.preInit]);Module.preInit.length>0;)Module.preInit.pop()();var shouldRunNow=!0;Module.noInitialRun&&(shouldRunNow=!1),run();let C=Module,INTERNAL={},SIZE_OF_INT=4,SIZE_OF_CURSOR=4*SIZE_OF_INT,SIZE_OF_NODE=5*SIZE_OF_INT,SIZE_OF_POINT=2*SIZE_OF_INT,SIZE_OF_RANGE=2*SIZE_OF_INT+2*SIZE_OF_POINT,ZERO_POINT={row:0,column:0},QUERY_WORD_REGEX=/[\w-.]*/g,PREDICATE_STEP_TYPE_CAPTURE=1,PREDICATE_STEP_TYPE_STRING=2,LANGUAGE_FUNCTION_REGEX=/^_?tree_sitter_\w+/,VERSION,MIN_COMPATIBLE_VERSION,TRANSFER_BUFFER,currentParseCallback,currentLogCallback;class ParserImpl{static init(){TRANSFER_BUFFER=C._ts_init(),VERSION=getValue(TRANSFER_BUFFER,"i32"),MIN_COMPATIBLE_VERSION=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32")}initialize(){C._ts_parser_new_wasm(),this[0]=getValue(TRANSFER_BUFFER,"i32"),this[1]=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32")}delete(){C._ts_parser_delete(this[0]),C._free(this[1]),this[0]=0,this[1]=0}setLanguage(e){let r;if(e){if(e.constructor!==Language)throw new Error("Argument must be a Language");{r=e[0];let n=C._ts_language_version(r);if(n<MIN_COMPATIBLE_VERSION||VERSION<n)throw new Error(`Incompatible language version ${n}. Compatibility range ${MIN_COMPATIBLE_VERSION} through ${VERSION}.`)}}else r=0,e=null;return this.language=e,C._ts_parser_set_language(this[0],r),this}getLanguage(){return this.language}parse(e,r,n){if(typeof e=="string")currentParseCallback=(u,l)=>e.slice(u);else{if(typeof e!="function")throw new Error("Argument must be a string or a function");currentParseCallback=e}this.logCallback?(currentLogCallback=this.logCallback,C._ts_parser_enable_logger_wasm(this[0],1)):(currentLogCallback=null,C._ts_parser_enable_logger_wasm(this[0],0));let o=0,s=0;if(n?.includedRanges){o=n.includedRanges.length,s=C._calloc(o,SIZE_OF_RANGE);let u=s;for(let l=0;l<o;l++)marshalRange(u,n.includedRanges[l]),u+=SIZE_OF_RANGE}let a=C._ts_parser_parse_wasm(this[0],this[1],r?r[0]:0,s,o);if(!a)throw currentParseCallback=null,currentLogCallback=null,new Error("Parsing failed");let c=new Tree(INTERNAL,a,this.language,currentParseCallback);return currentParseCallback=null,currentLogCallback=null,c}reset(){C._ts_parser_reset(this[0])}getIncludedRanges(){C._ts_parser_included_ranges_wasm(this[0]);let e=getValue(TRANSFER_BUFFER,"i32"),r=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),n=new Array(e);if(e>0){let o=r;for(let s=0;s<e;s++)n[s]=unmarshalRange(o),o+=SIZE_OF_RANGE;C._free(r)}return n}getTimeoutMicros(){return C._ts_parser_timeout_micros(this[0])}setTimeoutMicros(e){C._ts_parser_set_timeout_micros(this[0],e)}setLogger(e){if(e){if(typeof e!="function")throw new Error("Logger callback must be a function")}else e=null;return this.logCallback=e,this}getLogger(){return this.logCallback}}class Tree{constructor(e,r,n,o){assertInternal(e),this[0]=r,this.language=n,this.textCallback=o}copy(){let e=C._ts_tree_copy(this[0]);return new Tree(INTERNAL,e,this.language,this.textCallback)}delete(){C._ts_tree_delete(this[0]),this[0]=0}edit(e){marshalEdit(e),C._ts_tree_edit_wasm(this[0])}get rootNode(){return C._ts_tree_root_node_wasm(this[0]),unmarshalNode(this)}rootNodeWithOffset(e,r){let n=TRANSFER_BUFFER+SIZE_OF_NODE;return setValue(n,e,"i32"),marshalPoint(n+SIZE_OF_INT,r),C._ts_tree_root_node_with_offset_wasm(this[0]),unmarshalNode(this)}getLanguage(){return this.language}walk(){return this.rootNode.walk()}getChangedRanges(e){if(e.constructor!==Tree)throw new TypeError("Argument must be a Tree");C._ts_tree_get_changed_ranges_wasm(this[0],e[0]);let r=getValue(TRANSFER_BUFFER,"i32"),n=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),o=new Array(r);if(r>0){let s=n;for(let a=0;a<r;a++)o[a]=unmarshalRange(s),s+=SIZE_OF_RANGE;C._free(n)}return o}getIncludedRanges(){C._ts_tree_included_ranges_wasm(this[0]);let e=getValue(TRANSFER_BUFFER,"i32"),r=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),n=new Array(e);if(e>0){let o=r;for(let s=0;s<e;s++)n[s]=unmarshalRange(o),o+=SIZE_OF_RANGE;C._free(r)}return n}}class Node{constructor(e,r){assertInternal(e),this.tree=r}get typeId(){return marshalNode(this),C._ts_node_symbol_wasm(this.tree[0])}get grammarId(){return marshalNode(this),C._ts_node_grammar_symbol_wasm(this.tree[0])}get type(){return this.tree.language.types[this.typeId]||"ERROR"}get grammarType(){return this.tree.language.types[this.grammarId]||"ERROR"}get endPosition(){return marshalNode(this),C._ts_node_end_point_wasm(this.tree[0]),unmarshalPoint(TRANSFER_BUFFER)}get endIndex(){return marshalNode(this),C._ts_node_end_index_wasm(this.tree[0])}get text(){return getText(this.tree,this.startIndex,this.endIndex)}get parseState(){return marshalNode(this),C._ts_node_parse_state_wasm(this.tree[0])}get nextParseState(){return marshalNode(this),C._ts_node_next_parse_state_wasm(this.tree[0])}get isNamed(){return marshalNode(this),C._ts_node_is_named_wasm(this.tree[0])===1}get hasError(){return marshalNode(this),C._ts_node_has_error_wasm(this.tree[0])===1}get hasChanges(){return marshalNode(this),C._ts_node_has_changes_wasm(this.tree[0])===1}get isError(){return marshalNode(this),C._ts_node_is_error_wasm(this.tree[0])===1}get isMissing(){return marshalNode(this),C._ts_node_is_missing_wasm(this.tree[0])===1}get isExtra(){return marshalNode(this),C._ts_node_is_extra_wasm(this.tree[0])===1}equals(e){return this.id===e.id}child(e){return marshalNode(this),C._ts_node_child_wasm(this.tree[0],e),unmarshalNode(this.tree)}namedChild(e){return marshalNode(this),C._ts_node_named_child_wasm(this.tree[0],e),unmarshalNode(this.tree)}childForFieldId(e){return marshalNode(this),C._ts_node_child_by_field_id_wasm(this.tree[0],e),unmarshalNode(this.tree)}childForFieldName(e){let r=this.tree.language.fields.indexOf(e);return r!==-1?this.childForFieldId(r):null}fieldNameForChild(e){marshalNode(this);let r=C._ts_node_field_name_for_child_wasm(this.tree[0],e);return r?AsciiToString(r):null}childrenForFieldName(e){let r=this.tree.language.fields.indexOf(e);return r!==-1&&r!==0?this.childrenForFieldId(r):[]}childrenForFieldId(e){marshalNode(this),C._ts_node_children_by_field_id_wasm(this.tree[0],e);let r=getValue(TRANSFER_BUFFER,"i32"),n=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),o=new Array(r);if(r>0){let s=n;for(let a=0;a<r;a++)o[a]=unmarshalNode(this.tree,s),s+=SIZE_OF_NODE;C._free(n)}return o}firstChildForIndex(e){return marshalNode(this),setValue(TRANSFER_BUFFER+SIZE_OF_NODE,e,"i32"),C._ts_node_first_child_for_byte_wasm(this.tree[0]),unmarshalNode(this.tree)}firstNamedChildForIndex(e){return marshalNode(this),setValue(TRANSFER_BUFFER+SIZE_OF_NODE,e,"i32"),C._ts_node_first_named_child_for_byte_wasm(this.tree[0]),unmarshalNode(this.tree)}get childCount(){return marshalNode(this),C._ts_node_child_count_wasm(this.tree[0])}get namedChildCount(){return marshalNode(this),C._ts_node_named_child_count_wasm(this.tree[0])}get firstChild(){return this.child(0)}get firstNamedChild(){return this.namedChild(0)}get lastChild(){return this.child(this.childCount-1)}get lastNamedChild(){return this.namedChild(this.namedChildCount-1)}get children(){if(!this._children){marshalNode(this),C._ts_node_children_wasm(this.tree[0]);let e=getValue(TRANSFER_BUFFER,"i32"),r=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32");if(this._children=new Array(e),e>0){let n=r;for(let o=0;o<e;o++)this._children[o]=unmarshalNode(this.tree,n),n+=SIZE_OF_NODE;C._free(r)}}return this._children}get namedChildren(){if(!this._namedChildren){marshalNode(this),C._ts_node_named_children_wasm(this.tree[0]);let e=getValue(TRANSFER_BUFFER,"i32"),r=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32");if(this._namedChildren=new Array(e),e>0){let n=r;for(let o=0;o<e;o++)this._namedChildren[o]=unmarshalNode(this.tree,n),n+=SIZE_OF_NODE;C._free(r)}}return this._namedChildren}descendantsOfType(e,r,n){Array.isArray(e)||(e=[e]),r||(r=ZERO_POINT),n||(n=ZERO_POINT);let o=[],s=this.tree.language.types;for(let d=0,p=s.length;d<p;d++)e.includes(s[d])&&o.push(d);let a=C._malloc(SIZE_OF_INT*o.length);for(let d=0,p=o.length;d<p;d++)setValue(a+d*SIZE_OF_INT,o[d],"i32");marshalNode(this),C._ts_node_descendants_of_type_wasm(this.tree[0],a,o.length,r.row,r.column,n.row,n.column);let c=getValue(TRANSFER_BUFFER,"i32"),u=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),l=new Array(c);if(c>0){let d=u;for(let p=0;p<c;p++)l[p]=unmarshalNode(this.tree,d),d+=SIZE_OF_NODE}return C._free(u),C._free(a),l}get nextSibling(){return marshalNode(this),C._ts_node_next_sibling_wasm(this.tree[0]),unmarshalNode(this.tree)}get previousSibling(){return marshalNode(this),C._ts_node_prev_sibling_wasm(this.tree[0]),unmarshalNode(this.tree)}get nextNamedSibling(){return marshalNode(this),C._ts_node_next_named_sibling_wasm(this.tree[0]),unmarshalNode(this.tree)}get previousNamedSibling(){return marshalNode(this),C._ts_node_prev_named_sibling_wasm(this.tree[0]),unmarshalNode(this.tree)}get descendantCount(){return marshalNode(this),C._ts_node_descendant_count_wasm(this.tree[0])}get parent(){return marshalNode(this),C._ts_node_parent_wasm(this.tree[0]),unmarshalNode(this.tree)}descendantForIndex(e,r=e){if(typeof e!="number"||typeof r!="number")throw new Error("Arguments must be numbers");marshalNode(this);let n=TRANSFER_BUFFER+SIZE_OF_NODE;return setValue(n,e,"i32"),setValue(n+SIZE_OF_INT,r,"i32"),C._ts_node_descendant_for_index_wasm(this.tree[0]),unmarshalNode(this.tree)}namedDescendantForIndex(e,r=e){if(typeof e!="number"||typeof r!="number")throw new Error("Arguments must be numbers");marshalNode(this);let n=TRANSFER_BUFFER+SIZE_OF_NODE;return setValue(n,e,"i32"),setValue(n+SIZE_OF_INT,r,"i32"),C._ts_node_named_descendant_for_index_wasm(this.tree[0]),unmarshalNode(this.tree)}descendantForPosition(e,r=e){if(!isPoint(e)||!isPoint(r))throw new Error("Arguments must be {row, column} objects");marshalNode(this);let n=TRANSFER_BUFFER+SIZE_OF_NODE;return marshalPoint(n,e),marshalPoint(n+SIZE_OF_POINT,r),C._ts_node_descendant_for_position_wasm(this.tree[0]),unmarshalNode(this.tree)}namedDescendantForPosition(e,r=e){if(!isPoint(e)||!isPoint(r))throw new Error("Arguments must be {row, column} objects");marshalNode(this);let n=TRANSFER_BUFFER+SIZE_OF_NODE;return marshalPoint(n,e),marshalPoint(n+SIZE_OF_POINT,r),C._ts_node_named_descendant_for_position_wasm(this.tree[0]),unmarshalNode(this.tree)}walk(){return marshalNode(this),C._ts_tree_cursor_new_wasm(this.tree[0]),new TreeCursor(INTERNAL,this.tree)}toString(){marshalNode(this);let e=C._ts_node_to_string_wasm(this.tree[0]),r=AsciiToString(e);return C._free(e),r}}class TreeCursor{constructor(e,r){assertInternal(e),this.tree=r,unmarshalTreeCursor(this)}delete(){marshalTreeCursor(this),C._ts_tree_cursor_delete_wasm(this.tree[0]),this[0]=this[1]=this[2]=0}reset(e){marshalNode(e),marshalTreeCursor(this,TRANSFER_BUFFER+SIZE_OF_NODE),C._ts_tree_cursor_reset_wasm(this.tree[0]),unmarshalTreeCursor(this)}resetTo(e){marshalTreeCursor(this,TRANSFER_BUFFER),marshalTreeCursor(e,TRANSFER_BUFFER+SIZE_OF_CURSOR),C._ts_tree_cursor_reset_to_wasm(this.tree[0],e.tree[0]),unmarshalTreeCursor(this)}get nodeType(){return this.tree.language.types[this.nodeTypeId]||"ERROR"}get nodeTypeId(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_type_id_wasm(this.tree[0])}get nodeStateId(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_state_id_wasm(this.tree[0])}get nodeId(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_id_wasm(this.tree[0])}get nodeIsNamed(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_is_named_wasm(this.tree[0])===1}get nodeIsMissing(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_is_missing_wasm(this.tree[0])===1}get nodeText(){marshalTreeCursor(this);let e=C._ts_tree_cursor_start_index_wasm(this.tree[0]),r=C._ts_tree_cursor_end_index_wasm(this.tree[0]);return getText(this.tree,e,r)}get startPosition(){return marshalTreeCursor(this),C._ts_tree_cursor_start_position_wasm(this.tree[0]),unmarshalPoint(TRANSFER_BUFFER)}get endPosition(){return marshalTreeCursor(this),C._ts_tree_cursor_end_position_wasm(this.tree[0]),unmarshalPoint(TRANSFER_BUFFER)}get startIndex(){return marshalTreeCursor(this),C._ts_tree_cursor_start_index_wasm(this.tree[0])}get endIndex(){return marshalTreeCursor(this),C._ts_tree_cursor_end_index_wasm(this.tree[0])}get currentNode(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_wasm(this.tree[0]),unmarshalNode(this.tree)}get currentFieldId(){return marshalTreeCursor(this),C._ts_tree_cursor_current_field_id_wasm(this.tree[0])}get currentFieldName(){return this.tree.language.fields[this.currentFieldId]}get currentDepth(){return marshalTreeCursor(this),C._ts_tree_cursor_current_depth_wasm(this.tree[0])}get currentDescendantIndex(){return marshalTreeCursor(this),C._ts_tree_cursor_current_descendant_index_wasm(this.tree[0])}gotoFirstChild(){marshalTreeCursor(this);let e=C._ts_tree_cursor_goto_first_child_wasm(this.tree[0]);return unmarshalTreeCursor(this),e===1}gotoLastChild(){marshalTreeCursor(this);let e=C._ts_tree_cursor_goto_last_child_wasm(this.tree[0]);return unmarshalTreeCursor(this),e===1}gotoFirstChildForIndex(e){marshalTreeCursor(this),setValue(TRANSFER_BUFFER+SIZE_OF_CURSOR,e,"i32");let r=C._ts_tree_cursor_goto_first_child_for_index_wasm(this.tree[0]);return unmarshalTreeCursor(this),r===1}gotoFirstChildForPosition(e){marshalTreeCursor(this),marshalPoint(TRANSFER_BUFFER+SIZE_OF_CURSOR,e);let r=C._ts_tree_cursor_goto_first_child_for_position_wasm(this.tree[0]);return unmarshalTreeCursor(this),r===1}gotoNextSibling(){marshalTreeCursor(this);let e=C._ts_tree_cursor_goto_next_sibling_wasm(this.tree[0]);return unmarshalTreeCursor(this),e===1}gotoPreviousSibling(){marshalTreeCursor(this);let e=C._ts_tree_cursor_goto_previous_sibling_wasm(this.tree[0]);return unmarshalTreeCursor(this),e===1}gotoDescendant(e){marshalTreeCursor(this),C._ts_tree_cursor_goto_descendant_wasm(this.tree[0],e),unmarshalTreeCursor(this)}gotoParent(){marshalTreeCursor(this);let e=C._ts_tree_cursor_goto_parent_wasm(this.tree[0]);return unmarshalTreeCursor(this),e===1}}class Language{constructor(e,r){assertInternal(e),this[0]=r,this.types=new Array(C._ts_language_symbol_count(this[0]));for(let n=0,o=this.types.length;n<o;n++)C._ts_language_symbol_type(this[0],n)<2&&(this.types[n]=UTF8ToString(C._ts_language_symbol_name(this[0],n)));this.fields=new Array(C._ts_language_field_count(this[0])+1);for(let n=0,o=this.fields.length;n<o;n++){let s=C._ts_language_field_name_for_id(this[0],n);this.fields[n]=s!==0?UTF8ToString(s):null}}get version(){return C._ts_language_version(this[0])}get fieldCount(){return this.fields.length-1}get stateCount(){return C._ts_language_state_count(this[0])}fieldIdForName(e){let r=this.fields.indexOf(e);return r!==-1?r:null}fieldNameForId(e){return this.fields[e]||null}idForNodeType(e,r){let n=lengthBytesUTF8(e),o=C._malloc(n+1);stringToUTF8(e,o,n+1);let s=C._ts_language_symbol_for_name(this[0],o,n,r);return C._free(o),s||null}get nodeTypeCount(){return C._ts_language_symbol_count(this[0])}nodeTypeForId(e){let r=C._ts_language_symbol_name(this[0],e);return r?UTF8ToString(r):null}nodeTypeIsNamed(e){return!!C._ts_language_type_is_named_wasm(this[0],e)}nodeTypeIsVisible(e){return!!C._ts_language_type_is_visible_wasm(this[0],e)}nextState(e,r){return C._ts_language_next_state(this[0],e,r)}lookaheadIterator(e){let r=C._ts_lookahead_iterator_new(this[0],e);return r?new LookaheadIterable(INTERNAL,r,this):null}query(e){let r=lengthBytesUTF8(e),n=C._malloc(r+1);stringToUTF8(e,n,r+1);let o=C._ts_query_new(this[0],n,r,TRANSFER_BUFFER,TRANSFER_BUFFER+SIZE_OF_INT);if(!o){let g=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),v=getValue(TRANSFER_BUFFER,"i32"),y=UTF8ToString(n,v).length,_=e.substr(y,100).split(`
`)[0],b,S=_.match(QUERY_WORD_REGEX)[0];switch(g){case 2:b=new RangeError(`Bad node name '${S}'`);break;case 3:b=new RangeError(`Bad field name '${S}'`);break;case 4:b=new RangeError(`Bad capture name @${S}`);break;case 5:b=new TypeError(`Bad pattern structure at offset ${y}: '${_}'...`),S="";break;default:b=new SyntaxError(`Bad syntax at offset ${y}: '${_}'...`),S=""}throw b.index=y,b.length=S.length,C._free(n),b}let s=C._ts_query_string_count(o),a=C._ts_query_capture_count(o),c=C._ts_query_pattern_count(o),u=new Array(a),l=new Array(s);for(let g=0;g<a;g++){let v=C._ts_query_capture_name_for_id(o,g,TRANSFER_BUFFER),y=getValue(TRANSFER_BUFFER,"i32");u[g]=UTF8ToString(v,y)}for(let g=0;g<s;g++){let v=C._ts_query_string_value_for_id(o,g,TRANSFER_BUFFER),y=getValue(TRANSFER_BUFFER,"i32");l[g]=UTF8ToString(v,y)}let d=new Array(c),p=new Array(c),f=new Array(c),m=new Array(c),h=new Array(c);for(let g=0;g<c;g++){let v=C._ts_query_predicates_for_pattern(o,g,TRANSFER_BUFFER),y=getValue(TRANSFER_BUFFER,"i32");m[g]=[],h[g]=[];let _=[],b=v;for(let S=0;S<y;S++){let I=getValue(b,"i32");b+=SIZE_OF_INT;let w=getValue(b,"i32");if(b+=SIZE_OF_INT,I===PREDICATE_STEP_TYPE_CAPTURE)_.push({type:"capture",name:u[w]});else if(I===PREDICATE_STEP_TYPE_STRING)_.push({type:"string",value:l[w]});else if(_.length>0){if(_[0].type!=="string")throw new Error("Predicates must begin with a literal value");let O=_[0].value,U,z=!0,M=!0;switch(O){case"any-not-eq?":case"not-eq?":z=!1;case"any-eq?":case"eq?":if(_.length!==3)throw new Error(`Wrong number of arguments to \`#${O}\` predicate. Expected 2, got ${_.length-1}`);if(_[1].type!=="capture")throw new Error(`First argument of \`#${O}\` predicate must be a capture. Got "${_[1].value}"`);if(M=!O.startsWith("any-"),_[2].type==="capture"){let E=_[1].name,P=_[2].name;h[g].push(q=>{let F=[],Z=[];for(let te of q)te.name===E&&F.push(te.node),te.name===P&&Z.push(te.node);let ue=(te,Q,je)=>je?te.text===Q.text:te.text!==Q.text;return M?F.every(te=>Z.some(Q=>ue(te,Q,z))):F.some(te=>Z.some(Q=>ue(te,Q,z)))})}else{U=_[1].name;let E=_[2].value,P=F=>F.text===E,q=F=>F.text!==E;h[g].push(F=>{let Z=[];for(let te of F)te.name===U&&Z.push(te.node);let ue=z?P:q;return M?Z.every(ue):Z.some(ue)})}break;case"any-not-match?":case"not-match?":z=!1;case"any-match?":case"match?":if(_.length!==3)throw new Error(`Wrong number of arguments to \`#${O}\` predicate. Expected 2, got ${_.length-1}.`);if(_[1].type!=="capture")throw new Error(`First argument of \`#${O}\` predicate must be a capture. Got "${_[1].value}".`);if(_[2].type!=="string")throw new Error(`Second argument of \`#${O}\` predicate must be a string. Got @${_[2].value}.`);U=_[1].name;let re=new RegExp(_[2].value);M=!O.startsWith("any-"),h[g].push(E=>{let P=[];for(let F of E)F.name===U&&P.push(F.node.text);let q=(F,Z)=>Z?re.test(F):!re.test(F);return P.length===0?!z:M?P.every(F=>q(F,z)):P.some(F=>q(F,z))});break;case"set!":if(_.length<2||_.length>3)throw new Error(`Wrong number of arguments to \`#set!\` predicate. Expected 1 or 2. Got ${_.length-1}.`);if(_.some(E=>E.type!=="string"))throw new Error('Arguments to `#set!` predicate must be a strings.".');d[g]||(d[g]={}),d[g][_[1].value]=_[2]?_[2].value:null;break;case"is?":case"is-not?":if(_.length<2||_.length>3)throw new Error(`Wrong number of arguments to \`#${O}\` predicate. Expected 1 or 2. Got ${_.length-1}.`);if(_.some(E=>E.type!=="string"))throw new Error(`Arguments to \`#${O}\` predicate must be a strings.".`);let ee=O==="is?"?p:f;ee[g]||(ee[g]={}),ee[g][_[1].value]=_[2]?_[2].value:null;break;case"not-any-of?":z=!1;case"any-of?":if(_.length<2)throw new Error(`Wrong number of arguments to \`#${O}\` predicate. Expected at least 1. Got ${_.length-1}.`);if(_[1].type!=="capture")throw new Error(`First argument of \`#${O}\` predicate must be a capture. Got "${_[1].value}".`);for(let E=2;E<_.length;E++)if(_[E].type!=="string")throw new Error(`Arguments to \`#${O}\` predicate must be a strings.".`);U=_[1].name;let N=_.slice(2).map(E=>E.value);h[g].push(E=>{let P=[];for(let q of E)q.name===U&&P.push(q.node.text);return P.length===0?!z:P.every(q=>N.includes(q))===z});break;default:m[g].push({operator:O,operands:_.slice(1)})}_.length=0}}Object.freeze(d[g]),Object.freeze(p[g]),Object.freeze(f[g])}return C._free(n),new Query(INTERNAL,o,u,h,m,Object.freeze(d),Object.freeze(p),Object.freeze(f))}static load(e){let r;if(e instanceof Uint8Array)r=Promise.resolve(e);else{let n=e;if(typeof process<"u"&&process.versions&&process.versions.node){let o=require("fs");r=Promise.resolve(o.readFileSync(n))}else r=fetch(n).then(o=>o.arrayBuffer().then(s=>{if(o.ok)return new Uint8Array(s);{let a=new TextDecoder("utf-8").decode(s);throw new Error(`Language.load failed with status ${o.status}.

${a}`)}}))}return r.then(n=>loadWebAssemblyModule(n,{loadAsync:!0})).then(n=>{let o=Object.keys(n),s=o.find(c=>LANGUAGE_FUNCTION_REGEX.test(c)&&!c.includes("external_scanner_"));s||console.log(`Couldn't find language function in WASM file. Symbols:
${JSON.stringify(o,null,2)}`);let a=n[s]();return new Language(INTERNAL,a)})}}class LookaheadIterable{constructor(e,r,n){assertInternal(e),this[0]=r,this.language=n}get currentTypeId(){return C._ts_lookahead_iterator_current_symbol(this[0])}get currentType(){return this.language.types[this.currentTypeId]||"ERROR"}delete(){C._ts_lookahead_iterator_delete(this[0]),this[0]=0}resetState(e){return C._ts_lookahead_iterator_reset_state(this[0],e)}reset(e,r){return!!C._ts_lookahead_iterator_reset(this[0],e[0],r)&&(this.language=e,!0)}[Symbol.iterator](){let e=this;return{next:()=>C._ts_lookahead_iterator_next(e[0])?{done:!1,value:e.currentType}:{done:!0,value:""}}}}class Query{constructor(e,r,n,o,s,a,c,u){assertInternal(e),this[0]=r,this.captureNames=n,this.textPredicates=o,this.predicates=s,this.setProperties=a,this.assertedProperties=c,this.refutedProperties=u,this.exceededMatchLimit=!1}delete(){C._ts_query_delete(this[0]),this[0]=0}matches(e,{startPosition:r=ZERO_POINT,endPosition:n=ZERO_POINT,startIndex:o=0,endIndex:s=0,matchLimit:a=4294967295,maxStartDepth:c=4294967295}={}){if(typeof a!="number")throw new Error("Arguments must be numbers");marshalNode(e),C._ts_query_matches_wasm(this[0],e.tree[0],r.row,r.column,n.row,n.column,o,s,a,c);let u=getValue(TRANSFER_BUFFER,"i32"),l=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),d=getValue(TRANSFER_BUFFER+2*SIZE_OF_INT,"i32"),p=new Array(u);this.exceededMatchLimit=!!d;let f=0,m=l;for(let h=0;h<u;h++){let g=getValue(m,"i32");m+=SIZE_OF_INT;let v=getValue(m,"i32");m+=SIZE_OF_INT;let y=new Array(v);if(m=unmarshalCaptures(this,e.tree,m,y),this.textPredicates[g].every(_=>_(y))){p[f]={pattern:g,captures:y};let _=this.setProperties[g];_&&(p[f].setProperties=_);let b=this.assertedProperties[g];b&&(p[f].assertedProperties=b);let S=this.refutedProperties[g];S&&(p[f].refutedProperties=S),f++}}return p.length=f,C._free(l),p}captures(e,{startPosition:r=ZERO_POINT,endPosition:n=ZERO_POINT,startIndex:o=0,endIndex:s=0,matchLimit:a=4294967295,maxStartDepth:c=4294967295}={}){if(typeof a!="number")throw new Error("Arguments must be numbers");marshalNode(e),C._ts_query_captures_wasm(this[0],e.tree[0],r.row,r.column,n.row,n.column,o,s,a,c);let u=getValue(TRANSFER_BUFFER,"i32"),l=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),d=getValue(TRANSFER_BUFFER+2*SIZE_OF_INT,"i32"),p=[];this.exceededMatchLimit=!!d;let f=[],m=l;for(let h=0;h<u;h++){let g=getValue(m,"i32");m+=SIZE_OF_INT;let v=getValue(m,"i32");m+=SIZE_OF_INT;let y=getValue(m,"i32");if(m+=SIZE_OF_INT,f.length=v,m=unmarshalCaptures(this,e.tree,m,f),this.textPredicates[g].every(_=>_(f))){let _=f[y],b=this.setProperties[g];b&&(_.setProperties=b);let S=this.assertedProperties[g];S&&(_.assertedProperties=S);let I=this.refutedProperties[g];I&&(_.refutedProperties=I),p.push(_)}}return C._free(l),p}predicatesForPattern(e){return this.predicates[e]}disableCapture(e){let r=lengthBytesUTF8(e),n=C._malloc(r+1);stringToUTF8(e,n,r+1),C._ts_query_disable_capture(this[0],n,r),C._free(n)}didExceedMatchLimit(){return this.exceededMatchLimit}}function getText(t,e,r){let n=r-e,o=t.textCallback(e,null,r);for(e+=o.length;e<r;){let s=t.textCallback(e,null,r);if(!(s&&s.length>0))break;e+=s.length,o+=s}return e>r&&(o=o.slice(0,n)),o}function unmarshalCaptures(t,e,r,n){for(let o=0,s=n.length;o<s;o++){let a=getValue(r,"i32"),c=unmarshalNode(e,r+=SIZE_OF_INT);r+=SIZE_OF_NODE,n[o]={name:t.captureNames[a],node:c}}return r}function assertInternal(t){if(t!==INTERNAL)throw new Error("Illegal constructor")}function isPoint(t){return t&&typeof t.row=="number"&&typeof t.column=="number"}function marshalNode(t){let e=TRANSFER_BUFFER;setValue(e,t.id,"i32"),e+=SIZE_OF_INT,setValue(e,t.startIndex,"i32"),e+=SIZE_OF_INT,setValue(e,t.startPosition.row,"i32"),e+=SIZE_OF_INT,setValue(e,t.startPosition.column,"i32"),e+=SIZE_OF_INT,setValue(e,t[0],"i32")}function unmarshalNode(t,e=TRANSFER_BUFFER){let r=getValue(e,"i32");if(r===0)return null;let n=getValue(e+=SIZE_OF_INT,"i32"),o=getValue(e+=SIZE_OF_INT,"i32"),s=getValue(e+=SIZE_OF_INT,"i32"),a=getValue(e+=SIZE_OF_INT,"i32"),c=new Node(INTERNAL,t);return c.id=r,c.startIndex=n,c.startPosition={row:o,column:s},c[0]=a,c}function marshalTreeCursor(t,e=TRANSFER_BUFFER){setValue(e+0*SIZE_OF_INT,t[0],"i32"),setValue(e+1*SIZE_OF_INT,t[1],"i32"),setValue(e+2*SIZE_OF_INT,t[2],"i32"),setValue(e+3*SIZE_OF_INT,t[3],"i32")}function unmarshalTreeCursor(t){t[0]=getValue(TRANSFER_BUFFER+0*SIZE_OF_INT,"i32"),t[1]=getValue(TRANSFER_BUFFER+1*SIZE_OF_INT,"i32"),t[2]=getValue(TRANSFER_BUFFER+2*SIZE_OF_INT,"i32"),t[3]=getValue(TRANSFER_BUFFER+3*SIZE_OF_INT,"i32")}function marshalPoint(t,e){setValue(t,e.row,"i32"),setValue(t+SIZE_OF_INT,e.column,"i32")}function unmarshalPoint(t){return{row:getValue(t,"i32")>>>0,column:getValue(t+SIZE_OF_INT,"i32")>>>0}}function marshalRange(t,e){marshalPoint(t,e.startPosition),marshalPoint(t+=SIZE_OF_POINT,e.endPosition),setValue(t+=SIZE_OF_POINT,e.startIndex,"i32"),setValue(t+=SIZE_OF_INT,e.endIndex,"i32"),t+=SIZE_OF_INT}function unmarshalRange(t){let e={};return e.startPosition=unmarshalPoint(t),t+=SIZE_OF_POINT,e.endPosition=unmarshalPoint(t),t+=SIZE_OF_POINT,e.startIndex=getValue(t,"i32")>>>0,t+=SIZE_OF_INT,e.endIndex=getValue(t,"i32")>>>0,e}function marshalEdit(t){let e=TRANSFER_BUFFER;marshalPoint(e,t.startPosition),e+=SIZE_OF_POINT,marshalPoint(e,t.oldEndPosition),e+=SIZE_OF_POINT,marshalPoint(e,t.newEndPosition),e+=SIZE_OF_POINT,setValue(e,t.startIndex,"i32"),e+=SIZE_OF_INT,setValue(e,t.oldEndIndex,"i32"),e+=SIZE_OF_INT,setValue(e,t.newEndIndex,"i32"),e+=SIZE_OF_INT}for(let t of Object.getOwnPropertyNames(ParserImpl.prototype))Object.defineProperty(Parser.prototype,t,{value:ParserImpl.prototype[t],enumerable:!1,writable:!1});Parser.Language=Language,Module.onRuntimeInitialized=()=>{ParserImpl.init(),resolveInitPromise()}}))}}return Parser}();typeof exports=="object"&&(module.exports=TreeSitter)});var nB=L(cr=>{"use strict";var tB=cr&&cr.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},rB=cr&&cr.__generator||function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(d){return u([l,d])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=l[0]&2?o.return:l[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,l[1])).done)return s;switch(o=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(d){l=[6,d],o=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(cr,"__esModule",{value:!0});cr.getShallowFileSize=cr.getShallowDirectorySizeSync=cr.getShallowDirectorySize=cr.confirmDirExists=cr.unlinkAsync=cr.readdirAsync=cr.readFileAsync=cr.writeFileAsync=cr.appendFileAsync=cr.accessAsync=cr.mkdirAsync=cr.lstatAsync=cr.statAsync=void 0;var Ju=require("fs"),Eie=require("path"),jp=require("util");cr.statAsync=jp.promisify(Ju.stat);cr.lstatAsync=jp.promisify(Ju.lstat);cr.mkdirAsync=jp.promisify(Ju.mkdir);cr.accessAsync=jp.promisify(Ju.access);cr.appendFileAsync=jp.promisify(Ju.appendFile);cr.writeFileAsync=jp.promisify(Ju.writeFile);cr.readFileAsync=jp.promisify(Ju.readFile);cr.readdirAsync=jp.promisify(Ju.readdir);cr.unlinkAsync=jp.promisify(Ju.unlink);var y4e=function(t){return tB(void 0,void 0,void 0,function(){var e,r,n;return rB(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,7]),[4,cr.lstatAsync(t)];case 1:if(e=o.sent(),!e.isDirectory())throw new Error("Path existed but was not a directory");return[3,7];case 2:if(r=o.sent(),!(r&&r.code==="ENOENT"))return[3,6];o.label=3;case 3:return o.trys.push([3,5,,6]),[4,cr.mkdirAsync(t)];case 4:return o.sent(),[3,6];case 5:if(n=o.sent(),n&&n.code!=="EEXIST")throw n;return[3,6];case 6:return[3,7];case 7:return[2]}})})};cr.confirmDirExists=y4e;var b4e=function(t){return tB(void 0,void 0,void 0,function(){var e,r,n,o,s,a;return rB(this,function(c){switch(c.label){case 0:return[4,cr.readdirAsync(t)];case 1:e=c.sent(),r=0,n=0,o=e,c.label=2;case 2:return n<o.length?(s=o[n],[4,cr.statAsync(Eie.join(t,s))]):[3,5];case 3:a=c.sent(),a.isFile()&&(r+=a.size),c.label=4;case 4:return n++,[3,2];case 5:return[2,r]}})})};cr.getShallowDirectorySize=b4e;var _4e=function(t){for(var e=Ju.readdirSync(t),r=0,n=0;n<e.length;n++)r+=Ju.statSync(Eie.join(t,e[n])).size;return r};cr.getShallowDirectorySizeSync=_4e;var x4e=function(t){return tB(void 0,void 0,void 0,function(){var e;return rB(this,function(r){switch(r.label){case 0:return[4,cr.statAsync(t)];case 1:return e=r.sent(),e.isFile()?[2,e.size]:[2]}})})};cr.getShallowFileSize=x4e});var kie=L((C0,Rie)=>{"use strict";var iB=C0&&C0.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},oB=C0&&C0.__generator||function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(d){return u([l,d])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=l[0]&2?o.return:l[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,l[1])).done)return s;switch(o=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(d){l=[6,d],o=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},wie=C0&&C0.__spreadArrays||function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),o=0,e=0;e<r;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,o++)n[o]=s[a];return n},S4e=require("fs"),I4e=require("os"),I0=require("path"),ed=nB(),C4e=function(){function t(){var e=this;this.TAG="Logger",this._cleanupTimeOut=60*30*1e3,this._tempDir="",this._logFileName="",this._fileFullPath="",this._backUpNameFormat="",this._logToFile=!1,this._logToConsole=!0;var r=process.env.APPLICATIONINSIGHTS_LOG_DESTINATION;r=="file+console"&&(this._logToFile=!0),r=="file"&&(this._logToFile=!0,this._logToConsole=!1),this.maxSizeBytes=5e4,this.maxHistory=1,this._logFileName="applicationinsights.log";var n=process.env.APPLICATIONINSIGHTS_LOGDIR;n?I0.isAbsolute(n)?this._tempDir=n:this._tempDir=I0.join(process.cwd(),n):this._tempDir=I0.join(I4e.tmpdir(),"appInsights-node"),this._fileFullPath=I0.join(this._tempDir,this._logFileName),this._backUpNameFormat="."+this._logFileName,this._logToFile&&(t._fileCleanupTimer||(t._fileCleanupTimer=setInterval(function(){e._fileCleanupTask()},this._cleanupTimeOut),t._fileCleanupTimer.unref()))}return t.prototype.info=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=e?wie([e],r):r;this._logToFile&&this._storeToDisk(o),this._logToConsole&&console.info.apply(console,o)},t.prototype.warning=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=e?wie([e],r):r;this._logToFile&&this._storeToDisk(o),this._logToConsole&&console.warn.apply(console,o)},t.getInstance=function(){return t._instance||(t._instance=new t),t._instance},t.prototype._storeToDisk=function(e){return iB(this,void 0,void 0,function(){var r,n,o,s,a,c;return oB(this,function(u){switch(u.label){case 0:r=e+`\r
`,u.label=1;case 1:return u.trys.push([1,3,,4]),[4,ed.confirmDirExists(this._tempDir)];case 2:return u.sent(),[3,4];case 3:return n=u.sent(),console.log(this.TAG,"Failed to create directory for log file: "+(n&&n.message)),[2];case 4:return u.trys.push([4,6,,11]),[4,ed.accessAsync(this._fileFullPath,S4e.constants.F_OK)];case 5:return u.sent(),[3,11];case 6:o=u.sent(),u.label=7;case 7:return u.trys.push([7,9,,10]),[4,ed.appendFileAsync(this._fileFullPath,r)];case 8:return u.sent(),[2];case 9:return s=u.sent(),console.log(this.TAG,"Failed to put log into file: "+(o&&o.message)),[2];case 10:return[3,11];case 11:return u.trys.push([11,17,,18]),[4,ed.getShallowFileSize(this._fileFullPath)];case 12:return a=u.sent(),a>this.maxSizeBytes?[4,this._createBackupFile(r)]:[3,14];case 13:return u.sent(),[3,16];case 14:return[4,ed.appendFileAsync(this._fileFullPath,r)];case 15:u.sent(),u.label=16;case 16:return[3,18];case 17:return c=u.sent(),console.log(this.TAG,"Failed to create backup file: "+(c&&c.message)),[3,18];case 18:return[2]}})})},t.prototype._createBackupFile=function(e){return iB(this,void 0,void 0,function(){var r,n,o;return oB(this,function(s){switch(s.label){case 0:return s.trys.push([0,3,4,5]),[4,ed.readFileAsync(this._fileFullPath)];case 1:return r=s.sent(),n=I0.join(this._tempDir,new Date().getTime()+"."+this._logFileName),[4,ed.writeFileAsync(n,r)];case 2:return s.sent(),[3,5];case 3:return o=s.sent(),console.log("Failed to generate backup log file",o),[3,5];case 4:return ed.writeFileAsync(this._fileFullPath,e),[7];case 5:return[2]}})})},t.prototype._fileCleanupTask=function(){return iB(this,void 0,void 0,function(){var e,r,n,o,s,a=this;return oB(this,function(c){switch(c.label){case 0:return c.trys.push([0,6,,7]),[4,ed.readdirAsync(this._tempDir)];case 1:e=c.sent(),e=e.filter(function(u){return I0.basename(u).indexOf(a._backUpNameFormat)>-1}),e.sort(function(u,l){var d=new Date(parseInt(u.split(a._backUpNameFormat)[0])),p=new Date(parseInt(l.split(a._backUpNameFormat)[0]));if(d<p)return-1;if(d>=p)return 1}),r=e.length,n=0,c.label=2;case 2:return n<r-this.maxHistory?(o=I0.join(this._tempDir,e[n]),[4,ed.unlinkAsync(o)]):[3,5];case 3:c.sent(),c.label=4;case 4:return n++,[3,2];case 5:return[3,7];case 6:return s=c.sent(),console.log(this.TAG,"Failed to cleanup log files: "+(s&&s.message)),[3,7];case 7:return[2]}})})},t._fileCleanupTimer=null,t}();Rie.exports=C4e});var Fn=L((xyt,Pie)=>{"use strict";var Aie=kie(),T4e="APPLICATION_INSIGHTS_ENABLE_DEBUG_LOGS",E4e="APPLICATION_INSIGHTS_DISABLE_WARNING_LOGS",w4e=function(){function t(){}return t.info=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this.enableDebug&&Aie.getInstance().info(this.TAG+e,r)},t.warn=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this.disableWarnings||Aie.getInstance().warning(this.TAG+e,r)},t.enableDebug=!!process.env[T4e],t.disableWarnings=!!process.env[E4e],t.TAG="ApplicationInsights:",t}();Pie.exports=w4e});var MD=L(OD=>{"use strict";Object.defineProperty(OD,"__esModule",{value:!0});OD.JsonConfig=void 0;var R4e=require("fs"),LD=require("path"),sB=Fn(),k4e="APPLICATIONINSIGHTS_CONFIGURATION_FILE",A4e="APPLICATIONINSIGHTS_CONNECTION_STRING",Die="APPSETTING_",Nie="APPINSIGHTS_INSTRUMENTATIONKEY",Lie="APPINSIGHTS_INSTRUMENTATION_KEY",P4e="APPLICATION_INSIGHTS_DISABLE_EXTENDED_METRIC",D4e="APPLICATION_INSIGHTS_DISABLE_ALL_EXTENDED_METRICS",N4e="http_proxy",L4e="https_proxy",O4e="APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL",M4e="APPLICATION_INSIGHTS_NO_STATSBEAT",F4e="APPLICATION_INSIGHTS_NO_HTTP_AGENT_KEEP_ALIVE",U4e="APPLICATION_INSIGHTS_NO_PATCH_MODULES",B4e="APPLICATIONINSIGHTS_WEB_INSTRUMENTATION_ENABLED",q4e="APPLICATIONINSIGHTS_WEB_INSTRUMENTATION_CONNECTION_STRING",H4e="APPLICATIONINSIGHTS_WEB_INSTRUMENTATION_SOURCE",j4e="APPLICATIONINSIGHTS_WEB_SNIPPET_ENABLED",z4e="APPLICATIONINSIGHTS_WEB_SNIPPET_CONNECTION_STRING",G4e=function(){function t(){this.connectionString=process.env[A4e],this.instrumentationKey=process.env[Nie]||process.env[Die+Nie]||process.env[Lie]||process.env[Die+Lie],!this.connectionString&&this.instrumentationKey&&sB.warn("APPINSIGHTS_INSTRUMENTATIONKEY is in path of deprecation, please use APPLICATIONINSIGHTS_CONNECTION_STRING env variable to setup the SDK."),this.disableAllExtendedMetrics=!!process.env[D4e],this.extendedMetricDisablers=process.env[P4e],this.proxyHttpUrl=process.env[N4e],this.proxyHttpsUrl=process.env[L4e],this.noDiagnosticChannel=!!process.env[O4e],this.disableStatsbeat=!!process.env[M4e],this.noHttpAgentKeepAlive=!!process.env[F4e],this.noPatchModules=process.env[U4e]||"",this.enableWebInstrumentation=!!process.env[B4e]||!!process.env[j4e],this.webInstrumentationSrc=process.env[H4e]||"",this.webInstrumentationConnectionString=process.env[q4e]||process.env[z4e]||"",this.enableAutoWebSnippetInjection=this.enableWebInstrumentation,this.webSnippetConnectionString=this.webInstrumentationConnectionString,this._loadJsonFile()}return t.getInstance=function(){return t._instance||(t._instance=new t),t._instance},t.prototype._loadJsonFile=function(){var e="",r="{}";if(r)e=r;else{var n="applicationinsights.json",o=LD.join(__dirname,"../../"),s=LD.join(o,n),a=process.env[k4e];a&&(LD.isAbsolute(a)?s=a:s=LD.join(o,a));try{e=R4e.readFileSync(s,"utf8")}catch(u){sB.warn("Failed to read JSON config file: ",u)}}try{var c=JSON.parse(e);c.disableStatsbeat!=null&&(this.disableStatsbeat=c.disableStatsbeat),c.disableAllExtendedMetrics!=null&&(this.disableAllExtendedMetrics=c.disableStatsbeat),c.noDiagnosticChannel!=null&&(this.noDiagnosticChannel=c.noDiagnosticChannel),c.noHttpAgentKeepAlive!=null&&(this.noHttpAgentKeepAlive=c.noHttpAgentKeepAlive),c.connectionString!=null&&(this.connectionString=c.connectionString),c.extendedMetricDisablers!=null&&(this.extendedMetricDisablers=c.extendedMetricDisablers),c.noDiagnosticChannel!=null&&(this.noDiagnosticChannel=c.noDiagnosticChannel),c.proxyHttpUrl!=null&&(this.proxyHttpUrl=c.proxyHttpUrl),c.proxyHttpsUrl!=null&&(this.proxyHttpsUrl=c.proxyHttpsUrl),c.proxyHttpsUrl!=null&&(this.proxyHttpsUrl=c.proxyHttpsUrl),c.noPatchModules!=null&&(this.noPatchModules=c.noPatchModules),c.enableAutoWebSnippetInjection!=null&&(this.enableWebInstrumentation=c.enableAutoWebSnippetInjection,this.enableAutoWebSnippetInjection=this.enableWebInstrumentation),c.enableWebInstrumentation!=null&&(this.enableWebInstrumentation=c.enableWebInstrumentation,this.enableAutoWebSnippetInjection=this.enableWebInstrumentation),c.webSnippetConnectionString!=null&&(this.webInstrumentationConnectionString=c.webSnippetConnectionString,this.webSnippetConnectionString=this.webInstrumentationConnectionString),c.webInstrumentationConnectionString!=null&&(this.webInstrumentationConnectionString=c.webInstrumentationConnectionString,this.webSnippetConnectionString=this.webInstrumentationConnectionString),c.webInstrumentationConfig!=null&&(this.webInstrumentationConfig=c.webInstrumentationConfig),c.webInstrumentationSrc!=null&&(this.webInstrumentationSrc=c.webInstrumentationSrc),c.enableLoggerErrorToTrace!=null&&(this.enableLoggerErrorToTrace=c.enableLoggerErrorToTrace),this.endpointUrl=c.endpointUrl,this.maxBatchSize=c.maxBatchSize,this.maxBatchIntervalMs=c.maxBatchIntervalMs,this.disableAppInsights=c.disableAppInsights,this.samplingPercentage=c.samplingPercentage,this.correlationIdRetryIntervalMs=c.correlationIdRetryIntervalMs,this.correlationHeaderExcludedDomains=c.correlationHeaderExcludedDomains,this.ignoreLegacyHeaders=c.ignoreLegacyHeaders,this.distributedTracingMode=c.distributedTracingMode,this.enableAutoCollectExternalLoggers=c.enableAutoCollectExternalLoggers,this.enableAutoCollectConsole=c.enableAutoCollectConsole,this.enableLoggerErrorToTrace=c.enableLoggerErrorToTrace,this.enableAutoCollectExceptions=c.enableAutoCollectExceptions,this.enableAutoCollectPerformance=c.enableAutoCollectPerformance,this.enableAutoCollectExtendedMetrics=c.enableAutoCollectExtendedMetrics,this.enableAutoCollectPreAggregatedMetrics=c.enableAutoCollectPreAggregatedMetrics,this.enableAutoCollectHeartbeat=c.enableAutoCollectHeartbeat,this.enableAutoCollectRequests=c.enableAutoCollectRequests,this.enableAutoCollectDependencies=c.enableAutoCollectDependencies,this.enableAutoDependencyCorrelation=c.enableAutoDependencyCorrelation,this.enableAutoCollectIncomingRequestAzureFunctions=c.enableAutoCollectIncomingRequestAzureFunctions,this.enableUseAsyncHooks=c.enableUseAsyncHooks,this.enableUseDiskRetryCaching=c.enableUseDiskRetryCaching,this.enableResendInterval=c.enableResendInterval,this.enableMaxBytesOnDisk=c.enableMaxBytesOnDisk,this.enableInternalDebugLogging=c.enableInternalDebugLogging,this.enableInternalWarningLogging=c.enableInternalWarningLogging,this.enableSendLiveMetrics=c.enableSendLiveMetrics,this.quickPulseHost=c.quickPulseHost}catch(u){sB.warn("Invalid JSON config file: ",u)}},t}();OD.JsonConfig=G4e});var BE=L((Iyt,Oie)=>{var V4e="2.0.0",$4e=Number.MAX_SAFE_INTEGER||9007199254740991,W4e=16,K4e=250,Y4e=["major","premajor","minor","preminor","patch","prepatch","prerelease"];Oie.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:W4e,MAX_SAFE_BUILD_LENGTH:K4e,MAX_SAFE_INTEGER:$4e,RELEASE_TYPES:Y4e,SEMVER_SPEC_VERSION:V4e,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var qE=L((Cyt,Mie)=>{var Q4e=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{};Mie.exports=Q4e});var nx=L((zp,Fie)=>{var{MAX_SAFE_COMPONENT_LENGTH:aB,MAX_SAFE_BUILD_LENGTH:X4e,MAX_LENGTH:J4e}=BE(),Z4e=qE();zp=Fie.exports={};var eOe=zp.re=[],tOe=zp.safeRe=[],ot=zp.src=[],st=zp.t={},rOe=0,cB="[a-zA-Z0-9-]",nOe=[["\\s",1],["\\d",J4e],[cB,X4e]],iOe=t=>{for(let[e,r]of nOe)t=t.split(`${e}*`).join(`${e}{0,${r}}`).split(`${e}+`).join(`${e}{1,${r}}`);return t},Zt=(t,e,r)=>{let n=iOe(e),o=rOe++;Z4e(t,o,e),st[t]=o,ot[o]=e,eOe[o]=new RegExp(e,r?"g":void 0),tOe[o]=new RegExp(n,r?"g":void 0)};Zt("NUMERICIDENTIFIER","0|[1-9]\\d*");Zt("NUMERICIDENTIFIERLOOSE","\\d+");Zt("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${cB}*`);Zt("MAINVERSION",`(${ot[st.NUMERICIDENTIFIER]})\\.(${ot[st.NUMERICIDENTIFIER]})\\.(${ot[st.NUMERICIDENTIFIER]})`);Zt("MAINVERSIONLOOSE",`(${ot[st.NUMERICIDENTIFIERLOOSE]})\\.(${ot[st.NUMERICIDENTIFIERLOOSE]})\\.(${ot[st.NUMERICIDENTIFIERLOOSE]})`);Zt("PRERELEASEIDENTIFIER",`(?:${ot[st.NUMERICIDENTIFIER]}|${ot[st.NONNUMERICIDENTIFIER]})`);Zt("PRERELEASEIDENTIFIERLOOSE",`(?:${ot[st.NUMERICIDENTIFIERLOOSE]}|${ot[st.NONNUMERICIDENTIFIER]})`);Zt("PRERELEASE",`(?:-(${ot[st.PRERELEASEIDENTIFIER]}(?:\\.${ot[st.PRERELEASEIDENTIFIER]})*))`);Zt("PRERELEASELOOSE",`(?:-?(${ot[st.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${ot[st.PRERELEASEIDENTIFIERLOOSE]})*))`);Zt("BUILDIDENTIFIER",`${cB}+`);Zt("BUILD",`(?:\\+(${ot[st.BUILDIDENTIFIER]}(?:\\.${ot[st.BUILDIDENTIFIER]})*))`);Zt("FULLPLAIN",`v?${ot[st.MAINVERSION]}${ot[st.PRERELEASE]}?${ot[st.BUILD]}?`);Zt("FULL",`^${ot[st.FULLPLAIN]}$`);Zt("LOOSEPLAIN",`[v=\\s]*${ot[st.MAINVERSIONLOOSE]}${ot[st.PRERELEASELOOSE]}?${ot[st.BUILD]}?`);Zt("LOOSE",`^${ot[st.LOOSEPLAIN]}$`);Zt("GTLT","((?:<|>)?=?)");Zt("XRANGEIDENTIFIERLOOSE",`${ot[st.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);Zt("XRANGEIDENTIFIER",`${ot[st.NUMERICIDENTIFIER]}|x|X|\\*`);Zt("XRANGEPLAIN",`[v=\\s]*(${ot[st.XRANGEIDENTIFIER]})(?:\\.(${ot[st.XRANGEIDENTIFIER]})(?:\\.(${ot[st.XRANGEIDENTIFIER]})(?:${ot[st.PRERELEASE]})?${ot[st.BUILD]}?)?)?`);Zt("XRANGEPLAINLOOSE",`[v=\\s]*(${ot[st.XRANGEIDENTIFIERLOOSE]})(?:\\.(${ot[st.XRANGEIDENTIFIERLOOSE]})(?:\\.(${ot[st.XRANGEIDENTIFIERLOOSE]})(?:${ot[st.PRERELEASELOOSE]})?${ot[st.BUILD]}?)?)?`);Zt("XRANGE",`^${ot[st.GTLT]}\\s*${ot[st.XRANGEPLAIN]}$`);Zt("XRANGELOOSE",`^${ot[st.GTLT]}\\s*${ot[st.XRANGEPLAINLOOSE]}$`);Zt("COERCE",`(^|[^\\d])(\\d{1,${aB}})(?:\\.(\\d{1,${aB}}))?(?:\\.(\\d{1,${aB}}))?(?:$|[^\\d])`);Zt("COERCERTL",ot[st.COERCE],!0);Zt("LONETILDE","(?:~>?)");Zt("TILDETRIM",`(\\s*)${ot[st.LONETILDE]}\\s+`,!0);zp.tildeTrimReplace="$1~";Zt("TILDE",`^${ot[st.LONETILDE]}${ot[st.XRANGEPLAIN]}$`);Zt("TILDELOOSE",`^${ot[st.LONETILDE]}${ot[st.XRANGEPLAINLOOSE]}$`);Zt("LONECARET","(?:\\^)");Zt("CARETTRIM",`(\\s*)${ot[st.LONECARET]}\\s+`,!0);zp.caretTrimReplace="$1^";Zt("CARET",`^${ot[st.LONECARET]}${ot[st.XRANGEPLAIN]}$`);Zt("CARETLOOSE",`^${ot[st.LONECARET]}${ot[st.XRANGEPLAINLOOSE]}$`);Zt("COMPARATORLOOSE",`^${ot[st.GTLT]}\\s*(${ot[st.LOOSEPLAIN]})$|^$`);Zt("COMPARATOR",`^${ot[st.GTLT]}\\s*(${ot[st.FULLPLAIN]})$|^$`);Zt("COMPARATORTRIM",`(\\s*)${ot[st.GTLT]}\\s*(${ot[st.LOOSEPLAIN]}|${ot[st.XRANGEPLAIN]})`,!0);zp.comparatorTrimReplace="$1$2$3";Zt("HYPHENRANGE",`^\\s*(${ot[st.XRANGEPLAIN]})\\s+-\\s+(${ot[st.XRANGEPLAIN]})\\s*$`);Zt("HYPHENRANGELOOSE",`^\\s*(${ot[st.XRANGEPLAINLOOSE]})\\s+-\\s+(${ot[st.XRANGEPLAINLOOSE]})\\s*$`);Zt("STAR","(<|>)?=?\\s*\\*");Zt("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");Zt("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var FD=L((Tyt,Uie)=>{var oOe=Object.freeze({loose:!0}),sOe=Object.freeze({}),aOe=t=>t?typeof t!="object"?oOe:t:sOe;Uie.exports=aOe});var uB=L((Eyt,Hie)=>{var Bie=/^[0-9]+$/,qie=(t,e)=>{let r=Bie.test(t),n=Bie.test(e);return r&&n&&(t=+t,e=+e),t===e?0:r&&!n?-1:n&&!r?1:t<e?-1:1},cOe=(t,e)=>qie(e,t);Hie.exports={compareIdentifiers:qie,rcompareIdentifiers:cOe}});var Ds=L((wyt,Vie)=>{var UD=qE(),{MAX_LENGTH:jie,MAX_SAFE_INTEGER:BD}=BE(),{safeRe:zie,t:Gie}=nx(),uOe=FD(),{compareIdentifiers:ix}=uB(),lB=class t{constructor(e,r){if(r=uOe(r),e instanceof t){if(e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>jie)throw new TypeError(`version is longer than ${jie} characters`);UD("SemVer",e,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;let n=e.trim().match(r.loose?zie[Gie.LOOSE]:zie[Gie.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>BD||this.major<0)throw new TypeError("Invalid major version");if(this.minor>BD||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>BD||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(o=>{if(/^[0-9]+$/.test(o)){let s=+o;if(s>=0&&s<BD)return s}return o}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(UD("SemVer.compare",this.version,this.options,e),!(e instanceof t)){if(typeof e=="string"&&e===this.version)return 0;e=new t(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof t||(e=new t(e,this.options)),ix(this.major,e.major)||ix(this.minor,e.minor)||ix(this.patch,e.patch)}comparePre(e){if(e instanceof t||(e=new t(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let r=0;do{let n=this.prerelease[r],o=e.prerelease[r];if(UD("prerelease compare",r,n,o),n===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(n===void 0)return-1;if(n===o)continue;return ix(n,o)}while(++r)}compareBuild(e){e instanceof t||(e=new t(e,this.options));let r=0;do{let n=this.build[r],o=e.build[r];if(UD("prerelease compare",r,n,o),n===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(n===void 0)return-1;if(n===o)continue;return ix(n,o)}while(++r)}inc(e,r,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",r,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",r,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",r,n),this.inc("pre",r,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",r,n),this.inc("pre",r,n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let o=Number(n)?1:0;if(!r&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[o];else{let s=this.prerelease.length;for(;--s>=0;)typeof this.prerelease[s]=="number"&&(this.prerelease[s]++,s=-2);if(s===-1){if(r===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(o)}}if(r){let s=[r,o];n===!1&&(s=[r]),ix(this.prerelease[0],r)===0?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};Vie.exports=lB});var T0=L((Ryt,Wie)=>{var $ie=Ds(),lOe=(t,e,r=!1)=>{if(t instanceof $ie)return t;try{return new $ie(t,e)}catch(n){if(!r)return null;throw n}};Wie.exports=lOe});var Yie=L((kyt,Kie)=>{var dOe=T0(),pOe=(t,e)=>{let r=dOe(t,e);return r?r.version:null};Kie.exports=pOe});var Xie=L((Ayt,Qie)=>{var fOe=T0(),mOe=(t,e)=>{let r=fOe(t.trim().replace(/^[=v]+/,""),e);return r?r.version:null};Qie.exports=mOe});var eoe=L((Pyt,Zie)=>{var Jie=Ds(),hOe=(t,e,r,n,o)=>{typeof r=="string"&&(o=n,n=r,r=void 0);try{return new Jie(t instanceof Jie?t.version:t,r).inc(e,n,o).version}catch{return null}};Zie.exports=hOe});var noe=L((Dyt,roe)=>{var toe=T0(),gOe=(t,e)=>{let r=toe(t,null,!0),n=toe(e,null,!0),o=r.compare(n);if(o===0)return null;let s=o>0,a=s?r:n,c=s?n:r,u=!!a.prerelease.length;if(!!c.prerelease.length&&!u)return!c.patch&&!c.minor?"major":a.patch?"patch":a.minor?"minor":"major";let d=u?"pre":"";return r.major!==n.major?d+"major":r.minor!==n.minor?d+"minor":r.patch!==n.patch?d+"patch":"prerelease"};roe.exports=gOe});var ooe=L((Nyt,ioe)=>{var vOe=Ds(),yOe=(t,e)=>new vOe(t,e).major;ioe.exports=yOe});var aoe=L((Lyt,soe)=>{var bOe=Ds(),_Oe=(t,e)=>new bOe(t,e).minor;soe.exports=_Oe});var uoe=L((Oyt,coe)=>{var xOe=Ds(),SOe=(t,e)=>new xOe(t,e).patch;coe.exports=SOe});var doe=L((Myt,loe)=>{var IOe=T0(),COe=(t,e)=>{let r=IOe(t,e);return r&&r.prerelease.length?r.prerelease:null};loe.exports=COe});var Wc=L((Fyt,foe)=>{var poe=Ds(),TOe=(t,e,r)=>new poe(t,r).compare(new poe(e,r));foe.exports=TOe});var hoe=L((Uyt,moe)=>{var EOe=Wc(),wOe=(t,e,r)=>EOe(e,t,r);moe.exports=wOe});var voe=L((Byt,goe)=>{var ROe=Wc(),kOe=(t,e)=>ROe(t,e,!0);goe.exports=kOe});var qD=L((qyt,boe)=>{var yoe=Ds(),AOe=(t,e,r)=>{let n=new yoe(t,r),o=new yoe(e,r);return n.compare(o)||n.compareBuild(o)};boe.exports=AOe});var xoe=L((Hyt,_oe)=>{var POe=qD(),DOe=(t,e)=>t.sort((r,n)=>POe(r,n,e));_oe.exports=DOe});var Ioe=L((jyt,Soe)=>{var NOe=qD(),LOe=(t,e)=>t.sort((r,n)=>NOe(n,r,e));Soe.exports=LOe});var HE=L((zyt,Coe)=>{var OOe=Wc(),MOe=(t,e,r)=>OOe(t,e,r)>0;Coe.exports=MOe});var HD=L((Gyt,Toe)=>{var FOe=Wc(),UOe=(t,e,r)=>FOe(t,e,r)<0;Toe.exports=UOe});var dB=L((Vyt,Eoe)=>{var BOe=Wc(),qOe=(t,e,r)=>BOe(t,e,r)===0;Eoe.exports=qOe});var pB=L(($yt,woe)=>{var HOe=Wc(),jOe=(t,e,r)=>HOe(t,e,r)!==0;woe.exports=jOe});var jD=L((Wyt,Roe)=>{var zOe=Wc(),GOe=(t,e,r)=>zOe(t,e,r)>=0;Roe.exports=GOe});var zD=L((Kyt,koe)=>{var VOe=Wc(),$Oe=(t,e,r)=>VOe(t,e,r)<=0;koe.exports=$Oe});var fB=L((Yyt,Aoe)=>{var WOe=dB(),KOe=pB(),YOe=HE(),QOe=jD(),XOe=HD(),JOe=zD(),ZOe=(t,e,r,n)=>{switch(e){case"===":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t===r;case"!==":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t!==r;case"":case"=":case"==":return WOe(t,r,n);case"!=":return KOe(t,r,n);case">":return YOe(t,r,n);case">=":return QOe(t,r,n);case"<":return XOe(t,r,n);case"<=":return JOe(t,r,n);default:throw new TypeError(`Invalid operator: ${e}`)}};Aoe.exports=ZOe});var Doe=L((Qyt,Poe)=>{var e3e=Ds(),t3e=T0(),{safeRe:GD,t:VD}=nx(),r3e=(t,e)=>{if(t instanceof e3e)return t;if(typeof t=="number"&&(t=String(t)),typeof t!="string")return null;e=e||{};let r=null;if(!e.rtl)r=t.match(GD[VD.COERCE]);else{let n;for(;(n=GD[VD.COERCERTL].exec(t))&&(!r||r.index+r[0].length!==t.length);)(!r||n.index+n[0].length!==r.index+r[0].length)&&(r=n),GD[VD.COERCERTL].lastIndex=n.index+n[1].length+n[2].length;GD[VD.COERCERTL].lastIndex=-1}return r===null?null:t3e(`${r[2]}.${r[3]||"0"}.${r[4]||"0"}`,e)};Poe.exports=r3e});var Loe=L((Xyt,Noe)=>{"use strict";Noe.exports=function(t){t.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}});var Moe=L((Jyt,Ooe)=>{"use strict";Ooe.exports=Hr;Hr.Node=E0;Hr.create=Hr;function Hr(t){var e=this;if(e instanceof Hr||(e=new Hr),e.tail=null,e.head=null,e.length=0,t&&typeof t.forEach=="function")t.forEach(function(o){e.push(o)});else if(arguments.length>0)for(var r=0,n=arguments.length;r<n;r++)e.push(arguments[r]);return e}Hr.prototype.removeNode=function(t){if(t.list!==this)throw new Error("removing node which does not belong to this list");var e=t.next,r=t.prev;return e&&(e.prev=r),r&&(r.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=r),t.list.length--,t.next=null,t.prev=null,t.list=null,e};Hr.prototype.unshiftNode=function(t){if(t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}};Hr.prototype.pushNode=function(t){if(t!==this.tail){t.list&&t.list.removeNode(t);var e=this.tail;t.list=this,t.prev=e,e&&(e.next=t),this.tail=t,this.head||(this.head=t),this.length++}};Hr.prototype.push=function(){for(var t=0,e=arguments.length;t<e;t++)i3e(this,arguments[t]);return this.length};Hr.prototype.unshift=function(){for(var t=0,e=arguments.length;t<e;t++)o3e(this,arguments[t]);return this.length};Hr.prototype.pop=function(){if(this.tail){var t=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,t}};Hr.prototype.shift=function(){if(this.head){var t=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,t}};Hr.prototype.forEach=function(t,e){e=e||this;for(var r=this.head,n=0;r!==null;n++)t.call(e,r.value,n,this),r=r.next};Hr.prototype.forEachReverse=function(t,e){e=e||this;for(var r=this.tail,n=this.length-1;r!==null;n--)t.call(e,r.value,n,this),r=r.prev};Hr.prototype.get=function(t){for(var e=0,r=this.head;r!==null&&e<t;e++)r=r.next;if(e===t&&r!==null)return r.value};Hr.prototype.getReverse=function(t){for(var e=0,r=this.tail;r!==null&&e<t;e++)r=r.prev;if(e===t&&r!==null)return r.value};Hr.prototype.map=function(t,e){e=e||this;for(var r=new Hr,n=this.head;n!==null;)r.push(t.call(e,n.value,this)),n=n.next;return r};Hr.prototype.mapReverse=function(t,e){e=e||this;for(var r=new Hr,n=this.tail;n!==null;)r.push(t.call(e,n.value,this)),n=n.prev;return r};Hr.prototype.reduce=function(t,e){var r,n=this.head;if(arguments.length>1)r=e;else if(this.head)n=this.head.next,r=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var o=0;n!==null;o++)r=t(r,n.value,o),n=n.next;return r};Hr.prototype.reduceReverse=function(t,e){var r,n=this.tail;if(arguments.length>1)r=e;else if(this.tail)n=this.tail.prev,r=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var o=this.length-1;n!==null;o--)r=t(r,n.value,o),n=n.prev;return r};Hr.prototype.toArray=function(){for(var t=new Array(this.length),e=0,r=this.head;r!==null;e++)t[e]=r.value,r=r.next;return t};Hr.prototype.toArrayReverse=function(){for(var t=new Array(this.length),e=0,r=this.tail;r!==null;e++)t[e]=r.value,r=r.prev;return t};Hr.prototype.slice=function(t,e){e=e||this.length,e<0&&(e+=this.length),t=t||0,t<0&&(t+=this.length);var r=new Hr;if(e<t||e<0)return r;t<0&&(t=0),e>this.length&&(e=this.length);for(var n=0,o=this.head;o!==null&&n<t;n++)o=o.next;for(;o!==null&&n<e;n++,o=o.next)r.push(o.value);return r};Hr.prototype.sliceReverse=function(t,e){e=e||this.length,e<0&&(e+=this.length),t=t||0,t<0&&(t+=this.length);var r=new Hr;if(e<t||e<0)return r;t<0&&(t=0),e>this.length&&(e=this.length);for(var n=this.length,o=this.tail;o!==null&&n>e;n--)o=o.prev;for(;o!==null&&n>t;n--,o=o.prev)r.push(o.value);return r};Hr.prototype.splice=function(t,e,...r){t>this.length&&(t=this.length-1),t<0&&(t=this.length+t);for(var n=0,o=this.head;o!==null&&n<t;n++)o=o.next;for(var s=[],n=0;o&&n<e;n++)s.push(o.value),o=this.removeNode(o);o===null&&(o=this.tail),o!==this.head&&o!==this.tail&&(o=o.prev);for(var n=0;n<r.length;n++)o=n3e(this,o,r[n]);return s};Hr.prototype.reverse=function(){for(var t=this.head,e=this.tail,r=t;r!==null;r=r.prev){var n=r.prev;r.prev=r.next,r.next=n}return this.head=e,this.tail=t,this};function n3e(t,e,r){var n=e===t.head?new E0(r,null,e,t):new E0(r,e,e.next,t);return n.next===null&&(t.tail=n),n.prev===null&&(t.head=n),t.length++,n}function i3e(t,e){t.tail=new E0(e,t.tail,null,t),t.head||(t.head=t.tail),t.length++}function o3e(t,e){t.head=new E0(e,null,t.head,t),t.tail||(t.tail=t.head),t.length++}function E0(t,e,r,n){if(!(this instanceof E0))return new E0(t,e,r,n);this.list=n,this.value=t,e?(e.next=this,this.prev=e):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}try{Loe()(Hr)}catch{}});var Hoe=L((Zyt,qoe)=>{"use strict";var s3e=Moe(),w0=Symbol("max"),Vp=Symbol("length"),ox=Symbol("lengthCalculator"),zE=Symbol("allowStale"),R0=Symbol("maxAge"),Gp=Symbol("dispose"),Foe=Symbol("noDisposeOnSet"),Uo=Symbol("lruList"),Zu=Symbol("cache"),Boe=Symbol("updateAgeOnGet"),mB=()=>1,gB=class{constructor(e){if(typeof e=="number"&&(e={max:e}),e||(e={}),e.max&&(typeof e.max!="number"||e.max<0))throw new TypeError("max must be a non-negative number");let r=this[w0]=e.max||1/0,n=e.length||mB;if(this[ox]=typeof n!="function"?mB:n,this[zE]=e.stale||!1,e.maxAge&&typeof e.maxAge!="number")throw new TypeError("maxAge must be a number");this[R0]=e.maxAge||0,this[Gp]=e.dispose,this[Foe]=e.noDisposeOnSet||!1,this[Boe]=e.updateAgeOnGet||!1,this.reset()}set max(e){if(typeof e!="number"||e<0)throw new TypeError("max must be a non-negative number");this[w0]=e||1/0,jE(this)}get max(){return this[w0]}set allowStale(e){this[zE]=!!e}get allowStale(){return this[zE]}set maxAge(e){if(typeof e!="number")throw new TypeError("maxAge must be a non-negative number");this[R0]=e,jE(this)}get maxAge(){return this[R0]}set lengthCalculator(e){typeof e!="function"&&(e=mB),e!==this[ox]&&(this[ox]=e,this[Vp]=0,this[Uo].forEach(r=>{r.length=this[ox](r.value,r.key),this[Vp]+=r.length})),jE(this)}get lengthCalculator(){return this[ox]}get length(){return this[Vp]}get itemCount(){return this[Uo].length}rforEach(e,r){r=r||this;for(let n=this[Uo].tail;n!==null;){let o=n.prev;Uoe(this,e,n,r),n=o}}forEach(e,r){r=r||this;for(let n=this[Uo].head;n!==null;){let o=n.next;Uoe(this,e,n,r),n=o}}keys(){return this[Uo].toArray().map(e=>e.key)}values(){return this[Uo].toArray().map(e=>e.value)}reset(){this[Gp]&&this[Uo]&&this[Uo].length&&this[Uo].forEach(e=>this[Gp](e.key,e.value)),this[Zu]=new Map,this[Uo]=new s3e,this[Vp]=0}dump(){return this[Uo].map(e=>$D(this,e)?!1:{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}).toArray().filter(e=>e)}dumpLru(){return this[Uo]}set(e,r,n){if(n=n||this[R0],n&&typeof n!="number")throw new TypeError("maxAge must be a number");let o=n?Date.now():0,s=this[ox](r,e);if(this[Zu].has(e)){if(s>this[w0])return sx(this,this[Zu].get(e)),!1;let u=this[Zu].get(e).value;return this[Gp]&&(this[Foe]||this[Gp](e,u.value)),u.now=o,u.maxAge=n,u.value=r,this[Vp]+=s-u.length,u.length=s,this.get(e),jE(this),!0}let a=new vB(e,r,s,o,n);return a.length>this[w0]?(this[Gp]&&this[Gp](e,r),!1):(this[Vp]+=a.length,this[Uo].unshift(a),this[Zu].set(e,this[Uo].head),jE(this),!0)}has(e){if(!this[Zu].has(e))return!1;let r=this[Zu].get(e).value;return!$D(this,r)}get(e){return hB(this,e,!0)}peek(e){return hB(this,e,!1)}pop(){let e=this[Uo].tail;return e?(sx(this,e),e.value):null}del(e){sx(this,this[Zu].get(e))}load(e){this.reset();let r=Date.now();for(let n=e.length-1;n>=0;n--){let o=e[n],s=o.e||0;if(s===0)this.set(o.k,o.v);else{let a=s-r;a>0&&this.set(o.k,o.v,a)}}}prune(){this[Zu].forEach((e,r)=>hB(this,r,!1))}},hB=(t,e,r)=>{let n=t[Zu].get(e);if(n){let o=n.value;if($D(t,o)){if(sx(t,n),!t[zE])return}else r&&(t[Boe]&&(n.value.now=Date.now()),t[Uo].unshiftNode(n));return o.value}},$D=(t,e)=>{if(!e||!e.maxAge&&!t[R0])return!1;let r=Date.now()-e.now;return e.maxAge?r>e.maxAge:t[R0]&&r>t[R0]},jE=t=>{if(t[Vp]>t[w0])for(let e=t[Uo].tail;t[Vp]>t[w0]&&e!==null;){let r=e.prev;sx(t,e),e=r}},sx=(t,e)=>{if(e){let r=e.value;t[Gp]&&t[Gp](r.key,r.value),t[Vp]-=r.length,t[Zu].delete(r.key),t[Uo].removeNode(e)}},vB=class{constructor(e,r,n,o,s){this.key=e,this.value=r,this.length=n,this.now=o,this.maxAge=s||0}},Uoe=(t,e,r,n)=>{let o=r.value;$D(t,o)&&(sx(t,r),t[zE]||(o=void 0)),o&&e.call(n,o.value,o.key,t)};qoe.exports=gB});var Kc=L((ebt,Voe)=>{var yB=class t{constructor(e,r){if(r=c3e(r),e instanceof t)return e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease?e:new t(e.raw,r);if(e instanceof bB)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease,this.raw=e.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(n=>this.parseRange(n.trim())).filter(n=>n.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let n=this.set[0];if(this.set=this.set.filter(o=>!zoe(o[0])),this.set.length===0)this.set=[n];else if(this.set.length>1){for(let o of this.set)if(o.length===1&&h3e(o[0])){this.set=[o];break}}}this.format()}format(){return this.range=this.set.map(e=>e.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(e){let n=((this.options.includePrerelease&&f3e)|(this.options.loose&&m3e))+":"+e,o=joe.get(n);if(o)return o;let s=this.options.loose,a=s?Pa[ta.HYPHENRANGELOOSE]:Pa[ta.HYPHENRANGE];e=e.replace(a,T3e(this.options.includePrerelease)),Un("hyphen replace",e),e=e.replace(Pa[ta.COMPARATORTRIM],l3e),Un("comparator trim",e),e=e.replace(Pa[ta.TILDETRIM],d3e),Un("tilde trim",e),e=e.replace(Pa[ta.CARETTRIM],p3e),Un("caret trim",e);let c=e.split(" ").map(p=>g3e(p,this.options)).join(" ").split(/\s+/).map(p=>C3e(p,this.options));s&&(c=c.filter(p=>(Un("loose invalid filter",p,this.options),!!p.match(Pa[ta.COMPARATORLOOSE])))),Un("range list",c);let u=new Map,l=c.map(p=>new bB(p,this.options));for(let p of l){if(zoe(p))return[p];u.set(p.value,p)}u.size>1&&u.has("")&&u.delete("");let d=[...u.values()];return joe.set(n,d),d}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Range is required");return this.set.some(n=>Goe(n,r)&&e.set.some(o=>Goe(o,r)&&n.every(s=>o.every(a=>s.intersects(a,r)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new u3e(e,this.options)}catch{return!1}for(let r=0;r<this.set.length;r++)if(E3e(this.set[r],e,this.options))return!0;return!1}};Voe.exports=yB;var a3e=Hoe(),joe=new a3e({max:1e3}),c3e=FD(),bB=GE(),Un=qE(),u3e=Ds(),{safeRe:Pa,t:ta,comparatorTrimReplace:l3e,tildeTrimReplace:d3e,caretTrimReplace:p3e}=nx(),{FLAG_INCLUDE_PRERELEASE:f3e,FLAG_LOOSE:m3e}=BE(),zoe=t=>t.value==="<0.0.0-0",h3e=t=>t.value==="",Goe=(t,e)=>{let r=!0,n=t.slice(),o=n.pop();for(;r&&n.length;)r=n.every(s=>o.intersects(s,e)),o=n.pop();return r},g3e=(t,e)=>(Un("comp",t,e),t=b3e(t,e),Un("caret",t),t=v3e(t,e),Un("tildes",t),t=x3e(t,e),Un("xrange",t),t=I3e(t,e),Un("stars",t),t),ra=t=>!t||t.toLowerCase()==="x"||t==="*",v3e=(t,e)=>t.trim().split(/\s+/).map(r=>y3e(r,e)).join(" "),y3e=(t,e)=>{let r=e.loose?Pa[ta.TILDELOOSE]:Pa[ta.TILDE];return t.replace(r,(n,o,s,a,c)=>{Un("tilde",t,n,o,s,a,c);let u;return ra(o)?u="":ra(s)?u=`>=${o}.0.0 <${+o+1}.0.0-0`:ra(a)?u=`>=${o}.${s}.0 <${o}.${+s+1}.0-0`:c?(Un("replaceTilde pr",c),u=`>=${o}.${s}.${a}-${c} <${o}.${+s+1}.0-0`):u=`>=${o}.${s}.${a} <${o}.${+s+1}.0-0`,Un("tilde return",u),u})},b3e=(t,e)=>t.trim().split(/\s+/).map(r=>_3e(r,e)).join(" "),_3e=(t,e)=>{Un("caret",t,e);let r=e.loose?Pa[ta.CARETLOOSE]:Pa[ta.CARET],n=e.includePrerelease?"-0":"";return t.replace(r,(o,s,a,c,u)=>{Un("caret",t,o,s,a,c,u);let l;return ra(s)?l="":ra(a)?l=`>=${s}.0.0${n} <${+s+1}.0.0-0`:ra(c)?s==="0"?l=`>=${s}.${a}.0${n} <${s}.${+a+1}.0-0`:l=`>=${s}.${a}.0${n} <${+s+1}.0.0-0`:u?(Un("replaceCaret pr",u),s==="0"?a==="0"?l=`>=${s}.${a}.${c}-${u} <${s}.${a}.${+c+1}-0`:l=`>=${s}.${a}.${c}-${u} <${s}.${+a+1}.0-0`:l=`>=${s}.${a}.${c}-${u} <${+s+1}.0.0-0`):(Un("no pr"),s==="0"?a==="0"?l=`>=${s}.${a}.${c}${n} <${s}.${a}.${+c+1}-0`:l=`>=${s}.${a}.${c}${n} <${s}.${+a+1}.0-0`:l=`>=${s}.${a}.${c} <${+s+1}.0.0-0`),Un("caret return",l),l})},x3e=(t,e)=>(Un("replaceXRanges",t,e),t.split(/\s+/).map(r=>S3e(r,e)).join(" ")),S3e=(t,e)=>{t=t.trim();let r=e.loose?Pa[ta.XRANGELOOSE]:Pa[ta.XRANGE];return t.replace(r,(n,o,s,a,c,u)=>{Un("xRange",t,n,o,s,a,c,u);let l=ra(s),d=l||ra(a),p=d||ra(c),f=p;return o==="="&&f&&(o=""),u=e.includePrerelease?"-0":"",l?o===">"||o==="<"?n="<0.0.0-0":n="*":o&&f?(d&&(a=0),c=0,o===">"?(o=">=",d?(s=+s+1,a=0,c=0):(a=+a+1,c=0)):o==="<="&&(o="<",d?s=+s+1:a=+a+1),o==="<"&&(u="-0"),n=`${o+s}.${a}.${c}${u}`):d?n=`>=${s}.0.0${u} <${+s+1}.0.0-0`:p&&(n=`>=${s}.${a}.0${u} <${s}.${+a+1}.0-0`),Un("xRange return",n),n})},I3e=(t,e)=>(Un("replaceStars",t,e),t.trim().replace(Pa[ta.STAR],"")),C3e=(t,e)=>(Un("replaceGTE0",t,e),t.trim().replace(Pa[e.includePrerelease?ta.GTE0PRE:ta.GTE0],"")),T3e=t=>(e,r,n,o,s,a,c,u,l,d,p,f,m)=>(ra(n)?r="":ra(o)?r=`>=${n}.0.0${t?"-0":""}`:ra(s)?r=`>=${n}.${o}.0${t?"-0":""}`:a?r=`>=${r}`:r=`>=${r}${t?"-0":""}`,ra(l)?u="":ra(d)?u=`<${+l+1}.0.0-0`:ra(p)?u=`<${l}.${+d+1}.0-0`:f?u=`<=${l}.${d}.${p}-${f}`:t?u=`<${l}.${d}.${+p+1}-0`:u=`<=${u}`,`${r} ${u}`.trim()),E3e=(t,e,r)=>{for(let n=0;n<t.length;n++)if(!t[n].test(e))return!1;if(e.prerelease.length&&!r.includePrerelease){for(let n=0;n<t.length;n++)if(Un(t[n].semver),t[n].semver!==bB.ANY&&t[n].semver.prerelease.length>0){let o=t[n].semver;if(o.major===e.major&&o.minor===e.minor&&o.patch===e.patch)return!0}return!1}return!0}});var GE=L((tbt,Xoe)=>{var VE=Symbol("SemVer ANY"),SB=class t{static get ANY(){return VE}constructor(e,r){if(r=$oe(r),e instanceof t){if(e.loose===!!r.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),xB("comparator",e,r),this.options=r,this.loose=!!r.loose,this.parse(e),this.semver===VE?this.value="":this.value=this.operator+this.semver.version,xB("comp",this)}parse(e){let r=this.options.loose?Woe[Koe.COMPARATORLOOSE]:Woe[Koe.COMPARATOR],n=e.match(r);if(!n)throw new TypeError(`Invalid comparator: ${e}`);this.operator=n[1]!==void 0?n[1]:"",this.operator==="="&&(this.operator=""),n[2]?this.semver=new Yoe(n[2],this.options.loose):this.semver=VE}toString(){return this.value}test(e){if(xB("Comparator.test",e,this.options.loose),this.semver===VE||e===VE)return!0;if(typeof e=="string")try{e=new Yoe(e,this.options)}catch{return!1}return _B(e,this.operator,this.semver,this.options)}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new Qoe(e.value,r).test(this.value):e.operator===""?e.value===""?!0:new Qoe(this.value,r).test(e.semver):(r=$oe(r),r.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!r.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||_B(this.semver,"<",e.semver,r)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||_B(this.semver,">",e.semver,r)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}};Xoe.exports=SB;var $oe=FD(),{safeRe:Woe,t:Koe}=nx(),_B=fB(),xB=qE(),Yoe=Ds(),Qoe=Kc()});var $E=L((rbt,Joe)=>{var w3e=Kc(),R3e=(t,e,r)=>{try{e=new w3e(e,r)}catch{return!1}return e.test(t)};Joe.exports=R3e});var ese=L((nbt,Zoe)=>{var k3e=Kc(),A3e=(t,e)=>new k3e(t,e).set.map(r=>r.map(n=>n.value).join(" ").trim().split(" "));Zoe.exports=A3e});var rse=L((ibt,tse)=>{var P3e=Ds(),D3e=Kc(),N3e=(t,e,r)=>{let n=null,o=null,s=null;try{s=new D3e(e,r)}catch{return null}return t.forEach(a=>{s.test(a)&&(!n||o.compare(a)===-1)&&(n=a,o=new P3e(n,r))}),n};tse.exports=N3e});var ise=L((obt,nse)=>{var L3e=Ds(),O3e=Kc(),M3e=(t,e,r)=>{let n=null,o=null,s=null;try{s=new O3e(e,r)}catch{return null}return t.forEach(a=>{s.test(a)&&(!n||o.compare(a)===1)&&(n=a,o=new L3e(n,r))}),n};nse.exports=M3e});var ase=L((sbt,sse)=>{var IB=Ds(),F3e=Kc(),ose=HE(),U3e=(t,e)=>{t=new F3e(t,e);let r=new IB("0.0.0");if(t.test(r)||(r=new IB("0.0.0-0"),t.test(r)))return r;r=null;for(let n=0;n<t.set.length;++n){let o=t.set[n],s=null;o.forEach(a=>{let c=new IB(a.semver.version);switch(a.operator){case">":c.prerelease.length===0?c.patch++:c.prerelease.push(0),c.raw=c.format();case"":case">=":(!s||ose(c,s))&&(s=c);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${a.operator}`)}}),s&&(!r||ose(r,s))&&(r=s)}return r&&t.test(r)?r:null};sse.exports=U3e});var use=L((abt,cse)=>{var B3e=Kc(),q3e=(t,e)=>{try{return new B3e(t,e).range||"*"}catch{return null}};cse.exports=q3e});var WD=L((cbt,fse)=>{var H3e=Ds(),pse=GE(),{ANY:j3e}=pse,z3e=Kc(),G3e=$E(),lse=HE(),dse=HD(),V3e=zD(),$3e=jD(),W3e=(t,e,r,n)=>{t=new H3e(t,n),e=new z3e(e,n);let o,s,a,c,u;switch(r){case">":o=lse,s=V3e,a=dse,c=">",u=">=";break;case"<":o=dse,s=$3e,a=lse,c="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(G3e(t,e,n))return!1;for(let l=0;l<e.set.length;++l){let d=e.set[l],p=null,f=null;if(d.forEach(m=>{m.semver===j3e&&(m=new pse(">=0.0.0")),p=p||m,f=f||m,o(m.semver,p.semver,n)?p=m:a(m.semver,f.semver,n)&&(f=m)}),p.operator===c||p.operator===u||(!f.operator||f.operator===c)&&s(t,f.semver))return!1;if(f.operator===u&&a(t,f.semver))return!1}return!0};fse.exports=W3e});var hse=L((ubt,mse)=>{var K3e=WD(),Y3e=(t,e,r)=>K3e(t,e,">",r);mse.exports=Y3e});var vse=L((lbt,gse)=>{var Q3e=WD(),X3e=(t,e,r)=>Q3e(t,e,"<",r);gse.exports=X3e});var _se=L((dbt,bse)=>{var yse=Kc(),J3e=(t,e,r)=>(t=new yse(t,r),e=new yse(e,r),t.intersects(e,r));bse.exports=J3e});var Sse=L((pbt,xse)=>{var Z3e=$E(),e5e=Wc();xse.exports=(t,e,r)=>{let n=[],o=null,s=null,a=t.sort((d,p)=>e5e(d,p,r));for(let d of a)Z3e(d,e,r)?(s=d,o||(o=d)):(s&&n.push([o,s]),s=null,o=null);o&&n.push([o,null]);let c=[];for(let[d,p]of n)d===p?c.push(d):!p&&d===a[0]?c.push("*"):p?d===a[0]?c.push(`<=${p}`):c.push(`${d} - ${p}`):c.push(`>=${d}`);let u=c.join(" || "),l=typeof e.raw=="string"?e.raw:String(e);return u.length<l.length?u:e}});var Rse=L((fbt,wse)=>{var Ise=Kc(),TB=GE(),{ANY:CB}=TB,WE=$E(),EB=Wc(),t5e=(t,e,r={})=>{if(t===e)return!0;t=new Ise(t,r),e=new Ise(e,r);let n=!1;e:for(let o of t.set){for(let s of e.set){let a=n5e(o,s,r);if(n=n||a!==null,a)continue e}if(n)return!1}return!0},r5e=[new TB(">=0.0.0-0")],Cse=[new TB(">=0.0.0")],n5e=(t,e,r)=>{if(t===e)return!0;if(t.length===1&&t[0].semver===CB){if(e.length===1&&e[0].semver===CB)return!0;r.includePrerelease?t=r5e:t=Cse}if(e.length===1&&e[0].semver===CB){if(r.includePrerelease)return!0;e=Cse}let n=new Set,o,s;for(let m of t)m.operator===">"||m.operator===">="?o=Tse(o,m,r):m.operator==="<"||m.operator==="<="?s=Ese(s,m,r):n.add(m.semver);if(n.size>1)return null;let a;if(o&&s){if(a=EB(o.semver,s.semver,r),a>0)return null;if(a===0&&(o.operator!==">="||s.operator!=="<="))return null}for(let m of n){if(o&&!WE(m,String(o),r)||s&&!WE(m,String(s),r))return null;for(let h of e)if(!WE(m,String(h),r))return!1;return!0}let c,u,l,d,p=s&&!r.includePrerelease&&s.semver.prerelease.length?s.semver:!1,f=o&&!r.includePrerelease&&o.semver.prerelease.length?o.semver:!1;p&&p.prerelease.length===1&&s.operator==="<"&&p.prerelease[0]===0&&(p=!1);for(let m of e){if(d=d||m.operator===">"||m.operator===">=",l=l||m.operator==="<"||m.operator==="<=",o){if(f&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===f.major&&m.semver.minor===f.minor&&m.semver.patch===f.patch&&(f=!1),m.operator===">"||m.operator===">="){if(c=Tse(o,m,r),c===m&&c!==o)return!1}else if(o.operator===">="&&!WE(o.semver,String(m),r))return!1}if(s){if(p&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===p.major&&m.semver.minor===p.minor&&m.semver.patch===p.patch&&(p=!1),m.operator==="<"||m.operator==="<="){if(u=Ese(s,m,r),u===m&&u!==s)return!1}else if(s.operator==="<="&&!WE(s.semver,String(m),r))return!1}if(!m.operator&&(s||o)&&a!==0)return!1}return!(o&&l&&!s&&a!==0||s&&d&&!o&&a!==0||f||p)},Tse=(t,e,r)=>{if(!t)return e;let n=EB(t.semver,e.semver,r);return n>0?t:n<0||e.operator===">"&&t.operator===">="?e:t},Ese=(t,e,r)=>{if(!t)return e;let n=EB(t.semver,e.semver,r);return n<0?t:n>0||e.operator==="<"&&t.operator==="<="?e:t};wse.exports=t5e});var Dse=L((mbt,Pse)=>{var wB=nx(),kse=BE(),i5e=Ds(),Ase=uB(),o5e=T0(),s5e=Yie(),a5e=Xie(),c5e=eoe(),u5e=noe(),l5e=ooe(),d5e=aoe(),p5e=uoe(),f5e=doe(),m5e=Wc(),h5e=hoe(),g5e=voe(),v5e=qD(),y5e=xoe(),b5e=Ioe(),_5e=HE(),x5e=HD(),S5e=dB(),I5e=pB(),C5e=jD(),T5e=zD(),E5e=fB(),w5e=Doe(),R5e=GE(),k5e=Kc(),A5e=$E(),P5e=ese(),D5e=rse(),N5e=ise(),L5e=ase(),O5e=use(),M5e=WD(),F5e=hse(),U5e=vse(),B5e=_se(),q5e=Sse(),H5e=Rse();Pse.exports={parse:o5e,valid:s5e,clean:a5e,inc:c5e,diff:u5e,major:l5e,minor:d5e,patch:p5e,prerelease:f5e,compare:m5e,rcompare:h5e,compareLoose:g5e,compareBuild:v5e,sort:y5e,rsort:b5e,gt:_5e,lt:x5e,eq:S5e,neq:I5e,gte:C5e,lte:T5e,cmp:E5e,coerce:w5e,Comparator:R5e,Range:k5e,satisfies:A5e,toComparators:P5e,maxSatisfying:D5e,minSatisfying:N5e,minVersion:L5e,validRange:O5e,outside:M5e,gtr:F5e,ltr:U5e,intersects:B5e,simplifyRange:q5e,subset:H5e,SemVer:i5e,re:wB.re,src:wB.src,tokens:wB.t,SEMVER_SPEC_VERSION:kse.SEMVER_SPEC_VERSION,RELEASE_TYPES:kse.RELEASE_TYPES,compareIdentifiers:Ase.compareIdentifiers,rcompareIdentifiers:Ase.rcompareIdentifiers}});var RB=L(KD=>{"use strict";Object.defineProperty(KD,"__esModule",{value:!0});KD.makePatchingRequire=void 0;var j5e=require("path"),z5e=Dse(),Nse=_i(),Ose=require("module"),G5e=Object.keys(process.binding("natives")),Lse=Ose.prototype.require;function V5e(t){var e={};return function(n){var o=Lse.apply(this,arguments);if(t[n]){var s=Ose._resolveFilename(n,this);if(e.hasOwnProperty(s))return e[s];var a=void 0;if(G5e.indexOf(n)<0)try{a=Lse.call(this,j5e.join(n,"package.json")).version}catch{return o}else a=process.version.substring(1);var c=a.indexOf("-");c>=0&&(a=a.substring(0,c));for(var u=o,l=0,d=t[n];l<d.length;l++){var p=d[l];if(z5e.satisfies(a,p.versionSpecifier)&&(u=p.patch(u,s),Nse.channel)){var f=p.publisherName||n;Nse.channel.addPatchedModule(f,a)}}return e[s]=u}return o}}KD.makePatchingRequire=V5e});var Mse=L((gbt,$5e)=>{$5e.exports={name:"diagnostic-channel",version:"1.1.1",main:"./dist/src/channel.js",types:"./dist/src/channel.d.ts",scripts:{build:"tsc",lint:"eslint ./ --fix",clean:"rimraf ./dist",test:"mocha ./dist/tests/**/*.js",debug:"mocha --inspect-brk ./dist/tests/**/*.js"},homepage:"https://github.com/Microsoft/node-diagnostic-channel",bugs:{url:"https://github.com/Microsoft/node-diagnostic-channel/issues"},repository:{type:"git",url:"https://github.com/Microsoft/node-diagnostic-channel.git"},description:"Provides a context-saving pub/sub channel to connect diagnostic event publishers and subscribers",dependencies:{semver:"^7.5.3"},devDependencies:{"@types/mocha":"^2.2.40","@types/node":"~8.0.0",mocha:"^3.2.0",rimraf:"^2.6.1",sinon:"1.17.6",typescript:"4.1.2"},files:["dist/src/**/*.d.ts","dist/src/**/*.js","LICENSE","README.md","package.json"],license:"MIT"}});var _i=L(Yc=>{"use strict";Object.defineProperty(Yc,"__esModule",{value:!0});Yc.channel=Yc.ContextPreservingEventEmitter=Yc.trueFilter=Yc.makePatchingRequire=void 0;var W5e=RB(),K5e=RB();Object.defineProperty(Yc,"makePatchingRequire",{enumerable:!0,get:function(){return K5e.makePatchingRequire}});var Y5e=function(t){return!0};Yc.trueFilter=Y5e;var Use=function(){function t(){this.version=Mse().version,this.subscribers={},this.contextPreservationFunction=function(e){return e},this.knownPatches={},this.modulesPatched=[],this.currentlyPublishing=!1}return t.prototype.shouldPublish=function(e){var r=this.subscribers[e];return r?r.some(function(n){var o=n.filter;return!o||o(!1)}):!1},t.prototype.publish=function(e,r){if(!this.currentlyPublishing){var n=this.subscribers[e];if(n){var o={timestamp:Date.now(),data:r};this.currentlyPublishing=!0,n.forEach(function(s){var a=s.listener,c=s.filter;try{c&&c(!0)&&a(o)}catch{}}),this.currentlyPublishing=!1}}},t.prototype.subscribe=function(e,r,n,o){n===void 0&&(n=Yc.trueFilter),this.subscribers[e]||(this.subscribers[e]=[]),this.subscribers[e].push({listener:r,filter:n,patchCallback:o});var s=this.checkIfModuleIsAlreadyPatched(e);s&&o&&o(s.name,s.version)},t.prototype.unsubscribe=function(e,r,n){n===void 0&&(n=Yc.trueFilter);var o=this.subscribers[e];if(o){for(var s=0;s<o.length;++s)if(o[s].listener===r&&o[s].filter===n)return o.splice(s,1),!0}return!1},t.prototype.reset=function(){var e=this;this.subscribers={},this.contextPreservationFunction=function(r){return r},Object.getOwnPropertyNames(this.knownPatches).forEach(function(r){return delete e.knownPatches[r]})},t.prototype.bindToContext=function(e){return this.contextPreservationFunction(e)},t.prototype.addContextPreservation=function(e){var r=this.contextPreservationFunction;this.contextPreservationFunction=function(n){return e(r(n))}},t.prototype.registerMonkeyPatch=function(e,r){this.knownPatches[e]||(this.knownPatches[e]=[]),this.knownPatches[e].push(r)},t.prototype.getPatchesObject=function(){return this.knownPatches},t.prototype.addPatchedModule=function(e,r){for(var n=0,o=this.modulesPatched;n<o.length;n++){var s=o[n];if(s.name===e)return}this.modulesPatched.push({name:e,version:r});var a=this.subscribers[e];a&&a.forEach(function(c){c.patchCallback&&c.patchCallback(e,r)})},t.prototype.checkIfModuleIsAlreadyPatched=function(e){for(var r=0,n=this.modulesPatched;r<n.length;r++){var o=n[r];if(o.name===e)return o}return null},t}();Yc.ContextPreservingEventEmitter=Use;global.diagnosticsSource||(global.diagnosticsSource=new Use,Fse=require("module"),Fse.prototype.require=W5e.makePatchingRequire(global.diagnosticsSource.getPatchesObject()));var Fse;Yc.channel=global.diagnosticsSource});var Bse,qse=R(()=>{Bse=typeof globalThis=="object"?globalThis:global});var Hse=R(()=>{qse()});var jse=R(()=>{Hse()});var $p,kB=R(()=>{$p="1.6.0"});function Q5e(t){var e=new Set([t]),r=new Set,n=t.match(zse);if(!n)return function(){return!1};var o={major:+n[1],minor:+n[2],patch:+n[3],prerelease:n[4]};if(o.prerelease!=null)return function(u){return u===t};function s(c){return r.add(c),!1}function a(c){return e.add(c),!0}return function(u){if(e.has(u))return!0;if(r.has(u))return!1;var l=u.match(zse);if(!l)return s(u);var d={major:+l[1],minor:+l[2],patch:+l[3],prerelease:l[4]};return d.prerelease!=null||o.major!==d.major?s(u):o.major===0?o.minor===d.minor&&o.patch<=d.patch?a(u):s(u):o.minor<=d.minor?a(u):s(u)}}var zse,Gse,Vse=R(()=>{kB();zse=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;Gse=Q5e($p)});function td(t,e,r,n){var o;n===void 0&&(n=!1);var s=YE[KE]=(o=YE[KE])!==null&&o!==void 0?o:{version:$p};if(!n&&s[t]){var a=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+t);return r.error(a.stack||a.message),!1}if(s.version!==$p){var a=new Error("@opentelemetry/api: Registration of version v"+s.version+" for "+t+" does not match previously registered API v"+$p);return r.error(a.stack||a.message),!1}return s[t]=e,r.debug("@opentelemetry/api: Registered a global for "+t+" v"+$p+"."),!0}function pc(t){var e,r,n=(e=YE[KE])===null||e===void 0?void 0:e.version;if(!(!n||!Gse(n)))return(r=YE[KE])===null||r===void 0?void 0:r[t]}function rd(t,e){e.debug("@opentelemetry/api: Unregistering a global for "+t+" v"+$p+".");var r=YE[KE];r&&delete r[t]}var X5e,KE,YE,k0=R(()=>{jse();kB();Vse();X5e=$p.split(".")[0],KE=Symbol.for("opentelemetry.js.api."+X5e),YE=Bse});function QE(t,e,r){var n=pc("diag");if(n)return r.unshift(e),n[t].apply(n,Z5e([],J5e(r),!1))}var J5e,Z5e,$se,Wse=R(()=>{k0();J5e=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},Z5e=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,s;n<o;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},$se=function(){function t(e){this._namespace=e.namespace||"DiagComponentLogger"}return t.prototype.debug=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return QE("debug",this._namespace,e)},t.prototype.error=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return QE("error",this._namespace,e)},t.prototype.info=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return QE("info",this._namespace,e)},t.prototype.warn=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return QE("warn",this._namespace,e)},t.prototype.verbose=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return QE("verbose",this._namespace,e)},t}()});var xn,YD=R(()=>{(function(t){t[t.NONE=0]="NONE",t[t.ERROR=30]="ERROR",t[t.WARN=50]="WARN",t[t.INFO=60]="INFO",t[t.DEBUG=70]="DEBUG",t[t.VERBOSE=80]="VERBOSE",t[t.ALL=9999]="ALL"})(xn||(xn={}))});function Kse(t,e){t<xn.NONE?t=xn.NONE:t>xn.ALL&&(t=xn.ALL),e=e||{};function r(n,o){var s=e[n];return typeof s=="function"&&t>=o?s.bind(e):function(){}}return{error:r("error",xn.ERROR),warn:r("warn",xn.WARN),info:r("info",xn.INFO),debug:r("debug",xn.DEBUG),verbose:r("verbose",xn.VERBOSE)}}var Yse=R(()=>{YD()});var e6e,t6e,r6e,Ns,A0=R(()=>{Wse();Yse();YD();k0();e6e=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},t6e=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,s;n<o;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},r6e="diag",Ns=function(){function t(){function e(o){return function(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];var c=pc("diag");if(c)return c[o].apply(c,t6e([],e6e(s),!1))}}var r=this,n=function(o,s){var a,c,u;if(s===void 0&&(s={logLevel:xn.INFO}),o===r){var l=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return r.error((a=l.stack)!==null&&a!==void 0?a:l.message),!1}typeof s=="number"&&(s={logLevel:s});var d=pc("diag"),p=Kse((c=s.logLevel)!==null&&c!==void 0?c:xn.INFO,o);if(d&&!s.suppressOverrideMessage){var f=(u=new Error().stack)!==null&&u!==void 0?u:"<failed to generate stacktrace>";d.warn("Current logger will be overwritten from "+f),p.warn("Current logger will overwrite one already registered from "+f)}return td("diag",p,r,!0)};r.setLogger=n,r.disable=function(){rd(r6e,r)},r.createComponentLogger=function(o){return new $se(o)},r.verbose=e("verbose"),r.debug=e("debug"),r.info=e("info"),r.warn=e("warn"),r.error=e("error")}return t.instance=function(){return this._instance||(this._instance=new t),this._instance},t}()});var n6e,i6e,Qse,Xse=R(()=>{n6e=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},i6e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Qse=function(){function t(e){this._entries=e?new Map(e):new Map}return t.prototype.getEntry=function(e){var r=this._entries.get(e);if(r)return Object.assign({},r)},t.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map(function(e){var r=n6e(e,2),n=r[0],o=r[1];return[n,o]})},t.prototype.setEntry=function(e,r){var n=new t(this._entries);return n._entries.set(e,r),n},t.prototype.removeEntry=function(e){var r=new t(this._entries);return r._entries.delete(e),r},t.prototype.removeEntries=function(){for(var e,r,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var s=new t(this._entries);try{for(var a=i6e(n),c=a.next();!c.done;c=a.next()){var u=c.value;s._entries.delete(u)}}catch(l){e={error:l}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}return s},t.prototype.clear=function(){return new t},t}()});var Jse,Zse=R(()=>{Jse=Symbol("BaggageEntryMetadata")});function eae(t){return t===void 0&&(t={}),new Qse(new Map(Object.entries(t)))}function QD(t){return typeof t!="string"&&(o6e.error("Cannot create baggage metadata from unknown type: "+typeof t),t=""),{__TYPE__:Jse,toString:function(){return t}}}var o6e,AB=R(()=>{A0();Xse();Zse();o6e=Ns.instance()});function nd(t){return Symbol.for(t)}var s6e,XD,XE=R(()=>{s6e=function(){function t(e){var r=this;r._currentContext=e?new Map(e):new Map,r.getValue=function(n){return r._currentContext.get(n)},r.setValue=function(n,o){var s=new t(r._currentContext);return s._currentContext.set(n,o),s},r.deleteValue=function(n){var o=new t(r._currentContext);return o._currentContext.delete(n),o}}return t}(),XD=new s6e});var PB,tae,rae=R(()=>{PB=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}],tae=function(){function t(){function e(n){return function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];if(console){var a=console[n];if(typeof a!="function"&&(a=console.log),typeof a=="function")return a.apply(console,o)}}}for(var r=0;r<PB.length;r++)this[PB[r].n]=e(PB[r].c)}return t}()});function nae(){return LB}var ax,a6e,DB,c6e,u6e,l6e,NB,d6e,p6e,f6e,LB,m6e,h6e,g6e,v6e,y6e,b6e,OB=R(()=>{ax=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),a6e=function(){function t(){}return t.prototype.createHistogram=function(e,r){return h6e},t.prototype.createCounter=function(e,r){return m6e},t.prototype.createUpDownCounter=function(e,r){return g6e},t.prototype.createObservableGauge=function(e,r){return y6e},t.prototype.createObservableCounter=function(e,r){return v6e},t.prototype.createObservableUpDownCounter=function(e,r){return b6e},t.prototype.addBatchObservableCallback=function(e,r){},t.prototype.removeBatchObservableCallback=function(e){},t}(),DB=function(){function t(){}return t}(),c6e=function(t){ax(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.add=function(r,n){},e}(DB),u6e=function(t){ax(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.add=function(r,n){},e}(DB),l6e=function(t){ax(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.record=function(r,n){},e}(DB),NB=function(){function t(){}return t.prototype.addCallback=function(e){},t.prototype.removeCallback=function(e){},t}(),d6e=function(t){ax(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(NB),p6e=function(t){ax(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(NB),f6e=function(t){ax(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(NB),LB=new a6e,m6e=new c6e,h6e=new l6e,g6e=new u6e,v6e=new d6e,y6e=new p6e,b6e=new f6e});var JD,iae=R(()=>{(function(t){t[t.INT=0]="INT",t[t.DOUBLE=1]="DOUBLE"})(JD||(JD={}))});var ZD,eN,MB=R(()=>{ZD={get:function(t,e){if(t!=null)return t[e]},keys:function(t){return t==null?[]:Object.keys(t)}},eN={set:function(t,e,r){t!=null&&(t[e]=r)}}});var _6e,x6e,oae,sae=R(()=>{XE();_6e=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},x6e=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,s;n<o;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},oae=function(){function t(){}return t.prototype.active=function(){return XD},t.prototype.with=function(e,r,n){for(var o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return r.call.apply(r,x6e([n],_6e(o),!1))},t.prototype.bind=function(e,r){return r},t.prototype.enable=function(){return this},t.prototype.disable=function(){return this},t}()});var S6e,I6e,FB,C6e,ah,JE=R(()=>{sae();k0();A0();S6e=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},I6e=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,s;n<o;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},FB="context",C6e=new oae,ah=function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalContextManager=function(e){return td(FB,e,Ns.instance())},t.prototype.active=function(){return this._getContextManager().active()},t.prototype.with=function(e,r,n){for(var o,s=[],a=3;a<arguments.length;a++)s[a-3]=arguments[a];return(o=this._getContextManager()).with.apply(o,I6e([e,r,n],S6e(s),!1))},t.prototype.bind=function(e,r){return this._getContextManager().bind(e,r)},t.prototype._getContextManager=function(){return pc(FB)||C6e},t.prototype.disable=function(){this._getContextManager().disable(),rd(FB,Ns.instance())},t}()});var Ni,UB=R(()=>{(function(t){t[t.NONE=0]="NONE",t[t.SAMPLED=1]="SAMPLED"})(Ni||(Ni={}))});var ZE,ew,cx,tN=R(()=>{UB();ZE="0000000000000000",ew="00000000000000000000000000000000",cx={traceId:ew,spanId:ZE,traceFlags:Ni.NONE}});var ch,rN=R(()=>{tN();ch=function(){function t(e){e===void 0&&(e=cx),this._spanContext=e}return t.prototype.spanContext=function(){return this._spanContext},t.prototype.setAttribute=function(e,r){return this},t.prototype.setAttributes=function(e){return this},t.prototype.addEvent=function(e,r){return this},t.prototype.setStatus=function(e){return this},t.prototype.updateName=function(e){return this},t.prototype.end=function(e){},t.prototype.isRecording=function(){return!1},t.prototype.recordException=function(e,r){},t}()});function nN(t){return t.getValue(BB)||void 0}function aae(){return nN(ah.getInstance().active())}function tw(t,e){return t.setValue(BB,e)}function cae(t){return t.deleteValue(BB)}function uae(t,e){return tw(t,new ch(e))}function iN(t){var e;return(e=nN(t))===null||e===void 0?void 0:e.spanContext()}var BB,qB=R(()=>{XE();rN();JE();BB=nd("OpenTelemetry Context Key SPAN")});function P0(t){return T6e.test(t)&&t!==ew}function HB(t){return E6e.test(t)&&t!==ZE}function Qc(t){return P0(t.traceId)&&HB(t.spanId)}function lae(t){return new ch(t)}var T6e,E6e,oN=R(()=>{tN();rN();T6e=/^([0-9a-f]{32})$/i,E6e=/^[0-9a-f]{16}$/i});function w6e(t){return typeof t=="object"&&typeof t.spanId=="string"&&typeof t.traceId=="string"&&typeof t.traceFlags=="number"}var jB,sN,zB=R(()=>{JE();qB();rN();oN();jB=ah.getInstance(),sN=function(){function t(){}return t.prototype.startSpan=function(e,r,n){n===void 0&&(n=jB.active());var o=!!r?.root;if(o)return new ch;var s=n&&iN(n);return w6e(s)&&Qc(s)?new ch(s):new ch},t.prototype.startActiveSpan=function(e,r,n,o){var s,a,c;if(!(arguments.length<2)){arguments.length===2?c=r:arguments.length===3?(s=r,c=n):(s=r,a=n,c=o);var u=a??jB.active(),l=this.startSpan(e,s,u),d=tw(u,l);return jB.with(d,c,void 0,l)}},t}()});var R6e,aN,GB=R(()=>{zB();R6e=new sN,aN=function(){function t(e,r,n,o){this._provider=e,this.name=r,this.version=n,this.options=o}return t.prototype.startSpan=function(e,r,n){return this._getTracer().startSpan(e,r,n)},t.prototype.startActiveSpan=function(e,r,n,o){var s=this._getTracer();return Reflect.apply(s.startActiveSpan,s,arguments)},t.prototype._getTracer=function(){if(this._delegate)return this._delegate;var e=this._provider.getDelegateTracer(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):R6e},t}()});var dae,pae=R(()=>{zB();dae=function(){function t(){}return t.prototype.getTracer=function(e,r,n){return new sN},t}()});var k6e,rw,VB=R(()=>{GB();pae();k6e=new dae,rw=function(){function t(){}return t.prototype.getTracer=function(e,r,n){var o;return(o=this.getDelegateTracer(e,r,n))!==null&&o!==void 0?o:new aN(this,e,r,n)},t.prototype.getDelegate=function(){var e;return(e=this._delegate)!==null&&e!==void 0?e:k6e},t.prototype.setDelegate=function(e){this._delegate=e},t.prototype.getDelegateTracer=function(e,r,n){var o;return(o=this._delegate)===null||o===void 0?void 0:o.getTracer(e,r,n)},t}()});var Da,fae=R(()=>{(function(t){t[t.NOT_RECORD=0]="NOT_RECORD",t[t.RECORD=1]="RECORD",t[t.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"})(Da||(Da={}))});var ux,mae=R(()=>{(function(t){t[t.INTERNAL=0]="INTERNAL",t[t.SERVER=1]="SERVER",t[t.CLIENT=2]="CLIENT",t[t.PRODUCER=3]="PRODUCER",t[t.CONSUMER=4]="CONSUMER"})(ux||(ux={}))});var lx,hae=R(()=>{(function(t){t[t.UNSET=0]="UNSET",t[t.OK=1]="OK",t[t.ERROR=2]="ERROR"})(lx||(lx={}))});function gae(t){return D6e.test(t)}function vae(t){return N6e.test(t)&&!L6e.test(t)}var $B,A6e,P6e,D6e,N6e,L6e,yae=R(()=>{$B="[_0-9a-z-*/]",A6e="[a-z]"+$B+"{0,255}",P6e="[a-z0-9]"+$B+"{0,240}@[a-z]"+$B+"{0,13}",D6e=new RegExp("^(?:"+A6e+"|"+P6e+")$"),N6e=/^[ -~]{0,255}[!-~]$/,L6e=/,|=/});var bae,O6e,_ae,xae,Sae,Iae=R(()=>{yae();bae=32,O6e=512,_ae=",",xae="=",Sae=function(){function t(e){this._internalState=new Map,e&&this._parse(e)}return t.prototype.set=function(e,r){var n=this._clone();return n._internalState.has(e)&&n._internalState.delete(e),n._internalState.set(e,r),n},t.prototype.unset=function(e){var r=this._clone();return r._internalState.delete(e),r},t.prototype.get=function(e){return this._internalState.get(e)},t.prototype.serialize=function(){var e=this;return this._keys().reduce(function(r,n){return r.push(n+xae+e.get(n)),r},[]).join(_ae)},t.prototype._parse=function(e){e.length>O6e||(this._internalState=e.split(_ae).reverse().reduce(function(r,n){var o=n.trim(),s=o.indexOf(xae);if(s!==-1){var a=o.slice(0,s),c=o.slice(s+1,n.length);gae(a)&&vae(c)&&r.set(a,c)}return r},new Map),this._internalState.size>bae&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,bae))))},t.prototype._keys=function(){return Array.from(this._internalState.keys()).reverse()},t.prototype._clone=function(){var e=new t;return e._internalState=new Map(this._internalState),e},t}()});function Cae(t){return new Sae(t)}var Tae=R(()=>{Iae()});var na,Eae=R(()=>{JE();na=ah.getInstance()});var dt,wae=R(()=>{A0();dt=Ns.instance()});var M6e,Rae,kae=R(()=>{OB();M6e=function(){function t(){}return t.prototype.getMeter=function(e,r,n){return LB},t}(),Rae=new M6e});var WB,Aae,Pae=R(()=>{kae();k0();A0();WB="metrics",Aae=function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalMeterProvider=function(e){return td(WB,e,Ns.instance())},t.prototype.getMeterProvider=function(){return pc(WB)||Rae},t.prototype.getMeter=function(e,r,n){return this.getMeterProvider().getMeter(e,r,n)},t.prototype.disable=function(){rd(WB,Ns.instance())},t}()});var KB,Dae=R(()=>{Pae();KB=Aae.getInstance()});var Nae,Lae=R(()=>{Nae=function(){function t(){}return t.prototype.inject=function(e,r){},t.prototype.extract=function(e,r){return e},t.prototype.fields=function(){return[]},t}()});function QB(t){return t.getValue(YB)||void 0}function Oae(){return QB(ah.getInstance().active())}function Mae(t,e){return t.setValue(YB,e)}function Fae(t){return t.deleteValue(YB)}var YB,Uae=R(()=>{JE();XE();YB=nd("OpenTelemetry Baggage Key")});var XB,F6e,Bae,qae=R(()=>{k0();Lae();MB();Uae();AB();A0();XB="propagation",F6e=new Nae,Bae=function(){function t(){this.createBaggage=eae,this.getBaggage=QB,this.getActiveBaggage=Oae,this.setBaggage=Mae,this.deleteBaggage=Fae}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalPropagator=function(e){return td(XB,e,Ns.instance())},t.prototype.inject=function(e,r,n){return n===void 0&&(n=eN),this._getGlobalPropagator().inject(e,r,n)},t.prototype.extract=function(e,r,n){return n===void 0&&(n=ZD),this._getGlobalPropagator().extract(e,r,n)},t.prototype.fields=function(){return this._getGlobalPropagator().fields()},t.prototype.disable=function(){rd(XB,Ns.instance())},t.prototype._getGlobalPropagator=function(){return pc(XB)||F6e},t}()});var Wp,Hae=R(()=>{qae();Wp=Bae.getInstance()});var JB,jae,zae=R(()=>{k0();VB();oN();qB();A0();JB="trace",jae=function(){function t(){this._proxyTracerProvider=new rw,this.wrapSpanContext=lae,this.isSpanContextValid=Qc,this.deleteSpan=cae,this.getSpan=nN,this.getActiveSpan=aae,this.getSpanContext=iN,this.setSpan=tw,this.setSpanContext=uae}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalTracerProvider=function(e){var r=td(JB,this._proxyTracerProvider,Ns.instance());return r&&this._proxyTracerProvider.setDelegate(e),r},t.prototype.getTracerProvider=function(){return pc(JB)||this._proxyTracerProvider},t.prototype.getTracer=function(e,r){return this.getTracerProvider().getTracer(e,r)},t.prototype.disable=function(){rd(JB,Ns.instance()),this._proxyTracerProvider=new rw},t}()});var go,Gae=R(()=>{zae();go=jae.getInstance()});var dx={};dn(dx,{DiagConsoleLogger:()=>tae,DiagLogLevel:()=>xn,INVALID_SPANID:()=>ZE,INVALID_SPAN_CONTEXT:()=>cx,INVALID_TRACEID:()=>ew,ProxyTracer:()=>aN,ProxyTracerProvider:()=>rw,ROOT_CONTEXT:()=>XD,SamplingDecision:()=>Da,SpanKind:()=>ux,SpanStatusCode:()=>lx,TraceFlags:()=>Ni,ValueType:()=>JD,baggageEntryMetadataFromString:()=>QD,context:()=>na,createContextKey:()=>nd,createNoopMeter:()=>nae,createTraceState:()=>Cae,default:()=>U6e,defaultTextMapGetter:()=>ZD,defaultTextMapSetter:()=>eN,diag:()=>dt,isSpanContextValid:()=>Qc,isValidSpanId:()=>HB,isValidTraceId:()=>P0,metrics:()=>KB,propagation:()=>Wp,trace:()=>go});var U6e,gr=R(()=>{AB();XE();rae();YD();OB();iae();MB();GB();VB();fae();mae();hae();UB();Tae();oN();tN();Eae();wae();Dae();Hae();Gae();U6e={context:na,diag:dt,metrics:KB,propagation:Wp,trace:go}});function nw(t){return t.setValue(ZB,!0)}function B6e(t){return t.deleteValue(ZB)}function D0(t){return t.getValue(ZB)===!0}var ZB,iw=R(()=>{gr();ZB=nd("OpenTelemetry SDK Context Key SUPPRESS_TRACING")});var Vae,cN,px,uN,$ae,Wae,Kae,eq=R(()=>{Vae="=",cN=";",px=",",uN="baggage",$ae=180,Wae=4096,Kae=8192});var nq={};dn(nq,{getKeyPairs:()=>rq,parseKeyPairsIntoRecord:()=>H6e,parsePairKeyValue:()=>lN,serializeKeyPairs:()=>tq});function tq(t){return t.reduce(function(e,r){var n=""+e+(e!==""?px:"")+r;return n.length>Kae?e:n},"")}function rq(t){return t.getAllEntries().map(function(e){var r=q6e(e,2),n=r[0],o=r[1],s=encodeURIComponent(n)+"="+encodeURIComponent(o.value);return o.metadata!==void 0&&(s+=cN+o.metadata.toString()),s})}function lN(t){var e=t.split(cN);if(!(e.length<=0)){var r=e.shift();if(r){var n=r.indexOf(Vae);if(!(n<=0)){var o=decodeURIComponent(r.substring(0,n).trim()),s=decodeURIComponent(r.substring(n+1).trim()),a;return e.length>0&&(a=QD(e.join(cN))),{key:o,value:s,metadata:a}}}}}function H6e(t){return typeof t!="string"||t.length===0?{}:t.split(px).map(function(e){return lN(e)}).filter(function(e){return e!==void 0&&e.value.length>0}).reduce(function(e,r){return e[r.key]=r.value,e},{})}var q6e,iq=R(()=>{gr();eq();q6e=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s}});var oq,Yae=R(()=>{gr();iw();eq();iq();oq=function(){function t(){}return t.prototype.inject=function(e,r,n){var o=Wp.getBaggage(e);if(!(!o||D0(e))){var s=rq(o).filter(function(c){return c.length<=Wae}).slice(0,$ae),a=tq(s);a.length>0&&n.set(r,uN,a)}},t.prototype.extract=function(e,r,n){var o=n.get(r,uN),s=Array.isArray(o)?o.join(px):o;if(!s)return e;var a={};if(s.length===0)return e;var c=s.split(px);return c.forEach(function(u){var l=lN(u);if(l){var d={value:l.value};l.metadata&&(d.metadata=l.metadata),a[l.key]=d}}),Object.entries(a).length===0?e:Wp.setBaggage(e,Wp.createBaggage(a))},t.prototype.fields=function(){return[uN]},t}()});var j6e,Qae=R(()=>{j6e=function(){function t(e,r){this._monotonicClock=r,this._epochMillis=e.now(),this._performanceMillis=r.now()}return t.prototype.now=function(){var e=this._monotonicClock.now()-this._performanceMillis;return this._epochMillis+e},t}()});function N0(t){var e,r,n={};if(typeof t!="object"||t==null)return n;try{for(var o=Xae(Object.entries(t)),s=o.next();!s.done;s=o.next()){var a=z6e(s.value,2),c=a[0],u=a[1];if(!Jae(c)){dt.warn("Invalid attribute key: "+c);continue}if(!dN(u)){dt.warn("Invalid attribute value set for key: "+c);continue}Array.isArray(u)?n[c]=u.slice():n[c]=u}}catch(l){e={error:l}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return n}function Jae(t){return typeof t=="string"&&t.length>0}function dN(t){return t==null?!0:Array.isArray(t)?G6e(t):Zae(t)}function G6e(t){var e,r,n;try{for(var o=Xae(t),s=o.next();!s.done;s=o.next()){var a=s.value;if(a!=null){if(!n){if(Zae(a)){n=typeof a;continue}return!1}if(typeof a!==n)return!1}}}catch(c){e={error:c}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return!0}function Zae(t){switch(typeof t){case"number":case"boolean":case"string":return!0}return!1}var Xae,z6e,ece=R(()=>{gr();Xae=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},z6e=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s}});function sq(){return function(t){dt.error(V6e(t))}}function V6e(t){return typeof t=="string"?t:JSON.stringify($6e(t))}function $6e(t){for(var e={},r=t;r!==null;)Object.getOwnPropertyNames(r).forEach(function(n){if(!e[n]){var o=r[n];o&&(e[n]=String(o))}}),r=Object.getPrototypeOf(r);return e}var aq=R(()=>{gr()});function W6e(t){tce=t}function Na(t){try{tce(t)}catch{}}var tce,cq=R(()=>{aq();tce=sq()});var fc,uq=R(()=>{(function(t){t.AlwaysOff="always_off",t.AlwaysOn="always_on",t.ParentBasedAlwaysOff="parentbased_always_off",t.ParentBasedAlwaysOn="parentbased_always_on",t.ParentBasedTraceIdRatio="parentbased_traceidratio",t.TraceIdRatio="traceidratio"})(fc||(fc={}))});var rce,nce=R(()=>{rce=typeof globalThis=="object"?globalThis:typeof self=="object"?self:typeof window=="object"?window:typeof global=="object"?global:{}});function Q6e(t){return Y6e.indexOf(t)>-1}function J6e(t){return X6e.indexOf(t)>-1}function e8e(t){return Z6e.indexOf(t)>-1}function t8e(t,e,r){if(!(typeof r[t]>"u")){var n=String(r[t]);e[t]=n.toLowerCase()==="true"}}function r8e(t,e,r,n,o){if(n===void 0&&(n=-1/0),o===void 0&&(o=1/0),typeof r[t]<"u"){var s=Number(r[t]);isNaN(s)||(s<n?e[t]=n:s>o?e[t]=o:e[t]=s)}}function n8e(t,e,r,n){n===void 0&&(n=K6e);var o=r[t];typeof o=="string"&&(e[t]=o.split(n).map(function(s){return s.trim()}))}function o8e(t,e,r){var n=r[t];if(typeof n=="string"){var o=i8e[n.toUpperCase()];o!=null&&(e[t]=o)}}function ow(t){var e={};for(var r in pN){var n=r;switch(n){case"OTEL_LOG_LEVEL":o8e(n,e,t);break;default:if(Q6e(n))t8e(n,e,t);else if(J6e(n))r8e(n,e,t);else if(e8e(n))n8e(n,e,t);else{var o=t[n];typeof o<"u"&&o!==null&&(e[n]=String(o))}}}return e}function lq(){return typeof process<"u"&&process&&process.env?ow(process.env):ow(rce)}var K6e,Y6e,X6e,Z6e,fx,mx,ice,oce,pN,i8e,dq=R(()=>{gr();uq();nce();K6e=",",Y6e=["OTEL_SDK_DISABLED"];X6e=["OTEL_BSP_EXPORT_TIMEOUT","OTEL_BSP_MAX_EXPORT_BATCH_SIZE","OTEL_BSP_MAX_QUEUE_SIZE","OTEL_BSP_SCHEDULE_DELAY","OTEL_BLRP_EXPORT_TIMEOUT","OTEL_BLRP_MAX_EXPORT_BATCH_SIZE","OTEL_BLRP_MAX_QUEUE_SIZE","OTEL_BLRP_SCHEDULE_DELAY","OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT","OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_EVENT_COUNT_LIMIT","OTEL_SPAN_LINK_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT","OTEL_EXPORTER_OTLP_TIMEOUT","OTEL_EXPORTER_OTLP_TRACES_TIMEOUT","OTEL_EXPORTER_OTLP_METRICS_TIMEOUT","OTEL_EXPORTER_OTLP_LOGS_TIMEOUT","OTEL_EXPORTER_JAEGER_AGENT_PORT"];Z6e=["OTEL_NO_PATCH_MODULES","OTEL_PROPAGATORS"];fx=1/0,mx=128,ice=128,oce=128,pN={OTEL_SDK_DISABLED:!1,CONTAINER_NAME:"",ECS_CONTAINER_METADATA_URI_V4:"",ECS_CONTAINER_METADATA_URI:"",HOSTNAME:"",KUBERNETES_SERVICE_HOST:"",NAMESPACE:"",OTEL_BSP_EXPORT_TIMEOUT:3e4,OTEL_BSP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BSP_MAX_QUEUE_SIZE:2048,OTEL_BSP_SCHEDULE_DELAY:5e3,OTEL_BLRP_EXPORT_TIMEOUT:3e4,OTEL_BLRP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BLRP_MAX_QUEUE_SIZE:2048,OTEL_BLRP_SCHEDULE_DELAY:5e3,OTEL_EXPORTER_JAEGER_AGENT_HOST:"",OTEL_EXPORTER_JAEGER_AGENT_PORT:6832,OTEL_EXPORTER_JAEGER_ENDPOINT:"",OTEL_EXPORTER_JAEGER_PASSWORD:"",OTEL_EXPORTER_JAEGER_USER:"",OTEL_EXPORTER_OTLP_ENDPOINT:"",OTEL_EXPORTER_OTLP_TRACES_ENDPOINT:"",OTEL_EXPORTER_OTLP_METRICS_ENDPOINT:"",OTEL_EXPORTER_OTLP_LOGS_ENDPOINT:"",OTEL_EXPORTER_OTLP_HEADERS:"",OTEL_EXPORTER_OTLP_TRACES_HEADERS:"",OTEL_EXPORTER_OTLP_METRICS_HEADERS:"",OTEL_EXPORTER_OTLP_LOGS_HEADERS:"",OTEL_EXPORTER_OTLP_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_TRACES_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_METRICS_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_LOGS_TIMEOUT:1e4,OTEL_EXPORTER_ZIPKIN_ENDPOINT:"http://localhost:9411/api/v2/spans",OTEL_LOG_LEVEL:xn.INFO,OTEL_NO_PATCH_MODULES:[],OTEL_PROPAGATORS:["tracecontext","baggage"],OTEL_RESOURCE_ATTRIBUTES:"",OTEL_SERVICE_NAME:"",OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT:fx,OTEL_ATTRIBUTE_COUNT_LIMIT:mx,OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT:fx,OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT:mx,OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT:fx,OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT:mx,OTEL_SPAN_EVENT_COUNT_LIMIT:128,OTEL_SPAN_LINK_COUNT_LIMIT:128,OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT:ice,OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT:oce,OTEL_TRACES_EXPORTER:"",OTEL_TRACES_SAMPLER:fc.ParentBasedAlwaysOn,OTEL_TRACES_SAMPLER_ARG:"",OTEL_LOGS_EXPORTER:"",OTEL_EXPORTER_OTLP_INSECURE:"",OTEL_EXPORTER_OTLP_TRACES_INSECURE:"",OTEL_EXPORTER_OTLP_METRICS_INSECURE:"",OTEL_EXPORTER_OTLP_LOGS_INSECURE:"",OTEL_EXPORTER_OTLP_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CERTIFICATE:"",OTEL_EXPORTER_OTLP_LOGS_CERTIFICATE:"",OTEL_EXPORTER_OTLP_COMPRESSION:"",OTEL_EXPORTER_OTLP_TRACES_COMPRESSION:"",OTEL_EXPORTER_OTLP_METRICS_COMPRESSION:"",OTEL_EXPORTER_OTLP_LOGS_COMPRESSION:"",OTEL_EXPORTER_OTLP_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_LOGS_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_LOGS_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_TRACES_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_METRICS_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_LOGS_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_METRICS_TEMPORALITY_PREFERENCE:"cumulative"};i8e={ALL:xn.ALL,VERBOSE:xn.VERBOSE,DEBUG:xn.DEBUG,INFO:xn.INFO,WARN:xn.WARN,ERROR:xn.ERROR,NONE:xn.NONE}});function vo(){var t=ow(process.env);return Object.assign({HOSTNAME:sce.hostname()},pN,t)}var sce,ace=R(()=>{sce=W(require("os"));dq()});var s8e,cce=R(()=>{s8e=typeof globalThis=="object"?globalThis:global});function uce(t){return t>=48&&t<=57?t-48:t>=97&&t<=102?t-87:t-55}function u8e(t){var e;t.length===16?e=a8e:t.length===32?e=c8e:e=Buffer.alloc(t.length/2);for(var r=0,n=0;n<t.length;n+=2){var o=uce(t.charCodeAt(n)),s=uce(t.charCodeAt(n+1));e.writeUInt8(o<<4|s,r++)}return e.toString("base64")}var a8e,c8e,lce=R(()=>{a8e=Buffer.alloc(8),c8e=Buffer.alloc(16)});function dce(t){return function(){for(var r=0;r<t/4;r++)fN.writeUInt32BE(Math.random()*Math.pow(2,32)>>>0,r*4);for(var r=0;r<t&&!(fN[r]>0);r++)r===t-1&&(fN[t-1]=1);return fN.toString("hex",0,t)}}var l8e,pce,d8e,fN,fce=R(()=>{l8e=8,pce=16,d8e=function(){function t(){this.generateTraceId=dce(pce),this.generateSpanId=dce(l8e)}return t}(),fN=Buffer.allocUnsafe(pce)});var mce,Kp,hce=R(()=>{mce=require("perf_hooks"),Kp=mce.performance});var pq,mN=R(()=>{pq="1.17.0"});var Yp,p8e,f8e,m8e,h8e,g8e,v8e,y8e,b8e,_8e,x8e,S8e,I8e,C8e,gce=R(()=>{Yp={AWS_LAMBDA_INVOKED_ARN:"aws.lambda.invoked_arn",DB_SYSTEM:"db.system",DB_CONNECTION_STRING:"db.connection_string",DB_USER:"db.user",DB_JDBC_DRIVER_CLASSNAME:"db.jdbc.driver_classname",DB_NAME:"db.name",DB_STATEMENT:"db.statement",DB_OPERATION:"db.operation",DB_MSSQL_INSTANCE_NAME:"db.mssql.instance_name",DB_CASSANDRA_KEYSPACE:"db.cassandra.keyspace",DB_CASSANDRA_PAGE_SIZE:"db.cassandra.page_size",DB_CASSANDRA_CONSISTENCY_LEVEL:"db.cassandra.consistency_level",DB_CASSANDRA_TABLE:"db.cassandra.table",DB_CASSANDRA_IDEMPOTENCE:"db.cassandra.idempotence",DB_CASSANDRA_SPECULATIVE_EXECUTION_COUNT:"db.cassandra.speculative_execution_count",DB_CASSANDRA_COORDINATOR_ID:"db.cassandra.coordinator.id",DB_CASSANDRA_COORDINATOR_DC:"db.cassandra.coordinator.dc",DB_HBASE_NAMESPACE:"db.hbase.namespace",DB_REDIS_DATABASE_INDEX:"db.redis.database_index",DB_MONGODB_COLLECTION:"db.mongodb.collection",DB_SQL_TABLE:"db.sql.table",EXCEPTION_TYPE:"exception.type",EXCEPTION_MESSAGE:"exception.message",EXCEPTION_STACKTRACE:"exception.stacktrace",EXCEPTION_ESCAPED:"exception.escaped",FAAS_TRIGGER:"faas.trigger",FAAS_EXECUTION:"faas.execution",FAAS_DOCUMENT_COLLECTION:"faas.document.collection",FAAS_DOCUMENT_OPERATION:"faas.document.operation",FAAS_DOCUMENT_TIME:"faas.document.time",FAAS_DOCUMENT_NAME:"faas.document.name",FAAS_TIME:"faas.time",FAAS_CRON:"faas.cron",FAAS_COLDSTART:"faas.coldstart",FAAS_INVOKED_NAME:"faas.invoked_name",FAAS_INVOKED_PROVIDER:"faas.invoked_provider",FAAS_INVOKED_REGION:"faas.invoked_region",NET_TRANSPORT:"net.transport",NET_PEER_IP:"net.peer.ip",NET_PEER_PORT:"net.peer.port",NET_PEER_NAME:"net.peer.name",NET_HOST_IP:"net.host.ip",NET_HOST_PORT:"net.host.port",NET_HOST_NAME:"net.host.name",NET_HOST_CONNECTION_TYPE:"net.host.connection.type",NET_HOST_CONNECTION_SUBTYPE:"net.host.connection.subtype",NET_HOST_CARRIER_NAME:"net.host.carrier.name",NET_HOST_CARRIER_MCC:"net.host.carrier.mcc",NET_HOST_CARRIER_MNC:"net.host.carrier.mnc",NET_HOST_CARRIER_ICC:"net.host.carrier.icc",PEER_SERVICE:"peer.service",ENDUSER_ID:"enduser.id",ENDUSER_ROLE:"enduser.role",ENDUSER_SCOPE:"enduser.scope",THREAD_ID:"thread.id",THREAD_NAME:"thread.name",CODE_FUNCTION:"code.function",CODE_NAMESPACE:"code.namespace",CODE_FILEPATH:"code.filepath",CODE_LINENO:"code.lineno",HTTP_METHOD:"http.method",HTTP_URL:"http.url",HTTP_TARGET:"http.target",HTTP_HOST:"http.host",HTTP_SCHEME:"http.scheme",HTTP_STATUS_CODE:"http.status_code",HTTP_FLAVOR:"http.flavor",HTTP_USER_AGENT:"http.user_agent",HTTP_REQUEST_CONTENT_LENGTH:"http.request_content_length",HTTP_REQUEST_CONTENT_LENGTH_UNCOMPRESSED:"http.request_content_length_uncompressed",HTTP_RESPONSE_CONTENT_LENGTH:"http.response_content_length",HTTP_RESPONSE_CONTENT_LENGTH_UNCOMPRESSED:"http.response_content_length_uncompressed",HTTP_SERVER_NAME:"http.server_name",HTTP_ROUTE:"http.route",HTTP_CLIENT_IP:"http.client_ip",AWS_DYNAMODB_TABLE_NAMES:"aws.dynamodb.table_names",AWS_DYNAMODB_CONSUMED_CAPACITY:"aws.dynamodb.consumed_capacity",AWS_DYNAMODB_ITEM_COLLECTION_METRICS:"aws.dynamodb.item_collection_metrics",AWS_DYNAMODB_PROVISIONED_READ_CAPACITY:"aws.dynamodb.provisioned_read_capacity",AWS_DYNAMODB_PROVISIONED_WRITE_CAPACITY:"aws.dynamodb.provisioned_write_capacity",AWS_DYNAMODB_CONSISTENT_READ:"aws.dynamodb.consistent_read",AWS_DYNAMODB_PROJECTION:"aws.dynamodb.projection",AWS_DYNAMODB_LIMIT:"aws.dynamodb.limit",AWS_DYNAMODB_ATTRIBUTES_TO_GET:"aws.dynamodb.attributes_to_get",AWS_DYNAMODB_INDEX_NAME:"aws.dynamodb.index_name",AWS_DYNAMODB_SELECT:"aws.dynamodb.select",AWS_DYNAMODB_GLOBAL_SECONDARY_INDEXES:"aws.dynamodb.global_secondary_indexes",AWS_DYNAMODB_LOCAL_SECONDARY_INDEXES:"aws.dynamodb.local_secondary_indexes",AWS_DYNAMODB_EXCLUSIVE_START_TABLE:"aws.dynamodb.exclusive_start_table",AWS_DYNAMODB_TABLE_COUNT:"aws.dynamodb.table_count",AWS_DYNAMODB_SCAN_FORWARD:"aws.dynamodb.scan_forward",AWS_DYNAMODB_SEGMENT:"aws.dynamodb.segment",AWS_DYNAMODB_TOTAL_SEGMENTS:"aws.dynamodb.total_segments",AWS_DYNAMODB_COUNT:"aws.dynamodb.count",AWS_DYNAMODB_SCANNED_COUNT:"aws.dynamodb.scanned_count",AWS_DYNAMODB_ATTRIBUTE_DEFINITIONS:"aws.dynamodb.attribute_definitions",AWS_DYNAMODB_GLOBAL_SECONDARY_INDEX_UPDATES:"aws.dynamodb.global_secondary_index_updates",MESSAGING_SYSTEM:"messaging.system",MESSAGING_DESTINATION:"messaging.destination",MESSAGING_DESTINATION_KIND:"messaging.destination_kind",MESSAGING_TEMP_DESTINATION:"messaging.temp_destination",MESSAGING_PROTOCOL:"messaging.protocol",MESSAGING_PROTOCOL_VERSION:"messaging.protocol_version",MESSAGING_URL:"messaging.url",MESSAGING_MESSAGE_ID:"messaging.message_id",MESSAGING_CONVERSATION_ID:"messaging.conversation_id",MESSAGING_MESSAGE_PAYLOAD_SIZE_BYTES:"messaging.message_payload_size_bytes",MESSAGING_MESSAGE_PAYLOAD_COMPRESSED_SIZE_BYTES:"messaging.message_payload_compressed_size_bytes",MESSAGING_OPERATION:"messaging.operation",MESSAGING_CONSUMER_ID:"messaging.consumer_id",MESSAGING_RABBITMQ_ROUTING_KEY:"messaging.rabbitmq.routing_key",MESSAGING_KAFKA_MESSAGE_KEY:"messaging.kafka.message_key",MESSAGING_KAFKA_CONSUMER_GROUP:"messaging.kafka.consumer_group",MESSAGING_KAFKA_CLIENT_ID:"messaging.kafka.client_id",MESSAGING_KAFKA_PARTITION:"messaging.kafka.partition",MESSAGING_KAFKA_TOMBSTONE:"messaging.kafka.tombstone",RPC_SYSTEM:"rpc.system",RPC_SERVICE:"rpc.service",RPC_METHOD:"rpc.method",RPC_GRPC_STATUS_CODE:"rpc.grpc.status_code",RPC_JSONRPC_VERSION:"rpc.jsonrpc.version",RPC_JSONRPC_REQUEST_ID:"rpc.jsonrpc.request_id",RPC_JSONRPC_ERROR_CODE:"rpc.jsonrpc.error_code",RPC_JSONRPC_ERROR_MESSAGE:"rpc.jsonrpc.error_message",MESSAGE_TYPE:"message.type",MESSAGE_ID:"message.id",MESSAGE_COMPRESSED_SIZE:"message.compressed_size",MESSAGE_UNCOMPRESSED_SIZE:"message.uncompressed_size"},p8e={OTHER_SQL:"other_sql",MSSQL:"mssql",MYSQL:"mysql",ORACLE:"oracle",DB2:"db2",POSTGRESQL:"postgresql",REDSHIFT:"redshift",HIVE:"hive",CLOUDSCAPE:"cloudscape",HSQLDB:"hsqldb",PROGRESS:"progress",MAXDB:"maxdb",HANADB:"hanadb",INGRES:"ingres",FIRSTSQL:"firstsql",EDB:"edb",CACHE:"cache",ADABAS:"adabas",FIREBIRD:"firebird",DERBY:"derby",FILEMAKER:"filemaker",INFORMIX:"informix",INSTANTDB:"instantdb",INTERBASE:"interbase",MARIADB:"mariadb",NETEZZA:"netezza",PERVASIVE:"pervasive",POINTBASE:"pointbase",SQLITE:"sqlite",SYBASE:"sybase",TERADATA:"teradata",VERTICA:"vertica",H2:"h2",COLDFUSION:"coldfusion",CASSANDRA:"cassandra",HBASE:"hbase",MONGODB:"mongodb",REDIS:"redis",COUCHBASE:"couchbase",COUCHDB:"couchdb",COSMOSDB:"cosmosdb",DYNAMODB:"dynamodb",NEO4J:"neo4j",GEODE:"geode",ELASTICSEARCH:"elasticsearch",MEMCACHED:"memcached",COCKROACHDB:"cockroachdb"},f8e={ALL:"all",EACH_QUORUM:"each_quorum",QUORUM:"quorum",LOCAL_QUORUM:"local_quorum",ONE:"one",TWO:"two",THREE:"three",LOCAL_ONE:"local_one",ANY:"any",SERIAL:"serial",LOCAL_SERIAL:"local_serial"},m8e={DATASOURCE:"datasource",HTTP:"http",PUBSUB:"pubsub",TIMER:"timer",OTHER:"other"},h8e={INSERT:"insert",EDIT:"edit",DELETE:"delete"},g8e={ALIBABA_CLOUD:"alibaba_cloud",AWS:"aws",AZURE:"azure",GCP:"gcp"},v8e={IP_TCP:"ip_tcp",IP_UDP:"ip_udp",IP:"ip",UNIX:"unix",PIPE:"pipe",INPROC:"inproc",OTHER:"other"},y8e={WIFI:"wifi",WIRED:"wired",CELL:"cell",UNAVAILABLE:"unavailable",UNKNOWN:"unknown"},b8e={GPRS:"gprs",EDGE:"edge",UMTS:"umts",CDMA:"cdma",EVDO_0:"evdo_0",EVDO_A:"evdo_a",CDMA2000_1XRTT:"cdma2000_1xrtt",HSDPA:"hsdpa",HSUPA:"hsupa",HSPA:"hspa",IDEN:"iden",EVDO_B:"evdo_b",LTE:"lte",EHRPD:"ehrpd",HSPAP:"hspap",GSM:"gsm",TD_SCDMA:"td_scdma",IWLAN:"iwlan",NR:"nr",NRNSA:"nrnsa",LTE_CA:"lte_ca"},_8e={HTTP_1_0:"1.0",HTTP_1_1:"1.1",HTTP_2_0:"2.0",SPDY:"SPDY",QUIC:"QUIC"},x8e={QUEUE:"queue",TOPIC:"topic"},S8e={RECEIVE:"receive",PROCESS:"process"},I8e={OK:0,CANCELLED:1,UNKNOWN:2,INVALID_ARGUMENT:3,DEADLINE_EXCEEDED:4,NOT_FOUND:5,ALREADY_EXISTS:6,PERMISSION_DENIED:7,RESOURCE_EXHAUSTED:8,FAILED_PRECONDITION:9,ABORTED:10,OUT_OF_RANGE:11,UNIMPLEMENTED:12,INTERNAL:13,UNAVAILABLE:14,DATA_LOSS:15,UNAUTHENTICATED:16},C8e={SENT:"SENT",RECEIVED:"RECEIVED"}});var vce=R(()=>{gce()});var sr,T8e,E8e,w8e,R8e,k8e,fq,yce=R(()=>{sr={CLOUD_PROVIDER:"cloud.provider",CLOUD_ACCOUNT_ID:"cloud.account.id",CLOUD_REGION:"cloud.region",CLOUD_AVAILABILITY_ZONE:"cloud.availability_zone",CLOUD_PLATFORM:"cloud.platform",AWS_ECS_CONTAINER_ARN:"aws.ecs.container.arn",AWS_ECS_CLUSTER_ARN:"aws.ecs.cluster.arn",AWS_ECS_LAUNCHTYPE:"aws.ecs.launchtype",AWS_ECS_TASK_ARN:"aws.ecs.task.arn",AWS_ECS_TASK_FAMILY:"aws.ecs.task.family",AWS_ECS_TASK_REVISION:"aws.ecs.task.revision",AWS_EKS_CLUSTER_ARN:"aws.eks.cluster.arn",AWS_LOG_GROUP_NAMES:"aws.log.group.names",AWS_LOG_GROUP_ARNS:"aws.log.group.arns",AWS_LOG_STREAM_NAMES:"aws.log.stream.names",AWS_LOG_STREAM_ARNS:"aws.log.stream.arns",CONTAINER_NAME:"container.name",CONTAINER_ID:"container.id",CONTAINER_RUNTIME:"container.runtime",CONTAINER_IMAGE_NAME:"container.image.name",CONTAINER_IMAGE_TAG:"container.image.tag",DEPLOYMENT_ENVIRONMENT:"deployment.environment",DEVICE_ID:"device.id",DEVICE_MODEL_IDENTIFIER:"device.model.identifier",DEVICE_MODEL_NAME:"device.model.name",FAAS_NAME:"faas.name",FAAS_ID:"faas.id",FAAS_VERSION:"faas.version",FAAS_INSTANCE:"faas.instance",FAAS_MAX_MEMORY:"faas.max_memory",HOST_ID:"host.id",HOST_NAME:"host.name",HOST_TYPE:"host.type",HOST_ARCH:"host.arch",HOST_IMAGE_NAME:"host.image.name",HOST_IMAGE_ID:"host.image.id",HOST_IMAGE_VERSION:"host.image.version",K8S_CLUSTER_NAME:"k8s.cluster.name",K8S_NODE_NAME:"k8s.node.name",K8S_NODE_UID:"k8s.node.uid",K8S_NAMESPACE_NAME:"k8s.namespace.name",K8S_POD_UID:"k8s.pod.uid",K8S_POD_NAME:"k8s.pod.name",K8S_CONTAINER_NAME:"k8s.container.name",K8S_REPLICASET_UID:"k8s.replicaset.uid",K8S_REPLICASET_NAME:"k8s.replicaset.name",K8S_DEPLOYMENT_UID:"k8s.deployment.uid",K8S_DEPLOYMENT_NAME:"k8s.deployment.name",K8S_STATEFULSET_UID:"k8s.statefulset.uid",K8S_STATEFULSET_NAME:"k8s.statefulset.name",K8S_DAEMONSET_UID:"k8s.daemonset.uid",K8S_DAEMONSET_NAME:"k8s.daemonset.name",K8S_JOB_UID:"k8s.job.uid",K8S_JOB_NAME:"k8s.job.name",K8S_CRONJOB_UID:"k8s.cronjob.uid",K8S_CRONJOB_NAME:"k8s.cronjob.name",OS_TYPE:"os.type",OS_DESCRIPTION:"os.description",OS_NAME:"os.name",OS_VERSION:"os.version",PROCESS_PID:"process.pid",PROCESS_EXECUTABLE_NAME:"process.executable.name",PROCESS_EXECUTABLE_PATH:"process.executable.path",PROCESS_COMMAND:"process.command",PROCESS_COMMAND_LINE:"process.command_line",PROCESS_COMMAND_ARGS:"process.command_args",PROCESS_OWNER:"process.owner",PROCESS_RUNTIME_NAME:"process.runtime.name",PROCESS_RUNTIME_VERSION:"process.runtime.version",PROCESS_RUNTIME_DESCRIPTION:"process.runtime.description",SERVICE_NAME:"service.name",SERVICE_NAMESPACE:"service.namespace",SERVICE_INSTANCE_ID:"service.instance.id",SERVICE_VERSION:"service.version",TELEMETRY_SDK_NAME:"telemetry.sdk.name",TELEMETRY_SDK_LANGUAGE:"telemetry.sdk.language",TELEMETRY_SDK_VERSION:"telemetry.sdk.version",TELEMETRY_AUTO_VERSION:"telemetry.auto.version",WEBENGINE_NAME:"webengine.name",WEBENGINE_VERSION:"webengine.version",WEBENGINE_DESCRIPTION:"webengine.description"},T8e={ALIBABA_CLOUD:"alibaba_cloud",AWS:"aws",AZURE:"azure",GCP:"gcp"},E8e={ALIBABA_CLOUD_ECS:"alibaba_cloud_ecs",ALIBABA_CLOUD_FC:"alibaba_cloud_fc",AWS_EC2:"aws_ec2",AWS_ECS:"aws_ecs",AWS_EKS:"aws_eks",AWS_LAMBDA:"aws_lambda",AWS_ELASTIC_BEANSTALK:"aws_elastic_beanstalk",AZURE_VM:"azure_vm",AZURE_CONTAINER_INSTANCES:"azure_container_instances",AZURE_AKS:"azure_aks",AZURE_FUNCTIONS:"azure_functions",AZURE_APP_SERVICE:"azure_app_service",GCP_COMPUTE_ENGINE:"gcp_compute_engine",GCP_CLOUD_RUN:"gcp_cloud_run",GCP_KUBERNETES_ENGINE:"gcp_kubernetes_engine",GCP_CLOUD_FUNCTIONS:"gcp_cloud_functions",GCP_APP_ENGINE:"gcp_app_engine"},w8e={EC2:"ec2",FARGATE:"fargate"},R8e={AMD64:"amd64",ARM32:"arm32",ARM64:"arm64",IA64:"ia64",PPC32:"ppc32",PPC64:"ppc64",X86:"x86"},k8e={WINDOWS:"windows",LINUX:"linux",DARWIN:"darwin",FREEBSD:"freebsd",NETBSD:"netbsd",OPENBSD:"openbsd",DRAGONFLYBSD:"dragonflybsd",HPUX:"hpux",AIX:"aix",SOLARIS:"solaris",Z_OS:"z_os"},fq={CPP:"cpp",DOTNET:"dotnet",ERLANG:"erlang",GO:"go",JAVA:"java",NODEJS:"nodejs",PHP:"php",PYTHON:"python",RUBY:"ruby",WEBJS:"webjs"}});var bce=R(()=>{yce()});var mq={};dn(mq,{AwsEcsLaunchtypeValues:()=>w8e,CloudPlatformValues:()=>E8e,CloudProviderValues:()=>T8e,DbCassandraConsistencyLevelValues:()=>f8e,DbSystemValues:()=>p8e,FaasDocumentOperationValues:()=>h8e,FaasInvokedProviderValues:()=>g8e,FaasTriggerValues:()=>m8e,HostArchValues:()=>R8e,HttpFlavorValues:()=>_8e,MessageTypeValues:()=>C8e,MessagingDestinationKindValues:()=>x8e,MessagingOperationValues:()=>S8e,NetHostConnectionSubtypeValues:()=>b8e,NetHostConnectionTypeValues:()=>y8e,NetTransportValues:()=>v8e,OsTypeValues:()=>k8e,RpcGrpcStatusCodeValues:()=>I8e,SemanticAttributes:()=>Yp,SemanticResourceAttributes:()=>sr,TelemetrySdkLanguageValues:()=>fq});var el=R(()=>{vce();bce()});var hx,sw,_ce=R(()=>{mN();el();sw=(hx={},hx[sr.TELEMETRY_SDK_NAME]="opentelemetry",hx[sr.PROCESS_RUNTIME_NAME]="node",hx[sr.TELEMETRY_SDK_LANGUAGE]=fq.NODEJS,hx[sr.TELEMETRY_SDK_VERSION]=pq,hx)});function hq(t){t.unref()}var xce=R(()=>{});var Sce=R(()=>{ace();cce();lce();fce();hce();_ce();xce()});var gq=R(()=>{Sce()});function id(t){var e=t/1e3,r=Math.trunc(e),n=Math.round(t%1e3*P8e);return[r,n]}function aw(){var t=Kp.timeOrigin;if(typeof t!="number"){var e=Kp;t=e.timing&&e.timing.fetchStart}return t}function gN(t){var e=id(aw()),r=id(typeof t=="number"?t:Kp.now());return bN(e,r)}function D8e(t){if(cw(t))return t;if(typeof t=="number")return t<aw()?gN(t):id(t);if(t instanceof Date)return id(t.getTime());throw TypeError("Invalid input type")}function vq(t,e){var r=e[0]-t[0],n=e[1]-t[1];return n<0&&(r-=1,n+=hN),[r,n]}function N8e(t){var e=Ice,r=""+"0".repeat(e)+t[1]+"Z",n=r.substr(r.length-e-1),o=new Date(t[0]*1e3).toISOString();return o.replace("000Z",n)}function L8e(t){return t[0]*hN+t[1]}function O8e(t){return t[0]*1e3+t[1]/1e6}function vN(t){return t[0]*1e6+t[1]/1e3}function cw(t){return Array.isArray(t)&&t.length===2&&typeof t[0]=="number"&&typeof t[1]=="number"}function yN(t){return cw(t)||typeof t=="number"||t instanceof Date}function bN(t,e){var r=[t[0]+e[0],t[1]+e[1]];return r[1]>=hN&&(r[1]-=hN,r[0]+=1),r}var Ice,A8e,P8e,hN,Cce=R(()=>{gq();Ice=9,A8e=6,P8e=Math.pow(10,A8e),hN=Math.pow(10,Ice)});var Tce=R(()=>{});var Xc,Ece=R(()=>{(function(t){t[t.SUCCESS=0]="SUCCESS",t[t.FAILED=1]="FAILED"})(Xc||(Xc={}))});var M8e,yq,wce=R(()=>{gr();M8e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},yq=function(){function t(e){e===void 0&&(e={});var r;this._propagators=(r=e.propagators)!==null&&r!==void 0?r:[],this._fields=Array.from(new Set(this._propagators.map(function(n){return typeof n.fields=="function"?n.fields():[]}).reduce(function(n,o){return n.concat(o)},[])))}return t.prototype.inject=function(e,r,n){var o,s;try{for(var a=M8e(this._propagators),c=a.next();!c.done;c=a.next()){var u=c.value;try{u.inject(e,r,n)}catch(l){dt.warn("Failed to inject with "+u.constructor.name+". Err: "+l.message)}}}catch(l){o={error:l}}finally{try{c&&!c.done&&(s=a.return)&&s.call(a)}finally{if(o)throw o.error}}},t.prototype.extract=function(e,r,n){return this._propagators.reduce(function(o,s){try{return s.extract(o,r,n)}catch(a){dt.warn("Failed to inject with "+s.constructor.name+". Err: "+a.message)}return o},e)},t.prototype.fields=function(){return this._fields.slice()},t}()});function Rce(t){return B8e.test(t)}function kce(t){return q8e.test(t)&&!H8e.test(t)}var bq,F8e,U8e,B8e,q8e,H8e,Ace=R(()=>{bq="[_0-9a-z-*/]",F8e="[a-z]"+bq+"{0,255}",U8e="[a-z0-9]"+bq+"{0,240}@[a-z]"+bq+"{0,13}",B8e=new RegExp("^(?:"+F8e+"|"+U8e+")$"),q8e=/^[ -~]{0,255}[!-~]$/,H8e=/,|=/});var Pce,j8e,Dce,Nce,_q,xq=R(()=>{Ace();Pce=32,j8e=512,Dce=",",Nce="=",_q=function(){function t(e){this._internalState=new Map,e&&this._parse(e)}return t.prototype.set=function(e,r){var n=this._clone();return n._internalState.has(e)&&n._internalState.delete(e),n._internalState.set(e,r),n},t.prototype.unset=function(e){var r=this._clone();return r._internalState.delete(e),r},t.prototype.get=function(e){return this._internalState.get(e)},t.prototype.serialize=function(){var e=this;return this._keys().reduce(function(r,n){return r.push(n+Nce+e.get(n)),r},[]).join(Dce)},t.prototype._parse=function(e){e.length>j8e||(this._internalState=e.split(Dce).reverse().reduce(function(r,n){var o=n.trim(),s=o.indexOf(Nce);if(s!==-1){var a=o.slice(0,s),c=o.slice(s+1,n.length);Rce(a)&&kce(c)&&r.set(a,c)}return r},new Map),this._internalState.size>Pce&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,Pce))))},t.prototype._keys=function(){return Array.from(this._internalState.keys()).reverse()},t.prototype._clone=function(){var e=new t;return e._internalState=new Map(this._internalState),e},t}()});function Lce(t){var e=K8e.exec(t);return!e||e[1]==="00"&&e[5]?null:{traceId:e[2],spanId:e[3],traceFlags:parseInt(e[4],16)}}var _N,xN,z8e,G8e,V8e,$8e,W8e,K8e,Sq,Oce=R(()=>{gr();iw();xq();_N="traceparent",xN="tracestate",z8e="00",G8e="(?!ff)[\\da-f]{2}",V8e="(?![0]{32})[\\da-f]{32}",$8e="(?![0]{16})[\\da-f]{16}",W8e="[\\da-f]{2}",K8e=new RegExp("^\\s?("+G8e+")-("+V8e+")-("+$8e+")-("+W8e+")(-.*)?\\s?$");Sq=function(){function t(){}return t.prototype.inject=function(e,r,n){var o=go.getSpanContext(e);if(!(!o||D0(e)||!Qc(o))){var s=z8e+"-"+o.traceId+"-"+o.spanId+"-0"+Number(o.traceFlags||Ni.NONE).toString(16);n.set(r,_N,s),o.traceState&&n.set(r,xN,o.traceState.serialize())}},t.prototype.extract=function(e,r,n){var o=n.get(r,_N);if(!o)return e;var s=Array.isArray(o)?o[0]:o;if(typeof s!="string")return e;var a=Lce(s);if(!a)return e;a.isRemote=!0;var c=n.get(r,xN);if(c){var u=Array.isArray(c)?c.join(","):c;a.traceState=new _q(typeof u=="string"?u:void 0)}return go.setSpanContext(e,a)},t.prototype.fields=function(){return[_N,xN]},t}()});var Mce=R(()=>{});function Y8e(t,e){return t.setValue(Cq,e)}function Q8e(t){return t.deleteValue(Cq)}function X8e(t){return t.getValue(Cq)}var Cq,Iq,Fce=R(()=>{gr();Cq=nd("OpenTelemetry SDK Context Key RPC_METADATA");(function(t){t.HTTP="http"})(Iq||(Iq={}))});var SN,Tq=R(()=>{gr();SN=function(){function t(){}return t.prototype.shouldSample=function(){return{decision:Da.NOT_RECORD}},t.prototype.toString=function(){return"AlwaysOffSampler"},t}()});var uw,Eq=R(()=>{gr();uw=function(){function t(){}return t.prototype.shouldSample=function(){return{decision:Da.RECORD_AND_SAMPLED}},t.prototype.toString=function(){return"AlwaysOnSampler"},t}()});var J8e,Uce=R(()=>{gr();cq();Tq();Eq();J8e=function(){function t(e){var r,n,o,s;this._root=e.root,this._root||(Na(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new uw),this._remoteParentSampled=(r=e.remoteParentSampled)!==null&&r!==void 0?r:new uw,this._remoteParentNotSampled=(n=e.remoteParentNotSampled)!==null&&n!==void 0?n:new SN,this._localParentSampled=(o=e.localParentSampled)!==null&&o!==void 0?o:new uw,this._localParentNotSampled=(s=e.localParentNotSampled)!==null&&s!==void 0?s:new SN}return t.prototype.shouldSample=function(e,r,n,o,s,a){var c=go.getSpanContext(e);return!c||!Qc(c)?this._root.shouldSample(e,r,n,o,s,a):c.isRemote?c.traceFlags&Ni.SAMPLED?this._remoteParentSampled.shouldSample(e,r,n,o,s,a):this._remoteParentNotSampled.shouldSample(e,r,n,o,s,a):c.traceFlags&Ni.SAMPLED?this._localParentSampled.shouldSample(e,r,n,o,s,a):this._localParentNotSampled.shouldSample(e,r,n,o,s,a)},t.prototype.toString=function(){return"ParentBased{root="+this._root.toString()+", remoteParentSampled="+this._remoteParentSampled.toString()+", remoteParentNotSampled="+this._remoteParentNotSampled.toString()+", localParentSampled="+this._localParentSampled.toString()+", localParentNotSampled="+this._localParentNotSampled.toString()+"}"},t}()});var Z8e,Bce=R(()=>{gr();Z8e=function(){function t(e){e===void 0&&(e=0),this._ratio=e,this._ratio=this._normalize(e),this._upperBound=Math.floor(this._ratio*4294967295)}return t.prototype.shouldSample=function(e,r){return{decision:P0(r)&&this._accumulate(r)<this._upperBound?Da.RECORD_AND_SAMPLED:Da.NOT_RECORD}},t.prototype.toString=function(){return"TraceIdRatioBased{"+this._ratio+"}"},t.prototype._normalize=function(e){return typeof e!="number"||isNaN(e)?0:e>=1?1:e<=0?0:e},t.prototype._accumulate=function(e){for(var r=0,n=0;n<e.length/8;n++){var o=n*8,s=parseInt(e.slice(o,o+8),16);r=(r^s)>>>0}return r},t}()});function sMe(t,e){return function(r){return t(e(r))}}function wq(t){if(!aMe(t)||cMe(t)!==eMe)return!1;var e=oMe(t);if(e===null)return!0;var r=jce.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&qce.call(r)===iMe}function aMe(t){return t!=null&&typeof t=="object"}function cMe(t){return t==null?t===void 0?rMe:tMe:L0&&L0 in Object(t)?uMe(t):lMe(t)}function uMe(t){var e=jce.call(t,L0),r=t[L0],n=!1;try{t[L0]=void 0,n=!0}catch{}var o=zce.call(t);return n&&(e?t[L0]=r:delete t[L0]),o}function lMe(t){return zce.call(t)}var eMe,tMe,rMe,nMe,qce,iMe,oMe,Hce,jce,L0,zce,Gce=R(()=>{eMe="[object Object]",tMe="[object Null]",rMe="[object Undefined]",nMe=Function.prototype,qce=nMe.toString,iMe=qce.call(Object),oMe=sMe(Object.getPrototypeOf,Object),Hce=Object.prototype,jce=Hce.hasOwnProperty,L0=Symbol?Symbol.toStringTag:void 0,zce=Hce.toString});function kq(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=t.shift(),n=new WeakMap;t.length>0;)r=$ce(r,t.shift(),0,n);return r}function Rq(t){return CN(t)?t.slice():t}function $ce(t,e,r,n){r===void 0&&(r=0);var o;if(!(r>dMe)){if(r++,IN(t)||IN(e)||Wce(e))o=Rq(e);else if(CN(t)){if(o=t.slice(),CN(e))for(var s=0,a=e.length;s<a;s++)o.push(Rq(e[s]));else if(lw(e))for(var c=Object.keys(e),s=0,a=c.length;s<a;s++){var u=c[s];o[u]=Rq(e[u])}}else if(lw(t))if(lw(e)){if(!pMe(t,e))return e;o=Object.assign({},t);for(var c=Object.keys(e),s=0,a=c.length;s<a;s++){var u=c[s],l=e[u];if(IN(l))typeof l>"u"?delete o[u]:o[u]=l;else{var d=o[u],p=l;if(Vce(t,u,n)||Vce(e,u,n))delete o[u];else{if(lw(d)&&lw(p)){var f=n.get(d)||[],m=n.get(p)||[];f.push({obj:t,key:u}),m.push({obj:e,key:u}),n.set(d,f),n.set(p,m)}o[u]=$ce(o[u],l,r,n)}}}}else o=e;return o}}function Vce(t,e,r){for(var n=r.get(t[e])||[],o=0,s=n.length;o<s;o++){var a=n[o];if(a.key===e&&a.obj===t)return!0}return!1}function CN(t){return Array.isArray(t)}function Wce(t){return typeof t=="function"}function lw(t){return!IN(t)&&!CN(t)&&!Wce(t)&&typeof t=="object"}function IN(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t>"u"||t instanceof Date||t instanceof RegExp||t===null}function pMe(t,e){return!(!wq(t)||!wq(e))}var dMe,Kce=R(()=>{Gce();dMe=20});function mMe(t,e){var r,n=new Promise(function(s,a){r=setTimeout(function(){a(new Yce("Operation timed out."))},e)});return Promise.race([t,n]).then(function(o){return clearTimeout(r),o},function(o){throw clearTimeout(r),o})}var fMe,Yce,Qce=R(()=>{fMe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Yce=function(t){fMe(e,t);function e(r){var n=t.call(this,r)||this;return Object.setPrototypeOf(n,e.prototype),n}return e}(Error)});function Xce(t,e){return typeof e=="string"?t===e:!!t.match(e)}function gMe(t,e){var r,n;if(!e)return!1;try{for(var o=hMe(e),s=o.next();!s.done;s=o.next()){var a=s.value;if(Xce(t,a))return!0}}catch(c){r={error:c}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return!1}var hMe,Jce=R(()=>{hMe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}});function vMe(t){return typeof t=="function"&&typeof t.__original=="function"&&typeof t.__unwrap=="function"&&t.__wrapped===!0}var Zce=R(()=>{});var eue,tue=R(()=>{eue=function(){function t(){var e=this;this._promise=new Promise(function(r,n){e._resolve=r,e._reject=n})}return Object.defineProperty(t.prototype,"promise",{get:function(){return this._promise},enumerable:!1,configurable:!0}),t.prototype.resolve=function(e){this._resolve(e)},t.prototype.reject=function(e){this._reject(e)},t}()});var yMe,bMe,dw,rue=R(()=>{tue();yMe=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},bMe=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,s;n<o;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},dw=function(){function t(e,r){this._callback=e,this._that=r,this._isCalled=!1,this._deferred=new eue}return Object.defineProperty(t.prototype,"isCalled",{get:function(){return this._isCalled},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"promise",{get:function(){return this._deferred.promise},enumerable:!1,configurable:!0}),t.prototype.call=function(){for(var e,r=this,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];if(!this._isCalled){this._isCalled=!0;try{Promise.resolve((e=this._callback).call.apply(e,bMe([this._that],yMe(n),!1))).then(function(s){return r._deferred.resolve(s)},function(s){return r._deferred.reject(s)})}catch(s){this._deferred.reject(s)}}return this._deferred.promise},t}()});function nue(t,e){return new Promise(function(r){na.with(nw(na.active()),function(){t.export(e,function(n){r(n)})})})}var iue=R(()=>{gr();iw()});var oue={};dn(oue,{AlwaysOffSampler:()=>SN,AlwaysOnSampler:()=>uw,AnchoredClock:()=>j6e,BindOnceFuture:()=>dw,CompositePropagator:()=>yq,DEFAULT_ATTRIBUTE_COUNT_LIMIT:()=>mx,DEFAULT_ATTRIBUTE_VALUE_LENGTH_LIMIT:()=>fx,DEFAULT_ENVIRONMENT:()=>pN,DEFAULT_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT:()=>ice,DEFAULT_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT:()=>oce,ExportResultCode:()=>Xc,ParentBasedSampler:()=>J8e,RPCType:()=>Iq,RandomIdGenerator:()=>d8e,SDK_INFO:()=>sw,TRACE_PARENT_HEADER:()=>_N,TRACE_STATE_HEADER:()=>xN,TimeoutError:()=>Yce,TraceIdRatioBasedSampler:()=>Z8e,TraceState:()=>_q,TracesSamplerValues:()=>fc,VERSION:()=>pq,W3CBaggagePropagator:()=>oq,W3CTraceContextPropagator:()=>Sq,_globalThis:()=>s8e,addHrTimes:()=>bN,baggageUtils:()=>nq,callWithTimeout:()=>mMe,deleteRPCMetadata:()=>Q8e,getEnv:()=>vo,getEnvWithoutDefaults:()=>lq,getRPCMetadata:()=>X8e,getTimeOrigin:()=>aw,globalErrorHandler:()=>Na,hexToBase64:()=>u8e,hrTime:()=>gN,hrTimeDuration:()=>vq,hrTimeToMicroseconds:()=>vN,hrTimeToMilliseconds:()=>O8e,hrTimeToNanoseconds:()=>L8e,hrTimeToTimeStamp:()=>N8e,internal:()=>Aq,isAttributeKey:()=>Jae,isAttributeValue:()=>dN,isTimeInput:()=>yN,isTimeInputHrTime:()=>cw,isTracingSuppressed:()=>D0,isUrlIgnored:()=>gMe,isWrapped:()=>vMe,loggingErrorHandler:()=>sq,merge:()=>kq,millisToHrTime:()=>id,otperformance:()=>Kp,parseEnvironment:()=>ow,parseTraceParent:()=>Lce,sanitizeAttributes:()=>N0,setGlobalErrorHandler:()=>W6e,setRPCMetadata:()=>Y8e,suppressTracing:()=>nw,timeInputToHrTime:()=>D8e,unrefTimer:()=>hq,unsuppressTracing:()=>B6e,urlMatches:()=>Xce});var Aq,ia=R(()=>{Yae();Qae();ece();cq();aq();Cce();Tce();Ece();mN();iq();gq();wce();Oce();Mce();Fce();Tq();Eq();Uce();Bce();iw();xq();dq();Kce();uq();Qce();Jce();Zce();rue();mN();iue();Aq={_export:nue}});var sue,aue=R(()=>{sue="exception"});var _Me,xMe,Pq,Dq=R(()=>{gr();ia();el();aue();_Me=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},xMe=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},Pq=function(){function t(e,r,n,o,s,a,c,u,l){c===void 0&&(c=[]),this.attributes={},this.links=[],this.events=[],this._droppedAttributesCount=0,this._droppedEventsCount=0,this._droppedLinksCount=0,this.status={code:lx.UNSET},this.endTime=[0,0],this._ended=!1,this._duration=[-1,-1],this.name=n,this._spanContext=o,this.parentSpanId=a,this.kind=s,this.links=c;var d=Date.now();this._performanceStartTime=Kp.now(),this._performanceOffset=d-(this._performanceStartTime+aw()),this._startTimeProvided=u!=null,this.startTime=this._getTime(u??d),this.resource=e.resource,this.instrumentationLibrary=e.instrumentationLibrary,this._spanLimits=e.getSpanLimits(),this._spanProcessor=e.getActiveSpanProcessor(),this._spanProcessor.onStart(this,r),this._attributeValueLengthLimit=this._spanLimits.attributeValueLengthLimit||0}return t.prototype.spanContext=function(){return this._spanContext},t.prototype.setAttribute=function(e,r){return r==null||this._isSpanEnded()?this:e.length===0?(dt.warn("Invalid attribute key: "+e),this):dN(r)?Object.keys(this.attributes).length>=this._spanLimits.attributeCountLimit&&!Object.prototype.hasOwnProperty.call(this.attributes,e)?(this._droppedAttributesCount++,this):(this.attributes[e]=this._truncateToSize(r),this):(dt.warn("Invalid attribute value set for key: "+e),this)},t.prototype.setAttributes=function(e){var r,n;try{for(var o=_Me(Object.entries(e)),s=o.next();!s.done;s=o.next()){var a=xMe(s.value,2),c=a[0],u=a[1];this.setAttribute(c,u)}}catch(l){r={error:l}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return this},t.prototype.addEvent=function(e,r,n){if(this._isSpanEnded())return this;if(this._spanLimits.eventCountLimit===0)return dt.warn("No events allowed."),this._droppedEventsCount++,this;this.events.length>=this._spanLimits.eventCountLimit&&(dt.warn("Dropping extra events."),this.events.shift(),this._droppedEventsCount++),yN(r)&&(yN(n)||(n=r),r=void 0);var o=N0(r);return this.events.push({name:e,attributes:o,time:this._getTime(n),droppedAttributesCount:0}),this},t.prototype.setStatus=function(e){return this._isSpanEnded()?this:(this.status=e,this)},t.prototype.updateName=function(e){return this._isSpanEnded()?this:(this.name=e,this)},t.prototype.end=function(e){if(this._isSpanEnded()){dt.error(this.name+" "+this._spanContext.traceId+"-"+this._spanContext.spanId+" - You can only call end() on a span once.");return}this._ended=!0,this.endTime=this._getTime(e),this._duration=vq(this.startTime,this.endTime),this._duration[0]<0&&(dt.warn("Inconsistent start and end time, startTime > endTime. Setting span duration to 0ms.",this.startTime,this.endTime),this.endTime=this.startTime.slice(),this._duration=[0,0]),this._spanProcessor.onEnd(this)},t.prototype._getTime=function(e){if(typeof e=="number"&&e<Kp.now())return gN(e+this._performanceOffset);if(typeof e=="number")return id(e);if(e instanceof Date)return id(e.getTime());if(cw(e))return e;if(this._startTimeProvided)return id(Date.now());var r=Kp.now()-this._performanceStartTime;return bN(this.startTime,id(r))},t.prototype.isRecording=function(){return this._ended===!1},t.prototype.recordException=function(e,r){var n={};typeof e=="string"?n[Yp.EXCEPTION_MESSAGE]=e:e&&(e.code?n[Yp.EXCEPTION_TYPE]=e.code.toString():e.name&&(n[Yp.EXCEPTION_TYPE]=e.name),e.message&&(n[Yp.EXCEPTION_MESSAGE]=e.message),e.stack&&(n[Yp.EXCEPTION_STACKTRACE]=e.stack)),n[Yp.EXCEPTION_TYPE]||n[Yp.EXCEPTION_MESSAGE]?this.addEvent(sue,n,r):dt.warn("Failed to record an exception "+e)},Object.defineProperty(t.prototype,"duration",{get:function(){return this._duration},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ended",{get:function(){return this._ended},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"droppedAttributesCount",{get:function(){return this._droppedAttributesCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"droppedEventsCount",{get:function(){return this._droppedEventsCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"droppedLinksCount",{get:function(){return this._droppedLinksCount},enumerable:!1,configurable:!0}),t.prototype._isSpanEnded=function(){return this._ended&&dt.warn("Can not execute the operation on ended Span {traceId: "+this._spanContext.traceId+", spanId: "+this._spanContext.spanId+"}"),this._ended},t.prototype._truncateToLimitUtil=function(e,r){return e.length<=r?e:e.substr(0,r)},t.prototype._truncateToSize=function(e){var r=this,n=this._attributeValueLengthLimit;return n<=0?(dt.warn("Attribute value limit must be positive, got "+n),e):typeof e=="string"?this._truncateToLimitUtil(e,n):Array.isArray(e)?e.map(function(o){return typeof o=="string"?r._truncateToLimitUtil(o,n):o}):e},t}()});var od,pw=R(()=>{(function(t){t[t.NOT_RECORD=0]="NOT_RECORD",t[t.RECORD=1]="RECORD",t[t.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"})(od||(od={}))});var O0,TN=R(()=>{pw();O0=function(){function t(){}return t.prototype.shouldSample=function(){return{decision:od.NOT_RECORD}},t.prototype.toString=function(){return"AlwaysOffSampler"},t}()});var Qp,EN=R(()=>{pw();Qp=function(){function t(){}return t.prototype.shouldSample=function(){return{decision:od.RECORD_AND_SAMPLED}},t.prototype.toString=function(){return"AlwaysOnSampler"},t}()});var fw,Nq=R(()=>{gr();ia();TN();EN();fw=function(){function t(e){var r,n,o,s;this._root=e.root,this._root||(Na(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new Qp),this._remoteParentSampled=(r=e.remoteParentSampled)!==null&&r!==void 0?r:new Qp,this._remoteParentNotSampled=(n=e.remoteParentNotSampled)!==null&&n!==void 0?n:new O0,this._localParentSampled=(o=e.localParentSampled)!==null&&o!==void 0?o:new Qp,this._localParentNotSampled=(s=e.localParentNotSampled)!==null&&s!==void 0?s:new O0}return t.prototype.shouldSample=function(e,r,n,o,s,a){var c=go.getSpanContext(e);return!c||!Qc(c)?this._root.shouldSample(e,r,n,o,s,a):c.isRemote?c.traceFlags&Ni.SAMPLED?this._remoteParentSampled.shouldSample(e,r,n,o,s,a):this._remoteParentNotSampled.shouldSample(e,r,n,o,s,a):c.traceFlags&Ni.SAMPLED?this._localParentSampled.shouldSample(e,r,n,o,s,a):this._localParentNotSampled.shouldSample(e,r,n,o,s,a)},t.prototype.toString=function(){return"ParentBased{root="+this._root.toString()+", remoteParentSampled="+this._remoteParentSampled.toString()+", remoteParentNotSampled="+this._remoteParentNotSampled.toString()+", localParentSampled="+this._localParentSampled.toString()+", localParentNotSampled="+this._localParentNotSampled.toString()+"}"},t}()});var wN,Lq=R(()=>{gr();pw();wN=function(){function t(e){e===void 0&&(e=0),this._ratio=e,this._ratio=this._normalize(e),this._upperBound=Math.floor(this._ratio*4294967295)}return t.prototype.shouldSample=function(e,r){return{decision:P0(r)&&this._accumulate(r)<this._upperBound?od.RECORD_AND_SAMPLED:od.NOT_RECORD}},t.prototype.toString=function(){return"TraceIdRatioBased{"+this._ratio+"}"},t.prototype._normalize=function(e){return typeof e!="number"||isNaN(e)?0:e>=1?1:e<=0?0:e},t.prototype._accumulate=function(e){for(var r=0,n=0;n<e.length/8;n++){var o=n*8,s=parseInt(e.slice(o,o+8),16);r=(r^s)>>>0}return r},t}()});function RN(){return{sampler:Oq(SMe),forceFlushTimeoutMillis:3e4,generalLimits:{attributeValueLengthLimit:vo().OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT,attributeCountLimit:vo().OTEL_ATTRIBUTE_COUNT_LIMIT},spanLimits:{attributeValueLengthLimit:vo().OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT,attributeCountLimit:vo().OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT,linkCountLimit:vo().OTEL_SPAN_LINK_COUNT_LIMIT,eventCountLimit:vo().OTEL_SPAN_EVENT_COUNT_LIMIT,attributePerEventCountLimit:vo().OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT,attributePerLinkCountLimit:vo().OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT}}}function Oq(t){switch(t===void 0&&(t=vo()),t.OTEL_TRACES_SAMPLER){case fc.AlwaysOn:return new Qp;case fc.AlwaysOff:return new O0;case fc.ParentBasedAlwaysOn:return new fw({root:new Qp});case fc.ParentBasedAlwaysOff:return new fw({root:new O0});case fc.TraceIdRatio:return new wN(cue(t));case fc.ParentBasedTraceIdRatio:return new fw({root:new wN(cue(t))});default:return dt.error('OTEL_TRACES_SAMPLER value "'+t.OTEL_TRACES_SAMPLER+" invalid, defaulting to "+IMe+'".'),new Qp}}function cue(t){if(t.OTEL_TRACES_SAMPLER_ARG===void 0||t.OTEL_TRACES_SAMPLER_ARG==="")return dt.error("OTEL_TRACES_SAMPLER_ARG is blank, defaulting to "+gx+"."),gx;var e=Number(t.OTEL_TRACES_SAMPLER_ARG);return isNaN(e)?(dt.error("OTEL_TRACES_SAMPLER_ARG="+t.OTEL_TRACES_SAMPLER_ARG+" was given, but it is invalid, defaulting to "+gx+"."),gx):e<0||e>1?(dt.error("OTEL_TRACES_SAMPLER_ARG="+t.OTEL_TRACES_SAMPLER_ARG+" was given, but it is out of range ([0..1]), defaulting to "+gx+"."),gx):e}var SMe,IMe,gx,Mq=R(()=>{gr();ia();TN();EN();Nq();Lq();SMe=vo(),IMe=fc.AlwaysOn,gx=1});function uue(t){var e={sampler:Oq()},r=RN(),n=Object.assign({},r,e,t);return n.generalLimits=Object.assign({},r.generalLimits,t.generalLimits||{}),n.spanLimits=Object.assign({},r.spanLimits,t.spanLimits||{}),n}function lue(t){var e,r,n,o,s,a,c,u,l,d,p,f,m=Object.assign({},t.spanLimits),h=lq();return m.attributeCountLimit=(a=(s=(o=(r=(e=t.spanLimits)===null||e===void 0?void 0:e.attributeCountLimit)!==null&&r!==void 0?r:(n=t.generalLimits)===null||n===void 0?void 0:n.attributeCountLimit)!==null&&o!==void 0?o:h.OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT)!==null&&s!==void 0?s:h.OTEL_ATTRIBUTE_COUNT_LIMIT)!==null&&a!==void 0?a:mx,m.attributeValueLengthLimit=(f=(p=(d=(u=(c=t.spanLimits)===null||c===void 0?void 0:c.attributeValueLengthLimit)!==null&&u!==void 0?u:(l=t.generalLimits)===null||l===void 0?void 0:l.attributeValueLengthLimit)!==null&&d!==void 0?d:h.OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT)!==null&&p!==void 0?p:h.OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT)!==null&&f!==void 0?f:fx,Object.assign({},t,{spanLimits:m})}var Fq=R(()=>{Mq();ia()});var due,pue=R(()=>{gr();ia();due=function(){function t(e,r){this._exporter=e,this._finishedSpans=[],this._droppedSpansCount=0;var n=vo();this._maxExportBatchSize=typeof r?.maxExportBatchSize=="number"?r.maxExportBatchSize:n.OTEL_BSP_MAX_EXPORT_BATCH_SIZE,this._maxQueueSize=typeof r?.maxQueueSize=="number"?r.maxQueueSize:n.OTEL_BSP_MAX_QUEUE_SIZE,this._scheduledDelayMillis=typeof r?.scheduledDelayMillis=="number"?r.scheduledDelayMillis:n.OTEL_BSP_SCHEDULE_DELAY,this._exportTimeoutMillis=typeof r?.exportTimeoutMillis=="number"?r.exportTimeoutMillis:n.OTEL_BSP_EXPORT_TIMEOUT,this._shutdownOnce=new dw(this._shutdown,this),this._maxExportBatchSize>this._maxQueueSize&&(dt.warn("BatchSpanProcessor: maxExportBatchSize must be smaller or equal to maxQueueSize, setting maxExportBatchSize to match maxQueueSize"),this._maxExportBatchSize=this._maxQueueSize)}return t.prototype.forceFlush=function(){return this._shutdownOnce.isCalled?this._shutdownOnce.promise:this._flushAll()},t.prototype.onStart=function(e,r){},t.prototype.onEnd=function(e){this._shutdownOnce.isCalled||e.spanContext().traceFlags&Ni.SAMPLED&&this._addToBuffer(e)},t.prototype.shutdown=function(){return this._shutdownOnce.call()},t.prototype._shutdown=function(){var e=this;return Promise.resolve().then(function(){return e.onShutdown()}).then(function(){return e._flushAll()}).then(function(){return e._exporter.shutdown()})},t.prototype._addToBuffer=function(e){if(this._finishedSpans.length>=this._maxQueueSize){this._droppedSpansCount===0&&dt.debug("maxQueueSize reached, dropping spans"),this._droppedSpansCount++;return}this._droppedSpansCount>0&&(dt.warn("Dropped "+this._droppedSpansCount+" spans because maxQueueSize reached"),this._droppedSpansCount=0),this._finishedSpans.push(e),this._maybeStartTimer()},t.prototype._flushAll=function(){var e=this;return new Promise(function(r,n){for(var o=[],s=Math.ceil(e._finishedSpans.length/e._maxExportBatchSize),a=0,c=s;a<c;a++)o.push(e._flushOneBatch());Promise.all(o).then(function(){r()}).catch(n)})},t.prototype._flushOneBatch=function(){var e=this;return this._clearTimer(),this._finishedSpans.length===0?Promise.resolve():new Promise(function(r,n){var o=setTimeout(function(){n(new Error("Timeout"))},e._exportTimeoutMillis);na.with(nw(na.active()),function(){var s=e._finishedSpans.splice(0,e._maxExportBatchSize),a=function(){return e._exporter.export(s,function(u){var l;clearTimeout(o),u.code===Xc.SUCCESS?r():n((l=u.error)!==null&&l!==void 0?l:new Error("BatchSpanProcessor: span export failed"))})},c=s.map(function(u){return u.resource}).filter(function(u){return u.asyncAttributesPending});c.length===0?a():Promise.all(c.map(function(u){var l;return(l=u.waitForAsyncAttributes)===null||l===void 0?void 0:l.call(u)})).then(a,function(u){Na(u),n(u)})})})},t.prototype._maybeStartTimer=function(){var e=this;this._timer===void 0&&(this._timer=setTimeout(function(){e._flushOneBatch().then(function(){e._finishedSpans.length>0&&(e._clearTimer(),e._maybeStartTimer())}).catch(function(r){Na(r)})},this._scheduledDelayMillis),hq(this._timer))},t.prototype._clearTimer=function(){this._timer!==void 0&&(clearTimeout(this._timer),this._timer=void 0)},t}()});var CMe,Uq,fue=R(()=>{pue();CMe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Uq=function(t){CMe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.onShutdown=function(){},e}(due)});function mue(t){return function(){for(var r=0;r<t/4;r++)kN.writeUInt32BE(Math.random()*Math.pow(2,32)>>>0,r*4);for(var r=0;r<t&&!(kN[r]>0);r++)r===t-1&&(kN[t-1]=1);return kN.toString("hex",0,t)}}var TMe,hue,Bq,kN,gue=R(()=>{TMe=8,hue=16,Bq=function(){function t(){this.generateTraceId=mue(hue),this.generateSpanId=mue(TMe)}return t}(),kN=Buffer.allocUnsafe(hue)});var vue=R(()=>{fue();gue()});var AN=R(()=>{vue()});var qq,yue=R(()=>{gr();ia();Dq();Fq();AN();qq=function(){function t(e,r,n){this._tracerProvider=n;var o=uue(r);this._sampler=o.sampler,this._generalLimits=o.generalLimits,this._spanLimits=o.spanLimits,this._idGenerator=r.idGenerator||new Bq,this.resource=n.resource,this.instrumentationLibrary=e}return t.prototype.startSpan=function(e,r,n){var o,s,a;r===void 0&&(r={}),n===void 0&&(n=na.active()),r.root&&(n=go.deleteSpan(n));var c=go.getSpan(n);if(D0(n)){dt.debug("Instrumentation suppressed, returning Noop Span");var u=go.wrapSpanContext(cx);return u}var l=c?.spanContext(),d=this._idGenerator.generateSpanId(),p,f,m;!l||!go.isSpanContextValid(l)?p=this._idGenerator.generateTraceId():(p=l.traceId,f=l.traceState,m=l.spanId);var h=(o=r.kind)!==null&&o!==void 0?o:ux.INTERNAL,g=((s=r.links)!==null&&s!==void 0?s:[]).map(function(w){return{context:w.context,attributes:N0(w.attributes)}}),v=N0(r.attributes),y=this._sampler.shouldSample(n,p,e,h,v,g);f=(a=y.traceState)!==null&&a!==void 0?a:f;var _=y.decision===Da.RECORD_AND_SAMPLED?Ni.SAMPLED:Ni.NONE,b={traceId:p,spanId:d,traceFlags:_,traceState:f};if(y.decision===Da.NOT_RECORD){dt.debug("Recording is off, propagating context in a non-recording span");var u=go.wrapSpanContext(b);return u}var S=new Pq(this,n,e,b,h,m,g,r.startTime),I=N0(Object.assign(v,y.attributes));return S.setAttributes(I),S},t.prototype.startActiveSpan=function(e,r,n,o){var s,a,c;if(!(arguments.length<2)){arguments.length===2?c=r:arguments.length===3?(s=r,c=n):(s=r,a=n,c=o);var u=a??na.active(),l=this.startSpan(e,s,u),d=go.setSpan(u,l);return na.with(d,c,void 0,l)}},t.prototype.getGeneralLimits=function(){return this._generalLimits},t.prototype.getSpanLimits=function(){return this._spanLimits},t.prototype.getActiveSpanProcessor=function(){return this._tracerProvider.getActiveSpanProcessor()},t}()});function bue(){return"unknown_service:"+process.argv0}var _ue=R(()=>{});var xue,Sue,Hq=R(()=>{xue=function(t){switch(t){case"arm":return"arm32";case"ppc":return"ppc32";case"x64":return"amd64";default:return t}},Sue=function(t){switch(t){case"sunos":return"solaris";case"win32":return"windows";default:return t}}});var Iue,Cue,vx,PN=R(()=>{Iue=W(require("child_process")),Cue=W(require("util")),vx=Cue.promisify(Iue.exec)});var Tue={};dn(Tue,{getMachineId:()=>RMe});function RMe(){return EMe(this,void 0,void 0,function(){var t,e,r,n;return wMe(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,vx('ioreg -rd1 -c "IOPlatformExpertDevice"')];case 1:return t=o.sent(),e=t.stdout.split(`
`).find(function(s){return s.includes("IOPlatformUUID")}),e?(r=e.split('" = "'),r.length===2?[2,r[1].slice(0,-1)]:[3,3]):[2,""];case 2:return n=o.sent(),dt.debug("error reading machine id: "+n),[3,3];case 3:return[2,""]}})})}var EMe,wMe,Eue=R(()=>{PN();gr();EMe=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},wMe=function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(d){return u([l,d])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=l[0]&2?o.return:l[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,l[1])).done)return s;switch(o=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(d){l=[6,d],o=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}});var Rue={};dn(Rue,{getMachineId:()=>DMe});function DMe(){return kMe(this,void 0,void 0,function(){var t,e,r,n,o,s,a,c,u;return AMe(this,function(l){switch(l.label){case 0:t=["/etc/machine-id","/var/lib/dbus/machine-id"],l.label=1;case 1:l.trys.push([1,8,9,10]),e=PMe(t),r=e.next(),l.label=2;case 2:if(r.done)return[3,7];n=r.value,l.label=3;case 3:return l.trys.push([3,5,,6]),[4,wue.promises.readFile(n,{encoding:"utf8"})];case 4:return o=l.sent(),[2,o.trim()];case 5:return s=l.sent(),dt.debug("error reading machine id: "+s),[3,6];case 6:return r=e.next(),[3,2];case 7:return[3,10];case 8:return a=l.sent(),c={error:a},[3,10];case 9:try{r&&!r.done&&(u=e.return)&&u.call(e)}finally{if(c)throw c.error}return[7];case 10:return[2,""]}})})}var wue,kMe,AMe,PMe,kue=R(()=>{wue=require("fs");gr();kMe=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},AMe=function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(d){return u([l,d])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=l[0]&2?o.return:l[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,l[1])).done)return s;switch(o=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(d){l=[6,d],o=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},PMe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}});var Pue={};dn(Pue,{getMachineId:()=>OMe});function OMe(){return NMe(this,void 0,void 0,function(){var e,t,e,r;return LMe(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Aue.promises.readFile("/etc/hostid",{encoding:"utf8"})];case 1:return e=n.sent(),[2,e.trim()];case 2:return t=n.sent(),dt.debug("error reading machine id: "+t),[3,3];case 3:return n.trys.push([3,5,,6]),[4,vx("kenv -q smbios.system.uuid")];case 4:return e=n.sent(),[2,e.stdout.trim()];case 5:return r=n.sent(),dt.debug("error reading machine id: "+r),[3,6];case 6:return[2,""]}})})}var Aue,NMe,LMe,Due=R(()=>{Aue=require("fs");PN();gr();NMe=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},LMe=function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(d){return u([l,d])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=l[0]&2?o.return:l[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,l[1])).done)return s;switch(o=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(d){l=[6,d],o=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}});var Nue={};dn(Nue,{getMachineId:()=>UMe});function UMe(){return MMe(this,void 0,void 0,function(){var t,e,r,n,o;return FMe(this,function(s){switch(s.label){case 0:t="QUERY HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography /v MachineGuid",e="%windir%\\System32\\REG.exe",DN.arch==="ia32"&&"PROCESSOR_ARCHITEW6432"in DN.env&&(e="%windir%\\sysnative\\cmd.exe /c "+e),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,vx(e+" "+t)];case 2:return r=s.sent(),n=r.stdout.split("REG_SZ"),n.length===2?[2,n[1].trim()]:[3,4];case 3:return o=s.sent(),dt.debug("error reading machine id: "+o),[3,4];case 4:return[2,""]}})})}var DN,MMe,FMe,Lue=R(()=>{DN=W(require("process"));PN();gr();MMe=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},FMe=function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(d){return u([l,d])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=l[0]&2?o.return:l[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,l[1])).done)return s;switch(o=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(d){l=[6,d],o=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}});var Oue={};dn(Oue,{getMachineId:()=>HMe});function HMe(){return BMe(this,void 0,void 0,function(){return qMe(this,function(t){return dt.debug("could not read machine-id: unsupported platform"),[2,""]})})}var BMe,qMe,Mue=R(()=>{gr();BMe=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},qMe=function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(d){return u([l,d])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=l[0]&2?o.return:l[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,l[1])).done)return s;switch(o=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(d){l=[6,d],o=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}});var Fue,M0,Uue=R(()=>{Fue=W(require("process"));switch(Fue.platform){case"darwin":M0=(Eue(),Gi(Tue)).getMachineId;break;case"linux":M0=(kue(),Gi(Rue)).getMachineId;break;case"freebsd":M0=(Due(),Gi(Pue)).getMachineId;break;case"win32":M0=(Lue(),Gi(Nue)).getMachineId;break;default:M0=(Mue(),Gi(Oue)).getMachineId}});var NN,jMe,Bue,jq=R(()=>{el();yx();NN=require("os");Hq();Uue();jMe=function(){function t(){}return t.prototype.detect=function(e){var r,n=(r={},r[sr.HOST_NAME]=(0,NN.hostname)(),r[sr.HOST_ARCH]=xue((0,NN.arch)()),r);return new oa(n,this._getAsyncAttributes())},t.prototype._getAsyncAttributes=function(){return M0().then(function(e){var r={};return e&&(r[sr.HOST_ID]=e),r})},t}(),Bue=new jMe});var zMe,eCt,que=R(()=>{jq();zMe=function(){function t(){}return t.prototype.detect=function(e){return Promise.resolve(Bue.detect(e))},t}(),eCt=new zMe});var LN,GMe,Hue,zq=R(()=>{el();yx();LN=require("os");Hq();GMe=function(){function t(){}return t.prototype.detect=function(e){var r,n=(r={},r[sr.OS_TYPE]=Sue((0,LN.platform)()),r[sr.OS_VERSION]=(0,LN.release)(),r);return new oa(n)},t}(),Hue=new GMe});var VMe,aCt,jue=R(()=>{zq();VMe=function(){function t(){}return t.prototype.detect=function(e){return Promise.resolve(Hue.detect(e))},t}(),aCt=new VMe});var Vue,zue,Gue,$Me,$ue,Gq=R(()=>{gr();el();yx();Vue=W(require("os")),zue=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},Gue=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,s;n<o;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},$Me=function(){function t(){}return t.prototype.detect=function(e){var r,n=(r={},r[sr.PROCESS_PID]=process.pid,r[sr.PROCESS_EXECUTABLE_NAME]=process.title,r[sr.PROCESS_EXECUTABLE_PATH]=process.execPath,r[sr.PROCESS_COMMAND_ARGS]=Gue(Gue([process.argv[0]],zue(process.execArgv),!1),zue(process.argv.slice(1)),!1),r[sr.PROCESS_RUNTIME_VERSION]=process.versions.node,r[sr.PROCESS_RUNTIME_NAME]="nodejs",r[sr.PROCESS_RUNTIME_DESCRIPTION]="Node.js",r);process.argv.length>1&&(n[sr.PROCESS_COMMAND]=process.argv[1]);try{var o=Vue.userInfo();n[sr.PROCESS_OWNER]=o.username}catch(s){dt.debug("error obtaining process owner: "+s)}return new oa(n)},t}(),$ue=new $Me});var WMe,mCt,Wue=R(()=>{Gq();WMe=function(){function t(){}return t.prototype.detect=function(e){return Promise.resolve($ue.detect(e))},t}(),mCt=new WMe});var Kue=R(()=>{_ue();que();jue();jq();zq();Wue();Gq()});var Vq=R(()=>{Kue()});var uh,KMe,YMe,QMe,oa,yx=R(()=>{gr();el();ia();Vq();uh=function(){return uh=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},uh.apply(this,arguments)},KMe=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},YMe=function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(d){return u([l,d])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=l[0]&2?o.return:l[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,l[1])).done)return s;switch(o=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(d){l=[6,d],o=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},QMe=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},oa=function(){function t(e,r){var n=this,o;this._attributes=e,this.asyncAttributesPending=r!=null,this._syncAttributes=(o=this._attributes)!==null&&o!==void 0?o:{},this._asyncAttributesPromise=r?.then(function(s){return n._attributes=Object.assign({},n._attributes,s),n.asyncAttributesPending=!1,s},function(s){return dt.debug("a resource's async attributes promise rejected: %s",s),n.asyncAttributesPending=!1,{}})}return t.empty=function(){return t.EMPTY},t.default=function(){var e;return new t((e={},e[sr.SERVICE_NAME]=bue(),e[sr.TELEMETRY_SDK_LANGUAGE]=sw[sr.TELEMETRY_SDK_LANGUAGE],e[sr.TELEMETRY_SDK_NAME]=sw[sr.TELEMETRY_SDK_NAME],e[sr.TELEMETRY_SDK_VERSION]=sw[sr.TELEMETRY_SDK_VERSION],e))},Object.defineProperty(t.prototype,"attributes",{get:function(){var e;return this.asyncAttributesPending&&dt.error("Accessing resource attributes before async attributes settled"),(e=this._attributes)!==null&&e!==void 0?e:{}},enumerable:!1,configurable:!0}),t.prototype.waitForAsyncAttributes=function(){return KMe(this,void 0,void 0,function(){return YMe(this,function(e){switch(e.label){case 0:return this.asyncAttributesPending?[4,this._asyncAttributesPromise]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.merge=function(e){var r=this,n;if(!e)return this;var o=uh(uh({},this._syncAttributes),(n=e._syncAttributes)!==null&&n!==void 0?n:e.attributes);if(!this._asyncAttributesPromise&&!e._asyncAttributesPromise)return new t(o);var s=Promise.all([this._asyncAttributesPromise,e._asyncAttributesPromise]).then(function(a){var c,u=QMe(a,2),l=u[0],d=u[1];return uh(uh(uh(uh({},r._syncAttributes),l),(c=e._syncAttributes)!==null&&c!==void 0?c:e.attributes),d)});return new t(o,s)},t.EMPTY=new t({}),t}()});var Yue=R(()=>{});var Que=R(()=>{});var Xue=R(()=>{});var XMe,DCt,Jue=R(()=>{ON();XMe=function(){function t(){}return t.prototype.detect=function(e){return Promise.resolve(Zue.detect(e))},t}(),DCt=new XMe});var JMe,ZMe,eFe,ele,$q=R(()=>{gr();ia();el();yx();JMe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ZMe=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},eFe=function(){function t(){this._MAX_LENGTH=255,this._COMMA_SEPARATOR=",",this._LABEL_KEY_VALUE_SPLITTER="=",this._ERROR_MESSAGE_INVALID_CHARS="should be a ASCII string with a length greater than 0 and not exceed "+this._MAX_LENGTH+" characters.",this._ERROR_MESSAGE_INVALID_VALUE="should be a ASCII string with a length not exceed "+this._MAX_LENGTH+" characters."}return t.prototype.detect=function(e){var r={},n=vo(),o=n.OTEL_RESOURCE_ATTRIBUTES,s=n.OTEL_SERVICE_NAME;if(o)try{var a=this._parseResourceAttributes(o);Object.assign(r,a)}catch(c){dt.debug("EnvDetector failed: "+c.message)}return s&&(r[sr.SERVICE_NAME]=s),new oa(r)},t.prototype._parseResourceAttributes=function(e){var r,n;if(!e)return{};var o={},s=e.split(this._COMMA_SEPARATOR,-1);try{for(var a=JMe(s),c=a.next();!c.done;c=a.next()){var u=c.value,l=u.split(this._LABEL_KEY_VALUE_SPLITTER,-1);if(l.length===2){var d=ZMe(l,2),p=d[0],f=d[1];if(p=p.trim(),f=f.trim().split(/^"|"$/).join(""),!this._isValidAndNotEmpty(p))throw new Error("Attribute key "+this._ERROR_MESSAGE_INVALID_CHARS);if(!this._isValid(f))throw new Error("Attribute value "+this._ERROR_MESSAGE_INVALID_VALUE);o[p]=decodeURIComponent(f)}}}catch(m){r={error:m}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return o},t.prototype._isValid=function(e){return e.length<=this._MAX_LENGTH&&this._isBaggageOctetString(e)},t.prototype._isBaggageOctetString=function(e){for(var r=0;r<e.length;r++){var n=e.charCodeAt(r);if(n<33||n===44||n===59||n===92||n>126)return!1}return!0},t.prototype._isValidAndNotEmpty=function(e){return e.length>0&&this._isValid(e)},t}(),ele=new eFe});var tFe,qCt,tle=R(()=>{$q();tFe=function(){function t(){}return t.prototype.detect=function(e){return Promise.resolve(ele.detect(e))},t}(),qCt=new tFe});var Wq,rFe,Zue,rle=R(()=>{el();ON();gr();Wq=function(){return Wq=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Wq.apply(this,arguments)},rFe=function(){function t(){}return t.prototype.detect=function(e){var r,n=typeof navigator<"u";if(!n)return oa.empty();var o=(r={},r[sr.PROCESS_RUNTIME_NAME]="browser",r[sr.PROCESS_RUNTIME_DESCRIPTION]="Web Browser",r[sr.PROCESS_RUNTIME_VERSION]=navigator.userAgent,r);return this._getResourceAttributes(o,e)},t.prototype._getResourceAttributes=function(e,r){return e[sr.PROCESS_RUNTIME_VERSION]===""?(dt.debug("BrowserDetector failed: Unable to find required browser resources. "),oa.empty()):new oa(Wq({},e))},t}(),Zue=new rFe});var nle=R(()=>{Jue();tle();rle();$q()});var ile=R(()=>{});var ON=R(()=>{yx();Yue();Vq();Que();Xue();nle();ile()});var MN,ole,sle=R(()=>{ia();MN=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ole=function(){function t(e){this._spanProcessors=e}return t.prototype.forceFlush=function(){var e,r,n=[];try{for(var o=MN(this._spanProcessors),s=o.next();!s.done;s=o.next()){var a=s.value;n.push(a.forceFlush())}}catch(c){e={error:c}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return new Promise(function(c){Promise.all(n).then(function(){c()}).catch(function(u){Na(u||new Error("MultiSpanProcessor: forceFlush failed")),c()})})},t.prototype.onStart=function(e,r){var n,o;try{for(var s=MN(this._spanProcessors),a=s.next();!a.done;a=s.next()){var c=a.value;c.onStart(e,r)}}catch(u){n={error:u}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}},t.prototype.onEnd=function(e){var r,n;try{for(var o=MN(this._spanProcessors),s=o.next();!s.done;s=o.next()){var a=s.value;a.onEnd(e)}}catch(c){r={error:c}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}},t.prototype.shutdown=function(){var e,r,n=[];try{for(var o=MN(this._spanProcessors),s=o.next();!s.done;s=o.next()){var a=s.value;n.push(a.shutdown())}}catch(c){e={error:c}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return new Promise(function(c,u){Promise.all(n).then(function(){c()},u)})},t}()});var Kq,Yq=R(()=>{Kq=function(){function t(){}return t.prototype.onStart=function(e,r){},t.prototype.onEnd=function(e){},t.prototype.shutdown=function(){return Promise.resolve()},t.prototype.forceFlush=function(){return Promise.resolve()},t}()});var lh,nFe,ale=R(()=>{gr();ia();ON();Qq();Mq();sle();Yq();AN();Fq();(function(t){t[t.resolved=0]="resolved",t[t.timeout=1]="timeout",t[t.error=2]="error",t[t.unresolved=3]="unresolved"})(lh||(lh={}));nFe=function(){function t(e){e===void 0&&(e={});var r;this._registeredSpanProcessors=[],this._tracers=new Map;var n=kq({},RN(),lue(e));this.resource=(r=n.resource)!==null&&r!==void 0?r:oa.empty(),this.resource=oa.default().merge(this.resource),this._config=Object.assign({},n,{resource:this.resource});var o=this._buildExporterFromEnv();if(o!==void 0){var s=new Uq(o);this.activeSpanProcessor=s}else this.activeSpanProcessor=new Kq}return t.prototype.getTracer=function(e,r,n){var o=e+"@"+(r||"")+":"+(n?.schemaUrl||"");return this._tracers.has(o)||this._tracers.set(o,new qq({name:e,version:r,schemaUrl:n?.schemaUrl},this._config,this)),this._tracers.get(o)},t.prototype.addSpanProcessor=function(e){this._registeredSpanProcessors.length===0&&this.activeSpanProcessor.shutdown().catch(function(r){return dt.error("Error while trying to shutdown current span processor",r)}),this._registeredSpanProcessors.push(e),this.activeSpanProcessor=new ole(this._registeredSpanProcessors)},t.prototype.getActiveSpanProcessor=function(){return this.activeSpanProcessor},t.prototype.register=function(e){e===void 0&&(e={}),go.setGlobalTracerProvider(this),e.propagator===void 0&&(e.propagator=this._buildPropagatorFromEnv()),e.contextManager&&na.setGlobalContextManager(e.contextManager),e.propagator&&Wp.setGlobalPropagator(e.propagator)},t.prototype.forceFlush=function(){var e=this._config.forceFlushTimeoutMillis,r=this._registeredSpanProcessors.map(function(n){return new Promise(function(o){var s,a=setTimeout(function(){o(new Error("Span processor did not completed within timeout period of "+e+" ms")),s=lh.timeout},e);n.forceFlush().then(function(){clearTimeout(a),s!==lh.timeout&&(s=lh.resolved,o(s))}).catch(function(c){clearTimeout(a),s=lh.error,o(c)})})});return new Promise(function(n,o){Promise.all(r).then(function(s){var a=s.filter(function(c){return c!==lh.resolved});a.length>0?o(a):n()}).catch(function(s){return o([s])})})},t.prototype.shutdown=function(){return this.activeSpanProcessor.shutdown()},t.prototype._getPropagator=function(e){var r;return(r=this.constructor._registeredPropagators.get(e))===null||r===void 0?void 0:r()},t.prototype._getSpanExporter=function(e){var r;return(r=this.constructor._registeredExporters.get(e))===null||r===void 0?void 0:r()},t.prototype._buildPropagatorFromEnv=function(){var e=this,r=Array.from(new Set(vo().OTEL_PROPAGATORS)),n=r.map(function(s){var a=e._getPropagator(s);return a||dt.warn('Propagator "'+s+'" requested through environment variable is unavailable.'),a}),o=n.reduce(function(s,a){return a&&s.push(a),s},[]);if(o.length!==0)return r.length===1?o[0]:new yq({propagators:o})},t.prototype._buildExporterFromEnv=function(){var e=vo().OTEL_TRACES_EXPORTER;if(!(e==="none"||e==="")){var r=this._getSpanExporter(e);return r||dt.error('Exporter "'+e+'" requested through environment variable is unavailable.'),r}},t._registeredPropagators=new Map([["tracecontext",function(){return new Sq}],["baggage",function(){return new oq}]]),t._registeredExporters=new Map,t}()});var iFe,oFe,cle=R(()=>{ia();iFe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},oFe=function(){function t(){}return t.prototype.export=function(e,r){return this._sendSpans(e,r)},t.prototype.shutdown=function(){return this._sendSpans([]),this.forceFlush()},t.prototype.forceFlush=function(){return Promise.resolve()},t.prototype._exportInfo=function(e){var r;return{traceId:e.spanContext().traceId,parentId:e.parentSpanId,traceState:(r=e.spanContext().traceState)===null||r===void 0?void 0:r.serialize(),name:e.name,id:e.spanContext().spanId,kind:e.kind,timestamp:vN(e.startTime),duration:vN(e.duration),attributes:e.attributes,status:e.status,events:e.events,links:e.links}},t.prototype._sendSpans=function(e,r){var n,o;try{for(var s=iFe(e),a=s.next();!a.done;a=s.next()){var c=a.value;console.dir(this._exportInfo(c),{depth:3})}}catch(u){n={error:u}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}if(r)return r({code:Xc.SUCCESS})},t}()});var sFe,aFe,cFe,ule=R(()=>{ia();sFe=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},aFe=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,s;n<o;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},cFe=function(){function t(){this._finishedSpans=[],this._stopped=!1}return t.prototype.export=function(e,r){var n;if(this._stopped)return r({code:Xc.FAILED,error:new Error("Exporter has been stopped")});(n=this._finishedSpans).push.apply(n,aFe([],sFe(e),!1)),setTimeout(function(){return r({code:Xc.SUCCESS})},0)},t.prototype.shutdown=function(){return this._stopped=!0,this._finishedSpans=[],this.forceFlush()},t.prototype.forceFlush=function(){return Promise.resolve()},t.prototype.reset=function(){this._finishedSpans=[]},t.prototype.getFinishedSpans=function(){return this._finishedSpans},t}()});var lle=R(()=>{});var uFe,lFe,dFe,dle=R(()=>{gr();ia();uFe=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},lFe=function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(d){return u([l,d])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=l[0]&2?o.return:l[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,l[1])).done)return s;switch(o=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(d){l=[6,d],o=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},dFe=function(){function t(e){this._exporter=e,this._shutdownOnce=new dw(this._shutdown,this),this._unresolvedExports=new Set}return t.prototype.forceFlush=function(){return uFe(this,void 0,void 0,function(){return lFe(this,function(e){switch(e.label){case 0:return[4,Promise.all(Array.from(this._unresolvedExports))];case 1:return e.sent(),this._exporter.forceFlush?[4,this._exporter.forceFlush()]:[3,3];case 2:e.sent(),e.label=3;case 3:return[2]}})})},t.prototype.onStart=function(e,r){},t.prototype.onEnd=function(e){var r=this,n,o;if(!this._shutdownOnce.isCalled&&e.spanContext().traceFlags&Ni.SAMPLED){var s=function(){return Aq._export(r._exporter,[e]).then(function(c){var u;c.code!==Xc.SUCCESS&&Na((u=c.error)!==null&&u!==void 0?u:new Error("SimpleSpanProcessor: span export failed (status "+c+")"))}).catch(function(c){Na(c)})};if(e.resource.asyncAttributesPending){var a=(o=(n=e.resource).waitForAsyncAttributes)===null||o===void 0?void 0:o.call(n).then(function(){return a!=null&&r._unresolvedExports.delete(a),s()},function(c){return Na(c)});a!=null&&this._unresolvedExports.add(a)}else s()}},t.prototype.shutdown=function(){return this._shutdownOnce.call()},t.prototype._shutdown=function(){return this._exporter.shutdown()},t}()});var ple=R(()=>{});var fle=R(()=>{});var mle=R(()=>{});var hle=R(()=>{});var gle=R(()=>{});var vle={};dn(vle,{AlwaysOffSampler:()=>O0,AlwaysOnSampler:()=>Qp,BasicTracerProvider:()=>nFe,BatchSpanProcessor:()=>Uq,ConsoleSpanExporter:()=>oFe,ForceFlushState:()=>lh,InMemorySpanExporter:()=>cFe,NoopSpanProcessor:()=>Kq,ParentBasedSampler:()=>fw,RandomIdGenerator:()=>Bq,SamplingDecision:()=>od,SimpleSpanProcessor:()=>dFe,Span:()=>Pq,TraceIdRatioBasedSampler:()=>wN,Tracer:()=>qq});var Qq=R(()=>{yue();ale();AN();cle();ule();lle();dle();ple();Yq();TN();EN();Nq();Lq();pw();Dq();fle();mle();hle();gle()});var ble=L(Jc=>{"use strict";Object.defineProperty(Jc,"__esModule",{value:!0});Jc.enable=Jc.azureCoreTracing=Jc.AzureMonitorSymbol=void 0;var Xq=_i();Jc.AzureMonitorSymbol="Azure_Monitor_Tracer";var Jq="azure-coretracing",yle=!1,pFe=function(t){if(yle)return t;try{var e=(Qq(),Gi(vle)),r=(gr(),Gi(dx)),n=new e.BasicTracerProvider,o=n.getTracer("applicationinsights tracer");if(t.setTracer){var s=t.setTracer;t.setTracer=function(l){var d=l.startSpan;l.startSpan=function(p,f,m){var h=d.call(this,p,f,m),g=h.end;return h.end=function(){var v=g.apply(this,arguments);return Xq.channel.publish(Jq,h),v},h},l[Jc.AzureMonitorSymbol]=!0,s.call(this,l)},r.trace.getSpan(r.context.active()),t.setTracer(o)}else{var a=r.trace.setGlobalTracerProvider;r.trace.setGlobalTracerProvider=function(l){var d=l.getTracer;return l.getTracer=function(p,f){var m=d.call(this,p,f);if(!m[Jc.AzureMonitorSymbol]){var h=m.startSpan;m.startSpan=function(g,v,y){var _=h.call(this,g,v,y),b=_.end;return _.end=function(){var S=b.apply(this,arguments);return Xq.channel.publish(Jq,_),S},_},m[Jc.AzureMonitorSymbol]=!0}return m},a.call(this,l)},n.register(),r.trace.getSpan(r.context.active());var c=require("@opentelemetry/instrumentation"),u=require("@azure/opentelemetry-instrumentation-azure-sdk");c.registerInstrumentations({instrumentations:[u.createAzureSdkInstrumentation()]})}yle=!0}catch{}return t};Jc.azureCoreTracing={versionSpecifier:">= 1.0.0 < 2.0.0",patch:pFe,publisherName:Jq};function fFe(){Xq.channel.registerMonkeyPatch("@azure/core-tracing",Jc.azureCoreTracing)}Jc.enable=fFe});var xle=L(F0=>{"use strict";Object.defineProperty(F0,"__esModule",{value:!0});F0.enable=F0.bunyan=void 0;var _le=_i(),mFe=function(t){var e=t.prototype._emit;return t.prototype._emit=function(r,n){var o=e.apply(this,arguments);if(!n){var s=o;s||(s=e.call(this,r,!0)),_le.channel.publish("bunyan",{level:r.level,result:s})}return o},t};F0.bunyan={versionSpecifier:">= 1.0.0 < 2.0.0",patch:mFe};function hFe(){_le.channel.registerMonkeyPatch("bunyan",F0.bunyan)}F0.enable=hFe});var Ile=L(U0=>{"use strict";Object.defineProperty(U0,"__esModule",{value:!0});U0.enable=U0.console=void 0;var Zq=_i(),Sle=require("stream"),gFe=function(t){var e=new Sle.Writable,r=new Sle.Writable;e.write=function(l){if(!l)return!0;var d=l.toString();return Zq.channel.publish("console",{message:d}),!0},r.write=function(l){if(!l)return!0;var d=l.toString();return Zq.channel.publish("console",{message:d,stderr:!0}),!0};for(var n=new t.Console(e,r),o=["log","info","warn","error","dir","time","timeEnd","trace","assert"],s=function(l){var d=t[l];d&&(t[l]=function(){if(n[l])try{n[l].apply(n,arguments)}catch{}return d.apply(t,arguments)})},a=0,c=o;a<c.length;a++){var u=c[a];s(u)}return t};U0.console={versionSpecifier:">= 4.0.0",patch:gFe};function vFe(){Zq.channel.registerMonkeyPatch("console",U0.console),require("console")}U0.enable=vFe});var Cle=L(B0=>{"use strict";Object.defineProperty(B0,"__esModule",{value:!0});B0.enable=B0.mongoCore=void 0;var eH=_i(),yFe=function(t){var e=t.Server.prototype.connect;return t.Server.prototype.connect=function(){var n=e.apply(this,arguments),o=this.s.pool.write;this.s.pool.write=function(){var c=typeof arguments[1]=="function"?1:2;return typeof arguments[c]=="function"&&(arguments[c]=eH.channel.bindToContext(arguments[c])),o.apply(this,arguments)};var s=this.s.pool.logout;return this.s.pool.logout=function(){return typeof arguments[1]=="function"&&(arguments[1]=eH.channel.bindToContext(arguments[1])),s.apply(this,arguments)},n},t};B0.mongoCore={versionSpecifier:">= 2.0.0 < 4.0.0",patch:yFe};function bFe(){eH.channel.registerMonkeyPatch("mongodb-core",B0.mongoCore)}B0.enable=bFe});var Tle=L(sa=>{"use strict";var bx=sa&&sa.__assign||function(){return bx=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},bx.apply(this,arguments)};Object.defineProperty(sa,"__esModule",{value:!0});sa.enable=sa.mongo330=sa.mongo3=sa.mongo2=void 0;var Ls=_i(),_Fe=function(t){var e=t.instrument({operationIdGenerator:{next:function(){return Ls.channel.bindToContext(function(n){return n()})}}}),r={};return e.on("started",function(n){r[n.requestId]||(r[n.requestId]=bx(bx({},n),{time:new Date}))}),e.on("succeeded",function(n){var o=r[n.requestId];o&&delete r[n.requestId],typeof n.operationId=="function"?n.operationId(function(){return Ls.channel.publish("mongodb",{startedData:o,event:n,succeeded:!0})}):Ls.channel.publish("mongodb",{startedData:o,event:n,succeeded:!0})}),e.on("failed",function(n){var o=r[n.requestId];o&&delete r[n.requestId],typeof n.operationId=="function"?n.operationId(function(){return Ls.channel.publish("mongodb",{startedData:o,event:n,succeeded:!1})}):Ls.channel.publish("mongodb",{startedData:o,event:n,succeeded:!1})}),t},xFe=function(t){var e=t.instrument(),r={},n={};return e.on("started",function(o){r[o.requestId]||(n[o.requestId]=Ls.channel.bindToContext(function(s){return s()}),r[o.requestId]=bx(bx({},o),{time:new Date}))}),e.on("succeeded",function(o){var s=r[o.requestId];s&&delete r[o.requestId],typeof o=="object"&&typeof n[o.requestId]=="function"&&(n[o.requestId](function(){return Ls.channel.publish("mongodb",{startedData:s,event:o,succeeded:!0})}),delete n[o.requestId])}),e.on("failed",function(o){var s=r[o.requestId];s&&delete r[o.requestId],typeof o=="object"&&typeof n[o.requestId]=="function"&&(n[o.requestId](function(){return Ls.channel.publish("mongodb",{startedData:s,event:o,succeeded:!1})}),delete n[o.requestId])}),t},SFe=function(t){var e=t.Server.prototype.connect;return t.Server.prototype.connect=function(){var n=e.apply(this,arguments),o=this.s.coreTopology.s.pool.write;this.s.coreTopology.s.pool.write=function(){var c=typeof arguments[1]=="function"?1:2;return typeof arguments[c]=="function"&&(arguments[c]=Ls.channel.bindToContext(arguments[c])),o.apply(this,arguments)};var s=this.s.coreTopology.s.pool.logout;return this.s.coreTopology.s.pool.logout=function(){return typeof arguments[1]=="function"&&(arguments[1]=Ls.channel.bindToContext(arguments[1])),s.apply(this,arguments)},n},t},IFe=function(t){SFe(t);var e=t.instrument(),r={},n={};return e.on("started",function(o){r[o.requestId]||(n[o.requestId]=Ls.channel.bindToContext(function(s){return s()}),r[o.requestId]=o)}),e.on("succeeded",function(o){var s=r[o.requestId];s&&delete r[o.requestId],typeof o=="object"&&typeof n[o.requestId]=="function"&&(n[o.requestId](function(){return Ls.channel.publish("mongodb",{startedData:s,event:o,succeeded:!0})}),delete n[o.requestId])}),e.on("failed",function(o){var s=r[o.requestId];s&&delete r[o.requestId],typeof o=="object"&&typeof n[o.requestId]=="function"&&(n[o.requestId](function(){return Ls.channel.publish("mongodb",{startedData:s,event:o,succeeded:!1})}),delete n[o.requestId])}),t};sa.mongo2={versionSpecifier:">= 2.0.0 <= 3.0.5",patch:_Fe};sa.mongo3={versionSpecifier:"> 3.0.5 < 3.3.0",patch:xFe};sa.mongo330={versionSpecifier:">= 3.3.0 < 4.0.0",patch:IFe};function CFe(){Ls.channel.registerMonkeyPatch("mongodb",sa.mongo2),Ls.channel.registerMonkeyPatch("mongodb",sa.mongo3),Ls.channel.registerMonkeyPatch("mongodb",sa.mongo330)}sa.enable=CFe});var wle=L(q0=>{"use strict";Object.defineProperty(q0,"__esModule",{value:!0});q0.enable=q0.mysql=void 0;var FN=_i(),Ele=require("path"),TFe=function(t,e){var r=function(u,l){return function(d,p){var f=u[d];f&&(u[d]=function(){for(var h=arguments.length-1,g=arguments.length-1;g>=0;--g)if(typeof arguments[g]=="function"){h=g;break}else if(typeof arguments[g]<"u")break;var v=arguments[h],y={result:null,startTime:null,startDate:null};typeof v=="function"&&(p?(y.startTime=process.hrtime(),y.startDate=new Date,arguments[h]=FN.channel.bindToContext(p(y,v))):arguments[h]=FN.channel.bindToContext(v));var _=f.apply(this,arguments);return y.result=_,_})}},n=function(u,l){return r(u.prototype,l+".prototype")},o=["connect","changeUser","ping","statistics","end"],s=require(Ele.dirname(e)+"/lib/Connection");o.forEach(function(u){return n(s,"Connection")(u)}),r(s,"Connection")("createQuery",function(u,l){return function(d){var p=process.hrtime(u.startTime),f=p[0]*1e3+p[1]/1e6|0;FN.channel.publish("mysql",{query:u.result,callbackArgs:arguments,err:d,duration:f,time:u.startDate}),l.apply(this,arguments)}});var a=["_enqueueCallback"],c=require(Ele.dirname(e)+"/lib/Pool");return a.forEach(function(u){return n(c,"Pool")(u)}),t};q0.mysql={versionSpecifier:">= 2.0.0 < 3.0.0",patch:TFe};function EFe(){FN.channel.registerMonkeyPatch("mysql",q0.mysql)}q0.enable=EFe});var kle=L(H0=>{"use strict";Object.defineProperty(H0,"__esModule",{value:!0});H0.enable=H0.postgresPool1=void 0;var Rle=_i();function wFe(t){var e=t.prototype.connect;return t.prototype.connect=function(n){return n&&(arguments[0]=Rle.channel.bindToContext(n)),e.apply(this,arguments)},t}H0.postgresPool1={versionSpecifier:">= 1.0.0 < 3.0.0",patch:wFe};function RFe(){Rle.channel.registerMonkeyPatch("pg-pool",H0.postgresPool1)}H0.enable=RFe});var Ple=L(sd=>{"use strict";Object.defineProperty(sd,"__esModule",{value:!0});sd.enable=sd.postgres=sd.postgres6=void 0;var _x=_i(),Ale=require("events"),tH="postgres";function kFe(t,e){var r=t.Client.prototype.query,n="__diagnosticOriginalFunc";return t.Client.prototype.query=function(s,a,c){var u={query:{},database:{host:this.connectionParameters.host,port:this.connectionParameters.port},result:null,error:null,duration:0,time:new Date},l=process.hrtime(),d;function p(f){f&&f[n]&&(f=f[n]);var m=_x.channel.bindToContext(function(h,g){var v=process.hrtime(l);if(u.result=g&&{rowCount:g.rowCount,command:g.command},u.error=h,u.duration=Math.ceil(v[0]*1e3+v[1]/1e6),_x.channel.publish(tH,u),h){if(f)return f.apply(this,arguments);d&&d instanceof Ale.EventEmitter&&d.emit("error",h)}else f&&f.apply(this,arguments)});try{return Object.defineProperty(m,n,{value:f}),m}catch{return f}}try{typeof s=="string"?a instanceof Array?(u.query.preparable={text:s,args:a},c=p(c)):(u.query.text=s,c?c=p(c):a=p(a)):(typeof s.name=="string"?u.query.plan=s.name:s.values instanceof Array?u.query.preparable={text:s.text,args:s.values}:u.query.text=s.text,c?c=p(c):a?a=p(a):s.callback=p(s.callback))}catch{return r.apply(this,arguments)}return arguments[0]=s,arguments[1]=a,arguments[2]=c,arguments.length=arguments.length>3?arguments.length:3,d=r.apply(this,arguments),d},t}function AFe(t,e){var r=t.Client.prototype.query,n="__diagnosticOriginalFunc";return t.Client.prototype.query=function(s,a,c){var u=this,l,d,p=!!c,f={query:{},database:{host:this.connectionParameters.host,port:this.connectionParameters.port},result:null,error:null,duration:0,time:new Date},m,h=process.hrtime();function g(_){_&&_[n]&&(_=_[n]);var b=_x.channel.bindToContext(function(S,I){var w=process.hrtime(h);if(f.result=I&&{rowCount:I.rowCount,command:I.command},f.error=S,f.duration=Math.ceil(w[0]*1e3+w[1]/1e6),_x.channel.publish(tH,f),S){if(_)return _.apply(this,arguments);m&&m instanceof Ale.EventEmitter&&m.emit("error",S)}else _&&_.apply(this,arguments)});try{return Object.defineProperty(b,n,{value:_}),b}catch{return _}}try{typeof s=="string"?a instanceof Array?(f.query.preparable={text:s,args:a},p=typeof c=="function",c=p?g(c):c):(f.query.text=s,c?(p=typeof c=="function",c=p?g(c):c):(p=typeof a=="function",a=p?g(a):a)):(typeof s.name=="string"?f.query.plan=s.name:s.values instanceof Array?f.query.preparable={text:s.text,args:s.values}:s.cursor?f.query.text=(l=s.cursor)===null||l===void 0?void 0:l.text:f.query.text=s.text,c?(p=typeof c=="function",c=g(c)):a?(p=typeof a=="function",a=p?g(a):a):(p=typeof s.callback=="function",s.callback=p?g(s.callback):s.callback))}catch{return r.apply(this,arguments)}arguments[0]=s,arguments[1]=a,arguments[2]=c,arguments.length=arguments.length>3?arguments.length:3;try{m=r.apply(this,arguments)}catch(_){throw g()(_,void 0),_}if(!p){if(m instanceof Promise)return m.then(function(_){return g()(void 0,_),new u._Promise(function(b,S){b(_)})}).catch(function(_){return g()(_,void 0),new u._Promise(function(b,S){S(_)})});var v=m.text?m.text:"";if(m.cursor&&(v=(d=m.cursor)===null||d===void 0?void 0:d.text),v){var y={command:v,rowCount:0};g()(void 0,y)}}return m},t}sd.postgres6={versionSpecifier:"6.*",patch:kFe};sd.postgres={versionSpecifier:">=7.* <=8.*",patch:AFe,publisherName:tH};function PFe(){_x.channel.registerMonkeyPatch("pg",sd.postgres6),_x.channel.registerMonkeyPatch("pg",sd.postgres)}sd.enable=PFe});var Dle=L(j0=>{"use strict";Object.defineProperty(j0,"__esModule",{value:!0});j0.enable=j0.redis=void 0;var rH=_i(),DFe=function(t){var e=t.RedisClient.prototype.internal_send_command;return t.RedisClient.prototype.internal_send_command=function(r){if(r){var n=r.callback;if(!n||!n.pubsubBound){var o=this.address,s=process.hrtime(),a=new Date;r.callback=rH.channel.bindToContext(function(c,u){var l=process.hrtime(s),d=l[0]*1e3+l[1]/1e6|0;rH.channel.publish("redis",{duration:d,address:o,commandObj:r,err:c,result:u,time:a}),typeof n=="function"&&n.apply(this,arguments)}),r.callback.pubsubBound=!0}}return e.call(this,r)},t};j0.redis={versionSpecifier:">= 2.0.0 < 4.0.0",patch:DFe};function NFe(){rH.channel.registerMonkeyPatch("redis",j0.redis)}j0.enable=NFe});var Nle=L(Xp=>{"use strict";var UN=Xp&&Xp.__assign||function(){return UN=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},UN.apply(this,arguments)};Object.defineProperty(Xp,"__esModule",{value:!0});Xp.enable=Xp.tedious=void 0;var nH=_i(),LFe=function(t){var e=t.Connection.prototype.makeRequest;return t.Connection.prototype.makeRequest=function(){function n(s){var a=process.hrtime(),c={query:{},database:{host:null,port:null},result:null,error:null,duration:0};return nH.channel.bindToContext(function(u,l,d){var p=process.hrtime(a);c=UN(UN({},c),{database:{host:this.connection.config.server,port:this.connection.config.options.port},result:!u&&{rowCount:l,rows:d},query:{text:this.parametersByName.statement.value},error:u,duration:Math.ceil(p[0]*1e3+p[1]/1e6)}),nH.channel.publish("tedious",c),s.call(this,u,l,d)})}var o=arguments[0];arguments[0].callback=n(o.callback),e.apply(this,arguments)},t};Xp.tedious={versionSpecifier:">= 6.0.0 < 9.0.0",patch:LFe};function OFe(){nH.channel.registerMonkeyPatch("tedious",Xp.tedious)}Xp.enable=OFe});var Lle=L(La=>{"use strict";var MFe=La&&La.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),FFe=La&&La.__rest||function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]]);return r};Object.defineProperty(La,"__esModule",{value:!0});La.enable=La.winston2=La.winston3=void 0;var BN=_i(),UFe=function(t){var e=t.Logger.prototype.log,r,n=function(o,s,a){var c;return r===t.config.npm.levels?c="npm":r===t.config.syslog.levels?c="syslog":c="unknown",BN.channel.publish("winston",{level:o,message:s,meta:a,levelKind:c}),s};return t.Logger.prototype.log=function(){return r=this.levels,!this.filters||this.filters.length===0?this.filters=[n]:this.filters[this.filters.length-1]!==n&&(this.filters=this.filters.filter(function(s){return s!==n}),this.filters.push(n)),e.apply(this,arguments)},t},BFe=function(t){var e=function(a,c){var u;return a.config.npm.levels[c]!=null?u="npm":a.config.syslog.levels[c]!=null?u="syslog":u="unknown",u},r=function(a){MFe(c,a);function c(u,l){var d=a.call(this,l)||this;return d.winston=u,d}return c.prototype.log=function(u,l){var d=u.message,p=u.level,f=u.meta,m=FFe(u,["message","level","meta"]);p=typeof Symbol.for=="function"?u[Symbol.for("level")]:p,d=u instanceof Error?u:d;var h=e(this.winston,p);f=f||{};for(var g in m)m.hasOwnProperty(g)&&(f[g]=m[g]);BN.channel.publish("winston",{message:d,level:p,levelKind:h,meta:f}),l()},c}(t.Transport);function n(){var a=t.config.npm.levels;arguments&&arguments[0]&&arguments[0].levels&&(a=arguments[0].levels);var c;for(var u in a)a.hasOwnProperty(u)&&(c=c===void 0||a[u]>a[c]?u:c);this.add(new r(t,{level:c}))}var o=t.createLogger;t.createLogger=function(){var c=t.config.npm.levels;arguments&&arguments[0]&&arguments[0].levels&&(c=arguments[0].levels);var u;for(var l in c)c.hasOwnProperty(l)&&(u=u===void 0||c[l]>c[u]?l:u);var d=o.apply(this,arguments);d.add(new r(t,{level:u}));var p=d.configure;return d.configure=function(){p.apply(this,arguments),n.apply(this,arguments)},d};var s=t.configure;return t.configure=function(){s.apply(this,arguments),n.apply(this,arguments)},t.add(new r(t)),t};La.winston3={versionSpecifier:"3.x",patch:BFe};La.winston2={versionSpecifier:"2.x",patch:UFe};function qFe(){BN.channel.registerMonkeyPatch("winston",La.winston2),BN.channel.registerMonkeyPatch("winston",La.winston3)}La.enable=qFe});var $le=L(Sn=>{"use strict";Object.defineProperty(Sn,"__esModule",{value:!0});Sn.enable=Sn.tedious=Sn.pgPool=Sn.pg=Sn.winston=Sn.redis=Sn.mysql=Sn.mongodb=Sn.mongodbCore=Sn.console=Sn.bunyan=Sn.azuresdk=void 0;var Ole=ble();Sn.azuresdk=Ole;var Mle=xle();Sn.bunyan=Mle;var Fle=Ile();Sn.console=Fle;var Ule=Cle();Sn.mongodbCore=Ule;var Ble=Tle();Sn.mongodb=Ble;var qle=wle();Sn.mysql=qle;var Hle=kle();Sn.pgPool=Hle;var jle=Ple();Sn.pg=jle;var zle=Dle();Sn.redis=zle;var Gle=Nle();Sn.tedious=Gle;var Vle=Lle();Sn.winston=Vle;function HFe(){Mle.enable(),Fle.enable(),Ule.enable(),Ble.enable(),qle.enable(),jle.enable(),Hle.enable(),zle.enable(),Vle.enable(),Ole.enable(),Gle.enable()}Sn.enable=HFe});var jN=L(dh=>{"use strict";Object.defineProperty(dh,"__esModule",{value:!0});dh.registerContextPreservation=dh.IsInitialized=void 0;var iH=Fn(),Kle=MD();dh.IsInitialized=!Kle.JsonConfig.getInstance().noDiagnosticChannel;var oH="DiagnosticChannel";if(dh.IsInitialized){tl=$le(),Wle=Kle.JsonConfig.getInstance().noPatchModules,qN=Wle.split(","),sH={bunyan:tl.bunyan,console:tl.console,mongodb:tl.mongodb,mongodbCore:tl.mongodbCore,mysql:tl.mysql,redis:tl.redis,pg:tl.pg,pgPool:tl.pgPool,winston:tl.winston,azuresdk:tl.azuresdk};for(HN in sH)qN.indexOf(HN)===-1&&(sH[HN].enable(),iH.info(oH,"Subscribed to "+HN+" events"));qN.length>0&&iH.info(oH,"Some modules will not be patched",qN)}else iH.info(oH,"Not subscribing to dependency autocollection because APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL was set");var tl,Wle,qN,sH,HN;function jFe(t){if(dh.IsInitialized){var e=_i();e.channel.addContextPreservation(t)}}dh.registerContextPreservation=jFe});var xx=L((iEt,Yle)=>{"use strict";Yle.exports={requestContextHeader:"request-context",requestContextSourceKey:"appId",requestContextTargetKey:"appId",requestIdHeader:"request-id",parentIdHeader:"x-ms-request-id",rootIdHeader:"x-ms-request-root-id",correlationContextHeader:"correlation-context",traceparentHeader:"traceparent",traceStateHeader:"tracestate"}});var as=L((uH,Qle)=>{"use strict";var fh=uH&&uH.__assign||function(){return fh=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},fh.apply(this,arguments)},zFe=require("http"),aH=require("https"),cH=require("url"),ph=require("constants"),z0=Fn(),Sx=xx(),GFe=MD(),VFe=function(){function t(){t._addCloseHandler()}return t.getCookie=function(e,r){var n="";if(e&&e.length&&typeof r=="string")for(var o=e+"=",s=r.split(";"),a=0;a<s.length;a++){var r=s[a];if(r=t.trim(r),r&&r.indexOf(o)===0){n=r.substring(o.length,s[a].length);break}}return n},t.trim=function(e){return typeof e=="string"?e.replace(/^\s+|\s+$/g,""):""},t.int32ArrayToBase64=function(e){var r=function(c,u){return String.fromCharCode(c>>u&255)},n=function(c){return r(c,24)+r(c,16)+r(c,8)+r(c,0)},o=e.map(n).join(""),s=Buffer.from?Buffer.from(o,"binary"):new Buffer(o,"binary"),a=s.toString("base64");return a.substr(0,a.indexOf("="))},t.random32=function(){return 4294967296*Math.random()|0},t.randomu32=function(){return t.random32()+2147483648},t.w3cTraceId=function(){for(var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],r="",n,o=0;o<4;o++)n=t.random32(),r+=e[n&15]+e[n>>4&15]+e[n>>8&15]+e[n>>12&15]+e[n>>16&15]+e[n>>20&15]+e[n>>24&15]+e[n>>28&15];var s=e[8+Math.random()*4|0];return r.substr(0,8)+r.substr(9,4)+"4"+r.substr(13,3)+s+r.substr(16,3)+r.substr(19,12)},t.w3cSpanId=function(){return t.w3cTraceId().substring(16)},t.isValidW3CId=function(e){return e.length===32&&e!=="00000000000000000000000000000000"},t.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"},t.isError=function(e){return Object.prototype.toString.call(e)==="[object Error]"},t.isPrimitive=function(e){var r=typeof e;return r==="string"||r==="number"||r==="boolean"},t.isDate=function(e){return Object.prototype.toString.call(e)==="[object Date]"},t.msToTimeSpan=function(e){(isNaN(e)||e<0)&&(e=0);var r=(e/1e3%60).toFixed(7).replace(/0{0,4}$/,""),n=""+Math.floor(e/(1e3*60))%60,o=""+Math.floor(e/(1e3*60*60))%24,s=Math.floor(e/(1e3*60*60*24));r=r.indexOf(".")<2?"0"+r:r,n=n.length<2?"0"+n:n,o=o.length<2?"0"+o:o;var a=s>0?s+".":"";return a+o+":"+n+":"+r},t.extractError=function(e){var r=e;return{message:e.message,code:r.code||r.id||""}},t.extractObject=function(e){return e instanceof Error?t.extractError(e):typeof e.toJSON=="function"?e.toJSON():e},t.validateStringMap=function(e){if(typeof e!="object"){z0.info("Invalid properties dropped from payload");return}var r={};for(var n in e){var o="",s=e[n],a=typeof s;if(t.isPrimitive(s))o=s.toString();else if(s===null||a==="undefined")o="";else if(a==="function"){z0.info("key: "+n+" was function; will not serialize");continue}else{var c=t.isArray(s)?s:t.extractObject(s);try{t.isPrimitive(c)?o=c:o=JSON.stringify(c)}catch(u){o=s.constructor.name.toString()+" (Error: "+u.message+")",z0.info("key: "+n+", could not be serialized")}}r[n]=o.substring(0,t.MAX_PROPERTY_LENGTH)}return r},t.canIncludeCorrelationHeader=function(e,r){var n=e&&e.config&&e.config.correlationHeaderExcludedDomains;if(!n||n.length==0||!r)return!0;for(var o=0;o<n.length;o++){var s=new RegExp(n[o].replace(/\./g,".").replace(/\*/g,".*"));try{if(s.test(new cH.URL(r).hostname))return!1}catch{}}return!0},t.getCorrelationContextTarget=function(e,r){var n=e.headers&&e.headers[Sx.requestContextHeader];if(n)for(var o=n.split(","),s=0;s<o.length;++s){var a=o[s].split("=");if(a.length==2&&a[0]==r)return a[1]}},t.makeRequest=function(e,r,n,o,s,a){s===void 0&&(s=!0),a===void 0&&(a=!0),r&&r.indexOf("//")===0&&(r="https:"+r);var c=new cH.URL(r),u=fh(fh({},n),{host:c.hostname,port:c.port,path:c.pathname}),l=void 0;if(s&&(c.protocol==="https:"&&(l=e.proxyHttpsUrl||void 0),c.protocol==="http:"&&(l=e.proxyHttpUrl||void 0),l)){l.indexOf("//")===0&&(l="http:"+l);try{var d=new cH.URL(l);d.protocol==="https:"?(z0.info("Proxies that use HTTPS are not supported"),l=void 0):u=fh(fh({},u),{host:d.hostname,port:d.port||"80",path:r,headers:fh(fh({},u.headers),{Host:c.hostname})})}catch{z0.warn("Wrong proxy URL provided")}}var p=c.protocol==="https:"&&!l;return a&&(p&&e.httpsAgent!==void 0?u.agent=e.httpsAgent:!p&&e.httpAgent!==void 0?u.agent=e.httpAgent:p&&(u.agent=t._useKeepAlive?t.keepAliveAgent:t.tlsRestrictedAgent)),p?aH.request(u,o):zFe.request(u,o)},t.safeIncludeCorrelationHeader=function(e,r,n){var o;if(typeof n=="string")o=n;else if(n instanceof Array)o=n.join(",");else if(n&&typeof n.toString=="function")try{o=n.toString()}catch(s){z0.warn("Outgoing request-context header could not be read. Correlation of requests may be lost.",s,n)}o?t.addCorrelationIdHeaderFromString(e,r,o):r.setHeader(Sx.requestContextHeader,Sx.requestContextSourceKey+"="+e.config.correlationId)},t.dumpObj=function(e){if(e)try{var r=Object.prototype.toString.call(e),n="";return r==="[object Error]"?n="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e.name+"'":n=this.stringify(e),r+n}catch{return e.toString()}},t.stringify=function(e){try{return JSON.stringify(e)}catch(r){z0.warn("Failed to serialize payload",r,e)}},t.addCorrelationIdHeaderFromString=function(e,r,n){var o=n.split(","),s=Sx.requestContextSourceKey+"=",a=o.some(function(c){return c.substring(0,s.length)===s});a||r.setHeader(Sx.requestContextHeader,n+","+Sx.requestContextSourceKey+"="+e.config.correlationId)},t._addCloseHandler=function(){t._listenerAttached||(process.on("exit",function(){t.isNodeExit=!0,t._useKeepAlive=!1}),t._listenerAttached=!0)},t._useKeepAlive=!GFe.JsonConfig.getInstance().noHttpAgentKeepAlive,t._listenerAttached=!1,t.MAX_PROPERTY_LENGTH=8192,t.keepAliveAgent=new aH.Agent({keepAlive:!0,maxSockets:25,secureOptions:ph.SSL_OP_NO_SSLv2|ph.SSL_OP_NO_SSLv3|ph.SSL_OP_NO_TLSv1|ph.SSL_OP_NO_TLSv1_1}),t.tlsRestrictedAgent=new aH.Agent({secureOptions:ph.SSL_OP_NO_SSLv2|ph.SSL_OP_NO_SSLv3|ph.SSL_OP_NO_TLSv1|ph.SSL_OP_NO_TLSv1_1}),t.isNodeExit=!1,t}();Qle.exports=VFe});var G0=L((oEt,Xle)=>{"use strict";var lH=as(),$Fe=function(){function t(){}return t.queryCorrelationId=function(e,r){},t.cancelCorrelationIdQuery=function(e,r){},t.generateRequestId=function(e){if(e){e=e[0]=="|"?e:"|"+e,e[e.length-1]!=="."&&(e+=".");var r=(t.currentRootId++).toString(16);return t.appendSuffix(e,r,"_")}else return t.generateRootId()},t.getRootId=function(e){var r=e.indexOf(".");r<0&&(r=e.length);var n=e[0]==="|"?1:0;return e.substring(n,r)},t.generateRootId=function(){return"|"+lH.w3cTraceId()+"."},t.appendSuffix=function(e,r,n){if(e.length+r.length<t.requestIdMaxLength)return e+r+n;var o=t.requestIdMaxLength-9;if(e.length>o)for(;o>1;--o){var s=e[o-1];if(s==="."||s==="_")break}if(o<=1)return t.generateRootId();for(r=lH.randomu32().toString(16);r.length<8;)r="0"+r;return e.substring(0,o)+r+"#"},t.correlationIdPrefix="cid-v1:",t.w3cEnabled=!0,t.HTTP_TIMEOUT=2500,t.requestIdMaxLength=1024,t.currentRootId=lH.randomu32(),t}();Xle.exports=$Fe});var zN=L((sEt,Jle)=>{"use strict";var cs=as(),WFe=G0(),KFe=function(){function t(e,r){if(this.traceFlag=t.DEFAULT_TRACE_FLAG,this.version=t.DEFAULT_VERSION,e&&typeof e=="string")if(e.split(",").length>1)this.traceId=cs.w3cTraceId(),this.spanId=cs.w3cTraceId().substr(0,16);else{var n=e.trim().split("-"),o=n.length;o>=4?(this.version=n[0],this.traceId=n[1],this.spanId=n[2],this.traceFlag=n[3]):(this.traceId=cs.w3cTraceId(),this.spanId=cs.w3cTraceId().substr(0,16)),this.version.match(/^[0-9a-f]{2}$/g)||(this.version=t.DEFAULT_VERSION,this.traceId=cs.w3cTraceId()),this.version==="00"&&o!==4&&(this.traceId=cs.w3cTraceId(),this.spanId=cs.w3cTraceId().substr(0,16)),this.version==="ff"&&(this.version=t.DEFAULT_VERSION,this.traceId=cs.w3cTraceId(),this.spanId=cs.w3cTraceId().substr(0,16)),this.version.match(/^0[0-9a-f]$/g)||(this.version=t.DEFAULT_VERSION),this.traceFlag.match(/^[0-9a-f]{2}$/g)||(this.traceFlag=t.DEFAULT_TRACE_FLAG,this.traceId=cs.w3cTraceId()),t.isValidTraceId(this.traceId)||(this.traceId=cs.w3cTraceId()),t.isValidSpanId(this.spanId)||(this.spanId=cs.w3cTraceId().substr(0,16),this.traceId=cs.w3cTraceId()),this.parentId=this.getBackCompatRequestId()}else if(r){this.parentId=r.slice();var s=WFe.getRootId(r);t.isValidTraceId(s)||(this.legacyRootId=s,s=cs.w3cTraceId()),r.indexOf("|")!==-1&&(r=r.substring(1+r.substring(0,r.length-1).lastIndexOf("."),r.length-1)),this.traceId=s,this.spanId=r}else this.traceId=cs.w3cTraceId(),this.spanId=cs.w3cTraceId().substr(0,16)}return t.isValidTraceId=function(e){return e.match(/^[0-9a-f]{32}$/)&&e!=="00000000000000000000000000000000"},t.isValidSpanId=function(e){return e.match(/^[0-9a-f]{16}$/)&&e!=="0000000000000000"},t.formatOpenTelemetryTraceFlags=function(e){var r="0"+e.toString(16);return r.substring(r.length-2)},t.prototype.getBackCompatRequestId=function(){return"|"+this.traceId+"."+this.spanId+"."},t.prototype.toString=function(){return this.version+"-"+this.traceId+"-"+this.spanId+"-"+this.traceFlag},t.prototype.updateSpanId=function(){this.spanId=cs.w3cTraceId().substr(0,16)},t.DEFAULT_TRACE_FLAG="01",t.DEFAULT_VERSION="00",t}();Jle.exports=KFe});var dH=L((aEt,Zle)=>{"use strict";var YFe=function(){function t(e){this.fieldmap=[],e&&(this.fieldmap=this.parseHeader(e))}return t.prototype.toString=function(){var e=this.fieldmap;return!e||e.length==0?null:e.join(", ")},t.validateKeyChars=function(e){var r=e.split("@");if(r.length==2){var n=r[0].trim(),o=r[1].trim(),s=!!n.match(/^[\ ]?[a-z0-9\*\-\_/]{1,241}$/),a=!!o.match(/^[\ ]?[a-z0-9\*\-\_/]{1,14}$/);return s&&a}else if(r.length==1)return!!e.match(/^[\ ]?[a-z0-9\*\-\_/]{1,256}$/);return!1},t.prototype.parseHeader=function(e){var r=[],n={},o=e.split(",");if(o.length>32)return null;for(var s=0,a=o;s<a.length;s++){var c=a[s],u=c.trim();if(u.length!==0){var l=u.split("=");if(l.length!==2||!t.validateKeyChars(l[0])||n[l[0]])return null;n[l[0]]=!0,r.push(u)}}return r},t.strict=!0,t}();Zle.exports=YFe});var Jp=L((cEt,ede)=>{"use strict";var QFe=function(){function t(){}return t}();ede.exports=QFe});var rde=L((pH,tde)=>{"use strict";var XFe=pH&&pH.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),JFe=Jp(),ZFe=function(t){XFe(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return e}(JFe);tde.exports=ZFe});var fH=L((uEt,nde)=>{"use strict";var e9e=function(){function t(){}return t}();nde.exports=e9e});var ode=L((lEt,ide)=>{"use strict";var t9e=function(){function t(){this.applicationVersion="ai.application.ver",this.deviceId="ai.device.id",this.deviceLocale="ai.device.locale",this.deviceModel="ai.device.model",this.deviceOEMName="ai.device.oemName",this.deviceOSVersion="ai.device.osVersion",this.deviceType="ai.device.type",this.locationIp="ai.location.ip",this.operationId="ai.operation.id",this.operationName="ai.operation.name",this.operationParentId="ai.operation.parentId",this.operationSyntheticSource="ai.operation.syntheticSource",this.operationCorrelationVector="ai.operation.correlationVector",this.sessionId="ai.session.id",this.sessionIsFirst="ai.session.isFirst",this.userAccountId="ai.user.accountId",this.userId="ai.user.id",this.userAuthUserId="ai.user.authUserId",this.cloudRole="ai.cloud.role",this.cloudRoleInstance="ai.cloud.roleInstance",this.internalSdkVersion="ai.internal.sdkVersion",this.internalAgentVersion="ai.internal.agentVersion",this.internalNodeName="ai.internal.nodeName"}return t}();ide.exports=t9e});var ade=L((mH,sde)=>{"use strict";var r9e=mH&&mH.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),n9e=fH(),i9e=function(t){r9e(e,t);function e(){return t.call(this)||this}return e}(n9e);sde.exports=i9e});var gH=L((dEt,cde)=>{"use strict";var hH;(function(t){t[t.Measurement=0]="Measurement",t[t.Aggregation=1]="Aggregation"})(hH||(hH={}));cde.exports=hH});var lde=L((pEt,ude)=>{"use strict";var o9e=gH(),s9e=function(){function t(){this.kind=o9e.Measurement}return t}();ude.exports=s9e});var pde=L((fEt,dde)=>{"use strict";var a9e=function(){function t(){this.ver=1,this.sampleRate=100,this.tags={}}return t}();dde.exports=a9e});var yH=L((vH,fde)=>{"use strict";var c9e=vH&&vH.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),u9e=Jp(),l9e=function(t){c9e(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return e}(u9e);fde.exports=l9e});var hde=L((bH,mde)=>{"use strict";var d9e=bH&&bH.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),p9e=Jp(),f9e=function(t){d9e(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.exceptions=[],r.properties={},r.measurements={},r}return e}(p9e);mde.exports=f9e});var vde=L((mEt,gde)=>{"use strict";var m9e=function(){function t(){this.hasFullStack=!0,this.parsedStack=[]}return t}();gde.exports=m9e});var bde=L((_H,yde)=>{"use strict";var h9e=_H&&_H.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),g9e=Jp(),v9e=function(t){h9e(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.properties={},r}return e}(g9e);yde.exports=v9e});var xde=L((xH,_de)=>{"use strict";var y9e=xH&&xH.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),b9e=Jp(),_9e=function(t){y9e(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.metrics=[],r.properties={},r}return e}(b9e);_de.exports=_9e});var Ide=L((SH,Sde)=>{"use strict";var x9e=SH&&SH.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),S9e=yH(),I9e=function(t){x9e(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return e}(S9e);Sde.exports=I9e});var Tde=L((IH,Cde)=>{"use strict";var C9e=IH&&IH.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),T9e=Jp(),E9e=function(t){C9e(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.success=!0,r.properties={},r.measurements={},r}return e}(T9e);Cde.exports=E9e});var wde=L((CH,Ede)=>{"use strict";var w9e=CH&&CH.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),R9e=Jp(),k9e=function(t){w9e(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return e}(R9e);Ede.exports=k9e});var kde=L((hEt,Rde)=>{"use strict";var TH;(function(t){t[t.Verbose=0]="Verbose",t[t.Information=1]="Information",t[t.Warning=2]="Warning",t[t.Error=3]="Error",t[t.Critical=4]="Critical"})(TH||(TH={}));Rde.exports=TH});var Pde=L((gEt,Ade)=>{"use strict";var A9e=function(){function t(){}return t}();Ade.exports=A9e});var EH=L(eo=>{"use strict";Object.defineProperty(eo,"__esModule",{value:!0});eo.AvailabilityData=rde();eo.Base=fH();eo.ContextTagKeys=ode();eo.Data=ade();eo.DataPoint=lde();eo.DataPointType=gH();eo.Domain=Jp();eo.Envelope=pde();eo.EventData=yH();eo.ExceptionData=hde();eo.ExceptionDetails=vde();eo.MessageData=bde();eo.MetricData=xde();eo.PageViewData=Ide();eo.RemoteDependencyData=Tde();eo.RequestData=wde();eo.SeverityLevel=kde();eo.StackFrame=Pde()});var Dde=L(Ix=>{"use strict";Object.defineProperty(Ix,"__esModule",{value:!0});Ix.domainSupportsProperties=Ix.RemoteDependencyDataConstants=void 0;var V0=EH(),P9e=function(){function t(){}return t.TYPE_HTTP="Http",t.TYPE_AI="Http (tracked component)",t}();Ix.RemoteDependencyDataConstants=P9e;function D9e(t){return"properties"in t||t instanceof V0.EventData||t instanceof V0.ExceptionData||t instanceof V0.MessageData||t instanceof V0.MetricData||t instanceof V0.PageViewData||t instanceof V0.RemoteDependencyData||t instanceof V0.RequestData}Ix.domainSupportsProperties=D9e});var Lde=L(Nde=>{"use strict";Object.defineProperty(Nde,"__esModule",{value:!0})});var Mde=L(Ode=>{"use strict";Object.defineProperty(Ode,"__esModule",{value:!0})});var Ude=L(Fde=>{"use strict";Object.defineProperty(Fde,"__esModule",{value:!0})});var qde=L(Bde=>{"use strict";Object.defineProperty(Bde,"__esModule",{value:!0})});var jde=L(Hde=>{"use strict";Object.defineProperty(Hde,"__esModule",{value:!0})});var Gde=L(zde=>{"use strict";Object.defineProperty(zde,"__esModule",{value:!0})});var $de=L(Vde=>{"use strict";Object.defineProperty(Vde,"__esModule",{value:!0})});var Kde=L(Wde=>{"use strict";Object.defineProperty(Wde,"__esModule",{value:!0})});var Qde=L(Yde=>{"use strict";Object.defineProperty(Yde,"__esModule",{value:!0})});var Jde=L(Xde=>{"use strict";Object.defineProperty(Xde,"__esModule",{value:!0})});var epe=L(Zde=>{"use strict";Object.defineProperty(Zde,"__esModule",{value:!0})});var rpe=L(tpe=>{"use strict";Object.defineProperty(tpe,"__esModule",{value:!0})});var npe=L(rl=>{"use strict";Object.defineProperty(rl,"__esModule",{value:!0});rl.TelemetryType=rl.TelemetryTypeString=rl.baseTypeToTelemetryType=rl.telemetryTypeToBaseType=void 0;function N9e(t){switch(t){case us.Event:return"EventData";case us.Exception:return"ExceptionData";case us.Trace:return"MessageData";case us.Metric:return"MetricData";case us.Request:return"RequestData";case us.Dependency:return"RemoteDependencyData";case us.Availability:return"AvailabilityData";case us.PageView:return"PageViewData"}}rl.telemetryTypeToBaseType=N9e;function L9e(t){switch(t){case"EventData":return us.Event;case"ExceptionData":return us.Exception;case"MessageData":return us.Trace;case"MetricData":return us.Metric;case"RequestData":return us.Request;case"RemoteDependencyData":return us.Dependency;case"AvailabilityData":return us.Availability;case"PageViewData":return us.PageView}}rl.baseTypeToTelemetryType=L9e;rl.TelemetryTypeString={Event:"EventData",Exception:"ExceptionData",Trace:"MessageData",Metric:"MetricData",Request:"RequestData",Dependency:"RemoteDependencyData",Availability:"AvailabilityData",PageView:"PageViewData"};var us;(function(t){t[t.Event=0]="Event",t[t.Exception=1]="Exception",t[t.Trace=2]="Trace",t[t.Metric=3]="Metric",t[t.Request=4]="Request",t[t.Dependency=5]="Dependency",t[t.Availability=6]="Availability",t[t.PageView=7]="PageView"})(us=rl.TelemetryType||(rl.TelemetryType={}))});var ipe=L(yo=>{"use strict";var O9e=yo&&yo.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),mc=yo&&yo.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&O9e(e,t,r)};Object.defineProperty(yo,"__esModule",{value:!0});mc(Lde(),yo);mc(Mde(),yo);mc(Ude(),yo);mc(qde(),yo);mc(jde(),yo);mc(Gde(),yo);mc($de(),yo);mc(Kde(),yo);mc(Qde(),yo);mc(Jde(),yo);mc(epe(),yo);mc(rpe(),yo);mc(npe(),yo)});var spe=L(ope=>{"use strict";Object.defineProperty(ope,"__esModule",{value:!0})});var cpe=L(ape=>{"use strict";Object.defineProperty(ape,"__esModule",{value:!0})});var lpe=L(upe=>{"use strict";Object.defineProperty(upe,"__esModule",{value:!0})});var ppe=L(dpe=>{"use strict";Object.defineProperty(dpe,"__esModule",{value:!0})});var mpe=L(fpe=>{"use strict";Object.defineProperty(fpe,"__esModule",{value:!0})});var gpe=L(hpe=>{"use strict";Object.defineProperty(hpe,"__esModule",{value:!0})});var ype=L(vpe=>{"use strict";Object.defineProperty(vpe,"__esModule",{value:!0})});var _pe=L(bpe=>{"use strict";Object.defineProperty(bpe,"__esModule",{value:!0})});var xpe=L(Oa=>{"use strict";var M9e=Oa&&Oa.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),mh=Oa&&Oa.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&M9e(e,t,r)};Object.defineProperty(Oa,"__esModule",{value:!0});mh(spe(),Oa);mh(cpe(),Oa);mh(lpe(),Oa);mh(ppe(),Oa);mh(mpe(),Oa);mh(gpe(),Oa);mh(ype(),Oa);mh(_pe(),Oa)});var Os=L(ad=>{"use strict";var F9e=ad&&ad.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),GN=ad&&ad.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&F9e(e,t,r)};Object.defineProperty(ad,"__esModule",{value:!0});GN(Dde(),ad);GN(EH(),ad);GN(ipe(),ad);GN(xpe(),ad)});var wH=L((zEt,Spe)=>{"use strict";var U9e=function(){function t(){}return t.prototype.getUrl=function(){return this.url},t.prototype.RequestParser=function(){this.startTime=+new Date},t.prototype._setStatus=function(e,r){var n=+new Date;this.duration=n-this.startTime,this.statusCode=e;var o=this.properties||{};if(r){if(typeof r=="string")o.error=r;else if(r instanceof Error)o.error=r.message;else if(typeof r=="object")for(var s in r)o[s]=r[s]&&r[s].toString&&r[s].toString()}this.properties=o},t.prototype._isSuccess=function(){return 0<this.statusCode&&this.statusCode<400},t}();Spe.exports=U9e});var ni=L(Be=>{"use strict";var nl;Object.defineProperty(Be,"__esModule",{value:!0});Be.WEB_INSTRUMENTATION_DEPRECATED_SOURCE=Be.WEB_INSTRUMENTATION_DEFAULT_SOURCE=Be.TIME_SINCE_ENQUEUED=Be.ENQUEUED_TIME=Be.MessageBusDestination=Be.MicrosoftEventHub=Be.AzNamespace=Be.HttpRequestCookieNames=Be.StatsbeatNetworkCategory=Be.StatsbeatFeatureType=Be.StatsbeatInstrumentation=Be.StatsbeatFeature=Be.StatsbeatCounter=Be.StatsbeatAttach=Be.StatsbeatResourceProvider=Be.StatsbeatTelemetryName=Be.HeartBeatMetricName=Be.DependencyTypeName=Be.TelemetryTypeStringToQuickPulseDocumentType=Be.TelemetryTypeStringToQuickPulseType=Be.QuickPulseType=Be.QuickPulseDocumentType=Be.PerformanceToQuickPulseCounter=Be.MetricId=Be.PerformanceCounter=Be.QuickPulseCounter=Be.DEFAULT_LIVEMETRICS_HOST=Be.DEFAULT_LIVEMETRICS_ENDPOINT=Be.DEFAULT_BREEZE_ENDPOINT=Be.APPLICATION_INSIGHTS_SDK_VERSION=void 0;Be.APPLICATION_INSIGHTS_SDK_VERSION="2.9.1";Be.DEFAULT_BREEZE_ENDPOINT="https://dc.services.visualstudio.com";Be.DEFAULT_LIVEMETRICS_ENDPOINT="https://rt.services.visualstudio.com";Be.DEFAULT_LIVEMETRICS_HOST="rt.services.visualstudio.com";var Ms;(function(t){t.COMMITTED_BYTES="\\Memory\\Committed Bytes",t.PROCESSOR_TIME="\\Processor(_Total)\\% Processor Time",t.REQUEST_RATE="\\ApplicationInsights\\Requests/Sec",t.REQUEST_FAILURE_RATE="\\ApplicationInsights\\Requests Failed/Sec",t.REQUEST_DURATION="\\ApplicationInsights\\Request Duration",t.DEPENDENCY_RATE="\\ApplicationInsights\\Dependency Calls/Sec",t.DEPENDENCY_FAILURE_RATE="\\ApplicationInsights\\Dependency Calls Failed/Sec",t.DEPENDENCY_DURATION="\\ApplicationInsights\\Dependency Call Duration",t.EXCEPTION_RATE="\\ApplicationInsights\\Exceptions/Sec"})(Ms=Be.QuickPulseCounter||(Be.QuickPulseCounter={}));var VN;(function(t){t.PRIVATE_BYTES="\\Process(??APP_WIN32_PROC??)\\Private Bytes",t.AVAILABLE_BYTES="\\Memory\\Available Bytes",t.PROCESSOR_TIME="\\Processor(_Total)\\% Processor Time",t.PROCESS_TIME="\\Process(??APP_WIN32_PROC??)\\% Processor Time",t.REQUEST_RATE="\\ASP.NET Applications(??APP_W3SVC_PROC??)\\Requests/Sec",t.REQUEST_DURATION="\\ASP.NET Applications(??APP_W3SVC_PROC??)\\Request Execution Time"})(VN=Be.PerformanceCounter||(Be.PerformanceCounter={}));var B9e;(function(t){t.REQUESTS_DURATION="requests/duration",t.DEPENDENCIES_DURATION="dependencies/duration",t.EXCEPTIONS_COUNT="exceptions/count",t.TRACES_COUNT="traces/count"})(B9e=Be.MetricId||(Be.MetricId={}));Be.PerformanceToQuickPulseCounter=(nl={},nl[VN.PROCESSOR_TIME]=Ms.PROCESSOR_TIME,nl[VN.REQUEST_RATE]=Ms.REQUEST_RATE,nl[VN.REQUEST_DURATION]=Ms.REQUEST_DURATION,nl[Ms.COMMITTED_BYTES]=Ms.COMMITTED_BYTES,nl[Ms.REQUEST_FAILURE_RATE]=Ms.REQUEST_FAILURE_RATE,nl[Ms.DEPENDENCY_RATE]=Ms.DEPENDENCY_RATE,nl[Ms.DEPENDENCY_FAILURE_RATE]=Ms.DEPENDENCY_FAILURE_RATE,nl[Ms.DEPENDENCY_DURATION]=Ms.DEPENDENCY_DURATION,nl[Ms.EXCEPTION_RATE]=Ms.EXCEPTION_RATE,nl);Be.QuickPulseDocumentType={Event:"Event",Exception:"Exception",Trace:"Trace",Metric:"Metric",Request:"Request",Dependency:"RemoteDependency",Availability:"Availability",PageView:"PageView"};Be.QuickPulseType={Event:"EventTelemetryDocument",Exception:"ExceptionTelemetryDocument",Trace:"TraceTelemetryDocument",Metric:"MetricTelemetryDocument",Request:"RequestTelemetryDocument",Dependency:"DependencyTelemetryDocument",Availability:"AvailabilityTelemetryDocument",PageView:"PageViewTelemetryDocument"};Be.TelemetryTypeStringToQuickPulseType={EventData:Be.QuickPulseType.Event,ExceptionData:Be.QuickPulseType.Exception,MessageData:Be.QuickPulseType.Trace,MetricData:Be.QuickPulseType.Metric,RequestData:Be.QuickPulseType.Request,RemoteDependencyData:Be.QuickPulseType.Dependency,AvailabilityData:Be.QuickPulseType.Availability,PageViewData:Be.QuickPulseType.PageView};Be.TelemetryTypeStringToQuickPulseDocumentType={EventData:Be.QuickPulseDocumentType.Event,ExceptionData:Be.QuickPulseDocumentType.Exception,MessageData:Be.QuickPulseDocumentType.Trace,MetricData:Be.QuickPulseDocumentType.Metric,RequestData:Be.QuickPulseDocumentType.Request,RemoteDependencyData:Be.QuickPulseDocumentType.Dependency,AvailabilityData:Be.QuickPulseDocumentType.Availability,PageViewData:Be.QuickPulseDocumentType.PageView};Be.DependencyTypeName={Grpc:"GRPC",Http:"HTTP",InProc:"InProc",Sql:"SQL",QueueMessage:"Queue Message"};Be.HeartBeatMetricName="HeartbeatState";Be.StatsbeatTelemetryName="Statsbeat";Be.StatsbeatResourceProvider={appsvc:"appsvc",aks:"aks",functions:"functions",vm:"vm",unknown:"unknown"};Be.StatsbeatAttach={codeless:"codeless",sdk:"sdk"};Be.StatsbeatCounter={REQUEST_SUCCESS:"Request Success Count",REQUEST_FAILURE:"Request Failure Count",REQUEST_DURATION:"Request Duration",RETRY_COUNT:"Retry Count",THROTTLE_COUNT:"Throttle Count",EXCEPTION_COUNT:"Exception Count",ATTACH:"Attach",FEATURE:"Feature"};var q9e;(function(t){t[t.NONE=0]="NONE",t[t.DISK_RETRY=1]="DISK_RETRY",t[t.AAD_HANDLING=2]="AAD_HANDLING",t[t.WEB_SNIPPET=4]="WEB_SNIPPET"})(q9e=Be.StatsbeatFeature||(Be.StatsbeatFeature={}));var H9e;(function(t){t[t.NONE=0]="NONE",t[t.AZURE_CORE_TRACING=1]="AZURE_CORE_TRACING",t[t.MONGODB=2]="MONGODB",t[t.MYSQL=4]="MYSQL",t[t.REDIS=8]="REDIS",t[t.POSTGRES=16]="POSTGRES",t[t.BUNYAN=32]="BUNYAN",t[t.WINSTON=64]="WINSTON",t[t.CONSOLE=128]="CONSOLE"})(H9e=Be.StatsbeatInstrumentation||(Be.StatsbeatInstrumentation={}));var j9e;(function(t){t[t.Feature=0]="Feature",t[t.Instrumentation=1]="Instrumentation"})(j9e=Be.StatsbeatFeatureType||(Be.StatsbeatFeatureType={}));var z9e;(function(t){t[t.Breeze=0]="Breeze",t[t.Quickpulse=1]="Quickpulse"})(z9e=Be.StatsbeatNetworkCategory||(Be.StatsbeatNetworkCategory={}));var G9e;(function(t){t.SESSION="ai_session",t.USER="ai_user",t.AUTH_USER="ai_authUser"})(G9e=Be.HttpRequestCookieNames||(Be.HttpRequestCookieNames={}));Be.AzNamespace="az.namespace";Be.MicrosoftEventHub="Microsoft.EventHub";Be.MessageBusDestination="message_bus.destination";Be.ENQUEUED_TIME="enqueuedTime";Be.TIME_SINCE_ENQUEUED="timeSinceEnqueued";Be.WEB_INSTRUMENTATION_DEFAULT_SOURCE="https://js.monitor.azure.com/scripts/b/ai";Be.WEB_INSTRUMENTATION_DEPRECATED_SOURCE="https://az416426.vo.msecnd.net/scripts/b/ai"});var PH=L((AH,Ipe)=>{"use strict";var V9e=AH&&AH.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),$N=require("url"),$9e=Os(),RH=as(),hc=xx(),W9e=wH(),hh=G0(),K9e=dH(),kH=zN(),Y9e=Fn(),WN=ni(),Q9e=function(t){V9e(e,t);function e(r,n){var o=t.call(this)||this;return r&&(o.method=r.method,o.url=o._getAbsoluteUrl(r),o.startTime=+new Date,o.socketRemoteAddress=r.socket&&r.socket.remoteAddress,o.parseHeaders(r,n),r.connection&&(o.connectionRemoteAddress=r.connection.remoteAddress,o.legacySocketRemoteAddress=r.connection.socket&&r.connection.socket.remoteAddress)),o}return e.prototype.onError=function(r,n){this._setStatus(void 0,r),n&&(this.duration=n)},e.prototype.onResponse=function(r,n){this._setStatus(r.statusCode,void 0),n&&(this.duration=n)},e.prototype.getRequestTelemetry=function(r){var n=this.method;try{n+=" "+new $N.URL(this.url).pathname}catch{}var o={id:this.requestId,name:n,url:this.url,source:this.sourceCorrelationId,duration:this.duration,resultCode:this.statusCode?this.statusCode.toString():null,success:this._isSuccess(),properties:this.properties};if(r&&r.time?o.time=r.time:this.startTime&&(o.time=new Date(this.startTime)),r){for(var s in r)o[s]||(o[s]=r[s]);if(r.properties)for(var s in r.properties)o.properties[s]=r.properties[s]}return o},e.prototype.getRequestTags=function(r){var n={};for(var o in r)n[o]=r[o];return n[e.keys.locationIp]=r[e.keys.locationIp]||this._getIp(),n[e.keys.sessionId]=r[e.keys.sessionId]||this._getId(WN.HttpRequestCookieNames.SESSION),n[e.keys.userId]=r[e.keys.userId]||this._getId(WN.HttpRequestCookieNames.USER),n[e.keys.userAuthUserId]=r[e.keys.userAuthUserId]||this._getId(WN.HttpRequestCookieNames.AUTH_USER),n[e.keys.operationName]=this.getOperationName(r),n[e.keys.operationParentId]=this.getOperationParentId(r),n[e.keys.operationId]=this.getOperationId(r),n},e.prototype.getOperationId=function(r){return r[e.keys.operationId]||this.operationId},e.prototype.getOperationParentId=function(r){return r[e.keys.operationParentId]||this.parentId||this.getOperationId(r)},e.prototype.getOperationName=function(r){if(r[e.keys.operationName])return r[e.keys.operationName];var n="";try{n=new $N.URL(this.url).pathname}catch{}var o=this.method;return n&&(o+=" "+n),o},e.prototype.getRequestId=function(){return this.requestId},e.prototype.getCorrelationContextHeader=function(){return this.correlationContextHeader},e.prototype.getTraceparent=function(){return this.traceparent},e.prototype.getTracestate=function(){return this.tracestate},e.prototype.getLegacyRootId=function(){return this.legacyRootId},e.prototype._getAbsoluteUrl=function(r){if(!r.headers)return r.url;var n=r.connection?r.connection.encrypted:null,o=n||r.headers["x-forwarded-proto"]=="https"?"https":"http",s=o+"://"+r.headers.host+"/",a="",c="";try{var u=new $N.URL(r.url,s);a=u.pathname,c=u.search}catch{}var l=$N.format({protocol:o,host:r.headers.host,pathname:a,search:c});return l},e.prototype._getIp=function(){var r=/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/,n=function(s){var a=r.exec(s);if(a)return a[0]},o=n(this.rawHeaders["x-forwarded-for"])||n(this.rawHeaders["x-client-ip"])||n(this.rawHeaders["x-real-ip"])||n(this.connectionRemoteAddress)||n(this.socketRemoteAddress)||n(this.legacySocketRemoteAddress);return!o&&this.connectionRemoteAddress&&this.connectionRemoteAddress.substr&&this.connectionRemoteAddress.substr(0,2)==="::"&&(o="127.0.0.1"),o},e.prototype._getId=function(r){var n=this.rawHeaders&&this.rawHeaders.cookie&&typeof this.rawHeaders.cookie=="string"&&this.rawHeaders.cookie||"";if(r===WN.HttpRequestCookieNames.AUTH_USER)try{n=decodeURI(n)}catch(s){n="",Y9e.warn("Could not decode the auth cookie with error: ",RH.dumpObj(s))}var o=e.parseId(RH.getCookie(r,n));return o},e.prototype.setBackCompatFromThisTraceContext=function(){this.operationId=this.traceparent.traceId,this.traceparent.legacyRootId&&(this.legacyRootId=this.traceparent.legacyRootId),this.parentId=this.traceparent.parentId,this.traceparent.updateSpanId(),this.requestId=this.traceparent.getBackCompatRequestId()},e.prototype.parseHeaders=function(r,n){if(this.rawHeaders=r.headers||r.rawHeaders,this.userAgent=r.headers&&r.headers["user-agent"],this.sourceCorrelationId=RH.getCorrelationContextTarget(r,hc.requestContextSourceKey),r.headers){var o=r.headers[hc.traceStateHeader]?r.headers[hc.traceStateHeader].toString():null,s=r.headers[hc.traceparentHeader]?r.headers[hc.traceparentHeader].toString():null,a=r.headers[hc.requestIdHeader]?r.headers[hc.requestIdHeader].toString():null,c=r.headers[hc.parentIdHeader]?r.headers[hc.parentIdHeader].toString():null,u=r.headers[hc.rootIdHeader]?r.headers[hc.rootIdHeader].toString():null;this.correlationContextHeader=r.headers[hc.correlationContextHeader]?r.headers[hc.correlationContextHeader].toString():null,hh.w3cEnabled&&(s||o)?(this.traceparent=new kH(s?s.toString():null),this.tracestate=s&&o&&new K9e(o?o.toString():null),this.setBackCompatFromThisTraceContext()):a?hh.w3cEnabled?(this.traceparent=new kH(null,a),this.setBackCompatFromThisTraceContext()):(this.parentId=a,this.requestId=hh.generateRequestId(this.parentId),this.operationId=hh.getRootId(this.requestId)):hh.w3cEnabled?(this.traceparent=new kH,this.traceparent.parentId=c,this.traceparent.legacyRootId=u||c,this.setBackCompatFromThisTraceContext()):(this.parentId=c,this.requestId=hh.generateRequestId(u||this.parentId),this.correlationContextHeader=null,this.operationId=hh.getRootId(this.requestId)),n&&(this.requestId=n,this.operationId=hh.getRootId(this.requestId))}},e.parseId=function(r){var n=r.split("|");return n.length>0?n[0]:""},e.keys=new $9e.ContextTagKeys,e}(W9e);Ipe.exports=Q9e});var qpe=L((Ft,Bpe)=>{Ft=Bpe.exports=Sr;var sn;typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?sn=function(){var t=Array.prototype.slice.call(arguments,0);t.unshift("SEMVER"),console.log.apply(console,t)}:sn=function(){};Ft.SEMVER_SPEC_VERSION="2.0.0";var mw=256,KN=Number.MAX_SAFE_INTEGER||9007199254740991,DH=16,X9e=mw-6,hw=Ft.re=[],In=Ft.safeRe=[],we=Ft.src=[],vr=0,FH="[a-zA-Z0-9-]",NH=[["\\s",1],["\\d",mw],[FH,X9e]];function eL(t){for(var e=0;e<NH.length;e++){var r=NH[e][0],n=NH[e][1];t=t.split(r+"*").join(r+"{0,"+n+"}").split(r+"+").join(r+"{1,"+n+"}")}return t}var Cx=vr++;we[Cx]="0|[1-9]\\d*";var Tx=vr++;we[Tx]="\\d+";var UH=vr++;we[UH]="\\d*[a-zA-Z-]"+FH+"*";var Tpe=vr++;we[Tpe]="("+we[Cx]+")\\.("+we[Cx]+")\\.("+we[Cx]+")";var Epe=vr++;we[Epe]="("+we[Tx]+")\\.("+we[Tx]+")\\.("+we[Tx]+")";var LH=vr++;we[LH]="(?:"+we[Cx]+"|"+we[UH]+")";var OH=vr++;we[OH]="(?:"+we[Tx]+"|"+we[UH]+")";var BH=vr++;we[BH]="(?:-("+we[LH]+"(?:\\."+we[LH]+")*))";var qH=vr++;we[qH]="(?:-?("+we[OH]+"(?:\\."+we[OH]+")*))";var MH=vr++;we[MH]=FH+"+";var vw=vr++;we[vw]="(?:\\+("+we[MH]+"(?:\\."+we[MH]+")*))";var HH=vr++,wpe="v?"+we[Tpe]+we[BH]+"?"+we[vw]+"?";we[HH]="^"+wpe+"$";var jH="[v=\\s]*"+we[Epe]+we[qH]+"?"+we[vw]+"?",zH=vr++;we[zH]="^"+jH+"$";var Ax=vr++;we[Ax]="((?:<|>)?=?)";var YN=vr++;we[YN]=we[Tx]+"|x|X|\\*";var QN=vr++;we[QN]=we[Cx]+"|x|X|\\*";var $0=vr++;we[$0]="[v=\\s]*("+we[QN]+")(?:\\.("+we[QN]+")(?:\\.("+we[QN]+")(?:"+we[BH]+")?"+we[vw]+"?)?)?";var wx=vr++;we[wx]="[v=\\s]*("+we[YN]+")(?:\\.("+we[YN]+")(?:\\.("+we[YN]+")(?:"+we[qH]+")?"+we[vw]+"?)?)?";var Rpe=vr++;we[Rpe]="^"+we[Ax]+"\\s*"+we[$0]+"$";var kpe=vr++;we[kpe]="^"+we[Ax]+"\\s*"+we[wx]+"$";var Ape=vr++;we[Ape]="(?:^|[^\\d])(\\d{1,"+DH+"})(?:\\.(\\d{1,"+DH+"}))?(?:\\.(\\d{1,"+DH+"}))?(?:$|[^\\d])";var tL=vr++;we[tL]="(?:~>?)";var Rx=vr++;we[Rx]="(\\s*)"+we[tL]+"\\s+";hw[Rx]=new RegExp(we[Rx],"g");In[Rx]=new RegExp(eL(we[Rx]),"g");var J9e="$1~",Ppe=vr++;we[Ppe]="^"+we[tL]+we[$0]+"$";var Dpe=vr++;we[Dpe]="^"+we[tL]+we[wx]+"$";var rL=vr++;we[rL]="(?:\\^)";var kx=vr++;we[kx]="(\\s*)"+we[rL]+"\\s+";hw[kx]=new RegExp(we[kx],"g");In[kx]=new RegExp(eL(we[kx]),"g");var Z9e="$1^",Npe=vr++;we[Npe]="^"+we[rL]+we[$0]+"$";var Lpe=vr++;we[Lpe]="^"+we[rL]+we[wx]+"$";var GH=vr++;we[GH]="^"+we[Ax]+"\\s*("+jH+")$|^$";var VH=vr++;we[VH]="^"+we[Ax]+"\\s*("+wpe+")$|^$";var W0=vr++;we[W0]="(\\s*)"+we[Ax]+"\\s*("+jH+"|"+we[$0]+")";hw[W0]=new RegExp(we[W0],"g");In[W0]=new RegExp(eL(we[W0]),"g");var e7e="$1$2$3",Ope=vr++;we[Ope]="^\\s*("+we[$0]+")\\s+-\\s+("+we[$0]+")\\s*$";var Mpe=vr++;we[Mpe]="^\\s*("+we[wx]+")\\s+-\\s+("+we[wx]+")\\s*$";var Fpe=vr++;we[Fpe]="(<|>)?=?\\s*\\*";for(cd=0;cd<vr;cd++)sn(cd,we[cd]),hw[cd]||(hw[cd]=new RegExp(we[cd]),In[cd]=new RegExp(eL(we[cd])));var cd;Ft.parse=K0;function K0(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof Sr)return t;if(typeof t!="string"||t.length>mw)return null;var r=e.loose?In[zH]:In[HH];if(!r.test(t))return null;try{return new Sr(t,e)}catch{return null}}Ft.valid=t7e;function t7e(t,e){var r=K0(t,e);return r?r.version:null}Ft.clean=r7e;function r7e(t,e){var r=K0(t.trim().replace(/^[=v]+/,""),e);return r?r.version:null}Ft.SemVer=Sr;function Sr(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof Sr){if(t.loose===e.loose)return t;t=t.version}else if(typeof t!="string")throw new TypeError("Invalid Version: "+t);if(t.length>mw)throw new TypeError("version is longer than "+mw+" characters");if(!(this instanceof Sr))return new Sr(t,e);sn("SemVer",t,e),this.options=e,this.loose=!!e.loose;var r=t.trim().match(e.loose?In[zH]:In[HH]);if(!r)throw new TypeError("Invalid Version: "+t);if(this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>KN||this.major<0)throw new TypeError("Invalid major version");if(this.minor>KN||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>KN||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(function(n){if(/^[0-9]+$/.test(n)){var o=+n;if(o>=0&&o<KN)return o}return n}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}Sr.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version};Sr.prototype.toString=function(){return this.version};Sr.prototype.compare=function(t){return sn("SemVer.compare",this.version,this.options,t),t instanceof Sr||(t=new Sr(t,this.options)),this.compareMain(t)||this.comparePre(t)};Sr.prototype.compareMain=function(t){return t instanceof Sr||(t=new Sr(t,this.options)),Ex(this.major,t.major)||Ex(this.minor,t.minor)||Ex(this.patch,t.patch)};Sr.prototype.comparePre=function(t){if(t instanceof Sr||(t=new Sr(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;var e=0;do{var r=this.prerelease[e],n=t.prerelease[e];if(sn("prerelease compare",e,r,n),r===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(r===void 0)return-1;if(r===n)continue;return Ex(r,n)}while(++e)};Sr.prototype.inc=function(t,e){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e),this.inc("pre",e);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",e),this.inc("pre",e);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);r===-1&&this.prerelease.push(0)}e&&(this.prerelease[0]===e?isNaN(this.prerelease[1])&&(this.prerelease=[e,0]):this.prerelease=[e,0]);break;default:throw new Error("invalid increment argument: "+t)}return this.format(),this.raw=this.version,this};Ft.inc=n7e;function n7e(t,e,r,n){typeof r=="string"&&(n=r,r=void 0);try{return new Sr(t,r).inc(e,n).version}catch{return null}}Ft.diff=i7e;function i7e(t,e){if($H(t,e))return null;var r=K0(t),n=K0(e),o="";if(r.prerelease.length||n.prerelease.length){o="pre";var s="prerelease"}for(var a in r)if((a==="major"||a==="minor"||a==="patch")&&r[a]!==n[a])return o+a;return s}Ft.compareIdentifiers=Ex;var Cpe=/^[0-9]+$/;function Ex(t,e){var r=Cpe.test(t),n=Cpe.test(e);return r&&n&&(t=+t,e=+e),t===e?0:r&&!n?-1:n&&!r?1:t<e?-1:1}Ft.rcompareIdentifiers=o7e;function o7e(t,e){return Ex(e,t)}Ft.major=s7e;function s7e(t,e){return new Sr(t,e).major}Ft.minor=a7e;function a7e(t,e){return new Sr(t,e).minor}Ft.patch=c7e;function c7e(t,e){return new Sr(t,e).patch}Ft.compare=Zp;function Zp(t,e,r){return new Sr(t,r).compare(new Sr(e,r))}Ft.compareLoose=u7e;function u7e(t,e){return Zp(t,e,!0)}Ft.rcompare=l7e;function l7e(t,e,r){return Zp(e,t,r)}Ft.sort=d7e;function d7e(t,e){return t.sort(function(r,n){return Ft.compare(r,n,e)})}Ft.rsort=p7e;function p7e(t,e){return t.sort(function(r,n){return Ft.rcompare(r,n,e)})}Ft.gt=gw;function gw(t,e,r){return Zp(t,e,r)>0}Ft.lt=XN;function XN(t,e,r){return Zp(t,e,r)<0}Ft.eq=$H;function $H(t,e,r){return Zp(t,e,r)===0}Ft.neq=Upe;function Upe(t,e,r){return Zp(t,e,r)!==0}Ft.gte=WH;function WH(t,e,r){return Zp(t,e,r)>=0}Ft.lte=KH;function KH(t,e,r){return Zp(t,e,r)<=0}Ft.cmp=JN;function JN(t,e,r,n){switch(e){case"===":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t===r;case"!==":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t!==r;case"":case"=":case"==":return $H(t,r,n);case"!=":return Upe(t,r,n);case">":return gw(t,r,n);case">=":return WH(t,r,n);case"<":return XN(t,r,n);case"<=":return KH(t,r,n);default:throw new TypeError("Invalid operator: "+e)}}Ft.Comparator=Zc;function Zc(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof Zc){if(t.loose===!!e.loose)return t;t=t.value}if(!(this instanceof Zc))return new Zc(t,e);t=t.trim().split(/\s+/).join(" "),sn("comparator",t,e),this.options=e,this.loose=!!e.loose,this.parse(t),this.semver===yw?this.value="":this.value=this.operator+this.semver.version,sn("comp",this)}var yw={};Zc.prototype.parse=function(t){var e=this.options.loose?In[GH]:In[VH],r=t.match(e);if(!r)throw new TypeError("Invalid comparator: "+t);this.operator=r[1],this.operator==="="&&(this.operator=""),r[2]?this.semver=new Sr(r[2],this.options.loose):this.semver=yw};Zc.prototype.toString=function(){return this.value};Zc.prototype.test=function(t){return sn("Comparator.test",t,this.options.loose),this.semver===yw?!0:(typeof t=="string"&&(t=new Sr(t,this.options)),JN(t,this.operator,this.semver,this.options))};Zc.prototype.intersects=function(t,e){if(!(t instanceof Zc))throw new TypeError("a Comparator is required");(!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1});var r;if(this.operator==="")return r=new ii(t.value,e),ZN(this.value,r,e);if(t.operator==="")return r=new ii(this.value,e),ZN(t.semver,r,e);var n=(this.operator===">="||this.operator===">")&&(t.operator===">="||t.operator===">"),o=(this.operator==="<="||this.operator==="<")&&(t.operator==="<="||t.operator==="<"),s=this.semver.version===t.semver.version,a=(this.operator===">="||this.operator==="<=")&&(t.operator===">="||t.operator==="<="),c=JN(this.semver,"<",t.semver,e)&&(this.operator===">="||this.operator===">")&&(t.operator==="<="||t.operator==="<"),u=JN(this.semver,">",t.semver,e)&&(this.operator==="<="||this.operator==="<")&&(t.operator===">="||t.operator===">");return n||o||s&&a||c||u};Ft.Range=ii;function ii(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof ii)return t.loose===!!e.loose&&t.includePrerelease===!!e.includePrerelease?t:new ii(t.raw,e);if(t instanceof Zc)return new ii(t.value,e);if(!(this instanceof ii))return new ii(t,e);if(this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease,this.raw=t.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(function(r){return this.parseRange(r.trim())},this).filter(function(r){return r.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+this.raw);this.format()}ii.prototype.format=function(){return this.range=this.set.map(function(t){return t.join(" ").trim()}).join("||").trim(),this.range};ii.prototype.toString=function(){return this.range};ii.prototype.parseRange=function(t){var e=this.options.loose,r=e?In[Mpe]:In[Ope];t=t.replace(r,S7e),sn("hyphen replace",t),t=t.replace(In[W0],e7e),sn("comparator trim",t,In[W0]),t=t.replace(In[Rx],J9e),t=t.replace(In[kx],Z9e);var n=e?In[GH]:In[VH],o=t.split(" ").map(function(s){return m7e(s,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(o=o.filter(function(s){return!!s.match(n)})),o=o.map(function(s){return new Zc(s,this.options)},this),o};ii.prototype.intersects=function(t,e){if(!(t instanceof ii))throw new TypeError("a Range is required");return this.set.some(function(r){return r.every(function(n){return t.set.some(function(o){return o.every(function(s){return n.intersects(s,e)})})})})};Ft.toComparators=f7e;function f7e(t,e){return new ii(t,e).set.map(function(r){return r.map(function(n){return n.value}).join(" ").trim().split(" ")})}function m7e(t,e){return sn("comp",t,e),t=v7e(t,e),sn("caret",t),t=h7e(t,e),sn("tildes",t),t=b7e(t,e),sn("xrange",t),t=x7e(t,e),sn("stars",t),t}function aa(t){return!t||t.toLowerCase()==="x"||t==="*"}function h7e(t,e){return t.trim().split(/\s+/).map(function(r){return g7e(r,e)}).join(" ")}function g7e(t,e){var r=e.loose?In[Dpe]:In[Ppe];return t.replace(r,function(n,o,s,a,c){sn("tilde",t,n,o,s,a,c);var u;return aa(o)?u="":aa(s)?u=">="+o+".0.0 <"+(+o+1)+".0.0":aa(a)?u=">="+o+"."+s+".0 <"+o+"."+(+s+1)+".0":c?(sn("replaceTilde pr",c),u=">="+o+"."+s+"."+a+"-"+c+" <"+o+"."+(+s+1)+".0"):u=">="+o+"."+s+"."+a+" <"+o+"."+(+s+1)+".0",sn("tilde return",u),u})}function v7e(t,e){return t.trim().split(/\s+/).map(function(r){return y7e(r,e)}).join(" ")}function y7e(t,e){sn("caret",t,e);var r=e.loose?In[Lpe]:In[Npe];return t.replace(r,function(n,o,s,a,c){sn("caret",t,n,o,s,a,c);var u;return aa(o)?u="":aa(s)?u=">="+o+".0.0 <"+(+o+1)+".0.0":aa(a)?o==="0"?u=">="+o+"."+s+".0 <"+o+"."+(+s+1)+".0":u=">="+o+"."+s+".0 <"+(+o+1)+".0.0":c?(sn("replaceCaret pr",c),o==="0"?s==="0"?u=">="+o+"."+s+"."+a+"-"+c+" <"+o+"."+s+"."+(+a+1):u=">="+o+"."+s+"."+a+"-"+c+" <"+o+"."+(+s+1)+".0":u=">="+o+"."+s+"."+a+"-"+c+" <"+(+o+1)+".0.0"):(sn("no pr"),o==="0"?s==="0"?u=">="+o+"."+s+"."+a+" <"+o+"."+s+"."+(+a+1):u=">="+o+"."+s+"."+a+" <"+o+"."+(+s+1)+".0":u=">="+o+"."+s+"."+a+" <"+(+o+1)+".0.0"),sn("caret return",u),u})}function b7e(t,e){return sn("replaceXRanges",t,e),t.split(/\s+/).map(function(r){return _7e(r,e)}).join(" ")}function _7e(t,e){t=t.trim();var r=e.loose?In[kpe]:In[Rpe];return t.replace(r,function(n,o,s,a,c,u){sn("xRange",t,n,o,s,a,c,u);var l=aa(s),d=l||aa(a),p=d||aa(c),f=p;return o==="="&&f&&(o=""),l?o===">"||o==="<"?n="<0.0.0":n="*":o&&f?(d&&(a=0),c=0,o===">"?(o=">=",d?(s=+s+1,a=0,c=0):(a=+a+1,c=0)):o==="<="&&(o="<",d?s=+s+1:a=+a+1),n=o+s+"."+a+"."+c):d?n=">="+s+".0.0 <"+(+s+1)+".0.0":p&&(n=">="+s+"."+a+".0 <"+s+"."+(+a+1)+".0"),sn("xRange return",n),n})}function x7e(t,e){return sn("replaceStars",t,e),t.trim().replace(In[Fpe],"")}function S7e(t,e,r,n,o,s,a,c,u,l,d,p,f){return aa(r)?e="":aa(n)?e=">="+r+".0.0":aa(o)?e=">="+r+"."+n+".0":e=">="+e,aa(u)?c="":aa(l)?c="<"+(+u+1)+".0.0":aa(d)?c="<"+u+"."+(+l+1)+".0":p?c="<="+u+"."+l+"."+d+"-"+p:c="<="+c,(e+" "+c).trim()}ii.prototype.test=function(t){if(!t)return!1;typeof t=="string"&&(t=new Sr(t,this.options));for(var e=0;e<this.set.length;e++)if(I7e(this.set[e],t,this.options))return!0;return!1};function I7e(t,e,r){for(var n=0;n<t.length;n++)if(!t[n].test(e))return!1;if(e.prerelease.length&&!r.includePrerelease){for(n=0;n<t.length;n++)if(sn(t[n].semver),t[n].semver!==yw&&t[n].semver.prerelease.length>0){var o=t[n].semver;if(o.major===e.major&&o.minor===e.minor&&o.patch===e.patch)return!0}return!1}return!0}Ft.satisfies=ZN;function ZN(t,e,r){try{e=new ii(e,r)}catch{return!1}return e.test(t)}Ft.maxSatisfying=C7e;function C7e(t,e,r){var n=null,o=null;try{var s=new ii(e,r)}catch{return null}return t.forEach(function(a){s.test(a)&&(!n||o.compare(a)===-1)&&(n=a,o=new Sr(n,r))}),n}Ft.minSatisfying=T7e;function T7e(t,e,r){var n=null,o=null;try{var s=new ii(e,r)}catch{return null}return t.forEach(function(a){s.test(a)&&(!n||o.compare(a)===1)&&(n=a,o=new Sr(n,r))}),n}Ft.minVersion=E7e;function E7e(t,e){t=new ii(t,e);var r=new Sr("0.0.0");if(t.test(r)||(r=new Sr("0.0.0-0"),t.test(r)))return r;r=null;for(var n=0;n<t.set.length;++n){var o=t.set[n];o.forEach(function(s){var a=new Sr(s.semver.version);switch(s.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!r||gw(r,a))&&(r=a);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+s.operator)}})}return r&&t.test(r)?r:null}Ft.validRange=w7e;function w7e(t,e){try{return new ii(t,e).range||"*"}catch{return null}}Ft.ltr=R7e;function R7e(t,e,r){return YH(t,e,"<",r)}Ft.gtr=k7e;function k7e(t,e,r){return YH(t,e,">",r)}Ft.outside=YH;function YH(t,e,r,n){t=new Sr(t,n),e=new ii(e,n);var o,s,a,c,u;switch(r){case">":o=gw,s=KH,a=XN,c=">",u=">=";break;case"<":o=XN,s=WH,a=gw,c="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(ZN(t,e,n))return!1;for(var l=0;l<e.set.length;++l){var d=e.set[l],p=null,f=null;if(d.forEach(function(m){m.semver===yw&&(m=new Zc(">=0.0.0")),p=p||m,f=f||m,o(m.semver,p.semver,n)?p=m:a(m.semver,f.semver,n)&&(f=m)}),p.operator===c||p.operator===u||(!f.operator||f.operator===c)&&s(t,f.semver))return!1;if(f.operator===u&&a(t,f.semver))return!1}return!0}Ft.prerelease=A7e;function A7e(t,e){var r=K0(t,e);return r&&r.prerelease.length?r.prerelease:null}Ft.intersects=P7e;function P7e(t,e,r){return t=new ii(t,r),e=new ii(e,r),t.intersects(e)}Ft.coerce=D7e;function D7e(t){if(t instanceof Sr)return t;if(typeof t!="string")return null;var e=t.match(In[Ape]);return e==null?null:K0(e[1]+"."+(e[2]||"0")+"."+(e[3]||"0"))}});var nL=L((VEt,zpe)=>{"use strict";function QH(t){return typeof t=="function"}var ca=console.error.bind(console);function bw(t,e,r){var n=!!t[e]&&t.propertyIsEnumerable(e);Object.defineProperty(t,e,{configurable:!0,enumerable:n,writable:!0,value:r})}function _w(t){t&&t.logger&&(QH(t.logger)?ca=t.logger:ca("new logger isn't a function, not replacing"))}function Hpe(t,e,r){if(!t||!t[e]){ca("no original function "+e+" to wrap");return}if(!r){ca("no wrapper function"),ca(new Error().stack);return}if(!QH(t[e])||!QH(r)){ca("original object and wrapper must be functions");return}var n=t[e],o=r(n,e);return bw(o,"__original",n),bw(o,"__unwrap",function(){t[e]===o&&bw(t,e,n)}),bw(o,"__wrapped",!0),bw(t,e,o),o}function N7e(t,e,r){if(t)Array.isArray(t)||(t=[t]);else{ca("must provide one or more modules to patch"),ca(new Error().stack);return}if(!(e&&Array.isArray(e))){ca("must provide one or more functions to wrap on modules");return}t.forEach(function(n){e.forEach(function(o){Hpe(n,o,r)})})}function jpe(t,e){if(!t||!t[e]){ca("no function to unwrap."),ca(new Error().stack);return}if(!t[e].__unwrap)ca("no original to unwrap to -- has "+e+" already been unwrapped?");else return t[e].__unwrap()}function L7e(t,e){if(t)Array.isArray(t)||(t=[t]);else{ca("must provide one or more modules to patch"),ca(new Error().stack);return}if(!(e&&Array.isArray(e))){ca("must provide one or more functions to unwrap on modules");return}t.forEach(function(r){e.forEach(function(n){jpe(r,n)})})}_w.wrap=Hpe;_w.massWrap=N7e;_w.unwrap=jpe;_w.massUnwrap=L7e;zpe.exports=_w});var sL=L(($Et,Wpe)=>{"use strict";var Vpe=nL(),Px=Vpe.wrap,iL=Vpe.unwrap,ef="wrap@before";function oL(t,e,r){var n=!!t[e]&&t.propertyIsEnumerable(e);Object.defineProperty(t,e,{configurable:!0,enumerable:n,writable:!0,value:r})}function O7e(t,e){for(var r=e.length,n=0;n<r;n++){var o=e[n],s=t[ef];if(typeof s=="function")s(o);else if(Array.isArray(s))for(var a=s.length,c=0;c<a;c++)s[c](o)}}function $pe(t,e){var r;return r=t._events&&t._events[e],Array.isArray(r)||(r?r=[r]:r=[]),r}function M7e(t,e,r){var n=$pe(t,e),o=n.filter(function(s){return r.indexOf(s)===-1});o.length>0&&O7e(t,o)}function Gpe(t,e){if(t){var r=t;if(typeof t=="function")r=e(t);else if(Array.isArray(t)){r=[];for(var n=0;n<t.length;n++)r[n]=e(t[n])}return r}}Wpe.exports=function(e,r,n){if(!e||!e.on||!e.addListener||!e.removeListener||!e.emit)throw new Error("can only wrap real EEs");if(!r)throw new Error("must have function to run on listener addition");if(!n)throw new Error("must have function to wrap listeners when emitting");function o(a){return function(u,l){var d=$pe(this,u).slice();try{var p=a.call(this,u,l);return M7e(this,u,d),p}finally{this.on.__wrapped||Px(this,"on",o),this.addListener.__wrapped||Px(this,"addListener",o)}}}function s(a){return function(u){if(!this._events||!this._events[u])return a.apply(this,arguments);var l=this._events[u];function d(p){return function(){this._events[u]=l;try{return p.apply(this,arguments)}finally{l=this._events[u],this._events[u]=Gpe(l,n)}}}Px(this,"removeListener",d);try{return this._events[u]=Gpe(l,n),a.apply(this,arguments)}finally{iL(this,"removeListener"),this._events[u]=l}}}e[ef]?typeof e[ef]=="function"?oL(e,ef,[e[ef],r]):Array.isArray(e[ef])&&e[ef].push(r):oL(e,ef,r),e.__wrapped||(Px(e,"addListener",o),Px(e,"on",o),Px(e,"emit",s),oL(e,"__unwrap",function(){iL(e,"addListener"),iL(e,"on"),iL(e,"emit"),delete e[ef],delete e.__wrapped}),oL(e,"__wrapped",!0))}});var Xpe=L((WEt,Qpe)=>{"use strict";var Gr=require("util"),tf=require("assert"),F7e=sL(),Bn=require("async_hooks"),xw="cls@contexts",Sw="error@context",oi=process.env.DEBUG_CLS_HOOKED,zr=-1;Qpe.exports={getNamespace:Kpe,createNamespace:U7e,destroyNamespace:Ype,reset:B7e,ERROR_SYMBOL:Sw};function eu(t){this.name=t,this.active=null,this._set=[],this.id=null,this._contexts=new Map,this._indent=0}eu.prototype.set=function(e,r){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");if(this.active[e]=r,oi){let n=" ".repeat(this._indent<0?0:this._indent);Wn(n+"CONTEXT-SET KEY:"+e+"="+r+" in ns:"+this.name+" currentUid:"+zr+" active:"+Gr.inspect(this.active,{showHidden:!0,depth:2,colors:!0}))}return r};eu.prototype.get=function(e){if(!this.active){if(oi){let r=Bn.currentId(),n=Bn.triggerAsyncId(),o=" ".repeat(this._indent<0?0:this._indent);Wn(`${o}CONTEXT-GETTING KEY NO ACTIVE NS: (${this.name}) ${e}=undefined currentUid:${zr} asyncHooksCurrentId:${r} triggerId:${n} len:${this._set.length}`)}return}if(oi){let r=Bn.executionAsyncId(),n=Bn.triggerAsyncId(),o=" ".repeat(this._indent<0?0:this._indent);Wn(o+"CONTEXT-GETTING KEY:"+e+"="+this.active[e]+" ("+this.name+") currentUid:"+zr+" active:"+Gr.inspect(this.active,{showHidden:!0,depth:2,colors:!0})),Wn(`${o}CONTEXT-GETTING KEY: (${this.name}) ${e}=${this.active[e]} currentUid:${zr} asyncHooksCurrentId:${r} triggerId:${n} len:${this._set.length} active:${Gr.inspect(this.active)}`)}return this.active[e]};eu.prototype.createContext=function(){let e=Object.create(this.active?this.active:Object.prototype);if(e._ns_name=this.name,e.id=zr,oi){let r=Bn.executionAsyncId(),n=Bn.triggerAsyncId(),o=" ".repeat(this._indent<0?0:this._indent);Wn(`${o}CONTEXT-CREATED Context: (${this.name}) currentUid:${zr} asyncHooksCurrentId:${r} triggerId:${n} len:${this._set.length} context:${Gr.inspect(e,{showHidden:!0,depth:2,colors:!0})}`)}return e};eu.prototype.run=function(e){let r=this.createContext();this.enter(r);try{if(oi){let n=Bn.triggerAsyncId(),o=Bn.executionAsyncId(),s=" ".repeat(this._indent<0?0:this._indent);Wn(`${s}CONTEXT-RUN BEGIN: (${this.name}) currentUid:${zr} triggerId:${n} asyncHooksCurrentId:${o} len:${this._set.length} context:${Gr.inspect(r)}`)}return e(r),r}catch(n){throw n&&(n[Sw]=r),n}finally{if(oi){let n=Bn.triggerAsyncId(),o=Bn.executionAsyncId(),s=" ".repeat(this._indent<0?0:this._indent);Wn(`${s}CONTEXT-RUN END: (${this.name}) currentUid:${zr} triggerId:${n} asyncHooksCurrentId:${o} len:${this._set.length} ${Gr.inspect(r)}`)}this.exit(r)}};eu.prototype.runAndReturn=function(e){let r;return this.run(function(n){r=e(n)}),r};eu.prototype.runPromise=function(e){let r=this.createContext();this.enter(r);let n=e(r);if(!n||!n.then||!n.catch)throw new Error("fn must return a promise.");return oi&&Wn("CONTEXT-runPromise BEFORE: ("+this.name+") currentUid:"+zr+" len:"+this._set.length+" "+Gr.inspect(r)),n.then(o=>(oi&&Wn("CONTEXT-runPromise AFTER then: ("+this.name+") currentUid:"+zr+" len:"+this._set.length+" "+Gr.inspect(r)),this.exit(r),o)).catch(o=>{throw o[Sw]=r,oi&&Wn("CONTEXT-runPromise AFTER catch: ("+this.name+") currentUid:"+zr+" len:"+this._set.length+" "+Gr.inspect(r)),this.exit(r),o})};eu.prototype.bind=function(e,r){r||(this.active?r=this.active:r=this.createContext());let n=this;return function(){n.enter(r);try{return e.apply(this,arguments)}catch(s){throw s&&(s[Sw]=r),s}finally{n.exit(r)}}};eu.prototype.enter=function(e){if(tf.ok(e,"context must be provided for entering"),oi){let r=Bn.executionAsyncId(),n=Bn.triggerAsyncId(),o=" ".repeat(this._indent<0?0:this._indent);Wn(`${o}CONTEXT-ENTER: (${this.name}) currentUid:${zr} triggerId:${n} asyncHooksCurrentId:${r} len:${this._set.length} ${Gr.inspect(e)}`)}this._set.push(this.active),this.active=e};eu.prototype.exit=function(e){if(tf.ok(e,"context must be provided for exiting"),oi){let n=Bn.executionAsyncId(),o=Bn.triggerAsyncId(),s=" ".repeat(this._indent<0?0:this._indent);Wn(`${s}CONTEXT-EXIT: (${this.name}) currentUid:${zr} triggerId:${o} asyncHooksCurrentId:${n} len:${this._set.length} ${Gr.inspect(e)}`)}if(this.active===e){tf.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}let r=this._set.lastIndexOf(e);r<0?(oi&&Wn("??ERROR?? context exiting but not entered - ignoring: "+Gr.inspect(e)),tf.ok(r>=0,`context not currently entered; can't exit. 
`+Gr.inspect(this)+`
`+Gr.inspect(e))):(tf.ok(r,"can't remove top context"),this._set.splice(r,1))};eu.prototype.bindEmitter=function(e){tf.ok(e.on&&e.addListener&&e.emit,"can only bind real EEs");let r=this,n="context@"+this.name;function o(a){a&&(a[xw]||(a[xw]=Object.create(null)),a[xw][n]={namespace:r,context:r.active})}function s(a){if(!(a&&a[xw]))return a;let c=a,u=a[xw];return Object.keys(u).forEach(function(l){let d=u[l];c=d.namespace.bind(c,d.context)}),c}F7e(e,o,s)};eu.prototype.fromException=function(e){return e[Sw]};function Kpe(t){return process.namespaces[t]}function U7e(t){tf.ok(t,"namespace must be given a name."),oi&&Wn(`NS-CREATING NAMESPACE (${t})`);let e=new eu(t);return e.id=zr,Bn.createHook({init(n,o,s,a){if(zr=Bn.executionAsyncId(),e.active){if(e._contexts.set(n,e.active),oi){let c=" ".repeat(e._indent<0?0:e._indent);Wn(`${c}INIT [${o}] (${t}) asyncId:${n} currentUid:${zr} triggerId:${s} active:${Gr.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}}else if(zr===0){let c=Bn.triggerAsyncId(),u=e._contexts.get(c);if(u){if(e._contexts.set(n,u),oi){let l=" ".repeat(e._indent<0?0:e._indent);Wn(`${l}INIT USING CONTEXT FROM TRIGGERID [${o}] (${t}) asyncId:${n} currentUid:${zr} triggerId:${c} active:${Gr.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}}else if(oi){let l=" ".repeat(e._indent<0?0:e._indent);Wn(`${l}INIT MISSING CONTEXT [${o}] (${t}) asyncId:${n} currentUid:${zr} triggerId:${c} active:${Gr.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}}if(oi&&o==="PROMISE"){Wn(Gr.inspect(a,{showHidden:!0}));let c=a.parentId,u=" ".repeat(e._indent<0?0:e._indent);Wn(`${u}INIT RESOURCE-PROMISE [${o}] (${t}) parentId:${c} asyncId:${n} currentUid:${zr} triggerId:${s} active:${Gr.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}},before(n){zr=Bn.executionAsyncId();let o;if(o=e._contexts.get(n)||e._contexts.get(zr),o){if(oi){let s=Bn.triggerAsyncId(),a=" ".repeat(e._indent<0?0:e._indent);Wn(`${a}BEFORE (${t}) asyncId:${n} currentUid:${zr} triggerId:${s} active:${Gr.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} context:${Gr.inspect(o)}`),e._indent+=2}e.enter(o)}else if(oi){let s=Bn.triggerAsyncId(),a=" ".repeat(e._indent<0?0:e._indent);Wn(`${a}BEFORE MISSING CONTEXT (${t}) asyncId:${n} currentUid:${zr} triggerId:${s} active:${Gr.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} namespace._contexts:${Gr.inspect(e._contexts,{showHidden:!0,depth:2,colors:!0})}`),e._indent+=2}},after(n){zr=Bn.executionAsyncId();let o;if(o=e._contexts.get(n)||e._contexts.get(zr),o){if(oi){let s=Bn.triggerAsyncId();e._indent-=2;let a=" ".repeat(e._indent<0?0:e._indent);Wn(`${a}AFTER (${t}) asyncId:${n} currentUid:${zr} triggerId:${s} active:${Gr.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} context:${Gr.inspect(o)}`)}e.exit(o)}else if(oi){let s=Bn.triggerAsyncId();e._indent-=2;let a=" ".repeat(e._indent<0?0:e._indent);Wn(`${a}AFTER MISSING CONTEXT (${t}) asyncId:${n} currentUid:${zr} triggerId:${s} active:${Gr.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} context:${Gr.inspect(o)}`)}},destroy(n){if(zr=Bn.executionAsyncId(),oi){let o=Bn.triggerAsyncId(),s=" ".repeat(e._indent<0?0:e._indent);Wn(`${s}DESTROY (${t}) currentUid:${zr} asyncId:${n} triggerId:${o} active:${Gr.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} context:${Gr.inspect(e._contexts.get(zr))}`)}e._contexts.delete(n)}}).enable(),process.namespaces[t]=e,e}function Ype(t){let e=Kpe(t);tf.ok(e,`can't delete nonexistent namespace! "`+t+'"'),tf.ok(e.id,"don't assign to process.namespaces directly! "+Gr.inspect(e)),process.namespaces[t]=null}function B7e(){process.namespaces&&Object.keys(process.namespaces).forEach(function(t){Ype(t)}),process.namespaces=Object.create(null)}process.namespaces={};function Wn(...t){oi&&process._rawDebug(`${Gr.format(...t)}`)}});var Zpe=L((KEt,Jpe)=>{"use strict";function q7e(){}Jpe.exports=function(){let e=this._hooks,r=this._state,n=process.nextTick;process.nextTick=function(){if(!r.enabled)return n.apply(process,arguments);let o=new Array(arguments.length);for(let u=0;u<arguments.length;u++)o[u]=arguments[u];let s=o[0];if(typeof s!="function")throw new TypeError("callback is not a function");let a=new q7e,c=--r.counter;return e.init.call(a,c,0,null,null),o[0]=function(){e.pre.call(a,c);let u=!0;try{s.apply(this,arguments),u=!1}finally{u&&process.listenerCount("uncaughtException")>0&&process.once("uncaughtException",function(){e.post.call(a,c,!0),e.destroy.call(null,c)})}e.post.call(a,c,!1),e.destroy.call(null,c)},n.apply(process,o)}}});var tfe=L((YEt,efe)=>{"use strict";function H7e(){}efe.exports=function(){let e=this._hooks,r=this._state,n=global.Promise,o=n.prototype.then;n.prototype.then=u;function s(l,d,p,f){return typeof l!="function"?f?a(p):c(p):function(){e.pre.call(d,p);try{return l.apply(this,arguments)}finally{e.post.call(d,p,!1),e.destroy.call(null,p)}}}function a(l){return function(p){return e.destroy.call(null,l),p}}function c(l){return function(p){throw e.destroy.call(null,l),p}}function u(l,d){if(!r.enabled)return o.call(this,l,d);let p=new H7e,f=--r.counter;return e.init.call(p,f,0,null,null),o.call(this,s(l,p,f,!0),s(d,p,f,!1))}}});var nfe=L((QEt,rfe)=>{"use strict";var gc=require("timers");function j7e(){}function z7e(){}function G7e(){}var V7e=new Map,$7e=new Map,W7e=new Map,XH=null,JH=!1;rfe.exports=function(){ZH(this._hooks,this._state,"setTimeout","clearTimeout",j7e,V7e,!0),ZH(this._hooks,this._state,"setInterval","clearInterval",z7e,$7e,!1),ZH(this._hooks,this._state,"setImmediate","clearImmediate",G7e,W7e,!0),global.setTimeout=gc.setTimeout,global.setInterval=gc.setInterval,global.setImmediate=gc.setImmediate,global.clearTimeout=gc.clearTimeout,global.clearInterval=gc.clearInterval,global.clearImmediate=gc.clearImmediate};function ZH(t,e,r,n,o,s,a){let c=gc[r],u=gc[n];gc[r]=function(){if(!e.enabled)return c.apply(gc,arguments);let l=new Array(arguments.length);for(let h=0;h<arguments.length;h++)l[h]=arguments[h];let d=l[0];if(typeof d!="function")throw new TypeError('"callback" argument must be a function');let p=new o,f=--e.counter,m;return t.init.call(p,f,0,null,null),l[0]=function(){XH=m,t.pre.call(p,f);let h=!0;try{d.apply(this,arguments),h=!1}finally{h&&process.listenerCount("uncaughtException")>0&&process.once("uncaughtException",function(){t.post.call(p,f,!0),s.delete(m),t.destroy.call(null,f)})}t.post.call(p,f,!1),XH=null,(a||JH)&&(JH=!1,s.delete(m),t.destroy.call(null,f))},m=c.apply(gc,l),s.set(m,f),m},gc[n]=function(l){if(XH===l&&l!==null)JH=!0;else if(s.has(l)){let d=s.get(l);s.delete(l),t.destroy.call(null,d)}u.apply(gc,arguments)}}});var sfe=L((XEt,ofe)=>{"use strict";var Cw=process.binding("async_wrap"),K7e=Cw.Providers.TIMERWRAP,ife={nextTick:Zpe(),promise:tfe(),timers:nfe()},Iw=new Set;function Y7e(){this.enabled=!1,this.counter=0}function ej(){let t=this.initFns=[],e=this.preFns=[],r=this.postFns=[],n=this.destroyFns=[];this.init=function(o,s,a,c){if(s===K7e){Iw.add(o);return}for(let u of t)u(o,this,s,a,c)},this.pre=function(o){if(!Iw.has(o))for(let s of e)s(o,this)},this.post=function(o,s){if(!Iw.has(o))for(let a of r)a(o,this,s)},this.destroy=function(o){if(Iw.has(o)){Iw.delete(o);return}for(let s of n)s(o)}}ej.prototype.add=function(t){t.init&&this.initFns.push(t.init),t.pre&&this.preFns.push(t.pre),t.post&&this.postFns.push(t.post),t.destroy&&this.destroyFns.push(t.destroy)};function aL(t,e){let r=t.indexOf(e);r!==-1&&t.splice(r,1)}ej.prototype.remove=function(t){t.init&&aL(this.initFns,t.init),t.pre&&aL(this.preFns,t.pre),t.post&&aL(this.postFns,t.post),t.destroy&&aL(this.destroyFns,t.destroy)};function Tw(){this._state=new Y7e,this._hooks=new ej,this.version=require("./package.json").version,this.providers=Cw.Providers;for(let t of Object.keys(ife))ife[t].call(this);process.env.hasOwnProperty("NODE_ASYNC_HOOK_WARNING")&&console.warn("warning: you are using async-hook-jl which is unstable."),Cw.setupHooks({init:this._hooks.init,pre:this._hooks.pre,post:this._hooks.post,destroy:this._hooks.destroy})}ofe.exports=Tw;Tw.prototype.addHooks=function(t){this._hooks.add(t)};Tw.prototype.removeHooks=function(t){this._hooks.remove(t)};Tw.prototype.enable=function(){this._state.enabled=!0,Cw.enable()};Tw.prototype.disable=function(){this._state.enabled=!1,Cw.disable()}});var cfe=L((JEt,afe)=>{function Q7e(t){try{return Error.prototype.toString.call(t)}catch(e){try{return"<error: "+e+">"}catch{return"<error>"}}}afe.exports=function(e,r){var n=[];n.push(Q7e(e));for(var o=0;o<r.length;o++){var s=r[o],a;try{a=s.toString()}catch(c){try{a="<error: "+c+">"}catch{a="<error>"}}n.push("    at "+a)}return n.join(`
`)}});var pfe=L((ZEt,dfe)=>{var cL=cfe();function lfe(){this.extend=new Ew,this.filter=new Ew,this.format=new ww,this.version=require("./package.json").version}var rj=!1;lfe.prototype.callSite=function t(e){e||(e={}),rj=!0;var r={};Error.captureStackTrace(r,t);var n=r.stack;return rj=!1,n=n.slice(e.slice||0),e.extend&&(n=this.extend._modify(r,n)),e.filter&&(n=this.filter._modify(r,n)),n};var gh=new lfe;function Ew(){this._modifiers=[]}Ew.prototype._modify=function(t,e){for(var r=0,n=this._modifiers.length;r<n;r++)e=this._modifiers[r](t,e);return e};Ew.prototype.attach=function(t){this._modifiers.push(t)};Ew.prototype.deattach=function(t){var e=this._modifiers.indexOf(t);return e===-1?!1:(this._modifiers.splice(e,1),!0)};function ww(){this._formater=cL,this._previous=void 0}ww.prototype.replace=function(t){t?this._formater=t:this.restore()};ww.prototype.restore=function(){this._formater=cL,this._previous=void 0};ww.prototype._backup=function(){this._previous=this._formater};ww.prototype._roolback=function(){this._previous===cL?this.replace(void 0):this.replace(this._previous),this._previous=void 0};Error.prepareStackTrace&&gh.format.replace(Error.prepareStackTrace);var tj=!1;function ufe(t,e){if(rj)return e;if(tj)return cL(t,e);var r=e.concat();r=gh.extend._modify(t,r),r=gh.filter._modify(t,r),r=r.slice(0,Error.stackTraceLimit),Object.isExtensible(t)&&Object.getOwnPropertyDescriptor(t,"callSite")===void 0&&(t.callSite={original:e,mutated:r}),tj=!0;var n=gh.format._formater(t,r);return tj=!1,n}Object.defineProperty(Error,"prepareStackTrace",{get:function(){return ufe},set:function(t){t===ufe?gh.format._roolback():(gh.format._backup(),gh.format.replace(t))}});function X7e(){return this.stack,this.callSite}Object.defineProperty(Error.prototype,"callSite",{get:X7e,set:function(t){Object.defineProperty(this,"callSite",{value:t,writable:!0,configurable:!0})},configurable:!0});dfe.exports=gh});var ij=L((ewt,nj)=>{if(global._stackChain)if(global._stackChain.version===require("./package.json").version)nj.exports=global._stackChain;else throw new Error("Conflicting version of stack-chain found");else nj.exports=global._stackChain=pfe()});var ffe=L((twt,oj)=>{"use strict";var J7e=sfe();if(global._asyncHook)if(global._asyncHook.version===require("./package.json").version)oj.exports=global._asyncHook;else throw new Error("Conflicting version of async-hook-jl found");else ij().filter.attach(function(e,r){return r.filter(function(n){let o=n.getFileName();return!(o&&o.slice(0,__dirname.length)===__dirname)})}),oj.exports=global._asyncHook=new J7e});var bfe=L((rwt,yfe)=>{"use strict";var Oi=require("util"),rf=require("assert"),Z7e=sL(),Dx=ffe(),Rw="cls@contexts",kw="error@context",hfe=[];for(let t in Dx.providers)hfe[Dx.providers[t]]=t;var xi=process.env.DEBUG_CLS_HOOKED,to=-1;yfe.exports={getNamespace:gfe,createNamespace:eUe,destroyNamespace:vfe,reset:tUe,ERROR_SYMBOL:kw};function tu(t){this.name=t,this.active=null,this._set=[],this.id=null,this._contexts=new Map}tu.prototype.set=function(e,r){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return xi&&Li("    SETTING KEY:"+e+"="+r+" in ns:"+this.name+" uid:"+to+" active:"+Oi.inspect(this.active,!0)),this.active[e]=r,r};tu.prototype.get=function(e){if(!this.active){xi&&Li("    GETTING KEY:"+e+"=undefined "+this.name+" uid:"+to+" active:"+Oi.inspect(this.active,!0));return}return xi&&Li("    GETTING KEY:"+e+"="+this.active[e]+" "+this.name+" uid:"+to+" active:"+Oi.inspect(this.active,!0)),this.active[e]};tu.prototype.createContext=function(){xi&&Li("   CREATING Context: "+this.name+" uid:"+to+" len:"+this._set.length+"  active:"+Oi.inspect(this.active,!0,2,!0));let e=Object.create(this.active?this.active:Object.prototype);return e._ns_name=this.name,e.id=to,xi&&Li("   CREATED Context: "+this.name+" uid:"+to+" len:"+this._set.length+"  context:"+Oi.inspect(e,!0,2,!0)),e};tu.prototype.run=function(e){let r=this.createContext();this.enter(r);try{return xi&&Li(" BEFORE RUN: "+this.name+" uid:"+to+" len:"+this._set.length+" "+Oi.inspect(r)),e(r),r}catch(n){throw n&&(n[kw]=r),n}finally{xi&&Li(" AFTER RUN: "+this.name+" uid:"+to+" len:"+this._set.length+" "+Oi.inspect(r)),this.exit(r)}};tu.prototype.runAndReturn=function(e){var r;return this.run(function(n){r=e(n)}),r};tu.prototype.runPromise=function(e){let r=this.createContext();this.enter(r);let n=e(r);if(!n||!n.then||!n.catch)throw new Error("fn must return a promise.");return xi&&Li(" BEFORE runPromise: "+this.name+" uid:"+to+" len:"+this._set.length+" "+Oi.inspect(r)),n.then(o=>(xi&&Li(" AFTER runPromise: "+this.name+" uid:"+to+" len:"+this._set.length+" "+Oi.inspect(r)),this.exit(r),o)).catch(o=>{throw o[kw]=r,xi&&Li(" AFTER runPromise: "+this.name+" uid:"+to+" len:"+this._set.length+" "+Oi.inspect(r)),this.exit(r),o})};tu.prototype.bind=function(e,r){r||(this.active?r=this.active:r=this.createContext());let n=this;return function(){n.enter(r);try{return e.apply(this,arguments)}catch(s){throw s&&(s[kw]=r),s}finally{n.exit(r)}}};tu.prototype.enter=function(e){rf.ok(e,"context must be provided for entering"),xi&&Li("  ENTER "+this.name+" uid:"+to+" len:"+this._set.length+" context: "+Oi.inspect(e)),this._set.push(this.active),this.active=e};tu.prototype.exit=function(e){if(rf.ok(e,"context must be provided for exiting"),xi&&Li("  EXIT "+this.name+" uid:"+to+" len:"+this._set.length+" context: "+Oi.inspect(e)),this.active===e){rf.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}let r=this._set.lastIndexOf(e);r<0?(xi&&Li("??ERROR?? context exiting but not entered - ignoring: "+Oi.inspect(e)),rf.ok(r>=0,`context not currently entered; can't exit. 
`+Oi.inspect(this)+`
`+Oi.inspect(e))):(rf.ok(r,"can't remove top context"),this._set.splice(r,1))};tu.prototype.bindEmitter=function(e){rf.ok(e.on&&e.addListener&&e.emit,"can only bind real EEs");let r=this,n="context@"+this.name;function o(a){a&&(a[Rw]||(a[Rw]=Object.create(null)),a[Rw][n]={namespace:r,context:r.active})}function s(a){if(!(a&&a[Rw]))return a;let c=a,u=a[Rw];return Object.keys(u).forEach(function(l){let d=u[l];c=d.namespace.bind(c,d.context)}),c}Z7e(e,o,s)};tu.prototype.fromException=function(e){return e[kw]};function gfe(t){return process.namespaces[t]}function eUe(t){rf.ok(t,"namespace must be given a name."),xi&&Li("CREATING NAMESPACE "+t);let e=new tu(t);return e.id=to,Dx.addHooks({init(r,n,o,s,a){to=r,s?(e._contexts.set(r,e._contexts.get(s)),xi&&Li("PARENTID: "+t+" uid:"+r+" parent:"+s+" provider:"+o)):e._contexts.set(to,e.active),xi&&Li("INIT "+t+" uid:"+r+" parent:"+s+" provider:"+hfe[o]+" active:"+Oi.inspect(e.active,!0))},pre(r,n){to=r;let o=e._contexts.get(r);o?(xi&&Li(" PRE "+t+" uid:"+r+" handle:"+uL(n)+" context:"+Oi.inspect(o)),e.enter(o)):xi&&Li(" PRE MISSING CONTEXT "+t+" uid:"+r+" handle:"+uL(n))},post(r,n){to=r;let o=e._contexts.get(r);o?(xi&&Li(" POST "+t+" uid:"+r+" handle:"+uL(n)+" context:"+Oi.inspect(o)),e.exit(o)):xi&&Li(" POST MISSING CONTEXT "+t+" uid:"+r+" handle:"+uL(n))},destroy(r){to=r,xi&&Li("DESTROY "+t+" uid:"+r+" context:"+Oi.inspect(e._contexts.get(to))+" active:"+Oi.inspect(e.active,!0)),e._contexts.delete(r)}}),process.namespaces[t]=e,e}function vfe(t){let e=gfe(t);rf.ok(e,`can't delete nonexistent namespace! "`+t+'"'),rf.ok(e.id,"don't assign to process.namespaces directly! "+Oi.inspect(e)),process.namespaces[t]=null}function tUe(){process.namespaces&&Object.keys(process.namespaces).forEach(function(t){vfe(t)}),process.namespaces=Object.create(null)}process.namespaces={};Dx._state&&!Dx._state.enabled&&Dx.enable();function Li(t){process.env.DEBUG&&process._rawDebug(t)}function uL(t){if(!t)return t;if(typeof t=="function")return t.name?t.name:(t.toString().trim().match(/^function\s*([^\s(]+)/)||[])[1];if(t.constructor&&t.constructor.name)return t.constructor.name}if(xi){sj=ij();for(mfe in sj.filter._modifiers)sj.filter.deattach(mfe)}var sj,mfe});var _fe=L((nwt,aj)=>{"use strict";var rUe=qpe();process&&rUe.gte(process.versions.node,"8.0.0")?aj.exports=Xpe():aj.exports=bfe()});var Ffe=L((Ut,Mfe)=>{Ut=Mfe.exports=Ir;var an;typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?an=function(){var t=Array.prototype.slice.call(arguments,0);t.unshift("SEMVER"),console.log.apply(console,t)}:an=function(){};Ut.SEMVER_SPEC_VERSION="2.0.0";var Aw=256,lL=Number.MAX_SAFE_INTEGER||9007199254740991,cj=16,nUe=Aw-6,Pw=Ut.re=[],Cn=Ut.safeRe=[],Re=Ut.src=[],yr=0,fj="[a-zA-Z0-9-]",uj=[["\\s",1],["\\d",Aw],[fj,nUe]];function gL(t){for(var e=0;e<uj.length;e++){var r=uj[e][0],n=uj[e][1];t=t.split(r+"*").join(r+"{0,"+n+"}").split(r+"+").join(r+"{1,"+n+"}")}return t}var Nx=yr++;Re[Nx]="0|[1-9]\\d*";var Lx=yr++;Re[Lx]="\\d+";var mj=yr++;Re[mj]="\\d*[a-zA-Z-]"+fj+"*";var Sfe=yr++;Re[Sfe]="("+Re[Nx]+")\\.("+Re[Nx]+")\\.("+Re[Nx]+")";var Ife=yr++;Re[Ife]="("+Re[Lx]+")\\.("+Re[Lx]+")\\.("+Re[Lx]+")";var lj=yr++;Re[lj]="(?:"+Re[Nx]+"|"+Re[mj]+")";var dj=yr++;Re[dj]="(?:"+Re[Lx]+"|"+Re[mj]+")";var hj=yr++;Re[hj]="(?:-("+Re[lj]+"(?:\\."+Re[lj]+")*))";var gj=yr++;Re[gj]="(?:-?("+Re[dj]+"(?:\\."+Re[dj]+")*))";var pj=yr++;Re[pj]=fj+"+";var Nw=yr++;Re[Nw]="(?:\\+("+Re[pj]+"(?:\\."+Re[pj]+")*))";var vj=yr++,Cfe="v?"+Re[Sfe]+Re[hj]+"?"+Re[Nw]+"?";Re[vj]="^"+Cfe+"$";var yj="[v=\\s]*"+Re[Ife]+Re[gj]+"?"+Re[Nw]+"?",bj=yr++;Re[bj]="^"+yj+"$";var Bx=yr++;Re[Bx]="((?:<|>)?=?)";var dL=yr++;Re[dL]=Re[Lx]+"|x|X|\\*";var pL=yr++;Re[pL]=Re[Nx]+"|x|X|\\*";var Y0=yr++;Re[Y0]="[v=\\s]*("+Re[pL]+")(?:\\.("+Re[pL]+")(?:\\.("+Re[pL]+")(?:"+Re[hj]+")?"+Re[Nw]+"?)?)?";var Mx=yr++;Re[Mx]="[v=\\s]*("+Re[dL]+")(?:\\.("+Re[dL]+")(?:\\.("+Re[dL]+")(?:"+Re[gj]+")?"+Re[Nw]+"?)?)?";var Tfe=yr++;Re[Tfe]="^"+Re[Bx]+"\\s*"+Re[Y0]+"$";var Efe=yr++;Re[Efe]="^"+Re[Bx]+"\\s*"+Re[Mx]+"$";var wfe=yr++;Re[wfe]="(?:^|[^\\d])(\\d{1,"+cj+"})(?:\\.(\\d{1,"+cj+"}))?(?:\\.(\\d{1,"+cj+"}))?(?:$|[^\\d])";var vL=yr++;Re[vL]="(?:~>?)";var Fx=yr++;Re[Fx]="(\\s*)"+Re[vL]+"\\s+";Pw[Fx]=new RegExp(Re[Fx],"g");Cn[Fx]=new RegExp(gL(Re[Fx]),"g");var iUe="$1~",Rfe=yr++;Re[Rfe]="^"+Re[vL]+Re[Y0]+"$";var kfe=yr++;Re[kfe]="^"+Re[vL]+Re[Mx]+"$";var yL=yr++;Re[yL]="(?:\\^)";var Ux=yr++;Re[Ux]="(\\s*)"+Re[yL]+"\\s+";Pw[Ux]=new RegExp(Re[Ux],"g");Cn[Ux]=new RegExp(gL(Re[Ux]),"g");var oUe="$1^",Afe=yr++;Re[Afe]="^"+Re[yL]+Re[Y0]+"$";var Pfe=yr++;Re[Pfe]="^"+Re[yL]+Re[Mx]+"$";var _j=yr++;Re[_j]="^"+Re[Bx]+"\\s*("+yj+")$|^$";var xj=yr++;Re[xj]="^"+Re[Bx]+"\\s*("+Cfe+")$|^$";var Q0=yr++;Re[Q0]="(\\s*)"+Re[Bx]+"\\s*("+yj+"|"+Re[Y0]+")";Pw[Q0]=new RegExp(Re[Q0],"g");Cn[Q0]=new RegExp(gL(Re[Q0]),"g");var sUe="$1$2$3",Dfe=yr++;Re[Dfe]="^\\s*("+Re[Y0]+")\\s+-\\s+("+Re[Y0]+")\\s*$";var Nfe=yr++;Re[Nfe]="^\\s*("+Re[Mx]+")\\s+-\\s+("+Re[Mx]+")\\s*$";var Lfe=yr++;Re[Lfe]="(<|>)?=?\\s*\\*";for(ud=0;ud<yr;ud++)an(ud,Re[ud]),Pw[ud]||(Pw[ud]=new RegExp(Re[ud]),Cn[ud]=new RegExp(gL(Re[ud])));var ud;Ut.parse=X0;function X0(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof Ir)return t;if(typeof t!="string"||t.length>Aw)return null;var r=e.loose?Cn[bj]:Cn[vj];if(!r.test(t))return null;try{return new Ir(t,e)}catch{return null}}Ut.valid=aUe;function aUe(t,e){var r=X0(t,e);return r?r.version:null}Ut.clean=cUe;function cUe(t,e){var r=X0(t.trim().replace(/^[=v]+/,""),e);return r?r.version:null}Ut.SemVer=Ir;function Ir(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof Ir){if(t.loose===e.loose)return t;t=t.version}else if(typeof t!="string")throw new TypeError("Invalid Version: "+t);if(t.length>Aw)throw new TypeError("version is longer than "+Aw+" characters");if(!(this instanceof Ir))return new Ir(t,e);an("SemVer",t,e),this.options=e,this.loose=!!e.loose;var r=t.trim().match(e.loose?Cn[bj]:Cn[vj]);if(!r)throw new TypeError("Invalid Version: "+t);if(this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>lL||this.major<0)throw new TypeError("Invalid major version");if(this.minor>lL||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>lL||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(function(n){if(/^[0-9]+$/.test(n)){var o=+n;if(o>=0&&o<lL)return o}return n}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}Ir.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version};Ir.prototype.toString=function(){return this.version};Ir.prototype.compare=function(t){return an("SemVer.compare",this.version,this.options,t),t instanceof Ir||(t=new Ir(t,this.options)),this.compareMain(t)||this.comparePre(t)};Ir.prototype.compareMain=function(t){return t instanceof Ir||(t=new Ir(t,this.options)),Ox(this.major,t.major)||Ox(this.minor,t.minor)||Ox(this.patch,t.patch)};Ir.prototype.comparePre=function(t){if(t instanceof Ir||(t=new Ir(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;var e=0;do{var r=this.prerelease[e],n=t.prerelease[e];if(an("prerelease compare",e,r,n),r===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(r===void 0)return-1;if(r===n)continue;return Ox(r,n)}while(++e)};Ir.prototype.inc=function(t,e){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e),this.inc("pre",e);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",e),this.inc("pre",e);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);r===-1&&this.prerelease.push(0)}e&&(this.prerelease[0]===e?isNaN(this.prerelease[1])&&(this.prerelease=[e,0]):this.prerelease=[e,0]);break;default:throw new Error("invalid increment argument: "+t)}return this.format(),this.raw=this.version,this};Ut.inc=uUe;function uUe(t,e,r,n){typeof r=="string"&&(n=r,r=void 0);try{return new Ir(t,r).inc(e,n).version}catch{return null}}Ut.diff=lUe;function lUe(t,e){if(Sj(t,e))return null;var r=X0(t),n=X0(e),o="";if(r.prerelease.length||n.prerelease.length){o="pre";var s="prerelease"}for(var a in r)if((a==="major"||a==="minor"||a==="patch")&&r[a]!==n[a])return o+a;return s}Ut.compareIdentifiers=Ox;var xfe=/^[0-9]+$/;function Ox(t,e){var r=xfe.test(t),n=xfe.test(e);return r&&n&&(t=+t,e=+e),t===e?0:r&&!n?-1:n&&!r?1:t<e?-1:1}Ut.rcompareIdentifiers=dUe;function dUe(t,e){return Ox(e,t)}Ut.major=pUe;function pUe(t,e){return new Ir(t,e).major}Ut.minor=fUe;function fUe(t,e){return new Ir(t,e).minor}Ut.patch=mUe;function mUe(t,e){return new Ir(t,e).patch}Ut.compare=nf;function nf(t,e,r){return new Ir(t,r).compare(new Ir(e,r))}Ut.compareLoose=hUe;function hUe(t,e){return nf(t,e,!0)}Ut.rcompare=gUe;function gUe(t,e,r){return nf(e,t,r)}Ut.sort=vUe;function vUe(t,e){return t.sort(function(r,n){return Ut.compare(r,n,e)})}Ut.rsort=yUe;function yUe(t,e){return t.sort(function(r,n){return Ut.rcompare(r,n,e)})}Ut.gt=Dw;function Dw(t,e,r){return nf(t,e,r)>0}Ut.lt=fL;function fL(t,e,r){return nf(t,e,r)<0}Ut.eq=Sj;function Sj(t,e,r){return nf(t,e,r)===0}Ut.neq=Ofe;function Ofe(t,e,r){return nf(t,e,r)!==0}Ut.gte=Ij;function Ij(t,e,r){return nf(t,e,r)>=0}Ut.lte=Cj;function Cj(t,e,r){return nf(t,e,r)<=0}Ut.cmp=mL;function mL(t,e,r,n){switch(e){case"===":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t===r;case"!==":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t!==r;case"":case"=":case"==":return Sj(t,r,n);case"!=":return Ofe(t,r,n);case">":return Dw(t,r,n);case">=":return Ij(t,r,n);case"<":return fL(t,r,n);case"<=":return Cj(t,r,n);default:throw new TypeError("Invalid operator: "+e)}}Ut.Comparator=ru;function ru(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof ru){if(t.loose===!!e.loose)return t;t=t.value}if(!(this instanceof ru))return new ru(t,e);t=t.trim().split(/\s+/).join(" "),an("comparator",t,e),this.options=e,this.loose=!!e.loose,this.parse(t),this.semver===Lw?this.value="":this.value=this.operator+this.semver.version,an("comp",this)}var Lw={};ru.prototype.parse=function(t){var e=this.options.loose?Cn[_j]:Cn[xj],r=t.match(e);if(!r)throw new TypeError("Invalid comparator: "+t);this.operator=r[1],this.operator==="="&&(this.operator=""),r[2]?this.semver=new Ir(r[2],this.options.loose):this.semver=Lw};ru.prototype.toString=function(){return this.value};ru.prototype.test=function(t){return an("Comparator.test",t,this.options.loose),this.semver===Lw?!0:(typeof t=="string"&&(t=new Ir(t,this.options)),mL(t,this.operator,this.semver,this.options))};ru.prototype.intersects=function(t,e){if(!(t instanceof ru))throw new TypeError("a Comparator is required");(!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1});var r;if(this.operator==="")return r=new si(t.value,e),hL(this.value,r,e);if(t.operator==="")return r=new si(this.value,e),hL(t.semver,r,e);var n=(this.operator===">="||this.operator===">")&&(t.operator===">="||t.operator===">"),o=(this.operator==="<="||this.operator==="<")&&(t.operator==="<="||t.operator==="<"),s=this.semver.version===t.semver.version,a=(this.operator===">="||this.operator==="<=")&&(t.operator===">="||t.operator==="<="),c=mL(this.semver,"<",t.semver,e)&&(this.operator===">="||this.operator===">")&&(t.operator==="<="||t.operator==="<"),u=mL(this.semver,">",t.semver,e)&&(this.operator==="<="||this.operator==="<")&&(t.operator===">="||t.operator===">");return n||o||s&&a||c||u};Ut.Range=si;function si(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof si)return t.loose===!!e.loose&&t.includePrerelease===!!e.includePrerelease?t:new si(t.raw,e);if(t instanceof ru)return new si(t.value,e);if(!(this instanceof si))return new si(t,e);if(this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease,this.raw=t.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(function(r){return this.parseRange(r.trim())},this).filter(function(r){return r.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+this.raw);this.format()}si.prototype.format=function(){return this.range=this.set.map(function(t){return t.join(" ").trim()}).join("||").trim(),this.range};si.prototype.toString=function(){return this.range};si.prototype.parseRange=function(t){var e=this.options.loose,r=e?Cn[Nfe]:Cn[Dfe];t=t.replace(r,RUe),an("hyphen replace",t),t=t.replace(Cn[Q0],sUe),an("comparator trim",t,Cn[Q0]),t=t.replace(Cn[Fx],iUe),t=t.replace(Cn[Ux],oUe);var n=e?Cn[_j]:Cn[xj],o=t.split(" ").map(function(s){return _Ue(s,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(o=o.filter(function(s){return!!s.match(n)})),o=o.map(function(s){return new ru(s,this.options)},this),o};si.prototype.intersects=function(t,e){if(!(t instanceof si))throw new TypeError("a Range is required");return this.set.some(function(r){return r.every(function(n){return t.set.some(function(o){return o.every(function(s){return n.intersects(s,e)})})})})};Ut.toComparators=bUe;function bUe(t,e){return new si(t,e).set.map(function(r){return r.map(function(n){return n.value}).join(" ").trim().split(" ")})}function _Ue(t,e){return an("comp",t,e),t=IUe(t,e),an("caret",t),t=xUe(t,e),an("tildes",t),t=TUe(t,e),an("xrange",t),t=wUe(t,e),an("stars",t),t}function ua(t){return!t||t.toLowerCase()==="x"||t==="*"}function xUe(t,e){return t.trim().split(/\s+/).map(function(r){return SUe(r,e)}).join(" ")}function SUe(t,e){var r=e.loose?Cn[kfe]:Cn[Rfe];return t.replace(r,function(n,o,s,a,c){an("tilde",t,n,o,s,a,c);var u;return ua(o)?u="":ua(s)?u=">="+o+".0.0 <"+(+o+1)+".0.0":ua(a)?u=">="+o+"."+s+".0 <"+o+"."+(+s+1)+".0":c?(an("replaceTilde pr",c),u=">="+o+"."+s+"."+a+"-"+c+" <"+o+"."+(+s+1)+".0"):u=">="+o+"."+s+"."+a+" <"+o+"."+(+s+1)+".0",an("tilde return",u),u})}function IUe(t,e){return t.trim().split(/\s+/).map(function(r){return CUe(r,e)}).join(" ")}function CUe(t,e){an("caret",t,e);var r=e.loose?Cn[Pfe]:Cn[Afe];return t.replace(r,function(n,o,s,a,c){an("caret",t,n,o,s,a,c);var u;return ua(o)?u="":ua(s)?u=">="+o+".0.0 <"+(+o+1)+".0.0":ua(a)?o==="0"?u=">="+o+"."+s+".0 <"+o+"."+(+s+1)+".0":u=">="+o+"."+s+".0 <"+(+o+1)+".0.0":c?(an("replaceCaret pr",c),o==="0"?s==="0"?u=">="+o+"."+s+"."+a+"-"+c+" <"+o+"."+s+"."+(+a+1):u=">="+o+"."+s+"."+a+"-"+c+" <"+o+"."+(+s+1)+".0":u=">="+o+"."+s+"."+a+"-"+c+" <"+(+o+1)+".0.0"):(an("no pr"),o==="0"?s==="0"?u=">="+o+"."+s+"."+a+" <"+o+"."+s+"."+(+a+1):u=">="+o+"."+s+"."+a+" <"+o+"."+(+s+1)+".0":u=">="+o+"."+s+"."+a+" <"+(+o+1)+".0.0"),an("caret return",u),u})}function TUe(t,e){return an("replaceXRanges",t,e),t.split(/\s+/).map(function(r){return EUe(r,e)}).join(" ")}function EUe(t,e){t=t.trim();var r=e.loose?Cn[Efe]:Cn[Tfe];return t.replace(r,function(n,o,s,a,c,u){an("xRange",t,n,o,s,a,c,u);var l=ua(s),d=l||ua(a),p=d||ua(c),f=p;return o==="="&&f&&(o=""),l?o===">"||o==="<"?n="<0.0.0":n="*":o&&f?(d&&(a=0),c=0,o===">"?(o=">=",d?(s=+s+1,a=0,c=0):(a=+a+1,c=0)):o==="<="&&(o="<",d?s=+s+1:a=+a+1),n=o+s+"."+a+"."+c):d?n=">="+s+".0.0 <"+(+s+1)+".0.0":p&&(n=">="+s+"."+a+".0 <"+s+"."+(+a+1)+".0"),an("xRange return",n),n})}function wUe(t,e){return an("replaceStars",t,e),t.trim().replace(Cn[Lfe],"")}function RUe(t,e,r,n,o,s,a,c,u,l,d,p,f){return ua(r)?e="":ua(n)?e=">="+r+".0.0":ua(o)?e=">="+r+"."+n+".0":e=">="+e,ua(u)?c="":ua(l)?c="<"+(+u+1)+".0.0":ua(d)?c="<"+u+"."+(+l+1)+".0":p?c="<="+u+"."+l+"."+d+"-"+p:c="<="+c,(e+" "+c).trim()}si.prototype.test=function(t){if(!t)return!1;typeof t=="string"&&(t=new Ir(t,this.options));for(var e=0;e<this.set.length;e++)if(kUe(this.set[e],t,this.options))return!0;return!1};function kUe(t,e,r){for(var n=0;n<t.length;n++)if(!t[n].test(e))return!1;if(e.prerelease.length&&!r.includePrerelease){for(n=0;n<t.length;n++)if(an(t[n].semver),t[n].semver!==Lw&&t[n].semver.prerelease.length>0){var o=t[n].semver;if(o.major===e.major&&o.minor===e.minor&&o.patch===e.patch)return!0}return!1}return!0}Ut.satisfies=hL;function hL(t,e,r){try{e=new si(e,r)}catch{return!1}return e.test(t)}Ut.maxSatisfying=AUe;function AUe(t,e,r){var n=null,o=null;try{var s=new si(e,r)}catch{return null}return t.forEach(function(a){s.test(a)&&(!n||o.compare(a)===-1)&&(n=a,o=new Ir(n,r))}),n}Ut.minSatisfying=PUe;function PUe(t,e,r){var n=null,o=null;try{var s=new si(e,r)}catch{return null}return t.forEach(function(a){s.test(a)&&(!n||o.compare(a)===1)&&(n=a,o=new Ir(n,r))}),n}Ut.minVersion=DUe;function DUe(t,e){t=new si(t,e);var r=new Ir("0.0.0");if(t.test(r)||(r=new Ir("0.0.0-0"),t.test(r)))return r;r=null;for(var n=0;n<t.set.length;++n){var o=t.set[n];o.forEach(function(s){var a=new Ir(s.semver.version);switch(s.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!r||Dw(r,a))&&(r=a);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+s.operator)}})}return r&&t.test(r)?r:null}Ut.validRange=NUe;function NUe(t,e){try{return new si(t,e).range||"*"}catch{return null}}Ut.ltr=LUe;function LUe(t,e,r){return Tj(t,e,"<",r)}Ut.gtr=OUe;function OUe(t,e,r){return Tj(t,e,">",r)}Ut.outside=Tj;function Tj(t,e,r,n){t=new Ir(t,n),e=new si(e,n);var o,s,a,c,u;switch(r){case">":o=Dw,s=Cj,a=fL,c=">",u=">=";break;case"<":o=fL,s=Ij,a=Dw,c="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(hL(t,e,n))return!1;for(var l=0;l<e.set.length;++l){var d=e.set[l],p=null,f=null;if(d.forEach(function(m){m.semver===Lw&&(m=new ru(">=0.0.0")),p=p||m,f=f||m,o(m.semver,p.semver,n)?p=m:a(m.semver,f.semver,n)&&(f=m)}),p.operator===c||p.operator===u||(!f.operator||f.operator===c)&&s(t,f.semver))return!1;if(f.operator===u&&a(t,f.semver))return!1}return!0}Ut.prerelease=MUe;function MUe(t,e){var r=X0(t,e);return r&&r.prerelease.length?r.prerelease:null}Ut.intersects=FUe;function FUe(t,e,r){return t=new si(t,r),e=new si(e,r),t.intersects(e)}Ut.coerce=UUe;function UUe(t){if(t instanceof Ir)return t;if(typeof t!="string")return null;var e=t.match(Cn[wfe]);return e==null?null:X0(e[1]+"."+(e[2]||"0")+"."+(e[3]||"0"))}});var qfe=L((iwt,Bfe)=>{var BUe=nL().wrap,wj=1,Rj=2,kj=4,_L=8,vn=[],qUe=0,Fs=!1,vh=[],qx,Aj;function Pj(t,e){var r=t.length,n=e.length,o=[];if(r===0&&n===0)return o;for(var s=0;s<r;s++)o[s]=t[s];if(n===0)return o;for(var a=0;a<n;a++){var c=!0;for(s=0;s<r;s++)if(t[s].uid===e[a].uid){c=!1;break}c&&o.push(e[a])}return o}process._fatalException?(bL=!1,qx=function(e){var r=vn.length;if(bL||r===0)return!1;var n=!1;bL=!0;for(var o=0;o<r;++o){var s=vn[o];if(s.flags&_L){var a=Hx&&Hx[s.uid];n=s.error(a,e)||n}}return bL=!1,vh.length>0&&(vn=vh.pop()),Hx=void 0,n&&!Fs},Aj=function(e,r,n){var o=[];Fs=!0;for(var s=0;s<n;++s){var a=r[s];if(o[a.uid]=a.data,!!(a.flags&wj)){var c=a.create(a.data);c!==void 0&&(o[a.uid]=c)}}return Fs=!1,function(){Hx=o,vh.push(vn),vn=Pj(r,vn),Fs=!0;for(var u=0;u<n;++u)(r[u].flags&Rj)>0&&r[u].before(this,o[r[u].uid]);Fs=!1;var l=e.apply(this,arguments);for(Fs=!0,u=0;u<n;++u)(r[u].flags&kj)>0&&r[u].after(this,o[r[u].uid]);return Fs=!1,vn=vh.pop(),Hx=void 0,l}},BUe(process,"_fatalException",function(t){return function(r){return qx(r)||t(r)}})):(Ej=!1,qx=function(e){if(Ej)throw e;for(var r=!1,n=vn.length,o=0;o<n;++o){var s=vn[o];s.flags&_L&&(r=s.error(null,e)||r)}if(!r&&Fs)throw e},Aj=function(e,r,n){var o=[];Fs=!0;for(var s=0;s<n;++s){var a=r[s];if(o[a.uid]=a.data,!!(a.flags&wj)){var c=a.create(a.data);c!==void 0&&(o[a.uid]=c)}}return Fs=!1,function(){var u=!1,l=!1;vh.push(vn),vn=Pj(r,vn),Fs=!0;for(var d=0;d<n;++d)(r[d].flags&Rj)>0&&r[d].before(this,o[r[d].uid]);Fs=!1;var p;try{p=e.apply(this,arguments)}catch(f){u=!0;for(var d=0;d<n;++d)if(vn[d].flags&_L)try{l=vn[d].error(o[r[d].uid],f)||l}catch(h){throw Ej=!0,h}if(!l)throw process.removeListener("uncaughtException",qx),process._originalNextTick(function(){process.addListener("uncaughtException",qx)}),f}finally{if(!u||l){for(Fs=!0,d=0;d<n;++d)(r[d].flags&kj)>0&&r[d].after(this,o[r[d].uid]);Fs=!1}vn=vh.pop()}return p}},process.addListener("uncaughtException",qx));var bL,Hx,Ej;function HUe(t,e,r){Fs=!0;for(var n=0;n<r;++n){var o=e[n];o.create&&o.create(o.data)}return Fs=!1,function(){vh.push(vn),vn=Pj(e,vn);var s=t.apply(this,arguments);return vn=vh.pop(),s}}function jUe(t){var e=vn.length;if(e===0)return t;for(var r=vn.slice(),n=0;n<e;++n)if(r[n].flags>0)return Aj(t,r,e);return HUe(t,r,e)}function ld(t,e){typeof t.create=="function"&&(this.create=t.create,this.flags|=wj),typeof t.before=="function"&&(this.before=t.before,this.flags|=Rj),typeof t.after=="function"&&(this.after=t.after,this.flags|=kj),typeof t.error=="function"&&(this.error=t.error,this.flags|=_L),this.uid=++qUe,this.data=e===void 0?null:e}ld.prototype.create=void 0;ld.prototype.before=void 0;ld.prototype.after=void 0;ld.prototype.error=void 0;ld.prototype.data=void 0;ld.prototype.uid=0;ld.prototype.flags=0;function Ufe(t,e){if(typeof t!="object"||!t)throw new TypeError("callbacks argument must be an object");return t instanceof ld?t:new ld(t,e)}function zUe(t,e){var r;t instanceof ld?r=t:r=Ufe(t,e);for(var n=!1,o=0;o<vn.length;o++)if(r===vn[o]){n=!0;break}return n||vn.push(r),r}function GUe(t){for(var e=0;e<vn.length;e++)if(t===vn[e]){vn.splice(e,1);break}}process.createAsyncListener=Ufe;process.addAsyncListener=zUe;process.removeAsyncListener=GUe;Bfe.exports=jUe});var jfe=L((swt,Hfe)=>{"use strict";Hfe.exports=(t,e)=>class extends t{constructor(n){var o,s;super(c);var a=this;try{n.apply(o,s)}catch(u){s[1](u)}return a;function c(u,l){o=this,s=[d,p];function d(f){return e(a,!1),u(f)}function p(f){return e(a,!1),l(f)}}}}});var Yfe=L(()=>{"use strict";if(process.addAsyncListener)throw new Error("Don't require polyfill unless needed");var $fe=nL(),SL=Ffe(),Ma=$fe.wrap,yh=$fe.massWrap,ai=qfe(),VUe=require("util"),$Ue=SL.gte(process.version,"6.0.0"),Lj=SL.gte(process.version,"7.0.0"),WUe=SL.gte(process.version,"8.0.0"),KUe=SL.gte(process.version,"11.0.0"),dd=require("net");Lj&&!dd._normalizeArgs?dd._normalizeArgs=function(t){if(t.length===0)return[{},null];var e=t[0],r={};typeof e=="object"&&e!==null?r=e:ZUe(e)?r.path=e:(r.port=e,t.length>1&&typeof t[1]=="string"&&(r.host=t[1]));var n=t[t.length-1];return typeof n!="function"?[r,null]:[r,n]}:!Lj&&!dd._normalizeConnectArgs&&(dd._normalizeConnectArgs=function(t){var e={};function r(o){return(o=Number(o))>=0?o:!1}typeof t[0]=="object"&&t[0]!==null?e=t[0]:typeof t[0]=="string"&&r(t[0])===!1?e.path=t[0]:(e.port=t[0],typeof t[1]=="string"&&(e.host=t[1]));var n=t[t.length-1];return typeof n=="function"?[e,n]:[e]});"_setUpListenHandle"in dd.Server.prototype?Ma(dd.Server.prototype,"_setUpListenHandle",zfe):Ma(dd.Server.prototype,"_listen2",zfe);function zfe(t){return function(){this.on("connection",function(e){e._handle&&(e._handle.onread=ai(e._handle.onread))});try{return t.apply(this,arguments)}finally{this._handle&&this._handle.onconnection&&(this._handle.onconnection=ai(this._handle.onconnection))}}}function Wfe(t){if(t&&t._handle){var e=t._handle;e._originalOnread||(e._originalOnread=e.onread),e.onread=ai(e._originalOnread)}}Ma(dd.Socket.prototype,"connect",function(t){return function(){var e;WUe&&Array.isArray(arguments[0])&&Object.getOwnPropertySymbols(arguments[0]).length>0?e=arguments[0]:e=Lj?dd._normalizeArgs(arguments):dd._normalizeConnectArgs(arguments),e[1]&&(e[1]=ai(e[1]));var r=t.apply(this,e);return Wfe(this),r}});var YUe=require("http");Ma(YUe.Agent.prototype,"addRequest",function(t){return function(e){var r=e.onSocket;return e.onSocket=ai(function(n){return Wfe(n),r.apply(this,arguments)}),t.apply(this,arguments)}});var Dj=require("child_process");function Gfe(t){Array.isArray(t.stdio)&&t.stdio.forEach(function(e){e&&e._handle&&(e._handle.onread=ai(e._handle.onread),Ma(e._handle,"close",IL))}),t._handle&&(t._handle.onexit=ai(t._handle.onexit))}Dj.ChildProcess?Ma(Dj.ChildProcess.prototype,"spawn",function(t){return function(){var e=t.apply(this,arguments);return Gfe(this),e}}):yh(Dj,["execFile","fork","spawn"],function(t){return function(){var e=t.apply(this,arguments);return Gfe(e),e}});process._fatalException||(process._originalNextTick=process.nextTick);var Fj=[];process._nextDomainTick&&Fj.push("_nextDomainTick");process._tickDomainCallback&&Fj.push("_tickDomainCallback");yh(process,Fj,pd);Ma(process,"nextTick",IL);var Uj=["setTimeout","setInterval"];global.setImmediate&&Uj.push("setImmediate");var Kfe=require("timers"),QUe=global.setTimeout===Kfe.setTimeout;yh(Kfe,Uj,IL);QUe&&yh(global,Uj,IL);var Oj=require("dns");yh(Oj,["lookup","resolve","resolve4","resolve6","resolveCname","resolveMx","resolveNs","resolveTxt","resolveSrv","reverse"],pd);Oj.resolveNaptr&&Ma(Oj,"resolveNaptr",pd);var Z0=require("fs");yh(Z0,["watch","rename","truncate","chown","fchown","chmod","fchmod","stat","lstat","fstat","link","symlink","readlink","realpath","unlink","rmdir","mkdir","readdir","close","open","utimes","futimes","fsync","write","read","readFile","writeFile","appendFile","watchFile","unwatchFile","exists"],pd);Z0.lchown&&Ma(Z0,"lchown",pd);Z0.lchmod&&Ma(Z0,"lchmod",pd);Z0.ftruncate&&Ma(Z0,"ftruncate",pd);var Ow;try{Ow=require("zlib")}catch{}Ow&&Ow.Deflate&&Ow.Deflate.prototype&&(J0=Object.getPrototypeOf(Ow.Deflate.prototype),J0._transform?Ma(J0,"_transform",pd):J0.write&&J0.flush&&J0.end&&yh(J0,["write","flush","end"],pd));var J0,Mj;try{Mj=require("crypto")}catch{}Mj&&(Nj=["pbkdf2","randomBytes"],KUe||Nj.push("pseudoRandomBytes"),yh(Mj,Nj,pd));var Nj,xL=!!global.Promise&&Promise.toString()==="function Promise() { [native code] }"&&Promise.toString.toString()==="function toString() { [native code] }";xL&&(Vfe=process.addAsyncListener({create:function(){xL=!1}}),global.Promise.resolve(!0).then(function(){xL=!1}),process.removeAsyncListener(Vfe));var Vfe;xL&&XUe();function XUe(){var t=global.Promise;function e(a){if(!(this instanceof e))return t(a);if(typeof a!="function")return new t(a);var c,u,l=new t(d);l.__proto__=e.prototype;try{a.apply(c,u)}catch(p){u[1](p)}return l;function d(p,f){c=this,u=[m,h];function m(g){return n(l,!1),p(g)}function h(g){return n(l,!1),f(g)}}}if(VUe.inherits(e,t),Ma(t.prototype,"then",s),t.prototype.chain&&Ma(t.prototype,"chain",s),$Ue)global.Promise=jfe()(t,n);else{var r=["all","race","reject","resolve","accept","defer"];r.forEach(function(a){typeof t[a]=="function"&&(e[a]=t[a])}),global.Promise=e}function n(a,c){(!a.__asl_wrapper||c)&&(a.__asl_wrapper=ai(o))}function o(a,c,u,l){var d;try{return d=c.call(a,u),{returnVal:d,error:!1}}catch(p){return{errorVal:p,error:!0}}finally{d instanceof t?l.__asl_wrapper=function(){var f=d.__asl_wrapper||o;return f.apply(this,arguments)}:n(l,!0)}}function s(a){return function(){var u=this,l=a.apply(u,Array.prototype.map.call(arguments,d));return l.__asl_wrapper=function(f,m,h,g){return u.__asl_wrapper?(u.__asl_wrapper(f,function(){},null,l),l.__asl_wrapper(f,m,h,g)):o(f,m,h,g)},l;function d(p){return typeof p!="function"?p:ai(function(f){var m=(u.__asl_wrapper||o)(this,p,f,l);if(m.error)throw m.errorVal;return m.returnVal})}}}}function pd(t){var e=function(){var r,n=arguments.length-1;if(typeof arguments[n]=="function"){r=Array(arguments.length);for(var o=0;o<arguments.length-1;o++)r[o]=arguments[o];r[n]=ai(arguments[n])}return t.apply(this,r||arguments)};switch(t.length){case 1:return function(r){return arguments.length!==1?e.apply(this,arguments):(typeof r=="function"&&(r=ai(r)),t.call(this,r))};case 2:return function(r,n){return arguments.length!==2?e.apply(this,arguments):(typeof n=="function"&&(n=ai(n)),t.call(this,r,n))};case 3:return function(r,n,o){return arguments.length!==3?e.apply(this,arguments):(typeof o=="function"&&(o=ai(o)),t.call(this,r,n,o))};case 4:return function(r,n,o,s){return arguments.length!==4?e.apply(this,arguments):(typeof s=="function"&&(s=ai(s)),t.call(this,r,n,o,s))};case 5:return function(r,n,o,s,a){return arguments.length!==5?e.apply(this,arguments):(typeof a=="function"&&(a=ai(a)),t.call(this,r,n,o,s,a))};case 6:return function(r,n,o,s,a,c){return arguments.length!==6?e.apply(this,arguments):(typeof c=="function"&&(c=ai(c)),t.call(this,r,n,o,s,a,c))};default:return e}}function IL(t){var e=function(){var r;if(typeof arguments[0]=="function"){r=Array(arguments.length),r[0]=ai(arguments[0]);for(var n=1;n<arguments.length;n++)r[n]=arguments[n]}return t.apply(this,r||arguments)};switch(t.length){case 1:return function(r){return arguments.length!==1?e.apply(this,arguments):(typeof r=="function"&&(r=ai(r)),t.call(this,r))};case 2:return function(r,n){return arguments.length!==2?e.apply(this,arguments):(typeof r=="function"&&(r=ai(r)),t.call(this,r,n))};case 3:return function(r,n,o){return arguments.length!==3?e.apply(this,arguments):(typeof r=="function"&&(r=ai(r)),t.call(this,r,n,o))};case 4:return function(r,n,o,s){return arguments.length!==4?e.apply(this,arguments):(typeof r=="function"&&(r=ai(r)),t.call(this,r,n,o,s))};case 5:return function(r,n,o,s,a){return arguments.length!==5?e.apply(this,arguments):(typeof r=="function"&&(r=ai(r)),t.call(this,r,n,o,s,a))};case 6:return function(r,n,o,s,a,c){return arguments.length!==6?e.apply(this,arguments):(typeof r=="function"&&(r=ai(r)),t.call(this,r,n,o,s,a,c))};default:return e}}function JUe(t){return(t=Number(t))>=0?t:!1}function ZUe(t){return typeof t=="string"&&JUe(t)===!1}});var eme=L((uwt,Zfe)=>{"use strict";var of=require("assert"),eBe=sL(),Mw="cls@contexts",Bj="error@context";process.addAsyncListener||Yfe();function il(t){this.name=t,this.active=null,this._set=[],this.id=null}il.prototype.set=function(t,e){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return this.active[t]=e,e};il.prototype.get=function(t){if(this.active)return this.active[t]};il.prototype.createContext=function(){return Object.create(this.active)};il.prototype.run=function(t){var e=this.createContext();this.enter(e);try{return t(e),e}catch(r){throw r&&(r[Bj]=e),r}finally{this.exit(e)}};il.prototype.runAndReturn=function(t){var e;return this.run(function(r){e=t(r)}),e};il.prototype.bind=function(t,e){e||(this.active?e=this.active:e=this.createContext());var r=this;return function(){r.enter(e);try{return t.apply(this,arguments)}catch(n){throw n&&(n[Bj]=e),n}finally{r.exit(e)}}};il.prototype.enter=function(t){of.ok(t,"context must be provided for entering"),this._set.push(this.active),this.active=t};il.prototype.exit=function(t){if(of.ok(t,"context must be provided for exiting"),this.active===t){of.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}var e=this._set.lastIndexOf(t);of.ok(e>=0,"context not currently entered; can't exit"),of.ok(e,"can't remove top context"),this._set.splice(e,1)};il.prototype.bindEmitter=function(t){of.ok(t.on&&t.addListener&&t.emit,"can only bind real EEs");var e=this,r="context@"+this.name;function n(s){s&&(s[Mw]||(s[Mw]=Object.create(null)),s[Mw][r]={namespace:e,context:e.active})}function o(s){if(!(s&&s[Mw]))return s;var a=s,c=s[Mw];return Object.keys(c).forEach(function(u){var l=c[u];a=l.namespace.bind(a,l.context)}),a}eBe(t,n,o)};il.prototype.fromException=function(t){return t[Bj]};function Qfe(t){return process.namespaces[t]}function tBe(t){of.ok(t,"namespace must be given a name!");var e=new il(t);return e.id=process.addAsyncListener({create:function(){return e.active},before:function(r,n){n&&e.enter(n)},after:function(r,n){n&&e.exit(n)},error:function(r){r&&e.exit(r)}}),process.namespaces[t]=e,e}function Xfe(t){var e=Qfe(t);of.ok(e,"can't delete nonexistent namespace!"),of.ok(e.id,"don't assign to process.namespaces directly!"),process.removeAsyncListener(e.id),process.namespaces[t]=null}function Jfe(){process.namespaces&&Object.keys(process.namespaces).forEach(function(t){Xfe(t)}),process.namespaces=Object.create(null)}process.namespaces||Jfe();Zfe.exports={getNamespace:Qfe,createNamespace:tBe,destroyNamespace:Xfe,reset:Jfe}});var bh=L(TL=>{"use strict";Object.defineProperty(TL,"__esModule",{value:!0});TL.CorrelationContextManager=void 0;var jx=Fn(),rBe=jN(),ey=zN(),qj=dH(),tme=PH(),CL=as(),nBe=function(){function t(){}return t.getCurrentContext=function(){if(!t.enabled)return null;var e=t.session.get(t.CONTEXT_NAME);return e===void 0?null:e},t.generateContextObject=function(e,r,n,o,s,a){return r=r||e,this.enabled?{operation:{name:n,id:e,parentId:r,traceparent:s,tracestate:a},customProperties:new iBe(o)}:null},t.spanToContextObject=function(e,r,n){var o=new ey;return o.traceId=e.traceId,o.spanId=e.spanId,o.traceFlag=ey.formatOpenTelemetryTraceFlags(e.traceFlags)||ey.DEFAULT_TRACE_FLAG,o.parentId=r,t.generateContextObject(o.traceId,o.parentId,n,null,o)},t.runWithContext=function(e,r){var n;if(t.enabled)try{return t.session.bind(r,(n={},n[t.CONTEXT_NAME]=e,n))()}catch(o){jx.warn("Error binding to session context",CL.dumpObj(o))}return r()},t.wrapEmitter=function(e){if(t.enabled)try{t.session.bindEmitter(e)}catch(r){jx.warn("Error binding to session context",CL.dumpObj(r))}},t.wrapCallback=function(e,r){var n;if(t.enabled)try{return t.session.bind(e,r?(n={},n[t.CONTEXT_NAME]=r,n):void 0)}catch(o){jx.warn("Error binding to session context",CL.dumpObj(o))}return e},t.enable=function(e){if(!this.enabled){if(!this.isNodeVersionCompatible()){this.enabled=!1;return}t.hasEverEnabled||(this.forceClsHooked=e,this.hasEverEnabled=!0,typeof this.cls>"u"&&(t.forceClsHooked===!0||t.forceClsHooked===void 0&&t.shouldUseClsHooked()?this.cls=_fe():this.cls=eme()),t.session=this.cls.createNamespace("AI-CLS-Session"),rBe.registerContextPreservation(function(r){try{return t.session.bind(r)}catch(n){jx.warn("Error binding to session context",CL.dumpObj(n))}})),this.enabled=!0}},t.startOperation=function(e,r){var n=e&&e.traceContext||null,o=e&&e.spanContext?e:null,s=e&&e.traceId?e:null,a=e&&e.headers;if(o)return this.spanToContextObject(o.spanContext(),o.parentSpanId,o.name);if(s)return this.spanToContextObject(s,"|"+s.traceId+"."+s.spanId+".",typeof r=="string"?r:"");var c=typeof r=="string"?r:"";if(n){var u=null,l=null;if(c=n.attributes.OperationName||c,r){var d=r;d.headers&&(d.headers.traceparent?u=new ey(d.headers.traceparent):d.headers["request-id"]&&(u=new ey(null,d.headers["request-id"])),d.headers.tracestate&&(l=new qj(d.headers.tracestate)))}u||(u=new ey(n.traceParent||n.traceparent)),l||(l=new qj(n.traceState||n.tracestate));var p=void 0;if(typeof r=="object"){var f=new tme(r);p=f.getCorrelationContextHeader(),c=f.getOperationName({})}var m=t.generateContextObject(u.traceId,u.parentId,c,p,u,l);return m}if(a){var u=new ey(a.traceparent?a.traceparent.toString():null),l=new qj(a.tracestate?a.tracestate.toString():null),f=new tme(e),m=t.generateContextObject(u.traceId,u.parentId,f.getOperationName({}),f.getCorrelationContextHeader(),u,l);return m}return jx.warn("startOperation was called with invalid arguments",arguments),null},t.disable=function(){this.enabled=!1},t.reset=function(){t.hasEverEnabled&&(t.session=null,t.session=this.cls.createNamespace("AI-CLS-Session"))},t.isNodeVersionCompatible=function(){var e=process.versions.node.split(".");return parseInt(e[0])>3||parseInt(e[0])>2&&parseInt(e[1])>2},t.shouldUseClsHooked=function(){var e=process.versions.node.split(".");return parseInt(e[0])>8||parseInt(e[0])>=8&&parseInt(e[1])>=2},t.canUseClsHooked=function(){var e=process.versions.node.split("."),r=parseInt(e[0])>8||parseInt(e[0])>=8&&parseInt(e[1])>=0,n=parseInt(e[0])<8||parseInt(e[0])<=8&&parseInt(e[1])<2,o=parseInt(e[0])>4||parseInt(e[0])>=4&&parseInt(e[1])>=7;return!(r&&n)&&o},t.enabled=!1,t.hasEverEnabled=!1,t.forceClsHooked=void 0,t.CONTEXT_NAME="ApplicationInsights-Context",t}();TL.CorrelationContextManager=nBe;var iBe=function(){function t(e){this.props=[],this.addHeaderData(e)}return t.prototype.addHeaderData=function(e){var r=e?e.split(", "):[];this.props=r.map(function(n){var o=n.split("=");return{key:o[0],value:o[1]}}).concat(this.props)},t.prototype.serializeToHeader=function(){return this.props.map(function(e){return e.key+"="+e.value}).join(", ")},t.prototype.getProperty=function(e){for(var r=0;r<this.props.length;++r){var n=this.props[r];if(n.key===e)return n.value}},t.prototype.setProperty=function(e,r){if(t.bannedCharacters.test(e)||t.bannedCharacters.test(r)){jx.warn("Correlation context property keys and values must not contain ',' or '='. setProperty was called with key: "+e+" and value: "+r);return}for(var n=0;n<this.props.length;++n){var o=this.props[n];if(o.key===e){o.value=r;return}}this.props.push({key:e,value:r})},t.bannedCharacters=/[,=]/,t}()});var rme=L(zx=>{"use strict";Object.defineProperty(zx,"__esModule",{value:!0});zx.dispose=zx.enable=void 0;var EL=Os(),oBe=ni(),wL=_i(),_h=[],Hj=function(t){var e=t.data.message;_h.forEach(function(r){e instanceof Error&&!r.config.enableLoggerErrorToTrace?r.trackException({exception:e}):e instanceof Error?r.trackTrace({message:e.toString(),severity:t.data.stderr?EL.SeverityLevel.Error:EL.SeverityLevel.Information}):(e.lastIndexOf(`
`)==e.length-1&&(e=e.substring(0,e.length-1)),r.trackTrace({message:e,severity:t.data.stderr?EL.SeverityLevel.Warning:EL.SeverityLevel.Information}))})};function sBe(t,e){if(t){var r=_h.find(function(n){return n==e});if(r)return;_h.length===0&&wL.channel.subscribe("console",Hj,wL.trueFilter,function(n,o){var s=e.getStatsbeat();s&&s.addInstrumentation(oBe.StatsbeatInstrumentation.CONSOLE)}),_h.push(e)}else _h=_h.filter(function(n){return n!=e}),_h.length===0&&wL.channel.unsubscribe("console",Hj)}zx.enable=sBe;function aBe(){wL.channel.unsubscribe("console",Hj),_h=[]}zx.dispose=aBe});var nme=L(Vx=>{"use strict";Object.defineProperty(Vx,"__esModule",{value:!0});Vx.dispose=Vx.enable=void 0;var Gx=Os(),cBe=ni(),RL=_i(),xh=[],uBe={10:Gx.SeverityLevel.Verbose,20:Gx.SeverityLevel.Verbose,30:Gx.SeverityLevel.Information,40:Gx.SeverityLevel.Warning,50:Gx.SeverityLevel.Error,60:Gx.SeverityLevel.Critical},jj=function(t){var e=t.data.result,r=uBe[t.data.level];xh.forEach(function(n){try{var o=JSON.parse(e);if(o.err){var s=new Error(o.err.message);if(s.name=o.err.name,s.stack=o.err.stack,n.config.enableLoggerErrorToTrace){n.trackTrace({message:e,severity:r});return}n.trackException({exception:s});return}}catch{}n.trackTrace({message:e,severity:r})})};function lBe(t,e){if(t){var r=xh.find(function(n){return n==e});if(r)return;xh.length===0&&RL.channel.subscribe("bunyan",jj,RL.trueFilter,function(n,o){var s=e.getStatsbeat();s&&s.addInstrumentation(cBe.StatsbeatInstrumentation.BUNYAN)}),xh.push(e)}else xh=xh.filter(function(n){return n!=e}),xh.length===0&&RL.channel.unsubscribe("bunyan",jj)}Vx.enable=lBe;function dBe(){RL.channel.unsubscribe("bunyan",jj),xh=[]}Vx.dispose=dBe});var ime=L($x=>{"use strict";Object.defineProperty($x,"__esModule",{value:!0});$x.dispose=$x.enable=void 0;var pBe=ni(),ls=Os(),kL=_i(),Sh=[],fBe={syslog:function(t){var e={emerg:ls.SeverityLevel.Critical,alert:ls.SeverityLevel.Critical,crit:ls.SeverityLevel.Critical,error:ls.SeverityLevel.Error,warning:ls.SeverityLevel.Warning,notice:ls.SeverityLevel.Information,info:ls.SeverityLevel.Information,debug:ls.SeverityLevel.Verbose};return e[t]===void 0?ls.SeverityLevel.Information:e[t]},npm:function(t){var e={error:ls.SeverityLevel.Error,warn:ls.SeverityLevel.Warning,info:ls.SeverityLevel.Information,verbose:ls.SeverityLevel.Verbose,debug:ls.SeverityLevel.Verbose,silly:ls.SeverityLevel.Verbose};return e[t]===void 0?ls.SeverityLevel.Information:e[t]},unknown:function(t){return ls.SeverityLevel.Information}},zj=function(t){var e=t.data.message,r=fBe[t.data.levelKind](t.data.level);Sh.forEach(function(n){e instanceof Error&&!n.config.enableLoggerErrorToTrace?n.trackException({exception:e,properties:t.data.meta}):e instanceof Error?n.trackTrace({message:e.toString(),severity:r,properties:t.data.meta}):n.trackTrace({message:e,severity:r,properties:t.data.meta})})};function mBe(t,e){if(t){var r=Sh.find(function(n){return n==e});if(r)return;Sh.length===0&&kL.channel.subscribe("winston",zj,kL.trueFilter,function(n,o){var s=e.getStatsbeat();s&&s.addInstrumentation(pBe.StatsbeatInstrumentation.WINSTON)}),Sh.push(e)}else Sh=Sh.filter(function(n){return n!=e}),Sh.length===0&&kL.channel.unsubscribe("winston",zj)}$x.enable=mBe;function hBe(){kL.channel.unsubscribe("winston",zj),Sh=[]}$x.dispose=hBe});var sme=L((mwt,ome)=>{"use strict";var gBe=jN(),vBe=function(){function t(e){if(t.INSTANCE)throw new Error("Console logging adapter tracking should be configured from the applicationInsights object");this._client=e,t.INSTANCE=this}return t.prototype.enable=function(e,r){gBe.IsInitialized&&(rme().enable(e&&r,this._client),nme().enable(e,this._client),ime().enable(e,this._client))},t.prototype.isInitialized=function(){return this._isInitialized},t.prototype.dispose=function(){t.INSTANCE=null,this.enable(!1,!1)},t._methodNames=["debug","info","log","warn","error"],t}();ome.exports=vBe});var cme=L((hwt,ame)=>{"use strict";var yBe=function(){function t(e){if(t.INSTANCE)throw new Error("Exception tracking should be configured from the applicationInsights object");t.INSTANCE=this,this._client=e;var r=process.versions.node.split(".");t._canUseUncaughtExceptionMonitor=parseInt(r[0])>13||parseInt(r[0])===13&&parseInt(r[1])>=7}return t.prototype.isInitialized=function(){return this._isInitialized},t.prototype.enable=function(e){var r=this;if(e){if(this._isInitialized=!0,!this._exceptionListenerHandle){var n=function(o,s,a){a===void 0&&(a=new Error(t._FALLBACK_ERROR_MESSAGE));var c={exception:a};c.contextObjects={},c.contextObjects.Error=a,r._client.trackException(c),r._client.flush({isAppCrashing:!0}),o&&s&&process.listeners(s).length===1&&(console.error(a),process.exit(1))};t._canUseUncaughtExceptionMonitor?(this._exceptionListenerHandle=n.bind(this,!1,void 0),process.on(t.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME,this._exceptionListenerHandle)):(this._exceptionListenerHandle=n.bind(this,!0,t.UNCAUGHT_EXCEPTION_HANDLER_NAME),this._rejectionListenerHandle=n.bind(this,!1,void 0),process.on(t.UNCAUGHT_EXCEPTION_HANDLER_NAME,this._exceptionListenerHandle),process.on(t.UNHANDLED_REJECTION_HANDLER_NAME,this._rejectionListenerHandle))}}else this._exceptionListenerHandle&&(t._canUseUncaughtExceptionMonitor?process.removeListener(t.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME,this._exceptionListenerHandle):(process.removeListener(t.UNCAUGHT_EXCEPTION_HANDLER_NAME,this._exceptionListenerHandle),process.removeListener(t.UNHANDLED_REJECTION_HANDLER_NAME,this._rejectionListenerHandle)),this._exceptionListenerHandle=void 0,this._rejectionListenerHandle=void 0,delete this._exceptionListenerHandle,delete this._rejectionListenerHandle)},t.prototype.dispose=function(){t.INSTANCE=null,this.enable(!1),this._isInitialized=!1},t.INSTANCE=null,t.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME="uncaughtExceptionMonitor",t.UNCAUGHT_EXCEPTION_HANDLER_NAME="uncaughtException",t.UNHANDLED_REJECTION_HANDLER_NAME="unhandledRejection",t._RETHROW_EXIT_MESSAGE="Application Insights Rethrow Exception Handler",t._FALLBACK_ERROR_MESSAGE="A promise was rejected without providing an error. Application Insights generated this error stack for you.",t._canUseUncaughtExceptionMonitor=!1,t}();ame.exports=yBe});var PL=L((gwt,ume)=>{"use strict";var AL=require("os"),nu=ni(),bBe=function(){function t(e,r,n){r===void 0&&(r=6e4),n===void 0&&(n=!1),this._lastIntervalRequestExecutionTime=0,this._lastIntervalDependencyExecutionTime=0,t.INSTANCE||(t.INSTANCE=this),this._lastRequests={totalRequestCount:0,totalFailedRequestCount:0,time:0},this._lastDependencies={totalDependencyCount:0,totalFailedDependencyCount:0,time:0},this._lastExceptions={totalExceptionCount:0,time:0},this._isInitialized=!1,this._client=e,this._collectionInterval=r,this._enableLiveMetricsCounters=n}return t.prototype.enable=function(e,r){var n=this;this._isEnabled=e,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),e?this._handle||(this._lastCpus=AL.cpus(),this._lastRequests={totalRequestCount:t._totalRequestCount,totalFailedRequestCount:t._totalFailedRequestCount,time:+new Date},this._lastDependencies={totalDependencyCount:t._totalDependencyCount,totalFailedDependencyCount:t._totalFailedDependencyCount,time:+new Date},this._lastExceptions={totalExceptionCount:t._totalExceptionCount,time:+new Date},typeof process.cpuUsage=="function"&&(this._lastAppCpuUsage=process.cpuUsage()),this._lastHrtime=process.hrtime(),this._collectionInterval=r||this._collectionInterval,this._handle=setInterval(function(){return n.trackPerformance()},this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=void 0)},t.countRequest=function(e,r){var n;if(t.isEnabled()){if(typeof e=="string")n=+new Date("1970-01-01T"+e+"Z");else if(typeof e=="number")n=e;else return;t._intervalRequestExecutionTime+=n,r===!1&&t._totalFailedRequestCount++,t._totalRequestCount++}},t.countException=function(){t._totalExceptionCount++},t.countDependency=function(e,r){var n;if(t.isEnabled()){if(typeof e=="string")n=+new Date("1970-01-01T"+e+"Z");else if(typeof e=="number")n=e;else return;t._intervalDependencyExecutionTime+=n,r===!1&&t._totalFailedDependencyCount++,t._totalDependencyCount++}},t.prototype.isInitialized=function(){return this._isInitialized},t.isEnabled=function(){return t.INSTANCE&&t.INSTANCE._isEnabled},t.prototype.trackPerformance=function(){this._trackCpu(),this._trackMemory(),this._trackNetwork(),this._trackDependencyRate(),this._trackExceptionRate()},t.prototype._trackCpu=function(){var e=AL.cpus();if(e&&e.length&&this._lastCpus&&e.length===this._lastCpus.length){for(var r=0,n=0,o=0,s=0,a=0,c=0;e&&c<e.length;c++){var u=e[c],l=this._lastCpus[c],d="% cpu("+c+") ",p=u.model,f=u.speed,m=u.times,h=l.times,g=m.user-h.user||0;r+=g;var v=m.sys-h.sys||0;n+=v;var y=m.nice-h.nice||0;o+=y;var _=m.idle-h.idle||0;s+=_;var b=m.irq-h.irq||0;a+=b}var S=void 0;if(typeof process.cpuUsage=="function"){var I=process.cpuUsage(),w=process.hrtime(),O=I.user-this._lastAppCpuUsage.user+(I.system-this._lastAppCpuUsage.system)||0;if(typeof this._lastHrtime<"u"&&this._lastHrtime.length===2){var U=(w[0]-this._lastHrtime[0])*1e6+(w[1]-this._lastHrtime[1])/1e3||0;S=100*O/(U*e.length)}this._lastAppCpuUsage=I,this._lastHrtime=w}var z=r+n+o+s+a||1;this._client.trackMetric({name:nu.PerformanceCounter.PROCESSOR_TIME,value:(z-s)/z*100}),this._client.trackMetric({name:nu.PerformanceCounter.PROCESS_TIME,value:S||r/z*100})}this._lastCpus=e},t.prototype._trackMemory=function(){var e=AL.freemem(),r=process.memoryUsage().rss,n=AL.totalmem()-e;this._client.trackMetric({name:nu.PerformanceCounter.PRIVATE_BYTES,value:r}),this._client.trackMetric({name:nu.PerformanceCounter.AVAILABLE_BYTES,value:e}),this._enableLiveMetricsCounters&&this._client.trackMetric({name:nu.QuickPulseCounter.COMMITTED_BYTES,value:n})},t.prototype._trackNetwork=function(){var e=this._lastRequests,r={totalRequestCount:t._totalRequestCount,totalFailedRequestCount:t._totalFailedRequestCount,time:+new Date},n=r.totalRequestCount-e.totalRequestCount||0,o=r.totalFailedRequestCount-e.totalFailedRequestCount||0,s=r.time-e.time,a=s/1e3,c=(t._intervalRequestExecutionTime-this._lastIntervalRequestExecutionTime)/n||0;if(this._lastIntervalRequestExecutionTime=t._intervalRequestExecutionTime,s>0){var u=n/a,l=o/a;this._client.trackMetric({name:nu.PerformanceCounter.REQUEST_RATE,value:u}),(!this._enableLiveMetricsCounters||n>0)&&this._client.trackMetric({name:nu.PerformanceCounter.REQUEST_DURATION,value:c}),this._enableLiveMetricsCounters&&this._client.trackMetric({name:nu.QuickPulseCounter.REQUEST_FAILURE_RATE,value:l})}this._lastRequests=r},t.prototype._trackDependencyRate=function(){if(this._enableLiveMetricsCounters){var e=this._lastDependencies,r={totalDependencyCount:t._totalDependencyCount,totalFailedDependencyCount:t._totalFailedDependencyCount,time:+new Date},n=r.totalDependencyCount-e.totalDependencyCount||0,o=r.totalFailedDependencyCount-e.totalFailedDependencyCount||0,s=r.time-e.time,a=s/1e3,c=(t._intervalDependencyExecutionTime-this._lastIntervalDependencyExecutionTime)/n||0;if(this._lastIntervalDependencyExecutionTime=t._intervalDependencyExecutionTime,s>0){var u=n/a,l=o/a;this._client.trackMetric({name:nu.QuickPulseCounter.DEPENDENCY_RATE,value:u}),this._client.trackMetric({name:nu.QuickPulseCounter.DEPENDENCY_FAILURE_RATE,value:l}),(!this._enableLiveMetricsCounters||n>0)&&this._client.trackMetric({name:nu.QuickPulseCounter.DEPENDENCY_DURATION,value:c})}this._lastDependencies=r}},t.prototype._trackExceptionRate=function(){if(this._enableLiveMetricsCounters){var e=this._lastExceptions,r={totalExceptionCount:t._totalExceptionCount,time:+new Date},n=r.totalExceptionCount-e.totalExceptionCount||0,o=r.time-e.time,s=o/1e3;if(o>0){var a=n/s;this._client.trackMetric({name:nu.QuickPulseCounter.EXCEPTION_RATE,value:a})}this._lastExceptions=r}},t.prototype.dispose=function(){t.INSTANCE=null,this.enable(!1),this._isInitialized=!1},t._totalRequestCount=0,t._totalFailedRequestCount=0,t._totalDependencyCount=0,t._totalFailedDependencyCount=0,t._totalExceptionCount=0,t._intervalDependencyExecutionTime=0,t._intervalRequestExecutionTime=0,t}();ume.exports=bBe});var lme=L(DL=>{"use strict";Object.defineProperty(DL,"__esModule",{value:!0});DL.AggregatedMetricCounter=void 0;var _Be=function(){function t(e){this.dimensions=e,this.totalCount=0,this.lastTotalCount=0,this.intervalExecutionTime=0,this.lastTime=+new Date,this.lastIntervalExecutionTime=0}return t}();DL.AggregatedMetricCounter=_Be});var dme=L(NL=>{"use strict";Object.defineProperty(NL,"__esModule",{value:!0});NL.PreaggregatedMetricPropertyNames=void 0;NL.PreaggregatedMetricPropertyNames={cloudRoleInstance:"cloud/roleInstance",cloudRoleName:"cloud/roleName",operationSynthetic:"operation/synthetic",requestSuccess:"Request.Success",requestResultCode:"request/resultCode",dependencyType:"Dependency.Type",dependencyTarget:"dependency/target",dependencySuccess:"Dependency.Success",dependencyResultCode:"dependency/resultCode",traceSeverityLevel:"trace/severityLevel"}});var Vj=L((Gj,pme)=>{"use strict";var OL=Gj&&Gj.__assign||function(){return OL=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},OL.apply(this,arguments)},LL=ni(),xBe=lme(),SBe=dme(),IBe=function(){function t(e,r){r===void 0&&(r=6e4),t.INSTANCE||(t.INSTANCE=this),this._isInitialized=!1,t._dependencyCountersCollection=[],t._requestCountersCollection=[],t._exceptionCountersCollection=[],t._traceCountersCollection=[],this._client=e,this._collectionInterval=r}return t.prototype.enable=function(e,r){var n=this;this._isEnabled=e,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),e?this._handle||(this._collectionInterval=r||this._collectionInterval,this._handle=setInterval(function(){return n.trackPreAggregatedMetrics()},this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=void 0)},t.countException=function(e){if(t.isEnabled()){var r=t._getAggregatedCounter(e,this._exceptionCountersCollection);r.totalCount++}},t.countTrace=function(e){if(t.isEnabled()){var r=t._getAggregatedCounter(e,this._traceCountersCollection);r.totalCount++}},t.countRequest=function(e,r){if(t.isEnabled()){var n,o=t._getAggregatedCounter(r,this._requestCountersCollection);if(typeof e=="string")n=+new Date("1970-01-01T"+e+"Z");else if(typeof e=="number")n=e;else return;o.intervalExecutionTime+=n,o.totalCount++}},t.countDependency=function(e,r){if(t.isEnabled()){var n=t._getAggregatedCounter(r,this._dependencyCountersCollection),o;if(typeof e=="string")o=+new Date("1970-01-01T"+e+"Z");else if(typeof e=="number")o=e;else return;n.intervalExecutionTime+=o,n.totalCount++}},t.prototype.isInitialized=function(){return this._isInitialized},t.isEnabled=function(){return t.INSTANCE&&t.INSTANCE._isEnabled},t.prototype.trackPreAggregatedMetrics=function(){this._trackRequestMetrics(),this._trackDependencyMetrics(),this._trackExceptionMetrics(),this._trackTraceMetrics()},t._getAggregatedCounter=function(e,r){for(var n=!1,o=0;o<r.length;o++){if(e===r[o].dimensions)return r[o];if(Object.keys(e).length===Object.keys(r[o].dimensions).length){for(var s in e)if(e[s]!=r[o].dimensions[s]){n=!0;break}if(!n)return r[o];n=!1}}var a=new xBe.AggregatedMetricCounter(e);return r.push(a),a},t.prototype._trackRequestMetrics=function(){for(var e=0;e<t._requestCountersCollection.length;e++){var r=t._requestCountersCollection[e];r.time=+new Date;var n=r.totalCount-r.lastTotalCount||0,o=r.time-r.lastTime,s=(r.intervalExecutionTime-r.lastIntervalExecutionTime)/n||0;r.lastIntervalExecutionTime=r.intervalExecutionTime,o>0&&n>0&&this._trackPreAggregatedMetric({name:"Server response time",dimensions:r.dimensions,value:s,count:n,aggregationInterval:o,metricType:LL.MetricId.REQUESTS_DURATION}),r.lastTotalCount=r.totalCount,r.lastTime=r.time}},t.prototype._trackDependencyMetrics=function(){for(var e=0;e<t._dependencyCountersCollection.length;e++){var r=t._dependencyCountersCollection[e];r.time=+new Date;var n=r.totalCount-r.lastTotalCount||0,o=r.time-r.lastTime,s=(r.intervalExecutionTime-r.lastIntervalExecutionTime)/n||0;r.lastIntervalExecutionTime=r.intervalExecutionTime,o>0&&n>0&&this._trackPreAggregatedMetric({name:"Dependency duration",dimensions:r.dimensions,value:s,count:n,aggregationInterval:o,metricType:LL.MetricId.DEPENDENCIES_DURATION}),r.lastTotalCount=r.totalCount,r.lastTime=r.time}},t.prototype._trackExceptionMetrics=function(){for(var e=0;e<t._exceptionCountersCollection.length;e++){var r=t._exceptionCountersCollection[e];r.time=+new Date;var n=r.totalCount-r.lastTotalCount||0,o=r.time-r.lastTime;o>0&&n>0&&this._trackPreAggregatedMetric({name:"Exceptions",dimensions:r.dimensions,value:n,count:n,aggregationInterval:o,metricType:LL.MetricId.EXCEPTIONS_COUNT}),r.lastTotalCount=r.totalCount,r.lastTime=r.time}},t.prototype._trackTraceMetrics=function(){for(var e=0;e<t._traceCountersCollection.length;e++){var r=t._traceCountersCollection[e];r.time=+new Date;var n=r.totalCount-r.lastTotalCount||0,o=r.time-r.lastTime;o>0&&n>0&&this._trackPreAggregatedMetric({name:"Traces",dimensions:r.dimensions,value:n,count:n,aggregationInterval:o,metricType:LL.MetricId.TRACES_COUNT}),r.lastTotalCount=r.totalCount,r.lastTime=r.time}},t.prototype._trackPreAggregatedMetric=function(e){var r={};for(var n in e.dimensions)r[SBe.PreaggregatedMetricPropertyNames[n]]=e.dimensions[n];r=OL(OL({},r),{"_MS.MetricId":e.metricType,"_MS.AggregationIntervalMs":String(e.aggregationInterval),"_MS.IsAutocollected":"True"});var o={name:e.name,value:e.value,count:e.count,properties:r,kind:"Aggregation"};this._client.trackMetric(o)},t.prototype.dispose=function(){t.INSTANCE=null,this.enable(!1),this._isInitialized=!1},t}();pme.exports=IBe});var Wx=L((bwt,fme)=>{"use strict";var sf=require("os"),CBe=require("fs"),TBe=require("path"),EBe=Os(),wBe=ni(),RBe=Fn(),kBe=function(){function t(e){this.keys=new EBe.ContextTagKeys,this.tags={},this._loadApplicationContext(e),this._loadDeviceContext(),this._loadInternalContext()}return t.prototype._loadApplicationContext=function(e){try{if(e=e||TBe.resolve(__dirname,"../../../../package.json"),!t.appVersion[e]){t.appVersion[e]="unknown";var r=JSON.parse(CBe.readFileSync(e,"utf8"));r&&typeof r.version=="string"&&(t.appVersion[e]=r.version)}this.tags[this.keys.applicationVersion]=t.appVersion[e]}catch(n){RBe.info("Failed to read app version: ",n)}},t.prototype._loadDeviceContext=function(){var e=sf&&sf.hostname(),r=t.DefaultRoleName;process.env.WEBSITE_SITE_NAME&&(r=process.env.WEBSITE_SITE_NAME),process.env.WEBSITE_INSTANCE_ID&&(e=process.env.WEBSITE_INSTANCE_ID),this.tags[this.keys.deviceId]="",this.tags[this.keys.cloudRoleInstance]=e,this.tags[this.keys.deviceOSVersion]=sf&&sf.type()+" "+sf.release(),this.tags[this.keys.cloudRole]=r,this.tags["ai.device.osArchitecture"]=sf&&sf.arch(),this.tags["ai.device.osPlatform"]=sf&&sf.platform()},t.prototype._loadInternalContext=function(){t.sdkVersion=wBe.APPLICATION_INSIGHTS_SDK_VERSION,this.tags[this.keys.internalSdkVersion]="node:"+t.sdkVersion},t.DefaultRoleName="Web",t.appVersion={},t.sdkVersion=null,t}();fme.exports=kBe});var gme=L((_wt,hme)=>{"use strict";var ABe=require("crypto"),mme=require("os"),PBe=ni(),DBe=Wx(),NBe=function(){function t(e){this._collectionInterval=9e5,t.INSTANCE||(t.INSTANCE=this),this._isInitialized=!1,this._client=e}return t.prototype.enable=function(e){var r=this;this._isEnabled=e,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),e?this._handle||(this._handle=setInterval(function(){return r.trackHeartBeat(r._client.config,function(){})},this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=null)},t.prototype.isInitialized=function(){return this._isInitialized},t.isEnabled=function(){return t.INSTANCE&&t.INSTANCE._isEnabled},t.prototype.trackHeartBeat=function(e,r){var n={},o=DBe.sdkVersion;n.sdkVersion=o,n.osType=mme.type(),n.osVersion=mme.release(),this._uniqueProcessId||(this._uniqueProcessId=ABe.randomBytes(16).toString("hex")),n.processSessionId=this._uniqueProcessId,process.env.WEBSITE_SITE_NAME&&(n.appSrv_SiteName=process.env.WEBSITE_SITE_NAME),process.env.WEBSITE_HOME_STAMPNAME&&(n.appSrv_wsStamp=process.env.WEBSITE_HOME_STAMPNAME),process.env.WEBSITE_HOSTNAME&&(n.appSrv_wsHost=process.env.WEBSITE_HOSTNAME),process.env.WEBSITE_OWNER_NAME&&(n.appSrv_wsOwner=process.env.WEBSITE_OWNER_NAME),process.env.WEBSITE_RESOURCE_GROUP&&(n.appSrv_ResourceGroup=process.env.WEBSITE_RESOURCE_GROUP),process.env.WEBSITE_SLOT_NAME&&(n.appSrv_SlotName=process.env.WEBSITE_SLOT_NAME),this._client.trackMetric({name:PBe.HeartBeatMetricName,value:0,properties:n}),r()},t.prototype.dispose=function(){t.INSTANCE=null,this.enable(!1),this._isInitialized=!1},t}();hme.exports=NBe});var vme=L(Bt=>{"use strict";Object.defineProperty(Bt,"__esModule",{value:!0});Bt.isContentTypeHeaderHtml=Bt.insertSnippetByIndex=Bt.getContentEncodingFromHeaders=Bt.isSupportedContentEncoding=Bt.findBufferEncodingType=Bt.isBufferType=Bt.getBrotliDecompressSync=Bt.getBrotliDecompressAsync=Bt.getBrotliCompressSync=Bt.getBrotliCompressAsync=Bt.inflateAsync=Bt.deflateAsync=Bt.gunzipAsync=Bt.gzipAsync=Bt.isBrotliSupperted=Bt.bufferEncodingTypes=Bt.contentEncodingMethod=void 0;var FL=require("zlib"),Kx=require("util"),ML;(function(t){t.GZIP="gzip",t.DEFLATE="deflate",t.BR="br"})(ML=Bt.contentEncodingMethod||(Bt.contentEncodingMethod={}));Bt.bufferEncodingTypes=["utf8","utf16le","latin1","base64","hex","ascii","binary","ucs2"];var LBe=function(){var t=process.versions.node.split(".")[0];return parseInt(t)>=10};Bt.isBrotliSupperted=LBe;Bt.gzipAsync=Kx.promisify(FL.gzip);Bt.gunzipAsync=Kx.promisify(FL.gunzip);Bt.deflateAsync=Kx.promisify(FL.deflate);Bt.inflateAsync=Kx.promisify(FL.inflate);var OBe=function(t){var e=Bt.isBrotliSupperted();return e&&typeof t.brotliCompress=="function"?Kx.promisify(t.brotliCompress):null};Bt.getBrotliCompressAsync=OBe;var MBe=function(t){var e=Bt.isBrotliSupperted();return e&&typeof t.brotliCompressSync=="function"?t.brotliCompressSync:null};Bt.getBrotliCompressSync=MBe;var FBe=function(t){var e=Bt.isBrotliSupperted();return e&&typeof t.brotliDecompress=="function"?Kx.promisify(t.brotliDecompress):null};Bt.getBrotliDecompressAsync=FBe;var UBe=function(t){var e=Bt.isBrotliSupperted();return e&&typeof t.brotliDecompressSync=="function"?t.brotliDecompressSync:null};Bt.getBrotliDecompressSync=UBe;var BBe=function(t,e){var r=e||"utf8",n=!1;if(Buffer.isEncoding(r)){var o=Buffer.from(t.toString(r),r);n=o.toJSON().data.toString()===t.toJSON().data.toString()}return n};Bt.isBufferType=BBe;var qBe=function(t){var e=null;for(var r in Bt.bufferEncodingTypes){var n=Bt.bufferEncodingTypes[r];if(Buffer.isEncoding(n)&&Bt.isBufferType(t,n)){e=n;break}}return e};Bt.findBufferEncodingType=qBe;var HBe=function(t){var e=null;switch(t){case"gzip":e=ML.GZIP;break;case"br":e=ML.BR;break;case"deflate":e=ML.DEFLATE;break;default:}return e};Bt.isSupportedContentEncoding=HBe;var jBe=function(t){var e=[],r=t.getHeader("Content-Encoding");if(!r)return null;if(typeof r=="string"){var n=Bt.isSupportedContentEncoding(r);n&&e.push(n)}return e};Bt.getContentEncodingFromHeaders=jBe;var zBe=function(t,e,r){if(t<0)return null;var n=null,o=e.substring(0,t),s=e.substring(t);return n=o+'<script type="text/javascript">'+r+"</script>"+s,n};Bt.insertSnippetByIndex=zBe;var GBe=function(t){var e=!1,r=t.getHeader("Content-Type");return r&&(typeof r=="string"?e=r.indexOf("html")>=0:e=r.toString().indexOf("html")>=0),e};Bt.isContentTypeHeaderHtml=GBe});var yme=L(Bo=>{"use strict";Object.defineProperty(Bo,"__esModule",{value:!0});Bo.getResourceProvider=Bo.getOsPrefix=Bo.isFunctionApp=Bo.isWebApp=Bo.isLinux=Bo.isWindows=void 0;var VBe=function(){return process.platform==="win32"};Bo.isWindows=VBe;var $Be=function(){return process.platform==="linux"};Bo.isLinux=$Be;var WBe=function(){return!!process.env.WEBSITE_SITE_NAME};Bo.isWebApp=WBe;var KBe=function(){return!!process.env.FUNCTIONS_WORKER_RUNTIME};Bo.isFunctionApp=KBe;var YBe=function(){return Bo.isWindows()?"w":Bo.isLinux()?"l":"u"};Bo.getOsPrefix=YBe;var QBe=function(){return Bo.isWebApp()?"a":Bo.isFunctionApp()?"f":"u"};Bo.getResourceProvider=QBe});var $j=L((Iwt,_me)=>{"use strict";var bme=ni(),XBe=function(){function t(){}return t.parse=function(e){if(!e)return{};var r=e.split(t._FIELDS_SEPARATOR),n=r.reduce(function(s,a){var c=a.split(t._FIELD_KEY_VALUE_SEPARATOR);if(c.length===2){var u=c[0].toLowerCase(),l=c[1];s[u]=l}return s},{});if(Object.keys(n).length>0){if(n.endpointsuffix){var o=n.location?n.location+".":"";n.ingestionendpoint=n.ingestionendpoint||"https://"+o+"dc."+n.endpointsuffix,n.liveendpoint=n.liveendpoint||"https://"+o+"live."+n.endpointsuffix}n.ingestionendpoint=n.ingestionendpoint||bme.DEFAULT_BREEZE_ENDPOINT,n.liveendpoint=n.liveendpoint||bme.DEFAULT_LIVEMETRICS_ENDPOINT}return n},t.isIkeyValid=function(e){if(!e||e=="")return!1;var r="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",n=new RegExp(r);return n.test(e)},t._FIELDS_SEPARATOR=";",t._FIELD_KEY_VALUE_SEPARATOR="=",t}();_me.exports=XBe});var xme={};dn(xme,{webSnippet:()=>JBe});var JBe,Sme=R(()=>{JBe=`!function(T,l,y){var S=T.location,k="script",D="instrumentationKey",C="ingestionendpoint",I="disableExceptionTracking",E="ai.device.",b="toLowerCase",w="crossOrigin",N="POST",e="appInsightsSDK",t=y.name||"appInsights";(y.name||T[e])&&(T[e]=t);var n=T[t]||function(d){var g=!1,f=!1,m={initialize:!0,queue:[],sv:"5",version:2,config:d};function v(e,t){var n={},a="Browser";return n[E+"id"]=a[b](),n[E+"type"]=a,n["ai.operation.name"]=S&&S.pathname||"_unknown_",n["ai.internal.sdkVersion"]="javascript:snippet_"+(m.sv||m.version),{time:function(){var e=new Date;function t(e){var t=""+e;return 1===t.length&&(t="0"+t),t}return e.getUTCFullYear()+"-"+t(1+e.getUTCMonth())+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+((e.getUTCMilliseconds()/1e3).toFixed(3)+"").slice(2,5)+"Z"}(),iKey:e,name:"Microsoft.ApplicationInsights."+e.replace(/-/g,"")+"."+t,sampleRate:100,tags:n,data:{baseData:{ver:2}}}}var h=d.url||y.src;if(h){function a(e){var t,n,a,i,r,o,s,c,u,p,l;g=!0,m.queue=[],f||(f=!0,t=h,s=function(){var e={},t=d.connectionString;if(t)for(var n=t.split(";"),a=0;a<n.length;a++){var i=n[a].split("=");2===i.length&&(e[i[0][b]()]=i[1])}if(!e[C]){var r=e.endpointsuffix,o=r?e.location:null;e[C]="https://"+(o?o+".":"")+"dc."+(r||"services.visualstudio.com")}return e}(),c=s[D]||d[D]||"",u=s[C],p=u?u+"/v2/track":d.endpointUrl,(l=[]).push((n="SDK LOAD Failure: Failed to load Application Insights SDK script (See stack for details)",a=t,i=p,(o=(r=v(c,"Exception")).data).baseType="ExceptionData",o.baseData.exceptions=[{typeName:"SDKLoadFailed",message:n.replace(/\\./g,"-"),hasFullStack:!1,stack:n+"\\nSnippet failed to load ["+a+"] -- Telemetry is disabled\\nHelp Link: https://go.microsoft.com/fwlink/?linkid=2128109\\nHost: "+(S&&S.pathname||"_unknown_")+"\\nEndpoint: "+i,parsedStack:[]}],r)),l.push(function(e,t,n,a){var i=v(c,"Message"),r=i.data;r.baseType="MessageData";var o=r.baseData;return o.message='AI (Internal): 99 message:"'+("SDK LOAD Failure: Failed to load Application Insights SDK script (See stack for details) ("+n+")").replace(/\\"/g,"")+'"',o.properties={endpoint:a},i}(0,0,t,p)),function(e,t){if(JSON){var n=T.fetch;if(n&&!y.useXhr)n(t,{method:N,body:JSON.stringify(e),mode:"cors"});else if(XMLHttpRequest){var a=new XMLHttpRequest;a.open(N,t),a.setRequestHeader("Content-type","application/json"),a.send(JSON.stringify(e))}}}(l,p))}function i(e,t){f||setTimeout(function(){!t&&m.core||a()},500)}var e=function(){var n=l.createElement(k);n.src=h;var e=y[w];return!e&&""!==e||"undefined"==n[w]||(n[w]=e),n.onload=i,n.onerror=a,n.onreadystatechange=function(e,t){"loaded"!==n.readyState&&"complete"!==n.readyState||i(0,t)},n}();y.ld<0?l.getElementsByTagName("head")[0].appendChild(e):setTimeout(function(){l.getElementsByTagName(k)[0].parentNode.appendChild(e)},y.ld||0)}try{m.cookie=l.cookie}catch(p){}function t(e){for(;e.length;)!function(t){m[t]=function(){var e=arguments;g||m.queue.push(function(){m[t].apply(m,e)})}}(e.pop())}var n="track",r="TrackPage",o="TrackEvent";t([n+"Event",n+"PageView",n+"Exception",n+"Trace",n+"DependencyData",n+"Metric",n+"PageViewPerformance","start"+r,"stop"+r,"start"+o,"stop"+o,"addTelemetryInitializer","setAuthenticatedUserContext","clearAuthenticatedUserContext","flush"]),m.SeverityLevel={Verbose:0,Information:1,Warning:2,Error:3,Critical:4};var s=(d.extensionConfig||{}).ApplicationInsightsAnalytics||{};if(!0!==d[I]&&!0!==s[I]){var c="onerror";t(["_"+c]);var u=T[c];T[c]=function(e,t,n,a,i){var r=u&&u(e,t,n,a,i);return!0!==r&&m["_"+c]({message:e,url:t,lineNumber:n,columnNumber:a,error:i}),r},d.autoExceptionInstrumented=!0}return m}(y.cfg);function a(){y.onInit&&y.onInit(n)}(T[t]=n).queue&&0===n.queue.length?(n.queue.push(a),n.trackPageView({})):a()}(window,document,{\r
src: "https://js.monitor.azure.com/scripts/b/ai.2.min.js", // The SDK URL Source\r
// name: "appInsights", // Global SDK Instance name defaults to "appInsights" when not supplied\r
// ld: 0, // Defines the load delay (in ms) before attempting to load the sdk. -1 = block page load and add to head. (default) = 0ms load after timeout,\r
// useXhr: 1, // Use XHR instead of fetch to report failures (if available),\r
// crossOrigin: "anonymous", // When supplied this will add the provided value as the cross origin attribute on the script tag\r
// onInit: null, // Once the application insights instance has loaded and initialized this callback function will be called with 1 argument -- the sdk instance (DO NOT ADD anything to the sdk.queue -- As they won't get called)\r
cfg: { // Application Insights Configuration\r
    instrumentationKey: "INSTRUMENTATION_KEY"\r
}});`});var Rme=L((Cwt,wme)=>{"use strict";var Ime=require("http"),Cme=require("https"),Yx=require("zlib"),fd=Fn(),iu=vme(),Tme=yme(),Fw=ni(),Eme=$j(),ZBe=(Sme(),Gi(xme)),eqe=function(){function t(e){var r;if(this._isIkeyValid=!0,t.INSTANCE)throw new Error("Web snippet injection should be configured from the applicationInsights object");t.INSTANCE=this,t._aiUrl=Fw.WEB_INSTRUMENTATION_DEFAULT_SOURCE,t._aiDeprecatedUrl=Fw.WEB_INSTRUMENTATION_DEPRECATED_SOURCE;var n=this._getWebSnippetIkey((r=e.config)===null||r===void 0?void 0:r.webInstrumentationConnectionString);this._webInstrumentationIkey=n||e.config.instrumentationKey,this._clientWebInstrumentationConfig=e.config.webInstrumentationConfig,this._clientWebInstrumentationSrc=e.config.webInstrumentationSrc,this._statsbeat=e.getStatsbeat()}return t.prototype.enable=function(e,r){this._isEnabled=e,this._webInstrumentationIkey=this._getWebSnippetIkey(r)||this._webInstrumentationIkey,t._snippet=this._getWebInstrumentationReplacedStr(),this._isEnabled&&!this._isInitialized&&this._isIkeyValid?(this._statsbeat&&this._statsbeat.addFeature(Fw.StatsbeatFeature.WEB_SNIPPET),this._initialize()):this._isEnabled||this._statsbeat&&this._statsbeat.removeFeature(Fw.StatsbeatFeature.WEB_SNIPPET)},t.prototype.isInitialized=function(){return this._isInitialized},t.prototype._getWebSnippetIkey=function(e){var r=null;try{var n=Eme.parse(e),o=n.instrumentationkey||"";Eme.isIkeyValid(o)?(this._isIkeyValid=!0,r=o):(this._isIkeyValid=!1,fd.info("Invalid web Instrumentation connection string, web Instrumentation is not enabled."))}catch(s){fd.info("get web snippet ikey error: "+s)}return r},t.prototype._getWebInstrumentationReplacedStr=function(){var e=this._getClientWebInstrumentationConfigStr(this._clientWebInstrumentationConfig),r=Tme.getOsPrefix(),n=Tme.getResourceProvider(),o=this._webInstrumentationIkey+`",\r
`+e+` disableIkeyDeprecationMessage: true,\r
 sdkExtension: "`+n+r+"d_n_",s=ZBe.webSnippet.replace("INSTRUMENTATION_KEY",o);return this._clientWebInstrumentationSrc?s.replace(Fw.WEB_INSTRUMENTATION_DEFAULT_SOURCE+".2.min.js",this._clientWebInstrumentationSrc):s},t.prototype._getClientWebInstrumentationConfigStr=function(e){var r="";try{e!=null&&e.length>0&&e.forEach(function(n){var o=n.name;if(o!==void 0){var s=n.value,a="";switch(typeof s){case"function":break;case"object":break;case"string":a=" "+o+': "'+s+`",\r
`,r+=a;break;default:a=" "+o+": "+s+`,\r
`,r+=a;break}}})}catch{this._isEnabled=!1,fd.info("Parse client web instrumentation error. Web Instrumentation is disabled")}return r},t.prototype._initialize=function(){this._isInitialized=!0;var e=Ime.createServer,r=Cme.createServer,n=this._isEnabled;Ime.createServer=function(o){var s=o;return s&&(o=function(a,c){var u=c.write,l=a.method=="GET";c.write=function(f,m,h){try{if(n&&l){var g=iu.getContentEncodingFromHeaders(c),v=void 0;if(typeof m=="string"&&(v=m),g==null)t.INSTANCE.ValidateInjection(c,f)&&(arguments[0]=t.INSTANCE.InjectWebSnippet(c,f,void 0,v));else if(g.length){var y=g[0];arguments[0]=t.INSTANCE.InjectWebSnippet(c,f,y)}}}catch(_){fd.warn("Inject snippet error: "+_)}return u.apply(c,arguments)};var d=c.end;return c.end=function(f,m,h){if(n&&l)try{if(n&&l){var g=iu.getContentEncodingFromHeaders(c),v=void 0;if(typeof m=="string"&&(v=m),g==null)t.INSTANCE.ValidateInjection(c,f)&&(arguments[0]=t.INSTANCE.InjectWebSnippet(c,f,void 0,v));else if(g.length){var y=g[0];arguments[0]=t.INSTANCE.InjectWebSnippet(c,f,y)}}}catch(_){fd.warn("Inject snipet error: "+_)}return d.apply(c,arguments)},s(a,c)}),e(o)},Cme.createServer=function(o,s){var a=s;if(a)return s=function(c,u){var l=c.method=="GET",d=u.write,p=u.end;return u.write=function(m,h,g){try{if(n&&l){var v=iu.getContentEncodingFromHeaders(u),y=void 0;if(typeof h=="string"&&(y=h),v==null)t.INSTANCE.ValidateInjection(u,m)&&(arguments[0]=this.InjectWebSnippet(u,m,void 0,y));else if(v.length){var _=v[0];arguments[0]=t.INSTANCE.InjectWebSnippet(u,m,_)}}}catch(b){fd.warn("Inject snippet error: "+b)}return d.apply(u,arguments)},u.end=function(m,h,g){try{if(n&&l){var v=iu.getContentEncodingFromHeaders(u),y=void 0;if(typeof h=="string"&&(y=h),v==null)t.INSTANCE.ValidateInjection(u,m)&&(arguments[0]=t.INSTANCE.InjectWebSnippet(u,m,void 0,y));else if(v.length){var _=v[0];arguments[0]=t.INSTANCE.InjectWebSnippet(u,m,_)}}}catch(b){fd.warn("Inject snippet error: "+b)}return p.apply(u,arguments)},a(c,u)},r(o,s)}},t.prototype.ValidateInjection=function(e,r){try{if(!e||!r||e.statusCode!=200)return!1;var n=iu.isContentTypeHeaderHtml(e);if(!n)return!1;var o=r.slice().toString();if(o.indexOf("<head>")>=0&&o.indexOf("</head>")>=0&&o.indexOf(t._aiUrl)<0&&o.indexOf(t._aiDeprecatedUrl)<0)return!0}catch(s){fd.info("validate injections error: "+s)}return!1},t.prototype.InjectWebSnippet=function(e,r,n,o){try{var s=!!n;if(s)e.removeHeader("Content-Length"),r=this._getInjectedCompressBuffer(e,r,n),e.setHeader("Content-Length",r.length);else{var a=r.toString(),c=a.indexOf("</head>");if(c<0)return r;var u=iu.insertSnippetByIndex(c,a,t._snippet);if(typeof r=="string")e.removeHeader("Content-Length"),r=u,e.setHeader("Content-Length",Buffer.byteLength(r));else if(Buffer.isBuffer(r)){var l=o||"utf8",d=iu.isBufferType(r,l);if(d){e.removeHeader("Content-Length");var p=Buffer.from(u).toString(l);r=Buffer.from(p,l),e.setHeader("Content-Length",r.length)}}}}catch(f){fd.warn("Failed to inject web snippet and change content-lenght headers. Exception:"+f)}return r},t.prototype._getInjectedCompressBuffer=function(e,r,n){try{switch(n){case iu.contentEncodingMethod.GZIP:var o=Yx.gunzipSync(r);if(this.ValidateInjection(e,o)){var s=this.InjectWebSnippet(e,o);r=Yx.gzipSync(s)}break;case iu.contentEncodingMethod.DEFLATE:var a=Yx.inflateSync(r);if(this.ValidateInjection(e,a)){var c=this.InjectWebSnippet(e,a);r=Yx.deflateSync(c)}break;case iu.contentEncodingMethod.BR:var u=iu.getBrotliDecompressSync(Yx),l=iu.getBrotliCompressSync(Yx);if(u&&l){var d=u(r);if(this.ValidateInjection(e,d)){var p=this.InjectWebSnippet(e,d);r=l(p)}break}}}catch(f){fd.info("get web injection compress buffer error: "+f)}return r},t.prototype.dispose=function(){t.INSTANCE=null,this.enable(!1),this._isInitialized=!1},t}();wme.exports=eqe});var Ame=L((Kj,kme)=>{"use strict";var tqe=Kj&&Kj.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ou=require("url"),Wj=Os(),rqe=as(),nqe=xx(),iqe=wH(),oqe=G0(),sqe=function(t){tqe(e,t);function e(r,n){var o=t.call(this)||this;return n&&n.method&&r&&(o.method=n.method,o.url=e._getUrlFromRequestOptions(r,n),o.startTime=+new Date),o}return e.prototype.onError=function(r){this._setStatus(void 0,r)},e.prototype.onResponse=function(r){this._setStatus(r.statusCode,void 0),this.correlationId=rqe.getCorrelationContextTarget(r,nqe.requestContextTargetKey)},e.prototype.getDependencyTelemetry=function(r,n){var o=this.method.toUpperCase(),s=Wj.RemoteDependencyDataConstants.TYPE_HTTP,a="";try{var c=new ou.URL(this.url);c.search=void 0,c.hash=void 0,o+=" "+c.pathname,a=c.hostname,c.port&&(a+=":"+c.port)}catch{}this.correlationId?(s=Wj.RemoteDependencyDataConstants.TYPE_AI,this.correlationId!==oqe.correlationIdPrefix&&(a+=" | "+this.correlationId)):s=Wj.RemoteDependencyDataConstants.TYPE_HTTP;var u={id:n,name:o,data:this.url,duration:this.duration,success:this._isSuccess(),resultCode:this.statusCode?this.statusCode.toString():null,properties:this.properties||{},dependencyTypeName:s,target:a};if(r&&r.time?u.time=r.time:this.startTime&&(u.time=new Date(this.startTime)),r){for(var l in r)u[l]||(u[l]=r[l]);if(r.properties)for(var l in r.properties)u.properties[l]=r.properties[l]}return u},e._getUrlFromRequestOptions=function(r,n){if(typeof r=="string")if(r.indexOf("http://")===0||r.indexOf("https://")===0)try{r=new ou.URL(r)}catch{}else try{var o=new ou.URL("http://"+r);o.port==="443"?r=new ou.URL("https://"+r):r=new ou.URL("http://"+r)}catch{}else{if(r&&typeof ou.URL=="function"&&r instanceof ou.URL)return ou.format(r);var s=r;r={},s&&Object.keys(s).forEach(function(u){r[u]=s[u]})}if(r.path&&r.host)try{var a=new ou.URL(r.path,"http://"+r.host+r.path);r.pathname=a.pathname,r.search=a.search}catch{}if(r.path&&r.hostname&&!r.host)try{var a=new ou.URL(r.path,"http://"+r.hostname+r.path);r.pathname=a.pathname,r.search=a.search}catch{}if(r.host&&r.port)try{var c=new ou.URL("http://"+r.host);!c.port&&r.port&&(r.hostname=r.host,delete r.host)}catch{}return r.protocol=r.protocol||n.agent&&n.agent.protocol||n.protocol||void 0,r.hostname=r.hostname||"localhost",ou.format(r)},e}(iqe);kme.exports=sqe});var Pme=L(Qx=>{"use strict";var UL=Qx&&Qx.__assign||function(){return UL=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},UL.apply(this,arguments)};Object.defineProperty(Qx,"__esModule",{value:!0});Qx.parseEventHubSpan=void 0;var Yj=(gr(),Gi(dx)),aqe=(ia(),Gi(oue)),cqe=(el(),Gi(mq)),Uw=ni(),uqe=function(t){var e=0,r=0,n=aqe.hrTimeToMilliseconds(t.startTime);return t.links.forEach(function(o){var s=o.attributes,a=s?.[Uw.ENQUEUED_TIME];a&&(e+=1,r+=n-(parseFloat(a.toString())||0))}),Math.max(r/(e||1),0)},lqe=function(t,e){var r,n=t.attributes[Uw.AzNamespace],o=(t.attributes[cqe.SemanticAttributes.NET_PEER_NAME]||t.attributes["peer.address"]||"unknown").replace(/\/$/g,""),s=t.attributes[Uw.MessageBusDestination]||"unknown";switch(t.kind){case Yj.SpanKind.CLIENT:e.dependencyTypeName=n,e.target=o+"/"+s;break;case Yj.SpanKind.PRODUCER:e.dependencyTypeName=Uw.DependencyTypeName.QueueMessage+" | "+n,e.target=o+"/"+s;break;case Yj.SpanKind.CONSUMER:e.source=o+"/"+s,e.measurements=UL(UL({},e.measurements),(r={},r[Uw.TIME_SINCE_ENQUEUED]=uqe(t),r));break;default:}};Qx.parseEventHubSpan=lqe});var Lme=L(BL=>{"use strict";Object.defineProperty(BL,"__esModule",{value:!0});BL.spanToTelemetryContract=void 0;var Dme=require("url"),ol=(gr(),Gi(dx)),er=(el(),Gi(mq)),af=ni(),dqe=Pme(),pqe=as();function fqe(t){for(var e={},r=0,n=Object.keys(t.attributes);r<n.length;r++){var o=n[r];o.startsWith("http.")||o.startsWith("rpc.")||o.startsWith("db.")||o.startsWith("peer.")||o.startsWith("net.")||(e[o]=t.attributes[o])}var s=t.links.map(function(a){return{operation_Id:a.context.traceId,id:a.context.spanId}});return s.length>0&&(e["_MS.links"]=pqe.stringify(s)),e}function mqe(t){return t===er.DbSystemValues.DB2||t===er.DbSystemValues.DERBY||t===er.DbSystemValues.MARIADB||t===er.DbSystemValues.MSSQL||t===er.DbSystemValues.ORACLE||t===er.DbSystemValues.SQLITE||t===er.DbSystemValues.OTHER_SQL||t===er.DbSystemValues.HSQLDB||t===er.DbSystemValues.H2}function Nme(t){var e=t.attributes[er.SemanticAttributes.HTTP_METHOD];if(e){var r=t.attributes[er.SemanticAttributes.HTTP_URL];if(r)return String(r);var n=t.attributes[er.SemanticAttributes.HTTP_SCHEME],o=t.attributes[er.SemanticAttributes.HTTP_TARGET];if(n&&o){var s=t.attributes[er.SemanticAttributes.HTTP_HOST];if(s)return n+"://"+s+o;var a=t.attributes[er.SemanticAttributes.NET_PEER_PORT];if(a){var c=t.attributes[er.SemanticAttributes.NET_PEER_NAME];if(c)return n+"://"+c+":"+a+o;var u=t.attributes[er.SemanticAttributes.NET_PEER_IP];if(u)return n+"://"+u+":"+a+o}}}return""}function Qj(t){var e=t.attributes[er.SemanticAttributes.PEER_SERVICE],r=t.attributes[er.SemanticAttributes.HTTP_HOST],n=t.attributes[er.SemanticAttributes.HTTP_URL],o=t.attributes[er.SemanticAttributes.NET_PEER_NAME],s=t.attributes[er.SemanticAttributes.NET_PEER_IP];return e?String(e):r?String(r):n?String(n):o?String(o):s?String(s):""}function hqe(t){var e={name:t.name,success:t.status.code!=ol.SpanStatusCode.ERROR,resultCode:"0",duration:0,data:"",dependencyTypeName:""};t.kind===ol.SpanKind.PRODUCER&&(e.dependencyTypeName=af.DependencyTypeName.QueueMessage),t.kind===ol.SpanKind.INTERNAL&&t.parentSpanId&&(e.dependencyTypeName=af.DependencyTypeName.InProc);var r=t.attributes[er.SemanticAttributes.HTTP_METHOD],n=t.attributes[er.SemanticAttributes.DB_SYSTEM],o=t.attributes[er.SemanticAttributes.RPC_SYSTEM];if(r){e.dependencyTypeName=af.DependencyTypeName.Http;var s=t.attributes[er.SemanticAttributes.HTTP_URL];if(s){var a="";try{var c=new Dme.URL(String(s));a=c.pathname}catch{}e.name=r+" "+a}e.data=Nme(t);var u=t.attributes[er.SemanticAttributes.HTTP_STATUS_CODE];u&&(e.resultCode=String(u));var l=Qj(t);if(l){try{var d=new RegExp(/(https?)(:\/\/.*)(:\d+)(\S*)/),p=d.exec(l);if(p!=null){var f=p[1],m=p[3];(f=="https"&&m==":443"||f=="http"&&m==":80")&&(l=p[1]+p[2]+p[4])}}catch{}e.target=""+l}}else if(n){String(n)===er.DbSystemValues.MYSQL?e.dependencyTypeName="mysql":String(n)===er.DbSystemValues.POSTGRESQL?e.dependencyTypeName="postgresql":String(n)===er.DbSystemValues.MONGODB?e.dependencyTypeName="mongodb":String(n)===er.DbSystemValues.REDIS?e.dependencyTypeName="redis":mqe(String(n))?e.dependencyTypeName="SQL":e.dependencyTypeName=String(n);var h=t.attributes[er.SemanticAttributes.DB_STATEMENT],g=t.attributes[er.SemanticAttributes.DB_OPERATION];h?e.data=String(h):g&&(e.data=String(g));var l=Qj(t),v=t.attributes[er.SemanticAttributes.DB_NAME];l?e.target=v?l+"|"+v:""+l:e.target=v?""+v:""+n}else if(o){e.dependencyTypeName=af.DependencyTypeName.Grpc;var y=t.attributes[er.SemanticAttributes.RPC_GRPC_STATUS_CODE];y&&(e.resultCode=String(y));var l=Qj(t);l?e.target=""+l:o&&(e.target=String(o))}return e}function gqe(t){var e={name:t.name,success:t.status.code!=ol.SpanStatusCode.ERROR,resultCode:"0",duration:0,url:"",source:void 0},r=t.attributes[er.SemanticAttributes.HTTP_METHOD],n=t.attributes[er.SemanticAttributes.RPC_GRPC_STATUS_CODE];if(r){if(t.kind==ol.SpanKind.SERVER){var o=t.attributes[er.SemanticAttributes.HTTP_ROUTE],s=t.attributes[er.SemanticAttributes.HTTP_URL];if(o)e.name=r+" "+o;else if(s)try{var a=new Dme.URL(String(s));e.name=r+" "+a.pathname}catch{}}e.url=Nme(t);var c=t.attributes[er.SemanticAttributes.HTTP_STATUS_CODE];c&&(e.resultCode=String(c))}else n&&(e.resultCode=String(n));return e}function vqe(t){var e;switch(t.kind){case ol.SpanKind.CLIENT:case ol.SpanKind.PRODUCER:case ol.SpanKind.INTERNAL:e=hqe(t);break;case ol.SpanKind.SERVER:case ol.SpanKind.CONSUMER:e=gqe(t);break}var r=t.spanContext?t.spanContext():t.context(),n=""+r.spanId,o=Math.round(t.duration[0]*1e3+t.duration[1]/1e6);return e.id=n,e.duration=o,e.properties=fqe(t),t.attributes[af.AzNamespace]&&(t.kind===ol.SpanKind.INTERNAL&&(e.dependencyTypeName=af.DependencyTypeName.InProc+" | "+t.attributes[af.AzNamespace]),t.attributes[af.AzNamespace]===af.MicrosoftEventHub&&dqe.parseEventHubSpan(t,e)),e}BL.spanToTelemetryContract=vqe});var Mme=L(Ch=>{"use strict";var Xx=Ch&&Ch.__assign||function(){return Xx=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Xx.apply(this,arguments)};Object.defineProperty(Ch,"__esModule",{value:!0});Ch.AsyncScopeManager=Ch.OpenTelemetryScopeManagerWrapper=void 0;var Ih=bh(),yqe=require("events"),Ome=function(){function t(){}return t.prototype.active=function(){var e=this,r=Ih.CorrelationContextManager.getCurrentContext();return Xx(Xx({},r),{getValue:function(n){return e._activeSymbol?n===e._activeSymbol?r:!1:(e._activeSymbol=n,r)},setValue:function(){}})},t.prototype.with=function(e,r){var n=e.parentSpanId,o=e.name,s=t._spanToContext(e,n,o);return Ih.CorrelationContextManager.runWithContext(s,r)()},t.prototype.bind=function(e){return typeof e=="function"?Ih.CorrelationContextManager.wrapCallback(e):(e instanceof yqe.EventEmitter&&Ih.CorrelationContextManager.wrapEmitter(e),e)},t.prototype.enable=function(){return Ih.CorrelationContextManager.enable(),this},t.prototype.disable=function(){return Ih.CorrelationContextManager.disable(),this},t._spanToContext=function(e,r,n){var o=e.spanContext?e.spanContext():e.context(),s=Xx(Xx({},e.spanContext()),{traceFlags:e.spanContext().traceFlags}),a=r?"|"+o.traceId+"."+r+".":o.traceId,c=Ih.CorrelationContextManager.getCurrentContext();c&&(s.traceId=c.operation.id,r||(a=c.operation.parentId));var u=Ih.CorrelationContextManager.spanToContextObject(s,a,n);return u},t}();Ch.OpenTelemetryScopeManagerWrapper=Ome;Ch.AsyncScopeManager=new Ome});var Fme=L(Th=>{"use strict";Object.defineProperty(Th,"__esModule",{value:!0});Th.enable=Th.subscriber=void 0;var Bw=(gr(),Gi(dx)),bqe=ni(),Xj=_i(),_qe=Lme(),xqe=Mme(),ty=[],Sqe=function(t){try{var e=t.data,r=_qe.spanToTelemetryContract(e);xqe.AsyncScopeManager.with(e,function(){ty.forEach(function(n){e.kind===Bw.SpanKind.SERVER||e.kind===Bw.SpanKind.CONSUMER?n.trackRequest(r):(e.kind===Bw.SpanKind.CLIENT||e.kind===Bw.SpanKind.INTERNAL||e.kind===Bw.SpanKind.PRODUCER)&&n.trackDependency(r)})})}catch{}};Th.subscriber=Sqe;function Iqe(t,e){if(t){var r=ty.find(function(n){return n==e});if(r)return;ty.length===0&&Xj.channel.subscribe("azure-coretracing",Th.subscriber,Xj.trueFilter,function(n,o){var s=e.getStatsbeat();s&&s.addInstrumentation(bqe.StatsbeatInstrumentation.AZURE_CORE_TRACING)}),ty.push(e)}else ty=ty.filter(function(n){return n!=e}),ty.length===0&&Xj.channel.unsubscribe("azure-coretracing",Th.subscriber)}Th.enable=Iqe});var Ume=L(Eh=>{"use strict";Object.defineProperty(Eh,"__esModule",{value:!0});Eh.enable=Eh.subscriber=void 0;var Cqe=ni(),Jj=_i(),ry=[],Tqe=function(t){t.data.event.commandName!=="ismaster"&&ry.forEach(function(e){var r=t.data.startedData&&t.data.startedData.databaseName||"Unknown database";e.trackDependency({target:r,data:t.data.event.commandName,name:t.data.event.commandName,duration:t.data.event.duration,success:t.data.succeeded,resultCode:t.data.succeeded?"0":"1",time:t.data.startedData.time,dependencyTypeName:"mongodb"})})};Eh.subscriber=Tqe;function Eqe(t,e){if(t){var r=ry.find(function(n){return n==e});if(r)return;ry.length===0&&Jj.channel.subscribe("mongodb",Eh.subscriber,Jj.trueFilter,function(n,o){var s=e.getStatsbeat();s&&s.addInstrumentation(Cqe.StatsbeatInstrumentation.MONGODB)}),ry.push(e)}else ry=ry.filter(function(n){return n!=e}),ry.length===0&&Jj.channel.unsubscribe("mongodb",Eh.subscriber)}Eh.enable=Eqe});var Bme=L(wh=>{"use strict";Object.defineProperty(wh,"__esModule",{value:!0});wh.enable=wh.subscriber=void 0;var wqe=ni(),Zj=_i(),ny=[],Rqe=function(t){ny.forEach(function(e){var r=t.data.query||{},n=r.sql||"Unknown query",o=!t.data.err,s=r._connection||{},a=s.config||{},c=a.socketPath?a.socketPath:(a.host||"localhost")+":"+a.port;e.trackDependency({target:c,data:n,name:n,duration:t.data.duration,success:o,resultCode:o?"0":"1",time:t.data.time,dependencyTypeName:"mysql"})})};wh.subscriber=Rqe;function kqe(t,e){if(t){var r=ny.find(function(n){return n==e});if(r)return;ny.length===0&&Zj.channel.subscribe("mysql",wh.subscriber,Zj.trueFilter,function(n,o){var s=e.getStatsbeat();s&&s.addInstrumentation(wqe.StatsbeatInstrumentation.MYSQL)}),ny.push(e)}else ny=ny.filter(function(n){return n!=e}),ny.length===0&&Zj.channel.unsubscribe("mysql",wh.subscriber)}wh.enable=kqe});var qme=L(Rh=>{"use strict";Object.defineProperty(Rh,"__esModule",{value:!0});Rh.enable=Rh.subscriber=void 0;var Aqe=ni(),ez=_i(),iy=[],Pqe=function(t){iy.forEach(function(e){t.data.commandObj.command!=="info"&&e.trackDependency({target:t.data.address,name:t.data.commandObj.command,data:t.data.commandObj.command,duration:t.data.duration,success:!t.data.err,resultCode:t.data.err?"1":"0",time:t.data.time,dependencyTypeName:"redis"})})};Rh.subscriber=Pqe;function Dqe(t,e){if(t){var r=iy.find(function(n){return n==e});if(r)return;iy.length===0&&ez.channel.subscribe("redis",Rh.subscriber,ez.trueFilter,function(n,o){var s=e.getStatsbeat();s&&s.addInstrumentation(Aqe.StatsbeatInstrumentation.REDIS)}),iy.push(e)}else iy=iy.filter(function(n){return n!=e}),iy.length===0&&ez.channel.unsubscribe("redis",Rh.subscriber)}Rh.enable=Dqe});var Hme=L(kh=>{"use strict";Object.defineProperty(kh,"__esModule",{value:!0});kh.enable=kh.subscriber=void 0;var Nqe=ni(),tz=_i(),oy=[],Lqe=function(t){oy.forEach(function(e){var r=t.data.query,n=r.preparable&&r.preparable.text||r.plan||r.text||"unknown query",o=!t.data.error,s=t.data.database.host+":"+t.data.database.port;e.trackDependency({target:s,data:n,name:n,duration:t.data.duration,success:o,resultCode:o?"0":"1",time:t.data.time,dependencyTypeName:"postgres"})})};kh.subscriber=Lqe;function Oqe(t,e){if(t){var r=oy.find(function(n){return n==e});if(r)return;oy.length===0&&tz.channel.subscribe("postgres",kh.subscriber,tz.trueFilter,function(n,o){var s=e.getStatsbeat();s&&s.addInstrumentation(Nqe.StatsbeatInstrumentation.POSTGRES)}),oy.push(e)}else oy=oy.filter(function(n){return n!=e}),oy.length===0&&tz.channel.unsubscribe("postgres",kh.subscriber)}kh.enable=Oqe});var e1=L((nz,jme)=>{"use strict";var qL=nz&&nz.__spreadArrays||function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),o=0,e=0;e<r;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,o++)n[o]=s[a];return n},Jx=require("http"),Zx=require("https"),HL=Fn(),rz=as(),Ah=xx(),Mqe=Ame(),qw=bh(),jL=zN(),Fqe=jN(),Hw=G0(),Uqe=function(){function t(e){if(t.INSTANCE)throw new Error("Client request tracking should be configured from the applicationInsights object");t.INSTANCE=this,this._client=e}return t.prototype.enable=function(e){this._isEnabled=e,this._isEnabled&&!this._isInitialized&&this._initialize(),Fqe.IsInitialized&&(Fme().enable(e,this._client),Ume().enable(e,this._client),Bme().enable(e,this._client),qme().enable(e,this._client),Hme().enable(e,this._client))},t.prototype.isInitialized=function(){return this._isInitialized},t.prototype._initialize=function(){var e=this;this._isInitialized=!0;var r=Jx.request,n=Zx.request,o=function(s,a){try{var c=!a[t.disableCollectionRequestOption]&&!s[t.alreadyAutoCollectedFlag],u=null;if(a.headers&&(u=a.headers["User-Agent"]||a.headers["user-agent"],u&&u.toString().indexOf("azsdk-js")!==-1&&(c=!1)),s&&a&&c&&(qw.CorrelationContextManager.wrapEmitter(s),e._isEnabled))if(s[t.alreadyAutoCollectedFlag]=!0,qw.CorrelationContextManager.getCurrentContext())t.trackRequest(e._client,{options:a,request:s});else{var l=null;if(Hw.w3cEnabled){var d=new jL;l=d.traceId}else{var p=Hw.generateRequestId(null);l=Hw.getRootId(p)}var f=qw.CorrelationContextManager.generateContextObject(l);qw.CorrelationContextManager.runWithContext(f,function(){t.trackRequest(e._client,{options:a,request:s})})}}catch(m){HL.warn("Failed to generate dependency telemetry.",rz.dumpObj(m))}};Jx.request=function(s){for(var a=[],c=1;c<arguments.length;c++)a[c-1]=arguments[c];var u=r.call.apply(r,qL([Jx,s],a));return o(u,s),u},Zx.request=function(s){for(var a=[],c=1;c<arguments.length;c++)a[c-1]=arguments[c];var u=n.call.apply(n,qL([Zx,s],a));return o(u,s),u},Jx.get=function(s){for(var a,c=[],u=1;u<arguments.length;u++)c[u-1]=arguments[u];var l=(a=Jx.request).call.apply(a,qL([Jx,s],c));return l.end(),l},Zx.get=function(s){for(var a,c=[],u=1;u<arguments.length;u++)c[u-1]=arguments[u];var l=(a=Zx.request).call.apply(a,qL([Zx,s],c));return l.end(),l}},t.trackRequest=function(e,r){if(!r.options||!r.request||!e){HL.info("AutoCollectHttpDependencies.trackRequest was called with invalid parameters: ",!r.options,!r.request,!e);return}var n=new Mqe(r.options,r.request),o=qw.CorrelationContextManager.getCurrentContext(),s,a;if(o&&o.operation&&o.operation.traceparent&&jL.isValidTraceId(o.operation.traceparent.traceId))o.operation.traceparent.updateSpanId(),s=o.operation.traceparent.getBackCompatRequestId();else if(Hw.w3cEnabled){var c=new jL;a=c.toString(),s=c.getBackCompatRequestId()}else s=o&&o.operation&&o.operation.parentId+t.requestNumber+++".";if(rz.canIncludeCorrelationHeader(e,n.getUrl())&&r.request.getHeader&&r.request.setHeader&&e.config&&e.config.correlationId){var u=r.request.getHeader(Ah.requestContextHeader);try{rz.safeIncludeCorrelationHeader(e,r.request,u)}catch(p){HL.warn("Request-Context header could not be set. Correlation of requests may be lost",p)}if(o&&o.operation)try{if(r.request.setHeader(Ah.requestIdHeader,s),e.config.ignoreLegacyHeaders||(r.request.setHeader(Ah.parentIdHeader,o.operation.id),r.request.setHeader(Ah.rootIdHeader,s)),a||o.operation.traceparent)r.request.setHeader(Ah.traceparentHeader,a||o.operation.traceparent.toString());else if(Hw.w3cEnabled){var c=new jL().toString();r.request.setHeader(Ah.traceparentHeader,c)}if(o.operation.tracestate){var l=o.operation.tracestate.toString();l&&r.request.setHeader(Ah.traceStateHeader,l)}var d=o.customProperties.serializeToHeader();d&&r.request.setHeader(Ah.correlationContextHeader,d)}catch(p){HL.warn("Correlation headers could not be set. Correlation of requests may be lost.",p)}}r.request.on&&(r.request.on("response",function(p){if(!r.isProcessed){r.isProcessed=!0,n.onResponse(p);var f=n.getDependencyTelemetry(r,s);f.contextObjects=f.contextObjects||{},f.contextObjects["http.RequestOptions"]=r.options,f.contextObjects["http.ClientRequest"]=r.request,f.contextObjects["http.ClientResponse"]=p,e.trackDependency(f)}}),r.request.on("error",function(p){if(!r.isProcessed){r.isProcessed=!0,n.onError(p);var f=n.getDependencyTelemetry(r,s);f.contextObjects=f.contextObjects||{},f.contextObjects["http.RequestOptions"]=r.options,f.contextObjects["http.ClientRequest"]=r.request,f.contextObjects.Error=p,e.trackDependency(f)}}),r.request.on("abort",function(){if(!r.isProcessed){r.isProcessed=!0,n.onError(new Error("The request has been aborted and the network socket has closed."));var p=n.getDependencyTelemetry(r,s);p.contextObjects=p.contextObjects||{},p.contextObjects["http.RequestOptions"]=r.options,p.contextObjects["http.ClientRequest"]=r.request,e.trackDependency(p)}}))},t.prototype.dispose=function(){t.INSTANCE=null,this.enable(!1),this._isInitialized=!1},t.disableCollectionRequestOption="disableAppInsightsAutoCollection",t.requestNumber=1,t.alreadyAutoCollectedFlag="_appInsightsAutoCollected",t}();jme.exports=Uqe});var oz=L((Nwt,Wme)=>{"use strict";var zme=require("http"),Gme=require("https"),Vme=Fn(),$me=as(),Bqe=xx(),iz=PH(),cf=bh(),qqe=PL(),Hqe=function(){function t(e){if(t.INSTANCE)throw new Error("Server request tracking should be configured from the applicationInsights object");t.INSTANCE=this,this._client=e}return t.prototype.enable=function(e){this._isEnabled=e,(this._isAutoCorrelating||this._isEnabled||qqe.isEnabled())&&!this._isInitialized&&(this.useAutoCorrelation(this._isAutoCorrelating),this._initialize())},t.prototype.useAutoCorrelation=function(e,r){e&&!this._isAutoCorrelating?cf.CorrelationContextManager.enable(r):!e&&this._isAutoCorrelating&&cf.CorrelationContextManager.disable(),this._isAutoCorrelating=e},t.prototype.isInitialized=function(){return this._isInitialized},t.prototype.isAutoCorrelating=function(){return this._isAutoCorrelating},t.prototype._generateCorrelationContext=function(e){if(this._isAutoCorrelating)return cf.CorrelationContextManager.generateContextObject(e.getOperationId(this._client.context.tags),e.getRequestId(),e.getOperationName(this._client.context.tags),e.getCorrelationContextHeader(),e.getTraceparent(),e.getTracestate())},t.prototype._registerRequest=function(e,r,n){var o=this,s=new iz(e),a=this._generateCorrelationContext(s);cf.CorrelationContextManager.runWithContext(a,function(){o._isEnabled&&(e[t.alreadyAutoCollectedFlag]=!0,t.trackRequest(o._client,{request:e,response:r},s)),typeof n=="function"&&n(e,r)})},t.prototype._initialize=function(){if(this._isInitialized=!0,!t.HANDLER_READY){t.HANDLER_READY=!0;var e=function(s){if(s){if(typeof s!="function")throw new Error("onRequest handler must be a function");return function(a,c){cf.CorrelationContextManager.wrapEmitter(a),cf.CorrelationContextManager.wrapEmitter(c);var u=a&&!a[t.alreadyAutoCollectedFlag];a&&u&&t.INSTANCE?t.INSTANCE._registerRequest(a,c,s):s(a,c)}}},r=function(s){var a=s.addListener.bind(s);s.addListener=function(c,u){switch(c){case"request":case"checkContinue":return a(c,e(u));default:return a(c,u)}},s.on=s.addListener},n=zme.createServer;zme.createServer=function(s,a){if(a&&typeof a=="function"){var c=n(s,e(a));return r(c),c}else{var c=n(e(s));return r(c),c}};var o=Gme.createServer;Gme.createServer=function(s,a){var c=o(s,e(a));return r(c),c}}},t.trackRequestSync=function(e,r){if(!r.request||!r.response||!e){Vme.info("AutoCollectHttpRequests.trackRequestSync was called with invalid parameters: ",!r.request,!r.response,!e);return}r.isProcessed=!1,t.addResponseCorrelationIdHeader(e,r.response);var n=cf.CorrelationContextManager.getCurrentContext(),o=new iz(r.request,n&&n.operation.parentId);n&&(n.operation.id=o.getOperationId(e.context.tags)||n.operation.id,n.operation.name=o.getOperationName(e.context.tags)||n.operation.name,n.operation.parentId=o.getRequestId()||n.operation.parentId,n.customProperties.addHeaderData(o.getCorrelationContextHeader())),t.endRequest(e,o,r,r.duration,r.error)},t.trackRequest=function(e,r,n){if(!r.request||!r.response||!e){Vme.info("AutoCollectHttpRequests.trackRequest was called with invalid parameters: ",!r.request,!r.response,!e);return}r.isProcessed=!1;var o=cf.CorrelationContextManager.getCurrentContext(),s=n||new iz(r.request,o&&o.operation.parentId);$me.canIncludeCorrelationHeader(e,s.getUrl())&&t.addResponseCorrelationIdHeader(e,r.response),o&&!n&&(o.operation.id=s.getOperationId(e.context.tags)||o.operation.id,o.operation.name=s.getOperationName(e.context.tags)||o.operation.name,o.operation.parentId=s.getOperationParentId(e.context.tags)||o.operation.parentId,o.customProperties.addHeaderData(s.getCorrelationContextHeader())),r.response.once&&r.response.once("finish",function(){t.endRequest(e,s,r,null,null)}),r.request.on&&r.request.on("error",function(a){t.endRequest(e,s,r,null,a)}),r.request.on&&r.request.on("aborted",function(){var a="The request has been aborted and the network socket has closed.";t.endRequest(e,s,r,null,a)})},t.addResponseCorrelationIdHeader=function(e,r){if(e.config&&e.config.correlationId&&r.getHeader&&r.setHeader&&!r.headersSent){var n=r.getHeader(Bqe.requestContextHeader);$me.safeIncludeCorrelationHeader(e,r,n)}},t.endRequest=function(e,r,n,o,s){if(!n.isProcessed){n.isProcessed=!0,s?r.onError(s,o):r.onResponse(n.response,o);var a=r.getRequestTelemetry(n);if(a.tagOverrides=r.getRequestTags(e.context.tags),n.tagOverrides)for(var c in n.tagOverrides)a.tagOverrides[c]=n.tagOverrides[c];var u=r.getLegacyRootId();u&&(a.properties.ai_legacyRootId=u),a.contextObjects=a.contextObjects||{},a.contextObjects["http.ServerRequest"]=n.request,a.contextObjects["http.ServerResponse"]=n.response,e.trackRequest(a)}},t.prototype.dispose=function(){t.INSTANCE=null,this.enable(!1),this._isInitialized=!1,cf.CorrelationContextManager.disable(),this._isAutoCorrelating=!1},t.HANDLER_READY=!1,t.alreadyAutoCollectedFlag="_appInsightsAutoCollected",t}();Wme.exports=Hqe});var Qme=L((az,Yme)=>{"use strict";var su=az&&az.__assign||function(){return su=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},su.apply(this,arguments)},sz=require("os"),sy=Os(),Kme=ni(),jqe=as(),zqe=Fn(),Gqe=jqe.w3cTraceId(),Vqe=function(){function t(){}return t.createQuickPulseEnvelope=function(e,r,n,o){var s=sz&&typeof sz.hostname=="function"&&sz.hostname()||"Unknown",a=o.tags&&o.keys&&o.keys.cloudRoleInstance&&o.tags[o.keys.cloudRoleInstance]||s,c=o.tags&&o.keys&&o.keys.cloudRole&&o.tags[o.keys.cloudRole]||null,u={Documents:r.length>0?r:null,InstrumentationKey:n.instrumentationKey||"",Metrics:e.length>0?e:null,InvariantVersion:1,Timestamp:"/Date("+Date.now()+")/",Version:o.tags[o.keys.internalSdkVersion],StreamId:Gqe,MachineName:s,Instance:a,RoleName:c};return u},t.createQuickPulseMetric=function(e){var r;return r={Name:e.name,Value:e.value,Weight:e.count||1},r},t.telemetryEnvelopeToQuickPulseDocument=function(e){switch(e.data.baseType){case sy.TelemetryTypeString.Event:return t.createQuickPulseEventDocument(e);case sy.TelemetryTypeString.Exception:return t.createQuickPulseExceptionDocument(e);case sy.TelemetryTypeString.Trace:return t.createQuickPulseTraceDocument(e);case sy.TelemetryTypeString.Dependency:return t.createQuickPulseDependencyDocument(e);case sy.TelemetryTypeString.Request:return t.createQuickPulseRequestDocument(e)}return null},t.createQuickPulseEventDocument=function(e){var r=t.createQuickPulseDocument(e),n=e.data.baseData.name,o=su(su({},r),{Name:n});return o},t.createQuickPulseTraceDocument=function(e){var r=t.createQuickPulseDocument(e),n=e.data.baseData.severityLevel||0,o=su(su({},r),{Message:e.data.baseData.message,SeverityLevel:sy.SeverityLevel[n]});return o},t.createQuickPulseExceptionDocument=function(e){var r=t.createQuickPulseDocument(e),n=e.data.baseData.exceptions,o="",s="",a="";n&&n.length>0&&(n[0].parsedStack&&n[0].parsedStack.length>0?n[0].parsedStack.forEach(function(u){o+=u.assembly+`
`}):n[0].stack&&n[0].stack.length>0&&(o=n[0].stack),s=n[0].message,a=n[0].typeName);var c=su(su({},r),{Exception:o,ExceptionMessage:s,ExceptionType:a});return c},t.createQuickPulseRequestDocument=function(e){var r=t.createQuickPulseDocument(e),n=e.data.baseData,o=su(su({},r),{Name:n.name,Success:n.success,Duration:n.duration,ResponseCode:n.responseCode,OperationName:n.name});return o},t.createQuickPulseDependencyDocument=function(e){var r=t.createQuickPulseDocument(e),n=e.data.baseData,o=su(su({},r),{Name:n.name,Target:n.target,Success:n.success,Duration:n.duration,ResultCode:n.resultCode,CommandName:n.data,OperationName:r.OperationId,DependencyTypeName:n.type});return o},t.createQuickPulseDocument=function(e){var r,n,o,s;e.data.baseType?(n=Kme.TelemetryTypeStringToQuickPulseType[e.data.baseType],r=Kme.TelemetryTypeStringToQuickPulseDocumentType[e.data.baseType]):zqe.warn("Document type invalid; not sending live metric document",e.data.baseType),o=e.tags[t.keys.operationId],s=t.aggregateProperties(e);var a={DocumentType:r,__type:n,OperationId:o,Version:"1.0",Properties:s};return a},t.aggregateProperties=function(e){var r=[],n=e.data.baseData.measurements||{};for(var o in n)if(n.hasOwnProperty(o)){var s=n[o],a={key:o,value:s};r.push(a)}var c=e.data.baseData.properties||{};for(var o in c)if(c.hasOwnProperty(o)){var s=c[o],a={key:o,value:s};r.push(a)}return r},t.keys=new sy.ContextTagKeys,t}();Yme.exports=Vqe});var Jme=L((Lwt,Xme)=>{"use strict";var $qe=function(){return(Date.now()+621355968e5)*1e4};Xme.exports={getTransmissionTime:$qe}});var rhe=L((jw,the)=>{"use strict";var Zme=jw&&jw.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},ehe=jw&&jw.__generator||function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(d){return u([l,d])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=l[0]&2?o.return:l[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,l[1])).done)return s;switch(o=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(d){l=[6,d],o=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},Wqe=require("https"),Kqe=e1(),cz=Fn(),Yqe=Jme(),uz=as(),Qqe=require("url"),au={method:"POST",time:"x-ms-qps-transmission-time",pollingIntervalHint:"x-ms-qps-service-polling-interval-hint",endpointRedirect:"x-ms-qps-service-endpoint-redirect-v2",instanceName:"x-ms-qps-instance-name",streamId:"x-ms-qps-stream-id",machineName:"x-ms-qps-machine-name",roleName:"x-ms-qps-role-name",streamid:"x-ms-qps-stream-id",invariantVersion:"x-ms-qps-invariant-version",subscribed:"x-ms-qps-subscribed"},Xqe=function(){function t(e,r){this._config=e,this._consecutiveErrors=0,this._getAuthorizationHandler=r}return t.prototype.ping=function(e,r,n){var o=[{name:au.streamId,value:e.StreamId},{name:au.machineName,value:e.MachineName},{name:au.roleName,value:e.RoleName},{name:au.instanceName,value:e.Instance},{name:au.invariantVersion,value:e.InvariantVersion.toString()}];this._submitData(e,r,n,"ping",o)},t.prototype.post=function(e,r,n){return Zme(this,void 0,void 0,function(){return ehe(this,function(o){switch(o.label){case 0:return[4,this._submitData([e],r,n,"post")];case 1:return o.sent(),[2]}})})},t.prototype._submitData=function(e,r,n,o,s){return Zme(this,void 0,void 0,function(){var a,c,u,l,d,p,f,m,h=this;return ehe(this,function(g){switch(g.label){case 0:if(a=uz.stringify(e),c=(f={},f[Kqe.disableCollectionRequestOption]=!0,f.host=r&&r.length>0?r:this._config.quickPulseHost,f.method=au.method,f.path="/QuickPulseService.svc/"+o+"?ikey="+this._config.instrumentationKey,f.headers=(m={Expect:"100-continue"},m[au.time]=Yqe.getTransmissionTime(),m["Content-Type"]="application/json",m["Content-Length"]=Buffer.byteLength(a),m),f),s&&s.length>0&&s.forEach(function(v){return c.headers[v.name]=v.value}),o!=="post")return[3,4];if(u=this._getAuthorizationHandler?this._getAuthorizationHandler(this._config):null,!u)return[3,4];g.label=1;case 1:return g.trys.push([1,3,,4]),[4,u.addAuthorizationHeader(c)];case 2:return g.sent(),[3,4];case 3:return l=g.sent(),d="Failed to get AAD bearer token for the Application. Error:",cz.info(t.TAG,d,l),[2];case 4:return this._config.httpsAgent?c.agent=this._config.httpsAgent:c.agent=uz.tlsRestrictedAgent,p=Wqe.request(c,function(v){if(v.statusCode==200){var y=v.headers[au.subscribed]==="true",_=null;try{_=v.headers[au.endpointRedirect]?new Qqe.URL(v.headers[au.endpointRedirect].toString()).host:null}catch(S){h._onError("Failed to parse redirect header from QuickPulse: "+uz.dumpObj(S))}var b=v.headers[au.pollingIntervalHint]?parseInt(v.headers[au.pollingIntervalHint].toString()):null;h._consecutiveErrors=0,n(y,v,_,b)}else h._onError("StatusCode:"+v.statusCode+" StatusMessage:"+v.statusMessage),n()}),p.on("error",function(v){h._onError(v),n()}),p.write(a),p.end(),[2]}})})},t.prototype._onError=function(e){this._consecutiveErrors++;var r="Transient error connecting to the Live Metrics endpoint. This packet will not appear in your Live Metrics Stream. Error:";this._consecutiveErrors%t.MAX_QPS_FAILURES_BEFORE_WARN===0?(r="Live Metrics endpoint could not be reached "+this._consecutiveErrors+" consecutive times. Most recent error:",cz.warn(t.TAG,r,e)):cz.info(t.TAG,r,e)},t.TAG="QuickPulseSender",t.MAX_QPS_FAILURES_BEFORE_WARN=25,t}();the.exports=Xqe});var ahe=L((zw,she)=>{"use strict";var nhe=zw&&zw.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},ihe=zw&&zw.__generator||function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(d){return u([l,d])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=l[0]&2?o.return:l[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,l[1])).done)return s;switch(o=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(d){l=[6,d],o=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},ohe=Fn(),lz=Qme(),Jqe=rhe(),Zqe=ni(),eHe=Wx(),tHe=function(){function t(e,r,n){this._isCollectingData=!1,this._lastSuccessTime=Date.now(),this._lastSendSucceeded=!0,this._metrics={},this._documents=[],this._collectors=[],this._redirectedHost=null,this._pollingIntervalHint=-1,this.config=e,this.context=r||new eHe,this._sender=new Jqe(this.config,n),this._isEnabled=!1}return t.prototype.addCollector=function(e){this._collectors.push(e)},t.prototype.trackMetric=function(e){this._addMetric(e)},t.prototype.addDocument=function(e){if(this._isCollectingData){var r=lz.telemetryEnvelopeToQuickPulseDocument(e);r&&this._documents.push(r)}},t.prototype.enable=function(e){e&&!this._isEnabled?(this._isEnabled=!0,this._goQuickPulse()):!e&&this._isEnabled&&(this._isEnabled=!1,clearTimeout(this._handle),this._handle=void 0)},t.prototype.enableCollectors=function(e){this._collectors.forEach(function(r){r.enable(e)})},t.prototype._addMetric=function(e){var r=e.value,n=e.count||1,o=Zqe.PerformanceToQuickPulseCounter[e.name];o&&(this._metrics[o]?(this._metrics[o].Value=(this._metrics[o].Value*this._metrics[o].Weight+r*n)/(this._metrics[o].Weight+n),this._metrics[o].Weight+=n):(this._metrics[o]=lz.createQuickPulseMetric(e),this._metrics[o].Name=o,this._metrics[o].Weight=1))},t.prototype._resetQuickPulseBuffer=function(){delete this._metrics,this._metrics={},this._documents.length=0},t.prototype._goQuickPulse=function(){return nhe(this,void 0,void 0,function(){var e,r,n,o,s=this;return ihe(this,function(a){switch(a.label){case 0:return e=Object.keys(this._metrics).map(function(c){return s._metrics[c]}),r=lz.createQuickPulseEnvelope(e,this._documents.slice(),this.config,this.context),this._resetQuickPulseBuffer(),this._isCollectingData?[4,this._post(r)]:[3,2];case 1:return a.sent(),[3,3];case 2:this._ping(r),a.label=3;case 3:return n=this._pollingIntervalHint>0?this._pollingIntervalHint:t.PING_INTERVAL,o=this._isCollectingData?t.POST_INTERVAL:n,this._isCollectingData&&Date.now()-this._lastSuccessTime>=t.MAX_POST_WAIT_TIME&&!this._lastSendSucceeded?(this._isCollectingData=!1,o=t.FALLBACK_INTERVAL):!this._isCollectingData&&Date.now()-this._lastSuccessTime>=t.MAX_PING_WAIT_TIME&&!this._lastSendSucceeded&&(o=t.FALLBACK_INTERVAL),this._lastSendSucceeded=null,this._handle=setTimeout(this._goQuickPulse.bind(this),o),this._handle.unref(),[2]}})})},t.prototype._ping=function(e){this._sender.ping(e,this._redirectedHost,this._quickPulseDone.bind(this))},t.prototype._post=function(e){return nhe(this,void 0,void 0,function(){return ihe(this,function(r){switch(r.label){case 0:return[4,this._sender.post(e,this._redirectedHost,this._quickPulseDone.bind(this))];case 1:return r.sent(),[2]}})})},t.prototype._quickPulseDone=function(e,r,n,o){e!=null?(this._isCollectingData!==e&&(ohe.info("Live Metrics sending data",e),this.enableCollectors(e)),this._isCollectingData=e,n&&n.length>0&&(this._redirectedHost=n,ohe.info("Redirecting endpoint to: ",n)),o&&o>0&&(this._pollingIntervalHint=o),r&&r.statusCode<300&&r.statusCode>=200?(this._lastSuccessTime=Date.now(),this._lastSendSucceeded=!0):this._lastSendSucceeded=!1):this._lastSendSucceeded=!1},t.MAX_POST_WAIT_TIME=2e4,t.MAX_PING_WAIT_TIME=6e4,t.FALLBACK_INTERVAL=6e4,t.PING_INTERVAL=5e3,t.POST_INTERVAL=1e3,t}();she.exports=tHe});var che=L(t1=>{"use strict";var zL=t1&&t1.__assign||function(){return zL=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},zL.apply(this,arguments)};Object.defineProperty(t1,"__esModule",{value:!0});t1.AutoCollectNativePerformance=void 0;var Gw=Wx(),rHe=Fn(),nHe=function(){function t(e){this._disabledMetrics={},t.INSTANCE&&t.INSTANCE.dispose(),t.INSTANCE=this,this._client=e}return t.prototype.enable=function(e,r,n){var o=this;if(r===void 0&&(r={}),n===void 0&&(n=6e4),t._metricsAvailable==null&&e&&!this._isInitialized)try{var s=require("applicationinsights-native-metrics");t._emitter=new s,t._metricsAvailable=!0,rHe.info("Native metrics module successfully loaded!")}catch{t._metricsAvailable=!1;return}this._isEnabled=e,this._disabledMetrics=r,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),this._isEnabled&&t._emitter?(t._emitter.enable(!0,n),this._handle||(this._handle=setInterval(function(){return o._trackNativeMetrics()},n),this._handle.unref())):t._emitter&&(t._emitter.enable(!1),this._handle&&(clearInterval(this._handle),this._handle=void 0))},t.prototype.dispose=function(){this.enable(!1)},t.parseEnabled=function(e,r){var n=r.disableAllExtendedMetrics,o=r.extendedMetricDisablers;if(n)return{isEnabled:!1,disabledMetrics:{}};if(o){var s=o.split(","),a={};if(s.length>0)for(var c=0,u=s;c<u.length;c++){var l=u[c];a[l]=!0}return typeof e=="object"?{isEnabled:!0,disabledMetrics:zL(zL({},e),a)}:{isEnabled:e,disabledMetrics:a}}return typeof e=="boolean"?{isEnabled:e,disabledMetrics:{}}:{isEnabled:!0,disabledMetrics:e}},t.prototype._trackNativeMetrics=function(){var e=!0;typeof this._isEnabled!="object"&&(e=this._isEnabled),e&&(this._trackGarbageCollection(),this._trackEventLoop(),this._trackHeapUsage())},t.prototype._trackGarbageCollection=function(){var e;if(!this._disabledMetrics.gc){var r=t._emitter.getGCData();for(var n in r){var o=r[n].metrics,s=n+" Garbage Collection Duration",a=Math.sqrt(o.sumSquares/o.count-Math.pow(o.total/o.count,2))||0;this._client.trackMetric({name:s,value:o.total,count:o.count,max:o.max,min:o.min,stdDev:a,tagOverrides:(e={},e[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+Gw.sdkVersion,e)})}}},t.prototype._trackEventLoop=function(){var e;if(!this._disabledMetrics.loop){var r=t._emitter.getLoopData(),n=r.loopUsage;if(n.count!=0){var o="Event Loop CPU Time",s=Math.sqrt(n.sumSquares/n.count-Math.pow(n.total/n.count,2))||0;this._client.trackMetric({name:o,value:n.total,count:n.count,min:n.min,max:n.max,stdDev:s,tagOverrides:(e={},e[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+Gw.sdkVersion,e)})}}},t.prototype._trackHeapUsage=function(){var e,r,n;if(!this._disabledMetrics.heap){var o=process.memoryUsage(),s=o.heapUsed,a=o.heapTotal,c=o.rss;this._client.trackMetric({name:"Memory Usage (Heap)",value:s,count:1,tagOverrides:(e={},e[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+Gw.sdkVersion,e)}),this._client.trackMetric({name:"Memory Total (Heap)",value:a,count:1,tagOverrides:(r={},r[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+Gw.sdkVersion,r)}),this._client.trackMetric({name:"Memory Usage (Non-Heap)",value:c-a,count:1,tagOverrides:(n={},n[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+Gw.sdkVersion,n)})}},t}();t1.AutoCollectNativePerformance=nHe});var dhe=L(Ph=>{"use strict";var uhe=Ph&&Ph.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},lhe=Ph&&Ph.__generator||function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(d){return u([l,d])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=l[0]&2?o.return:l[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,l[1])).done)return s;switch(o=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(d){l=[6,d],o=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(Ph,"__esModule",{value:!0});Ph.AzureFunctionsHook=void 0;var GL=Fn(),dz=bh(),iHe=function(){function t(e){this._client=e,this._autoGenerateIncomingRequests=!1;try{this._functionsCoreModule=require("@azure/functions-core"),this._addPreInvocationHook(),this._addPostInvocationHook()}catch{GL.info("AzureFunctionsHook failed to load, not running in Azure Functions")}}return t.prototype._getFuncModelHelper=function(){if(this._cachedModelHelper===void 0){var e=this._functionsCoreModule.getProgrammingModel();e.name==="@azure/functions"&&(e.version.startsWith("3.")?this._cachedModelHelper=new oHe:e.version.startsWith("4.")&&(this._cachedModelHelper=new sHe)),this._cachedModelHelper||(this._cachedModelHelper=null,GL.warn('AzureFunctionsHook does not support model "'+e.name+'" version "'+e.version+'"'))}return this._cachedModelHelper},t.prototype.enable=function(e){this._autoGenerateIncomingRequests=e},t.prototype.dispose=function(){this.enable(!1),this._removeInvocationHooks(),this._functionsCoreModule=void 0},t.prototype._addPreInvocationHook=function(){var e=this;this._preInvocationHook||(this._preInvocationHook=this._functionsCoreModule.registerHook("preInvocation",function(r){return uhe(e,void 0,void 0,function(){var n,o,s,a;return lhe(this,function(c){try{n=this._getFuncModelHelper(),n&&(o=r.invocationContext,s=dz.CorrelationContextManager.startOperation(o),s&&(s.customProperties.setProperty("InvocationId",o.invocationId),a=o.traceContext,a.attributes&&(s.customProperties.setProperty("ProcessId",a.attributes.ProcessId),s.customProperties.setProperty("LogLevel",a.attributes.LogLevel),s.customProperties.setProperty("Category",a.attributes.Category),s.customProperties.setProperty("HostInstanceId",a.attributes.HostInstanceId),s.customProperties.setProperty("AzFuncLiveLogsSessionId",a.attributes["#AzFuncLiveLogsSessionId"])),r.functionCallback=dz.CorrelationContextManager.wrapCallback(r.functionCallback,s),n.isHttpTrigger(r)&&this._autoGenerateIncomingRequests&&(r.hookData.appInsightsExtractedContext=s,r.hookData.appInsightsStartTime=Date.now())))}catch(u){return GL.warn("Failed to propagate context in Azure Functions",u),[2]}return[2]})})}))},t.prototype._addPostInvocationHook=function(){var e=this;this._postInvocationHook||(this._postInvocationHook=this._functionsCoreModule.registerHook("postInvocation",function(r){return uhe(e,void 0,void 0,function(){var n,o,s,a,c=this;return lhe(this,function(u){try{n=this._getFuncModelHelper(),n&&this._autoGenerateIncomingRequests&&n.isHttpTrigger(r)&&(o=r.inputs[0],o&&(s=r.hookData.appInsightsStartTime||Date.now(),a=r.hookData.appInsightsExtractedContext,a?dz.CorrelationContextManager.runWithContext(a,function(){c._createIncomingRequestTelemetry(o,r,s,a.operation.parentId)}):this._createIncomingRequestTelemetry(o,r,s,null)))}catch(l){GL.warn("Error creating automatic incoming request in Azure Functions",l)}return[2]})})}))},t.prototype._createIncomingRequestTelemetry=function(e,r,n,o){var s=this._getFuncModelHelper().getStatusCodes(r),a=200;if(s)for(var c=0,u=s;c<u.length;c++){var l=u[c];if(typeof l=="number"&&Number.isInteger(l)){a=l;break}else if(typeof l=="string"){var d=parseInt(l);if(!isNaN(d)){a=d;break}}}else a=void 0;this._client.trackRequest({name:e.method+" "+e.url,resultCode:a,success:typeof a=="number"?0<a&&a<400:void 0,url:e.url,time:new Date(n),duration:Date.now()-n,id:o}),this._client.flush()},t.prototype._removeInvocationHooks=function(){this._preInvocationHook&&(this._preInvocationHook.dispose(),this._preInvocationHook=void 0),this._postInvocationHook&&(this._postInvocationHook.dispose(),this._postInvocationHook=void 0)},t}();Ph.AzureFunctionsHook=iHe;var oHe=function(){function t(){}return t.prototype._getInvocationContext=function(e){return e.invocationContext},t.prototype.getStatusCodes=function(e){var r=this._getInvocationContext(e),n,o=r.bindingDefinitions.find(function(s){return s.direction==="out"&&s.type.toLowerCase()==="http"});return o?.name==="$return"?n=e.result:o&&r.bindings&&r.bindings[o.name]!==void 0?n=r.bindings[o.name]:n=r.res,n?[n.statusCode,n.status]:void 0},t.prototype.isHttpTrigger=function(e){var r=this._getInvocationContext(e);return!!r.bindingDefinitions.find(function(n){var o;return((o=n.type)===null||o===void 0?void 0:o.toLowerCase())==="httptrigger"})},t}(),sHe=function(){function t(){}return t.prototype._getInvocationContext=function(e){return e.invocationContext},t.prototype.getStatusCodes=function(e){var r=e.result;return r?[r.status]:void 0},t.prototype.isHttpTrigger=function(e){var r=this._getInvocationContext(e);return r.options.trigger.type.toLowerCase()==="httptrigger"},t}()});var pz=L((Fwt,mhe)=>{"use strict";var aHe=G0(),phe=$j(),cHe=Fn(),fhe=ni(),uHe=require("url"),lHe=MD(),dHe=function(){function t(e){this._endpointBase=fhe.DEFAULT_BREEZE_ENDPOINT,this._mergeConfig();var r=this._connectionString,n=phe.parse(e),o=phe.parse(r),s=!n.instrumentationkey&&Object.keys(n).length>0?null:e,a=this._instrumentationKey;this.instrumentationKey=n.instrumentationkey||s||o.instrumentationkey||a;var c=""+(this.endpointUrl||n.ingestionendpoint||o.ingestionendpoint||this._endpointBase);c.endsWith("/")&&(c=c.slice(0,-1)),this.endpointUrl=c+"/v2.1/track",this.maxBatchSize=this.maxBatchSize||250,this.maxBatchIntervalMs=this.maxBatchIntervalMs||15e3,this.disableAppInsights=this.disableAppInsights||!1,this.samplingPercentage=this.samplingPercentage||100,this.correlationIdRetryIntervalMs=this.correlationIdRetryIntervalMs||30*1e3,this.enableWebInstrumentation=this.enableWebInstrumentation||this.enableAutoWebSnippetInjection||!1,this.webInstrumentationConfig=this.webInstrumentationConfig||null,this.enableAutoWebSnippetInjection=this.enableWebInstrumentation,this.correlationHeaderExcludedDomains=this.correlationHeaderExcludedDomains||["*.core.windows.net","*.core.chinacloudapi.cn","*.core.cloudapi.de","*.core.usgovcloudapi.net","*.core.microsoft.scloud","*.core.eaglex.ic.gov"],this.ignoreLegacyHeaders=this.ignoreLegacyHeaders||!1,this.profileQueryEndpoint=n.ingestionendpoint||o.ingestionendpoint||process.env[t.ENV_profileQueryEndpoint]||this._endpointBase,this.quickPulseHost=this.quickPulseHost||n.liveendpoint||o.liveendpoint||process.env[t.ENV_quickPulseHost]||fhe.DEFAULT_LIVEMETRICS_HOST,this.webInstrumentationConnectionString=this.webInstrumentationConnectionString||this._webInstrumentationConnectionString||"",this.webSnippetConnectionString=this.webInstrumentationConnectionString,this.quickPulseHost.match(/^https?:\/\//)&&(this.quickPulseHost=new uHe.URL(this.quickPulseHost).host),this.aadAudience=n.aadaudience||o.aadaudience}return Object.defineProperty(t.prototype,"profileQueryEndpoint",{get:function(){return this._profileQueryEndpoint},set:function(e){this._profileQueryEndpoint=e,this.correlationId=aHe.correlationIdPrefix},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"instrumentationKey",{get:function(){return this._instrumentationKey},set:function(e){t._validateInstrumentationKey(e)||cHe.warn("An invalid instrumentation key was provided. There may be resulting telemetry loss",this.instrumentationKey),this._instrumentationKey=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"webSnippetConnectionString",{get:function(){return this._webInstrumentationConnectionString},set:function(e){this._webInstrumentationConnectionString=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"webInstrumentationConnectionString",{get:function(){return this._webInstrumentationConnectionString},set:function(e){this._webInstrumentationConnectionString=e},enumerable:!1,configurable:!0}),t.prototype._mergeConfig=function(){var e=lHe.JsonConfig.getInstance();this._connectionString=e.connectionString,this._instrumentationKey=e.instrumentationKey,this.correlationHeaderExcludedDomains=e.correlationHeaderExcludedDomains,this.correlationIdRetryIntervalMs=e.correlationIdRetryIntervalMs,this.disableAllExtendedMetrics=e.disableAllExtendedMetrics,this.disableAppInsights=e.disableAppInsights,this.disableStatsbeat=e.disableStatsbeat,this.distributedTracingMode=e.distributedTracingMode,this.enableAutoCollectConsole=e.enableAutoCollectConsole,this.enableLoggerErrorToTrace=e.enableLoggerErrorToTrace,this.enableAutoCollectDependencies=e.enableAutoCollectDependencies,this.enableAutoCollectIncomingRequestAzureFunctions=e.enableAutoCollectIncomingRequestAzureFunctions,this.enableAutoCollectExceptions=e.enableAutoCollectExceptions,this.enableAutoCollectExtendedMetrics=e.enableAutoCollectExtendedMetrics,this.enableAutoCollectExternalLoggers=e.enableAutoCollectExternalLoggers,this.enableAutoCollectHeartbeat=e.enableAutoCollectHeartbeat,this.enableAutoCollectPerformance=e.enableAutoCollectPerformance,this.enableAutoCollectPreAggregatedMetrics=e.enableAutoCollectPreAggregatedMetrics,this.enableAutoCollectRequests=e.enableAutoCollectRequests,this.enableAutoDependencyCorrelation=e.enableAutoDependencyCorrelation,this.enableInternalDebugLogging=e.enableInternalDebugLogging,this.enableInternalWarningLogging=e.enableInternalWarningLogging,this.enableResendInterval=e.enableResendInterval,this.enableMaxBytesOnDisk=e.enableMaxBytesOnDisk,this.enableSendLiveMetrics=e.enableSendLiveMetrics,this.enableUseAsyncHooks=e.enableUseAsyncHooks,this.enableUseDiskRetryCaching=e.enableUseDiskRetryCaching,this.endpointUrl=e.endpointUrl,this.extendedMetricDisablers=e.extendedMetricDisablers,this.ignoreLegacyHeaders=e.ignoreLegacyHeaders,this.maxBatchIntervalMs=e.maxBatchIntervalMs,this.maxBatchSize=e.maxBatchSize,this.proxyHttpUrl=e.proxyHttpUrl,this.proxyHttpsUrl=e.proxyHttpsUrl,this.quickPulseHost=e.quickPulseHost,this.samplingPercentage=e.samplingPercentage,this.enableWebInstrumentation=e.enableWebInstrumentation,this._webInstrumentationConnectionString=e.webInstrumentationConnectionString,this.webInstrumentationConfig=e.webInstrumentationConfig,this.webInstrumentationSrc=e.webInstrumentationSrc},t._validateInstrumentationKey=function(e){var r="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",n=new RegExp(r);return n.test(e)},t.ENV_azurePrefix="APPSETTING_",t.ENV_iKey="APPINSIGHTS_INSTRUMENTATIONKEY",t.legacy_ENV_iKey="APPINSIGHTS_INSTRUMENTATION_KEY",t.ENV_profileQueryEndpoint="APPINSIGHTS_PROFILE_QUERY_ENDPOINT",t.ENV_quickPulseHost="APPINSIGHTS_QUICKPULSE_HOST",t}();mhe.exports=dHe});function VL(){return fz.create()}var hhe,fz,mz=R(()=>{hhe=new Set(["Deserialize","Serialize","Retry","Sign"]),fz=class t{constructor(e){var r;this._policies=[],this._policies=(r=e?.slice(0))!==null&&r!==void 0?r:[],this._orderedPolicies=void 0}addPolicy(e,r={}){if(r.phase&&r.afterPhase)throw new Error("Policies inside a phase cannot specify afterPhase.");if(r.phase&&!hhe.has(r.phase))throw new Error(`Invalid phase name: ${r.phase}`);if(r.afterPhase&&!hhe.has(r.afterPhase))throw new Error(`Invalid afterPhase name: ${r.afterPhase}`);this._policies.push({policy:e,options:r}),this._orderedPolicies=void 0}removePolicy(e){let r=[];return this._policies=this._policies.filter(n=>e.name&&n.policy.name===e.name||e.phase&&n.options.phase===e.phase?(r.push(n.policy),!1):!0),this._orderedPolicies=void 0,r}sendRequest(e,r){return this.getOrderedPolicies().reduceRight((s,a)=>c=>a.sendRequest(c,s),s=>e.sendRequest(s))(r)}getOrderedPolicies(){return this._orderedPolicies||(this._orderedPolicies=this.orderPolicies()),this._orderedPolicies}clone(){return new t(this._policies)}static create(){return new t}orderPolicies(){let e=[],r=new Map;function n(h){return{name:h,policies:new Set,hasRun:!1,hasAfterPolicies:!1}}let o=n("Serialize"),s=n("None"),a=n("Deserialize"),c=n("Retry"),u=n("Sign"),l=[o,s,a,c,u];function d(h){return h==="Retry"?c:h==="Serialize"?o:h==="Deserialize"?a:h==="Sign"?u:s}for(let h of this._policies){let g=h.policy,v=h.options,y=g.name;if(r.has(y))throw new Error("Duplicate policy names not allowed in pipeline");let _={policy:g,dependsOn:new Set,dependants:new Set};v.afterPhase&&(_.afterPhase=d(v.afterPhase),_.afterPhase.hasAfterPolicies=!0),r.set(y,_),d(v.phase).policies.add(_)}for(let h of this._policies){let{policy:g,options:v}=h,y=g.name,_=r.get(y);if(!_)throw new Error(`Missing node for policy ${y}`);if(v.afterPolicies)for(let b of v.afterPolicies){let S=r.get(b);S&&(_.dependsOn.add(S),S.dependants.add(_))}if(v.beforePolicies)for(let b of v.beforePolicies){let S=r.get(b);S&&(S.dependsOn.add(_),_.dependants.add(S))}}function p(h){h.hasRun=!0;for(let g of h.policies)if(!(g.afterPhase&&(!g.afterPhase.hasRun||g.afterPhase.policies.size))&&g.dependsOn.size===0){e.push(g.policy);for(let v of g.dependants)v.dependsOn.delete(g);r.delete(g.policy.name),h.policies.delete(g)}}function f(){for(let h of l){if(p(h),h.policies.size>0&&h!==s){s.hasRun||p(s);return}h.hasAfterPolicies&&p(s)}}let m=0;for(;r.size>0;){m++;let h=e.length;if(f(),e.length<=h&&m>1)throw new Error("Cannot satisfy policy dependencies due to requirements cycle.")}return e}}});function yhe(t,...e){process.stderr.write(`${vhe.default.format(t,...e)}${ghe.EOL}`)}var ghe,vhe,bhe=R(()=>{ghe=require("os"),vhe=W(require("util"))});function vz(t){xhe=t,hz=[],gz=[];let e=/\*/g,r=t.split(",").map(n=>n.trim().replace(e,".*?"));for(let n of r)n.startsWith("-")?gz.push(new RegExp(`^${n.substr(1)}$`)):hz.push(new RegExp(`^${n}$`));for(let n of $L)n.enabled=yz(n.namespace)}function yz(t){if(t.endsWith("*"))return!0;for(let e of gz)if(e.test(t))return!1;for(let e of hz)if(e.test(t))return!0;return!1}function pHe(){let t=xhe||"";return vz(""),t}function Ihe(t){let e=Object.assign(r,{enabled:yz(t),destroy:fHe,log:She.log,namespace:t,extend:mHe});function r(...n){e.enabled&&(n.length>0&&(n[0]=`${t} ${n[0]}`),e.log(...n))}return $L.push(e),e}function fHe(){let t=$L.indexOf(this);return t>=0?($L.splice(t,1),!0):!1}function mHe(t){let e=Ihe(`${this.namespace}:${t}`);return e.log=this.log,e}var _he,xhe,hz,gz,$L,She,r1,Che=R(()=>{bhe();_he=typeof process<"u"&&process.env&&process.env.DEBUG||void 0,hz=[],gz=[],$L=[];_he&&vz(_he);She=Object.assign(t=>Ihe(t),{enable:vz,enabled:yz,disable:pHe,log:yhe});r1=She});function hHe(t){if(t&&!khe(t))throw new Error(`Unknown log level '${t}'. Acceptable values: ${xz.join(",")}`);bz=t;let e=[];for(let r of Ehe)Rhe(r)&&e.push(r.namespace);r1.enable(e.join(","))}function YL(t){let e=_z.extend(t);return whe(_z,e),{error:KL(e,"error"),warning:KL(e,"warning"),info:KL(e,"info"),verbose:KL(e,"verbose")}}function whe(t,e){e.log=(...r)=>{t.log(...r)}}function KL(t,e){let r=Object.assign(t.extend(e),{level:e});if(whe(t,r),Rhe(r)){let n=r1.disable();r1.enable(n+","+r.namespace)}return Ehe.add(r),r}function Rhe(t){return!!(bz&&The[t.level]<=The[bz])}function khe(t){return xz.includes(t)}var Ehe,WL,bz,_z,xz,The,Sz=R(()=>{Che();Ehe=new Set,WL=typeof process<"u"&&process.env&&process.env.AZURE_LOG_LEVEL||void 0,_z=r1("azure");_z.log=(...t)=>{r1.log(...t)};xz=["verbose","info","warning","error"];WL&&(khe(WL)?hHe(WL):console.error(`AZURE_LOG_LEVEL set to unknown log level '${WL}'; logging is not enabled. Acceptable values: ${xz.join(", ")}.`));The={verbose:400,info:300,warning:200,error:100}});var ds,n1=R(()=>{Sz();ds=YL("core-rest-pipeline")});var Iz,QL,Ahe=R(()=>{QL=typeof process<"u"&&!!process.version&&!!(!((Iz=process.versions)===null||Iz===void 0)&&Iz.node)});function Cz(t){if(t.aborted)return;t.onabort&&t.onabort.call(t);let e=i1.get(t);e&&e.slice().forEach(r=>{r.call(t,{type:"abort"})}),XL.set(t,!0)}var i1,XL,Vw,Phe=R(()=>{i1=new WeakMap,XL=new WeakMap,Vw=class t{constructor(){this.onabort=null,i1.set(this,[]),XL.set(this,!1)}get aborted(){if(!XL.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");return XL.get(this)}static get none(){return new t}addEventListener(e,r){if(!i1.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");i1.get(this).push(r)}removeEventListener(e,r){if(!i1.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");let n=i1.get(this),o=n.indexOf(r);o>-1&&n.splice(o,1)}dispatchEvent(e){throw new Error("This is a stub dispatchEvent implementation that should not be used.  It only exists for type-checking purposes.")}}});var md,$w,Dhe=R(()=>{Phe();md=class extends Error{constructor(e){super(e),this.name="AbortError"}},$w=class{constructor(e){if(this._signal=new Vw,!!e){Array.isArray(e)||(e=arguments);for(let r of e)r.aborted?this.abort():r.addEventListener("abort",()=>{this.abort()})}}get signal(){return this._signal}abort(){Cz(this._signal)}static timeout(e){let r=new Vw,n=setTimeout(Cz,e,r);return typeof n.unref=="function"&&n.unref(),r}}});var JL=R(()=>{Dhe()});function Tz(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t}var Nhe=R(()=>{});function Ww(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)&&!(t instanceof RegExp)&&!(t instanceof Date)}var Ez=R(()=>{});function o1(t){if(Ww(t)){let e=typeof t.name=="string",r=typeof t.message=="string";return e&&r}return!1}function s1(t){if(o1(t))return t.message;{let e;try{typeof t=="object"&&t?e=JSON.stringify(t):e=String(t)}catch{e="[unable to stringify input]"}return`Unknown error ${e}`}}var Lhe=R(()=>{Ez()});var a1=R(()=>{Ahe();Nhe();Ez();Lhe()});var wz,gHe,vHe,c1,Rz=R(()=>{a1();wz="REDACTED",gHe=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent","WWW-Authenticate"],vHe=["api-version"],c1=class{constructor({additionalAllowedHeaderNames:e=[],additionalAllowedQueryParameters:r=[]}={}){e=gHe.concat(e),r=vHe.concat(r),this.allowedHeaderNames=new Set(e.map(n=>n.toLowerCase())),this.allowedQueryParameters=new Set(r.map(n=>n.toLowerCase()))}sanitize(e){let r=new Set;return JSON.stringify(e,(n,o)=>{if(o instanceof Error)return Object.assign(Object.assign({},o),{name:o.name,message:o.message});if(n==="headers")return this.sanitizeHeaders(o);if(n==="url")return this.sanitizeUrl(o);if(n==="query")return this.sanitizeQuery(o);if(n==="body")return;if(n==="response")return;if(n==="operationSpec")return;if(Array.isArray(o)||Ww(o)){if(r.has(o))return"[Circular]";r.add(o)}return o},2)}sanitizeHeaders(e){let r={};for(let n of Object.keys(e))this.allowedHeaderNames.has(n.toLowerCase())?r[n]=e[n]:r[n]=wz;return r}sanitizeQuery(e){if(typeof e!="object"||e===null)return e;let r={};for(let n of Object.keys(e))this.allowedQueryParameters.has(n.toLowerCase())?r[n]=e[n]:r[n]=wz;return r}sanitizeUrl(e){if(typeof e!="string"||e===null)return e;let r=new URL(e);if(!r.search)return e;for(let[n]of r.searchParams)this.allowedQueryParameters.has(n.toLowerCase())||r.searchParams.set(n,wz);return r.toString()}}});function ZL(t={}){var e;let r=(e=t.logger)!==null&&e!==void 0?e:ds.info,n=new c1({additionalAllowedHeaderNames:t.additionalAllowedHeaderNames,additionalAllowedQueryParameters:t.additionalAllowedQueryParameters});return{name:kz,async sendRequest(o,s){if(!r.enabled)return s(o);r(`Request: ${n.sanitize(o)}`);let a=await s(o);return r(`Response status code: ${a.status}`),r(`Headers: ${n.sanitize(a.headers)}`),a}}}var kz,Az=R(()=>{n1();Rz();kz="logPolicy"});function e4(t={}){let{maxRetries:e=20}=t;return{name:Pz,async sendRequest(r,n){let o=await n(r);return Mhe(n,o,e)}}}async function Mhe(t,e,r,n=0){let{request:o,status:s,headers:a}=e,c=a.get("location");if(c&&(s===300||s===301&&Ohe.includes(o.method)||s===302&&Ohe.includes(o.method)||s===303&&o.method==="POST"||s===307)&&n<r){let u=new URL(c,o.url);o.url=u.toString(),s===303&&(o.method="GET",o.headers.delete("Content-Length"),delete o.body),o.headers.delete("Authorization");let l=await t(o);return Mhe(t,l,r,n+1)}return e}var Pz,Ohe,Dz=R(()=>{Pz="redirectPolicy",Ohe=["GET","HEAD"]});function Fhe(){return"User-Agent"}function Uhe(t){t.set("Node",process.version),t.set("OS",`(${u1.arch()}-${u1.type()}-${u1.release()})`)}var u1,Bhe=R(()=>{u1=W(require("os"))});var t4,Nz=R(()=>{t4="1.10.1"});function yHe(t){let e=[];for(let[r,n]of t){let o=n?`${r}/${n}`:r;e.push(o)}return e.join(" ")}function qhe(){return Fhe()}function r4(t){let e=new Map;e.set("core-rest-pipeline",t4),Uhe(e);let r=yHe(e);return t?`${t} ${r}`:r}var Lz=R(()=>{Bhe();Nz()});function n4(t={}){let e=r4(t.userAgentPrefix);return{name:Oz,async sendRequest(r,n){return r.headers.has(Hhe)||r.headers.set(Hhe,e),n(r)}}}var Hhe,Oz,Mz=R(()=>{Lz();Hhe=qhe(),Oz="userAgentPolicy"});function i4(){return{name:Fz,async sendRequest(t,e){return t.method!=="HEAD"&&t.headers.set("Accept-Encoding","gzip,deflate"),e(t)}}}var Fz,Uz=R(()=>{Fz="decompressResponsePolicy"});function o4(t,e,r){return new Promise((n,o)=>{let s,a,c=()=>o(new md(r?.abortErrorMsg?r?.abortErrorMsg:bHe)),u=()=>{r?.abortSignal&&a&&r.abortSignal.removeEventListener("abort",a)};if(a=()=>(s&&clearTimeout(s),u(),c()),r?.abortSignal&&r.abortSignal.aborted)return c();s=setTimeout(()=>{u(),n(e)},t),r?.abortSignal&&r.abortSignal.addEventListener("abort",a)})}function jhe(t,e){let r=t.headers.get(e);if(!r)return;let n=Number(r);if(!Number.isNaN(n))return n}var bHe,s4=R(()=>{JL();bHe="The operation was aborted."});function zhe(t){if(t&&[429,503].includes(t.status))try{for(let o of _He){let s=jhe(t,o);if(s===0||s)return s*(o===Bz?1e3:1)}let e=t.headers.get(Bz);if(!e)return;let n=Date.parse(e)-Date.now();return Number.isFinite(n)?Math.max(0,n):void 0}catch{return}}function Ghe(t){return Number.isFinite(zhe(t))}function a4(){return{name:"throttlingRetryStrategy",retry({response:t}){let e=zhe(t);return Number.isFinite(e)?{retryAfterInMs:e}:{skipStrategy:!0}}}}var Bz,_He,c4=R(()=>{s4();Bz="Retry-After",_He=["retry-after-ms","x-ms-retry-after-ms",Bz]});function l1(t={}){var e,r;let n=(e=t.retryDelayInMs)!==null&&e!==void 0?e:xHe,o=(r=t.maxRetryDelayInMs)!==null&&r!==void 0?r:SHe,s=n;return{name:"exponentialRetryStrategy",retry({retryCount:a,response:c,responseError:u}){let l=CHe(u),d=l&&t.ignoreSystemErrors,p=IHe(c),f=p&&t.ignoreHttpStatusCodes;if(c&&(Ghe(c)||!p)||f||d)return{skipStrategy:!0};if(u&&!l&&!p)return{errorToThrow:u};let h=s*Math.pow(2,a),g=Math.min(o,h);return s=g/2+Tz(0,g/2),{retryAfterInMs:s}}}}function IHe(t){return!!(t&&t.status!==void 0&&(t.status>=500||t.status===408)&&t.status!==501&&t.status!==505)}function CHe(t){return t?t.code==="ETIMEDOUT"||t.code==="ESOCKETTIMEDOUT"||t.code==="ECONNREFUSED"||t.code==="ECONNRESET"||t.code==="ENOENT":!1}var xHe,SHe,u4=R(()=>{a1();c4();xHe=1e3,SHe=1e3*64});function hd(t,e={maxRetries:3}){let r=e.logger||Vhe;return{name:THe,async sendRequest(n,o){var s,a;let c,u,l=-1;e:for(;;){l+=1,c=void 0,u=void 0;try{r.info(`Retry ${l}: Attempting to send request`,n.requestId),c=await o(n),r.info(`Retry ${l}: Received a response from request`,n.requestId)}catch(d){if(r.error(`Retry ${l}: Received an error from request`,n.requestId),u=d,!d||u.name!=="RestError")throw d;c=u.response}if(!((s=n.abortSignal)===null||s===void 0)&&s.aborted)throw r.error(`Retry ${l}: Request aborted.`),new md;if(l>=((a=e.maxRetries)!==null&&a!==void 0?a:3)){if(r.info(`Retry ${l}: Maximum retries reached. Returning the last received response, or throwing the last received error.`),u)throw u;if(c)return c;throw new Error("Maximum retries reached with no response or error to throw")}r.info(`Retry ${l}: Processing ${t.length} retry strategies.`);t:for(let d of t){let p=d.logger||Vhe;p.info(`Retry ${l}: Processing retry strategy ${d.name}.`);let f=d.retry({retryCount:l,response:c,responseError:u});if(f.skipStrategy){p.info(`Retry ${l}: Skipped.`);continue t}let{errorToThrow:m,retryAfterInMs:h,redirectTo:g}=f;if(m)throw p.error(`Retry ${l}: Retry strategy ${d.name} throws error:`,m),m;if(h||h===0){p.info(`Retry ${l}: Retry strategy ${d.name} retries after ${h}`),await o4(h,void 0,{abortSignal:n.abortSignal});continue e}if(g){p.info(`Retry ${l}: Retry strategy ${d.name} redirects to ${g}`),n.url=g;continue e}}if(u)throw r.info("None of the retry strategies could work with the received error. Throwing it."),u;if(c)return r.info("None of the retry strategies could work with the received response. Returning it."),c}}}}var Vhe,THe,d1=R(()=>{s4();Sz();JL();Vhe=YL("core-rest-pipeline retryPolicy"),THe="retryPolicy"});function l4(t={}){var e;return{name:EHe,sendRequest:hd([a4(),l1(t)],{maxRetries:(e=t.maxRetries)!==null&&e!==void 0?e:3}).sendRequest}}var EHe,qz=R(()=>{u4();c4();d1();EHe="defaultRetryPolicy"});var Khe=L((MRt,Whe)=>{var $he=require("stream").Stream,wHe=require("util");Whe.exports=sl;function sl(){this.source=null,this.dataSize=0,this.maxDataSize=1024*1024,this.pauseStream=!0,this._maxDataSizeExceeded=!1,this._released=!1,this._bufferedEvents=[]}wHe.inherits(sl,$he);sl.create=function(t,e){var r=new this;e=e||{};for(var n in e)r[n]=e[n];r.source=t;var o=t.emit;return t.emit=function(){return r._handleEmit(arguments),o.apply(t,arguments)},t.on("error",function(){}),r.pauseStream&&t.pause(),r};Object.defineProperty(sl.prototype,"readable",{configurable:!0,enumerable:!0,get:function(){return this.source.readable}});sl.prototype.setEncoding=function(){return this.source.setEncoding.apply(this.source,arguments)};sl.prototype.resume=function(){this._released||this.release(),this.source.resume()};sl.prototype.pause=function(){this.source.pause()};sl.prototype.release=function(){this._released=!0,this._bufferedEvents.forEach(function(t){this.emit.apply(this,t)}.bind(this)),this._bufferedEvents=[]};sl.prototype.pipe=function(){var t=$he.prototype.pipe.apply(this,arguments);return this.resume(),t};sl.prototype._handleEmit=function(t){if(this._released){this.emit.apply(this,t);return}t[0]==="data"&&(this.dataSize+=t[1].length,this._checkIfMaxDataSizeExceeded()),this._bufferedEvents.push(t)};sl.prototype._checkIfMaxDataSizeExceeded=function(){if(!this._maxDataSizeExceeded&&!(this.dataSize<=this.maxDataSize)){this._maxDataSizeExceeded=!0;var t="DelayedStream#maxDataSize of "+this.maxDataSize+" bytes exceeded.";this.emit("error",new Error(t))}}});var Jhe=L((FRt,Xhe)=>{var RHe=require("util"),Qhe=require("stream").Stream,Yhe=Khe();Xhe.exports=Si;function Si(){this.writable=!1,this.readable=!0,this.dataSize=0,this.maxDataSize=2*1024*1024,this.pauseStreams=!0,this._released=!1,this._streams=[],this._currentStream=null,this._insideLoop=!1,this._pendingNext=!1}RHe.inherits(Si,Qhe);Si.create=function(t){var e=new this;t=t||{};for(var r in t)e[r]=t[r];return e};Si.isStreamLike=function(t){return typeof t!="function"&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"&&!Buffer.isBuffer(t)};Si.prototype.append=function(t){var e=Si.isStreamLike(t);if(e){if(!(t instanceof Yhe)){var r=Yhe.create(t,{maxDataSize:1/0,pauseStream:this.pauseStreams});t.on("data",this._checkDataSize.bind(this)),t=r}this._handleErrors(t),this.pauseStreams&&t.pause()}return this._streams.push(t),this};Si.prototype.pipe=function(t,e){return Qhe.prototype.pipe.call(this,t,e),this.resume(),t};Si.prototype._getNext=function(){if(this._currentStream=null,this._insideLoop){this._pendingNext=!0;return}this._insideLoop=!0;try{do this._pendingNext=!1,this._realGetNext();while(this._pendingNext)}finally{this._insideLoop=!1}};Si.prototype._realGetNext=function(){var t=this._streams.shift();if(typeof t>"u"){this.end();return}if(typeof t!="function"){this._pipeNext(t);return}var e=t;e(function(r){var n=Si.isStreamLike(r);n&&(r.on("data",this._checkDataSize.bind(this)),this._handleErrors(r)),this._pipeNext(r)}.bind(this))};Si.prototype._pipeNext=function(t){this._currentStream=t;var e=Si.isStreamLike(t);if(e){t.on("end",this._getNext.bind(this)),t.pipe(this,{end:!1});return}var r=t;this.write(r),this._getNext()};Si.prototype._handleErrors=function(t){var e=this;t.on("error",function(r){e._emitError(r)})};Si.prototype.write=function(t){this.emit("data",t)};Si.prototype.pause=function(){this.pauseStreams&&(this.pauseStreams&&this._currentStream&&typeof this._currentStream.pause=="function"&&this._currentStream.pause(),this.emit("pause"))};Si.prototype.resume=function(){this._released||(this._released=!0,this.writable=!0,this._getNext()),this.pauseStreams&&this._currentStream&&typeof this._currentStream.resume=="function"&&this._currentStream.resume(),this.emit("resume")};Si.prototype.end=function(){this._reset(),this.emit("end")};Si.prototype.destroy=function(){this._reset(),this.emit("close")};Si.prototype._reset=function(){this.writable=!1,this._streams=[],this._currentStream=null};Si.prototype._checkDataSize=function(){if(this._updateDataSize(),!(this.dataSize<=this.maxDataSize)){var t="DelayedStream#maxDataSize of "+this.maxDataSize+" bytes exceeded.";this._emitError(new Error(t))}};Si.prototype._updateDataSize=function(){this.dataSize=0;var t=this;this._streams.forEach(function(e){e.dataSize&&(t.dataSize+=e.dataSize)}),this._currentStream&&this._currentStream.dataSize&&(this.dataSize+=this._currentStream.dataSize)};Si.prototype._emitError=function(t){this._reset(),this.emit("error",t)}});var Zhe=L((URt,kHe)=>{kHe.exports={"application/1d-interleaved-parityfec":{source:"iana"},"application/3gpdash-qoe-report+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/3gpp-ims+xml":{source:"iana",compressible:!0},"application/3gpphal+json":{source:"iana",compressible:!0},"application/3gpphalforms+json":{source:"iana",compressible:!0},"application/a2l":{source:"iana"},"application/ace+cbor":{source:"iana"},"application/activemessage":{source:"iana"},"application/activity+json":{source:"iana",compressible:!0},"application/alto-costmap+json":{source:"iana",compressible:!0},"application/alto-costmapfilter+json":{source:"iana",compressible:!0},"application/alto-directory+json":{source:"iana",compressible:!0},"application/alto-endpointcost+json":{source:"iana",compressible:!0},"application/alto-endpointcostparams+json":{source:"iana",compressible:!0},"application/alto-endpointprop+json":{source:"iana",compressible:!0},"application/alto-endpointpropparams+json":{source:"iana",compressible:!0},"application/alto-error+json":{source:"iana",compressible:!0},"application/alto-networkmap+json":{source:"iana",compressible:!0},"application/alto-networkmapfilter+json":{source:"iana",compressible:!0},"application/alto-updatestreamcontrol+json":{source:"iana",compressible:!0},"application/alto-updatestreamparams+json":{source:"iana",compressible:!0},"application/aml":{source:"iana"},"application/andrew-inset":{source:"iana",extensions:["ez"]},"application/applefile":{source:"iana"},"application/applixware":{source:"apache",extensions:["aw"]},"application/at+jwt":{source:"iana"},"application/atf":{source:"iana"},"application/atfx":{source:"iana"},"application/atom+xml":{source:"iana",compressible:!0,extensions:["atom"]},"application/atomcat+xml":{source:"iana",compressible:!0,extensions:["atomcat"]},"application/atomdeleted+xml":{source:"iana",compressible:!0,extensions:["atomdeleted"]},"application/atomicmail":{source:"iana"},"application/atomsvc+xml":{source:"iana",compressible:!0,extensions:["atomsvc"]},"application/atsc-dwd+xml":{source:"iana",compressible:!0,extensions:["dwd"]},"application/atsc-dynamic-event-message":{source:"iana"},"application/atsc-held+xml":{source:"iana",compressible:!0,extensions:["held"]},"application/atsc-rdt+json":{source:"iana",compressible:!0},"application/atsc-rsat+xml":{source:"iana",compressible:!0,extensions:["rsat"]},"application/atxml":{source:"iana"},"application/auth-policy+xml":{source:"iana",compressible:!0},"application/bacnet-xdd+zip":{source:"iana",compressible:!1},"application/batch-smtp":{source:"iana"},"application/bdoc":{compressible:!1,extensions:["bdoc"]},"application/beep+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/calendar+json":{source:"iana",compressible:!0},"application/calendar+xml":{source:"iana",compressible:!0,extensions:["xcs"]},"application/call-completion":{source:"iana"},"application/cals-1840":{source:"iana"},"application/captive+json":{source:"iana",compressible:!0},"application/cbor":{source:"iana"},"application/cbor-seq":{source:"iana"},"application/cccex":{source:"iana"},"application/ccmp+xml":{source:"iana",compressible:!0},"application/ccxml+xml":{source:"iana",compressible:!0,extensions:["ccxml"]},"application/cdfx+xml":{source:"iana",compressible:!0,extensions:["cdfx"]},"application/cdmi-capability":{source:"iana",extensions:["cdmia"]},"application/cdmi-container":{source:"iana",extensions:["cdmic"]},"application/cdmi-domain":{source:"iana",extensions:["cdmid"]},"application/cdmi-object":{source:"iana",extensions:["cdmio"]},"application/cdmi-queue":{source:"iana",extensions:["cdmiq"]},"application/cdni":{source:"iana"},"application/cea":{source:"iana"},"application/cea-2018+xml":{source:"iana",compressible:!0},"application/cellml+xml":{source:"iana",compressible:!0},"application/cfw":{source:"iana"},"application/city+json":{source:"iana",compressible:!0},"application/clr":{source:"iana"},"application/clue+xml":{source:"iana",compressible:!0},"application/clue_info+xml":{source:"iana",compressible:!0},"application/cms":{source:"iana"},"application/cnrp+xml":{source:"iana",compressible:!0},"application/coap-group+json":{source:"iana",compressible:!0},"application/coap-payload":{source:"iana"},"application/commonground":{source:"iana"},"application/conference-info+xml":{source:"iana",compressible:!0},"application/cose":{source:"iana"},"application/cose-key":{source:"iana"},"application/cose-key-set":{source:"iana"},"application/cpl+xml":{source:"iana",compressible:!0,extensions:["cpl"]},"application/csrattrs":{source:"iana"},"application/csta+xml":{source:"iana",compressible:!0},"application/cstadata+xml":{source:"iana",compressible:!0},"application/csvm+json":{source:"iana",compressible:!0},"application/cu-seeme":{source:"apache",extensions:["cu"]},"application/cwt":{source:"iana"},"application/cybercash":{source:"iana"},"application/dart":{compressible:!0},"application/dash+xml":{source:"iana",compressible:!0,extensions:["mpd"]},"application/dash-patch+xml":{source:"iana",compressible:!0,extensions:["mpp"]},"application/dashdelta":{source:"iana"},"application/davmount+xml":{source:"iana",compressible:!0,extensions:["davmount"]},"application/dca-rft":{source:"iana"},"application/dcd":{source:"iana"},"application/dec-dx":{source:"iana"},"application/dialog-info+xml":{source:"iana",compressible:!0},"application/dicom":{source:"iana"},"application/dicom+json":{source:"iana",compressible:!0},"application/dicom+xml":{source:"iana",compressible:!0},"application/dii":{source:"iana"},"application/dit":{source:"iana"},"application/dns":{source:"iana"},"application/dns+json":{source:"iana",compressible:!0},"application/dns-message":{source:"iana"},"application/docbook+xml":{source:"apache",compressible:!0,extensions:["dbk"]},"application/dots+cbor":{source:"iana"},"application/dskpp+xml":{source:"iana",compressible:!0},"application/dssc+der":{source:"iana",extensions:["dssc"]},"application/dssc+xml":{source:"iana",compressible:!0,extensions:["xdssc"]},"application/dvcs":{source:"iana"},"application/ecmascript":{source:"iana",compressible:!0,extensions:["es","ecma"]},"application/edi-consent":{source:"iana"},"application/edi-x12":{source:"iana",compressible:!1},"application/edifact":{source:"iana",compressible:!1},"application/efi":{source:"iana"},"application/elm+json":{source:"iana",charset:"UTF-8",compressible:!0},"application/elm+xml":{source:"iana",compressible:!0},"application/emergencycalldata.cap+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/emergencycalldata.comment+xml":{source:"iana",compressible:!0},"application/emergencycalldata.control+xml":{source:"iana",compressible:!0},"application/emergencycalldata.deviceinfo+xml":{source:"iana",compressible:!0},"application/emergencycalldata.ecall.msd":{source:"iana"},"application/emergencycalldata.providerinfo+xml":{source:"iana",compressible:!0},"application/emergencycalldata.serviceinfo+xml":{source:"iana",compressible:!0},"application/emergencycalldata.subscriberinfo+xml":{source:"iana",compressible:!0},"application/emergencycalldata.veds+xml":{source:"iana",compressible:!0},"application/emma+xml":{source:"iana",compressible:!0,extensions:["emma"]},"application/emotionml+xml":{source:"iana",compressible:!0,extensions:["emotionml"]},"application/encaprtp":{source:"iana"},"application/epp+xml":{source:"iana",compressible:!0},"application/epub+zip":{source:"iana",compressible:!1,extensions:["epub"]},"application/eshop":{source:"iana"},"application/exi":{source:"iana",extensions:["exi"]},"application/expect-ct-report+json":{source:"iana",compressible:!0},"application/express":{source:"iana",extensions:["exp"]},"application/fastinfoset":{source:"iana"},"application/fastsoap":{source:"iana"},"application/fdt+xml":{source:"iana",compressible:!0,extensions:["fdt"]},"application/fhir+json":{source:"iana",charset:"UTF-8",compressible:!0},"application/fhir+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/fido.trusted-apps+json":{compressible:!0},"application/fits":{source:"iana"},"application/flexfec":{source:"iana"},"application/font-sfnt":{source:"iana"},"application/font-tdpfr":{source:"iana",extensions:["pfr"]},"application/font-woff":{source:"iana",compressible:!1},"application/framework-attributes+xml":{source:"iana",compressible:!0},"application/geo+json":{source:"iana",compressible:!0,extensions:["geojson"]},"application/geo+json-seq":{source:"iana"},"application/geopackage+sqlite3":{source:"iana"},"application/geoxacml+xml":{source:"iana",compressible:!0},"application/gltf-buffer":{source:"iana"},"application/gml+xml":{source:"iana",compressible:!0,extensions:["gml"]},"application/gpx+xml":{source:"apache",compressible:!0,extensions:["gpx"]},"application/gxf":{source:"apache",extensions:["gxf"]},"application/gzip":{source:"iana",compressible:!1,extensions:["gz"]},"application/h224":{source:"iana"},"application/held+xml":{source:"iana",compressible:!0},"application/hjson":{extensions:["hjson"]},"application/http":{source:"iana"},"application/hyperstudio":{source:"iana",extensions:["stk"]},"application/ibe-key-request+xml":{source:"iana",compressible:!0},"application/ibe-pkg-reply+xml":{source:"iana",compressible:!0},"application/ibe-pp-data":{source:"iana"},"application/iges":{source:"iana"},"application/im-iscomposing+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/index":{source:"iana"},"application/index.cmd":{source:"iana"},"application/index.obj":{source:"iana"},"application/index.response":{source:"iana"},"application/index.vnd":{source:"iana"},"application/inkml+xml":{source:"iana",compressible:!0,extensions:["ink","inkml"]},"application/iotp":{source:"iana"},"application/ipfix":{source:"iana",extensions:["ipfix"]},"application/ipp":{source:"iana"},"application/isup":{source:"iana"},"application/its+xml":{source:"iana",compressible:!0,extensions:["its"]},"application/java-archive":{source:"apache",compressible:!1,extensions:["jar","war","ear"]},"application/java-serialized-object":{source:"apache",compressible:!1,extensions:["ser"]},"application/java-vm":{source:"apache",compressible:!1,extensions:["class"]},"application/javascript":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["js","mjs"]},"application/jf2feed+json":{source:"iana",compressible:!0},"application/jose":{source:"iana"},"application/jose+json":{source:"iana",compressible:!0},"application/jrd+json":{source:"iana",compressible:!0},"application/jscalendar+json":{source:"iana",compressible:!0},"application/json":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["json","map"]},"application/json-patch+json":{source:"iana",compressible:!0},"application/json-seq":{source:"iana"},"application/json5":{extensions:["json5"]},"application/jsonml+json":{source:"apache",compressible:!0,extensions:["jsonml"]},"application/jwk+json":{source:"iana",compressible:!0},"application/jwk-set+json":{source:"iana",compressible:!0},"application/jwt":{source:"iana"},"application/kpml-request+xml":{source:"iana",compressible:!0},"application/kpml-response+xml":{source:"iana",compressible:!0},"application/ld+json":{source:"iana",compressible:!0,extensions:["jsonld"]},"application/lgr+xml":{source:"iana",compressible:!0,extensions:["lgr"]},"application/link-format":{source:"iana"},"application/load-control+xml":{source:"iana",compressible:!0},"application/lost+xml":{source:"iana",compressible:!0,extensions:["lostxml"]},"application/lostsync+xml":{source:"iana",compressible:!0},"application/lpf+zip":{source:"iana",compressible:!1},"application/lxf":{source:"iana"},"application/mac-binhex40":{source:"iana",extensions:["hqx"]},"application/mac-compactpro":{source:"apache",extensions:["cpt"]},"application/macwriteii":{source:"iana"},"application/mads+xml":{source:"iana",compressible:!0,extensions:["mads"]},"application/manifest+json":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["webmanifest"]},"application/marc":{source:"iana",extensions:["mrc"]},"application/marcxml+xml":{source:"iana",compressible:!0,extensions:["mrcx"]},"application/mathematica":{source:"iana",extensions:["ma","nb","mb"]},"application/mathml+xml":{source:"iana",compressible:!0,extensions:["mathml"]},"application/mathml-content+xml":{source:"iana",compressible:!0},"application/mathml-presentation+xml":{source:"iana",compressible:!0},"application/mbms-associated-procedure-description+xml":{source:"iana",compressible:!0},"application/mbms-deregister+xml":{source:"iana",compressible:!0},"application/mbms-envelope+xml":{source:"iana",compressible:!0},"application/mbms-msk+xml":{source:"iana",compressible:!0},"application/mbms-msk-response+xml":{source:"iana",compressible:!0},"application/mbms-protection-description+xml":{source:"iana",compressible:!0},"application/mbms-reception-report+xml":{source:"iana",compressible:!0},"application/mbms-register+xml":{source:"iana",compressible:!0},"application/mbms-register-response+xml":{source:"iana",compressible:!0},"application/mbms-schedule+xml":{source:"iana",compressible:!0},"application/mbms-user-service-description+xml":{source:"iana",compressible:!0},"application/mbox":{source:"iana",extensions:["mbox"]},"application/media-policy-dataset+xml":{source:"iana",compressible:!0,extensions:["mpf"]},"application/media_control+xml":{source:"iana",compressible:!0},"application/mediaservercontrol+xml":{source:"iana",compressible:!0,extensions:["mscml"]},"application/merge-patch+json":{source:"iana",compressible:!0},"application/metalink+xml":{source:"apache",compressible:!0,extensions:["metalink"]},"application/metalink4+xml":{source:"iana",compressible:!0,extensions:["meta4"]},"application/mets+xml":{source:"iana",compressible:!0,extensions:["mets"]},"application/mf4":{source:"iana"},"application/mikey":{source:"iana"},"application/mipc":{source:"iana"},"application/missing-blocks+cbor-seq":{source:"iana"},"application/mmt-aei+xml":{source:"iana",compressible:!0,extensions:["maei"]},"application/mmt-usd+xml":{source:"iana",compressible:!0,extensions:["musd"]},"application/mods+xml":{source:"iana",compressible:!0,extensions:["mods"]},"application/moss-keys":{source:"iana"},"application/moss-signature":{source:"iana"},"application/mosskey-data":{source:"iana"},"application/mosskey-request":{source:"iana"},"application/mp21":{source:"iana",extensions:["m21","mp21"]},"application/mp4":{source:"iana",extensions:["mp4s","m4p"]},"application/mpeg4-generic":{source:"iana"},"application/mpeg4-iod":{source:"iana"},"application/mpeg4-iod-xmt":{source:"iana"},"application/mrb-consumer+xml":{source:"iana",compressible:!0},"application/mrb-publish+xml":{source:"iana",compressible:!0},"application/msc-ivr+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/msc-mixer+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/msword":{source:"iana",compressible:!1,extensions:["doc","dot"]},"application/mud+json":{source:"iana",compressible:!0},"application/multipart-core":{source:"iana"},"application/mxf":{source:"iana",extensions:["mxf"]},"application/n-quads":{source:"iana",extensions:["nq"]},"application/n-triples":{source:"iana",extensions:["nt"]},"application/nasdata":{source:"iana"},"application/news-checkgroups":{source:"iana",charset:"US-ASCII"},"application/news-groupinfo":{source:"iana",charset:"US-ASCII"},"application/news-transmission":{source:"iana"},"application/nlsml+xml":{source:"iana",compressible:!0},"application/node":{source:"iana",extensions:["cjs"]},"application/nss":{source:"iana"},"application/oauth-authz-req+jwt":{source:"iana"},"application/oblivious-dns-message":{source:"iana"},"application/ocsp-request":{source:"iana"},"application/ocsp-response":{source:"iana"},"application/octet-stream":{source:"iana",compressible:!1,extensions:["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"]},"application/oda":{source:"iana",extensions:["oda"]},"application/odm+xml":{source:"iana",compressible:!0},"application/odx":{source:"iana"},"application/oebps-package+xml":{source:"iana",compressible:!0,extensions:["opf"]},"application/ogg":{source:"iana",compressible:!1,extensions:["ogx"]},"application/omdoc+xml":{source:"apache",compressible:!0,extensions:["omdoc"]},"application/onenote":{source:"apache",extensions:["onetoc","onetoc2","onetmp","onepkg"]},"application/opc-nodeset+xml":{source:"iana",compressible:!0},"application/oscore":{source:"iana"},"application/oxps":{source:"iana",extensions:["oxps"]},"application/p21":{source:"iana"},"application/p21+zip":{source:"iana",compressible:!1},"application/p2p-overlay+xml":{source:"iana",compressible:!0,extensions:["relo"]},"application/parityfec":{source:"iana"},"application/passport":{source:"iana"},"application/patch-ops-error+xml":{source:"iana",compressible:!0,extensions:["xer"]},"application/pdf":{source:"iana",compressible:!1,extensions:["pdf"]},"application/pdx":{source:"iana"},"application/pem-certificate-chain":{source:"iana"},"application/pgp-encrypted":{source:"iana",compressible:!1,extensions:["pgp"]},"application/pgp-keys":{source:"iana",extensions:["asc"]},"application/pgp-signature":{source:"iana",extensions:["asc","sig"]},"application/pics-rules":{source:"apache",extensions:["prf"]},"application/pidf+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/pidf-diff+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/pkcs10":{source:"iana",extensions:["p10"]},"application/pkcs12":{source:"iana"},"application/pkcs7-mime":{source:"iana",extensions:["p7m","p7c"]},"application/pkcs7-signature":{source:"iana",extensions:["p7s"]},"application/pkcs8":{source:"iana",extensions:["p8"]},"application/pkcs8-encrypted":{source:"iana"},"application/pkix-attr-cert":{source:"iana",extensions:["ac"]},"application/pkix-cert":{source:"iana",extensions:["cer"]},"application/pkix-crl":{source:"iana",extensions:["crl"]},"application/pkix-pkipath":{source:"iana",extensions:["pkipath"]},"application/pkixcmp":{source:"iana",extensions:["pki"]},"application/pls+xml":{source:"iana",compressible:!0,extensions:["pls"]},"application/poc-settings+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/postscript":{source:"iana",compressible:!0,extensions:["ai","eps","ps"]},"application/ppsp-tracker+json":{source:"iana",compressible:!0},"application/problem+json":{source:"iana",compressible:!0},"application/problem+xml":{source:"iana",compressible:!0},"application/provenance+xml":{source:"iana",compressible:!0,extensions:["provx"]},"application/prs.alvestrand.titrax-sheet":{source:"iana"},"application/prs.cww":{source:"iana",extensions:["cww"]},"application/prs.cyn":{source:"iana",charset:"7-BIT"},"application/prs.hpub+zip":{source:"iana",compressible:!1},"application/prs.nprend":{source:"iana"},"application/prs.plucker":{source:"iana"},"application/prs.rdf-xml-crypt":{source:"iana"},"application/prs.xsf+xml":{source:"iana",compressible:!0},"application/pskc+xml":{source:"iana",compressible:!0,extensions:["pskcxml"]},"application/pvd+json":{source:"iana",compressible:!0},"application/qsig":{source:"iana"},"application/raml+yaml":{compressible:!0,extensions:["raml"]},"application/raptorfec":{source:"iana"},"application/rdap+json":{source:"iana",compressible:!0},"application/rdf+xml":{source:"iana",compressible:!0,extensions:["rdf","owl"]},"application/reginfo+xml":{source:"iana",compressible:!0,extensions:["rif"]},"application/relax-ng-compact-syntax":{source:"iana",extensions:["rnc"]},"application/remote-printing":{source:"iana"},"application/reputon+json":{source:"iana",compressible:!0},"application/resource-lists+xml":{source:"iana",compressible:!0,extensions:["rl"]},"application/resource-lists-diff+xml":{source:"iana",compressible:!0,extensions:["rld"]},"application/rfc+xml":{source:"iana",compressible:!0},"application/riscos":{source:"iana"},"application/rlmi+xml":{source:"iana",compressible:!0},"application/rls-services+xml":{source:"iana",compressible:!0,extensions:["rs"]},"application/route-apd+xml":{source:"iana",compressible:!0,extensions:["rapd"]},"application/route-s-tsid+xml":{source:"iana",compressible:!0,extensions:["sls"]},"application/route-usd+xml":{source:"iana",compressible:!0,extensions:["rusd"]},"application/rpki-ghostbusters":{source:"iana",extensions:["gbr"]},"application/rpki-manifest":{source:"iana",extensions:["mft"]},"application/rpki-publication":{source:"iana"},"application/rpki-roa":{source:"iana",extensions:["roa"]},"application/rpki-updown":{source:"iana"},"application/rsd+xml":{source:"apache",compressible:!0,extensions:["rsd"]},"application/rss+xml":{source:"apache",compressible:!0,extensions:["rss"]},"application/rtf":{source:"iana",compressible:!0,extensions:["rtf"]},"application/rtploopback":{source:"iana"},"application/rtx":{source:"iana"},"application/samlassertion+xml":{source:"iana",compressible:!0},"application/samlmetadata+xml":{source:"iana",compressible:!0},"application/sarif+json":{source:"iana",compressible:!0},"application/sarif-external-properties+json":{source:"iana",compressible:!0},"application/sbe":{source:"iana"},"application/sbml+xml":{source:"iana",compressible:!0,extensions:["sbml"]},"application/scaip+xml":{source:"iana",compressible:!0},"application/scim+json":{source:"iana",compressible:!0},"application/scvp-cv-request":{source:"iana",extensions:["scq"]},"application/scvp-cv-response":{source:"iana",extensions:["scs"]},"application/scvp-vp-request":{source:"iana",extensions:["spq"]},"application/scvp-vp-response":{source:"iana",extensions:["spp"]},"application/sdp":{source:"iana",extensions:["sdp"]},"application/secevent+jwt":{source:"iana"},"application/senml+cbor":{source:"iana"},"application/senml+json":{source:"iana",compressible:!0},"application/senml+xml":{source:"iana",compressible:!0,extensions:["senmlx"]},"application/senml-etch+cbor":{source:"iana"},"application/senml-etch+json":{source:"iana",compressible:!0},"application/senml-exi":{source:"iana"},"application/sensml+cbor":{source:"iana"},"application/sensml+json":{source:"iana",compressible:!0},"application/sensml+xml":{source:"iana",compressible:!0,extensions:["sensmlx"]},"application/sensml-exi":{source:"iana"},"application/sep+xml":{source:"iana",compressible:!0},"application/sep-exi":{source:"iana"},"application/session-info":{source:"iana"},"application/set-payment":{source:"iana"},"application/set-payment-initiation":{source:"iana",extensions:["setpay"]},"application/set-registration":{source:"iana"},"application/set-registration-initiation":{source:"iana",extensions:["setreg"]},"application/sgml":{source:"iana"},"application/sgml-open-catalog":{source:"iana"},"application/shf+xml":{source:"iana",compressible:!0,extensions:["shf"]},"application/sieve":{source:"iana",extensions:["siv","sieve"]},"application/simple-filter+xml":{source:"iana",compressible:!0},"application/simple-message-summary":{source:"iana"},"application/simplesymbolcontainer":{source:"iana"},"application/sipc":{source:"iana"},"application/slate":{source:"iana"},"application/smil":{source:"iana"},"application/smil+xml":{source:"iana",compressible:!0,extensions:["smi","smil"]},"application/smpte336m":{source:"iana"},"application/soap+fastinfoset":{source:"iana"},"application/soap+xml":{source:"iana",compressible:!0},"application/sparql-query":{source:"iana",extensions:["rq"]},"application/sparql-results+xml":{source:"iana",compressible:!0,extensions:["srx"]},"application/spdx+json":{source:"iana",compressible:!0},"application/spirits-event+xml":{source:"iana",compressible:!0},"application/sql":{source:"iana"},"application/srgs":{source:"iana",extensions:["gram"]},"application/srgs+xml":{source:"iana",compressible:!0,extensions:["grxml"]},"application/sru+xml":{source:"iana",compressible:!0,extensions:["sru"]},"application/ssdl+xml":{source:"apache",compressible:!0,extensions:["ssdl"]},"application/ssml+xml":{source:"iana",compressible:!0,extensions:["ssml"]},"application/stix+json":{source:"iana",compressible:!0},"application/swid+xml":{source:"iana",compressible:!0,extensions:["swidtag"]},"application/tamp-apex-update":{source:"iana"},"application/tamp-apex-update-confirm":{source:"iana"},"application/tamp-community-update":{source:"iana"},"application/tamp-community-update-confirm":{source:"iana"},"application/tamp-error":{source:"iana"},"application/tamp-sequence-adjust":{source:"iana"},"application/tamp-sequence-adjust-confirm":{source:"iana"},"application/tamp-status-query":{source:"iana"},"application/tamp-status-response":{source:"iana"},"application/tamp-update":{source:"iana"},"application/tamp-update-confirm":{source:"iana"},"application/tar":{compressible:!0},"application/taxii+json":{source:"iana",compressible:!0},"application/td+json":{source:"iana",compressible:!0},"application/tei+xml":{source:"iana",compressible:!0,extensions:["tei","teicorpus"]},"application/tetra_isi":{source:"iana"},"application/thraud+xml":{source:"iana",compressible:!0,extensions:["tfi"]},"application/timestamp-query":{source:"iana"},"application/timestamp-reply":{source:"iana"},"application/timestamped-data":{source:"iana",extensions:["tsd"]},"application/tlsrpt+gzip":{source:"iana"},"application/tlsrpt+json":{source:"iana",compressible:!0},"application/tnauthlist":{source:"iana"},"application/token-introspection+jwt":{source:"iana"},"application/toml":{compressible:!0,extensions:["toml"]},"application/trickle-ice-sdpfrag":{source:"iana"},"application/trig":{source:"iana",extensions:["trig"]},"application/ttml+xml":{source:"iana",compressible:!0,extensions:["ttml"]},"application/tve-trigger":{source:"iana"},"application/tzif":{source:"iana"},"application/tzif-leap":{source:"iana"},"application/ubjson":{compressible:!1,extensions:["ubj"]},"application/ulpfec":{source:"iana"},"application/urc-grpsheet+xml":{source:"iana",compressible:!0},"application/urc-ressheet+xml":{source:"iana",compressible:!0,extensions:["rsheet"]},"application/urc-targetdesc+xml":{source:"iana",compressible:!0,extensions:["td"]},"application/urc-uisocketdesc+xml":{source:"iana",compressible:!0},"application/vcard+json":{source:"iana",compressible:!0},"application/vcard+xml":{source:"iana",compressible:!0},"application/vemmi":{source:"iana"},"application/vividence.scriptfile":{source:"apache"},"application/vnd.1000minds.decision-model+xml":{source:"iana",compressible:!0,extensions:["1km"]},"application/vnd.3gpp-prose+xml":{source:"iana",compressible:!0},"application/vnd.3gpp-prose-pc3ch+xml":{source:"iana",compressible:!0},"application/vnd.3gpp-v2x-local-service-information":{source:"iana"},"application/vnd.3gpp.5gnas":{source:"iana"},"application/vnd.3gpp.access-transfer-events+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.bsf+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.gmop+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.gtpc":{source:"iana"},"application/vnd.3gpp.interworking-data":{source:"iana"},"application/vnd.3gpp.lpp":{source:"iana"},"application/vnd.3gpp.mc-signalling-ear":{source:"iana"},"application/vnd.3gpp.mcdata-affiliation-command+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcdata-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcdata-payload":{source:"iana"},"application/vnd.3gpp.mcdata-service-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcdata-signalling":{source:"iana"},"application/vnd.3gpp.mcdata-ue-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcdata-user-profile+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-affiliation-command+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-floor-request+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-location-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-mbms-usage-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-service-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-signed+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-ue-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-ue-init-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-user-profile+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-affiliation-command+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-affiliation-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-location-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-mbms-usage-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-service-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-transmission-request+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-ue-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-user-profile+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mid-call+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.ngap":{source:"iana"},"application/vnd.3gpp.pfcp":{source:"iana"},"application/vnd.3gpp.pic-bw-large":{source:"iana",extensions:["plb"]},"application/vnd.3gpp.pic-bw-small":{source:"iana",extensions:["psb"]},"application/vnd.3gpp.pic-bw-var":{source:"iana",extensions:["pvb"]},"application/vnd.3gpp.s1ap":{source:"iana"},"application/vnd.3gpp.sms":{source:"iana"},"application/vnd.3gpp.sms+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.srvcc-ext+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.srvcc-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.state-and-event-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.ussd+xml":{source:"iana",compressible:!0},"application/vnd.3gpp2.bcmcsinfo+xml":{source:"iana",compressible:!0},"application/vnd.3gpp2.sms":{source:"iana"},"application/vnd.3gpp2.tcap":{source:"iana",extensions:["tcap"]},"application/vnd.3lightssoftware.imagescal":{source:"iana"},"application/vnd.3m.post-it-notes":{source:"iana",extensions:["pwn"]},"application/vnd.accpac.simply.aso":{source:"iana",extensions:["aso"]},"application/vnd.accpac.simply.imp":{source:"iana",extensions:["imp"]},"application/vnd.acucobol":{source:"iana",extensions:["acu"]},"application/vnd.acucorp":{source:"iana",extensions:["atc","acutc"]},"application/vnd.adobe.air-application-installer-package+zip":{source:"apache",compressible:!1,extensions:["air"]},"application/vnd.adobe.flash.movie":{source:"iana"},"application/vnd.adobe.formscentral.fcdt":{source:"iana",extensions:["fcdt"]},"application/vnd.adobe.fxp":{source:"iana",extensions:["fxp","fxpl"]},"application/vnd.adobe.partial-upload":{source:"iana"},"application/vnd.adobe.xdp+xml":{source:"iana",compressible:!0,extensions:["xdp"]},"application/vnd.adobe.xfdf":{source:"iana",extensions:["xfdf"]},"application/vnd.aether.imp":{source:"iana"},"application/vnd.afpc.afplinedata":{source:"iana"},"application/vnd.afpc.afplinedata-pagedef":{source:"iana"},"application/vnd.afpc.cmoca-cmresource":{source:"iana"},"application/vnd.afpc.foca-charset":{source:"iana"},"application/vnd.afpc.foca-codedfont":{source:"iana"},"application/vnd.afpc.foca-codepage":{source:"iana"},"application/vnd.afpc.modca":{source:"iana"},"application/vnd.afpc.modca-cmtable":{source:"iana"},"application/vnd.afpc.modca-formdef":{source:"iana"},"application/vnd.afpc.modca-mediummap":{source:"iana"},"application/vnd.afpc.modca-objectcontainer":{source:"iana"},"application/vnd.afpc.modca-overlay":{source:"iana"},"application/vnd.afpc.modca-pagesegment":{source:"iana"},"application/vnd.age":{source:"iana",extensions:["age"]},"application/vnd.ah-barcode":{source:"iana"},"application/vnd.ahead.space":{source:"iana",extensions:["ahead"]},"application/vnd.airzip.filesecure.azf":{source:"iana",extensions:["azf"]},"application/vnd.airzip.filesecure.azs":{source:"iana",extensions:["azs"]},"application/vnd.amadeus+json":{source:"iana",compressible:!0},"application/vnd.amazon.ebook":{source:"apache",extensions:["azw"]},"application/vnd.amazon.mobi8-ebook":{source:"iana"},"application/vnd.americandynamics.acc":{source:"iana",extensions:["acc"]},"application/vnd.amiga.ami":{source:"iana",extensions:["ami"]},"application/vnd.amundsen.maze+xml":{source:"iana",compressible:!0},"application/vnd.android.ota":{source:"iana"},"application/vnd.android.package-archive":{source:"apache",compressible:!1,extensions:["apk"]},"application/vnd.anki":{source:"iana"},"application/vnd.anser-web-certificate-issue-initiation":{source:"iana",extensions:["cii"]},"application/vnd.anser-web-funds-transfer-initiation":{source:"apache",extensions:["fti"]},"application/vnd.antix.game-component":{source:"iana",extensions:["atx"]},"application/vnd.apache.arrow.file":{source:"iana"},"application/vnd.apache.arrow.stream":{source:"iana"},"application/vnd.apache.thrift.binary":{source:"iana"},"application/vnd.apache.thrift.compact":{source:"iana"},"application/vnd.apache.thrift.json":{source:"iana"},"application/vnd.api+json":{source:"iana",compressible:!0},"application/vnd.aplextor.warrp+json":{source:"iana",compressible:!0},"application/vnd.apothekende.reservation+json":{source:"iana",compressible:!0},"application/vnd.apple.installer+xml":{source:"iana",compressible:!0,extensions:["mpkg"]},"application/vnd.apple.keynote":{source:"iana",extensions:["key"]},"application/vnd.apple.mpegurl":{source:"iana",extensions:["m3u8"]},"application/vnd.apple.numbers":{source:"iana",extensions:["numbers"]},"application/vnd.apple.pages":{source:"iana",extensions:["pages"]},"application/vnd.apple.pkpass":{compressible:!1,extensions:["pkpass"]},"application/vnd.arastra.swi":{source:"iana"},"application/vnd.aristanetworks.swi":{source:"iana",extensions:["swi"]},"application/vnd.artisan+json":{source:"iana",compressible:!0},"application/vnd.artsquare":{source:"iana"},"application/vnd.astraea-software.iota":{source:"iana",extensions:["iota"]},"application/vnd.audiograph":{source:"iana",extensions:["aep"]},"application/vnd.autopackage":{source:"iana"},"application/vnd.avalon+json":{source:"iana",compressible:!0},"application/vnd.avistar+xml":{source:"iana",compressible:!0},"application/vnd.balsamiq.bmml+xml":{source:"iana",compressible:!0,extensions:["bmml"]},"application/vnd.balsamiq.bmpr":{source:"iana"},"application/vnd.banana-accounting":{source:"iana"},"application/vnd.bbf.usp.error":{source:"iana"},"application/vnd.bbf.usp.msg":{source:"iana"},"application/vnd.bbf.usp.msg+json":{source:"iana",compressible:!0},"application/vnd.bekitzur-stech+json":{source:"iana",compressible:!0},"application/vnd.bint.med-content":{source:"iana"},"application/vnd.biopax.rdf+xml":{source:"iana",compressible:!0},"application/vnd.blink-idb-value-wrapper":{source:"iana"},"application/vnd.blueice.multipass":{source:"iana",extensions:["mpm"]},"application/vnd.bluetooth.ep.oob":{source:"iana"},"application/vnd.bluetooth.le.oob":{source:"iana"},"application/vnd.bmi":{source:"iana",extensions:["bmi"]},"application/vnd.bpf":{source:"iana"},"application/vnd.bpf3":{source:"iana"},"application/vnd.businessobjects":{source:"iana",extensions:["rep"]},"application/vnd.byu.uapi+json":{source:"iana",compressible:!0},"application/vnd.cab-jscript":{source:"iana"},"application/vnd.canon-cpdl":{source:"iana"},"application/vnd.canon-lips":{source:"iana"},"application/vnd.capasystems-pg+json":{source:"iana",compressible:!0},"application/vnd.cendio.thinlinc.clientconf":{source:"iana"},"application/vnd.century-systems.tcp_stream":{source:"iana"},"application/vnd.chemdraw+xml":{source:"iana",compressible:!0,extensions:["cdxml"]},"application/vnd.chess-pgn":{source:"iana"},"application/vnd.chipnuts.karaoke-mmd":{source:"iana",extensions:["mmd"]},"application/vnd.ciedi":{source:"iana"},"application/vnd.cinderella":{source:"iana",extensions:["cdy"]},"application/vnd.cirpack.isdn-ext":{source:"iana"},"application/vnd.citationstyles.style+xml":{source:"iana",compressible:!0,extensions:["csl"]},"application/vnd.claymore":{source:"iana",extensions:["cla"]},"application/vnd.cloanto.rp9":{source:"iana",extensions:["rp9"]},"application/vnd.clonk.c4group":{source:"iana",extensions:["c4g","c4d","c4f","c4p","c4u"]},"application/vnd.cluetrust.cartomobile-config":{source:"iana",extensions:["c11amc"]},"application/vnd.cluetrust.cartomobile-config-pkg":{source:"iana",extensions:["c11amz"]},"application/vnd.coffeescript":{source:"iana"},"application/vnd.collabio.xodocuments.document":{source:"iana"},"application/vnd.collabio.xodocuments.document-template":{source:"iana"},"application/vnd.collabio.xodocuments.presentation":{source:"iana"},"application/vnd.collabio.xodocuments.presentation-template":{source:"iana"},"application/vnd.collabio.xodocuments.spreadsheet":{source:"iana"},"application/vnd.collabio.xodocuments.spreadsheet-template":{source:"iana"},"application/vnd.collection+json":{source:"iana",compressible:!0},"application/vnd.collection.doc+json":{source:"iana",compressible:!0},"application/vnd.collection.next+json":{source:"iana",compressible:!0},"application/vnd.comicbook+zip":{source:"iana",compressible:!1},"application/vnd.comicbook-rar":{source:"iana"},"application/vnd.commerce-battelle":{source:"iana"},"application/vnd.commonspace":{source:"iana",extensions:["csp"]},"application/vnd.contact.cmsg":{source:"iana",extensions:["cdbcmsg"]},"application/vnd.coreos.ignition+json":{source:"iana",compressible:!0},"application/vnd.cosmocaller":{source:"iana",extensions:["cmc"]},"application/vnd.crick.clicker":{source:"iana",extensions:["clkx"]},"application/vnd.crick.clicker.keyboard":{source:"iana",extensions:["clkk"]},"application/vnd.crick.clicker.palette":{source:"iana",extensions:["clkp"]},"application/vnd.crick.clicker.template":{source:"iana",extensions:["clkt"]},"application/vnd.crick.clicker.wordbank":{source:"iana",extensions:["clkw"]},"application/vnd.criticaltools.wbs+xml":{source:"iana",compressible:!0,extensions:["wbs"]},"application/vnd.cryptii.pipe+json":{source:"iana",compressible:!0},"application/vnd.crypto-shade-file":{source:"iana"},"application/vnd.cryptomator.encrypted":{source:"iana"},"application/vnd.cryptomator.vault":{source:"iana"},"application/vnd.ctc-posml":{source:"iana",extensions:["pml"]},"application/vnd.ctct.ws+xml":{source:"iana",compressible:!0},"application/vnd.cups-pdf":{source:"iana"},"application/vnd.cups-postscript":{source:"iana"},"application/vnd.cups-ppd":{source:"iana",extensions:["ppd"]},"application/vnd.cups-raster":{source:"iana"},"application/vnd.cups-raw":{source:"iana"},"application/vnd.curl":{source:"iana"},"application/vnd.curl.car":{source:"apache",extensions:["car"]},"application/vnd.curl.pcurl":{source:"apache",extensions:["pcurl"]},"application/vnd.cyan.dean.root+xml":{source:"iana",compressible:!0},"application/vnd.cybank":{source:"iana"},"application/vnd.cyclonedx+json":{source:"iana",compressible:!0},"application/vnd.cyclonedx+xml":{source:"iana",compressible:!0},"application/vnd.d2l.coursepackage1p0+zip":{source:"iana",compressible:!1},"application/vnd.d3m-dataset":{source:"iana"},"application/vnd.d3m-problem":{source:"iana"},"application/vnd.dart":{source:"iana",compressible:!0,extensions:["dart"]},"application/vnd.data-vision.rdz":{source:"iana",extensions:["rdz"]},"application/vnd.datapackage+json":{source:"iana",compressible:!0},"application/vnd.dataresource+json":{source:"iana",compressible:!0},"application/vnd.dbf":{source:"iana",extensions:["dbf"]},"application/vnd.debian.binary-package":{source:"iana"},"application/vnd.dece.data":{source:"iana",extensions:["uvf","uvvf","uvd","uvvd"]},"application/vnd.dece.ttml+xml":{source:"iana",compressible:!0,extensions:["uvt","uvvt"]},"application/vnd.dece.unspecified":{source:"iana",extensions:["uvx","uvvx"]},"application/vnd.dece.zip":{source:"iana",extensions:["uvz","uvvz"]},"application/vnd.denovo.fcselayout-link":{source:"iana",extensions:["fe_launch"]},"application/vnd.desmume.movie":{source:"iana"},"application/vnd.dir-bi.plate-dl-nosuffix":{source:"iana"},"application/vnd.dm.delegation+xml":{source:"iana",compressible:!0},"application/vnd.dna":{source:"iana",extensions:["dna"]},"application/vnd.document+json":{source:"iana",compressible:!0},"application/vnd.dolby.mlp":{source:"apache",extensions:["mlp"]},"application/vnd.dolby.mobile.1":{source:"iana"},"application/vnd.dolby.mobile.2":{source:"iana"},"application/vnd.doremir.scorecloud-binary-document":{source:"iana"},"application/vnd.dpgraph":{source:"iana",extensions:["dpg"]},"application/vnd.dreamfactory":{source:"iana",extensions:["dfac"]},"application/vnd.drive+json":{source:"iana",compressible:!0},"application/vnd.ds-keypoint":{source:"apache",extensions:["kpxx"]},"application/vnd.dtg.local":{source:"iana"},"application/vnd.dtg.local.flash":{source:"iana"},"application/vnd.dtg.local.html":{source:"iana"},"application/vnd.dvb.ait":{source:"iana",extensions:["ait"]},"application/vnd.dvb.dvbisl+xml":{source:"iana",compressible:!0},"application/vnd.dvb.dvbj":{source:"iana"},"application/vnd.dvb.esgcontainer":{source:"iana"},"application/vnd.dvb.ipdcdftnotifaccess":{source:"iana"},"application/vnd.dvb.ipdcesgaccess":{source:"iana"},"application/vnd.dvb.ipdcesgaccess2":{source:"iana"},"application/vnd.dvb.ipdcesgpdd":{source:"iana"},"application/vnd.dvb.ipdcroaming":{source:"iana"},"application/vnd.dvb.iptv.alfec-base":{source:"iana"},"application/vnd.dvb.iptv.alfec-enhancement":{source:"iana"},"application/vnd.dvb.notif-aggregate-root+xml":{source:"iana",compressible:!0},"application/vnd.dvb.notif-container+xml":{source:"iana",compressible:!0},"application/vnd.dvb.notif-generic+xml":{source:"iana",compressible:!0},"application/vnd.dvb.notif-ia-msglist+xml":{source:"iana",compressible:!0},"application/vnd.dvb.notif-ia-registration-request+xml":{source:"iana",compressible:!0},"application/vnd.dvb.notif-ia-registration-response+xml":{source:"iana",compressible:!0},"application/vnd.dvb.notif-init+xml":{source:"iana",compressible:!0},"application/vnd.dvb.pfr":{source:"iana"},"application/vnd.dvb.service":{source:"iana",extensions:["svc"]},"application/vnd.dxr":{source:"iana"},"application/vnd.dynageo":{source:"iana",extensions:["geo"]},"application/vnd.dzr":{source:"iana"},"application/vnd.easykaraoke.cdgdownload":{source:"iana"},"application/vnd.ecdis-update":{source:"iana"},"application/vnd.ecip.rlp":{source:"iana"},"application/vnd.eclipse.ditto+json":{source:"iana",compressible:!0},"application/vnd.ecowin.chart":{source:"iana",extensions:["mag"]},"application/vnd.ecowin.filerequest":{source:"iana"},"application/vnd.ecowin.fileupdate":{source:"iana"},"application/vnd.ecowin.series":{source:"iana"},"application/vnd.ecowin.seriesrequest":{source:"iana"},"application/vnd.ecowin.seriesupdate":{source:"iana"},"application/vnd.efi.img":{source:"iana"},"application/vnd.efi.iso":{source:"iana"},"application/vnd.emclient.accessrequest+xml":{source:"iana",compressible:!0},"application/vnd.enliven":{source:"iana",extensions:["nml"]},"application/vnd.enphase.envoy":{source:"iana"},"application/vnd.eprints.data+xml":{source:"iana",compressible:!0},"application/vnd.epson.esf":{source:"iana",extensions:["esf"]},"application/vnd.epson.msf":{source:"iana",extensions:["msf"]},"application/vnd.epson.quickanime":{source:"iana",extensions:["qam"]},"application/vnd.epson.salt":{source:"iana",extensions:["slt"]},"application/vnd.epson.ssf":{source:"iana",extensions:["ssf"]},"application/vnd.ericsson.quickcall":{source:"iana"},"application/vnd.espass-espass+zip":{source:"iana",compressible:!1},"application/vnd.eszigno3+xml":{source:"iana",compressible:!0,extensions:["es3","et3"]},"application/vnd.etsi.aoc+xml":{source:"iana",compressible:!0},"application/vnd.etsi.asic-e+zip":{source:"iana",compressible:!1},"application/vnd.etsi.asic-s+zip":{source:"iana",compressible:!1},"application/vnd.etsi.cug+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvcommand+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvdiscovery+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvprofile+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvsad-bc+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvsad-cod+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvsad-npvr+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvservice+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvsync+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvueprofile+xml":{source:"iana",compressible:!0},"application/vnd.etsi.mcid+xml":{source:"iana",compressible:!0},"application/vnd.etsi.mheg5":{source:"iana"},"application/vnd.etsi.overload-control-policy-dataset+xml":{source:"iana",compressible:!0},"application/vnd.etsi.pstn+xml":{source:"iana",compressible:!0},"application/vnd.etsi.sci+xml":{source:"iana",compressible:!0},"application/vnd.etsi.simservs+xml":{source:"iana",compressible:!0},"application/vnd.etsi.timestamp-token":{source:"iana"},"application/vnd.etsi.tsl+xml":{source:"iana",compressible:!0},"application/vnd.etsi.tsl.der":{source:"iana"},"application/vnd.eu.kasparian.car+json":{source:"iana",compressible:!0},"application/vnd.eudora.data":{source:"iana"},"application/vnd.evolv.ecig.profile":{source:"iana"},"application/vnd.evolv.ecig.settings":{source:"iana"},"application/vnd.evolv.ecig.theme":{source:"iana"},"application/vnd.exstream-empower+zip":{source:"iana",compressible:!1},"application/vnd.exstream-package":{source:"iana"},"application/vnd.ezpix-album":{source:"iana",extensions:["ez2"]},"application/vnd.ezpix-package":{source:"iana",extensions:["ez3"]},"application/vnd.f-secure.mobile":{source:"iana"},"application/vnd.familysearch.gedcom+zip":{source:"iana",compressible:!1},"application/vnd.fastcopy-disk-image":{source:"iana"},"application/vnd.fdf":{source:"iana",extensions:["fdf"]},"application/vnd.fdsn.mseed":{source:"iana",extensions:["mseed"]},"application/vnd.fdsn.seed":{source:"iana",extensions:["seed","dataless"]},"application/vnd.ffsns":{source:"iana"},"application/vnd.ficlab.flb+zip":{source:"iana",compressible:!1},"application/vnd.filmit.zfc":{source:"iana"},"application/vnd.fints":{source:"iana"},"application/vnd.firemonkeys.cloudcell":{source:"iana"},"application/vnd.flographit":{source:"iana",extensions:["gph"]},"application/vnd.fluxtime.clip":{source:"iana",extensions:["ftc"]},"application/vnd.font-fontforge-sfd":{source:"iana"},"application/vnd.framemaker":{source:"iana",extensions:["fm","frame","maker","book"]},"application/vnd.frogans.fnc":{source:"iana",extensions:["fnc"]},"application/vnd.frogans.ltf":{source:"iana",extensions:["ltf"]},"application/vnd.fsc.weblaunch":{source:"iana",extensions:["fsc"]},"application/vnd.fujifilm.fb.docuworks":{source:"iana"},"application/vnd.fujifilm.fb.docuworks.binder":{source:"iana"},"application/vnd.fujifilm.fb.docuworks.container":{source:"iana"},"application/vnd.fujifilm.fb.jfi+xml":{source:"iana",compressible:!0},"application/vnd.fujitsu.oasys":{source:"iana",extensions:["oas"]},"application/vnd.fujitsu.oasys2":{source:"iana",extensions:["oa2"]},"application/vnd.fujitsu.oasys3":{source:"iana",extensions:["oa3"]},"application/vnd.fujitsu.oasysgp":{source:"iana",extensions:["fg5"]},"application/vnd.fujitsu.oasysprs":{source:"iana",extensions:["bh2"]},"application/vnd.fujixerox.art-ex":{source:"iana"},"application/vnd.fujixerox.art4":{source:"iana"},"application/vnd.fujixerox.ddd":{source:"iana",extensions:["ddd"]},"application/vnd.fujixerox.docuworks":{source:"iana",extensions:["xdw"]},"application/vnd.fujixerox.docuworks.binder":{source:"iana",extensions:["xbd"]},"application/vnd.fujixerox.docuworks.container":{source:"iana"},"application/vnd.fujixerox.hbpl":{source:"iana"},"application/vnd.fut-misnet":{source:"iana"},"application/vnd.futoin+cbor":{source:"iana"},"application/vnd.futoin+json":{source:"iana",compressible:!0},"application/vnd.fuzzysheet":{source:"iana",extensions:["fzs"]},"application/vnd.genomatix.tuxedo":{source:"iana",extensions:["txd"]},"application/vnd.gentics.grd+json":{source:"iana",compressible:!0},"application/vnd.geo+json":{source:"iana",compressible:!0},"application/vnd.geocube+xml":{source:"iana",compressible:!0},"application/vnd.geogebra.file":{source:"iana",extensions:["ggb"]},"application/vnd.geogebra.slides":{source:"iana"},"application/vnd.geogebra.tool":{source:"iana",extensions:["ggt"]},"application/vnd.geometry-explorer":{source:"iana",extensions:["gex","gre"]},"application/vnd.geonext":{source:"iana",extensions:["gxt"]},"application/vnd.geoplan":{source:"iana",extensions:["g2w"]},"application/vnd.geospace":{source:"iana",extensions:["g3w"]},"application/vnd.gerber":{source:"iana"},"application/vnd.globalplatform.card-content-mgt":{source:"iana"},"application/vnd.globalplatform.card-content-mgt-response":{source:"iana"},"application/vnd.gmx":{source:"iana",extensions:["gmx"]},"application/vnd.google-apps.document":{compressible:!1,extensions:["gdoc"]},"application/vnd.google-apps.presentation":{compressible:!1,extensions:["gslides"]},"application/vnd.google-apps.spreadsheet":{compressible:!1,extensions:["gsheet"]},"application/vnd.google-earth.kml+xml":{source:"iana",compressible:!0,extensions:["kml"]},"application/vnd.google-earth.kmz":{source:"iana",compressible:!1,extensions:["kmz"]},"application/vnd.gov.sk.e-form+xml":{source:"iana",compressible:!0},"application/vnd.gov.sk.e-form+zip":{source:"iana",compressible:!1},"application/vnd.gov.sk.xmldatacontainer+xml":{source:"iana",compressible:!0},"application/vnd.grafeq":{source:"iana",extensions:["gqf","gqs"]},"application/vnd.gridmp":{source:"iana"},"application/vnd.groove-account":{source:"iana",extensions:["gac"]},"application/vnd.groove-help":{source:"iana",extensions:["ghf"]},"application/vnd.groove-identity-message":{source:"iana",extensions:["gim"]},"application/vnd.groove-injector":{source:"iana",extensions:["grv"]},"application/vnd.groove-tool-message":{source:"iana",extensions:["gtm"]},"application/vnd.groove-tool-template":{source:"iana",extensions:["tpl"]},"application/vnd.groove-vcard":{source:"iana",extensions:["vcg"]},"application/vnd.hal+json":{source:"iana",compressible:!0},"application/vnd.hal+xml":{source:"iana",compressible:!0,extensions:["hal"]},"application/vnd.handheld-entertainment+xml":{source:"iana",compressible:!0,extensions:["zmm"]},"application/vnd.hbci":{source:"iana",extensions:["hbci"]},"application/vnd.hc+json":{source:"iana",compressible:!0},"application/vnd.hcl-bireports":{source:"iana"},"application/vnd.hdt":{source:"iana"},"application/vnd.heroku+json":{source:"iana",compressible:!0},"application/vnd.hhe.lesson-player":{source:"iana",extensions:["les"]},"application/vnd.hl7cda+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/vnd.hl7v2+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/vnd.hp-hpgl":{source:"iana",extensions:["hpgl"]},"application/vnd.hp-hpid":{source:"iana",extensions:["hpid"]},"application/vnd.hp-hps":{source:"iana",extensions:["hps"]},"application/vnd.hp-jlyt":{source:"iana",extensions:["jlt"]},"application/vnd.hp-pcl":{source:"iana",extensions:["pcl"]},"application/vnd.hp-pclxl":{source:"iana",extensions:["pclxl"]},"application/vnd.httphone":{source:"iana"},"application/vnd.hydrostatix.sof-data":{source:"iana",extensions:["sfd-hdstx"]},"application/vnd.hyper+json":{source:"iana",compressible:!0},"application/vnd.hyper-item+json":{source:"iana",compressible:!0},"application/vnd.hyperdrive+json":{source:"iana",compressible:!0},"application/vnd.hzn-3d-crossword":{source:"iana"},"application/vnd.ibm.afplinedata":{source:"iana"},"application/vnd.ibm.electronic-media":{source:"iana"},"application/vnd.ibm.minipay":{source:"iana",extensions:["mpy"]},"application/vnd.ibm.modcap":{source:"iana",extensions:["afp","listafp","list3820"]},"application/vnd.ibm.rights-management":{source:"iana",extensions:["irm"]},"application/vnd.ibm.secure-container":{source:"iana",extensions:["sc"]},"application/vnd.iccprofile":{source:"iana",extensions:["icc","icm"]},"application/vnd.ieee.1905":{source:"iana"},"application/vnd.igloader":{source:"iana",extensions:["igl"]},"application/vnd.imagemeter.folder+zip":{source:"iana",compressible:!1},"application/vnd.imagemeter.image+zip":{source:"iana",compressible:!1},"application/vnd.immervision-ivp":{source:"iana",extensions:["ivp"]},"application/vnd.immervision-ivu":{source:"iana",extensions:["ivu"]},"application/vnd.ims.imsccv1p1":{source:"iana"},"application/vnd.ims.imsccv1p2":{source:"iana"},"application/vnd.ims.imsccv1p3":{source:"iana"},"application/vnd.ims.lis.v2.result+json":{source:"iana",compressible:!0},"application/vnd.ims.lti.v2.toolconsumerprofile+json":{source:"iana",compressible:!0},"application/vnd.ims.lti.v2.toolproxy+json":{source:"iana",compressible:!0},"application/vnd.ims.lti.v2.toolproxy.id+json":{source:"iana",compressible:!0},"application/vnd.ims.lti.v2.toolsettings+json":{source:"iana",compressible:!0},"application/vnd.ims.lti.v2.toolsettings.simple+json":{source:"iana",compressible:!0},"application/vnd.informedcontrol.rms+xml":{source:"iana",compressible:!0},"application/vnd.informix-visionary":{source:"iana"},"application/vnd.infotech.project":{source:"iana"},"application/vnd.infotech.project+xml":{source:"iana",compressible:!0},"application/vnd.innopath.wamp.notification":{source:"iana"},"application/vnd.insors.igm":{source:"iana",extensions:["igm"]},"application/vnd.intercon.formnet":{source:"iana",extensions:["xpw","xpx"]},"application/vnd.intergeo":{source:"iana",extensions:["i2g"]},"application/vnd.intertrust.digibox":{source:"iana"},"application/vnd.intertrust.nncp":{source:"iana"},"application/vnd.intu.qbo":{source:"iana",extensions:["qbo"]},"application/vnd.intu.qfx":{source:"iana",extensions:["qfx"]},"application/vnd.iptc.g2.catalogitem+xml":{source:"iana",compressible:!0},"application/vnd.iptc.g2.conceptitem+xml":{source:"iana",compressible:!0},"application/vnd.iptc.g2.knowledgeitem+xml":{source:"iana",compressible:!0},"application/vnd.iptc.g2.newsitem+xml":{source:"iana",compressible:!0},"application/vnd.iptc.g2.newsmessage+xml":{source:"iana",compressible:!0},"application/vnd.iptc.g2.packageitem+xml":{source:"iana",compressible:!0},"application/vnd.iptc.g2.planningitem+xml":{source:"iana",compressible:!0},"application/vnd.ipunplugged.rcprofile":{source:"iana",extensions:["rcprofile"]},"application/vnd.irepository.package+xml":{source:"iana",compressible:!0,extensions:["irp"]},"application/vnd.is-xpr":{source:"iana",extensions:["xpr"]},"application/vnd.isac.fcs":{source:"iana",extensions:["fcs"]},"application/vnd.iso11783-10+zip":{source:"iana",compressible:!1},"application/vnd.jam":{source:"iana",extensions:["jam"]},"application/vnd.japannet-directory-service":{source:"iana"},"application/vnd.japannet-jpnstore-wakeup":{source:"iana"},"application/vnd.japannet-payment-wakeup":{source:"iana"},"application/vnd.japannet-registration":{source:"iana"},"application/vnd.japannet-registration-wakeup":{source:"iana"},"application/vnd.japannet-setstore-wakeup":{source:"iana"},"application/vnd.japannet-verification":{source:"iana"},"application/vnd.japannet-verification-wakeup":{source:"iana"},"application/vnd.jcp.javame.midlet-rms":{source:"iana",extensions:["rms"]},"application/vnd.jisp":{source:"iana",extensions:["jisp"]},"application/vnd.joost.joda-archive":{source:"iana",extensions:["joda"]},"application/vnd.jsk.isdn-ngn":{source:"iana"},"application/vnd.kahootz":{source:"iana",extensions:["ktz","ktr"]},"application/vnd.kde.karbon":{source:"iana",extensions:["karbon"]},"application/vnd.kde.kchart":{source:"iana",extensions:["chrt"]},"application/vnd.kde.kformula":{source:"iana",extensions:["kfo"]},"application/vnd.kde.kivio":{source:"iana",extensions:["flw"]},"application/vnd.kde.kontour":{source:"iana",extensions:["kon"]},"application/vnd.kde.kpresenter":{source:"iana",extensions:["kpr","kpt"]},"application/vnd.kde.kspread":{source:"iana",extensions:["ksp"]},"application/vnd.kde.kword":{source:"iana",extensions:["kwd","kwt"]},"application/vnd.kenameaapp":{source:"iana",extensions:["htke"]},"application/vnd.kidspiration":{source:"iana",extensions:["kia"]},"application/vnd.kinar":{source:"iana",extensions:["kne","knp"]},"application/vnd.koan":{source:"iana",extensions:["skp","skd","skt","skm"]},"application/vnd.kodak-descriptor":{source:"iana",extensions:["sse"]},"application/vnd.las":{source:"iana"},"application/vnd.las.las+json":{source:"iana",compressible:!0},"application/vnd.las.las+xml":{source:"iana",compressible:!0,extensions:["lasxml"]},"application/vnd.laszip":{source:"iana"},"application/vnd.leap+json":{source:"iana",compressible:!0},"application/vnd.liberty-request+xml":{source:"iana",compressible:!0},"application/vnd.llamagraphics.life-balance.desktop":{source:"iana",extensions:["lbd"]},"application/vnd.llamagraphics.life-balance.exchange+xml":{source:"iana",compressible:!0,extensions:["lbe"]},"application/vnd.logipipe.circuit+zip":{source:"iana",compressible:!1},"application/vnd.loom":{source:"iana"},"application/vnd.lotus-1-2-3":{source:"iana",extensions:["123"]},"application/vnd.lotus-approach":{source:"iana",extensions:["apr"]},"application/vnd.lotus-freelance":{source:"iana",extensions:["pre"]},"application/vnd.lotus-notes":{source:"iana",extensions:["nsf"]},"application/vnd.lotus-organizer":{source:"iana",extensions:["org"]},"application/vnd.lotus-screencam":{source:"iana",extensions:["scm"]},"application/vnd.lotus-wordpro":{source:"iana",extensions:["lwp"]},"application/vnd.macports.portpkg":{source:"iana",extensions:["portpkg"]},"application/vnd.mapbox-vector-tile":{source:"iana",extensions:["mvt"]},"application/vnd.marlin.drm.actiontoken+xml":{source:"iana",compressible:!0},"application/vnd.marlin.drm.conftoken+xml":{source:"iana",compressible:!0},"application/vnd.marlin.drm.license+xml":{source:"iana",compressible:!0},"application/vnd.marlin.drm.mdcf":{source:"iana"},"application/vnd.mason+json":{source:"iana",compressible:!0},"application/vnd.maxar.archive.3tz+zip":{source:"iana",compressible:!1},"application/vnd.maxmind.maxmind-db":{source:"iana"},"application/vnd.mcd":{source:"iana",extensions:["mcd"]},"application/vnd.medcalcdata":{source:"iana",extensions:["mc1"]},"application/vnd.mediastation.cdkey":{source:"iana",extensions:["cdkey"]},"application/vnd.meridian-slingshot":{source:"iana"},"application/vnd.mfer":{source:"iana",extensions:["mwf"]},"application/vnd.mfmp":{source:"iana",extensions:["mfm"]},"application/vnd.micro+json":{source:"iana",compressible:!0},"application/vnd.micrografx.flo":{source:"iana",extensions:["flo"]},"application/vnd.micrografx.igx":{source:"iana",extensions:["igx"]},"application/vnd.microsoft.portable-executable":{source:"iana"},"application/vnd.microsoft.windows.thumbnail-cache":{source:"iana"},"application/vnd.miele+json":{source:"iana",compressible:!0},"application/vnd.mif":{source:"iana",extensions:["mif"]},"application/vnd.minisoft-hp3000-save":{source:"iana"},"application/vnd.mitsubishi.misty-guard.trustweb":{source:"iana"},"application/vnd.mobius.daf":{source:"iana",extensions:["daf"]},"application/vnd.mobius.dis":{source:"iana",extensions:["dis"]},"application/vnd.mobius.mbk":{source:"iana",extensions:["mbk"]},"application/vnd.mobius.mqy":{source:"iana",extensions:["mqy"]},"application/vnd.mobius.msl":{source:"iana",extensions:["msl"]},"application/vnd.mobius.plc":{source:"iana",extensions:["plc"]},"application/vnd.mobius.txf":{source:"iana",extensions:["txf"]},"application/vnd.mophun.application":{source:"iana",extensions:["mpn"]},"application/vnd.mophun.certificate":{source:"iana",extensions:["mpc"]},"application/vnd.motorola.flexsuite":{source:"iana"},"application/vnd.motorola.flexsuite.adsi":{source:"iana"},"application/vnd.motorola.flexsuite.fis":{source:"iana"},"application/vnd.motorola.flexsuite.gotap":{source:"iana"},"application/vnd.motorola.flexsuite.kmr":{source:"iana"},"application/vnd.motorola.flexsuite.ttc":{source:"iana"},"application/vnd.motorola.flexsuite.wem":{source:"iana"},"application/vnd.motorola.iprm":{source:"iana"},"application/vnd.mozilla.xul+xml":{source:"iana",compressible:!0,extensions:["xul"]},"application/vnd.ms-3mfdocument":{source:"iana"},"application/vnd.ms-artgalry":{source:"iana",extensions:["cil"]},"application/vnd.ms-asf":{source:"iana"},"application/vnd.ms-cab-compressed":{source:"iana",extensions:["cab"]},"application/vnd.ms-color.iccprofile":{source:"apache"},"application/vnd.ms-excel":{source:"iana",compressible:!1,extensions:["xls","xlm","xla","xlc","xlt","xlw"]},"application/vnd.ms-excel.addin.macroenabled.12":{source:"iana",extensions:["xlam"]},"application/vnd.ms-excel.sheet.binary.macroenabled.12":{source:"iana",extensions:["xlsb"]},"application/vnd.ms-excel.sheet.macroenabled.12":{source:"iana",extensions:["xlsm"]},"application/vnd.ms-excel.template.macroenabled.12":{source:"iana",extensions:["xltm"]},"application/vnd.ms-fontobject":{source:"iana",compressible:!0,extensions:["eot"]},"application/vnd.ms-htmlhelp":{source:"iana",extensions:["chm"]},"application/vnd.ms-ims":{source:"iana",extensions:["ims"]},"application/vnd.ms-lrm":{source:"iana",extensions:["lrm"]},"application/vnd.ms-office.activex+xml":{source:"iana",compressible:!0},"application/vnd.ms-officetheme":{source:"iana",extensions:["thmx"]},"application/vnd.ms-opentype":{source:"apache",compressible:!0},"application/vnd.ms-outlook":{compressible:!1,extensions:["msg"]},"application/vnd.ms-package.obfuscated-opentype":{source:"apache"},"application/vnd.ms-pki.seccat":{source:"apache",extensions:["cat"]},"application/vnd.ms-pki.stl":{source:"apache",extensions:["stl"]},"application/vnd.ms-playready.initiator+xml":{source:"iana",compressible:!0},"application/vnd.ms-powerpoint":{source:"iana",compressible:!1,extensions:["ppt","pps","pot"]},"application/vnd.ms-powerpoint.addin.macroenabled.12":{source:"iana",extensions:["ppam"]},"application/vnd.ms-powerpoint.presentation.macroenabled.12":{source:"iana",extensions:["pptm"]},"application/vnd.ms-powerpoint.slide.macroenabled.12":{source:"iana",extensions:["sldm"]},"application/vnd.ms-powerpoint.slideshow.macroenabled.12":{source:"iana",extensions:["ppsm"]},"application/vnd.ms-powerpoint.template.macroenabled.12":{source:"iana",extensions:["potm"]},"application/vnd.ms-printdevicecapabilities+xml":{source:"iana",compressible:!0},"application/vnd.ms-printing.printticket+xml":{source:"apache",compressible:!0},"application/vnd.ms-printschematicket+xml":{source:"iana",compressible:!0},"application/vnd.ms-project":{source:"iana",extensions:["mpp","mpt"]},"application/vnd.ms-tnef":{source:"iana"},"application/vnd.ms-windows.devicepairing":{source:"iana"},"application/vnd.ms-windows.nwprinting.oob":{source:"iana"},"application/vnd.ms-windows.printerpairing":{source:"iana"},"application/vnd.ms-windows.wsd.oob":{source:"iana"},"application/vnd.ms-wmdrm.lic-chlg-req":{source:"iana"},"application/vnd.ms-wmdrm.lic-resp":{source:"iana"},"application/vnd.ms-wmdrm.meter-chlg-req":{source:"iana"},"application/vnd.ms-wmdrm.meter-resp":{source:"iana"},"application/vnd.ms-word.document.macroenabled.12":{source:"iana",extensions:["docm"]},"application/vnd.ms-word.template.macroenabled.12":{source:"iana",extensions:["dotm"]},"application/vnd.ms-works":{source:"iana",extensions:["wps","wks","wcm","wdb"]},"application/vnd.ms-wpl":{source:"iana",extensions:["wpl"]},"application/vnd.ms-xpsdocument":{source:"iana",compressible:!1,extensions:["xps"]},"application/vnd.msa-disk-image":{source:"iana"},"application/vnd.mseq":{source:"iana",extensions:["mseq"]},"application/vnd.msign":{source:"iana"},"application/vnd.multiad.creator":{source:"iana"},"application/vnd.multiad.creator.cif":{source:"iana"},"application/vnd.music-niff":{source:"iana"},"application/vnd.musician":{source:"iana",extensions:["mus"]},"application/vnd.muvee.style":{source:"iana",extensions:["msty"]},"application/vnd.mynfc":{source:"iana",extensions:["taglet"]},"application/vnd.nacamar.ybrid+json":{source:"iana",compressible:!0},"application/vnd.ncd.control":{source:"iana"},"application/vnd.ncd.reference":{source:"iana"},"application/vnd.nearst.inv+json":{source:"iana",compressible:!0},"application/vnd.nebumind.line":{source:"iana"},"application/vnd.nervana":{source:"iana"},"application/vnd.netfpx":{source:"iana"},"application/vnd.neurolanguage.nlu":{source:"iana",extensions:["nlu"]},"application/vnd.nimn":{source:"iana"},"application/vnd.nintendo.nitro.rom":{source:"iana"},"application/vnd.nintendo.snes.rom":{source:"iana"},"application/vnd.nitf":{source:"iana",extensions:["ntf","nitf"]},"application/vnd.noblenet-directory":{source:"iana",extensions:["nnd"]},"application/vnd.noblenet-sealer":{source:"iana",extensions:["nns"]},"application/vnd.noblenet-web":{source:"iana",extensions:["nnw"]},"application/vnd.nokia.catalogs":{source:"iana"},"application/vnd.nokia.conml+wbxml":{source:"iana"},"application/vnd.nokia.conml+xml":{source:"iana",compressible:!0},"application/vnd.nokia.iptv.config+xml":{source:"iana",compressible:!0},"application/vnd.nokia.isds-radio-presets":{source:"iana"},"application/vnd.nokia.landmark+wbxml":{source:"iana"},"application/vnd.nokia.landmark+xml":{source:"iana",compressible:!0},"application/vnd.nokia.landmarkcollection+xml":{source:"iana",compressible:!0},"application/vnd.nokia.n-gage.ac+xml":{source:"iana",compressible:!0,extensions:["ac"]},"application/vnd.nokia.n-gage.data":{source:"iana",extensions:["ngdat"]},"application/vnd.nokia.n-gage.symbian.install":{source:"iana",extensions:["n-gage"]},"application/vnd.nokia.ncd":{source:"iana"},"application/vnd.nokia.pcd+wbxml":{source:"iana"},"application/vnd.nokia.pcd+xml":{source:"iana",compressible:!0},"application/vnd.nokia.radio-preset":{source:"iana",extensions:["rpst"]},"application/vnd.nokia.radio-presets":{source:"iana",extensions:["rpss"]},"application/vnd.novadigm.edm":{source:"iana",extensions:["edm"]},"application/vnd.novadigm.edx":{source:"iana",extensions:["edx"]},"application/vnd.novadigm.ext":{source:"iana",extensions:["ext"]},"application/vnd.ntt-local.content-share":{source:"iana"},"application/vnd.ntt-local.file-transfer":{source:"iana"},"application/vnd.ntt-local.ogw_remote-access":{source:"iana"},"application/vnd.ntt-local.sip-ta_remote":{source:"iana"},"application/vnd.ntt-local.sip-ta_tcp_stream":{source:"iana"},"application/vnd.oasis.opendocument.chart":{source:"iana",extensions:["odc"]},"application/vnd.oasis.opendocument.chart-template":{source:"iana",extensions:["otc"]},"application/vnd.oasis.opendocument.database":{source:"iana",extensions:["odb"]},"application/vnd.oasis.opendocument.formula":{source:"iana",extensions:["odf"]},"application/vnd.oasis.opendocument.formula-template":{source:"iana",extensions:["odft"]},"application/vnd.oasis.opendocument.graphics":{source:"iana",compressible:!1,extensions:["odg"]},"application/vnd.oasis.opendocument.graphics-template":{source:"iana",extensions:["otg"]},"application/vnd.oasis.opendocument.image":{source:"iana",extensions:["odi"]},"application/vnd.oasis.opendocument.image-template":{source:"iana",extensions:["oti"]},"application/vnd.oasis.opendocument.presentation":{source:"iana",compressible:!1,extensions:["odp"]},"application/vnd.oasis.opendocument.presentation-template":{source:"iana",extensions:["otp"]},"application/vnd.oasis.opendocument.spreadsheet":{source:"iana",compressible:!1,extensions:["ods"]},"application/vnd.oasis.opendocument.spreadsheet-template":{source:"iana",extensions:["ots"]},"application/vnd.oasis.opendocument.text":{source:"iana",compressible:!1,extensions:["odt"]},"application/vnd.oasis.opendocument.text-master":{source:"iana",extensions:["odm"]},"application/vnd.oasis.opendocument.text-template":{source:"iana",extensions:["ott"]},"application/vnd.oasis.opendocument.text-web":{source:"iana",extensions:["oth"]},"application/vnd.obn":{source:"iana"},"application/vnd.ocf+cbor":{source:"iana"},"application/vnd.oci.image.manifest.v1+json":{source:"iana",compressible:!0},"application/vnd.oftn.l10n+json":{source:"iana",compressible:!0},"application/vnd.oipf.contentaccessdownload+xml":{source:"iana",compressible:!0},"application/vnd.oipf.contentaccessstreaming+xml":{source:"iana",compressible:!0},"application/vnd.oipf.cspg-hexbinary":{source:"iana"},"application/vnd.oipf.dae.svg+xml":{source:"iana",compressible:!0},"application/vnd.oipf.dae.xhtml+xml":{source:"iana",compressible:!0},"application/vnd.oipf.mippvcontrolmessage+xml":{source:"iana",compressible:!0},"application/vnd.oipf.pae.gem":{source:"iana"},"application/vnd.oipf.spdiscovery+xml":{source:"iana",compressible:!0},"application/vnd.oipf.spdlist+xml":{source:"iana",compressible:!0},"application/vnd.oipf.ueprofile+xml":{source:"iana",compressible:!0},"application/vnd.oipf.userprofile+xml":{source:"iana",compressible:!0},"application/vnd.olpc-sugar":{source:"iana",extensions:["xo"]},"application/vnd.oma-scws-config":{source:"iana"},"application/vnd.oma-scws-http-request":{source:"iana"},"application/vnd.oma-scws-http-response":{source:"iana"},"application/vnd.oma.bcast.associated-procedure-parameter+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.drm-trigger+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.imd+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.ltkm":{source:"iana"},"application/vnd.oma.bcast.notification+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.provisioningtrigger":{source:"iana"},"application/vnd.oma.bcast.sgboot":{source:"iana"},"application/vnd.oma.bcast.sgdd+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.sgdu":{source:"iana"},"application/vnd.oma.bcast.simple-symbol-container":{source:"iana"},"application/vnd.oma.bcast.smartcard-trigger+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.sprov+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.stkm":{source:"iana"},"application/vnd.oma.cab-address-book+xml":{source:"iana",compressible:!0},"application/vnd.oma.cab-feature-handler+xml":{source:"iana",compressible:!0},"application/vnd.oma.cab-pcc+xml":{source:"iana",compressible:!0},"application/vnd.oma.cab-subs-invite+xml":{source:"iana",compressible:!0},"application/vnd.oma.cab-user-prefs+xml":{source:"iana",compressible:!0},"application/vnd.oma.dcd":{source:"iana"},"application/vnd.oma.dcdc":{source:"iana"},"application/vnd.oma.dd2+xml":{source:"iana",compressible:!0,extensions:["dd2"]},"application/vnd.oma.drm.risd+xml":{source:"iana",compressible:!0},"application/vnd.oma.group-usage-list+xml":{source:"iana",compressible:!0},"application/vnd.oma.lwm2m+cbor":{source:"iana"},"application/vnd.oma.lwm2m+json":{source:"iana",compressible:!0},"application/vnd.oma.lwm2m+tlv":{source:"iana"},"application/vnd.oma.pal+xml":{source:"iana",compressible:!0},"application/vnd.oma.poc.detailed-progress-report+xml":{source:"iana",compressible:!0},"application/vnd.oma.poc.final-report+xml":{source:"iana",compressible:!0},"application/vnd.oma.poc.groups+xml":{source:"iana",compressible:!0},"application/vnd.oma.poc.invocation-descriptor+xml":{source:"iana",compressible:!0},"application/vnd.oma.poc.optimized-progress-report+xml":{source:"iana",compressible:!0},"application/vnd.oma.push":{source:"iana"},"application/vnd.oma.scidm.messages+xml":{source:"iana",compressible:!0},"application/vnd.oma.xcap-directory+xml":{source:"iana",compressible:!0},"application/vnd.omads-email+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/vnd.omads-file+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/vnd.omads-folder+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/vnd.omaloc-supl-init":{source:"iana"},"application/vnd.onepager":{source:"iana"},"application/vnd.onepagertamp":{source:"iana"},"application/vnd.onepagertamx":{source:"iana"},"application/vnd.onepagertat":{source:"iana"},"application/vnd.onepagertatp":{source:"iana"},"application/vnd.onepagertatx":{source:"iana"},"application/vnd.openblox.game+xml":{source:"iana",compressible:!0,extensions:["obgx"]},"application/vnd.openblox.game-binary":{source:"iana"},"application/vnd.openeye.oeb":{source:"iana"},"application/vnd.openofficeorg.extension":{source:"apache",extensions:["oxt"]},"application/vnd.openstreetmap.data+xml":{source:"iana",compressible:!0,extensions:["osm"]},"application/vnd.opentimestamps.ots":{source:"iana"},"application/vnd.openxmlformats-officedocument.custom-properties+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.customxmlproperties+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawing+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawingml.chart+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawingml.diagramcolors+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawingml.diagramdata+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawingml.diagramlayout+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawingml.diagramstyle+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.extended-properties+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.commentauthors+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.comments+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.handoutmaster+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.notesmaster+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.notesslide+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.presentation":{source:"iana",compressible:!1,extensions:["pptx"]},"application/vnd.openxmlformats-officedocument.presentationml.presentation.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.presprops+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.slide":{source:"iana",extensions:["sldx"]},"application/vnd.openxmlformats-officedocument.presentationml.slide+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.slidelayout+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.slidemaster+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.slideshow":{source:"iana",extensions:["ppsx"]},"application/vnd.openxmlformats-officedocument.presentationml.slideshow.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.slideupdateinfo+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.tablestyles+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.tags+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.template":{source:"iana",extensions:["potx"]},"application/vnd.openxmlformats-officedocument.presentationml.template.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.viewprops+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.calcchain+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.externallink+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotcachedefinition+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotcacherecords+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.pivottable+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.querytable+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionheaders+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionlog+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedstrings+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":{source:"iana",compressible:!1,extensions:["xlsx"]},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetmetadata+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.tablesinglecells+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.template":{source:"iana",extensions:["xltx"]},"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.usernames+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.volatiledependencies+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.theme+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.themeoverride+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.vmldrawing":{source:"iana"},"application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.document":{source:"iana",compressible:!1,extensions:["docx"]},"application/vnd.openxmlformats-officedocument.wordprocessingml.document.glossary+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.endnotes+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.fonttable+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.template":{source:"iana",extensions:["dotx"]},"application/vnd.openxmlformats-officedocument.wordprocessingml.template.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.websettings+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-package.core-properties+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-package.digital-signature-xmlsignature+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-package.relationships+xml":{source:"iana",compressible:!0},"application/vnd.oracle.resource+json":{source:"iana",compressible:!0},"application/vnd.orange.indata":{source:"iana"},"application/vnd.osa.netdeploy":{source:"iana"},"application/vnd.osgeo.mapguide.package":{source:"iana",extensions:["mgp"]},"application/vnd.osgi.bundle":{source:"iana"},"application/vnd.osgi.dp":{source:"iana",extensions:["dp"]},"application/vnd.osgi.subsystem":{source:"iana",extensions:["esa"]},"application/vnd.otps.ct-kip+xml":{source:"iana",compressible:!0},"application/vnd.oxli.countgraph":{source:"iana"},"application/vnd.pagerduty+json":{source:"iana",compressible:!0},"application/vnd.palm":{source:"iana",extensions:["pdb","pqa","oprc"]},"application/vnd.panoply":{source:"iana"},"application/vnd.paos.xml":{source:"iana"},"application/vnd.patentdive":{source:"iana"},"application/vnd.patientecommsdoc":{source:"iana"},"application/vnd.pawaafile":{source:"iana",extensions:["paw"]},"application/vnd.pcos":{source:"iana"},"application/vnd.pg.format":{source:"iana",extensions:["str"]},"application/vnd.pg.osasli":{source:"iana",extensions:["ei6"]},"application/vnd.piaccess.application-licence":{source:"iana"},"application/vnd.picsel":{source:"iana",extensions:["efif"]},"application/vnd.pmi.widget":{source:"iana",extensions:["wg"]},"application/vnd.poc.group-advertisement+xml":{source:"iana",compressible:!0},"application/vnd.pocketlearn":{source:"iana",extensions:["plf"]},"application/vnd.powerbuilder6":{source:"iana",extensions:["pbd"]},"application/vnd.powerbuilder6-s":{source:"iana"},"application/vnd.powerbuilder7":{source:"iana"},"application/vnd.powerbuilder7-s":{source:"iana"},"application/vnd.powerbuilder75":{source:"iana"},"application/vnd.powerbuilder75-s":{source:"iana"},"application/vnd.preminet":{source:"iana"},"application/vnd.previewsystems.box":{source:"iana",extensions:["box"]},"application/vnd.proteus.magazine":{source:"iana",extensions:["mgz"]},"application/vnd.psfs":{source:"iana"},"application/vnd.publishare-delta-tree":{source:"iana",extensions:["qps"]},"application/vnd.pvi.ptid1":{source:"iana",extensions:["ptid"]},"application/vnd.pwg-multiplexed":{source:"iana"},"application/vnd.pwg-xhtml-print+xml":{source:"iana",compressible:!0},"application/vnd.qualcomm.brew-app-res":{source:"iana"},"application/vnd.quarantainenet":{source:"iana"},"application/vnd.quark.quarkxpress":{source:"iana",extensions:["qxd","qxt","qwd","qwt","qxl","qxb"]},"application/vnd.quobject-quoxdocument":{source:"iana"},"application/vnd.radisys.moml+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-audit+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-audit-conf+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-audit-conn+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-audit-dialog+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-audit-stream+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-conf+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog-base+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog-fax-detect+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog-fax-sendrecv+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog-group+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog-speech+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog-transform+xml":{source:"iana",compressible:!0},"application/vnd.rainstor.data":{source:"iana"},"application/vnd.rapid":{source:"iana"},"application/vnd.rar":{source:"iana",extensions:["rar"]},"application/vnd.realvnc.bed":{source:"iana",extensions:["bed"]},"application/vnd.recordare.musicxml":{source:"iana",extensions:["mxl"]},"application/vnd.recordare.musicxml+xml":{source:"iana",compressible:!0,extensions:["musicxml"]},"application/vnd.renlearn.rlprint":{source:"iana"},"application/vnd.resilient.logic":{source:"iana"},"application/vnd.restful+json":{source:"iana",compressible:!0},"application/vnd.rig.cryptonote":{source:"iana",extensions:["cryptonote"]},"application/vnd.rim.cod":{source:"apache",extensions:["cod"]},"application/vnd.rn-realmedia":{source:"apache",extensions:["rm"]},"application/vnd.rn-realmedia-vbr":{source:"apache",extensions:["rmvb"]},"application/vnd.route66.link66+xml":{source:"iana",compressible:!0,extensions:["link66"]},"application/vnd.rs-274x":{source:"iana"},"application/vnd.ruckus.download":{source:"iana"},"application/vnd.s3sms":{source:"iana"},"application/vnd.sailingtracker.track":{source:"iana",extensions:["st"]},"application/vnd.sar":{source:"iana"},"application/vnd.sbm.cid":{source:"iana"},"application/vnd.sbm.mid2":{source:"iana"},"application/vnd.scribus":{source:"iana"},"application/vnd.sealed.3df":{source:"iana"},"application/vnd.sealed.csf":{source:"iana"},"application/vnd.sealed.doc":{source:"iana"},"application/vnd.sealed.eml":{source:"iana"},"application/vnd.sealed.mht":{source:"iana"},"application/vnd.sealed.net":{source:"iana"},"application/vnd.sealed.ppt":{source:"iana"},"application/vnd.sealed.tiff":{source:"iana"},"application/vnd.sealed.xls":{source:"iana"},"application/vnd.sealedmedia.softseal.html":{source:"iana"},"application/vnd.sealedmedia.softseal.pdf":{source:"iana"},"application/vnd.seemail":{source:"iana",extensions:["see"]},"application/vnd.seis+json":{source:"iana",compressible:!0},"application/vnd.sema":{source:"iana",extensions:["sema"]},"application/vnd.semd":{source:"iana",extensions:["semd"]},"application/vnd.semf":{source:"iana",extensions:["semf"]},"application/vnd.shade-save-file":{source:"iana"},"application/vnd.shana.informed.formdata":{source:"iana",extensions:["ifm"]},"application/vnd.shana.informed.formtemplate":{source:"iana",extensions:["itp"]},"application/vnd.shana.informed.interchange":{source:"iana",extensions:["iif"]},"application/vnd.shana.informed.package":{source:"iana",extensions:["ipk"]},"application/vnd.shootproof+json":{source:"iana",compressible:!0},"application/vnd.shopkick+json":{source:"iana",compressible:!0},"application/vnd.shp":{source:"iana"},"application/vnd.shx":{source:"iana"},"application/vnd.sigrok.session":{source:"iana"},"application/vnd.simtech-mindmapper":{source:"iana",extensions:["twd","twds"]},"application/vnd.siren+json":{source:"iana",compressible:!0},"application/vnd.smaf":{source:"iana",extensions:["mmf"]},"application/vnd.smart.notebook":{source:"iana"},"application/vnd.smart.teacher":{source:"iana",extensions:["teacher"]},"application/vnd.snesdev-page-table":{source:"iana"},"application/vnd.software602.filler.form+xml":{source:"iana",compressible:!0,extensions:["fo"]},"application/vnd.software602.filler.form-xml-zip":{source:"iana"},"application/vnd.solent.sdkm+xml":{source:"iana",compressible:!0,extensions:["sdkm","sdkd"]},"application/vnd.spotfire.dxp":{source:"iana",extensions:["dxp"]},"application/vnd.spotfire.sfs":{source:"iana",extensions:["sfs"]},"application/vnd.sqlite3":{source:"iana"},"application/vnd.sss-cod":{source:"iana"},"application/vnd.sss-dtf":{source:"iana"},"application/vnd.sss-ntf":{source:"iana"},"application/vnd.stardivision.calc":{source:"apache",extensions:["sdc"]},"application/vnd.stardivision.draw":{source:"apache",extensions:["sda"]},"application/vnd.stardivision.impress":{source:"apache",extensions:["sdd"]},"application/vnd.stardivision.math":{source:"apache",extensions:["smf"]},"application/vnd.stardivision.writer":{source:"apache",extensions:["sdw","vor"]},"application/vnd.stardivision.writer-global":{source:"apache",extensions:["sgl"]},"application/vnd.stepmania.package":{source:"iana",extensions:["smzip"]},"application/vnd.stepmania.stepchart":{source:"iana",extensions:["sm"]},"application/vnd.street-stream":{source:"iana"},"application/vnd.sun.wadl+xml":{source:"iana",compressible:!0,extensions:["wadl"]},"application/vnd.sun.xml.calc":{source:"apache",extensions:["sxc"]},"application/vnd.sun.xml.calc.template":{source:"apache",extensions:["stc"]},"application/vnd.sun.xml.draw":{source:"apache",extensions:["sxd"]},"application/vnd.sun.xml.draw.template":{source:"apache",extensions:["std"]},"application/vnd.sun.xml.impress":{source:"apache",extensions:["sxi"]},"application/vnd.sun.xml.impress.template":{source:"apache",extensions:["sti"]},"application/vnd.sun.xml.math":{source:"apache",extensions:["sxm"]},"application/vnd.sun.xml.writer":{source:"apache",extensions:["sxw"]},"application/vnd.sun.xml.writer.global":{source:"apache",extensions:["sxg"]},"application/vnd.sun.xml.writer.template":{source:"apache",extensions:["stw"]},"application/vnd.sus-calendar":{source:"iana",extensions:["sus","susp"]},"application/vnd.svd":{source:"iana",extensions:["svd"]},"application/vnd.swiftview-ics":{source:"iana"},"application/vnd.sycle+xml":{source:"iana",compressible:!0},"application/vnd.syft+json":{source:"iana",compressible:!0},"application/vnd.symbian.install":{source:"apache",extensions:["sis","sisx"]},"application/vnd.syncml+xml":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["xsm"]},"application/vnd.syncml.dm+wbxml":{source:"iana",charset:"UTF-8",extensions:["bdm"]},"application/vnd.syncml.dm+xml":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["xdm"]},"application/vnd.syncml.dm.notification":{source:"iana"},"application/vnd.syncml.dmddf+wbxml":{source:"iana"},"application/vnd.syncml.dmddf+xml":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["ddf"]},"application/vnd.syncml.dmtnds+wbxml":{source:"iana"},"application/vnd.syncml.dmtnds+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/vnd.syncml.ds.notification":{source:"iana"},"application/vnd.tableschema+json":{source:"iana",compressible:!0},"application/vnd.tao.intent-module-archive":{source:"iana",extensions:["tao"]},"application/vnd.tcpdump.pcap":{source:"iana",extensions:["pcap","cap","dmp"]},"application/vnd.think-cell.ppttc+json":{source:"iana",compressible:!0},"application/vnd.tmd.mediaflex.api+xml":{source:"iana",compressible:!0},"application/vnd.tml":{source:"iana"},"application/vnd.tmobile-livetv":{source:"iana",extensions:["tmo"]},"application/vnd.tri.onesource":{source:"iana"},"application/vnd.trid.tpt":{source:"iana",extensions:["tpt"]},"application/vnd.triscape.mxs":{source:"iana",extensions:["mxs"]},"application/vnd.trueapp":{source:"iana",extensions:["tra"]},"application/vnd.truedoc":{source:"iana"},"application/vnd.ubisoft.webplayer":{source:"iana"},"application/vnd.ufdl":{source:"iana",extensions:["ufd","ufdl"]},"application/vnd.uiq.theme":{source:"iana",extensions:["utz"]},"application/vnd.umajin":{source:"iana",extensions:["umj"]},"application/vnd.unity":{source:"iana",extensions:["unityweb"]},"application/vnd.uoml+xml":{source:"iana",compressible:!0,extensions:["uoml"]},"application/vnd.uplanet.alert":{source:"iana"},"application/vnd.uplanet.alert-wbxml":{source:"iana"},"application/vnd.uplanet.bearer-choice":{source:"iana"},"application/vnd.uplanet.bearer-choice-wbxml":{source:"iana"},"application/vnd.uplanet.cacheop":{source:"iana"},"application/vnd.uplanet.cacheop-wbxml":{source:"iana"},"application/vnd.uplanet.channel":{source:"iana"},"application/vnd.uplanet.channel-wbxml":{source:"iana"},"application/vnd.uplanet.list":{source:"iana"},"application/vnd.uplanet.list-wbxml":{source:"iana"},"application/vnd.uplanet.listcmd":{source:"iana"},"application/vnd.uplanet.listcmd-wbxml":{source:"iana"},"application/vnd.uplanet.signal":{source:"iana"},"application/vnd.uri-map":{source:"iana"},"application/vnd.valve.source.material":{source:"iana"},"application/vnd.vcx":{source:"iana",extensions:["vcx"]},"application/vnd.vd-study":{source:"iana"},"application/vnd.vectorworks":{source:"iana"},"application/vnd.vel+json":{source:"iana",compressible:!0},"application/vnd.verimatrix.vcas":{source:"iana"},"application/vnd.veritone.aion+json":{source:"iana",compressible:!0},"application/vnd.veryant.thin":{source:"iana"},"application/vnd.ves.encrypted":{source:"iana"},"application/vnd.vidsoft.vidconference":{source:"iana"},"application/vnd.visio":{source:"iana",extensions:["vsd","vst","vss","vsw"]},"application/vnd.visionary":{source:"iana",extensions:["vis"]},"application/vnd.vividence.scriptfile":{source:"iana"},"application/vnd.vsf":{source:"iana",extensions:["vsf"]},"application/vnd.wap.sic":{source:"iana"},"application/vnd.wap.slc":{source:"iana"},"application/vnd.wap.wbxml":{source:"iana",charset:"UTF-8",extensions:["wbxml"]},"application/vnd.wap.wmlc":{source:"iana",extensions:["wmlc"]},"application/vnd.wap.wmlscriptc":{source:"iana",extensions:["wmlsc"]},"application/vnd.webturbo":{source:"iana",extensions:["wtb"]},"application/vnd.wfa.dpp":{source:"iana"},"application/vnd.wfa.p2p":{source:"iana"},"application/vnd.wfa.wsc":{source:"iana"},"application/vnd.windows.devicepairing":{source:"iana"},"application/vnd.wmc":{source:"iana"},"application/vnd.wmf.bootstrap":{source:"iana"},"application/vnd.wolfram.mathematica":{source:"iana"},"application/vnd.wolfram.mathematica.package":{source:"iana"},"application/vnd.wolfram.player":{source:"iana",extensions:["nbp"]},"application/vnd.wordperfect":{source:"iana",extensions:["wpd"]},"application/vnd.wqd":{source:"iana",extensions:["wqd"]},"application/vnd.wrq-hp3000-labelled":{source:"iana"},"application/vnd.wt.stf":{source:"iana",extensions:["stf"]},"application/vnd.wv.csp+wbxml":{source:"iana"},"application/vnd.wv.csp+xml":{source:"iana",compressible:!0},"application/vnd.wv.ssp+xml":{source:"iana",compressible:!0},"application/vnd.xacml+json":{source:"iana",compressible:!0},"application/vnd.xara":{source:"iana",extensions:["xar"]},"application/vnd.xfdl":{source:"iana",extensions:["xfdl"]},"application/vnd.xfdl.webform":{source:"iana"},"application/vnd.xmi+xml":{source:"iana",compressible:!0},"application/vnd.xmpie.cpkg":{source:"iana"},"application/vnd.xmpie.dpkg":{source:"iana"},"application/vnd.xmpie.plan":{source:"iana"},"application/vnd.xmpie.ppkg":{source:"iana"},"application/vnd.xmpie.xlim":{source:"iana"},"application/vnd.yamaha.hv-dic":{source:"iana",extensions:["hvd"]},"application/vnd.yamaha.hv-script":{source:"iana",extensions:["hvs"]},"application/vnd.yamaha.hv-voice":{source:"iana",extensions:["hvp"]},"application/vnd.yamaha.openscoreformat":{source:"iana",extensions:["osf"]},"application/vnd.yamaha.openscoreformat.osfpvg+xml":{source:"iana",compressible:!0,extensions:["osfpvg"]},"application/vnd.yamaha.remote-setup":{source:"iana"},"application/vnd.yamaha.smaf-audio":{source:"iana",extensions:["saf"]},"application/vnd.yamaha.smaf-phrase":{source:"iana",extensions:["spf"]},"application/vnd.yamaha.through-ngn":{source:"iana"},"application/vnd.yamaha.tunnel-udpencap":{source:"iana"},"application/vnd.yaoweme":{source:"iana"},"application/vnd.yellowriver-custom-menu":{source:"iana",extensions:["cmp"]},"application/vnd.youtube.yt":{source:"iana"},"application/vnd.zul":{source:"iana",extensions:["zir","zirz"]},"application/vnd.zzazz.deck+xml":{source:"iana",compressible:!0,extensions:["zaz"]},"application/voicexml+xml":{source:"iana",compressible:!0,extensions:["vxml"]},"application/voucher-cms+json":{source:"iana",compressible:!0},"application/vq-rtcpxr":{source:"iana"},"application/wasm":{source:"iana",compressible:!0,extensions:["wasm"]},"application/watcherinfo+xml":{source:"iana",compressible:!0,extensions:["wif"]},"application/webpush-options+json":{source:"iana",compressible:!0},"application/whoispp-query":{source:"iana"},"application/whoispp-response":{source:"iana"},"application/widget":{source:"iana",extensions:["wgt"]},"application/winhlp":{source:"apache",extensions:["hlp"]},"application/wita":{source:"iana"},"application/wordperfect5.1":{source:"iana"},"application/wsdl+xml":{source:"iana",compressible:!0,extensions:["wsdl"]},"application/wspolicy+xml":{source:"iana",compressible:!0,extensions:["wspolicy"]},"application/x-7z-compressed":{source:"apache",compressible:!1,extensions:["7z"]},"application/x-abiword":{source:"apache",extensions:["abw"]},"application/x-ace-compressed":{source:"apache",extensions:["ace"]},"application/x-amf":{source:"apache"},"application/x-apple-diskimage":{source:"apache",extensions:["dmg"]},"application/x-arj":{compressible:!1,extensions:["arj"]},"application/x-authorware-bin":{source:"apache",extensions:["aab","x32","u32","vox"]},"application/x-authorware-map":{source:"apache",extensions:["aam"]},"application/x-authorware-seg":{source:"apache",extensions:["aas"]},"application/x-bcpio":{source:"apache",extensions:["bcpio"]},"application/x-bdoc":{compressible:!1,extensions:["bdoc"]},"application/x-bittorrent":{source:"apache",extensions:["torrent"]},"application/x-blorb":{source:"apache",extensions:["blb","blorb"]},"application/x-bzip":{source:"apache",compressible:!1,extensions:["bz"]},"application/x-bzip2":{source:"apache",compressible:!1,extensions:["bz2","boz"]},"application/x-cbr":{source:"apache",extensions:["cbr","cba","cbt","cbz","cb7"]},"application/x-cdlink":{source:"apache",extensions:["vcd"]},"application/x-cfs-compressed":{source:"apache",extensions:["cfs"]},"application/x-chat":{source:"apache",extensions:["chat"]},"application/x-chess-pgn":{source:"apache",extensions:["pgn"]},"application/x-chrome-extension":{extensions:["crx"]},"application/x-cocoa":{source:"nginx",extensions:["cco"]},"application/x-compress":{source:"apache"},"application/x-conference":{source:"apache",extensions:["nsc"]},"application/x-cpio":{source:"apache",extensions:["cpio"]},"application/x-csh":{source:"apache",extensions:["csh"]},"application/x-deb":{compressible:!1},"application/x-debian-package":{source:"apache",extensions:["deb","udeb"]},"application/x-dgc-compressed":{source:"apache",extensions:["dgc"]},"application/x-director":{source:"apache",extensions:["dir","dcr","dxr","cst","cct","cxt","w3d","fgd","swa"]},"application/x-doom":{source:"apache",extensions:["wad"]},"application/x-dtbncx+xml":{source:"apache",compressible:!0,extensions:["ncx"]},"application/x-dtbook+xml":{source:"apache",compressible:!0,extensions:["dtb"]},"application/x-dtbresource+xml":{source:"apache",compressible:!0,extensions:["res"]},"application/x-dvi":{source:"apache",compressible:!1,extensions:["dvi"]},"application/x-envoy":{source:"apache",extensions:["evy"]},"application/x-eva":{source:"apache",extensions:["eva"]},"application/x-font-bdf":{source:"apache",extensions:["bdf"]},"application/x-font-dos":{source:"apache"},"application/x-font-framemaker":{source:"apache"},"application/x-font-ghostscript":{source:"apache",extensions:["gsf"]},"application/x-font-libgrx":{source:"apache"},"application/x-font-linux-psf":{source:"apache",extensions:["psf"]},"application/x-font-pcf":{source:"apache",extensions:["pcf"]},"application/x-font-snf":{source:"apache",extensions:["snf"]},"application/x-font-speedo":{source:"apache"},"application/x-font-sunos-news":{source:"apache"},"application/x-font-type1":{source:"apache",extensions:["pfa","pfb","pfm","afm"]},"application/x-font-vfont":{source:"apache"},"application/x-freearc":{source:"apache",extensions:["arc"]},"application/x-futuresplash":{source:"apache",extensions:["spl"]},"application/x-gca-compressed":{source:"apache",extensions:["gca"]},"application/x-glulx":{source:"apache",extensions:["ulx"]},"application/x-gnumeric":{source:"apache",extensions:["gnumeric"]},"application/x-gramps-xml":{source:"apache",extensions:["gramps"]},"application/x-gtar":{source:"apache",extensions:["gtar"]},"application/x-gzip":{source:"apache"},"application/x-hdf":{source:"apache",extensions:["hdf"]},"application/x-httpd-php":{compressible:!0,extensions:["php"]},"application/x-install-instructions":{source:"apache",extensions:["install"]},"application/x-iso9660-image":{source:"apache",extensions:["iso"]},"application/x-iwork-keynote-sffkey":{extensions:["key"]},"application/x-iwork-numbers-sffnumbers":{extensions:["numbers"]},"application/x-iwork-pages-sffpages":{extensions:["pages"]},"application/x-java-archive-diff":{source:"nginx",extensions:["jardiff"]},"application/x-java-jnlp-file":{source:"apache",compressible:!1,extensions:["jnlp"]},"application/x-javascript":{compressible:!0},"application/x-keepass2":{extensions:["kdbx"]},"application/x-latex":{source:"apache",compressible:!1,extensions:["latex"]},"application/x-lua-bytecode":{extensions:["luac"]},"application/x-lzh-compressed":{source:"apache",extensions:["lzh","lha"]},"application/x-makeself":{source:"nginx",extensions:["run"]},"application/x-mie":{source:"apache",extensions:["mie"]},"application/x-mobipocket-ebook":{source:"apache",extensions:["prc","mobi"]},"application/x-mpegurl":{compressible:!1},"application/x-ms-application":{source:"apache",extensions:["application"]},"application/x-ms-shortcut":{source:"apache",extensions:["lnk"]},"application/x-ms-wmd":{source:"apache",extensions:["wmd"]},"application/x-ms-wmz":{source:"apache",extensions:["wmz"]},"application/x-ms-xbap":{source:"apache",extensions:["xbap"]},"application/x-msaccess":{source:"apache",extensions:["mdb"]},"application/x-msbinder":{source:"apache",extensions:["obd"]},"application/x-mscardfile":{source:"apache",extensions:["crd"]},"application/x-msclip":{source:"apache",extensions:["clp"]},"application/x-msdos-program":{extensions:["exe"]},"application/x-msdownload":{source:"apache",extensions:["exe","dll","com","bat","msi"]},"application/x-msmediaview":{source:"apache",extensions:["mvb","m13","m14"]},"application/x-msmetafile":{source:"apache",extensions:["wmf","wmz","emf","emz"]},"application/x-msmoney":{source:"apache",extensions:["mny"]},"application/x-mspublisher":{source:"apache",extensions:["pub"]},"application/x-msschedule":{source:"apache",extensions:["scd"]},"application/x-msterminal":{source:"apache",extensions:["trm"]},"application/x-mswrite":{source:"apache",extensions:["wri"]},"application/x-netcdf":{source:"apache",extensions:["nc","cdf"]},"application/x-ns-proxy-autoconfig":{compressible:!0,extensions:["pac"]},"application/x-nzb":{source:"apache",extensions:["nzb"]},"application/x-perl":{source:"nginx",extensions:["pl","pm"]},"application/x-pilot":{source:"nginx",extensions:["prc","pdb"]},"application/x-pkcs12":{source:"apache",compressible:!1,extensions:["p12","pfx"]},"application/x-pkcs7-certificates":{source:"apache",extensions:["p7b","spc"]},"application/x-pkcs7-certreqresp":{source:"apache",extensions:["p7r"]},"application/x-pki-message":{source:"iana"},"application/x-rar-compressed":{source:"apache",compressible:!1,extensions:["rar"]},"application/x-redhat-package-manager":{source:"nginx",extensions:["rpm"]},"application/x-research-info-systems":{source:"apache",extensions:["ris"]},"application/x-sea":{source:"nginx",extensions:["sea"]},"application/x-sh":{source:"apache",compressible:!0,extensions:["sh"]},"application/x-shar":{source:"apache",extensions:["shar"]},"application/x-shockwave-flash":{source:"apache",compressible:!1,extensions:["swf"]},"application/x-silverlight-app":{source:"apache",extensions:["xap"]},"application/x-sql":{source:"apache",extensions:["sql"]},"application/x-stuffit":{source:"apache",compressible:!1,extensions:["sit"]},"application/x-stuffitx":{source:"apache",extensions:["sitx"]},"application/x-subrip":{source:"apache",extensions:["srt"]},"application/x-sv4cpio":{source:"apache",extensions:["sv4cpio"]},"application/x-sv4crc":{source:"apache",extensions:["sv4crc"]},"application/x-t3vm-image":{source:"apache",extensions:["t3"]},"application/x-tads":{source:"apache",extensions:["gam"]},"application/x-tar":{source:"apache",compressible:!0,extensions:["tar"]},"application/x-tcl":{source:"apache",extensions:["tcl","tk"]},"application/x-tex":{source:"apache",extensions:["tex"]},"application/x-tex-tfm":{source:"apache",extensions:["tfm"]},"application/x-texinfo":{source:"apache",extensions:["texinfo","texi"]},"application/x-tgif":{source:"apache",extensions:["obj"]},"application/x-ustar":{source:"apache",extensions:["ustar"]},"application/x-virtualbox-hdd":{compressible:!0,extensions:["hdd"]},"application/x-virtualbox-ova":{compressible:!0,extensions:["ova"]},"application/x-virtualbox-ovf":{compressible:!0,extensions:["ovf"]},"application/x-virtualbox-vbox":{compressible:!0,extensions:["vbox"]},"application/x-virtualbox-vbox-extpack":{compressible:!1,extensions:["vbox-extpack"]},"application/x-virtualbox-vdi":{compressible:!0,extensions:["vdi"]},"application/x-virtualbox-vhd":{compressible:!0,extensions:["vhd"]},"application/x-virtualbox-vmdk":{compressible:!0,extensions:["vmdk"]},"application/x-wais-source":{source:"apache",extensions:["src"]},"application/x-web-app-manifest+json":{compressible:!0,extensions:["webapp"]},"application/x-www-form-urlencoded":{source:"iana",compressible:!0},"application/x-x509-ca-cert":{source:"iana",extensions:["der","crt","pem"]},"application/x-x509-ca-ra-cert":{source:"iana"},"application/x-x509-next-ca-cert":{source:"iana"},"application/x-xfig":{source:"apache",extensions:["fig"]},"application/x-xliff+xml":{source:"apache",compressible:!0,extensions:["xlf"]},"application/x-xpinstall":{source:"apache",compressible:!1,extensions:["xpi"]},"application/x-xz":{source:"apache",extensions:["xz"]},"application/x-zmachine":{source:"apache",extensions:["z1","z2","z3","z4","z5","z6","z7","z8"]},"application/x400-bp":{source:"iana"},"application/xacml+xml":{source:"iana",compressible:!0},"application/xaml+xml":{source:"apache",compressible:!0,extensions:["xaml"]},"application/xcap-att+xml":{source:"iana",compressible:!0,extensions:["xav"]},"application/xcap-caps+xml":{source:"iana",compressible:!0,extensions:["xca"]},"application/xcap-diff+xml":{source:"iana",compressible:!0,extensions:["xdf"]},"application/xcap-el+xml":{source:"iana",compressible:!0,extensions:["xel"]},"application/xcap-error+xml":{source:"iana",compressible:!0},"application/xcap-ns+xml":{source:"iana",compressible:!0,extensions:["xns"]},"application/xcon-conference-info+xml":{source:"iana",compressible:!0},"application/xcon-conference-info-diff+xml":{source:"iana",compressible:!0},"application/xenc+xml":{source:"iana",compressible:!0,extensions:["xenc"]},"application/xhtml+xml":{source:"iana",compressible:!0,extensions:["xhtml","xht"]},"application/xhtml-voice+xml":{source:"apache",compressible:!0},"application/xliff+xml":{source:"iana",compressible:!0,extensions:["xlf"]},"application/xml":{source:"iana",compressible:!0,extensions:["xml","xsl","xsd","rng"]},"application/xml-dtd":{source:"iana",compressible:!0,extensions:["dtd"]},"application/xml-external-parsed-entity":{source:"iana"},"application/xml-patch+xml":{source:"iana",compressible:!0},"application/xmpp+xml":{source:"iana",compressible:!0},"application/xop+xml":{source:"iana",compressible:!0,extensions:["xop"]},"application/xproc+xml":{source:"apache",compressible:!0,extensions:["xpl"]},"application/xslt+xml":{source:"iana",compressible:!0,extensions:["xsl","xslt"]},"application/xspf+xml":{source:"apache",compressible:!0,extensions:["xspf"]},"application/xv+xml":{source:"iana",compressible:!0,extensions:["mxml","xhvml","xvml","xvm"]},"application/yang":{source:"iana",extensions:["yang"]},"application/yang-data+json":{source:"iana",compressible:!0},"application/yang-data+xml":{source:"iana",compressible:!0},"application/yang-patch+json":{source:"iana",compressible:!0},"application/yang-patch+xml":{source:"iana",compressible:!0},"application/yin+xml":{source:"iana",compressible:!0,extensions:["yin"]},"application/zip":{source:"iana",compressible:!1,extensions:["zip"]},"application/zlib":{source:"iana"},"application/zstd":{source:"iana"},"audio/1d-interleaved-parityfec":{source:"iana"},"audio/32kadpcm":{source:"iana"},"audio/3gpp":{source:"iana",compressible:!1,extensions:["3gpp"]},"audio/3gpp2":{source:"iana"},"audio/aac":{source:"iana"},"audio/ac3":{source:"iana"},"audio/adpcm":{source:"apache",extensions:["adp"]},"audio/amr":{source:"iana",extensions:["amr"]},"audio/amr-wb":{source:"iana"},"audio/amr-wb+":{source:"iana"},"audio/aptx":{source:"iana"},"audio/asc":{source:"iana"},"audio/atrac-advanced-lossless":{source:"iana"},"audio/atrac-x":{source:"iana"},"audio/atrac3":{source:"iana"},"audio/basic":{source:"iana",compressible:!1,extensions:["au","snd"]},"audio/bv16":{source:"iana"},"audio/bv32":{source:"iana"},"audio/clearmode":{source:"iana"},"audio/cn":{source:"iana"},"audio/dat12":{source:"iana"},"audio/dls":{source:"iana"},"audio/dsr-es201108":{source:"iana"},"audio/dsr-es202050":{source:"iana"},"audio/dsr-es202211":{source:"iana"},"audio/dsr-es202212":{source:"iana"},"audio/dv":{source:"iana"},"audio/dvi4":{source:"iana"},"audio/eac3":{source:"iana"},"audio/encaprtp":{source:"iana"},"audio/evrc":{source:"iana"},"audio/evrc-qcp":{source:"iana"},"audio/evrc0":{source:"iana"},"audio/evrc1":{source:"iana"},"audio/evrcb":{source:"iana"},"audio/evrcb0":{source:"iana"},"audio/evrcb1":{source:"iana"},"audio/evrcnw":{source:"iana"},"audio/evrcnw0":{source:"iana"},"audio/evrcnw1":{source:"iana"},"audio/evrcwb":{source:"iana"},"audio/evrcwb0":{source:"iana"},"audio/evrcwb1":{source:"iana"},"audio/evs":{source:"iana"},"audio/flexfec":{source:"iana"},"audio/fwdred":{source:"iana"},"audio/g711-0":{source:"iana"},"audio/g719":{source:"iana"},"audio/g722":{source:"iana"},"audio/g7221":{source:"iana"},"audio/g723":{source:"iana"},"audio/g726-16":{source:"iana"},"audio/g726-24":{source:"iana"},"audio/g726-32":{source:"iana"},"audio/g726-40":{source:"iana"},"audio/g728":{source:"iana"},"audio/g729":{source:"iana"},"audio/g7291":{source:"iana"},"audio/g729d":{source:"iana"},"audio/g729e":{source:"iana"},"audio/gsm":{source:"iana"},"audio/gsm-efr":{source:"iana"},"audio/gsm-hr-08":{source:"iana"},"audio/ilbc":{source:"iana"},"audio/ip-mr_v2.5":{source:"iana"},"audio/isac":{source:"apache"},"audio/l16":{source:"iana"},"audio/l20":{source:"iana"},"audio/l24":{source:"iana",compressible:!1},"audio/l8":{source:"iana"},"audio/lpc":{source:"iana"},"audio/melp":{source:"iana"},"audio/melp1200":{source:"iana"},"audio/melp2400":{source:"iana"},"audio/melp600":{source:"iana"},"audio/mhas":{source:"iana"},"audio/midi":{source:"apache",extensions:["mid","midi","kar","rmi"]},"audio/mobile-xmf":{source:"iana",extensions:["mxmf"]},"audio/mp3":{compressible:!1,extensions:["mp3"]},"audio/mp4":{source:"iana",compressible:!1,extensions:["m4a","mp4a"]},"audio/mp4a-latm":{source:"iana"},"audio/mpa":{source:"iana"},"audio/mpa-robust":{source:"iana"},"audio/mpeg":{source:"iana",compressible:!1,extensions:["mpga","mp2","mp2a","mp3","m2a","m3a"]},"audio/mpeg4-generic":{source:"iana"},"audio/musepack":{source:"apache"},"audio/ogg":{source:"iana",compressible:!1,extensions:["oga","ogg","spx","opus"]},"audio/opus":{source:"iana"},"audio/parityfec":{source:"iana"},"audio/pcma":{source:"iana"},"audio/pcma-wb":{source:"iana"},"audio/pcmu":{source:"iana"},"audio/pcmu-wb":{source:"iana"},"audio/prs.sid":{source:"iana"},"audio/qcelp":{source:"iana"},"audio/raptorfec":{source:"iana"},"audio/red":{source:"iana"},"audio/rtp-enc-aescm128":{source:"iana"},"audio/rtp-midi":{source:"iana"},"audio/rtploopback":{source:"iana"},"audio/rtx":{source:"iana"},"audio/s3m":{source:"apache",extensions:["s3m"]},"audio/scip":{source:"iana"},"audio/silk":{source:"apache",extensions:["sil"]},"audio/smv":{source:"iana"},"audio/smv-qcp":{source:"iana"},"audio/smv0":{source:"iana"},"audio/sofa":{source:"iana"},"audio/sp-midi":{source:"iana"},"audio/speex":{source:"iana"},"audio/t140c":{source:"iana"},"audio/t38":{source:"iana"},"audio/telephone-event":{source:"iana"},"audio/tetra_acelp":{source:"iana"},"audio/tetra_acelp_bb":{source:"iana"},"audio/tone":{source:"iana"},"audio/tsvcis":{source:"iana"},"audio/uemclip":{source:"iana"},"audio/ulpfec":{source:"iana"},"audio/usac":{source:"iana"},"audio/vdvi":{source:"iana"},"audio/vmr-wb":{source:"iana"},"audio/vnd.3gpp.iufp":{source:"iana"},"audio/vnd.4sb":{source:"iana"},"audio/vnd.audiokoz":{source:"iana"},"audio/vnd.celp":{source:"iana"},"audio/vnd.cisco.nse":{source:"iana"},"audio/vnd.cmles.radio-events":{source:"iana"},"audio/vnd.cns.anp1":{source:"iana"},"audio/vnd.cns.inf1":{source:"iana"},"audio/vnd.dece.audio":{source:"iana",extensions:["uva","uvva"]},"audio/vnd.digital-winds":{source:"iana",extensions:["eol"]},"audio/vnd.dlna.adts":{source:"iana"},"audio/vnd.dolby.heaac.1":{source:"iana"},"audio/vnd.dolby.heaac.2":{source:"iana"},"audio/vnd.dolby.mlp":{source:"iana"},"audio/vnd.dolby.mps":{source:"iana"},"audio/vnd.dolby.pl2":{source:"iana"},"audio/vnd.dolby.pl2x":{source:"iana"},"audio/vnd.dolby.pl2z":{source:"iana"},"audio/vnd.dolby.pulse.1":{source:"iana"},"audio/vnd.dra":{source:"iana",extensions:["dra"]},"audio/vnd.dts":{source:"iana",extensions:["dts"]},"audio/vnd.dts.hd":{source:"iana",extensions:["dtshd"]},"audio/vnd.dts.uhd":{source:"iana"},"audio/vnd.dvb.file":{source:"iana"},"audio/vnd.everad.plj":{source:"iana"},"audio/vnd.hns.audio":{source:"iana"},"audio/vnd.lucent.voice":{source:"iana",extensions:["lvp"]},"audio/vnd.ms-playready.media.pya":{source:"iana",extensions:["pya"]},"audio/vnd.nokia.mobile-xmf":{source:"iana"},"audio/vnd.nortel.vbk":{source:"iana"},"audio/vnd.nuera.ecelp4800":{source:"iana",extensions:["ecelp4800"]},"audio/vnd.nuera.ecelp7470":{source:"iana",extensions:["ecelp7470"]},"audio/vnd.nuera.ecelp9600":{source:"iana",extensions:["ecelp9600"]},"audio/vnd.octel.sbc":{source:"iana"},"audio/vnd.presonus.multitrack":{source:"iana"},"audio/vnd.qcelp":{source:"iana"},"audio/vnd.rhetorex.32kadpcm":{source:"iana"},"audio/vnd.rip":{source:"iana",extensions:["rip"]},"audio/vnd.rn-realaudio":{compressible:!1},"audio/vnd.sealedmedia.softseal.mpeg":{source:"iana"},"audio/vnd.vmx.cvsd":{source:"iana"},"audio/vnd.wave":{compressible:!1},"audio/vorbis":{source:"iana",compressible:!1},"audio/vorbis-config":{source:"iana"},"audio/wav":{compressible:!1,extensions:["wav"]},"audio/wave":{compressible:!1,extensions:["wav"]},"audio/webm":{source:"apache",compressible:!1,extensions:["weba"]},"audio/x-aac":{source:"apache",compressible:!1,extensions:["aac"]},"audio/x-aiff":{source:"apache",extensions:["aif","aiff","aifc"]},"audio/x-caf":{source:"apache",compressible:!1,extensions:["caf"]},"audio/x-flac":{source:"apache",extensions:["flac"]},"audio/x-m4a":{source:"nginx",extensions:["m4a"]},"audio/x-matroska":{source:"apache",extensions:["mka"]},"audio/x-mpegurl":{source:"apache",extensions:["m3u"]},"audio/x-ms-wax":{source:"apache",extensions:["wax"]},"audio/x-ms-wma":{source:"apache",extensions:["wma"]},"audio/x-pn-realaudio":{source:"apache",extensions:["ram","ra"]},"audio/x-pn-realaudio-plugin":{source:"apache",extensions:["rmp"]},"audio/x-realaudio":{source:"nginx",extensions:["ra"]},"audio/x-tta":{source:"apache"},"audio/x-wav":{source:"apache",extensions:["wav"]},"audio/xm":{source:"apache",extensions:["xm"]},"chemical/x-cdx":{source:"apache",extensions:["cdx"]},"chemical/x-cif":{source:"apache",extensions:["cif"]},"chemical/x-cmdf":{source:"apache",extensions:["cmdf"]},"chemical/x-cml":{source:"apache",extensions:["cml"]},"chemical/x-csml":{source:"apache",extensions:["csml"]},"chemical/x-pdb":{source:"apache"},"chemical/x-xyz":{source:"apache",extensions:["xyz"]},"font/collection":{source:"iana",extensions:["ttc"]},"font/otf":{source:"iana",compressible:!0,extensions:["otf"]},"font/sfnt":{source:"iana"},"font/ttf":{source:"iana",compressible:!0,extensions:["ttf"]},"font/woff":{source:"iana",extensions:["woff"]},"font/woff2":{source:"iana",extensions:["woff2"]},"image/aces":{source:"iana",extensions:["exr"]},"image/apng":{compressible:!1,extensions:["apng"]},"image/avci":{source:"iana",extensions:["avci"]},"image/avcs":{source:"iana",extensions:["avcs"]},"image/avif":{source:"iana",compressible:!1,extensions:["avif"]},"image/bmp":{source:"iana",compressible:!0,extensions:["bmp"]},"image/cgm":{source:"iana",extensions:["cgm"]},"image/dicom-rle":{source:"iana",extensions:["drle"]},"image/emf":{source:"iana",extensions:["emf"]},"image/fits":{source:"iana",extensions:["fits"]},"image/g3fax":{source:"iana",extensions:["g3"]},"image/gif":{source:"iana",compressible:!1,extensions:["gif"]},"image/heic":{source:"iana",extensions:["heic"]},"image/heic-sequence":{source:"iana",extensions:["heics"]},"image/heif":{source:"iana",extensions:["heif"]},"image/heif-sequence":{source:"iana",extensions:["heifs"]},"image/hej2k":{source:"iana",extensions:["hej2"]},"image/hsj2":{source:"iana",extensions:["hsj2"]},"image/ief":{source:"iana",extensions:["ief"]},"image/jls":{source:"iana",extensions:["jls"]},"image/jp2":{source:"iana",compressible:!1,extensions:["jp2","jpg2"]},"image/jpeg":{source:"iana",compressible:!1,extensions:["jpeg","jpg","jpe"]},"image/jph":{source:"iana",extensions:["jph"]},"image/jphc":{source:"iana",extensions:["jhc"]},"image/jpm":{source:"iana",compressible:!1,extensions:["jpm"]},"image/jpx":{source:"iana",compressible:!1,extensions:["jpx","jpf"]},"image/jxr":{source:"iana",extensions:["jxr"]},"image/jxra":{source:"iana",extensions:["jxra"]},"image/jxrs":{source:"iana",extensions:["jxrs"]},"image/jxs":{source:"iana",extensions:["jxs"]},"image/jxsc":{source:"iana",extensions:["jxsc"]},"image/jxsi":{source:"iana",extensions:["jxsi"]},"image/jxss":{source:"iana",extensions:["jxss"]},"image/ktx":{source:"iana",extensions:["ktx"]},"image/ktx2":{source:"iana",extensions:["ktx2"]},"image/naplps":{source:"iana"},"image/pjpeg":{compressible:!1},"image/png":{source:"iana",compressible:!1,extensions:["png"]},"image/prs.btif":{source:"iana",extensions:["btif"]},"image/prs.pti":{source:"iana",extensions:["pti"]},"image/pwg-raster":{source:"iana"},"image/sgi":{source:"apache",extensions:["sgi"]},"image/svg+xml":{source:"iana",compressible:!0,extensions:["svg","svgz"]},"image/t38":{source:"iana",extensions:["t38"]},"image/tiff":{source:"iana",compressible:!1,extensions:["tif","tiff"]},"image/tiff-fx":{source:"iana",extensions:["tfx"]},"image/vnd.adobe.photoshop":{source:"iana",compressible:!0,extensions:["psd"]},"image/vnd.airzip.accelerator.azv":{source:"iana",extensions:["azv"]},"image/vnd.cns.inf2":{source:"iana"},"image/vnd.dece.graphic":{source:"iana",extensions:["uvi","uvvi","uvg","uvvg"]},"image/vnd.djvu":{source:"iana",extensions:["djvu","djv"]},"image/vnd.dvb.subtitle":{source:"iana",extensions:["sub"]},"image/vnd.dwg":{source:"iana",extensions:["dwg"]},"image/vnd.dxf":{source:"iana",extensions:["dxf"]},"image/vnd.fastbidsheet":{source:"iana",extensions:["fbs"]},"image/vnd.fpx":{source:"iana",extensions:["fpx"]},"image/vnd.fst":{source:"iana",extensions:["fst"]},"image/vnd.fujixerox.edmics-mmr":{source:"iana",extensions:["mmr"]},"image/vnd.fujixerox.edmics-rlc":{source:"iana",extensions:["rlc"]},"image/vnd.globalgraphics.pgb":{source:"iana"},"image/vnd.microsoft.icon":{source:"iana",compressible:!0,extensions:["ico"]},"image/vnd.mix":{source:"iana"},"image/vnd.mozilla.apng":{source:"iana"},"image/vnd.ms-dds":{compressible:!0,extensions:["dds"]},"image/vnd.ms-modi":{source:"iana",extensions:["mdi"]},"image/vnd.ms-photo":{source:"apache",extensions:["wdp"]},"image/vnd.net-fpx":{source:"iana",extensions:["npx"]},"image/vnd.pco.b16":{source:"iana",extensions:["b16"]},"image/vnd.radiance":{source:"iana"},"image/vnd.sealed.png":{source:"iana"},"image/vnd.sealedmedia.softseal.gif":{source:"iana"},"image/vnd.sealedmedia.softseal.jpg":{source:"iana"},"image/vnd.svf":{source:"iana"},"image/vnd.tencent.tap":{source:"iana",extensions:["tap"]},"image/vnd.valve.source.texture":{source:"iana",extensions:["vtf"]},"image/vnd.wap.wbmp":{source:"iana",extensions:["wbmp"]},"image/vnd.xiff":{source:"iana",extensions:["xif"]},"image/vnd.zbrush.pcx":{source:"iana",extensions:["pcx"]},"image/webp":{source:"apache",extensions:["webp"]},"image/wmf":{source:"iana",extensions:["wmf"]},"image/x-3ds":{source:"apache",extensions:["3ds"]},"image/x-cmu-raster":{source:"apache",extensions:["ras"]},"image/x-cmx":{source:"apache",extensions:["cmx"]},"image/x-freehand":{source:"apache",extensions:["fh","fhc","fh4","fh5","fh7"]},"image/x-icon":{source:"apache",compressible:!0,extensions:["ico"]},"image/x-jng":{source:"nginx",extensions:["jng"]},"image/x-mrsid-image":{source:"apache",extensions:["sid"]},"image/x-ms-bmp":{source:"nginx",compressible:!0,extensions:["bmp"]},"image/x-pcx":{source:"apache",extensions:["pcx"]},"image/x-pict":{source:"apache",extensions:["pic","pct"]},"image/x-portable-anymap":{source:"apache",extensions:["pnm"]},"image/x-portable-bitmap":{source:"apache",extensions:["pbm"]},"image/x-portable-graymap":{source:"apache",extensions:["pgm"]},"image/x-portable-pixmap":{source:"apache",extensions:["ppm"]},"image/x-rgb":{source:"apache",extensions:["rgb"]},"image/x-tga":{source:"apache",extensions:["tga"]},"image/x-xbitmap":{source:"apache",extensions:["xbm"]},"image/x-xcf":{compressible:!1},"image/x-xpixmap":{source:"apache",extensions:["xpm"]},"image/x-xwindowdump":{source:"apache",extensions:["xwd"]},"message/cpim":{source:"iana"},"message/delivery-status":{source:"iana"},"message/disposition-notification":{source:"iana",extensions:["disposition-notification"]},"message/external-body":{source:"iana"},"message/feedback-report":{source:"iana"},"message/global":{source:"iana",extensions:["u8msg"]},"message/global-delivery-status":{source:"iana",extensions:["u8dsn"]},"message/global-disposition-notification":{source:"iana",extensions:["u8mdn"]},"message/global-headers":{source:"iana",extensions:["u8hdr"]},"message/http":{source:"iana",compressible:!1},"message/imdn+xml":{source:"iana",compressible:!0},"message/news":{source:"iana"},"message/partial":{source:"iana",compressible:!1},"message/rfc822":{source:"iana",compressible:!0,extensions:["eml","mime"]},"message/s-http":{source:"iana"},"message/sip":{source:"iana"},"message/sipfrag":{source:"iana"},"message/tracking-status":{source:"iana"},"message/vnd.si.simp":{source:"iana"},"message/vnd.wfa.wsc":{source:"iana",extensions:["wsc"]},"model/3mf":{source:"iana",extensions:["3mf"]},"model/e57":{source:"iana"},"model/gltf+json":{source:"iana",compressible:!0,extensions:["gltf"]},"model/gltf-binary":{source:"iana",compressible:!0,extensions:["glb"]},"model/iges":{source:"iana",compressible:!1,extensions:["igs","iges"]},"model/mesh":{source:"iana",compressible:!1,extensions:["msh","mesh","silo"]},"model/mtl":{source:"iana",extensions:["mtl"]},"model/obj":{source:"iana",extensions:["obj"]},"model/step":{source:"iana"},"model/step+xml":{source:"iana",compressible:!0,extensions:["stpx"]},"model/step+zip":{source:"iana",compressible:!1,extensions:["stpz"]},"model/step-xml+zip":{source:"iana",compressible:!1,extensions:["stpxz"]},"model/stl":{source:"iana",extensions:["stl"]},"model/vnd.collada+xml":{source:"iana",compressible:!0,extensions:["dae"]},"model/vnd.dwf":{source:"iana",extensions:["dwf"]},"model/vnd.flatland.3dml":{source:"iana"},"model/vnd.gdl":{source:"iana",extensions:["gdl"]},"model/vnd.gs-gdl":{source:"apache"},"model/vnd.gs.gdl":{source:"iana"},"model/vnd.gtw":{source:"iana",extensions:["gtw"]},"model/vnd.moml+xml":{source:"iana",compressible:!0},"model/vnd.mts":{source:"iana",extensions:["mts"]},"model/vnd.opengex":{source:"iana",extensions:["ogex"]},"model/vnd.parasolid.transmit.binary":{source:"iana",extensions:["x_b"]},"model/vnd.parasolid.transmit.text":{source:"iana",extensions:["x_t"]},"model/vnd.pytha.pyox":{source:"iana"},"model/vnd.rosette.annotated-data-model":{source:"iana"},"model/vnd.sap.vds":{source:"iana",extensions:["vds"]},"model/vnd.usdz+zip":{source:"iana",compressible:!1,extensions:["usdz"]},"model/vnd.valve.source.compiled-map":{source:"iana",extensions:["bsp"]},"model/vnd.vtu":{source:"iana",extensions:["vtu"]},"model/vrml":{source:"iana",compressible:!1,extensions:["wrl","vrml"]},"model/x3d+binary":{source:"apache",compressible:!1,extensions:["x3db","x3dbz"]},"model/x3d+fastinfoset":{source:"iana",extensions:["x3db"]},"model/x3d+vrml":{source:"apache",compressible:!1,extensions:["x3dv","x3dvz"]},"model/x3d+xml":{source:"iana",compressible:!0,extensions:["x3d","x3dz"]},"model/x3d-vrml":{source:"iana",extensions:["x3dv"]},"multipart/alternative":{source:"iana",compressible:!1},"multipart/appledouble":{source:"iana"},"multipart/byteranges":{source:"iana"},"multipart/digest":{source:"iana"},"multipart/encrypted":{source:"iana",compressible:!1},"multipart/form-data":{source:"iana",compressible:!1},"multipart/header-set":{source:"iana"},"multipart/mixed":{source:"iana"},"multipart/multilingual":{source:"iana"},"multipart/parallel":{source:"iana"},"multipart/related":{source:"iana",compressible:!1},"multipart/report":{source:"iana"},"multipart/signed":{source:"iana",compressible:!1},"multipart/vnd.bint.med-plus":{source:"iana"},"multipart/voice-message":{source:"iana"},"multipart/x-mixed-replace":{source:"iana"},"text/1d-interleaved-parityfec":{source:"iana"},"text/cache-manifest":{source:"iana",compressible:!0,extensions:["appcache","manifest"]},"text/calendar":{source:"iana",extensions:["ics","ifb"]},"text/calender":{compressible:!0},"text/cmd":{compressible:!0},"text/coffeescript":{extensions:["coffee","litcoffee"]},"text/cql":{source:"iana"},"text/cql-expression":{source:"iana"},"text/cql-identifier":{source:"iana"},"text/css":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["css"]},"text/csv":{source:"iana",compressible:!0,extensions:["csv"]},"text/csv-schema":{source:"iana"},"text/directory":{source:"iana"},"text/dns":{source:"iana"},"text/ecmascript":{source:"iana"},"text/encaprtp":{source:"iana"},"text/enriched":{source:"iana"},"text/fhirpath":{source:"iana"},"text/flexfec":{source:"iana"},"text/fwdred":{source:"iana"},"text/gff3":{source:"iana"},"text/grammar-ref-list":{source:"iana"},"text/html":{source:"iana",compressible:!0,extensions:["html","htm","shtml"]},"text/jade":{extensions:["jade"]},"text/javascript":{source:"iana",compressible:!0},"text/jcr-cnd":{source:"iana"},"text/jsx":{compressible:!0,extensions:["jsx"]},"text/less":{compressible:!0,extensions:["less"]},"text/markdown":{source:"iana",compressible:!0,extensions:["markdown","md"]},"text/mathml":{source:"nginx",extensions:["mml"]},"text/mdx":{compressible:!0,extensions:["mdx"]},"text/mizar":{source:"iana"},"text/n3":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["n3"]},"text/parameters":{source:"iana",charset:"UTF-8"},"text/parityfec":{source:"iana"},"text/plain":{source:"iana",compressible:!0,extensions:["txt","text","conf","def","list","log","in","ini"]},"text/provenance-notation":{source:"iana",charset:"UTF-8"},"text/prs.fallenstein.rst":{source:"iana"},"text/prs.lines.tag":{source:"iana",extensions:["dsc"]},"text/prs.prop.logic":{source:"iana"},"text/raptorfec":{source:"iana"},"text/red":{source:"iana"},"text/rfc822-headers":{source:"iana"},"text/richtext":{source:"iana",compressible:!0,extensions:["rtx"]},"text/rtf":{source:"iana",compressible:!0,extensions:["rtf"]},"text/rtp-enc-aescm128":{source:"iana"},"text/rtploopback":{source:"iana"},"text/rtx":{source:"iana"},"text/sgml":{source:"iana",extensions:["sgml","sgm"]},"text/shaclc":{source:"iana"},"text/shex":{source:"iana",extensions:["shex"]},"text/slim":{extensions:["slim","slm"]},"text/spdx":{source:"iana",extensions:["spdx"]},"text/strings":{source:"iana"},"text/stylus":{extensions:["stylus","styl"]},"text/t140":{source:"iana"},"text/tab-separated-values":{source:"iana",compressible:!0,extensions:["tsv"]},"text/troff":{source:"iana",extensions:["t","tr","roff","man","me","ms"]},"text/turtle":{source:"iana",charset:"UTF-8",extensions:["ttl"]},"text/ulpfec":{source:"iana"},"text/uri-list":{source:"iana",compressible:!0,extensions:["uri","uris","urls"]},"text/vcard":{source:"iana",compressible:!0,extensions:["vcard"]},"text/vnd.a":{source:"iana"},"text/vnd.abc":{source:"iana"},"text/vnd.ascii-art":{source:"iana"},"text/vnd.curl":{source:"iana",extensions:["curl"]},"text/vnd.curl.dcurl":{source:"apache",extensions:["dcurl"]},"text/vnd.curl.mcurl":{source:"apache",extensions:["mcurl"]},"text/vnd.curl.scurl":{source:"apache",extensions:["scurl"]},"text/vnd.debian.copyright":{source:"iana",charset:"UTF-8"},"text/vnd.dmclientscript":{source:"iana"},"text/vnd.dvb.subtitle":{source:"iana",extensions:["sub"]},"text/vnd.esmertec.theme-descriptor":{source:"iana",charset:"UTF-8"},"text/vnd.familysearch.gedcom":{source:"iana",extensions:["ged"]},"text/vnd.ficlab.flt":{source:"iana"},"text/vnd.fly":{source:"iana",extensions:["fly"]},"text/vnd.fmi.flexstor":{source:"iana",extensions:["flx"]},"text/vnd.gml":{source:"iana"},"text/vnd.graphviz":{source:"iana",extensions:["gv"]},"text/vnd.hans":{source:"iana"},"text/vnd.hgl":{source:"iana"},"text/vnd.in3d.3dml":{source:"iana",extensions:["3dml"]},"text/vnd.in3d.spot":{source:"iana",extensions:["spot"]},"text/vnd.iptc.newsml":{source:"iana"},"text/vnd.iptc.nitf":{source:"iana"},"text/vnd.latex-z":{source:"iana"},"text/vnd.motorola.reflex":{source:"iana"},"text/vnd.ms-mediapackage":{source:"iana"},"text/vnd.net2phone.commcenter.command":{source:"iana"},"text/vnd.radisys.msml-basic-layout":{source:"iana"},"text/vnd.senx.warpscript":{source:"iana"},"text/vnd.si.uricatalogue":{source:"iana"},"text/vnd.sosi":{source:"iana"},"text/vnd.sun.j2me.app-descriptor":{source:"iana",charset:"UTF-8",extensions:["jad"]},"text/vnd.trolltech.linguist":{source:"iana",charset:"UTF-8"},"text/vnd.wap.si":{source:"iana"},"text/vnd.wap.sl":{source:"iana"},"text/vnd.wap.wml":{source:"iana",extensions:["wml"]},"text/vnd.wap.wmlscript":{source:"iana",extensions:["wmls"]},"text/vtt":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["vtt"]},"text/x-asm":{source:"apache",extensions:["s","asm"]},"text/x-c":{source:"apache",extensions:["c","cc","cxx","cpp","h","hh","dic"]},"text/x-component":{source:"nginx",extensions:["htc"]},"text/x-fortran":{source:"apache",extensions:["f","for","f77","f90"]},"text/x-gwt-rpc":{compressible:!0},"text/x-handlebars-template":{extensions:["hbs"]},"text/x-java-source":{source:"apache",extensions:["java"]},"text/x-jquery-tmpl":{compressible:!0},"text/x-lua":{extensions:["lua"]},"text/x-markdown":{compressible:!0,extensions:["mkd"]},"text/x-nfo":{source:"apache",extensions:["nfo"]},"text/x-opml":{source:"apache",extensions:["opml"]},"text/x-org":{compressible:!0,extensions:["org"]},"text/x-pascal":{source:"apache",extensions:["p","pas"]},"text/x-processing":{compressible:!0,extensions:["pde"]},"text/x-sass":{extensions:["sass"]},"text/x-scss":{extensions:["scss"]},"text/x-setext":{source:"apache",extensions:["etx"]},"text/x-sfv":{source:"apache",extensions:["sfv"]},"text/x-suse-ymp":{compressible:!0,extensions:["ymp"]},"text/x-uuencode":{source:"apache",extensions:["uu"]},"text/x-vcalendar":{source:"apache",extensions:["vcs"]},"text/x-vcard":{source:"apache",extensions:["vcf"]},"text/xml":{source:"iana",compressible:!0,extensions:["xml"]},"text/xml-external-parsed-entity":{source:"iana"},"text/yaml":{compressible:!0,extensions:["yaml","yml"]},"video/1d-interleaved-parityfec":{source:"iana"},"video/3gpp":{source:"iana",extensions:["3gp","3gpp"]},"video/3gpp-tt":{source:"iana"},"video/3gpp2":{source:"iana",extensions:["3g2"]},"video/av1":{source:"iana"},"video/bmpeg":{source:"iana"},"video/bt656":{source:"iana"},"video/celb":{source:"iana"},"video/dv":{source:"iana"},"video/encaprtp":{source:"iana"},"video/ffv1":{source:"iana"},"video/flexfec":{source:"iana"},"video/h261":{source:"iana",extensions:["h261"]},"video/h263":{source:"iana",extensions:["h263"]},"video/h263-1998":{source:"iana"},"video/h263-2000":{source:"iana"},"video/h264":{source:"iana",extensions:["h264"]},"video/h264-rcdo":{source:"iana"},"video/h264-svc":{source:"iana"},"video/h265":{source:"iana"},"video/iso.segment":{source:"iana",extensions:["m4s"]},"video/jpeg":{source:"iana",extensions:["jpgv"]},"video/jpeg2000":{source:"iana"},"video/jpm":{source:"apache",extensions:["jpm","jpgm"]},"video/jxsv":{source:"iana"},"video/mj2":{source:"iana",extensions:["mj2","mjp2"]},"video/mp1s":{source:"iana"},"video/mp2p":{source:"iana"},"video/mp2t":{source:"iana",extensions:["ts"]},"video/mp4":{source:"iana",compressible:!1,extensions:["mp4","mp4v","mpg4"]},"video/mp4v-es":{source:"iana"},"video/mpeg":{source:"iana",compressible:!1,extensions:["mpeg","mpg","mpe","m1v","m2v"]},"video/mpeg4-generic":{source:"iana"},"video/mpv":{source:"iana"},"video/nv":{source:"iana"},"video/ogg":{source:"iana",compressible:!1,extensions:["ogv"]},"video/parityfec":{source:"iana"},"video/pointer":{source:"iana"},"video/quicktime":{source:"iana",compressible:!1,extensions:["qt","mov"]},"video/raptorfec":{source:"iana"},"video/raw":{source:"iana"},"video/rtp-enc-aescm128":{source:"iana"},"video/rtploopback":{source:"iana"},"video/rtx":{source:"iana"},"video/scip":{source:"iana"},"video/smpte291":{source:"iana"},"video/smpte292m":{source:"iana"},"video/ulpfec":{source:"iana"},"video/vc1":{source:"iana"},"video/vc2":{source:"iana"},"video/vnd.cctv":{source:"iana"},"video/vnd.dece.hd":{source:"iana",extensions:["uvh","uvvh"]},"video/vnd.dece.mobile":{source:"iana",extensions:["uvm","uvvm"]},"video/vnd.dece.mp4":{source:"iana"},"video/vnd.dece.pd":{source:"iana",extensions:["uvp","uvvp"]},"video/vnd.dece.sd":{source:"iana",extensions:["uvs","uvvs"]},"video/vnd.dece.video":{source:"iana",extensions:["uvv","uvvv"]},"video/vnd.directv.mpeg":{source:"iana"},"video/vnd.directv.mpeg-tts":{source:"iana"},"video/vnd.dlna.mpeg-tts":{source:"iana"},"video/vnd.dvb.file":{source:"iana",extensions:["dvb"]},"video/vnd.fvt":{source:"iana",extensions:["fvt"]},"video/vnd.hns.video":{source:"iana"},"video/vnd.iptvforum.1dparityfec-1010":{source:"iana"},"video/vnd.iptvforum.1dparityfec-2005":{source:"iana"},"video/vnd.iptvforum.2dparityfec-1010":{source:"iana"},"video/vnd.iptvforum.2dparityfec-2005":{source:"iana"},"video/vnd.iptvforum.ttsavc":{source:"iana"},"video/vnd.iptvforum.ttsmpeg2":{source:"iana"},"video/vnd.motorola.video":{source:"iana"},"video/vnd.motorola.videop":{source:"iana"},"video/vnd.mpegurl":{source:"iana",extensions:["mxu","m4u"]},"video/vnd.ms-playready.media.pyv":{source:"iana",extensions:["pyv"]},"video/vnd.nokia.interleaved-multimedia":{source:"iana"},"video/vnd.nokia.mp4vr":{source:"iana"},"video/vnd.nokia.videovoip":{source:"iana"},"video/vnd.objectvideo":{source:"iana"},"video/vnd.radgamettools.bink":{source:"iana"},"video/vnd.radgamettools.smacker":{source:"iana"},"video/vnd.sealed.mpeg1":{source:"iana"},"video/vnd.sealed.mpeg4":{source:"iana"},"video/vnd.sealed.swf":{source:"iana"},"video/vnd.sealedmedia.softseal.mov":{source:"iana"},"video/vnd.uvvu.mp4":{source:"iana",extensions:["uvu","uvvu"]},"video/vnd.vivo":{source:"iana",extensions:["viv"]},"video/vnd.youtube.yt":{source:"iana"},"video/vp8":{source:"iana"},"video/vp9":{source:"iana"},"video/webm":{source:"apache",compressible:!1,extensions:["webm"]},"video/x-f4v":{source:"apache",extensions:["f4v"]},"video/x-fli":{source:"apache",extensions:["fli"]},"video/x-flv":{source:"apache",compressible:!1,extensions:["flv"]},"video/x-m4v":{source:"apache",extensions:["m4v"]},"video/x-matroska":{source:"apache",compressible:!1,extensions:["mkv","mk3d","mks"]},"video/x-mng":{source:"apache",extensions:["mng"]},"video/x-ms-asf":{source:"apache",extensions:["asf","asx"]},"video/x-ms-vob":{source:"apache",extensions:["vob"]},"video/x-ms-wm":{source:"apache",extensions:["wm"]},"video/x-ms-wmv":{source:"apache",compressible:!1,extensions:["wmv"]},"video/x-ms-wmx":{source:"apache",extensions:["wmx"]},"video/x-ms-wvx":{source:"apache",extensions:["wvx"]},"video/x-msvideo":{source:"apache",extensions:["avi"]},"video/x-sgi-movie":{source:"apache",extensions:["movie"]},"video/x-smv":{source:"apache",extensions:["smv"]},"x-conference/x-cooltalk":{source:"apache",extensions:["ice"]},"x-shader/x-fragment":{compressible:!0},"x-shader/x-vertex":{compressible:!0}}});var tge=L((BRt,ege)=>{ege.exports=Zhe()});var ige=L(Fa=>{"use strict";var d4=tge(),AHe=require("path").extname,rge=/^\s*([^;\s]*)(?:;|\s|$)/,PHe=/^text\//i;Fa.charset=nge;Fa.charsets={lookup:nge};Fa.contentType=DHe;Fa.extension=NHe;Fa.extensions=Object.create(null);Fa.lookup=LHe;Fa.types=Object.create(null);OHe(Fa.extensions,Fa.types);function nge(t){if(!t||typeof t!="string")return!1;var e=rge.exec(t),r=e&&d4[e[1].toLowerCase()];return r&&r.charset?r.charset:e&&PHe.test(e[1])?"UTF-8":!1}function DHe(t){if(!t||typeof t!="string")return!1;var e=t.indexOf("/")===-1?Fa.lookup(t):t;if(!e)return!1;if(e.indexOf("charset")===-1){var r=Fa.charset(e);r&&(e+="; charset="+r.toLowerCase())}return e}function NHe(t){if(!t||typeof t!="string")return!1;var e=rge.exec(t),r=e&&Fa.extensions[e[1].toLowerCase()];return!r||!r.length?!1:r[0]}function LHe(t){if(!t||typeof t!="string")return!1;var e=AHe("x."+t).toLowerCase().substr(1);return e&&Fa.types[e]||!1}function OHe(t,e){var r=["nginx","apache",void 0,"iana"];Object.keys(d4).forEach(function(o){var s=d4[o],a=s.extensions;if(!(!a||!a.length)){t[o]=a;for(var c=0;c<a.length;c++){var u=a[c];if(e[u]){var l=r.indexOf(d4[e[u]].source),d=r.indexOf(s.source);if(e[u]!=="application/octet-stream"&&(l>d||l===d&&e[u].substr(0,12)==="application/"))continue}e[u]=o}}})}});var sge=L((HRt,oge)=>{oge.exports=MHe;function MHe(t){var e=typeof setImmediate=="function"?setImmediate:typeof process=="object"&&typeof process.nextTick=="function"?process.nextTick:null;e?e(t):setTimeout(t,0)}});var Hz=L((jRt,cge)=>{var age=sge();cge.exports=FHe;function FHe(t){var e=!1;return age(function(){e=!0}),function(n,o){e?t(n,o):age(function(){t(n,o)})}}});var jz=L((zRt,uge)=>{uge.exports=UHe;function UHe(t){Object.keys(t.jobs).forEach(BHe.bind(t)),t.jobs={}}function BHe(t){typeof this.jobs[t]=="function"&&this.jobs[t]()}});var zz=L((GRt,dge)=>{var lge=Hz(),qHe=jz();dge.exports=HHe;function HHe(t,e,r,n){var o=r.keyedList?r.keyedList[r.index]:r.index;r.jobs[o]=jHe(e,o,t[o],function(s,a){o in r.jobs&&(delete r.jobs[o],s?qHe(r):r.results[o]=a,n(s,r.results))})}function jHe(t,e,r,n){var o;return t.length==2?o=t(r,lge(n)):o=t(r,e,lge(n)),o}});var Gz=L((VRt,pge)=>{pge.exports=zHe;function zHe(t,e){var r=!Array.isArray(t),n={index:0,keyedList:r||e?Object.keys(t):null,jobs:{},results:r?{}:[],size:r?Object.keys(t).length:t.length};return e&&n.keyedList.sort(r?e:function(o,s){return e(t[o],t[s])}),n}});var Vz=L(($Rt,fge)=>{var GHe=jz(),VHe=Hz();fge.exports=$He;function $He(t){Object.keys(this.jobs).length&&(this.index=this.size,GHe(this),VHe(t)(null,this.results))}});var hge=L((WRt,mge)=>{var WHe=zz(),KHe=Gz(),YHe=Vz();mge.exports=QHe;function QHe(t,e,r){for(var n=KHe(t);n.index<(n.keyedList||t).length;)WHe(t,e,n,function(o,s){if(o){r(o,s);return}if(Object.keys(n.jobs).length===0){r(null,n.results);return}}),n.index++;return YHe.bind(n,r)}});var $z=L((KRt,p4)=>{var gge=zz(),XHe=Gz(),JHe=Vz();p4.exports=ZHe;p4.exports.ascending=vge;p4.exports.descending=eje;function ZHe(t,e,r,n){var o=XHe(t,r);return gge(t,e,o,function s(a,c){if(a){n(a,c);return}if(o.index++,o.index<(o.keyedList||t).length){gge(t,e,o,s);return}n(null,o.results)}),JHe.bind(o,n)}function vge(t,e){return t<e?-1:t>e?1:0}function eje(t,e){return-1*vge(t,e)}});var bge=L((YRt,yge)=>{var tje=$z();yge.exports=rje;function rje(t,e,r){return tje(t,e,null,r)}});var xge=L((QRt,_ge)=>{_ge.exports={parallel:hge(),serial:bge(),serialOrdered:$z()}});var Ige=L((XRt,Sge)=>{Sge.exports=function(t,e){return Object.keys(e).forEach(function(r){t[r]=t[r]||e[r]}),t}});var Ege=L((JRt,Tge)=>{var Qz=Jhe(),Cge=require("util"),Wz=require("path"),nje=require("http"),ije=require("https"),oje=require("url").parse,sje=require("fs"),aje=require("stream").Stream,Kz=ige(),cje=xge(),Yz=Ige();Tge.exports=Dr;Cge.inherits(Dr,Qz);function Dr(t){if(!(this instanceof Dr))return new Dr(t);this._overheadLength=0,this._valueLength=0,this._valuesToMeasure=[],Qz.call(this),t=t||{};for(var e in t)this[e]=t[e]}Dr.LINE_BREAK=`\r
`;Dr.DEFAULT_CONTENT_TYPE="application/octet-stream";Dr.prototype.append=function(t,e,r){r=r||{},typeof r=="string"&&(r={filename:r});var n=Qz.prototype.append.bind(this);if(typeof e=="number"&&(e=""+e),Cge.isArray(e)){this._error(new Error("Arrays are not supported."));return}var o=this._multiPartHeader(t,e,r),s=this._multiPartFooter();n(o),n(e),n(s),this._trackLength(o,e,r)};Dr.prototype._trackLength=function(t,e,r){var n=0;r.knownLength!=null?n+=+r.knownLength:Buffer.isBuffer(e)?n=e.length:typeof e=="string"&&(n=Buffer.byteLength(e)),this._valueLength+=n,this._overheadLength+=Buffer.byteLength(t)+Dr.LINE_BREAK.length,!(!e||!e.path&&!(e.readable&&e.hasOwnProperty("httpVersion"))&&!(e instanceof aje))&&(r.knownLength||this._valuesToMeasure.push(e))};Dr.prototype._lengthRetriever=function(t,e){t.hasOwnProperty("fd")?t.end!=null&&t.end!=1/0&&t.start!=null?e(null,t.end+1-(t.start?t.start:0)):sje.stat(t.path,function(r,n){var o;if(r){e(r);return}o=n.size-(t.start?t.start:0),e(null,o)}):t.hasOwnProperty("httpVersion")?e(null,+t.headers["content-length"]):t.hasOwnProperty("httpModule")?(t.on("response",function(r){t.pause(),e(null,+r.headers["content-length"])}),t.resume()):e("Unknown stream")};Dr.prototype._multiPartHeader=function(t,e,r){if(typeof r.header=="string")return r.header;var n=this._getContentDisposition(e,r),o=this._getContentType(e,r),s="",a={"Content-Disposition":["form-data",'name="'+t+'"'].concat(n||[]),"Content-Type":[].concat(o||[])};typeof r.header=="object"&&Yz(a,r.header);var c;for(var u in a)a.hasOwnProperty(u)&&(c=a[u],c!=null&&(Array.isArray(c)||(c=[c]),c.length&&(s+=u+": "+c.join("; ")+Dr.LINE_BREAK)));return"--"+this.getBoundary()+Dr.LINE_BREAK+s+Dr.LINE_BREAK};Dr.prototype._getContentDisposition=function(t,e){var r,n;return typeof e.filepath=="string"?r=Wz.normalize(e.filepath).replace(/\\/g,"/"):e.filename||t.name||t.path?r=Wz.basename(e.filename||t.name||t.path):t.readable&&t.hasOwnProperty("httpVersion")&&(r=Wz.basename(t.client._httpMessage.path||"")),r&&(n='filename="'+r+'"'),n};Dr.prototype._getContentType=function(t,e){var r=e.contentType;return!r&&t.name&&(r=Kz.lookup(t.name)),!r&&t.path&&(r=Kz.lookup(t.path)),!r&&t.readable&&t.hasOwnProperty("httpVersion")&&(r=t.headers["content-type"]),!r&&(e.filepath||e.filename)&&(r=Kz.lookup(e.filepath||e.filename)),!r&&typeof t=="object"&&(r=Dr.DEFAULT_CONTENT_TYPE),r};Dr.prototype._multiPartFooter=function(){return function(t){var e=Dr.LINE_BREAK,r=this._streams.length===0;r&&(e+=this._lastBoundary()),t(e)}.bind(this)};Dr.prototype._lastBoundary=function(){return"--"+this.getBoundary()+"--"+Dr.LINE_BREAK};Dr.prototype.getHeaders=function(t){var e,r={"content-type":"multipart/form-data; boundary="+this.getBoundary()};for(e in t)t.hasOwnProperty(e)&&(r[e.toLowerCase()]=t[e]);return r};Dr.prototype.setBoundary=function(t){this._boundary=t};Dr.prototype.getBoundary=function(){return this._boundary||this._generateBoundary(),this._boundary};Dr.prototype.getBuffer=function(){for(var t=new Buffer.alloc(0),e=this.getBoundary(),r=0,n=this._streams.length;r<n;r++)typeof this._streams[r]!="function"&&(Buffer.isBuffer(this._streams[r])?t=Buffer.concat([t,this._streams[r]]):t=Buffer.concat([t,Buffer.from(this._streams[r])]),(typeof this._streams[r]!="string"||this._streams[r].substring(2,e.length+2)!==e)&&(t=Buffer.concat([t,Buffer.from(Dr.LINE_BREAK)])));return Buffer.concat([t,Buffer.from(this._lastBoundary())])};Dr.prototype._generateBoundary=function(){for(var t="--------------------------",e=0;e<24;e++)t+=Math.floor(Math.random()*10).toString(16);this._boundary=t};Dr.prototype.getLengthSync=function(){var t=this._overheadLength+this._valueLength;return this._streams.length&&(t+=this._lastBoundary().length),this.hasKnownLength()||this._error(new Error("Cannot calculate proper length in synchronous way.")),t};Dr.prototype.hasKnownLength=function(){var t=!0;return this._valuesToMeasure.length&&(t=!1),t};Dr.prototype.getLength=function(t){var e=this._overheadLength+this._valueLength;if(this._streams.length&&(e+=this._lastBoundary().length),!this._valuesToMeasure.length){process.nextTick(t.bind(this,null,e));return}cje.parallel(this._valuesToMeasure,this._lengthRetriever,function(r,n){if(r){t(r);return}n.forEach(function(o){e+=o}),t(null,e)})};Dr.prototype.submit=function(t,e){var r,n,o={method:"post"};return typeof t=="string"?(t=oje(t),n=Yz({port:t.port,path:t.pathname,host:t.hostname,protocol:t.protocol},o)):(n=Yz(t,o),n.port||(n.port=n.protocol=="https:"?443:80)),n.headers=this.getHeaders(t.headers),n.protocol=="https:"?r=ije.request(n):r=nje.request(n),this.getLength(function(s,a){if(s&&s!=="Unknown stream"){this._error(s);return}if(a&&r.setHeader("Content-Length",a),this.pipe(r),e){var c,u=function(l,d){return r.removeListener("error",u),r.removeListener("response",c),e.call(this,l,d)};c=u.bind(this,null),r.on("error",u),r.on("response",c)}}.bind(this)),r};Dr.prototype._error=function(t){this.error||(this.error=t,this.pause(),this.emit("error",t))};Dr.prototype.toString=function(){return"[object FormData]"}});function f4(){return{name:Xz,async sendRequest(t,e){if(t.formData){let r=t.headers.get("Content-Type");r&&r.indexOf("application/x-www-form-urlencoded")!==-1?(t.body=uje(t.formData),t.formData=void 0):await lje(t.formData,t)}return e(t)}}}function uje(t){let e=new URLSearchParams;for(let[r,n]of Object.entries(t))if(Array.isArray(n))for(let o of n)e.append(r,o.toString());else e.append(r,n.toString());return e.toString()}async function lje(t,e){let r=new wge.default;for(let o of Object.keys(t)){let s=t[o];if(Array.isArray(s))for(let a of s)r.append(o,a);else r.append(o,s)}e.body=r,e.formData=void 0;let n=e.headers.get("Content-Type");n&&n.indexOf("multipart/form-data")!==-1&&e.headers.set("Content-Type",`multipart/form-data; boundary=${r.getBoundary()}`);try{let o=await new Promise((s,a)=>{r.getLength((c,u)=>{c?a(c):s(u)})});e.headers.set("Content-Length",o)}catch{}}var wge,Xz,Jz=R(()=>{wge=W(Ege()),Xz="formDataPolicy"});var kge=L((ekt,Rge)=>{var p1=1e3,f1=p1*60,m1=f1*60,ay=m1*24,dje=ay*7,pje=ay*365.25;Rge.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return fje(t);if(r==="number"&&isFinite(t))return e.long?hje(t):mje(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function fje(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*pje;case"weeks":case"week":case"w":return r*dje;case"days":case"day":case"d":return r*ay;case"hours":case"hour":case"hrs":case"hr":case"h":return r*m1;case"minutes":case"minute":case"mins":case"min":case"m":return r*f1;case"seconds":case"second":case"secs":case"sec":case"s":return r*p1;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function mje(t){var e=Math.abs(t);return e>=ay?Math.round(t/ay)+"d":e>=m1?Math.round(t/m1)+"h":e>=f1?Math.round(t/f1)+"m":e>=p1?Math.round(t/p1)+"s":t+"ms"}function hje(t){var e=Math.abs(t);return e>=ay?m4(t,e,ay,"day"):e>=m1?m4(t,e,m1,"hour"):e>=f1?m4(t,e,f1,"minute"):e>=p1?m4(t,e,p1,"second"):t+" ms"}function m4(t,e,r,n){var o=e>=r*1.5;return Math.round(t/r)+" "+n+(o?"s":"")}});var Zz=L((tkt,Age)=>{function gje(t){r.debug=r,r.default=r,r.coerce=u,r.disable=s,r.enable=o,r.enabled=a,r.humanize=kge(),r.destroy=l,Object.keys(t).forEach(d=>{r[d]=t[d]}),r.names=[],r.skips=[],r.formatters={};function e(d){let p=0;for(let f=0;f<d.length;f++)p=(p<<5)-p+d.charCodeAt(f),p|=0;return r.colors[Math.abs(p)%r.colors.length]}r.selectColor=e;function r(d){let p,f=null,m,h;function g(...v){if(!g.enabled)return;let y=g,_=Number(new Date),b=_-(p||_);y.diff=b,y.prev=p,y.curr=_,p=_,v[0]=r.coerce(v[0]),typeof v[0]!="string"&&v.unshift("%O");let S=0;v[0]=v[0].replace(/%([a-zA-Z%])/g,(w,O)=>{if(w==="%%")return"%";S++;let U=r.formatters[O];if(typeof U=="function"){let z=v[S];w=U.call(y,z),v.splice(S,1),S--}return w}),r.formatArgs.call(y,v),(y.log||r.log).apply(y,v)}return g.namespace=d,g.useColors=r.useColors(),g.color=r.selectColor(d),g.extend=n,g.destroy=r.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>f!==null?f:(m!==r.namespaces&&(m=r.namespaces,h=r.enabled(d)),h),set:v=>{f=v}}),typeof r.init=="function"&&r.init(g),g}function n(d,p){let f=r(this.namespace+(typeof p>"u"?":":p)+d);return f.log=this.log,f}function o(d){r.save(d),r.namespaces=d,r.names=[],r.skips=[];let p,f=(typeof d=="string"?d:"").split(/[\s,]+/),m=f.length;for(p=0;p<m;p++)f[p]&&(d=f[p].replace(/\*/g,".*?"),d[0]==="-"?r.skips.push(new RegExp("^"+d.slice(1)+"$")):r.names.push(new RegExp("^"+d+"$")))}function s(){let d=[...r.names.map(c),...r.skips.map(c).map(p=>"-"+p)].join(",");return r.enable(""),d}function a(d){if(d[d.length-1]==="*")return!0;let p,f;for(p=0,f=r.skips.length;p<f;p++)if(r.skips[p].test(d))return!1;for(p=0,f=r.names.length;p<f;p++)if(r.names[p].test(d))return!0;return!1}function c(d){return d.toString().substring(2,d.toString().length-2).replace(/\.\*\?$/,"*")}function u(d){return d instanceof Error?d.stack||d.message:d}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}Age.exports=gje});var Pge=L((vc,h4)=>{vc.formatArgs=yje;vc.save=bje;vc.load=_je;vc.useColors=vje;vc.storage=xje();vc.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();vc.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function vje(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function yje(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+h4.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,n=0;t[0].replace(/%[a-zA-Z%]/g,o=>{o!=="%%"&&(r++,o==="%c"&&(n=r))}),t.splice(n,0,e)}vc.log=console.debug||console.log||(()=>{});function bje(t){try{t?vc.storage.setItem("debug",t):vc.storage.removeItem("debug")}catch{}}function _je(){let t;try{t=vc.storage.getItem("debug")}catch{}return!t&&typeof process<"u"&&"env"in process&&(t=process.env.DEBUG),t}function xje(){try{return localStorage}catch{}}h4.exports=Zz()(vc);var{formatters:Sje}=h4.exports;Sje.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var Nge=L((rkt,Dge)=>{"use strict";Dge.exports=(t,e=process.argv)=>{let r=t.startsWith("-")?"":t.length===1?"-":"--",n=e.indexOf(r+t),o=e.indexOf("--");return n!==-1&&(o===-1||n<o)}});var Mge=L((nkt,Oge)=>{"use strict";var Ije=require("os"),Lge=require("tty"),cu=Nge(),{env:qo}=process,Dh;cu("no-color")||cu("no-colors")||cu("color=false")||cu("color=never")?Dh=0:(cu("color")||cu("colors")||cu("color=true")||cu("color=always"))&&(Dh=1);"FORCE_COLOR"in qo&&(qo.FORCE_COLOR==="true"?Dh=1:qo.FORCE_COLOR==="false"?Dh=0:Dh=qo.FORCE_COLOR.length===0?1:Math.min(parseInt(qo.FORCE_COLOR,10),3));function eG(t){return t===0?!1:{level:t,hasBasic:!0,has256:t>=2,has16m:t>=3}}function tG(t,e){if(Dh===0)return 0;if(cu("color=16m")||cu("color=full")||cu("color=truecolor"))return 3;if(cu("color=256"))return 2;if(t&&!e&&Dh===void 0)return 0;let r=Dh||0;if(qo.TERM==="dumb")return r;if(process.platform==="win32"){let n=Ije.release().split(".");return Number(n[0])>=10&&Number(n[2])>=10586?Number(n[2])>=14931?3:2:1}if("CI"in qo)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(n=>n in qo)||qo.CI_NAME==="codeship"?1:r;if("TEAMCITY_VERSION"in qo)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(qo.TEAMCITY_VERSION)?1:0;if(qo.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in qo){let n=parseInt((qo.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(qo.TERM_PROGRAM){case"iTerm.app":return n>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(qo.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(qo.TERM)||"COLORTERM"in qo?1:r}function Cje(t){let e=tG(t,t&&t.isTTY);return eG(e)}Oge.exports={supportsColor:Cje,stdout:eG(tG(!0,Lge.isatty(1))),stderr:eG(tG(!0,Lge.isatty(2)))}});var Uge=L((ps,v4)=>{var Tje=require("tty"),g4=require("util");ps.init=Dje;ps.log=kje;ps.formatArgs=wje;ps.save=Aje;ps.load=Pje;ps.useColors=Eje;ps.destroy=g4.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");ps.colors=[6,2,3,4,5,1];try{let t=Mge();t&&(t.stderr||t).level>=2&&(ps.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}ps.inspectOpts=Object.keys(process.env).filter(t=>/^debug_/i.test(t)).reduce((t,e)=>{let r=e.substring(6).toLowerCase().replace(/_([a-z])/g,(o,s)=>s.toUpperCase()),n=process.env[e];return/^(yes|on|true|enabled)$/i.test(n)?n=!0:/^(no|off|false|disabled)$/i.test(n)?n=!1:n==="null"?n=null:n=Number(n),t[r]=n,t},{});function Eje(){return"colors"in ps.inspectOpts?!!ps.inspectOpts.colors:Tje.isatty(process.stderr.fd)}function wje(t){let{namespace:e,useColors:r}=this;if(r){let n=this.color,o="\x1B[3"+(n<8?n:"8;5;"+n),s=`  ${o};1m${e} \x1B[0m`;t[0]=s+t[0].split(`
`).join(`
`+s),t.push(o+"m+"+v4.exports.humanize(this.diff)+"\x1B[0m")}else t[0]=Rje()+e+" "+t[0]}function Rje(){return ps.inspectOpts.hideDate?"":new Date().toISOString()+" "}function kje(...t){return process.stderr.write(g4.format(...t)+`
`)}function Aje(t){t?process.env.DEBUG=t:delete process.env.DEBUG}function Pje(){return process.env.DEBUG}function Dje(t){t.inspectOpts={};let e=Object.keys(ps.inspectOpts);for(let r=0;r<e.length;r++)t.inspectOpts[e[r]]=ps.inspectOpts[e[r]]}v4.exports=Zz()(ps);var{formatters:Fge}=v4.exports;Fge.o=function(t){return this.inspectOpts.colors=this.useColors,g4.inspect(t,this.inspectOpts).split(`
`).map(e=>e.trim()).join(" ")};Fge.O=function(t){return this.inspectOpts.colors=this.useColors,g4.inspect(t,this.inspectOpts)}});var al=L((ikt,rG)=>{typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?rG.exports=Pge():rG.exports=Uge()});var Bge=L(nG=>{"use strict";Object.defineProperty(nG,"__esModule",{value:!0});function Nje(t){return function(e,r){return new Promise((n,o)=>{t.call(this,e,r,(s,a)=>{s?o(s):n(a)})})}}nG.default=Nje});var sG=L((oG,Hge)=>{"use strict";var qge=oG&&oG.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},Lje=require("events"),Oje=qge(al()),Mje=qge(Bge()),Yw=Oje.default("agent-base");function Fje(t){return!!t&&typeof t.addRequest=="function"}function iG(){let{stack:t}=new Error;return typeof t!="string"?!1:t.split(`
`).some(e=>e.indexOf("(https.js:")!==-1||e.indexOf("node:https:")!==-1)}function y4(t,e){return new y4.Agent(t,e)}(function(t){class e extends Lje.EventEmitter{constructor(n,o){super();let s=o;typeof n=="function"?this.callback=n:n&&(s=n),this.timeout=null,s&&typeof s.timeout=="number"&&(this.timeout=s.timeout),this.maxFreeSockets=1,this.maxSockets=1,this.maxTotalSockets=1/0,this.sockets={},this.freeSockets={},this.requests={},this.options={}}get defaultPort(){return typeof this.explicitDefaultPort=="number"?this.explicitDefaultPort:iG()?443:80}set defaultPort(n){this.explicitDefaultPort=n}get protocol(){return typeof this.explicitProtocol=="string"?this.explicitProtocol:iG()?"https:":"http:"}set protocol(n){this.explicitProtocol=n}callback(n,o,s){throw new Error('"agent-base" has no default implementation, you must subclass and override `callback()`')}addRequest(n,o){let s=Object.assign({},o);typeof s.secureEndpoint!="boolean"&&(s.secureEndpoint=iG()),s.host==null&&(s.host="localhost"),s.port==null&&(s.port=s.secureEndpoint?443:80),s.protocol==null&&(s.protocol=s.secureEndpoint?"https:":"http:"),s.host&&s.path&&delete s.path,delete s.agent,delete s.hostname,delete s._defaultAgent,delete s.defaultPort,delete s.createConnection,n._last=!0,n.shouldKeepAlive=!1;let a=!1,c=null,u=s.timeout||this.timeout,l=m=>{n._hadError||(n.emit("error",m),n._hadError=!0)},d=()=>{c=null,a=!0;let m=new Error(`A "socket" was not created for HTTP request before ${u}ms`);m.code="ETIMEOUT",l(m)},p=m=>{a||(c!==null&&(clearTimeout(c),c=null),l(m))},f=m=>{if(a)return;if(c!=null&&(clearTimeout(c),c=null),Fje(m)){Yw("Callback returned another Agent instance %o",m.constructor.name),m.addRequest(n,s);return}if(m){m.once("free",()=>{this.freeSocket(m,s)}),n.onSocket(m);return}let h=new Error(`no Duplex stream was returned to agent-base for \`${n.method} ${n.path}\``);l(h)};if(typeof this.callback!="function"){l(new Error("`callback` is not defined"));return}this.promisifiedCallback||(this.callback.length>=3?(Yw("Converting legacy callback function to promise"),this.promisifiedCallback=Mje.default(this.callback)):this.promisifiedCallback=this.callback),typeof u=="number"&&u>0&&(c=setTimeout(d,u)),"port"in s&&typeof s.port!="number"&&(s.port=Number(s.port));try{Yw("Resolving socket for %o request: %o",s.protocol,`${n.method} ${n.path}`),Promise.resolve(this.promisifiedCallback(n,s)).then(f,p)}catch(m){Promise.reject(m).catch(p)}}freeSocket(n,o){Yw("Freeing socket %o %o",n.constructor.name,o),n.destroy()}destroy(){Yw("Destroying agent %o",this.constructor.name)}}t.Agent=e,t.prototype=t.Agent.prototype})(y4||(y4={}));Hge.exports=y4});var jge=L(Xw=>{"use strict";var Uje=Xw&&Xw.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Xw,"__esModule",{value:!0});var Bje=Uje(al()),Qw=Bje.default("https-proxy-agent:parse-proxy-response");function qje(t){return new Promise((e,r)=>{let n=0,o=[];function s(){let p=t.read();p?d(p):t.once("readable",s)}function a(){t.removeListener("end",u),t.removeListener("error",l),t.removeListener("close",c),t.removeListener("readable",s)}function c(p){Qw("onclose had error %o",p)}function u(){Qw("onend")}function l(p){a(),Qw("onerror %o",p),r(p)}function d(p){o.push(p),n+=p.length;let f=Buffer.concat(o,n);if(f.indexOf(`\r
\r
`)===-1){Qw("have not received end of HTTP headers yet..."),s();return}let h=f.toString("ascii",0,f.indexOf(`\r
`)),g=+h.split(" ")[1];Qw("got proxy server response: %o",h),e({statusCode:g,buffered:f})}t.on("error",l),t.on("close",c),t.on("end",u),s()})}Xw.default=qje});var Vge=L(cy=>{"use strict";var Hje=cy&&cy.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},h1=cy&&cy.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(cy,"__esModule",{value:!0});var zge=h1(require("net")),Gge=h1(require("tls")),jje=h1(require("url")),zje=h1(require("assert")),Gje=h1(al()),Vje=sG(),$je=h1(jge()),Jw=Gje.default("https-proxy-agent:agent"),aG=class extends Vje.Agent{constructor(e){let r;if(typeof e=="string"?r=jje.default.parse(e):r=e,!r)throw new Error("an HTTP(S) proxy server `host` and `port` must be specified!");Jw("creating new HttpsProxyAgent instance: %o",r),super(r);let n=Object.assign({},r);this.secureProxy=r.secureProxy||Yje(n.protocol),n.host=n.hostname||n.host,typeof n.port=="string"&&(n.port=parseInt(n.port,10)),!n.port&&n.host&&(n.port=this.secureProxy?443:80),this.secureProxy&&!("ALPNProtocols"in n)&&(n.ALPNProtocols=["http 1.1"]),n.host&&n.path&&(delete n.path,delete n.pathname),this.proxy=n}callback(e,r){return Hje(this,void 0,void 0,function*(){let{proxy:n,secureProxy:o}=this,s;o?(Jw("Creating `tls.Socket`: %o",n),s=Gge.default.connect(n)):(Jw("Creating `net.Socket`: %o",n),s=zge.default.connect(n));let a=Object.assign({},n.headers),u=`CONNECT ${`${r.host}:${r.port}`} HTTP/1.1\r
`;n.auth&&(a["Proxy-Authorization"]=`Basic ${Buffer.from(n.auth).toString("base64")}`);let{host:l,port:d,secureEndpoint:p}=r;Kje(d,p)||(l+=`:${d}`),a.Host=l,a.Connection="close";for(let v of Object.keys(a))u+=`${v}: ${a[v]}\r
`;let f=$je.default(s);s.write(`${u}\r
`);let{statusCode:m,buffered:h}=yield f;if(m===200){if(e.once("socket",Wje),r.secureEndpoint){Jw("Upgrading socket connection to TLS");let v=r.servername||r.host;return Gge.default.connect(Object.assign(Object.assign({},Qje(r,"host","hostname","path","port")),{socket:s,servername:v}))}return s}s.destroy();let g=new zge.default.Socket({writable:!1});return g.readable=!0,e.once("socket",v=>{Jw("replaying proxy buffer for failed request"),zje.default(v.listenerCount("data")>0),v.push(h),v.push(null)}),g})}};cy.default=aG;function Wje(t){t.resume()}function Kje(t,e){return!!(!e&&t===80||e&&t===443)}function Yje(t){return typeof t=="string"?/^https:?$/i.test(t):!1}function Qje(t,...e){let r={},n;for(n in t)e.includes(n)||(r[n]=t[n]);return r}});var Wge=L((lG,$ge)=>{"use strict";var Xje=lG&&lG.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},cG=Xje(Vge());function uG(t){return new cG.default(t)}(function(t){t.HttpsProxyAgent=cG.default,t.prototype=cG.default.prototype})(uG||(uG={}));$ge.exports=uG});var Kge=L(dG=>{"use strict";Object.defineProperty(dG,"__esModule",{value:!0});function Jje(t,e,{signal:r}={}){return new Promise((n,o)=>{function s(){r?.removeEventListener("abort",s),t.removeListener(e,a),t.removeListener("error",c)}function a(...u){s(),n(u)}function c(u){s(),o(u)}r?.addEventListener("abort",s),t.on(e,a),t.on("error",c)})}dG.default=Jje});var Yge=L(uy=>{"use strict";var Zje=uy&&uy.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},Zw=uy&&uy.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(uy,"__esModule",{value:!0});var eze=Zw(require("net")),tze=Zw(require("tls")),pG=Zw(require("url")),rze=Zw(al()),nze=Zw(Kge()),ize=sG(),Nh=(0,rze.default)("http-proxy-agent");function oze(t){return typeof t=="string"?/^https:?$/i.test(t):!1}var fG=class extends ize.Agent{constructor(e){let r;if(typeof e=="string"?r=pG.default.parse(e):r=e,!r)throw new Error("an HTTP(S) proxy server `host` and `port` must be specified!");Nh("Creating new HttpProxyAgent instance: %o",r),super(r);let n=Object.assign({},r);this.secureProxy=r.secureProxy||oze(n.protocol),n.host=n.hostname||n.host,typeof n.port=="string"&&(n.port=parseInt(n.port,10)),!n.port&&n.host&&(n.port=this.secureProxy?443:80),n.host&&n.path&&(delete n.path,delete n.pathname),this.proxy=n}callback(e,r){return Zje(this,void 0,void 0,function*(){let{proxy:n,secureProxy:o}=this,s=pG.default.parse(e.path);s.protocol||(s.protocol="http:"),s.hostname||(s.hostname=r.hostname||r.host||null),s.port==null&&typeof r.port&&(s.port=String(r.port)),s.port==="80"&&(s.port=""),e.path=pG.default.format(s),n.auth&&e.setHeader("Proxy-Authorization",`Basic ${Buffer.from(n.auth).toString("base64")}`);let a;if(o?(Nh("Creating `tls.Socket`: %o",n),a=tze.default.connect(n)):(Nh("Creating `net.Socket`: %o",n),a=eze.default.connect(n)),e._header){let c,u;Nh("Regenerating stored HTTP header string for request"),e._header=null,e._implicitHeader(),e.output&&e.output.length>0?(Nh("Patching connection write() output buffer with updated header"),c=e.output[0],u=c.indexOf(`\r
\r
`)+4,e.output[0]=e._header+c.substring(u),Nh("Output buffer: %o",e.output)):e.outputData&&e.outputData.length>0&&(Nh("Patching connection write() output buffer with updated header"),c=e.outputData[0].data,u=c.indexOf(`\r
\r
`)+4,e.outputData[0].data=e._header+c.substring(u),Nh("Output buffer: %o",e.outputData[0].data))}return yield(0,nze.default)(a,"connect"),a})}};uy.default=fG});var Xge=L((gG,Qge)=>{"use strict";var sze=gG&&gG.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},mG=sze(Yge());function hG(t){return new mG.default(t)}(function(t){t.HttpProxyAgent=mG.default,t.prototype=mG.default.prototype})(hG||(hG={}));Qge.exports=hG});function b4(t){if(process.env[t])return process.env[t];if(process.env[t.toLowerCase()])return process.env[t.toLowerCase()]}function pze(){if(!process)return;let t=b4(aze),e=b4(uze),r=b4(cze);return t||e||r}function fze(t,e,r){if(e.length===0)return!1;let n=new URL(t).hostname;if(r?.has(n))return r.get(n);let o=!1;for(let s of e)s[0]==="."?(n.endsWith(s)||n.length===s.length-1&&n===s.slice(1))&&(o=!0):n===s&&(o=!0);return r?.set(n,o),o}function mze(){let t=b4(lze);return rve=!0,t?t.split(",").map(e=>e.trim()).filter(e=>e.length):[]}function yG(t){if(!t&&(t=pze(),!t))return;let e=new URL(t);return{host:(e.protocol?e.protocol+"//":"")+e.hostname,port:Number.parseInt(e.port||"80"),username:e.username,password:e.password}}function Zge(t,{headers:e,tlsSettings:r}){let n;try{n=new URL(t.host)}catch{throw new Error(`Expecting a valid host string in proxy settings, but found "${t.host}".`)}r&&ds.warning("TLS settings are not supported in combination with custom Proxy, certificates provided to the client will be ignored.");let o={hostname:n.hostname,port:t.port,protocol:n.protocol,headers:e.toJSON()};return t.username&&t.password?o.auth=`${t.username}:${t.password}`:t.username&&(o.auth=`${t.username}`),o}function hze(t,e){if(t.agent)return;let n=new URL(t.url).protocol!=="https:",o=t.proxySettings;if(o)if(n){if(!e.httpProxyAgent){let s=Zge(o,t);e.httpProxyAgent=new tve.HttpProxyAgent(s)}t.agent=e.httpProxyAgent}else{if(!e.httpsProxyAgent){let s=Zge(o,t);e.httpsProxyAgent=new eve.HttpsProxyAgent(s)}t.agent=e.httpsProxyAgent}}function _4(t=yG(),e){rve||Jge.push(...mze());let r={};return{name:vG,async sendRequest(n,o){var s;return!n.proxySettings&&!fze(n.url,(s=e?.customNoProxyList)!==null&&s!==void 0?s:Jge,e?.customNoProxyList?void 0:dze)&&(n.proxySettings=t),n.proxySettings&&hze(n,r),o(n)}}}var eve,tve,aze,cze,uze,lze,vG,Jge,rve,dze,bG=R(()=>{eve=W(Wge()),tve=W(Xge());n1();aze="HTTPS_PROXY",cze="HTTP_PROXY",uze="ALL_PROXY",lze="NO_PROXY",vG="proxyPolicy",Jge=[],rve=!1,dze=new Map});function x4(t="x-ms-client-request-id"){return{name:_G,async sendRequest(e,r){return e.headers.has(t)||e.headers.set(t,e.requestId),r(e)}}}var _G,xG=R(()=>{_G="setClientRequestIdPolicy"});function S4(t){return{name:SG,sendRequest:async(e,r)=>(e.tlsSettings||(e.tlsSettings=t),r(e))}}var SG,IG=R(()=>{SG="tlsPolicy"});function nve(t={}){let e=new CG(t.parentContext);return t.span&&(e=e.setValue(g1.span,t.span)),t.namespace&&(e=e.setValue(g1.namespace,t.namespace)),e}var g1,CG,TG=R(()=>{g1={span:Symbol.for("@azure/core-tracing span"),namespace:Symbol.for("@azure/core-tracing namespace")};CG=class t{constructor(e){this._contextMap=e instanceof t?new Map(e._contextMap):new Map}setValue(e,r){let n=new t(this);return n._contextMap.set(e,r),n}getValue(e){return this._contextMap.get(e)}deleteValue(e){let r=new t(this);return r._contextMap.delete(e),r}}});function gze(){return{end:()=>{},isRecording:()=>!1,recordException:()=>{},setAttribute:()=>{},setStatus:()=>{}}}function vze(){return{createRequestHeaders:()=>({}),parseTraceparentHeader:()=>{},startSpan:(t,e)=>({span:gze(),tracingContext:nve({parentContext:e.tracingContext})}),withContext(t,e,...r){return e(...r)}}}function eR(){return EG||(EG=vze()),EG}var EG,ive=R(()=>{TG()});function wG(t){let{namespace:e,packageName:r,packageVersion:n}=t;function o(l,d,p){var f;let m=eR().startSpan(l,Object.assign(Object.assign({},p),{packageName:r,packageVersion:n,tracingContext:(f=d?.tracingOptions)===null||f===void 0?void 0:f.tracingContext})),h=m.tracingContext,g=m.span;h.getValue(g1.namespace)||(h=h.setValue(g1.namespace,e)),g.setAttribute("az.namespace",h.getValue(g1.namespace));let v=Object.assign({},d,{tracingOptions:Object.assign(Object.assign({},d?.tracingOptions),{tracingContext:h})});return{span:g,updatedOptions:v}}async function s(l,d,p,f){let{span:m,updatedOptions:h}=o(l,d,f);try{let g=await a(h.tracingOptions.tracingContext,()=>Promise.resolve(p(h,m)));return m.setStatus({status:"success"}),g}catch(g){throw m.setStatus({status:"error",error:g}),g}finally{m.end()}}function a(l,d,...p){return eR().withContext(l,d,...p)}function c(l){return eR().parseTraceparentHeader(l)}function u(l){return eR().createRequestHeaders(l)}return{startSpan:o,withSpan:s,withContext:a,parseTraceparentHeader:c,createRequestHeaders:u}}var ove=R(()=>{ive();TG()});var sve=R(()=>{ove()});var ave,cve,uve=R(()=>{ave=require("util"),cve=ave.inspect.custom});function I4(t){return t instanceof yc?!0:o1(t)&&t.name==="RestError"}var yze,yc,C4=R(()=>{a1();uve();Rz();yze=new c1,yc=class t extends Error{constructor(e,r={}){super(e),this.name="RestError",this.code=r.code,this.statusCode=r.statusCode,this.request=r.request,this.response=r.response,Object.setPrototypeOf(this,t.prototype)}[cve](){return`RestError: ${this.message} 
 ${yze.sanitize(this)}`}};yc.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR";yc.PARSE_ERROR="PARSE_ERROR"});function T4(t={}){let e=r4(t.userAgentPrefix),r=bze();return{name:RG,async sendRequest(n,o){var s,a;if(!r||!(!((s=n.tracingOptions)===null||s===void 0)&&s.tracingContext))return o(n);let{span:c,tracingContext:u}=(a=_ze(r,n,e))!==null&&a!==void 0?a:{};if(!c||!u)return o(n);try{let l=await r.withContext(u,o,n);return Sze(c,l),l}catch(l){throw xze(c,l),l}}}}function bze(){try{return wG({namespace:"",packageName:"@azure/core-rest-pipeline",packageVersion:t4})}catch(t){ds.warning(`Error when creating the TracingClient: ${s1(t)}`);return}}function _ze(t,e,r){try{let{span:n,updatedOptions:o}=t.startSpan(`HTTP ${e.method}`,{tracingOptions:e.tracingOptions},{spanKind:"client",spanAttributes:{"http.method":e.method,"http.url":e.url,requestId:e.requestId}});if(!n.isRecording()){n.end();return}r&&n.setAttribute("http.user_agent",r);let s=t.createRequestHeaders(o.tracingOptions.tracingContext);for(let[a,c]of Object.entries(s))e.headers.set(a,c);return{span:n,tracingContext:o.tracingOptions.tracingContext}}catch(n){ds.warning(`Skipping creating a tracing span due to an error: ${s1(n)}`);return}}function xze(t,e){try{t.setStatus({status:"error",error:o1(e)?e:void 0}),I4(e)&&e.statusCode&&t.setAttribute("http.status_code",e.statusCode),t.end()}catch(r){ds.warning(`Skipping tracing span processing due to an error: ${s1(r)}`)}}function Sze(t,e){try{t.setAttribute("http.status_code",e.status);let r=e.headers.get("x-ms-request-id");r&&t.setAttribute("serviceRequestId",r),t.setStatus({status:"success"}),t.end()}catch(r){ds.warning(`Skipping tracing span processing due to an error: ${s1(r)}`)}}var RG,kG=R(()=>{sve();Nz();Lz();n1();a1();C4();RG="tracingPolicy"});function lve(t){let e=VL();return QL&&(t.tlsOptions&&e.addPolicy(S4(t.tlsOptions)),e.addPolicy(_4(t.proxyOptions)),e.addPolicy(i4())),e.addPolicy(f4()),e.addPolicy(n4(t.userAgentOptions)),e.addPolicy(x4()),e.addPolicy(l4(t.retryOptions),{phase:"Retry"}),e.addPolicy(T4(t.userAgentOptions),{afterPhase:"Retry"}),QL&&e.addPolicy(e4(t.redirectOptions),{afterPhase:"Retry"}),e.addPolicy(ZL(t.loggingOptions),{afterPhase:"Sign"}),e}var dve=R(()=>{Az();mz();Dz();Mz();Uz();qz();Jz();a1();bG();xG();IG();kG()});function E4(t){return t.toLowerCase()}function*Ize(t){for(let e of t.values())yield[e.name,e.value]}function v1(t){return new AG(t)}var AG,w4=R(()=>{AG=class{constructor(e){if(this._headersMap=new Map,e)for(let r of Object.keys(e))this.set(r,e[r])}set(e,r){this._headersMap.set(E4(e),{name:e,value:String(r)})}get(e){var r;return(r=this._headersMap.get(E4(e)))===null||r===void 0?void 0:r.value}has(e){return this._headersMap.has(E4(e))}delete(e){this._headersMap.delete(E4(e))}toJSON(e={}){let r={};if(e.preserveCase)for(let n of this._headersMap.values())r[n.name]=n.value;else for(let[n,o]of this._headersMap)r[n]=o.value;return r}toString(){return JSON.stringify(this.toJSON({preserveCase:!0}))}[Symbol.iterator](){return Ize(this._headersMap)}}});function tR(t){return t&&typeof t.pipe=="function"}function pve(t){return new Promise(e=>{t.on("close",e),t.on("end",e),t.on("error",e)})}function mve(t){return t&&typeof t.byteLength=="number"}function Tze(t){let e=v1();for(let r of Object.keys(t.headers)){let n=t.headers[r];Array.isArray(n)?n.length>0&&e.set(r,n[0]):n&&e.set(r,n)}return e}function Eze(t,e){let r=e.get("Content-Encoding");if(r==="gzip"){let n=k4.createGunzip();return t.pipe(n),n}else if(r==="deflate"){let n=k4.createInflate();return t.pipe(n),n}return t}function wze(t){return new Promise((e,r)=>{let n=[];t.on("data",o=>{Buffer.isBuffer(o)?n.push(o):n.push(Buffer.from(o))}),t.on("end",()=>{e(Buffer.concat(n).toString("utf8"))}),t.on("error",o=>{o&&o?.name==="AbortError"?r(o):r(new yc(`Error reading response as text: ${o.message}`,{code:yc.PARSE_ERROR}))})})}function Rze(t){return t?Buffer.isBuffer(t)?t.length:tR(t)?null:mve(t)?t.byteLength:typeof t=="string"?Buffer.from(t).length:null:0}function hve(){return new PG}var y1,b1,k4,fve,Cze,R4,PG,gve=R(()=>{y1=W(require("http")),b1=W(require("https")),k4=W(require("zlib")),fve=require("stream");JL();w4();C4();n1();Cze={};R4=class extends fve.Transform{constructor(e){super(),this.loadedBytes=0,this.progressCallback=e}_transform(e,r,n){this.push(e),this.loadedBytes+=e.length;try{this.progressCallback({loadedBytes:this.loadedBytes}),n()}catch(o){n(o)}}},PG=class{constructor(){this.cachedHttpsAgents=new WeakMap}async sendRequest(e){var r,n,o;let s=new $w,a;if(e.abortSignal){if(e.abortSignal.aborted)throw new md("The operation was aborted.");a=p=>{p.type==="abort"&&s.abort()},e.abortSignal.addEventListener("abort",a)}e.timeout>0&&setTimeout(()=>{s.abort()},e.timeout);let c=e.headers.get("Accept-Encoding"),u=c?.includes("gzip")||c?.includes("deflate"),l=typeof e.body=="function"?e.body():e.body;if(l&&!e.headers.has("Content-Length")){let p=Rze(l);p!==null&&e.headers.set("Content-Length",p)}let d;try{if(l&&e.onUploadProgress){let v=e.onUploadProgress,y=new R4(v);y.on("error",_=>{ds.error("Error in upload progress",_)}),tR(l)?l.pipe(y):y.end(l),l=y}let p=await this.makeRequest(e,s,l),f=Tze(p),h={status:(r=p.statusCode)!==null&&r!==void 0?r:0,headers:f,request:e};if(e.method==="HEAD")return p.resume(),h;d=u?Eze(p,f):p;let g=e.onDownloadProgress;if(g){let v=new R4(g);v.on("error",y=>{ds.error("Error in download progress",y)}),d.pipe(v),d=v}return!((n=e.streamResponseStatusCodes)===null||n===void 0)&&n.has(Number.POSITIVE_INFINITY)||!((o=e.streamResponseStatusCodes)===null||o===void 0)&&o.has(h.status)?h.readableStreamBody=d:h.bodyAsText=await wze(d),h}finally{if(e.abortSignal&&a){let p=Promise.resolve();tR(l)&&(p=pve(l));let f=Promise.resolve();tR(d)&&(f=pve(d)),Promise.all([p,f]).then(()=>{var m;a&&((m=e.abortSignal)===null||m===void 0||m.removeEventListener("abort",a))}).catch(m=>{ds.warning("Error when cleaning up abortListener on httpRequest",m)})}}}makeRequest(e,r,n){var o;let s=new URL(e.url),a=s.protocol!=="https:";if(a&&!e.allowInsecureConnection)throw new Error(`Cannot connect to ${e.url} while allowInsecureConnection is false.`);let u={agent:(o=e.agent)!==null&&o!==void 0?o:this.getOrCreateAgent(e,a),hostname:s.hostname,path:`${s.pathname}${s.search}`,port:s.port,method:e.method,headers:e.headers.toJSON({preserveCase:!0})};return new Promise((l,d)=>{let p=a?y1.request(u,l):b1.request(u,l);p.once("error",f=>{var m;d(new yc(f.message,{code:(m=f.code)!==null&&m!==void 0?m:yc.REQUEST_SEND_ERROR,request:e}))}),r.signal.addEventListener("abort",()=>{let f=new md("The operation was aborted.");p.destroy(f),d(f)}),n&&tR(n)?n.pipe(p):n?typeof n=="string"||Buffer.isBuffer(n)?p.end(n):mve(n)?p.end(ArrayBuffer.isView(n)?Buffer.from(n.buffer):Buffer.from(n)):(ds.error("Unrecognized body type",n),d(new yc("Unrecognized body type"))):p.end()})}getOrCreateAgent(e,r){var n;let o=e.disableKeepAlive;if(r)return o?y1.globalAgent:(this.cachedHttpAgent||(this.cachedHttpAgent=new y1.Agent({keepAlive:!0})),this.cachedHttpAgent);{if(o&&!e.tlsSettings)return b1.globalAgent;let s=(n=e.tlsSettings)!==null&&n!==void 0?n:Cze,a=this.cachedHttpsAgents.get(s);return a&&a.options.keepAlive===!o||(ds.info("No cached TLS Agent exist, creating a new Agent"),a=new b1.Agent(Object.assign({keepAlive:!o},s)),this.cachedHttpsAgents.set(s,a)),a}}}});function vve(){return hve()}var yve=R(()=>{gve()});function DG(){return A4>P4.length-16&&(bve.default.randomFillSync(P4),A4=0),P4.slice(A4,A4+=16)}var bve,P4,A4,_ve=R(()=>{bve=W(require("crypto")),P4=new Uint8Array(256),A4=P4.length});var xve,Sve=R(()=>{xve=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i});function kze(t){return typeof t=="string"&&xve.test(t)}var Ive,Cve=R(()=>{Sve();Ive=kze});function Aze(t,e=0){let r=(ms[t[e+0]]+ms[t[e+1]]+ms[t[e+2]]+ms[t[e+3]]+"-"+ms[t[e+4]]+ms[t[e+5]]+"-"+ms[t[e+6]]+ms[t[e+7]]+"-"+ms[t[e+8]]+ms[t[e+9]]+"-"+ms[t[e+10]]+ms[t[e+11]]+ms[t[e+12]]+ms[t[e+13]]+ms[t[e+14]]+ms[t[e+15]]).toLowerCase();if(!Ive(r))throw TypeError("Stringified UUID is invalid");return r}var ms,Tve,Eve=R(()=>{Cve();ms=[];for(let t=0;t<256;++t)ms.push((t+256).toString(16).substr(1));Tve=Aze});function Pze(t,e,r){t=t||{};let n=t.random||(t.rng||DG)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){r=r||0;for(let o=0;o<16;++o)e[r+o]=n[o];return e}return Tve(n)}var NG,wve=R(()=>{_ve();Eve();NG=Pze});var Rve=R(()=>{wve()});function kve(){return NG()}var Ave=R(()=>{Rve()});function Pve(t){return new LG(t)}var LG,Dve=R(()=>{w4();Ave();LG=class{constructor(e){var r,n,o,s,a,c,u;this.url=e.url,this.body=e.body,this.headers=(r=e.headers)!==null&&r!==void 0?r:v1(),this.method=(n=e.method)!==null&&n!==void 0?n:"GET",this.timeout=(o=e.timeout)!==null&&o!==void 0?o:0,this.formData=e.formData,this.disableKeepAlive=(s=e.disableKeepAlive)!==null&&s!==void 0?s:!1,this.proxySettings=e.proxySettings,this.streamResponseStatusCodes=e.streamResponseStatusCodes,this.withCredentials=(a=e.withCredentials)!==null&&a!==void 0?a:!1,this.abortSignal=e.abortSignal,this.tracingOptions=e.tracingOptions,this.onUploadProgress=e.onUploadProgress,this.onDownloadProgress=e.onDownloadProgress,this.requestId=e.requestId||kve(),this.allowInsecureConnection=(c=e.allowInsecureConnection)!==null&&c!==void 0?c:!1,this.enableBrowserStreams=(u=e.enableBrowserStreams)!==null&&u!==void 0?u:!1}}});function Lve(t={}){var e;return hd([l1(Object.assign(Object.assign({},t),{ignoreSystemErrors:!0}))],{maxRetries:(e=t.maxRetries)!==null&&e!==void 0?e:3})}var Nve,Ove=R(()=>{u4();d1();Nve="exponentialRetryPolicy"});function Mve(t={}){var e;return{name:OG,sendRequest:hd([l1(Object.assign(Object.assign({},t),{ignoreHttpStatusCodes:!0}))],{maxRetries:(e=t.maxRetries)!==null&&e!==void 0?e:3}).sendRequest}}var OG,Fve=R(()=>{u4();d1();OG="systemErrorRetryPolicy"});function Uve(t={}){var e;return{name:MG,sendRequest:hd([a4()],{maxRetries:(e=t.maxRetries)!==null&&e!==void 0?e:3}).sendRequest}}var MG,Bve=R(()=>{c4();d1();MG="throttlingRetryPolicy"});async function Nze(t,e,r){async function n(){if(Date.now()<r)try{return await t()}catch{return null}else{let s=await t();if(s===null)throw new Error("Failed to refresh access token.");return s}}let o=await n();for(;o===null;)await o4(e),o=await n();return o}function qve(t,e){let r=null,n=null,o,s=Object.assign(Object.assign({},Dze),e),a={get isRefreshing(){return r!==null},get shouldRefresh(){var u;return!a.isRefreshing&&((u=n?.expiresOnTimestamp)!==null&&u!==void 0?u:0)-s.refreshWindowInMs<Date.now()},get mustRefresh(){return n===null||n.expiresOnTimestamp-s.forcedRefreshWindowInMs<Date.now()}};function c(u,l){var d;return a.isRefreshing||(r=Nze(()=>t.getToken(u,l),s.retryIntervalInMs,(d=n?.expiresOnTimestamp)!==null&&d!==void 0?d:Date.now()).then(f=>(r=null,n=f,o=l.tenantId,n)).catch(f=>{throw r=null,n=null,o=void 0,f})),r}return async(u,l)=>o!==l.tenantId||!!l.claims||a.mustRefresh?c(u,l):(a.shouldRefresh&&c(u,l),n)}var Dze,Hve=R(()=>{s4();Dze={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:1e3*60*2}});async function Lze(t){let{scopes:e,getAccessToken:r,request:n}=t,o={abortSignal:n.abortSignal,tracingOptions:n.tracingOptions},s=await r(e,o);s&&t.request.headers.set("Authorization",`Bearer ${s.token}`)}function Oze(t){let e=t.headers.get("WWW-Authenticate");if(t.status===401&&e)return e}function jve(t){var e;let{credential:r,scopes:n,challengeCallbacks:o}=t,s=t.logger||ds,a=Object.assign({authorizeRequest:(e=o?.authorizeRequest)!==null&&e!==void 0?e:Lze,authorizeRequestOnChallenge:o?.authorizeRequestOnChallenge},o),c=r?qve(r):()=>Promise.resolve(null);return{name:FG,async sendRequest(u,l){if(!u.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");await a.authorizeRequest({scopes:Array.isArray(n)?n:[n],request:u,getAccessToken:c,logger:s});let d,p;try{d=await l(u)}catch(f){p=f,d=f.response}if(a.authorizeRequestOnChallenge&&d?.status===401&&Oze(d)&&await a.authorizeRequestOnChallenge({scopes:Array.isArray(n)?n:[n],request:u,response:d,getAccessToken:c,logger:s}))return l(u);if(p)throw p;return d}}}var FG,zve=R(()=>{Hve();n1();FG="bearerTokenAuthenticationPolicy"});function Gve(){return{name:UG,async sendRequest(t,e){if(typeof t.body=="string"&&t.body.startsWith("[")){let r=JSON.parse(t.body);Array.isArray(r)&&(t.body=r.map(n=>JSON.stringify(n)+`
`).join(""))}return e(t)}}}var UG,Vve=R(()=>{UG="ndJsonPolicy"});var $ve={};dn($ve,{RestError:()=>yc,bearerTokenAuthenticationPolicy:()=>jve,bearerTokenAuthenticationPolicyName:()=>FG,createDefaultHttpClient:()=>vve,createEmptyPipeline:()=>VL,createHttpHeaders:()=>v1,createPipelineFromOptions:()=>lve,createPipelineRequest:()=>Pve,decompressResponsePolicy:()=>i4,decompressResponsePolicyName:()=>Fz,defaultRetryPolicy:()=>l4,exponentialRetryPolicy:()=>Lve,exponentialRetryPolicyName:()=>Nve,formDataPolicy:()=>f4,formDataPolicyName:()=>Xz,getDefaultProxySettings:()=>yG,isRestError:()=>I4,logPolicy:()=>ZL,logPolicyName:()=>kz,ndJsonPolicy:()=>Gve,ndJsonPolicyName:()=>UG,proxyPolicy:()=>_4,proxyPolicyName:()=>vG,redirectPolicy:()=>e4,redirectPolicyName:()=>Pz,retryPolicy:()=>hd,setClientRequestIdPolicy:()=>x4,setClientRequestIdPolicyName:()=>_G,systemErrorRetryPolicy:()=>Mve,systemErrorRetryPolicyName:()=>OG,throttlingRetryPolicy:()=>Uve,throttlingRetryPolicyName:()=>MG,tlsPolicy:()=>S4,tlsPolicyName:()=>SG,tracingPolicy:()=>T4,tracingPolicyName:()=>RG,userAgentPolicy:()=>n4,userAgentPolicyName:()=>Oz});var Wve=R(()=>{mz();dve();yve();w4();Dve();C4();Uz();Ove();xG();Az();bG();Dz();Fve();Bve();d1();kG();qz();Mz();IG();Jz();zve();Vve()});var Qve=L((rR,Yve)=>{"use strict";var Mze=rR&&rR.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},Fze=rR&&rR.__generator||function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(d){return u([l,d])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=l[0]&2?o.return:l[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,l[1])).done)return s;switch(o=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(d){l=[6,d],o=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},Kve=(Wve(),Gi($ve)),Uze="https://monitor.azure.com//.default";function Bze(t){return null}var qze=function(){function t(e,r){var n=r?[r]:[Uze];this._azureTokenPolicy=Kve.bearerTokenAuthenticationPolicy({credential:e,scopes:n})}return t.prototype.addAuthorizationHeader=function(e){return Mze(this,void 0,void 0,function(){var r,n;return Fze(this,function(o){switch(o.label){case 0:return r="authorization",n=Kve.createPipelineRequest({url:"https://"}),[4,this._azureTokenPolicy.sendRequest(n,Bze)];case 1:return o.sent(),e.headers[r]=n.headers.get(r),[2]}})})},t}();Yve.exports=qze});var Jve=L((eAt,Xve)=>{"use strict";var Hze=Fn(),jze=as(),zze=function(){function t(e,r,n,o){this._buffer=[],this._lastSend=0,this._isDisabled=e,this._getBatchSize=r,this._getBatchIntervalMs=n,this._sender=o}return t.prototype.setUseDiskRetryCaching=function(e,r,n){this._sender.setDiskRetryMode(e,r,n)},t.prototype.send=function(e){var r=this;if(!this._isDisabled()){if(!e){Hze.warn("Cannot send null/undefined telemetry");return}if(this._buffer.push(e),this._buffer.length>=this._getBatchSize()){this.triggerSend(!1);return}!this._timeoutHandle&&this._buffer.length>0&&(this._timeoutHandle=setTimeout(function(){r._timeoutHandle=null,r.triggerSend(!1)},this._getBatchIntervalMs()))}},t.prototype.triggerSend=function(e,r){var n=this._buffer.length<1;n||(e||jze.isNodeExit?(this._sender.saveOnCrash(this._buffer),typeof r=="function"&&r("data saved on crash")):this._sender.send(this._buffer,r)),this._lastSend=+new Date,this._buffer=[],clearTimeout(this._timeoutHandle),this._timeoutHandle=null,n&&typeof r=="function"&&r("no data to send")},t}();Xve.exports=zze});var Zve=L(D4=>{"use strict";Object.defineProperty(D4,"__esModule",{value:!0});D4.azureRoleEnvironmentTelemetryProcessor=void 0;function Gze(t,e){}D4.azureRoleEnvironmentTelemetryProcessor=Gze});var r0e=L(_1=>{"use strict";Object.defineProperty(_1,"__esModule",{value:!0});_1.getSamplingHashCode=_1.samplingTelemetryProcessor=void 0;var e0e=Os();function Vze(t,e){var r=t.sampleRate,n=!1;return r==null||r>=100||t.data&&e0e.TelemetryType.Metric===e0e.baseTypeToTelemetryType(t.data.baseType)?!0:(e.correlationContext&&e.correlationContext.operation?n=t0e(e.correlationContext.operation.id)<r:n=Math.random()*100<r,n)}_1.samplingTelemetryProcessor=Vze;function t0e(t){var e=-2147483648,r=2147483647,n=5381;if(!t)return 0;for(;t.length<8;)t=t+t;for(var o=0;o<t.length;o++)n=((n<<5)+n|0)+t.charCodeAt(o)|0;return n=n<=e?r:Math.abs(n),n/r*100}_1.getSamplingHashCode=t0e});var n0e=L(N4=>{"use strict";Object.defineProperty(N4,"__esModule",{value:!0});N4.performanceMetricsTelemetryProcessor=void 0;var BG=PL(),qG=Os();function $ze(t,e){switch(e&&e.addDocument(t),t.data.baseType){case qG.TelemetryTypeString.Exception:BG.countException();break;case qG.TelemetryTypeString.Request:var r=t.data.baseData;BG.countRequest(r.duration,r.success);break;case qG.TelemetryTypeString.Dependency:var n=t.data.baseData;BG.countDependency(n.duration,n.success);break}return!0}N4.performanceMetricsTelemetryProcessor=$ze});var i0e=L(x1=>{"use strict";var gd=x1&&x1.__assign||function(){return gd=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},gd.apply(this,arguments)};Object.defineProperty(x1,"__esModule",{value:!0});x1.preAggregatedMetricsTelemetryProcessor=void 0;var Wze=Os(),nR=Vj(),L4=Os();function Kze(t,e){if(nR.isEnabled())switch(t.data.baseType){case L4.TelemetryTypeString.Exception:var r=t.data.baseData;r.properties=gd(gd({},r.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Exceptions', Ver:'1.1')"});var n={cloudRoleInstance:t.tags[e.keys.cloudRoleInstance],cloudRoleName:t.tags[e.keys.cloudRole]};nR.countException(n);break;case L4.TelemetryTypeString.Trace:var o=t.data.baseData;o.properties=gd(gd({},o.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Traces', Ver:'1.1')"});var s={cloudRoleInstance:t.tags[e.keys.cloudRoleInstance],cloudRoleName:t.tags[e.keys.cloudRole],traceSeverityLevel:Wze.SeverityLevel[o.severity]};nR.countTrace(s);break;case L4.TelemetryTypeString.Request:var a=t.data.baseData;a.properties=gd(gd({},a.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Requests', Ver:'1.1')"});var c={cloudRoleInstance:t.tags[e.keys.cloudRoleInstance],cloudRoleName:t.tags[e.keys.cloudRole],operationSynthetic:t.tags[e.keys.operationSyntheticSource],requestSuccess:a.success,requestResultCode:a.responseCode};nR.countRequest(a.duration,c);break;case L4.TelemetryTypeString.Dependency:var u=t.data.baseData;u.properties=gd(gd({},u.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Dependencies', Ver:'1.1')"});var l={cloudRoleInstance:t.tags[e.keys.cloudRoleInstance],cloudRoleName:t.tags[e.keys.cloudRole],operationSynthetic:t.tags[e.keys.operationSyntheticSource],dependencySuccess:u.success,dependencyType:u.type,dependencyTarget:u.target,dependencyResultCode:u.resultCode};nR.countDependency(u.duration,l);break}return!0}x1.preAggregatedMetricsTelemetryProcessor=Kze});var o0e=L(vd=>{"use strict";var Yze=vd&&vd.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),O4=vd&&vd.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&Yze(e,t,r)};Object.defineProperty(vd,"__esModule",{value:!0});O4(Zve(),vd);O4(r0e(),vd);O4(n0e(),vd);O4(i0e(),vd)});var HG=L((sAt,c0e)=>{"use strict";var Dt=Os(),Ua=as(),s0e=bh(),Qze=Fn(),Xze=function(){function t(){}return t.createEnvelope=function(e,r,n,o,s){var a=null;switch(r){case Dt.TelemetryType.Trace:a=t.createTraceData(e);break;case Dt.TelemetryType.Dependency:a=t.createDependencyData(e);break;case Dt.TelemetryType.Event:a=t.createEventData(e);break;case Dt.TelemetryType.Exception:a=t.createExceptionData(e);break;case Dt.TelemetryType.Request:a=t.createRequestData(e);break;case Dt.TelemetryType.Metric:a=t.createMetricData(e);break;case Dt.TelemetryType.Availability:a=t.createAvailabilityData(e);break;case Dt.TelemetryType.PageView:a=t.createPageViewData(e);break}if(a&&a.baseData&&Dt.domainSupportsProperties(a.baseData)){if(n)if(!a.baseData.properties)a.baseData.properties=n;else for(var c in n)a.baseData.properties[c]||(a.baseData.properties[c]=n[c]);t.addAzureFunctionsCorrelationProperties(a.baseData.properties),a.baseData.properties&&(a.baseData.properties=Ua.validateStringMap(a.baseData.properties))}var u=s&&s.instrumentationKey||"",l=new Dt.Envelope;return l.data=a,l.iKey=u,l.name="Microsoft.ApplicationInsights."+u.replace(/-/g,"")+"."+a.baseType.substr(0,a.baseType.length-4),l.tags=this.getTags(o,e.tagOverrides),l.time=new Date().toISOString(),l.ver=1,l.sampleRate=s?s.samplingPercentage:100,r===Dt.TelemetryType.Metric&&(l.sampleRate=100),l},t.addAzureFunctionsCorrelationProperties=function(e){var r=s0e.CorrelationContextManager.getCurrentContext();if(r&&r.customProperties&&r.customProperties.getProperty instanceof Function){e=e||{};var n=r.customProperties.getProperty("InvocationId");n&&(e.InvocationId=n),n=r.customProperties.getProperty("ProcessId"),n&&(e.ProcessId=n),n=r.customProperties.getProperty("LogLevel"),n&&(e.LogLevel=n),n=r.customProperties.getProperty("Category"),n&&(e.Category=n),n=r.customProperties.getProperty("HostInstanceId"),n&&(e.HostInstanceId=n),n=r.customProperties.getProperty("AzFuncLiveLogsSessionId"),n&&(e.AzFuncLiveLogsSessionId=n)}},t.truncateProperties=function(e){if(e.properties)try{for(var r={},n=Object.keys(e.properties),o=Object.values(e.properties),s=0;s<n.length;s++)n[s].length<=150&&(Ua.isDate(o[s])||(o[s]==null&&(o[s]=""),typeof o[s]=="object"&&(o[s]=Ua.stringify(o[s])),r[n[s]]=String(o[s]).substring(0,8192)),r[n[s]]=o[s]);return r}catch(a){Qze.warn("Failed to properly truncate telemetry properties: ",a)}},t.createTraceData=function(e){var r,n=new Dt.MessageData;n.message=(r=e.message)===null||r===void 0?void 0:r.substring(0,32768),n.properties=this.truncateProperties(e),isNaN(e.severity)?n.severityLevel=Dt.SeverityLevel.Information:n.severityLevel=e.severity;var o=new Dt.Data;return o.baseType=Dt.telemetryTypeToBaseType(Dt.TelemetryType.Trace),o.baseData=n,o},t.createDependencyData=function(e){var r,n,o,s=new Dt.RemoteDependencyData;s.name=(r=e.name)===null||r===void 0?void 0:r.substring(0,1024),s.data=(n=e.data)===null||n===void 0?void 0:n.substring(0,8192),s.target=(o=e.target)===null||o===void 0?void 0:o.substring(0,1024),s.duration=Ua.msToTimeSpan(e.duration),s.success=e.success,s.type=e.dependencyTypeName,s.properties=this.truncateProperties(e),s.resultCode=e.resultCode?e.resultCode.toString():"0",e.id?s.id=e.id:s.id=Ua.w3cTraceId();var a=new Dt.Data;return a.baseType=Dt.telemetryTypeToBaseType(Dt.TelemetryType.Dependency),a.baseData=s,a},t.createEventData=function(e){var r,n=new Dt.EventData;n.name=(r=e.name)===null||r===void 0?void 0:r.substring(0,512),n.properties=this.truncateProperties(e),n.measurements=e.measurements;var o=new Dt.Data;return o.baseType=Dt.telemetryTypeToBaseType(Dt.TelemetryType.Event),o.baseData=n,o},t.createExceptionData=function(e){var r,n,o=new Dt.ExceptionData;o.properties=this.truncateProperties(e),isNaN(e.severity)?o.severityLevel=Dt.SeverityLevel.Error:o.severityLevel=e.severity,o.measurements=e.measurements,o.exceptions=[];var s=e.exception.stack,a=new Dt.ExceptionDetails;a.message=(r=e.exception.message)===null||r===void 0?void 0:r.substring(0,32768),a.typeName=(n=e.exception.name)===null||n===void 0?void 0:n.substring(0,1024),a.parsedStack=this.parseStack(s),a.hasFullStack=Ua.isArray(a.parsedStack)&&a.parsedStack.length>0,o.exceptions.push(a);var c=new Dt.Data;return c.baseType=Dt.telemetryTypeToBaseType(Dt.TelemetryType.Exception),c.baseData=o,c},t.createRequestData=function(e){var r,n,o,s,a=new Dt.RequestData;e.id?a.id=e.id:a.id=Ua.w3cTraceId(),a.name=(r=e.name)===null||r===void 0?void 0:r.substring(0,1024),a.url=(n=e.url)===null||n===void 0?void 0:n.substring(0,2048),a.source=(o=e.source)===null||o===void 0?void 0:o.substring(0,1024),a.duration=Ua.msToTimeSpan(e.duration),a.responseCode=(s=e.resultCode?e.resultCode.toString():"0")===null||s===void 0?void 0:s.substring(0,1024),a.success=e.success,a.properties=this.truncateProperties(e),a.measurements=e.measurements;var c=new Dt.Data;return c.baseType=Dt.telemetryTypeToBaseType(Dt.TelemetryType.Request),c.baseData=a,c},t.createMetricData=function(e){var r,n=new Dt.MetricData;n.metrics=[];var o=new Dt.DataPoint;o.count=isNaN(e.count)?1:e.count,o.kind=Dt.DataPointType.Aggregation,o.max=isNaN(e.max)?e.value:e.max,o.min=isNaN(e.min)?e.value:e.min,o.name=(r=e.name)===null||r===void 0?void 0:r.substring(0,1024),o.stdDev=isNaN(e.stdDev)?0:e.stdDev,o.value=e.value,o.ns=e.namespace,n.metrics.push(o),n.properties=this.truncateProperties(e);var s=new Dt.Data;return s.baseType=Dt.telemetryTypeToBaseType(Dt.TelemetryType.Metric),s.baseData=n,s},t.createAvailabilityData=function(e){var r,n,o=new Dt.AvailabilityData;e.id?o.id=e.id:o.id=Ua.w3cTraceId(),o.name=(r=e.name)===null||r===void 0?void 0:r.substring(0,1024),o.duration=Ua.msToTimeSpan(e.duration),o.success=e.success,o.runLocation=e.runLocation,o.message=(n=e.message)===null||n===void 0?void 0:n.substring(0,8192),o.measurements=e.measurements,o.properties=this.truncateProperties(e);var s=new Dt.Data;return s.baseType=Dt.telemetryTypeToBaseType(Dt.TelemetryType.Availability),s.baseData=o,s},t.createPageViewData=function(e){var r,n,o=new Dt.PageViewData;o.name=(r=e.name)===null||r===void 0?void 0:r.substring(0,1024),o.duration=Ua.msToTimeSpan(e.duration),o.url=(n=e.url)===null||n===void 0?void 0:n.substring(0,2048),o.measurements=e.measurements,o.properties=this.truncateProperties(e);var s=new Dt.Data;return s.baseType=Dt.telemetryTypeToBaseType(Dt.TelemetryType.PageView),s.baseData=o,s},t.getTags=function(e,r){var n=s0e.CorrelationContextManager.getCurrentContext(),o={};if(e&&e.tags)for(var s in e.tags)o[s]=e.tags[s];if(r)for(var s in r)o[s]=r[s];return n&&(o[e.keys.operationId]=o[e.keys.operationId]||n.operation.id,o[e.keys.operationName]=o[e.keys.operationName]||n.operation.name,o[e.keys.operationParentId]=o[e.keys.operationParentId]||n.operation.parentId),o},t.parseStack=function(e){var r=void 0;if(typeof e=="string"){var n=e.split(`
`);r=[];for(var o=0,s=0,a=0;a<=n.length;a++){var c=n[a];if(a0e.regex.test(c)){var u=new a0e(n[a],o++);s+=u.sizeInBytes,r.push(u)}}var l=32*1024;if(s>l)for(var d=0,p=r.length-1,f=0,m=d,h=p;d<p;){var g=r[d].sizeInBytes,v=r[p].sizeInBytes;if(f+=g+v,f>l){var y=h-m+1;r.splice(m,y);break}m=d,h=p,d++,p--}}return r},t}(),a0e=function(){function t(e,r){this.sizeInBytes=0,this.level=r,this.method="<no_method>",this.assembly=Ua.trim(e);var n=e.match(t.regex);n&&n.length>=5&&(this.method=Ua.trim(n[2])||this.method,this.fileName=Ua.trim(n[4])||"<no_filename>",this.line=parseInt(n[5])||0),this.sizeInBytes+=this.method.length,this.sizeInBytes+=this.fileName.length,this.sizeInBytes+=this.assembly.length,this.sizeInBytes+=t.baseSize,this.sizeInBytes+=this.level.toString().length,this.sizeInBytes+=this.line.toString().length}return t.regex=/^(\s+at)?(.*?)(\@|\s\(|\s)([^\(\n]+):(\d+):(\d+)(\)?)$/,t.baseSize=58,t}();c0e.exports=Xze});var u0e=L(Lh=>{"use strict";var Jze=Lh&&Lh.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},Zze=Lh&&Lh.__generator||function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(d){return u([l,d])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=l[0]&2?o.return:l[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,l[1])).done)return s;switch(o=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(d){l=[6,d],o=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(Lh,"__esModule",{value:!0});Lh.FileAccessControl=void 0;var eGe=require("fs"),tGe=require("os"),S1=require("child_process"),rGe=Fn(),nGe=function(){function t(){}return t.checkFileProtection=function(){if(!t.OS_PROVIDES_FILE_PROTECTION&&!t.OS_FILE_PROTECTION_CHECKED)if(t.OS_FILE_PROTECTION_CHECKED=!0,t.USE_ICACLS){try{t.OS_PROVIDES_FILE_PROTECTION=eGe.existsSync(t.ICACLS_PATH)}catch{}t.OS_PROVIDES_FILE_PROTECTION||rGe.warn(t.TAG,"Could not find ICACLS in expected location! This is necessary to use disk retry mode on Windows.")}else t.OS_PROVIDES_FILE_PROTECTION=!0},t.applyACLRules=function(e){return Jze(this,void 0,void 0,function(){var r,n;return Zze(this,function(o){switch(o.label){case 0:if(!t.USE_ICACLS)return[3,7];if(t.ACLED_DIRECTORIES[e]!==void 0)return[3,6];t.ACLED_DIRECTORIES[e]=!1,o.label=1;case 1:return o.trys.push([1,4,,5]),[4,this._getACLIdentity()];case 2:return r=o.sent(),[4,this._runICACLS(this._getACLArguments(e,r))];case 3:return o.sent(),t.ACLED_DIRECTORIES[e]=!0,[3,5];case 4:throw n=o.sent(),t.ACLED_DIRECTORIES[e]=!1,n;case 5:return[3,7];case 6:if(!t.ACLED_DIRECTORIES[e])throw new Error("Setting ACL restrictions did not succeed (cached result)");o.label=7;case 7:return[2]}})})},t.applyACLRulesSync=function(e){if(t.USE_ICACLS){if(t.ACLED_DIRECTORIES[e]===void 0){this._runICACLSSync(this._getACLArguments(e,this._getACLIdentitySync())),t.ACLED_DIRECTORIES[e]=!0;return}else if(!t.ACLED_DIRECTORIES[e])throw new Error("Setting ACL restrictions did not succeed (cached result)")}},t._runICACLS=function(e){return new Promise(function(r,n){var o=S1.spawn(t.ICACLS_PATH,e,{windowsHide:!0});o.on("error",function(s){return n(s)}),o.on("close",function(s,a){s===0?r():n(new Error("Setting ACL restrictions did not succeed (ICACLS returned code "+s+")"))})})},t._runICACLSSync=function(e){if(S1.spawnSync){var r=S1.spawnSync(t.ICACLS_PATH,e,{windowsHide:!0});if(r.error)throw r.error;if(r.status!==0)throw new Error("Setting ACL restrictions did not succeed (ICACLS returned code "+r.status+")")}else throw new Error("Could not synchronously call ICACLS under current version of Node.js")},t._getACLIdentity=function(){return new Promise(function(e,r){t.ACL_IDENTITY&&e(t.ACL_IDENTITY);var n=S1.spawn(t.POWERSHELL_PATH,["-Command","[System.Security.Principal.WindowsIdentity]::GetCurrent().Name"],{windowsHide:!0,stdio:["ignore","pipe","pipe"]}),o="";n.stdout.on("data",function(s){return o+=s}),n.on("error",function(s){return r(s)}),n.on("close",function(s,a){t.ACL_IDENTITY=o&&o.trim(),s===0?e(t.ACL_IDENTITY):r(new Error("Getting ACL identity did not succeed (PS returned code "+s+")"))})})},t._getACLIdentitySync=function(){if(t.ACL_IDENTITY)return t.ACL_IDENTITY;if(S1.spawnSync){var e=S1.spawnSync(t.POWERSHELL_PATH,["-Command","[System.Security.Principal.WindowsIdentity]::GetCurrent().Name"],{windowsHide:!0,stdio:["ignore","pipe","pipe"]});if(e.error)throw e.error;if(e.status!==0)throw new Error("Getting ACL identity did not succeed (PS returned code "+e.status+")");return t.ACL_IDENTITY=e.stdout&&e.stdout.toString().trim(),t.ACL_IDENTITY}else throw new Error("Could not synchronously get ACL identity under current version of Node.js")},t._getACLArguments=function(e,r){return[e,"/grant","*S-1-5-32-544:(OI)(CI)F","/grant",r+":(OI)(CI)F","/inheritance:r"]},t.TAG="FileAccessControl",t.ICACLS_PATH=process.env.systemdrive+"/windows/system32/icacls.exe",t.POWERSHELL_PATH=process.env.systemdrive+"/windows/system32/windowspowershell/v1.0/powershell.exe",t.ACLED_DIRECTORIES={},t.ACL_IDENTITY=null,t.OS_FILE_PROTECTION_CHECKED=!1,t.OS_PROVIDES_FILE_PROTECTION=!1,t.USE_ICACLS=tGe.type()==="Windows_NT",t}();Lh.FileAccessControl=nGe});var zG=L((oR,d0e)=>{"use strict";var M4=oR&&oR.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},F4=oR&&oR.__generator||function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(d){return u([l,d])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=l[0]&2?o.return:l[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,l[1])).done)return s;switch(o=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(d){l=[6,d],o=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},jG=require("fs"),iGe=require("os"),ly=require("path"),oGe=require("zlib"),Oh=ni(),sGe=e1(),uf=nB(),Ba=as(),aGe=require("url"),l0e=Fn(),iR=u0e(),cGe=439,uGe=402,lGe=[200,206,402,408,429,439,500],dGe=function(){function t(e,r,n,o,s,a,c){this._redirectedHost=null,this._config=e,this._onSuccess=n,this._onError=o,this._statsbeat=s,this._enableDiskRetryMode=!1,this._resendInterval=t.WAIT_BETWEEN_RESEND,this._maxBytesOnDisk=t.MAX_BYTES_ON_DISK,this._numConsecutiveFailures=0,this._numConsecutiveRedirects=0,this._resendTimer=null,this._getAuthorizationHandler=r,this._fileCleanupTimer=null,this._tempDir=ly.join(iGe.tmpdir(),t.TEMPDIR_PREFIX+this._config.instrumentationKey),this._isStatsbeatSender=a||!1,this._shutdownStatsbeat=c,this._failedToIngestCounter=0,this._statsbeatHasReachedIngestionAtLeastOnce=!1}return t.prototype.setDiskRetryMode=function(e,r,n){var o=this;e&&iR.FileAccessControl.checkFileProtection(),this._enableDiskRetryMode=iR.FileAccessControl.OS_PROVIDES_FILE_PROTECTION&&e,typeof r=="number"&&r>=0&&(this._resendInterval=Math.floor(r)),typeof n=="number"&&n>=0&&(this._maxBytesOnDisk=Math.floor(n)),e&&!iR.FileAccessControl.OS_PROVIDES_FILE_PROTECTION&&(this._enableDiskRetryMode=!1,this._logWarn("Ignoring request to enable disk retry mode. Sufficient file protection capabilities were not detected.")),this._enableDiskRetryMode?(this._statsbeat&&this._statsbeat.addFeature(Oh.StatsbeatFeature.DISK_RETRY),this._fileCleanupTimer||(this._fileCleanupTimer=setTimeout(function(){o._fileCleanupTask()},t.CLEANUP_TIMEOUT),this._fileCleanupTimer.unref())):(this._statsbeat&&this._statsbeat.removeFeature(Oh.StatsbeatFeature.DISK_RETRY),this._fileCleanupTimer&&clearTimeout(this._fileCleanupTimer))},t.prototype.send=function(e,r){return M4(this,void 0,void 0,function(){var n,o,s,a,c,u,l,d,p=this;return F4(this,function(f){switch(f.label){case 0:if(!e)return[3,5];if(n=this._redirectedHost||this._config.endpointUrl,o=new aGe.URL(n).hostname,s={method:"POST",withCredentials:!1,headers:{"Content-Type":"application/x-json-stream"}},a=this._getAuthorizationHandler?this._getAuthorizationHandler(this._config):null,!a)return[3,4];this._statsbeat&&this._statsbeat.addFeature(Oh.StatsbeatFeature.AAD_HANDLING),f.label=1;case 1:return f.trys.push([1,3,,4]),[4,a.addAuthorizationHeader(s)];case 2:return f.sent(),[3,4];case 3:return c=f.sent(),u="Failed to get AAD bearer token for the Application.",this._enableDiskRetryMode&&(u+="This batch of telemetry items will be retried. ",this._storeToDisk(e)),u+="Error:"+c.toString(),this._logWarn(u),typeof r=="function"&&r(u),[2];case 4:l="",e.forEach(function(m){var h=Ba.stringify(m);typeof h=="string"&&(l+=h+`
`)}),l.length>0&&(l=l.substring(0,l.length-1)),d=Buffer.from?Buffer.from(l):new Buffer(l),oGe.gzip(d,function(m,h){var g=h;m?(p._logWarn(Ba.dumpObj(m)),g=d,s.headers["Content-Length"]=d.length.toString()):(s.headers["Content-Encoding"]="gzip",s.headers["Content-Length"]=h.length.toString()),p._logInfo(Ba.dumpObj(s)),s[sGe.disableCollectionRequestOption]=!0;var v=+new Date,y=function(b){b.setEncoding("utf-8");var S="";b.on("data",function(I){S+=I}),b.on("end",function(){var I=+new Date,w=I-v;if(p._numConsecutiveFailures=0,p._isStatsbeatSender&&!p._statsbeatHasReachedIngestionAtLeastOnce&&(lGe.includes(b.statusCode)?p._statsbeatHasReachedIngestionAtLeastOnce=!0:p._statsbeatFailedToIngest()),p._statsbeat&&(b.statusCode==uGe||b.statusCode==cGe?p._statsbeat.countThrottle(Oh.StatsbeatNetworkCategory.Breeze,o,b.statusCode):p._statsbeat.countRequest(Oh.StatsbeatNetworkCategory.Breeze,o,w,b.statusCode===200,b.statusCode)),p._enableDiskRetryMode){if(b.statusCode===200)p._resendTimer||(p._resendTimer=setTimeout(function(){p._resendTimer=null,p._sendFirstFileOnDisk()},p._resendInterval),p._resendTimer.unref());else if(p._isRetriable(b.statusCode))try{p._statsbeat&&p._statsbeat.countRetry(Oh.StatsbeatNetworkCategory.Breeze,o,b.statusCode);var O=JSON.parse(S),U=[];O.errors&&(O.errors.forEach(function(re){(re.statusCode==429||re.statusCode==500||re.statusCode==503)&&U.push(e[re.index])}),U.length>0&&p._storeToDisk(U))}catch{p._storeToDisk(e)}}if(b.statusCode===307||b.statusCode===308)if(p._numConsecutiveRedirects++,p._numConsecutiveRedirects<10){var z=b.headers.location?b.headers.location.toString():null;z&&(p._redirectedHost=z,p.send(e,r))}else{var M={name:"Circular Redirect",message:"Error sending telemetry because of circular redirects."};p._statsbeat&&p._statsbeat.countException(Oh.StatsbeatNetworkCategory.Breeze,o,M),typeof r=="function"&&r("Error sending telemetry because of circular redirects.")}else p._numConsecutiveRedirects=0,typeof r=="function"&&r(S),p._logInfo(S),typeof p._onSuccess=="function"&&p._onSuccess(S)})},_=Ba.makeRequest(p._config,n,s,y);_.setTimeout(t.HTTP_TIMEOUT,function(){p._requestTimedOut=!0,_.abort()}),_.on("error",function(b){if(p._isStatsbeatSender&&!p._statsbeatHasReachedIngestionAtLeastOnce&&p._statsbeatFailedToIngest(),p._numConsecutiveFailures++,p._statsbeat&&p._statsbeat.countException(Oh.StatsbeatNetworkCategory.Breeze,o,b),!p._enableDiskRetryMode||p._numConsecutiveFailures>0&&p._numConsecutiveFailures%t.MAX_CONNECTION_FAILURES_BEFORE_WARN===0){var S="Ingestion endpoint could not be reached. This batch of telemetry items has been lost. Use Disk Retry Caching to enable resending of failed telemetry. Error:";p._enableDiskRetryMode&&(S="Ingestion endpoint could not be reached "+p._numConsecutiveFailures+" consecutive times. There may be resulting telemetry loss. Most recent error:"),p._logWarn(S,Ba.dumpObj(b))}else{var S="Transient failure to reach ingestion endpoint. This batch of telemetry items will be retried. Error:";p._logInfo(S,Ba.dumpObj(b))}p._onErrorHelper(b),typeof r=="function"&&(b?(p._requestTimedOut&&(b.name="telemetry timeout",b.message="telemetry request timed out"),r(Ba.dumpObj(b))):r("Error sending telemetry")),p._enableDiskRetryMode&&p._storeToDisk(e)}),_.write(g),_.end()}),f.label=5;case 5:return[2]}})})},t.prototype.saveOnCrash=function(e){this._enableDiskRetryMode&&this._storeToDiskSync(Ba.stringify(e))},t.prototype._isRetriable=function(e){return e===206||e===401||e===403||e===408||e===429||e===500||e===502||e===503||e===504},t.prototype._logInfo=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this._isStatsbeatSender||l0e.info(t.TAG,e,r)},t.prototype._logWarn=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this._isStatsbeatSender||l0e.warn(t.TAG,e,r)},t.prototype._statsbeatFailedToIngest=function(){this._shutdownStatsbeat&&(this._failedToIngestCounter++,this._failedToIngestCounter>=3&&this._shutdownStatsbeat())},t.prototype._storeToDisk=function(e){return M4(this,void 0,void 0,function(){var r,n,o,s,a,c,u;return F4(this,function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),this._logInfo("Checking existence of data storage directory: "+this._tempDir),[4,uf.confirmDirExists(this._tempDir)];case 1:return l.sent(),[3,3];case 2:return r=l.sent(),this._logWarn("Failed to create folder to put telemetry: "+Ba.dumpObj(r)),this._onErrorHelper(r),[2];case 3:return l.trys.push([3,5,,6]),[4,iR.FileAccessControl.applyACLRules(this._tempDir)];case 4:return l.sent(),[3,6];case 5:return n=l.sent(),this._logWarn("Failed to apply file access control to folder: "+Ba.dumpObj(n)),this._onErrorHelper(n),[2];case 6:return l.trys.push([6,8,,9]),[4,uf.getShallowDirectorySize(this._tempDir)];case 7:return o=l.sent(),o>this._maxBytesOnDisk?(this._logWarn("Not saving data due to max size limit being met. Directory size in bytes is: "+o),[2]):[3,9];case 8:return s=l.sent(),this._logWarn("Failed to read directory for retriable telemetry: "+Ba.dumpObj(s)),this._onErrorHelper(s),[2];case 9:return l.trys.push([9,11,,12]),a=new Date().getTime()+".ai.json",c=ly.join(this._tempDir,a),this._logInfo("saving data to disk at: "+c),[4,uf.writeFileAsync(c,Ba.stringify(e),{mode:384})];case 10:return l.sent(),[3,12];case 11:return u=l.sent(),this._logWarn("Failed to persist telemetry to disk: "+Ba.dumpObj(u)),this._onErrorHelper(u),[2];case 12:return[2]}})})},t.prototype._storeToDiskSync=function(e){try{this._logInfo("Checking existence of data storage directory: "+this._tempDir),jG.existsSync(this._tempDir)||jG.mkdirSync(this._tempDir),iR.FileAccessControl.applyACLRulesSync(this._tempDir);var r=uf.getShallowDirectorySizeSync(this._tempDir);if(r>this._maxBytesOnDisk){this._logInfo("Not saving data due to max size limit being met. Directory size in bytes is: "+r);return}var n=new Date().getTime()+".ai.json",o=ly.join(this._tempDir,n);this._logInfo("saving data before crash to disk at: "+o),jG.writeFileSync(o,e,{mode:384})}catch(s){this._logWarn("Error while saving data to disk: "+Ba.dumpObj(s)),this._onErrorHelper(s)}},t.prototype._sendFirstFileOnDisk=function(){return M4(this,void 0,void 0,function(){var e,r,n,o,s,a;return F4(this,function(c){switch(c.label){case 0:return c.trys.push([0,6,,7]),[4,uf.readdirAsync(this._tempDir)];case 1:return e=c.sent(),e=e.filter(function(u){return ly.basename(u).indexOf(".ai.json")>-1}),e.length>0?(r=e[0],n=ly.join(this._tempDir,r),[4,uf.readFileAsync(n)]):[3,5];case 2:return o=c.sent(),[4,uf.unlinkAsync(n)];case 3:return c.sent(),s=JSON.parse(o.toString()),[4,this.send(s)];case 4:c.sent(),c.label=5;case 5:return[3,7];case 6:return a=c.sent(),this._onErrorHelper(a),[3,7];case 7:return[2]}})})},t.prototype._onErrorHelper=function(e){typeof this._onError=="function"&&this._onError(e)},t.prototype._fileCleanupTask=function(){return M4(this,void 0,void 0,function(){var e,r,n,o,s,a,c=this;return F4(this,function(u){switch(u.label){case 0:return u.trys.push([0,6,,7]),[4,uf.readdirAsync(this._tempDir)];case 1:if(e=u.sent(),e=e.filter(function(l){return ly.basename(l).indexOf(".ai.json")>-1}),!(e.length>0))return[3,5];r=0,u.label=2;case 2:return r<e.length?(n=new Date(parseInt(e[r].split(".ai.json")[0])),o=new Date(+new Date-t.FILE_RETEMPTION_PERIOD)>n,o?(s=ly.join(this._tempDir,e[r]),[4,uf.unlinkAsync(s).catch(function(l){c._onErrorHelper(l)})]):[3,4]):[3,5];case 3:u.sent(),u.label=4;case 4:return r++,[3,2];case 5:return[3,7];case 6:return a=u.sent(),a.code!="ENOENT"&&this._onErrorHelper(a),[3,7];case 7:return[2]}})})},t.TAG="Sender",t.WAIT_BETWEEN_RESEND=60*1e3,t.MAX_BYTES_ON_DISK=50*1024*1024,t.MAX_CONNECTION_FAILURES_BEFORE_WARN=5,t.CLEANUP_TIMEOUT=60*60*1e3,t.FILE_RETEMPTION_PERIOD=7*24*60*60*1e3,t.TEMPDIR_PREFIX="appInsights-node",t.HTTP_TIMEOUT=2e4,t}();d0e.exports=dGe});var f0e=L(U4=>{"use strict";Object.defineProperty(U4,"__esModule",{value:!0});U4.AzureVirtualMachine=void 0;var p0e=Fn(),pGe=as(),fGe=e1(),mGe="http://169.254.169.254/metadata/instance/compute",hGe="api-version=2017-12-01",gGe="format=json",vGe="UNREACH",yGe=function(){function t(){}return t.getAzureComputeMetadata=function(e,r){var n,o=this,s={},a=mGe+"?"+hGe+"&"+gGe,c=(n={method:"GET"},n[fGe.disableCollectionRequestOption]=!0,n.headers={Metadata:"True"},n),u=pGe.makeRequest(e,a,c,function(l){if(l.statusCode===200){s.isVM=!0;var d="";l.on("data",function(p){d+=p}),l.on("end",function(){try{var p=JSON.parse(d);s.id=p.vmId||"",s.subscriptionId=p.subscriptionId||"",s.osType=p.osType||""}catch(f){p0e.info(t.TAG,f)}r(s)})}else r(s)},!1,!1);u&&(setTimeout(function(){o._requestTimedOut=!0,u.abort()},t.HTTP_TIMEOUT),u.on("error",function(l){o._requestTimedOut&&l&&(l.name="telemetry timeout",l.message="telemetry request timed out"),l&&l.message&&l.message.indexOf(vGe)>-1?s.isVM=!1:p0e.info(t.TAG,l),r(s)}),u.end())},t.HTTP_TIMEOUT=2500,t.TAG="AzureVirtualMachine",t}();U4.AzureVirtualMachine=yGe});var m0e=L(B4=>{"use strict";Object.defineProperty(B4,"__esModule",{value:!0});B4.NetworkStatsbeat=void 0;var bGe=function(){function t(e,r){this.endpoint=e,this.host=r,this.totalRequestCount=0,this.totalSuccesfulRequestCount=0,this.totalFailedRequestCount=[],this.retryCount=[],this.exceptionCount=[],this.throttleCount=[],this.intervalRequestExecutionTime=0,this.lastIntervalRequestExecutionTime=0,this.lastTime=+new Date,this.lastRequestCount=0}return t}();B4.NetworkStatsbeat=bGe});var b0e=L((dy,y0e)=>{"use strict";var yd=dy&&dy.__assign||function(){return yd=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},yd.apply(this,arguments)},GG=dy&&dy.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},VG=dy&&dy.__generator||function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(d){return u([l,d])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=l[0]&2?o.return:l[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,l[1])).done)return s;switch(o=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(d){l=[6,d],o=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},_Ge=require("os"),xGe=HG(),h0e=Fn(),SGe=zG(),qn=ni(),IGe=Os(),CGe=f0e(),TGe=pz(),g0e=Wx(),EGe=m0e(),v0e=as(),wGe="node",RGe=function(){function t(e,r){this._attach=qn.StatsbeatAttach.sdk,this._feature=qn.StatsbeatFeature.NONE,this._instrumentation=qn.StatsbeatInstrumentation.NONE,this._isInitialized=!1,this._statbeatMetrics=[],this._networkStatsbeatCollection=[],this._config=e,this._context=r||new g0e;var n=this._getConnectionString(e);this._statsbeatConfig=new TGe(n),this._statsbeatConfig.samplingPercentage=100,this._sender=new SGe(this._statsbeatConfig,null,null,null,null,!0,this._shutdownStatsbeat.bind(this))}return t.prototype.enable=function(e){var r=this;this._isEnabled=e,this._isEnabled&&!this._isInitialized&&(this._getCustomProperties(),this._isInitialized=!0),e?(this._handle||(this._handle=setInterval(function(){r.trackShortIntervalStatsbeats()},t.STATS_COLLECTION_SHORT_INTERVAL),this._handle.unref()),this._longHandle||(this.trackLongIntervalStatsbeats(),this._longHandle=setInterval(function(){r.trackLongIntervalStatsbeats()},t.STATS_COLLECTION_LONG_INTERVAL),this._longHandle.unref())):(this._handle&&(clearInterval(this._handle),this._handle=null),this._longHandle&&(clearInterval(this._longHandle),this._longHandle=null))},t.prototype.isInitialized=function(){return this._isInitialized},t.prototype.isEnabled=function(){return this._isEnabled},t.prototype.setCodelessAttach=function(){this._attach=qn.StatsbeatAttach.codeless},t.prototype.addFeature=function(e){this._feature|=e},t.prototype.removeFeature=function(e){this._feature&=~e},t.prototype.addInstrumentation=function(e){this._instrumentation|=e},t.prototype.removeInstrumentation=function(e){this._instrumentation&=~e},t.prototype.countRequest=function(e,r,n,o,s){if(this.isEnabled()){var a=this._getNetworkStatsbeatCounter(e,r);if(a.totalRequestCount++,a.intervalRequestExecutionTime+=n,o===!1){if(!s)return;var c=a.totalFailedRequestCount.find(function(u){return s===u.statusCode});c?c.count++:a.totalFailedRequestCount.push({statusCode:s,count:1})}else a.totalSuccesfulRequestCount++}},t.prototype.countException=function(e,r,n){if(this.isEnabled()){var o=this._getNetworkStatsbeatCounter(e,r),s=o.exceptionCount.find(function(a){return n.name===a.exceptionType});s?s.count++:o.exceptionCount.push({exceptionType:n.name,count:1})}},t.prototype.countThrottle=function(e,r,n){if(this.isEnabled()){var o=this._getNetworkStatsbeatCounter(e,r),s=o.throttleCount.find(function(a){return n===a.statusCode});s?s.count++:o.throttleCount.push({statusCode:n,count:1})}},t.prototype.countRetry=function(e,r,n){if(this.isEnabled()){var o=this._getNetworkStatsbeatCounter(e,r),s=o.retryCount.find(function(a){return n===a.statusCode});s?s.count++:o.retryCount.push({statusCode:n,count:1})}},t.prototype.trackShortIntervalStatsbeats=function(){return GG(this,void 0,void 0,function(){var e,r;return VG(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,this._getResourceProvider()];case 1:return n.sent(),e={os:this._os,rp:this._resourceProvider,cikey:this._cikey,runtimeVersion:this._runtimeVersion,language:this._language,version:this._sdkVersion,attach:this._attach},this._trackRequestDuration(e),this._trackRequestsCount(e),[4,this._sendStatsbeats()];case 2:return n.sent(),[3,4];case 3:return r=n.sent(),h0e.info(t.TAG,"Failed to send Statsbeat metrics: "+v0e.dumpObj(r)),[3,4];case 4:return[2]}})})},t.prototype.trackLongIntervalStatsbeats=function(){return GG(this,void 0,void 0,function(){var e,r,n,o,s;return VG(this,function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),[4,this._getResourceProvider()];case 1:return a.sent(),e={os:this._os,rp:this._resourceProvider,cikey:this._cikey,runtimeVersion:this._runtimeVersion,language:this._language,version:this._sdkVersion,attach:this._attach},r=Object.assign({rpId:this._resourceIdentifier},e),this._statbeatMetrics.push({name:qn.StatsbeatCounter.ATTACH,value:1,properties:r}),this._instrumentation!=qn.StatsbeatInstrumentation.NONE&&(n=Object.assign({feature:this._instrumentation,type:qn.StatsbeatFeatureType.Instrumentation},e),this._statbeatMetrics.push({name:qn.StatsbeatCounter.FEATURE,value:1,properties:n})),this._feature!=qn.StatsbeatFeature.NONE&&(o=Object.assign({feature:this._feature,type:qn.StatsbeatFeatureType.Feature},e),this._statbeatMetrics.push({name:qn.StatsbeatCounter.FEATURE,value:1,properties:o})),[4,this._sendStatsbeats()];case 2:return a.sent(),[3,4];case 3:return s=a.sent(),h0e.info(t.TAG,"Failed to send Statsbeat metrics: "+v0e.dumpObj(s)),[3,4];case 4:return[2]}})})},t.prototype._getNetworkStatsbeatCounter=function(e,r){for(var n=this._getShortHost(r),o=0;o<this._networkStatsbeatCollection.length;o++)if(e===this._networkStatsbeatCollection[o].endpoint&&n===this._networkStatsbeatCollection[o].host)return this._networkStatsbeatCollection[o];var s=new EGe.NetworkStatsbeat(e,n);return this._networkStatsbeatCollection.push(s),s},t.prototype._trackRequestDuration=function(e){for(var r=0;r<this._networkStatsbeatCollection.length;r++){var n=this._networkStatsbeatCollection[r];n.time=+new Date;var o=n.totalRequestCount-n.lastRequestCount||0,s=n.intervalRequestExecutionTime-n.lastIntervalRequestExecutionTime,a=s>0&&s/o||0;if(n.lastIntervalRequestExecutionTime=n.intervalRequestExecutionTime,o>0){var c=Object.assign({endpoint:this._networkStatsbeatCollection[r].endpoint,host:this._networkStatsbeatCollection[r].host},e);this._statbeatMetrics.push({name:qn.StatsbeatCounter.REQUEST_DURATION,value:a,properties:c})}n.lastRequestCount=n.totalRequestCount,n.lastTime=n.time}},t.prototype._getShortHost=function(e){var r=e;try{var n=new RegExp(/^https?:\/\/(?:www\.)?([^\/.-]+)/),o=n.exec(e);o!=null&&o.length>1&&(r=o[1]),r=r.replace(".in.applicationinsights.azure.com","")}catch{}return r},t.prototype._trackRequestsCount=function(e){for(var r=this,n=function(c){s=o._networkStatsbeatCollection[c];var u=Object.assign({endpoint:s.endpoint,host:s.host},e);s.totalSuccesfulRequestCount>0&&(o._statbeatMetrics.push({name:qn.StatsbeatCounter.REQUEST_SUCCESS,value:s.totalSuccesfulRequestCount,properties:u}),s.totalSuccesfulRequestCount=0),s.totalFailedRequestCount.length>0&&(s.totalFailedRequestCount.forEach(function(l){u=Object.assign(yd(yd({},u),{statusCode:l.statusCode})),r._statbeatMetrics.push({name:qn.StatsbeatCounter.REQUEST_FAILURE,value:l.count,properties:u})}),s.totalFailedRequestCount=[]),s.retryCount.length>0&&(s.retryCount.forEach(function(l){u=Object.assign(yd(yd({},u),{statusCode:l.statusCode})),r._statbeatMetrics.push({name:qn.StatsbeatCounter.RETRY_COUNT,value:l.count,properties:u})}),s.retryCount=[]),s.throttleCount.length>0&&(s.throttleCount.forEach(function(l){u=Object.assign(yd(yd({},u),{statusCode:l.statusCode})),r._statbeatMetrics.push({name:qn.StatsbeatCounter.THROTTLE_COUNT,value:l.count,properties:u})}),s.throttleCount=[]),s.exceptionCount.length>0&&(s.exceptionCount.forEach(function(l){u=Object.assign(yd(yd({},u),{exceptionType:l.exceptionType})),r._statbeatMetrics.push({name:qn.StatsbeatCounter.EXCEPTION_COUNT,value:l.count,properties:u})}),s.exceptionCount=[])},o=this,s,a=0;a<this._networkStatsbeatCollection.length;a++)n(a)},t.prototype._sendStatsbeats=function(){return GG(this,void 0,void 0,function(){var e,r,n,o;return VG(this,function(s){switch(s.label){case 0:for(e=[],r=0;r<this._statbeatMetrics.length;r++)n={name:this._statbeatMetrics[r].name,value:this._statbeatMetrics[r].value,properties:this._statbeatMetrics[r].properties},o=xGe.createEnvelope(n,IGe.TelemetryType.Metric,null,this._context,this._statsbeatConfig),o.name=qn.StatsbeatTelemetryName,e.push(o);return this._statbeatMetrics=[],[4,this._sender.send(e)];case 1:return s.sent(),[2]}})})},t.prototype._getCustomProperties=function(){this._language=wGe,this._cikey=this._config.instrumentationKey,this._sdkVersion=g0e.sdkVersion,this._os=_Ge.type(),this._runtimeVersion=process.version},t.prototype._getResourceProvider=function(){var e=this;return new Promise(function(r,n){var o=!1;e._resourceProvider=qn.StatsbeatResourceProvider.unknown,e._resourceIdentifier=qn.StatsbeatResourceProvider.unknown,process.env.AKS_ARM_NAMESPACE_ID?(e._resourceProvider=qn.StatsbeatResourceProvider.aks,e._resourceIdentifier=process.env.AKS_ARM_NAMESPACE_ID):process.env.WEBSITE_SITE_NAME?(e._resourceProvider=qn.StatsbeatResourceProvider.appsvc,e._resourceIdentifier=process.env.WEBSITE_SITE_NAME,process.env.WEBSITE_HOME_STAMPNAME&&(e._resourceIdentifier+="/"+process.env.WEBSITE_HOME_STAMPNAME)):process.env.FUNCTIONS_WORKER_RUNTIME?(e._resourceProvider=qn.StatsbeatResourceProvider.functions,process.env.WEBSITE_HOSTNAME&&(e._resourceIdentifier=process.env.WEBSITE_HOSTNAME)):e._config&&(e._isVM===void 0||e._isVM==!0?(o=!0,CGe.AzureVirtualMachine.getAzureComputeMetadata(e._config,function(s){e._isVM=s.isVM,e._isVM&&(e._resourceProvider=qn.StatsbeatResourceProvider.vm,e._resourceIdentifier=s.id+"/"+s.subscriptionId,s.osType&&(e._os=s.osType)),r()})):e._resourceProvider=qn.StatsbeatResourceProvider.unknown),o||r()})},t.prototype._shutdownStatsbeat=function(){this.enable(!1)},t.prototype._getConnectionString=function(e){for(var r=e.endpointUrl,n=["westeurope","northeurope","francecentral","francesouth","germanywestcentral","norwayeast","norwaywest","swedencentral","switzerlandnorth","switzerlandwest","uksouth","ukwest"],o=0;o<n.length;o++)if(r.indexOf(n[o])>-1)return t.EU_CONNECTION_STRING;return t.NON_EU_CONNECTION_STRING},t.NON_EU_CONNECTION_STRING="InstrumentationKey=c4a29126-a7cb-47e5-b348-11414998b11e;IngestionEndpoint=https://westus-0.in.applicationinsights.azure.com",t.EU_CONNECTION_STRING="InstrumentationKey=7dc56bab-3c0c-4e9f-9ebb-d1acadee8d0f;IngestionEndpoint=https://westeurope-5.in.applicationinsights.azure.com",t.STATS_COLLECTION_SHORT_INTERVAL=9e5,t.STATS_COLLECTION_LONG_INTERVAL=864e5,t.TAG="Statsbeat",t}();y0e.exports=RGe});var S0e=L((lAt,x0e)=>{"use strict";var kGe=require("url"),AGe=pz(),PGe=Qve(),DGe=Wx(),lf=Os(),NGe=Jve(),$G=o0e(),_0e=bh(),LGe=b0e(),OGe=zG(),WG=as(),q4=Fn(),MGe=HG(),FGe=function(){function t(e){this._telemetryProcessors=[];var r=new AGe(e);if(this.config=r,!this.config.instrumentationKey||this.config.instrumentationKey=="")throw new Error("Instrumentation key not found, please provide a connection string before starting Application Insights SDK.");this.context=new DGe,this.commonProperties={},this.authorizationHandler=null,this.config.disableStatsbeat||(this._statsbeat=new LGe(this.config,this.context),this._statsbeat.enable(!0));var n=new OGe(this.config,this.getAuthorizationHandler,null,null,this._statsbeat);this.channel=new NGe(function(){return r.disableAppInsights},function(){return r.maxBatchSize},function(){return r.maxBatchIntervalMs},n)}return t.prototype.trackAvailability=function(e){this.track(e,lf.TelemetryType.Availability)},t.prototype.trackPageView=function(e){this.track(e,lf.TelemetryType.PageView)},t.prototype.trackTrace=function(e){this.track(e,lf.TelemetryType.Trace)},t.prototype.trackMetric=function(e){this.track(e,lf.TelemetryType.Metric)},t.prototype.trackException=function(e){e&&e.exception&&!WG.isError(e.exception)&&(e.exception=new Error(e.exception.toString())),this.track(e,lf.TelemetryType.Exception)},t.prototype.trackEvent=function(e){this.track(e,lf.TelemetryType.Event)},t.prototype.trackRequest=function(e){this.track(e,lf.TelemetryType.Request)},t.prototype.trackDependency=function(e){if(e&&!e.target&&e.data)try{e.target=new kGe.URL(e.data).host}catch(r){e.target=null,q4.warn(t.TAG,"The URL object is failed to create.",r)}this.track(e,lf.TelemetryType.Dependency)},t.prototype.flush=function(e){this.channel.triggerSend(e?!!e.isAppCrashing:!1,e?e.callback:void 0)},t.prototype.track=function(e,r){if(e&&lf.telemetryTypeToBaseType(r)){var n=MGe.createEnvelope(e,r,this.commonProperties,this.context,this.config);e.time&&(n.time=e.time.toISOString());var o=this.runTelemetryProcessors(n,e.contextObjects);o=o&&$G.samplingTelemetryProcessor(n,{correlationContext:_0e.CorrelationContextManager.getCurrentContext()}),$G.preAggregatedMetricsTelemetryProcessor(n,this.context),o&&($G.performanceMetricsTelemetryProcessor(n,this.quickPulseClient),this.channel.send(n))}else q4.warn(t.TAG,"track() requires telemetry object and telemetryType to be specified.")},t.prototype.setAutoPopulateAzureProperties=function(e){},t.prototype.getAuthorizationHandler=function(e){return e&&e.aadTokenCredential?(this.authorizationHandler||(q4.info(t.TAG,"Adding authorization handler"),this.authorizationHandler=new PGe(e.aadTokenCredential,e.aadAudience)),this.authorizationHandler):null},t.prototype.addTelemetryProcessor=function(e){this._telemetryProcessors.push(e)},t.prototype.clearTelemetryProcessors=function(){this._telemetryProcessors=[]},t.prototype.runTelemetryProcessors=function(e,r){var n=!0,o=this._telemetryProcessors.length;if(o===0)return n;r=r||{},r.correlationContext=_0e.CorrelationContextManager.getCurrentContext();for(var s=0;s<o;++s)try{var a=this._telemetryProcessors[s];if(a&&a.apply(null,[e,r])===!1){n=!1;break}}catch(c){n=!0,q4.warn(t.TAG,"One of telemetry processors failed, telemetry item will be sent.",c,e)}return n&&(e&&e.tags&&(e.tags=WG.validateStringMap(e.tags)),e&&e.data&&e.data.baseData&&e.data.baseData.properties&&(e.data.baseData.properties=WG.validateStringMap(e.data.baseData.properties))),n},t.prototype.getStatsbeat=function(){return this._statsbeat},t.TAG="TelemetryClient",t}();x0e.exports=FGe});var T0e=L((KG,C0e)=>{"use strict";var UGe=KG&&KG.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),BGe=S0e(),I0e=oz(),qGe=e1(),H4=Fn(),HGe=function(t){UGe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.trackNodeHttpRequestSync=function(r){r&&r.request&&r.response&&r.duration?I0e.trackRequestSync(this,r):H4.warn("trackNodeHttpRequestSync requires NodeHttpRequestTelemetry object with request, response and duration specified.")},e.prototype.trackNodeHttpRequest=function(r){(r.duration||r.error)&&H4.warn("trackNodeHttpRequest will ignore supplied duration and error parameters. These values are collected from the request and response objects."),r&&r.request&&r.response?I0e.trackRequest(this,r):H4.warn("trackNodeHttpRequest requires NodeHttpRequestTelemetry object with request and response specified.")},e.prototype.trackNodeHttpDependency=function(r){r&&r.request?qGe.trackRequest(this,r):H4.warn("trackNodeHttpDependency requires NodeHttpDependencyTelemetry object with request specified.")},e}(BGe);C0e.exports=HGe});var w0e=L(E0e=>{"use strict";Object.defineProperty(E0e,"__esModule",{value:!0})});var D0e=L(oe=>{"use strict";Object.defineProperty(oe,"__esModule",{value:!0});oe.dispose=oe.Configuration=oe.wrapWithCorrelationContext=oe.startOperation=oe.getCorrelationContext=oe.start=oe.setup=oe.liveMetricsClient=oe.defaultClient=oe.DistributedTracingModes=void 0;var YG=bh(),jGe=sme(),zGe=cme(),QG=PL(),GGe=Vj(),VGe=gme(),$Ge=Rme(),WGe=e1(),KGe=oz(),R0e=G0(),sR=Fn(),k0e=ahe(),XG=che(),YGe=dhe();oe.TelemetryClient=T0e();oe.Contracts=Os();oe.azureFunctionsTypes=w0e();var A0e;(function(t){t[t.AI=0]="AI",t[t.AI_AND_W3C=1]="AI_AND_W3C"})(A0e=oe.DistributedTracingModes||(oe.DistributedTracingModes={}));var aR,cR,uR,lR,dR,I1,C1,py,pR,fR,bc=!1,j4;function QGe(t){return oe.defaultClient?sR.info("The default client is already setup"):(oe.defaultClient=new oe.TelemetryClient(t),aR=new jGe(oe.defaultClient),cR=new zGe(oe.defaultClient),uR=new QG(oe.defaultClient),lR=new GGe(oe.defaultClient),dR=new VGe(oe.defaultClient),I1=new $Ge(oe.defaultClient),py=new KGe(oe.defaultClient),pR=new WGe(oe.defaultClient),C1||(C1=new XG.AutoCollectNativePerformance(oe.defaultClient)),fR=new YGe.AzureFunctionsHook(oe.defaultClient)),JG}oe.setup=QGe;function XGe(){oe.defaultClient&&(oe.defaultClient.config.enableAutoCollectExternalLoggers==null&&(oe.defaultClient.config.enableAutoCollectExternalLoggers=!0),oe.defaultClient.config.enableAutoCollectConsole==null&&(oe.defaultClient.config.enableAutoCollectConsole=!1),oe.defaultClient.config.enableAutoCollectExceptions==null&&(oe.defaultClient.config.enableAutoCollectExceptions=!0),oe.defaultClient.config.enableAutoCollectPerformance==null&&(oe.defaultClient.config.enableAutoCollectPerformance=!0),oe.defaultClient.config.enableAutoCollectPreAggregatedMetrics==null&&(oe.defaultClient.config.enableAutoCollectPreAggregatedMetrics=!0),oe.defaultClient.config.enableAutoCollectHeartbeat==null&&(oe.defaultClient.config.enableAutoCollectHeartbeat=!0),oe.defaultClient.config.enableAutoCollectRequests==null&&(oe.defaultClient.config.enableAutoCollectRequests=!0),oe.defaultClient.config.enableAutoCollectDependencies==null&&(oe.defaultClient.config.enableAutoCollectDependencies=!0),oe.defaultClient.config.enableUseDiskRetryCaching==null&&(oe.defaultClient.config.enableUseDiskRetryCaching=!0),oe.defaultClient.config.enableAutoDependencyCorrelation==null&&(oe.defaultClient.config.enableAutoDependencyCorrelation=!0),oe.defaultClient.config.enableSendLiveMetrics==null&&(oe.defaultClient.config.enableSendLiveMetrics=!1),oe.defaultClient.config.enableAutoCollectExtendedMetrics==null&&(oe.defaultClient.config.enableAutoCollectExtendedMetrics=!0),oe.defaultClient.config.enableWebInstrumentation==null&&(oe.defaultClient.config.enableWebInstrumentation=!1),oe.defaultClient.config.enableAutoCollectIncomingRequestAzureFunctions==null&&(oe.defaultClient.config.enableAutoCollectIncomingRequestAzureFunctions=!1))}function P0e(){if(oe.defaultClient){bc=!0,XGe(),aR.enable(oe.defaultClient.config.enableAutoCollectExternalLoggers,oe.defaultClient.config.enableAutoCollectConsole),cR.enable(oe.defaultClient.config.enableAutoCollectExceptions),uR.enable(oe.defaultClient.config.enableAutoCollectPerformance),lR.enable(oe.defaultClient.config.enableAutoCollectPreAggregatedMetrics),dR.enable(oe.defaultClient.config.enableAutoCollectHeartbeat),py.useAutoCorrelation(oe.defaultClient.config.enableAutoDependencyCorrelation,oe.defaultClient.config.enableUseAsyncHooks),py.enable(oe.defaultClient.config.enableAutoCollectRequests),pR.enable(oe.defaultClient.config.enableAutoCollectDependencies),I1.enable(oe.defaultClient.config.enableWebInstrumentation,oe.defaultClient.config.webInstrumentationConnectionString),oe.defaultClient.config.enableSendLiveMetrics&&(oe.liveMetricsClient||(oe.liveMetricsClient=new k0e(oe.defaultClient.config,oe.defaultClient.context,oe.defaultClient.getAuthorizationHandler),j4=new QG(oe.liveMetricsClient,1e3,!0),oe.liveMetricsClient.addCollector(j4),oe.defaultClient.quickPulseClient=oe.liveMetricsClient),oe.liveMetricsClient.enable(oe.defaultClient.config.enableSendLiveMetrics)),fR.enable(oe.defaultClient.config.enableAutoCollectIncomingRequestAzureFunctions);var t=XG.AutoCollectNativePerformance.parseEnabled(oe.defaultClient.config.enableAutoCollectExtendedMetrics,oe.defaultClient.config);C1.enable(oe.defaultClient.config.enableAutoCollectExtendedMetrics,t.disabledMetrics),oe.defaultClient&&oe.defaultClient.channel&&oe.defaultClient.channel.setUseDiskRetryCaching(oe.defaultClient.config.enableUseDiskRetryCaching,oe.defaultClient.config.enableResendInterval,oe.defaultClient.config.enableMaxBytesOnDisk)}else sR.warn("Start cannot be called before setup");return JG}oe.start=P0e;function JGe(){return YG.CorrelationContextManager.getCurrentContext()}oe.getCorrelationContext=JGe;function ZGe(t,e){return YG.CorrelationContextManager.startOperation(t,e)}oe.startOperation=ZGe;function eVe(t,e){return YG.CorrelationContextManager.wrapCallback(t,e)}oe.wrapWithCorrelationContext=eVe;var JG=function(){function t(){}return t.setDistributedTracingMode=function(e){return R0e.w3cEnabled=e===A0e.AI_AND_W3C,t},t.setAutoCollectConsole=function(e,r){return r===void 0&&(r=!1),oe.defaultClient&&(oe.defaultClient.config.enableAutoCollectExternalLoggers=e,oe.defaultClient.config.enableAutoCollectConsole=r,bc&&aR.enable(e,r)),t},t.setAutoCollectExceptions=function(e){return oe.defaultClient&&(oe.defaultClient.config.enableAutoCollectExceptions=e,bc&&cR.enable(e)),t},t.setAutoCollectPerformance=function(e,r){if(r===void 0&&(r=!0),oe.defaultClient){oe.defaultClient.config.enableAutoCollectPerformance=e;var n=XG.AutoCollectNativePerformance.parseEnabled(r,oe.defaultClient.config);oe.defaultClient.config.enableAutoCollectExtendedMetrics=n.isEnabled,bc&&(uR.enable(e),C1.enable(oe.defaultClient.config.enableAutoCollectExtendedMetrics,n.disabledMetrics))}return t},t.setAutoCollectPreAggregatedMetrics=function(e){return oe.defaultClient&&(oe.defaultClient.config.enableAutoCollectPreAggregatedMetrics=e,bc&&lR.enable(e)),t},t.setAutoCollectHeartbeat=function(e){return oe.defaultClient&&(oe.defaultClient.config.enableAutoCollectHeartbeat=e,bc&&dR.enable(e)),t},t.enableAutoWebSnippetInjection=function(e,r){return oe.defaultClient&&(oe.defaultClient.config.enableWebInstrumentation=e,oe.defaultClient.config.webInstrumentationConnectionString=r,bc&&I1.enable(oe.defaultClient.config.enableAutoWebSnippetInjection,oe.defaultClient.config.webSnippetConnectionString)),t},t.enableWebInstrumentation=function(e,r){return oe.defaultClient&&(oe.defaultClient.config.enableWebInstrumentation=e,oe.defaultClient.config.webInstrumentationConnectionString=r,bc&&I1.enable(oe.defaultClient.config.enableWebInstrumentation,oe.defaultClient.config.webInstrumentationConnectionString)),t},t.setAutoCollectRequests=function(e){return oe.defaultClient&&(oe.defaultClient.config.enableAutoCollectRequests=e,bc&&py.enable(e)),t},t.setAutoCollectDependencies=function(e){return oe.defaultClient&&(oe.defaultClient.config.enableAutoCollectDependencies=e,bc&&pR.enable(e)),t},t.setAutoDependencyCorrelation=function(e,r){return oe.defaultClient&&(oe.defaultClient.config.enableAutoDependencyCorrelation=e,oe.defaultClient.config.enableUseAsyncHooks=r,bc&&py.useAutoCorrelation(e,r)),t},t.setUseDiskRetryCaching=function(e,r,n){return oe.defaultClient&&(oe.defaultClient.config.enableUseDiskRetryCaching=e,oe.defaultClient.config.enableResendInterval=r,oe.defaultClient.config.enableMaxBytesOnDisk=n,oe.defaultClient.channel&&oe.defaultClient.channel.setUseDiskRetryCaching(oe.defaultClient.config.enableUseDiskRetryCaching,oe.defaultClient.config.enableResendInterval,oe.defaultClient.config.enableMaxBytesOnDisk)),t},t.setInternalLogging=function(e,r){return e===void 0&&(e=!1),r===void 0&&(r=!0),sR.enableDebug=e,sR.disableWarnings=!r,t},t.setAutoCollectIncomingRequestAzureFunctions=function(e){return oe.defaultClient&&(oe.defaultClient.config.enableAutoCollectIncomingRequestAzureFunctions=e,bc&&fR.enable(e)),t},t.setSendLiveMetrics=function(e){return e===void 0&&(e=!1),oe.defaultClient?(!oe.liveMetricsClient&&e?(oe.liveMetricsClient=new k0e(oe.defaultClient.config,oe.defaultClient.context,oe.defaultClient.getAuthorizationHandler),j4=new QG(oe.liveMetricsClient,1e3,!0),oe.liveMetricsClient.addCollector(j4),oe.defaultClient.quickPulseClient=oe.liveMetricsClient):oe.liveMetricsClient&&oe.liveMetricsClient.enable(e),oe.defaultClient.config.enableSendLiveMetrics=e,t):(sR.warn("Live metrics client cannot be setup without the default client"),t)},t.start=P0e,t}();oe.Configuration=JG;function tVe(){R0e.w3cEnabled=!0,oe.defaultClient=null,bc=!1,aR&&aR.dispose(),cR&&cR.dispose(),uR&&uR.dispose(),lR&&lR.dispose(),dR&&dR.dispose(),I1&&I1.dispose(),C1&&C1.dispose(),py&&py.dispose(),pR&&pR.dispose(),oe.liveMetricsClient&&(oe.liveMetricsClient.enable(!1),oe.liveMetricsClient=void 0),fR&&fR.dispose()}oe.dispose=tVe});var eV=L(Fh=>{"use strict";Object.defineProperty(Fh,"__esModule",{value:!0});Fh.TargetPopulation=Fh.Filters=Fh.VSCodeFilterProvider=void 0;var G4=require("vscode"),ZG=class t{constructor(e,r,n){this.extensionName=e,this.extensionVersion=r,this.targetPopulation=n}static trimVersionSuffix(e){let r=/\-[a-zA-Z0-9]+$/;return e.split(r)[0]}getFilterValue(e){switch(e){case bd.ApplicationVersion:return t.trimVersionSuffix(G4.version);case bd.Build:return G4.env.appName;case bd.ClientId:return G4.env.machineId;case bd.ExtensionName:return this.extensionName;case bd.ExtensionVersion:return t.trimVersionSuffix(this.extensionVersion);case bd.Language:return G4.env.language;case bd.TargetPopulation:return this.targetPopulation;default:return""}}getFilters(){let e=new Map,r=Object.values(bd);for(let n of r)e.set(n,this.getFilterValue(n));return e}};Fh.VSCodeFilterProvider=ZG;var bd;(function(t){t.Market="X-MSEdge-Market",t.CorpNet="X-FD-Corpnet",t.ApplicationVersion="X-VSCode-AppVersion",t.Build="X-VSCode-Build",t.ClientId="X-MSEdge-ClientId",t.ExtensionName="X-VSCode-ExtensionName",t.ExtensionVersion="X-VSCode-ExtensionVersion",t.Language="X-VSCode-Language",t.TargetPopulation="X-VSCode-TargetPopulation"})(bd||(Fh.Filters=bd={}));var F0e;(function(t){t.Team="team",t.Internal="internal",t.Insiders="insider",t.Public="public"})(F0e||(Fh.TargetPopulation=F0e={}))});var U0e=L(V4=>{"use strict";Object.defineProperty(V4,"__esModule",{value:!0});V4.BaseFeatureProvider=void 0;var tV=class{constructor(e){this.telemetry=e,this.isFetching=!1}async getFeatures(){if(this.isFetching&&this.fetchPromise)return this.fetchPromise;this.fetchPromise=this.fetch();let e=await this.fetchPromise;return this.isFetching=!1,this.fetchPromise=void 0,e}};V4.BaseFeatureProvider=tV});var B0e=L($4=>{"use strict";Object.defineProperty($4,"__esModule",{value:!0});$4.FilteredFeatureProvider=void 0;var iVe=U0e(),rV=class extends iVe.BaseFeatureProvider{constructor(e,r){super(e),this.telemetry=e,this.filterProviders=r,this.cachedTelemetryEvents=[]}getFilters(){let e=new Map;for(let r of this.filterProviders){let n=r.getFilters();for(let o of n.keys()){let s=n.get(o);e.set(o,s)}}return e}PostEventToTelemetry(e){if(this.cachedTelemetryEvents.includes(e))return;let r=JSON.stringify(e);this.telemetry.postEvent("report-headers",new Map([["ABExp.headers",r]])),this.cachedTelemetryEvents.push(e)}};$4.FilteredFeatureProvider=rV});var q0e=L(Uh=>{"use strict";Object.defineProperty(Uh,"__esModule",{value:!0});Uh.TasApiFeatureProvider=Uh.TASAPI_FETCHERROR_EVENTNAME=void 0;var oVe=B0e();Uh.TASAPI_FETCHERROR_EVENTNAME="call-tas-error";var nV="ErrorType",iV=class extends oVe.FilteredFeatureProvider{constructor(e,r,n){super(r,n),this.httpClient=e,this.telemetry=r,this.filterProviders=n}async fetch(){let e=this.getFilters(),r={};for(let c of e.keys()){let u=e.get(c);r[c]=u}let n;try{n=await this.httpClient.get({headers:r})}catch(c){let u=c,l=new Map;u.responseReceived&&!u.responseOk?l.set(nV,"ServerError"):u.responseReceived===!1?l.set(nV,"NoResponse"):l.set(nV,"GenericError"),this.telemetry.postEvent(Uh.TASAPI_FETCHERROR_EVENTNAME,l)}if(!n)throw Error(Uh.TASAPI_FETCHERROR_EVENTNAME);e.keys.length>0&&this.PostEventToTelemetry(r);let o=n.data,s=o.Configs,a=[];for(let c of s)if(c.Parameters)for(let u of Object.keys(c.Parameters)){let l=u+(c.Parameters[u]?"":"cf");a.includes(l)||a.push(l)}return{features:a,assignmentContext:o.AssignmentContext,configs:s}}};Uh.TasApiFeatureProvider=iV});var H0e=L(E1=>{"use strict";Object.defineProperty(E1,"__esModule",{value:!0});E1.HttpClient=E1.FetchError=void 0;var T1=class extends Error{constructor(e,r,n){super(e),this.responseReceived=r,this.responseOk=n}};E1.FetchError=T1;var oV=class{constructor(e){this.endpoint=e}async get(e){let r=await fetch(this.endpoint,{method:"GET",headers:e?.headers});if(!r)throw new T1("No response received",!1);if(!r.ok)throw new T1("Response not ok",!0,!1);let n=await r.json();if(!n)throw new T1("No data received",!1);return{data:n}}};E1.HttpClient=oV});var j0e=L(W4=>{"use strict";Object.defineProperty(W4,"__esModule",{value:!0});W4.MemoryKeyValueStorage=void 0;var sV=class{constructor(){this.storage=new Map}async getValue(e,r){return this.storage.has(e)?await Promise.resolve(this.storage.get(e)):await Promise.resolve(r||void 0)}setValue(e,r){this.storage.set(e,r)}};W4.MemoryKeyValueStorage=sV});var z0e=L(K4=>{"use strict";Object.defineProperty(K4,"__esModule",{value:!0});K4.ExperimentationServiceBase=void 0;var sVe=j0e(),aV=class{get features(){return this._features}set features(e){this._features=e,this.telemetry&&this.telemetry.setSharedProperty(this.assignmentContextTelemetryPropertyName,this.features.assignmentContext)}constructor(e,r,n,o,s){this.telemetry=e,this.assignmentContextTelemetryPropertyName=r,this.telemetryEventName=n,this.storageKey=o,this.storage=s,this.featuresConsumed=!1,this.cachedTelemetryEvents=[],this._features={features:[],assignmentContext:"",configs:[]},this.storageKey||(this.storageKey="ABExp.Features"),this.storage||(s=new sVe.MemoryKeyValueStorage),this.loadCachePromise=this.loadCachedFeatureData(),this.initializePromise=this.loadCachePromise,this.initialFetch=new Promise((a,c)=>{this.resolveInitialFetchPromise=a})}async getFeaturesAsync(e=!1){if(this.fetchPromise!=null){try{await this.fetchPromise}catch{}return this.features}if(!this.featureProviders||this.featureProviders.length===0)return Promise.resolve({features:[],assignmentContext:"",configs:[]});try{this.fetchPromise=Promise.all(this.featureProviders.map(async n=>await n.getFeatures()));let r=await this.fetchPromise;this.updateFeatures(r,e)}catch{}return this.fetchPromise=void 0,this.resolveInitialFetchPromise&&(this.resolveInitialFetchPromise(),this.resolveInitialFetchPromise=void 0),this.features}updateFeatures(e,r=!1){let n={features:[],assignmentContext:"",configs:[]};for(let o of e){for(let s of o.features)n.features.includes(s)||n.features.push(s);for(let s of o.configs){let a=n.configs.find(c=>c.Id===s.Id);a?a.Parameters=Object.assign(Object.assign({},a.Parameters),s.Parameters):n.configs.push(s)}n.assignmentContext+=o.assignmentContext}(r||!this.featuresConsumed)&&(this.features=n),this.storage&&this.storage.setValue(this.storageKey,n)}async loadCachedFeatureData(){let e;this.storage&&(e=await this.storage.getValue(this.storageKey),e!==void 0&&e.configs===void 0&&(e.configs=[])),this.features.features.length===0&&(this.features=e||{features:[],assignmentContext:"",configs:[]})}isFlightEnabled(e){return this.featuresConsumed=!0,this.PostEventToTelemetry(e),this.features.features.includes(e)}async isCachedFlightEnabled(e){return await this.loadCachePromise,this.featuresConsumed=!0,this.PostEventToTelemetry(e),this.features.features.includes(e)}async isFlightEnabledAsync(e){let r=await this.getFeaturesAsync(!0);return this.featuresConsumed=!0,this.PostEventToTelemetry(e),r.features.includes(e)}getTreatmentVariable(e,r){this.featuresConsumed=!0,this.PostEventToTelemetry(`${e}.${r}`);let n=this.features.configs.find(o=>o.Id===e);return n?.Parameters[r]}async getTreatmentVariableAsync(e,r,n){if(n){let o=this.featuresConsumed,s=this.getTreatmentVariable(e,r);if(s===void 0)this.featuresConsumed=o;else return s}return await this.getFeaturesAsync(!0),this.getTreatmentVariable(e,r)}PostEventToTelemetry(e){this.cachedTelemetryEvents.includes(e)||(this.telemetry.postEvent(this.telemetryEventName,new Map([["ABExp.queriedFeature",e]])),this.cachedTelemetryEvents.push(e))}invokeInit(){this.init()}addFeatureProvider(...e){if(!(e==null||this.featureProviders==null))for(let r of e)this.featureProviders.push(r)}};K4.ExperimentationServiceBase=aV});var G0e=L(Y4=>{"use strict";Object.defineProperty(Y4,"__esModule",{value:!0});Y4.PollingService=void 0;var cV=class{constructor(e){this.fetchInterval=e}StopPolling(){clearInterval(this.intervalHandle),this.intervalHandle=void 0}OnPollTick(e){this.onTick=e}StartPolling(e=!1){this.intervalHandle&&this.StopPolling(),this.onTick!=null&&(e&&this.onTick().then(()=>{}).catch(()=>{}),this.intervalHandle=setInterval(async()=>{await this.onTick()},this.fetchInterval),this.intervalHandle.unref&&this.intervalHandle.unref())}};Y4.PollingService=cV});var V0e=L(Q4=>{"use strict";Object.defineProperty(Q4,"__esModule",{value:!0});Q4.ExperimentationServiceAutoPolling=void 0;var aVe=z0e(),cVe=G0e(),uV=class extends aVe.ExperimentationServiceBase{constructor(e,r,n,o,s,a,c){if(super(e,o,s,a,c),this.telemetry=e,this.filterProviders=r,this.refreshRateMs=n,this.assignmentContextTelemetryPropertyName=o,this.telemetryEventName=s,this.storageKey=a,this.storage=c,n<1e3&&n!==0)throw new Error("The minimum refresh rate for polling is 1000 ms (1 second). If you wish to deactivate this auto-polling use value of 0.");n>0&&(this.pollingService=new cVe.PollingService(n),this.pollingService.OnPollTick(async()=>{await super.getFeaturesAsync()}))}init(){this.pollingService?this.pollingService.StartPolling(!0):super.getFeaturesAsync()}async getFeaturesAsync(e=!1){if(this.pollingService){this.pollingService.StopPolling();let r=await super.getFeaturesAsync(e);return this.pollingService.StartPolling(),r}else return await super.getFeaturesAsync(e)}};Q4.ExperimentationServiceAutoPolling=uV});var $0e=L(J4=>{"use strict";Object.defineProperty(J4,"__esModule",{value:!0});J4.ExperimentationService=void 0;var uVe=q0e(),lVe=H0e(),dVe=V0e(),X4=class extends dVe.ExperimentationServiceAutoPolling{constructor(e){super(e.telemetry,e.filterProviders||[],e.refetchInterval!=null?e.refetchInterval:0,e.assignmentContextTelemetryPropertyName,e.telemetryEventName,e.storageKey,e.keyValueStorage),this.options=e,this.invokeInit()}init(){this.featureProviders=[],this.addFeatureProvider(new uVe.TasApiFeatureProvider(new lVe.HttpClient(this.options.endpoint),this.telemetry,this.filterProviders)),super.init()}};J4.ExperimentationService=X4;X4.REFRESH_RATE_IN_MINUTES=30});var W0e=L(Z4=>{"use strict";Object.defineProperty(Z4,"__esModule",{value:!0});Z4.ExperimentationService=void 0;var pVe=$0e();Object.defineProperty(Z4,"ExperimentationService",{enumerable:!0,get:function(){return pVe.ExperimentationService}})});var K0e=L(eO=>{"use strict";Object.defineProperty(eO,"__esModule",{value:!0});eO.MementoKeyValueStorage=void 0;var lV=class{constructor(e){this.mementoGlobalStorage=e}async getValue(e,r){return await this.mementoGlobalStorage.get(e)||r}setValue(e,r){this.mementoGlobalStorage.update(e,r)}};eO.MementoKeyValueStorage=lV});var Y0e=L(pV=>{"use strict";Object.defineProperty(pV,"__esModule",{value:!0});var dV=class{constructor(){this.initializePromise=Promise.resolve(),this.initialFetch=Promise.resolve()}isFlightEnabled(e){return!1}isCachedFlightEnabled(e){return Promise.resolve(!1)}isFlightEnabledAsync(e){return Promise.resolve(!1)}getTreatmentVariable(e,r){}getTreatmentVariableAsync(e,r){return Promise.resolve(void 0)}};pV.default=dV});var X0e=L(w1=>{"use strict";Object.defineProperty(w1,"__esModule",{value:!0});w1.getExperimentationServiceAsync=w1.getExperimentationService=void 0;var fVe=eV(),mVe=W0e(),fV=require("vscode"),hVe=K0e(),gVe=Y0e(),vVe="https://default.exp-tas.com/vscode/ab",yVe="query-expfeature",bVe="abexp.assignmentcontext",_Ve="VSCode.ABExp.FeatureData",xVe=1e3*60*30;function Q0e(t,e,r,n,o,...s){if(!o)throw new Error("Memento storage was not provided.");let a=fV.workspace.getConfiguration("telemetry");if(!(fV.env.isTelemetryEnabled===void 0?a.get("enableTelemetry",!0):fV.env.isTelemetryEnabled))return new gVe.default;let l=[new fVe.VSCodeFilterProvider(t,e,r),...s],d=new hVe.MementoKeyValueStorage(o);return new mVe.ExperimentationService({filterProviders:l,telemetry:n,storageKey:_Ve,keyValueStorage:d,featuresTelemetryPropertyName:"",assignmentContextTelemetryPropertyName:bVe,telemetryEventName:yVe,endpoint:vVe,refetchInterval:xVe})}w1.getExperimentationService=Q0e;async function SVe(t,e,r,n,o,...s){let a=Q0e(t,e,r,n,o,...s);return await a.initializePromise,a}w1.getExperimentationServiceAsync=SVe});var Z0e=L(Bh=>{"use strict";Object.defineProperty(Bh,"__esModule",{value:!0});Bh.TargetPopulation=Bh.getExperimentationServiceAsync=Bh.getExperimentationService=void 0;var J0e=X0e();Object.defineProperty(Bh,"getExperimentationService",{enumerable:!0,get:function(){return J0e.getExperimentationService}});Object.defineProperty(Bh,"getExperimentationServiceAsync",{enumerable:!0,get:function(){return J0e.getExperimentationServiceAsync}});var IVe=eV();Object.defineProperty(Bh,"TargetPopulation",{enumerable:!0,get:function(){return IVe.TargetPopulation}})});var rye=L(rO=>{"use strict";Object.defineProperty(rO,"__esModule",{value:!0});rO.BaseTelemetryReporter=void 0;var mV=class{constructor(e,r,n){this.telemetrySender=e,this.vscodeAPI=r,this.userOptIn=!1,this.errorOptIn=!1,this.disposables=[],this._onDidChangeTelemetryLevel=new this.vscodeAPI.EventEmitter,this.onDidChangeTelemetryLevel=this._onDidChangeTelemetryLevel.event,this.telemetryLogger=this.vscodeAPI.env.createTelemetryLogger(this.telemetrySender,n),this.updateUserOptIn(),this.telemetryLogger.onDidChangeEnableStates(()=>{this.updateUserOptIn()})}updateUserOptIn(){this.errorOptIn=this.telemetryLogger.isErrorsEnabled,this.userOptIn=this.telemetryLogger.isUsageEnabled,(this.telemetryLogger.isErrorsEnabled||this.telemetryLogger.isUsageEnabled)&&this.telemetrySender.instantiateSender(),this._onDidChangeTelemetryLevel.fire(this.telemetryLevel)}get telemetryLevel(){return this.errorOptIn&&this.userOptIn?"all":this.errorOptIn?"error":"off"}internalSendTelemetryEvent(e,r,n,o){o?this.telemetrySender.sendEventData(e,{properties:r,measurements:n}):this.telemetryLogger.logUsage(e,{properties:r,measurements:n})}sendTelemetryEvent(e,r,n){this.internalSendTelemetryEvent(e,r,n,!1)}sendRawTelemetryEvent(e,r,n){let o={...r};for(let s of Object.keys(o??{})){let a=o[s];typeof s=="string"&&a!==void 0&&(o[s]=new this.vscodeAPI.TelemetryTrustedValue(typeof a=="string"?a:a.value))}this.sendTelemetryEvent(e,o,n)}sendDangerousTelemetryEvent(e,r,n){this.telemetrySender.instantiateSender(),this.internalSendTelemetryEvent(e,r,n,!0)}internalSendTelemetryErrorEvent(e,r,n,o){o?this.telemetrySender.sendEventData(e,{properties:r,measurements:n}):this.telemetryLogger.logError(e,{properties:r,measurements:n})}sendTelemetryErrorEvent(e,r,n){this.internalSendTelemetryErrorEvent(e,r,n,!1)}sendDangerousTelemetryErrorEvent(e,r,n){this.telemetrySender.instantiateSender(),this.internalSendTelemetryErrorEvent(e,r,n,!0)}async dispose(){return await this.telemetrySender.dispose(),this.telemetryLogger.dispose(),Promise.all(this.disposables.map(e=>e.dispose()))}};rO.BaseTelemetryReporter=mV});var nye=L(nO=>{"use strict";Object.defineProperty(nO,"__esModule",{value:!0});nO.BaseTelemetrySender=void 0;var df;(function(t){t[t.NOT_INSTANTIATED=0]="NOT_INSTANTIATED",t[t.INSTANTIATING=1]="INSTANTIATING",t[t.INSTANTIATED=2]="INSTANTIATED"})(df||(df={}));var hV=class{constructor(e,r){this._instantiationStatus=df.NOT_INSTANTIATED,this._eventQueue=[],this._exceptionQueue=[],this._clientFactory=r,this._key=e}sendEventData(e,r){if(!this._telemetryClient){this._instantiationStatus!==df.INSTANTIATED&&this._eventQueue.push({eventName:e,data:r});return}this._telemetryClient.logEvent(e,r)}sendErrorData(e,r){if(!this._telemetryClient){this._instantiationStatus!==df.INSTANTIATED&&this._exceptionQueue.push({exception:e,data:r});return}let n={stack:e.stack,message:e.message,name:e.name};if(r){let o=r.properties||r;r.properties={...o,...n}}else r={properties:n};this._telemetryClient.logEvent("unhandlederror",r)}async flush(){return this._telemetryClient?.flush()}async dispose(){this._telemetryClient&&(await this._telemetryClient.dispose(),this._telemetryClient=void 0)}_flushQueues(){this._eventQueue.forEach(({eventName:e,data:r})=>this.sendEventData(e,r)),this._eventQueue=[],this._exceptionQueue.forEach(({exception:e,data:r})=>this.sendErrorData(e,r)),this._exceptionQueue=[]}instantiateSender(){this._instantiationStatus===df.NOT_INSTANTIATED&&(this._instantiationStatus=df.INSTANTIATING,this._clientFactory(this._key).then(e=>{this._telemetryClient=e,this._instantiationStatus=df.INSTANTIATED,this._flushQueues()}).catch(e=>{console.error(e),this._instantiationStatus=df.INSTANTIATED}))}};nO.BaseTelemetrySender=hV});var vV=L(iO=>{"use strict";Object.defineProperty(iO,"__esModule",{value:!0});iO.TelemetryUtil=void 0;var gV=class t{static applyReplacements(e,r){for(let n of Object.keys(e))for(let o of r)o.lookup.test(n)&&(o.replacementString!==void 0?e[n]=o.replacementString:delete e[n])}static shouldUseOneDataSystemSDK(e){return e.length===74&&e[32]==="-"&&e[41]==="-"&&e[46]==="-"&&e[51]==="-"&&e[56]==="-"&&e[69]==="-"}static getAdditionalCommonProperties(e){return{"common.os":e.platform,"common.nodeArch":e.architecture,"common.platformversion":(e.release||"").replace(/^(\d+)(\.\d+)?(\.\d+)?(.*)/,"$1$2$3"),"common.telemetryclientversion":"0.9.4"}}static getInstance(){return t._instance||(t._instance=new t),t._instance}};iO.TelemetryUtil=gV});var R1,pf,_d,cl,k1,hR,yV=R(()=>{R1="function",pf="object",_d="undefined",cl="prototype",k1=Object,hR=k1[cl]});var Mi,Ii,A1,qh,ff,uu,gR,mf,vR,yR,iye,lu,bR,cn,P1,Ci,D1,bV,_c,_V,xV,hf,qa,rr=R(()=>{Mi=void 0,Ii=null,A1="",qh="function",ff="object",uu="prototype",gR="__proto__",mf="undefined",vR="constructor",yR="Symbol",iye="_polyfill",lu="length",bR="name",cn="call",P1="toString",Ci=Object,D1=Ci[uu],bV=String,_c=bV[uu],_V=Math,xV=Array,hf=xV[uu],qa=hf.slice});function Us(t,e){try{return{v:t.apply(this,e)}}catch(r){return{e:r}}}var N1=R(()=>{});function oye(t,e){var r=Us(t);return r.e?e:r.v}var sye=R(()=>{N1()});function oO(t){return function(e){return typeof e===t}}function aye(t){var e="[object "+t+"]";return function(r){return!!(r&&_R(r)===e)}}function _R(t){return D1.toString.call(t)}function sO(t,e){return typeof t===e}function wt(t){return typeof t===mf||t===mf}function Te(t){return t===Ii||wt(t)}function IV(t){return t===Ii||!aO(t)}function aO(t){return!!t||t!==Mi}function CV(t){return!SV&&(SV=["string","number","boolean",mf,"symbol","bigint"]),t!==ff&&SV.indexOf(t)!==-1}function Tn(t){return!t&&Te(t)?!1:!!t&&typeof t===ff}function jh(t){return!!(t&&t.then&&pt(t.then))}function cO(t){return!t||!du(t)}function du(t){return!(!t||oye(function(){return!(t&&0+t)},!t))}var SV,Ot,pt,et,L1,Bs,ul,Hh,xc=R(()=>{rr();sye();Ot=oO("string"),pt=oO(qh);et=xV.isArray,L1=aye("Date"),Bs=oO("number"),ul=oO("boolean"),Hh=aye("Error")});var my,uO=R(()=>{rr();my=Ci.getOwnPropertyDescriptor});function Fi(t,e){return!!t&&D1.hasOwnProperty[cn](t,e)}var lO=R(()=>{rr()});function cye(t,e){return Fi(t,e)||!!my(t,e)}var Ha,dO=R(()=>{rr();uO();lO();Ha=Ci.hasOwn||cye});function Ye(t,e,r){if(t&&Tn(t)){for(var n in t)if(Ha(t,n)&&e[cn](r||t,n,t[n])===-1)break}}var zh=R(()=>{xc();rr();dO()});function TV(t,e,r,n){var o={};return Ye(t,function(s,a){o[s]=e?a:s,o[a]=r?a:s}),n(o)}var uye=R(()=>{zh()});function ci(t){throw new Error(t)}function Kn(t){throw new TypeError(t)}var Gh=R(()=>{});function lye(t){var e=[];return Ye(t,function(r,n){e.push([r,n])}),e}function dye(t){var e=[];return Ye(t,function(r,n){e.push(n)}),e}var pye=R(()=>{zh()});function fye(t){return t}function TVe(t){return t[gR]||Ii}function la(t){return EV&&Ye(t,function(e,r){(et(r)||Tn(r))&&EV(r)}),xd(t)}var EV,hy,bo,xd,pO,O1,EVe,vPt,M1=R(()=>{rr();xc();zh();pye();EV=Ci.freeze;hy=Ci.assign,bo=Ci.keys;xd=EV||fye,pO=Ci.seal||fye,O1=Ci.getPrototypeOf||TVe,EVe=Ci.entries||lye,vPt=Ci.values||dye});function wV(t){return TV(t,1,0,la)}function RV(t){return TV(t,0,0,la)}function mye(t){var e={};return Ye(t,function(r,n){e[r]=n[1],e[n[0]]=n[1]}),la(e)}function kV(t){return mye(t)}var AV=R(()=>{uye();zh();M1()});var fO,PV=R(()=>{AV();fO=RV({asyncIterator:0,hasInstance:1,isConcatSpreadable:2,iterator:3,match:4,matchAll:5,replace:6,search:7,species:8,split:9,toPrimitive:10,toStringTag:11,unscopables:12})});var Hn,gy=R(()=>{rr();Hn=bV});function NV(){var t;return typeof globalThis!==mf&&(t=globalThis),!t&&typeof self!==mf&&(t=self),!t&&typeof window!==mf&&(t=window),!t&&typeof global!==mf&&(t=global),t}function mO(){if(!DV){var t=Us(NV).v||{};DV=t[hye]=t[hye]||{}}return DV}var hye,DV,hO=R(()=>{N1();rr();hye="__tsUtils$gblCfg"});function Ve(t,e){var r=A1,n=D1[P1][cn](t);n===wVe&&(t={stack:Hn(t.stack),message:Hn(t.message),name:Hn(t.name)});try{r=JSON.stringify(t,Ii,e?typeof e=="number"?e:4:Mi),r=r&&r.replace(/"(\w+)"\s*:\s{0,1}/g,"$1: ")||Hn(t)}catch(o){r=" - "+Ve(o,e)}return n+": "+r}var wVe,Vh=R(()=>{rr();gy();wVe="[object Error]"});function ll(t,e,r){var n=e&&e[t];return function(o){var s=o&&o[t]||n;if(s||r){var a=arguments;return(s||r).apply(o,s?qa[cn](a,1):a)}Kn('"'+Hn(t)+'" not defined for '+Ve(o))}}function gye(t){return function(e){return e[t]}}var pu,fu=R(()=>{Vh();Gh();gy();rr();pu=ll});var BPt,vye,yye=R(()=>{rr();BPt=_V.min,vye=_V.max});var LV,bye=R(()=>{rr();fu();LV=pu("slice",_c)});function _ye(t,e,r){return Te(t)&&Kn("'polyStrSubstr called with invalid "+Ve(t)),r<0?A1:(e=e||0,e<0&&(e=vye(e+t[lu],0)),wt(r)?LV(t,e):LV(t,e,e+r))}function $h(t,e){return Ti(t,0,e)}var Ti,dl,gO=R(()=>{xc();Vh();Gh();rr();fu();yye();bye();Ti=pu("substring",_c),dl=ll("substr",_c,_ye)});function RVe(){if(!OV){var t=mO();OV=t.gblSym=t.gblSym||{k:{},s:{}}}return OV}function yO(t){var e={description:Hn(t),toString:function(){return yR+"("+t+")"}};return e[iye]=!0,e}function Sye(t){var e=RVe();if(!Ha(e.k,t)){var r=yO(t),n=bo(e.s).length;r[xye]=function(){return n+"_"+r[P1]()},e.k[t]=r,e.s[r[xye]()]=Hn(t)}return e.k[t]}function Iye(t){!vO&&(vO={});var e,r=fO[t];return r&&(e=vO[r]=vO[r]||yO(yR+"."+r)),e}var xye,OV,vO,Cye=R(()=>{PV();rr();dO();gy();hO();M1();xye="_urid"});function Tye(t){var e={};if(e[bO.c]=!0,e[bO.e]=!0,t.l){e.get=function(){return t.l.v};var r=my(t.l,"v");r&&r.set&&(e.set=function(n){t.l.v=n})}return Ye(t,function(n,o){e[bO[n]]=wt(o)?e[bO[n]]:o}),e}function _O(t,e,r,n,o,s){var a={e:s,c:o};return r&&(a.g=r),n&&(a.s=n),Ei(t,e,Tye(a))}function jr(t,e,r){return Ei(t,e,Tye(r))}var bO,Ei,kVe,vy=R(()=>{rr();xc();zh();uO();bO={e:"enumerable",c:"configurable",v:"value",w:"writable",g:"get",s:"set"};Ei=Ci.defineProperty,kVe=Ci.defineProperties});function pl(){wi=mO()}function fl(t){var e={};return!wi&&pl(),e.b=wi.lzy,Ei(e,"v",{configurable:!0,get:function(){var r=t();return wi.lzy||Ei(e,"v",{value:r}),e.b=wi.lzy,r}}),e}var wi,yy=R(()=>{hO();vy()});function F1(t,e){return fl(function(){var r=Us(t);return r.e?e:r.v})}var MV=R(()=>{yy();N1()});function xR(t){return Ei({toJSON:function(){return t}},"v",{value:t})}var FV=R(()=>{vy()});function IR(t,e){var r;return function(){return!wi&&pl(),(!r||wi.lzy)&&(r=xR(Us(t,e).v)),r.v}}function gf(t){return fl(function(){return Us(Zr,[t]).v||Mi})}function qs(t){return!wi&&pl(),(!SR||t===!1||wi.lzy)&&(SR=xR(Us(NV).v||Ii)),SR.v}function Zr(t,e){var r=!SR||e===!1?qs(e):SR.v;return r&&r[t]?r[t]:t===Eye?li():Ii}function Wh(){return!!ui()}function Kh(){return!!li()}function U1(){return!!ro()}function xO(){return!!CR()}var Eye,SR,ui,li,ro,CR,UV,TR=R(()=>{rr();hO();yy();FV();N1();Eye="window";ui=IR(Zr,["document"]);li=IR(Zr,[Eye]);ro=IR(Zr,["navigator"]);CR=IR(Zr,["history"]),UV=IR(function(){return!!Us(function(){return process&&(process.versions||{}).node}).v})});function SO(){(!Hs||!Hs.b)&&(Hs=gf(yR),BV=F1(function(){return Hs.v?Hs.v.for:Mi},Mi),AVe=F1(function(){return Hs.v?Hs.v.keyFor:Mi},Mi))}function qV(){return!!wye()}function wye(){return!wi&&pl(),(!Hs||wi.lzy)&&SO(),Hs.v}function by(t,e){var r=fO[t];return!wi&&pl(),(!Hs||wi.lzy)&&SO(),Hs.v?Hs.v[r||t]:e?Mi:Iye(t)}function _y(t,e){return!wi&&pl(),(!Hs||wi.lzy)&&SO(),Hs.v?Hs.v(t):e?Ii:yO(t)}function ER(t){return!wi&&pl(),(!BV||!Hs||wi.lzy)&&SO(),(BV.v||Sye)(t)}var Hs,BV,AVe,IO=R(()=>{rr();Cye();PV();yy();MV();TR()});function wR(t){return!!t&&pt(t.next)}function Rye(t){return!IV(t)&&pt(t[by(3)])}var HV=R(()=>{IO();xc()});function kye(t,e,r){if(t&&(wR(t)||(!CO&&(CO=xR(by(3))),t=t[CO.v]?t[CO.v]():null),wR(t))){var n=void 0,o=void 0;try{for(var s=0;!(o=t.next()).done&&e[cn](r||t,o.value,s,t)!==-1;)s++}catch(a){n={e:a},t.throw&&(o=null,t.throw(n))}finally{try{o&&!o.done&&t.return&&t.return(o)}finally{if(n)throw n.e}}}}var CO,Aye=R(()=>{FV();rr();IO();HV()});function vf(t,e,r){return t.apply(e,r)}var TO=R(()=>{});function mu(t,e){return!wt(e)&&t&&(et(e)?vf(t.push,t,e):wR(e)||Rye(e)?kye(e,function(r){t.push(r)}):t.push(e)),t}var Pye=R(()=>{xc();HV();Aye();TO()});function _e(t,e,r){if(t)for(var n=t[lu]>>>0,o=0;o<n&&!(o in t&&e[cn](r||t,t[o],o,t)===-1);o++);}var EO=R(()=>{rr()});var wr,jV=R(()=>{rr();fu();wr=pu("indexOf",hf)});var Sd,Dye=R(()=>{rr();fu();Sd=pu("map",hf)});function Yh(t,e,r){return(t&&t.slice||qa).apply(t,qa[cn](arguments,1))}var Nye=R(()=>{rr()});function Lye(t,e,r){return wr(t,e,r)!==-1}var Oye=R(()=>{jV()});var wO,Mye=R(()=>{rr();fu();Oye();wO=ll("includes",hf,Lye)});var B1,Fye=R(()=>{rr();fu();B1=pu("reduce",hf)});function PVe(t){if(!t)return{};var e=typeof t;e!==ff&&e!==qh&&Kn("Prototype must be an Object or function: "+Ve(t));function r(){}return r[uu]=t,new r}var hu,zV=R(()=>{rr();Vh();Gh();hu=Ci.create||PVe});function VV(t,e){var r=Ci.setPrototypeOf||function(n,o){!GV&&(GV=fl(function(){var s;return s={},s[gR]=[],s instanceof Array})),GV.v?n[gR]=o:Ye(o,function(s,a){return n[s]=a})};return r(t,e)}var GV,Uye=R(()=>{yy();rr();zh()});function DVe(t,e,r){Us(jr,[e,bR,{v:t,c:!0,e:!1}]),e=VV(e,r);function n(){this.constructor=e,Us(jr,[this,bR,{v:t,c:!0,e:!1}])}return e[uu]=r===Ii?hu(r):(n[uu]=r[uu],new n),e}function Bye(t,e){e&&(t[bR]=e)}function $V(t,e,r){var n=r||Error,o=n[uu][bR],s=Error.captureStackTrace;return DVe(t,function(){var a=this,c=arguments;try{Us(Bye,[n,t]);var u=vf(n,a,qa[cn](c))||a;if(u!==a){var l=O1(a);l!==O1(u)&&VV(u,l)}return s&&s(u,a[vR]),e&&e(u,c),u}finally{Us(Bye,[n,o])}},n)}var qye=R(()=>{TO();rr();zV();vy();M1();Uye();N1()});function di(){return(Date.now||Hye)()}function Hye(){return new Date().getTime()}var WV=R(()=>{});function NVe(t){return function(r){return Te(r)&&Kn("strTrim called ["+Ve(r)+"]"),r&&r.replace&&(r=r.replace(t,A1)),r}}var jye,zye=R(()=>{xc();Vh();Gh();rr();jye=NVe(/^\s+|(?=\s)\s+$/g)});var Nr,Gye=R(()=>{rr();fu();zye();Nr=ll("trim",_c,jye)});function _o(t){if(!t||typeof t!==ff)return!1;QV||(QV=Kh()?li():!0);var e=!1;if(t!==QV){YV||(KV=Function[uu][P1],YV=KV[cn](Ci));try{var r=O1(t);e=!r,e||(Fi(r,vR)&&(r=r[vR]),e=r&&typeof r===qh&&KV[cn](r)===YV)}catch{}}return e}var KV,YV,QV,XV=R(()=>{TR();rr();lO();M1()});function LVe(t){return t.value&&Yye(t),!0}function OVe(t,e,r,n){var o;return _e(t,function(s){if(s.k===e)return o=s,-1}),o||(o={k:e,v:e},t.push(o),n(o)),o.v}function JV(t,e,r,n){var o=r.handler,s=r.path?n?r.path.concat(n):r.path:[],a={handler:r.handler,src:r.src,path:s},c=typeof e,u=!1,l=!1;e&&c===ff?u=_o(e):l=e===Ii||CV(c);var d={type:c,isPrim:l,isPlain:u,value:e,result:e,path:s,origin:r.src,copy:function(p,f){return JV(t,p,f?a:r,f)},copyTo:function(p,f){return $ye(t,p,f,a)}};return d.isPrim?o&&o[cn](r,d)?d.result:e:OVe(t,e,s,function(p){jr(d,"result",{g:function(){return p.v},s:function(h){p.v=h}});for(var f=0,m=o;!(m||(f<Vye.length?Vye[f++]:LVe))[cn](r,d);)m=Ii})}function $ye(t,e,r,n){if(!Te(r))for(var o in r)e[o]=JV(t,r[o],n,o);return e}function Wye(t,e,r){var n={handler:r,src:e,path:[]};return $ye([],t,e,n)}function Kye(t,e){var r={handler:e,src:t};return JV([],t,r)}function MVe(t){var e=t.value;if(et(e)){var r=t.result=[];return r.length=e.length,t.copyTo(r,e),!0}return!1}function FVe(t){var e=t.value;return L1(e)?(t.result=new Date(e.getTime()),!0):!1}function UVe(t){return t.type===qh}function Yye(t){var e=t.value;if(e&&t.isPlain){var r=t.result={};return t.copyTo(r,e),!0}return!1}var Vye,Qye=R(()=>{EO();xc();rr();vy();XV();Vye=[MVe,Yye,UVe,FVe]});function BVe(t,e){return _e(e,function(r){Wye(t,r)}),t}function RO(t,e,r,n,o,s,a){return BVe(Kye(t)||{},qa[cn](arguments))}var Xye=R(()=>{EO();rr();Qye()});var q1,Jye=R(()=>{rr();fu();q1=gye(lu)});function yf(){return!wi&&pl(),(!kO||!kO.b&&wi.lzy)&&(kO=gf("performance")),kO.v}function H1(){var t=yf();return t&&t.now?t.now():di()}var kO,Zye=R(()=>{WV();TR();yy()});function qVe(t,e,r){Ot(t)||Kn("'"+Ve(t)+"' is not a string");var n=Ot(e)?e:Hn(e),o=!wt(r)&&r<t[lu]?r:t[lu];return Ti(t,o-n[lu],o)===n}var Qh,ebe=R(()=>{xc();Vh();Gh();rr();fu();gy();gO();Qh=ll("endsWith",_c,qVe)});var da,tbe=R(()=>{rr();fu();da=pu("indexOf",_c)});function HVe(t,e,r){Ot(t)||Kn("'"+Ve(t)+"' is not a string");var n=Ot(e)?e:Hn(e),o=r>0?r:0;return Ti(t,o,o+n[lu])===n}var xy,rbe=R(()=>{xc();Vh();Gh();rr();fu();gy();gO();xy=ll("startsWith",_c,HVe)});function nbe(t,e,r){var n=!0,o=t?e(Ii):Ii,s;function a(){return n=!1,o&&o[e$]&&o[e$](),s}function c(){o&&r(o),o=Ii}function u(){return o=e(o),n||a(),s}function l(d){!d&&o&&c(),d&&!o&&u()}return s={cancel:c,refresh:u},s[t$]=function(){return o&&o[t$]?o[t$]():n},s[ZV]=function(){return n=!0,o&&o[ZV]&&o[ZV](),s},s[e$]=a,s=Ei(s,jVe,{get:function(){return!!o},set:l}),{h:s,dn:function(){o=Ii}}}var ZV,e$,t$,jVe,ibe=R(()=>{rr();vy();ZV="ref",e$="unref",t$="hasRef",jVe="enabled"});function r$(t,e,r){var n=et(e),o=n?e.length:0,s=(o>0?e[0]:n?Mi:e)||setTimeout,a=(o>1?e[1]:Mi)||clearTimeout,c=r[0];r[0]=function(){u.dn(),vf(c,Mi,qa[cn](arguments))};var u=nbe(t,function(l){if(l){if(l.refresh)return l.refresh(),l;vf(a,Mi,[l])}return vf(s,Mi,r)},function(l){vf(a,Mi,[l])});return u.h}function ja(t,e){return r$(!0,Mi,qa[cn](arguments))}function n$(t,e,r){return r$(!0,t,qa[cn](arguments,1))}function i$(t,e){return r$(!1,Mi,qa[cn](arguments))}var obe=R(()=>{TO();xc();rr();ibe()});var vt=R(()=>{Pye();EO();Mye();jV();Dye();Fye();Nye();xc();qye();WV();Vh();AV();TR();Xye();yy();Jye();Zye();MV();Gh();zV();vy();zh();uO();dO();lO();XV();M1();ebe();tbe();rbe();gO();gy();Gye();IO();obe()});function za(t,e){typeof e!==R1&&e!==null&&Kn("Class extends value "+String(e)+" is not a constructor or null"),o$(t,e);function r(){this.constructor=t}t[cl]=e===null?hu(e):(r[cl]=e[cl],new r)}function AO(t,e){for(var r=0,n=e.length,o=t.length;r<n;r++,o++)t[o]=e[r];return t}var W4t,K4t,sbe,VVe,gu,o$,abe=R(()=>{vt();yV();W4t=(qs()||{}).Symbol,K4t=(qs()||{}).Reflect,sbe="hasOwnProperty",VVe=function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)hR[sbe].call(e,o)&&(t[o]=e[o])}return t},gu=hy||VVe,o$=function(t,e){return o$=k1.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n[sbe](o)&&(r[o]=n[o])},o$(t,e)}});var cbe=R(()=>{});var Ga=R(()=>{yV();abe();cbe();vt()});function LO(t){return t&&(t===f$[bf]||t===Array[bf])}function m$(t){return LO(t)||t===Function[bf]}function Sy(t){var e;if(t){if(kR)return kR(t);var r=t[p$]||t[bf]||(t[OO]?t[OO][bf]:null);e=t[DO]||r,Fi(t,DO)||(delete t[s$],e=t[DO]=t[s$]||t[DO],t[s$]=r)}return e}function UO(t,e){var r=[];if(dbe)r=dbe(t);else for(var n in t)typeof n=="string"&&Fi(t,n)&&r.push(n);if(r&&r.length>0)for(var o=0;o<r.length;o++)e(r[o])}function h$(t,e,r){return e!==OO&&typeof t[e]===MO&&(r||Fi(t,e))&&e!==p$&&e!==bf}function BO(t){Kn("DynamicProto: "+t)}function WVe(t){var e=hu(null);return UO(t,function(r){!e[r]&&h$(t,r,!1)&&(e[r]=t[r])}),e}function g$(t,e){for(var r=t.length-1;r>=0;r--)if(t[r]===e)return!0;return!1}function KVe(t,e,r,n){function o(u,l,d){var p=l[d];if(p[c$]&&n){var f=u[FO]||{};f[RR]!==!1&&(p=(f[l[j1]]||{})[d]||p)}return function(){return p.apply(u,arguments)}}var s=hu(null);UO(r,function(u){s[u]=o(e,r,u)});for(var a=Sy(t),c=[];a&&!m$(a)&&!g$(c,a);)UO(a,function(u){!s[u]&&h$(a,u,!kR)&&(s[u]=o(e,a,u))}),c.push(a),a=Sy(a);return s}function YVe(t,e,r,n){var o=null;if(t&&Fi(r,j1)){var s=t[FO]||hu(null);if(o=(s[r[j1]]||hu(null))[e],o||BO("Missing ["+e+"] "+MO),!o[u$]&&s[RR]!==!1){for(var a=!Fi(t,e),c=Sy(t),u=[];a&&c&&!m$(c)&&!g$(u,c);){var l=c[e];if(l){a=l===n;break}u.push(c),c=Sy(c)}try{a&&(t[e]=o),o[u$]=1}catch{s[RR]=!1}}}return o}function QVe(t,e,r){var n=e[t];return n===r&&(n=Sy(e)[t]),typeof n!==MO&&BO("["+t+"] is not a "+MO),n}function XVe(t,e,r,n,o){function s(u,l){var d=function(){var p=YVe(this,l,u,d)||QVe(l,u,d);return p.apply(this,arguments)};return d[c$]=1,d}if(!LO(t)){var a=r[FO]=r[FO]||hu(null);if(!LO(a)){var c=a[e]=a[e]||hu(null);a[RR]!==!1&&(a[RR]=!!o),LO(c)||UO(r,function(u){h$(r,u,!1)&&r[u]!==n[u]&&(c[u]=r[u],delete r[u],(!Fi(t,u)||t[u]&&!t[u][c$])&&(t[u]=s(t,u)))})}}}function JVe(t,e){if(kR){for(var r=[],n=Sy(e);n&&!m$(n)&&!g$(r,n);){if(n===t)return!0;r.push(n),n=Sy(n)}return!1}return!0}function a$(t,e){return Fi(t,bf)?t.name||e||ube:((t||{})[OO]||{}).name||e||ube}function nr(t,e,r,n){Fi(t,bf)||BO("theClass is an invalid class definition.");var o=t[bf];JVe(o,e)||BO("["+a$(t)+"] not in hierarchy of ["+a$(e)+"]");var s=null;Fi(o,j1)?s=o[j1]:(s=$Ve+a$(t,"_")+"$"+d$.n,d$.n++,o[j1]=s);var a=nr[fbe],c=!!a[NO];c&&n&&n[NO]!==void 0&&(c=!!n[NO]);var u=WVe(e),l=KVe(o,e,u,c);r(e,l);var d=!!kR&&!!a[l$];d&&n&&(d=!!n[l$]),XVe(o,s,e,u,d!==!1)}var PO,OO,bf,MO,FO,c$,j1,$Ve,u$,RR,fbe,ube,p$,DO,lbe,s$,NO,l$,f$,kR,dbe,pbe,d$,Ho=R(()=>{vt();OO="constructor",bf="prototype",MO="function",FO="_dynInstFuncs",c$="_isDynProxy",j1="_dynClass",$Ve="_dynCls$",u$="_dynInstChk",RR=u$,fbe="_dfOpts",ube="_unknown_",p$="__proto__",DO="_dyn"+p$,lbe="__dynProto$Gbl",s$="_dynInstProto",NO="useBaseInst",l$="setInstFuncs",f$=Object,kR=f$.getPrototypeOf,dbe=f$.getOwnPropertyNames,pbe=qs(),d$=pbe[lbe]||(pbe[lbe]={o:(PO={},PO[l$]=!0,PO[NO]=!0,PO),n:1e3});nr[fbe]=d$.o});var v$,mbe=R(()=>{"use strict";v$=100});var no,y$,qO=R(()=>{vt();no=wV,y$=kV});var ml,ZVe,hbe=R(()=>{qO();ml=no({Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5}),ZVe=no({Unknown:0,NonRetryableStatus:1,CleanStorage:2,MaxInStorageTimeExceeded:3})});var Va,Xh,at,Iy,Cy,z1,_f,hl,vu,mn,Jh,ar,Id,HO,Ty,xf,Cd,$a,Zh,b$,js,eg,xo,jO,G1,V1,$1,tg,_$,Wa,AR,Ey,zO,Td,Sc,W1,Ed,gl,Ka,rg,wy,Ic,ng,GO,PR,yu,VO,vl,x$,Ya,DR,Ry,S$,I$,C$,NR,ig,ky,yl,$O,K1,T$,WO,Ay,E$,Y1,Q1,og,yn=R(()=>{Va="toLowerCase",Xh="blkVal",at="length",Iy="rdOnly",Cy="notify",z1="warnToConsole",_f="throwInternal",hl="setDf",vu="watch",mn="logger",Jh="apply",ar="push",Id="splice",HO="hdlr",Ty="cancel",xf="initialize",Cd="identifier",$a="isInitialized",Zh="getPlugin",b$="pollInternalLogs",js="name",eg="time",xo="processNext",jO="getProcessTelContext",G1="getNotifyMgr",V1="addNotificationListener",$1="removeNotificationListener",tg="enabled",_$="stopPollingInternalLogs",Wa="unload",AR="onComplete",Ey="version",zO="loggingLevelConsole",Td="createNew",Sc="teardown",W1="messageId",Ed="message",gl="isAsync",Ka="diagLog",rg="_doTeardown",wy="update",Ic="getNext",ng="setNextPlugin",GO="protocol",PR="userAgent",yu="split",VO="nodeType",vl="replace",x$="logInternalMessage",Ya="type",DR="handler",Ry="status",S$="itemsReceived",I$="getResponseHeader",C$="getAllResponseHeaders",NR="isChildEvt",ig="data",ky="getCtx",yl="setCtx",$O="complete",K1="urlString",T$="sendPOST",WO="headers",Ay="timeout",E$="setRequestHeader",Y1="traceId",Q1="spanId",og="traceFlags"});function gbe(t,e){w$||(w$=$V("AggregationError",function(n,o){o[at]>1&&(n.errors=o[1])}));var r=t||"One or more errors occurred.";throw _e(e,function(n,o){r+=`
`.concat(o," > ").concat(Ve(n))}),new w$(r,e||[])}var w$,vbe=R(()=>{vt();yn()});function sg(t,e){return KO(t,function(r){return e?e({value:r,rejected:!1}):r},function(r){return e?e({rejected:!0,reason:r}):r})}function KO(t,e,r,n){var o=t;return jh(t)?(e||r)&&(o=t.then(e,r)):e&&(o=e(t)),n&&ybe(o,n),o}function ybe(t,e){var r=t;return e&&(jh(t)?t.finally?r=t.finally(e):r=t.then(function(n){return e(),n},function(n){throw e(),n}):e()),r}var R$=R(()=>{vt()});function bbe(t,e,r,n){k$=k$||{toString:function(){return"[[PromiseState]]"}},A$=A$||{toString:function(){return"[[PromiseResult]]"}},P$=P$||{toString:function(){return"[[PromiseIsHandled]]"}},Ei(t,k$,{get:e}),Ei(t,A$,{get:r}),Ei(t,P$,{get:n})}var k$,A$,P$,D$,_be=R(()=>{vt();D$=!1});var YO,N$=R(()=>{YO=["pending","resolving","resolved","rejected"]});function Sbe(t,e,r,n){var o=ui();!QO&&(QO=F1(function(){var u;return o&&o.createEvent&&(u=o.createEvent("Event")),!!u&&u.initEvent},null));var s=QO.v?o.createEvent("Event"):n?new Event(e):{};if(r&&r(s),QO.v&&s.initEvent(e,!1,!0),s&&t[xbe])t[xbe](s);else{var a=t["on"+e];if(a)a(s);else{var c=Zr("console");c&&(c.error||c.log)(e,Ve(s))}}}var xbe,QO,Ibe=R(()=>{vt();xbe="dispatchEvent"});var X1,L$=R(()=>{X1="Promise"});function Cbe(t){return pt(t)?t.toString():Ve(t)}function Ebe(t,e,r){var n=Yh(arguments,3),o=0,s=!1,a,c=[],u=t$e++,l=LR.length>0?LR[LR.length-1]:void 0,d=!1,p=null,f;!O$&&(O$=gf(X1+"RejectionEvent"));var m=function(I,w){try{LR.push(u),d=!0,p&&p.cancel(),p=null;var O=t(function(U,z){c.push(function(){try{var M=o===2?I:w,re=wt(M)?a:pt(M)?M(a):M;jh(re)?re.then(U,z):M?U(re):o===3?z(re):U(re)}catch(ee){z(ee)}}),s&&y()},n);return O}finally{LR.pop()}},h=function(I){return m(void 0,I)},g=function(I){var w=I,O=I;return pt(I)&&(w=function(U){return I&&I(),U},O=function(U){throw I&&I(),U}),m(w,O)},v=function(){return YO[o]},y=function(){if(c.length>0){var I=c.slice();c=[],d=!0,e(I),p&&p.cancel(),p=null}},_=function(I,w){return function(O){if(o===w){if(I===2&&jh(O)){o=1,O.then(_(2,1),_(3,1));return}o=I,s=!0,a=O,y(),!d&&I===3&&!p&&(p=ja(b,r$e))}}},b=function(){if(!d)if(UV())process.emit(Tbe,a,f);else{var I=li()||qs();Sbe(I,e$e,function(w){return jr(w,"promise",{g:function(){return f}}),w.reason=a,w},!!O$.v)}};f={then:m,catch:h,finally:g},Ei(f,"state",{get:v}),D$&&bbe(f,v,function(){return _R(a)},function(){return d}),qV()&&(f[by(11)]="IPromise");var S=function(){return"IPromise"+(D$?"["+u+(wt(l)?"":":"+l)+"]":"")+" "+v()+(s?" - "+Cbe(a):"")};return f.toString=S,function(){pt(r)||Kn(X1+": executor is not a function - "+Cbe(r));var w=_(3,0);try{r.call(f,_(2,0),w)}catch(O){w(O)}}(),f}function J1(t){return function(e){var r=Yh(arguments,1);return t(function(n,o){try{var s=[],a=1;_e(e,function(c,u){c&&(a++,KO(c,function(l){s[u]=l,--a===0&&n(s)},o))}),a--,a===0&&n(s)}catch(c){o(c)}},r)}}function Z1(t){return function(e){var r=Yh(arguments,1);return jh(e)?e:t(function(n){n(e)},r)}}function eS(t){return function(e){var r=Yh(arguments,1);return t(function(n,o){o(e)},r)}}var Tbe,e$e,LR,t$e,r$e,O$,XO=R(()=>{vt();R$();_be();N$();Ibe();L$();Tbe="unhandledRejection",e$e=Tbe.toLowerCase(),LR=[],t$e=0,r$e=10});function wbe(t){var e=Bs(t)?t:0;return function(r){ja(function(){n$e(r)},e)}}var n$e,Rbe=R(()=>{vt();n$e=function(t){_e(t,function(e){try{e()}catch{}})}});function tS(t,e){return Ebe(tS,wbe(e),t,e)}var $Ot,WOt,KOt,kbe=R(()=>{XO();Rbe();$Ot=J1(tS),WOt=Z1(tS),KOt=eS(tS)});function OR(t,e){!M$&&(M$=gf(X1));var r=M$.v;if(!r)return tS(t);pt(t)||Kn(X1+": executor is not a function - "+Ve(t));var n=0;function o(){return YO[n]}var s=new r(function(a,c){function u(d){n=2,a(d)}function l(d){n=3,c(d)}t(u,l)});return Ei(s,"state",{get:o}),s}var M$,t3t,r3t,n3t,Abe=R(()=>{kbe();XO();N$();vt();L$();t3t=J1(OR),r3t=Z1(OR),n3t=eS(OR)});function pa(t,e){return!F$&&(F$=fl(function(){return OR})),F$.v.call(this,t,e)}var F$,U$,i$e,o$e,Pbe=R(()=>{vt();XO();Abe();U$=J1(pa),i$e=Z1(pa),o$e=eS(pa)});var rS=R(()=>{R$();Pbe()});var Cc,Rt,ag,pi,JO,MR,Sf,Py,Qa,Dy,nS,cg,iS,wd,ZO,e3,t3,oS,r3,n3,Dbe,io=R(()=>{Cc=void 0,Rt="",ag="channels",pi="core",JO="createPerfMgr",MR="disabled",Sf="extensionConfig",Py="extensions",Qa="processTelemetry",Dy="priority",nS="eventsSent",cg="eventsDiscarded",iS="eventsSendRequest",wd="perfEvent",ZO="offlineEventsStored",e3="offlineBatchSent",t3="offlineBatchDrop",oS="getPerfMgr",r3="domain",n3="path",Dbe="Not dynamic - "});function s$e(t,e){return function(){var r=arguments,n=q$(e);if(n){var o=n.listener;o&&o[t]&&o[t][Jh](o,r)}}}function a$e(){var t=Zr("Microsoft");return t&&(o3=t.ApplicationInsights),o3}function q$(t){var e=o3;return!e&&t.disableDbgExt!==!0&&(e=o3||a$e()),e?e.ChromeDbgExt:null}function Nbe(t){if(!i3){i3={};for(var e=0;e<B$[at];e++)i3[B$[e]]=s$e(B$[e],t)}return i3}var B$,o3,i3,H$=R(()=>{vt();yn();io();B$=[nS,cg,iS,wd],o3=null});function Fbe(t,e){var r=!1;if(t){try{if(r=e in t,!r){var n=t[cl];n&&(r=e in n)}}catch{}if(!r)try{var o=new t;r=!wt(o[e])}catch{}}return r}function W$(t){Mbe=t}function Ny(t){if(t&&Mbe){var e=Zr("__mockLocation");if(e)return e}return typeof location===pf&&location?location:Zr(u$e)}function FR(){return typeof console!==_d?console:Zr(l$e)}function Rd(){return!!(typeof JSON===pf&&JSON||Zr(Lbe)!==null)}function hs(){return Rd()?JSON||Zr(Lbe):null}function UR(){return Zr(d$e)}function BR(){return Zr(p$e)}function ug(){var t=ro();return t&&t.product?t.product===f$e:!1}function lg(){var t=ro();if(t&&(t[PR]!==z$||j$===null)){z$=t[PR];var e=(z$||Rt)[Va]();j$=Ui(e,V$)||Ui(e,$$)}return j$}function qR(t){if(t===void 0&&(t=null),!t){var e=ro()||{};t=e?(e.userAgent||Rt)[Va]():Rt}var r=(t||Rt)[Va]();if(Ui(r,V$)){var n=ui()||{};return Math.max(parseInt(r[yu](V$)[1]),n[c$e]||0)}else if(Ui(r,$$)){var o=parseInt(r[yu]($$)[1]);if(o)return o+4}return null}function Xa(t){return(G$===null||t===!1)&&(G$=U1()&&!!ro().sendBeacon),G$}function If(t){var e=!1;try{e=!!Zr("fetch");var r=Zr("Request");e&&t&&r&&(e=Fbe(r,"keepalive"))}catch{}return e}function HR(){return sS===null&&(sS=typeof XDomainRequest!==_d,sS&&aS()&&(sS=sS&&!Fbe(Zr(Obe),"withCredentials"))),sS}function aS(){var t=!1;try{var e=Zr(Obe);t=!!e}catch{}return t}function Ube(t,e){if(t)for(var r=0;r<t[at];r++){var n=t[r];if(n[js]&&n[js]===e)return n}return{}}function K$(t){var e=ui();return e&&t?Ube(e.querySelectorAll("meta"),t).content:null}function Y$(t){var e,r=yf();if(r){var n=r.getEntriesByType("navigation")||[];e=Ube((n[at]>0?n[0]:{}).serverTiming,t).description}return e}var c$e,u$e,l$e,Lbe,d$e,p$e,f$e,V$,$$,Obe,j$,z$,Mbe,sS,G$,dg=R(()=>{"use strict";Ga();vt();yn();kd();io();c$e="documentMode",u$e="location",l$e="console",Lbe="JSON",d$e="crypto",p$e="msCrypto",f$e="ReactNative",V$="msie",$$="trident/",Obe="XMLHttpRequest",j$=null,z$=null,Mbe=!1,sS=null,G$=null});function Bbe(t){return t?'"'+t[vl](/\"/g,Rt)+'"':Rt}function Q$(t,e){var r=FR();if(r){var n="log";r[t]&&(n=t),pt(r[n])&&r[n](e)}}function bl(t,e){return(t||{})[mn]||new pg(e)}function X$(t){return t||new pg}function Me(t,e,r,n,o,s){s===void 0&&(s=!1),X$(t)[_f](e,r,n,o,s)}function fa(t,e){X$(t)[z1](e)}function J$(t,e,r){X$(t)[x$](e,r)}var cS,qbe,m$e,h$e,g$e,v$e,y$e,Ly,pg,_l=R(()=>{"use strict";Ho();vt();fg();yn();H$();dg();io();qbe="warnToConsole",m$e="AI (Internal): ",h$e="AI: ",g$e="AITR_",v$e={loggingLevelConsole:0,loggingLevelTelemetry:1,maxMessageLimit:25,enableDebug:!1},y$e=(cS={},cS[0]=null,cS[1]="errorToConsole",cS[2]=qbe,cS[3]="debugToConsole",cS);Ly=function(){function t(e,r,n,o){n===void 0&&(n=!1);var s=this;s[W1]=e,s[Ed]=(n?h$e:m$e)+e;var a=Rt;Rd()&&(a=hs().stringify(o));var c=(r?" message:"+Bbe(r):Rt)+(o?" props:"+Bbe(a):Rt);s[Ed]+=c}return t.dataType="MessageData",t}();pg=function(){function t(e){this.identifier="DiagnosticLogger",this.queue=[];var r=0,n={},o,s,a,c,u;nr(t,this,function(l){u=p(e||{}),l.consoleLoggingLevel=function(){return o},l[_f]=function(h,g,v,y,_){_===void 0&&(_=!1);var b=new Ly(g,v,_,y);if(c)throw Ve(b);var S=y$e[h]||qbe;if(wt(b[Ed]))m("throw"+(h===1?"Critical":"Warning"),b);else{if(_){var I=+b[W1];!n[I]&&o>=h&&(l[S](b[Ed]),n[I]=!0)}else o>=h&&l[S](b[Ed]);d(h,b)}},l.debugToConsole=function(h){Q$("debug",h),m("warning",h)},l[z1]=function(h){Q$("warn",h),m("warning",h)},l.errorToConsole=function(h){Q$("error",h),m("error",h)},l.resetInternalMessageCount=function(){r=0,n={}},l[x$]=d,l[Wa]=function(h){u&&u.rm(),u=null};function d(h,g){if(!f()){var v=!0,y=g$e+g[W1];if(n[y]?v=!1:n[y]=!0,v&&(h<=s&&(l.queue[ar](g),r++,m(h===1?"error":"warn",g)),r===a)){var _="Internal events throttle limit per PageView reached for this app.",b=new Ly(23,_,!1);l.queue[ar](b),h===1?l.errorToConsole(_):l[z1](_)}}}function p(h){return oo(Yn(h,v$e,l).cfg,function(g){var v=g.cfg;o=v[zO],s=v.loggingLevelTelemetry,a=v.maxMessageLimit,c=v.enableDebug})}function f(){return r>=a}function m(h,g){var v=q$(e||{});v&&v[Ka]&&v[Ka](h,g)}})}return t.__ieDyn=1,t}()});function Ad(t){return!Te(t)}function Oy(t){var e=t;return e&&Ot(e)&&(e=e[vl](_$e,function(r,n){return n.toUpperCase()}),e=e[vl](x$e,"_"),e=e[vl](S$e,function(r,n){return"_"+n})),e}function Ui(t,e){return t&&e?da(t,e)!==-1:!1}function Tc(t){return t&&t.toISOString()||""}function En(t){return Hh(t)?t[js]:Rt}function bu(t,e,r,n,o){var s=r;return t&&(s=t[e],s!==r&&(!o||o(s))&&(!n||n(r))&&(s=r,t[e]=s)),s}function jR(t,e,r){var n;return t?(n=t[e],!n&&Te(n)&&(n=wt(r)?{}:r,t[e]=n)):n=wt(r)?{}:r,n}function jbe(t,e){var r=null,n=null;return pt(t)?r=t:n=t,function(){var o=arguments;if(r&&(n=r()),n)return n[e][Jh](n,o)}}function Z$(t,e,r){if(t&&e&&Tn(t)&&Tn(e)){var n=function(s){if(Ot(s)){var a=e[s];pt(a)?(!r||r(s,!0,e,t))&&(t[s]=jbe(e,s)):(!r||r(s,!1,e,t))&&(Ha(t,s)&&delete t[s],jr(t,s,{g:function(){return e[s]},s:function(c){e[s]=c}}))}};for(var o in e)n(o)}return t}function Cf(t,e,r,n,o){t&&e&&r&&(o!==!1||wt(t[e]))&&(t[e]=jbe(r,n))}function Ec(t,e,r,n){return t&&e&&Tn(t)&&et(r)&&_e(r,function(o){Ot(o)&&Cf(t,o,e,o,n)}),t}function eW(t){return function(){function e(){var r=this;t&&Ye(t,function(n,o){r[n]=o})}return e}()}function _u(t){return t&&hy&&(t=k1(hy({},t))),t}function s3(t,e,r,n,o,s){var a=arguments,c=a[0]||{},u=a[at],l=!1,d=1;for(u>0&&ul(c)&&(l=c,c=a[d]||{},d++),Tn(c)||(c={});d<u;d++){var p=a[d],f=et(p),m=Tn(p);for(var h in p){var g=f&&h in p||m&&Ha(p,h);if(g){var v=p[h],y=void 0;if(l&&v&&((y=et(v))||_o(v))){var _=c[h];y?et(_)||(_=[]):_o(_)||(_={}),v=s3(l,_,v)}v!==void 0&&(c[h]=v)}}}return c}function xl(t){try{return t.responseText}catch{}return null}function My(t,e){return t?"XDomainRequest,Response:"+xl(t)||"":e}function Tf(t,e){return t?"XMLHttpRequest,Status:"+t[Ry]+",Response:"+xl(t)||t.response||"":e}function Ef(t,e){return e&&(Bs(e)?t=[e].concat(t):et(e)&&(t=e.concat(t))),t}function Fy(t,e){try{if(t&&t!==""){var r=hs().parse(t);if(r&&r[S$]&&r[S$]>=r.itemsAccepted&&r.itemsReceived-r.itemsAccepted===r.errors[at])return r}}catch(n){Me(e,1,43,"Cannot parse the response. "+En(n),{response:t})}return null}function tW(t,e,r,n,o,s){n===void 0&&(n=!1),o===void 0&&(o=!1);function a(u,l,d){try{u[l]=d}catch{}}var c=new XMLHttpRequest;return n&&a(c,I$e,n),r&&a(c,Hbe,r),c.open(t,e,!o),r&&a(c,Hbe,r),!o&&s&&a(c,C$e,s),c}function a3(t){var e={};if(Ot(t)){var r=Nr(t)[yu](/[\r\n]+/);_e(r,function(n){if(n){var o=n.indexOf(": ");if(o!==-1){var s=Nr(n.substring(0,o))[Va](),a=Nr(n.substring(o+1));e[s]=a}else e[Nr(n)]=1}})}return e}function uS(t,e,r){if(!t[r]&&e&&e[I$]){var n=e[I$](r);n&&(t[r]=Nr(n))}return t}function wf(t,e){var r={};return t[C$]?r=a3(t[C$]()):e&&(r=uS(r,t,w$e),r=uS(r,t,T$e),r=uS(r,t,E$e)),r}var b$e,_$e,x$e,S$e,U3t,I$e,Hbe,C$e,T$e,E$e,w$e,kd=R(()=>{Ga();vt();yn();_l();dg();io();b$e="getPrototypeOf",_$e=/-([a-z])/g,x$e=/([^\w\d_$])/g,S$e=/^(\d+[\w\d_$])/,U3t=Object[b$e];I$e="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",Hbe="withCredentials",C$e="timeout";T$e="kill-duration",E$e="kill-duration-seconds",w$e="time-delta-millis"});function R$e(t){t<0&&(t>>>=0),zR=Gbe+t&mg,GR=Vbe-t&mg,$be=!0}function k$e(){try{var t=di()&2147483647;R$e((Math.random()*zbe^t)+t)}catch{}}function VR(t){return t>0?Math.floor(Rf()/mg*(t+1))>>>0:0}function Rf(t){var e=0,r=UR()||BR();return r&&r.getRandomValues&&(e=r.getRandomValues(new Uint32Array(1))[0]&mg),e===0&&lg()&&($be||k$e(),e=Wbe()&mg),e===0&&(e=Math.floor(zbe*Math.random()|0)),t||(e>>>=0),e}function Wbe(t){GR=36969*(GR&65535)+(GR>>16)&mg,zR=18e3*(zR&65535)+(zR>>16)&mg;var e=(GR<<16)+(zR&65535)>>>0&mg|0;return t||(e>>>=0),e}function $R(t){t===void 0&&(t=22);for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=Rf()>>>0,n=0,o=Rt;o[at]<t;)n++,o+=e.charAt(r&63),r>>>=6,n===5&&(r=(Rf()<<2&4294967295|r&3)>>>0,n=0);return o}var zbe,mg,Gbe,Vbe,$be,zR,GR,c3=R(()=>{vt();yn();dg();io();zbe=4294967296,mg=4294967295,Gbe=123456789,Vbe=987654321,$be=!1,zR=Gbe,GR=Vbe});function Ybe(t){return t[VO]===1||t[VO]===9||!+t[VO]}function D$e(t,e){var r=e[t.id];if(!r){r={};try{Ybe(e)&&jr(e,t.id,{e:!1,v:r})}catch{}}return r}function gs(t,e){return e===void 0&&(e=!1),Oy(t+P$e+++(e?"."+Kbe:Rt)+A$e)}function u3(t){var e={id:gs("_aiData-"+(t||Rt)+"."+Kbe),accept:function(r){return Ybe(r)},get:function(r,n,o,s){var a=r[e.id];return a?a[Oy(n)]:(s&&(a=D$e(e,r),a[Oy(n)]=o),o)},kill:function(r,n){if(r&&r[n])try{delete r[n]}catch{}}};return e}var Kbe,A$e,P$e,lS=R(()=>{vt();yn();kd();io();c3();Kbe="3.0.5",A$e="."+$R(6),P$e=0});function l3(t){return t&&Tn(t)&&(t.isVal||t.fb||Ha(t,"v")||Ha(t,"mrg")||Ha(t,"ref")||t.set)}function Qbe(t,e,r){var n,o=r.dfVal||aO;if(e&&r.fb){var s=r.fb;et(s)||(s=[s]);for(var a=0;a<s[at];a++){var c=s[a],u=e[c];if(o(u)?n=u:t&&(u=t.cfg[c],o(u)&&(n=u),t.set(t.cfg,Hn(c),u)),o(n))break}}return!o(n)&&o(r.v)&&(n=r.v),n}function rW(t,e,r){var n=r;if(r&&l3(r)&&(n=Qbe(t,e,r)),n){l3(n)&&(n=rW(t,e,n));var o;et(n)?(o=[],o[at]=n[at]):_o(n)&&(o={}),o&&(Ye(n,function(s,a){a&&l3(a)&&(a=rW(t,e,a)),o[s]=a}),n=o)}return n}function WR(t,e,r,n){var o,s,a,c=n,u,l,d,p;l3(c)?(o=c.isVal,s=c.set,d=c[Iy],p=c[Xh],u=c.mrg,l=c.ref,!l&&wt(l)&&(l=!!u),a=Qbe(t,e,c)):a=n,p&&t[Xh](e,r);var f,m=!0,h=e[r];(h||!Te(h))&&(f=h,m=!1,o&&f!==a&&!o(f)&&(f=a,m=!0),s&&(f=s(f,a,e),m=f===a)),m?a?f=rW(t,e,a):f=a:(_o(f)||et(a))&&u&&a&&(_o(a)||et(a))&&Ye(a,function(g,v){WR(t,f,g,v)}),t.set(e,r,f),l&&t.ref(e,r),d&&t[Iy](e,r)}var nW=R(()=>{vt();yn()});function iW(t){if(t){var e;if(et(t)?(e=[],e[at]=t[at]):_o(t)&&(e={}),e)return Ye(t,function(r,n){e[r]=iW(n)}),e}return t}function KR(t){if(t){var e=t[Pd]||t;if(e.cfg&&(e.cfg===t||e.cfg[Pd]===e))return e}return null}function YR(t){if(t&&(_o(t)||et(t)))try{t[Xbe]=!0}catch{}return t}function oW(t){if(t)try{t[Jbe]=!0}catch{}return t}function d3(t,e,r){var n=!1;return r&&!t[e.blkVal]&&(n=r[Jbe],!n&&!r[Xbe]&&(n=_o(r)||et(r))),n}function p3(t){Kn("InvalidAccess:"+t)}var Pd,Xbe,Jbe,f3=R(()=>{vt();yn();Pd=ER("[[ai_dynCfg_1]]"),Xbe=ER("[[ai_blkDynCfg_1]]"),Jbe=ER("[[ai_frcDynCfg_1]]")});function L$e(t,e,r){et(e)&&_e(N$e,function(n){var o=e[n];e[n]=function(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];var c=o[Jh](this,s);return QR(t,e,r,"Patching"),c}})}function m3(t,e){var r=my(t,e);return r&&r.get}function O$e(t,e,r,n){var o={n:r,h:[],trk:function(l){l&&l.fn&&(wr(o.h,l)===-1&&o.h[ar](l),t.trk(l,o))},clr:function(l){var d=wr(o.h,l);d!==-1&&o.h[Id](d,1)}},s=!0,a=!1;function c(){s&&(a=a||d3(c,t,n),n&&!n[Pd]&&a&&(n=QR(t,n,r,"Converting")),s=!1);var l=t.act;return l&&o.trk(l),n}c[t.prop]={chng:function(){t.add(o)}};function u(l){if(n!==l){c[t.ro]&&!t.upd&&p3("["+r+"] is read-only:"+Ve(e)),s&&(a=a||d3(c,t,n),s=!1);var d=a&&c[t.rf];if(a)if(d){Ye(n,function(f){n[f]=l?l[f]:Cc});try{Ye(l,function(f,m){XR(t,n,f,m)}),l=n}catch(f){dS((t.hdlr||{})[mn],r,"Assigning",f),a=!1}}else n&&n[Pd]&&Ye(n,function(f){var m=m3(n,f);if(m){var h=m[t.prop];h&&h.chng()}});if(l!==n){var p=l&&d3(c,t,l);!d&&p&&(l=QR(t,l,r,"Converting")),n=l,a=p}t.add(o)}}jr(e,o.n,{g:c,s:u})}function XR(t,e,r,n){if(e){var o=m3(e,r),s=o&&!!o[t.prop];s?e[r]=n:O$e(t,e,r,n)}return e}function h3(t,e,r,n){if(e){var o=m3(e,r),s=o&&!!o[t.prop],a=n&&n[0],c=n&&n[1],u=n&&n[2];if(!s){if(u)try{YR(e)}catch(l){dS((t.hdlr||{})[mn],r,"Blocking",l)}try{XR(t,e,r,e[r]),o=m3(e,r)}catch(l){dS((t.hdlr||{})[mn],r,"State",l)}}a&&(o[t.rf]=a),c&&(o[t.ro]=c),u&&(o[t.blkVal]=!0)}return e}function QR(t,e,r,n){try{Ye(e,function(o,s){XR(t,e,o,s)}),e[Pd]||(Ei(e,Pd,{get:function(){return t[HO]}}),L$e(t,e,r))}catch(o){dS((t.hdlr||{})[mn],r,n,o)}return e}var N$e,dS,Zbe=R(()=>{vt();io();yn();f3();N$e=["push","pop","shift","unshift","splice"],dS=function(t,e,r,n){t&&t[_f](3,108,"".concat(r," [").concat(e,"] failed - ")+Ve(n))}});function e_e(t){var e,r=_y(JR+"get"+t.uid+ZR),n=_y(JR+"ro"+t.uid+ZR),o=_y(JR+"rf"+t.uid+ZR),s=_y(JR+"blkVal"+t.uid+ZR),a=_y(JR+"dtl"+t.uid+ZR),c=null,u=null,l;function d(h,g){var v=l.act;try{l.act=h,h&&h[a]&&(_e(h[a],function(_){_.clr(h)}),h[a]=[]),g({cfg:t.cfg,set:t.set.bind(t),setDf:t[hl].bind(t),ref:t.ref.bind(t),rdOnly:t[Iy].bind(t)})}catch(_){var y=t[mn];throw y&&y[_f](1,107,Ve(_)),_}finally{l.act=v||null}}function p(){if(c){var h=c;c=null,u&&u[Ty](),u=null;var g=[];if(_e(h,function(v){if(v&&(v[a]&&(_e(v[a],function(y){y.clr(v)}),v[a]=null),v.fn))try{d(v,v.fn)}catch(y){g[ar](y)}}),c)try{p()}catch(v){g[ar](v)}g[at]>0&&gbe("Watcher error(s): ",g)}}function f(h){if(h&&h.h[at]>0){c||(c=[]),u||(u=ja(function(){u=null,p()},0));for(var g=0;g<h.h[at];g++){var v=h.h[g];v&&wr(c,v)===-1&&c[ar](v)}}}function m(h,g){if(h){var v=h[a]=h[a]||[];wr(v,g)===-1&&v[ar](g)}}return l=(e={prop:r,ro:n,rf:o},e[Xh]=s,e[HO]=t,e.add=f,e[Cy]=p,e.use=d,e.trk=m,e),l}var JR,ZR,t_e=R(()=>{vt();vbe();yn();JR="[[ai_",ZR="]]"});function M$e(t,e){var r={fn:e,rm:function(){r.fn=null,t=null,e=null}};return t.use(r,e),r}function F$e(t,e,r){var n,o=KR(e);if(o)return o;var s=gs("dyncfg",!0),a=e&&r!==!1?e:iW(e),c;function u(){c[Cy]()}function l(y,_,b){try{y=XR(c,y,_,b)}catch(S){dS(t,_,"Setting value",S)}return y[_]}function d(y){return M$e(c,y)}function p(y,_){c.use(null,function(b){var S=c.upd;try{wt(_)||(c.upd=_),y(b)}finally{c.upd=S}})}function f(y,_){var b;return h3(c,y,_,(b={},b[0]=!0,b))[_]}function m(y,_){var b;return h3(c,y,_,(b={},b[1]=!0,b))[_]}function h(y,_){var b;return h3(c,y,_,(b={},b[2]=!0,b))[_]}function g(y,_){return _&&Ye(_,function(b,S){WR(v,y,b,S)}),y}var v=(n={uid:null,cfg:a},n[mn]=t,n[Cy]=u,n.set=l,n[hl]=g,n[vu]=d,n.ref=f,n[Iy]=m,n[Xh]=h,n._block=p,n);return jr(v,"uid",{c:!1,e:!1,w:!1,v:s}),c=e_e(v),QR(c,a,"config","Creating"),v}function U$e(t,e){t?(t[z1](e),t[_f](2,108,e)):p3(e)}function Yn(t,e,r,n){var o=F$e(r,t||{},n);return e&&o[hl](o.cfg,e),o}function oo(t,e,r){var n=t[Pd]||t;return n.cfg&&(n.cfg===t||n.cfg[Pd]===n)?n[vu](e):(U$e(r,Dbe+Ve(t)),Yn(t,null,r)[vu](e))}var fg=R(()=>{vt();lS();io();yn();nW();Zbe();t_e();f3()});function kf(t,e){if(t&&t[Wa])return t[Wa](e)}function g3(t,e,r){var n;return r||(n=pa(function(o){r=o})),t&&q1(t)>0?sg(kf(t[0],e),function(){g3(Yh(t,1),e,r)}):r(),n}var sW=R(()=>{rS();vt();yn()});var r_e,aW,cW=R(()=>{r_e=500,aW="Microsoft_ApplicationInsights_BypassAjaxInstrumentation"});function B$e(t,e,r){return!t&&Te(t)?e:ul(t)?t:Hn(t)[Va]()==="true"}function uW(t){return{mrg:!0,v:t}}function pS(t,e,r){return{fb:r,isVal:t,v:e}}function xu(t,e){return{fb:e,set:B$e,v:!!t}}var lW=R(()=>{vt();yn()});function gW(){!Dd&&(Dd=fl(function(){return ui()}))}function H$e(t,e){var r=Af[hg]||b3[hg];return r||(r=Af[hg]=Af(t,e),b3[hg]=r),r}function y3(t){return t?t.isEnabled():!0}function p_e(t,e){return e&&t&&et(t.ignoreCookies)?wr(t.ignoreCookies,e)!==-1:!1}function j$e(t,e){return e&&t&&et(t.blockedCookies)&&wr(t.blockedCookies,e)!==-1?!0:p_e(t,e)}function c_e(t,e){var r=e[tg];if(Te(r)){var n=void 0;wt(t[o_e])||(n=!t[o_e]),wt(t[mW])||(n=!t[mW]),r=n}return r}function vW(t,e){var r;if(t)r=t.getCookieMgr();else if(e){var n=e.cookieCfg;n&&n[hg]?r=n[hg]:r=Af(e)}return r||(r=H$e(e,(t||{})[mn])),r}function Af(t,e){var r,n,o,s,a,c,u,l,d;t=Yn(t||b3,null,e).cfg,a=oo(t,function(f){f[hl](f.cfg,q$e),n=f.ref(f.cfg,"cookieCfg"),o=n[n3]||"/",s=n[r3],c=c_e(t,n)!==!1,u=n.getCookie||z$e,l=n.setCookie||d_e,d=n.delCookie||d_e},e);var p=(r={isEnabled:function(){var f=c_e(t,n)!==!1&&c&&fS(e),m=b3[hg];return f&&m&&p!==m&&(f=y3(m)),f},setEnabled:function(f){c=f!==!1,n[tg]=f},set:function(f,m,h,g,v){var y=!1;if(y3(p)&&!j$e(n,f)){var _={},b=Nr(m||Rt),S=da(b,";");if(S!==-1&&(b=Nr($h(m,S)),_=f_e(Ti(m,S+1))),bu(_,r3,g||s,du,wt),!Te(h)){var I=lg();if(wt(_[pW])){var w=di(),O=w+h*1e3;if(O>0){var U=new Date;U.setTime(O),bu(_,pW,u_e(U,I?n_e:i_e)||u_e(U,I?n_e:i_e)||Rt,du)}}I||bu(_,"max-age",Rt+h,null,wt)}var z=Ny();z&&z[GO]==="https:"&&(bu(_,"secure",null,null,wt),fW===null&&(fW=!_3((ro()||{})[PR])),fW&&bu(_,"SameSite","None",null,wt)),bu(_,n3,v||o,null,wt),l(f,l_e(b,_)),y=!0}return y},get:function(f){var m=Rt;return y3(p)&&!p_e(n,f)&&(m=u(f)),m},del:function(f,m){var h=!1;return y3(p)&&(h=p.purge(f,m)),h},purge:function(f,m){var h,g=!1;if(fS(e)){var v=(h={},h[n3]=m||"/",h[pW]="Thu, 01 Jan 1970 00:00:01 GMT",h);lg()||(v["max-age"]="0"),d(f,l_e(Rt,v)),g=!0}return g}},r[Wa]=function(f){a&&a.rm(),a=null},r);return p[hg]=p,p}function fS(t){if(v3===null){v3=!1,!Dd&&gW();try{var e=Dd.v||{};v3=e[hW]!==void 0}catch(r){Me(t,2,68,"Cannot access document.cookie - "+En(r),{exception:Ve(r)})}}return v3}function f_e(t){var e={};if(t&&t[at]){var r=Nr(t)[yu](";");_e(r,function(n){if(n=Nr(n||Rt),n){var o=da(n,"=");o===-1?e[n]=null:e[Nr($h(n,o))]=Nr(Ti(n,o+1))}})}return e}function u_e(t,e){return pt(t[e])?t[e]():null}function l_e(t,e){var r=t||Rt;return Ye(e,function(n,o){r+="; "+n+(Te(o)?Rt:"="+o)}),r}function z$e(t){var e=Rt;if(!Dd&&gW(),Dd.v){var r=Dd.v[hW]||Rt;s_e!==r&&(a_e=f_e(r),s_e=r),e=Nr(a_e[t]||Rt)}return e}function d_e(t,e){!Dd&&gW(),Dd.v&&(Dd.v[hW]=t+"="+e)}function _3(t){return Ot(t)?!!(Ui(t,"CPU iPhone OS 12")||Ui(t,"iPad; CPU OS 12")||Ui(t,"Macintosh; Intel Mac OS X 10_14")&&Ui(t,"Version/")&&Ui(t,"Safari")||Ui(t,"Macintosh; Intel Mac OS X 10_14")&&Qh(t,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||Ui(t,"Chrome/5")||Ui(t,"Chrome/6")||Ui(t,"UnrealEngine")&&!Ui(t,"Chrome")||Ui(t,"UCBrowser/12")||Ui(t,"UCBrowser/11")):!1}var dW,Uy,n_e,i_e,hW,pW,o_e,mW,hg,v3,fW,s_e,Dd,a_e,b3,q$e,yW=R(()=>{vt();lW();fg();yn();_l();dg();kd();io();n_e="toGMTString",i_e="toUTCString",hW="cookie",pW="expires",o_e="isCookieUseDisabled",mW="disableCookiesUsage",hg="_ckMgr",v3=null,fW=null,s_e=null,a_e={},b3={},q$e=(dW={cookieCfg:uW((Uy={},Uy[r3]={fb:"cookieDomain",dfVal:Ad},Uy.path={fb:"cookiePath",dfVal:Ad},Uy.enabled=Cc,Uy.ignoreCookies=Cc,Uy.blockedCookies=Cc,Uy)),cookieDomain:Cc,cookiePath:Cc},dW[mW]=Cc,dW)});function gg(t,e,r,n){_e(t,function(o){if(o&&o[e])if(r)ja(function(){return n(o)},0);else try{n(o)}catch{}})}var G$e,ek,bW=R(()=>{Ho();rS();vt();fg();yn();io();G$e={perfEvtsSendAll:!1};ek=function(){function t(e){this.listeners=[];var r,n,o=[],s=Yn(e,G$e);n=s[vu](function(a){r=!!a.cfg.perfEvtsSendAll}),nr(t,this,function(a){jr(a,"listeners",{g:function(){return o}}),a[V1]=function(c){o[ar](c)},a[$1]=function(c){for(var u=wr(o,c);u>-1;)o[Id](u,1),u=wr(o,c)},a[nS]=function(c){gg(o,nS,!0,function(u){u[nS](c)})},a[cg]=function(c,u){gg(o,cg,!0,function(l){l[cg](c,u)})},a[iS]=function(c,u){gg(o,iS,u,function(l){l[iS](c,u)})},a[wd]=function(c){c&&(r||!c[NR]())&&gg(o,wd,!1,function(u){c[gl]?ja(function(){return u[wd](c)},0):u[wd](c)})},a[ZO]=function(c){c&&c[at]&&gg(o,ZO,!0,function(u){u[ZO](c)})},a[e3]=function(c){c&&c[ig]&&gg(o,e3,!0,function(u){u[e3](c)})},a[t3]=function(c,u){if(c>0){var l=u||0;gg(o,t3,!0,function(d){d[t3](c,l)})}},a[Wa]=function(c){var u=function(){n&&n.rm(),n=null,o=[]},l;if(gg(o,"unload",!1,function(d){var p=d[Wa](c);p&&(l||(l=[]),l[ar](p))}),l)return pa(function(d){return sg(U$(l),function(){u(),d()})});u()}})}return t.__ieDyn=1,t}()});function Ri(t,e,r,n,o){if(t){var s=t;if(s[oS]&&(s=s[oS]()),s){var a=void 0,c=s[ky](_W);try{if(a=s.create(e(),n,o),a){if(c&&a[yl]&&(a[yl](By[xW],c),c[ky]&&c[yl])){var u=c[ky](By[tk]);u||(u=[],c[yl](By[tk],u)),u[ar](a)}return s[yl](_W,a),r(a)}}catch(l){a&&a[yl]&&a[yl]("exception",l)}finally{a&&s.fire(a),s[yl](_W,c)}}}return r()}function SW(){return V$e}var mS,xW,tk,V$e,By,rk,_W,x3=R(()=>{Ho();vt();yn();io();mS="ctx",xW="ParentContextKey",tk="ChildrenContextKey",V$e=null,By=function(){function t(e,r,n){var o=this;if(o.start=di(),o[js]=e,o[gl]=n,o[NR]=function(){return!1},pt(r)){var s;jr(o,"payload",{g:function(){return!s&&pt(r)&&(s=r(),r=null),s}})}o[ky]=function(a){return a?a===t[xW]||a===t[tk]?o[a]:(o[mS]||{})[a]:null},o[yl]=function(a,c){if(a)if(a===t[xW])o[a]||(o[NR]=function(){return!0}),o[a]=c;else if(a===t[tk])o[a]=c;else{var u=o[mS]=o[mS]||{};u[a]=c}},o[$O]=function(){var a=0,c=o[ky](t[tk]);if(et(c))for(var u=0;u<c[at];u++){var l=c[u];l&&(a+=l[eg])}o[eg]=di()-o.start,o.exTime=o[eg]-a,o[$O]=function(){}}}return t.ParentContextKey="parent",t.ChildrenContextKey="childEvts",t}(),rk=function(){function t(e){this.ctx={},nr(t,this,function(r){r.create=function(n,o,s){return new By(n,o,s)},r.fire=function(n){n&&(n[$O](),e&&pt(e[wd])&&e[wd](n))},r[yl]=function(n,o){if(n){var s=r[mS]=r[mS]||{};s[n]=o}},r[ky]=function(n){return(r[mS]||{})[n]}})}return t.__ieDyn=1,t}(),_W="CoreUtils.doPerf"});function nk(){var t=qy();return Ti(t,0,8)+"-"+Ti(t,8,12)+"-"+Ti(t,12,16)+"-"+Ti(t,16,20)+"-"+Ti(t,20)}function qy(){for(var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],e=Rt,r,n=0;n<4;n++)r=Rf(),e+=t[r&15]+t[r>>4&15]+t[r>>8&15]+t[r>>12&15]+t[r>>16&15]+t[r>>20&15]+t[r>>24&15]+t[r>>28&15];var o=t[8+(Rf()&3)|0];return dl(e,0,8)+dl(e,9,4)+"4"+dl(e,13,3)+o+dl(e,16,3)+dl(e,19,12)}var IW=R(()=>{"use strict";vt();io();c3()});function Pf(t,e,r){return t&&t[at]===e&&t!==r?!!t.match(/^[\da-f]*$/i):!1}function h_e(t,e,r){return Pf(t,e)?t:r}function g_e(t){(isNaN(t)||t<0||t>255)&&(t=1);for(var e=t.toString(16);e[at]<2;)e="0"+e;return e}function ik(t,e,r,n){var o;return o={},o[Ey]=Pf(n,2,TW)?n:CW,o[Y1]=Nd(t)?t:qy(),o[Q1]=Ld(e)?e:$h(qy(),16),o.traceFlags=r>=0&&r<=255?r:1,o}function Hy(t,e){var r;if(!t||(et(t)&&(t=t[0]||""),!t||!Ot(t)||t[at]>8192))return null;if(t.indexOf(",")!==-1){var n=t[yu](",");t=n[e>0&&n[at]>e?e:0]}var o=$$e.exec(Nr(t));return!o||o[1]===TW||o[2]===S3||o[3]===I3?null:(r={version:(o[1]||Rt)[Va](),traceId:(o[2]||Rt)[Va](),spanId:(o[3]||Rt)[Va]()},r[og]=parseInt(o[4],16),r)}function Nd(t){return Pf(t,32,S3)}function Ld(t){return Pf(t,16,I3)}function hS(t){return!(!t||!Pf(t[Ey],2,TW)||!Pf(t[Y1],32,S3)||!Pf(t[Q1],16,I3)||!Pf(g_e(t[og]),2))}function ok(t){return hS(t)?(t[og]&m_e)===m_e:!1}function sk(t){if(t){var e=g_e(t[og]);Pf(e,2)||(e="01");var r=t[Ey]||CW;return r!=="00"&&r!=="ff"&&(r=CW),"".concat(r.toLowerCase(),"-").concat(h_e(t.traceId,32,S3).toLowerCase(),"-").concat(h_e(t.spanId,16,I3).toLowerCase(),"-").concat(e.toLowerCase())}return""}function ak(t){var e="traceparent",r=Hy(K$(e),t);return r||(r=Hy(Y$(e),t)),r}var $$e,CW,TW,S3,I3,m_e,EW=R(()=>{vt();yn();IW();dg();io();$$e=/^([\da-f]{2})-([\da-f]{32})-([\da-f]{16})-([\da-f]{2})(-[^\s]{1,64})?$/i,CW="00",TW="ff",S3="00000000000000000000000000000000",I3="0000000000000000",m_e=1});function Df(t){return W$e.get(t,"state",{},!0)}function wW(t,e){for(var r=[],n=null,o=t[Ic](),s;o;){var a=o[Zh]();if(a){n&&n[ng]&&a[Qa]&&n[ng](a),s=Df(a);var c=!!s[$a];a[$a]&&(c=a[$a]()),c||r[ar](a),n=a,o=o[Ic]()}}_e(r,function(u){var l=t[pi]();u[xf](t.getCfg(),l,e,t[Ic]()),s=Df(u),!u[pi]&&!s[pi]&&(s[pi]=l),s[$a]=!0,delete s[Sc]})}function C3(t){return t.sort(function(e,r){var n=0;if(r){var o=r[Qa];e[Qa]?n=o?e[Dy]-r[Dy]:1:o&&(n=-1)}else n=e?1:-1;return n})}function v_e(t){var e={};return{getName:function(){return e[js]},setName:function(r){t&&t.setName(r),e[js]=r},getTraceId:function(){return e[Y1]},setTraceId:function(r){t&&t.setTraceId(r),Nd(r)&&(e[Y1]=r)},getSpanId:function(){return e[Q1]},setSpanId:function(r){t&&t.setSpanId(r),Ld(r)&&(e[Q1]=r)},getTraceFlags:function(){return e[og]},setTraceFlags:function(r){t&&t.setTraceFlags(r),e[og]=r}}}var W$e,RW=R(()=>{"use strict";vt();yn();lS();io();EW();W$e=u3("plugin")});function Y$e(t,e,r){for(;t;){if(t[Zh]()===r)return t;t=t[Ic]()}return vg([r],e.config||{},e)}function kW(t,e,r,n){var o=null,s=[];e||(e=Yn({},null,r[mn])),n!==null&&(o=n?Y$e(t,r,n):t);var a={_next:u,ctx:{core:function(){return r},diagLog:function(){return bl(r,e.cfg)},getCfg:function(){return e.cfg},getExtCfg:d,getConfig:p,hasNext:function(){return!!o},getNext:function(){return o},setNext:function(m){o=m},iterate:f,onComplete:c}};function c(m,h){for(var g=[],v=2;v<arguments.length;v++)g[v-2]=arguments[v];m&&s[ar]({func:m,self:wt(h)?a.ctx:h,args:g})}function u(){var m=o;if(o=m?m[Ic]():null,!m){var h=s;h&&h[at]>0&&(_e(h,function(g){try{g.func.call(g.self,g.args)}catch(v){Me(r[mn],2,73,"Unexpected Exception during onComplete - "+Ve(v))}}),s=[])}return m}function l(m,h){var g=null,v=e.cfg;if(v&&m){var y=v[Sf];!y&&h&&(y={}),v[Sf]=y,y=e.ref(v,Sf),y&&(g=y[m],!g&&h&&(g={}),y[m]=g,g=e.ref(y,m))}return g}function d(m,h){var g=l(m,!0);return h&&Ye(h,function(v,y){if(Te(g[v])){var _=e.cfg[v];(_||!Te(_))&&(g[v]=_)}WR(e,g,v,y)}),e[hl](g,h)}function p(m,h,g){g===void 0&&(g=!1);var v,y=l(m,!1),_=e.cfg;return y&&(y[h]||!Te(y[h]))?v=y[h]:(_[h]||!Te(_[h]))&&(v=_[h]),v||!Te(v)?v:g}function f(m){for(var h;h=a._next();){var g=h[Zh]();g&&m(g)}}return a}function ma(t,e,r,n){var o=Yn(e),s=kW(t,o,r,n),a=s.ctx;function c(l){var d=s._next();return d&&d[Qa](l,a),!d}function u(l,d){return l===void 0&&(l=null),et(l)&&(l=vg(l,o.cfg,r,d)),ma(l||a[Ic](),o.cfg,r,d)}return a[xo]=c,a[Td]=u,a}function gS(t,e,r){var n=Yn(e.config),o=kW(t,n,e,r),s=o.ctx;function a(u){var l=o._next();return l&&l[Wa](s,u),!l}function c(u,l){return u===void 0&&(u=null),et(u)&&(u=vg(u,n.cfg,e,l)),gS(u||s[Ic](),e,l)}return s[xo]=a,s[Td]=c,s}function ck(t,e,r){var n=Yn(e.config),o=kW(t,n,e,r),s=o.ctx;function a(u){return s.iterate(function(l){pt(l[wy])&&l[wy](s,u)})}function c(u,l){return u===void 0&&(u=null),et(u)&&(u=vg(u,n.cfg,e,l)),ck(u||s[Ic](),e,l)}return s[xo]=a,s[Td]=c,s}function vg(t,e,r,n){var o=null,s=!n;if(et(t)&&t[at]>0){var a=null;_e(t,function(c){if(!s&&n===c&&(s=!0),s&&c&&pt(c[Qa])){var u=Q$e(c,e,r);o||(o=u),a&&a._setNext(u),a=u}})}return n&&!o?vg([n],e,r):o}function Q$e(t,e,r){var n=null,o=pt(t[Qa]),s=pt(t[ng]),a;t?a=t[Cd]+"-"+t[Dy]+"-"+__e++:a="Unknown-0-"+__e++;var c={getPlugin:function(){return t},getNext:function(){return n},processTelemetry:d,unload:p,update:f,_id:a,_setNext:function(m){n=m}};function u(){var m;return t&&pt(t[b_e])&&(m=t[b_e]()),m||(m=ma(c,e,r)),m}function l(m,h,g,v,y){var _=!1,b=t?t[Cd]:K$e,S=m[y_e];return S||(S=m[y_e]={}),m.setNext(n),t&&Ri(m[pi](),function(){return b+":"+g},function(){S[a]=!0;try{var I=n?n._id:Rt;I&&(S[I]=!1),_=h(m)}catch(O){var w=n?S[n._id]:!0;w&&(_=!0),(!n||!w)&&Me(m[Ka](),1,73,"Plugin ["+b+"] failed during "+g+" - "+Ve(O)+", run flags: "+Ve(S))}},v,y),_}function d(m,h){h=h||u();function g(v){if(!t||!o)return!1;var y=Df(t);return y[Sc]||y[MR]?!1:(s&&t[ng](n),t[Qa](m,v),!0)}l(h,g,"processTelemetry",function(){return{item:m}},!m.sync)||h[xo](m)}function p(m,h){function g(){var v=!1;if(t){var y=Df(t),_=t[pi]||y[pi];t&&(!_||_===m.core())&&!y[Sc]&&(y[pi]=null,y[Sc]=!0,y[$a]=!1,t[Sc]&&t[Sc](m,h)===!0&&(v=!0))}return v}l(m,g,"unload",function(){},h[gl])||m[xo](h)}function f(m,h){function g(){var v=!1;if(t){var y=Df(t),_=t[pi]||y[pi];t&&(!_||_===m.core())&&!y[Sc]&&t[wy]&&t[wy](m,h)===!0&&(v=!0)}return v}l(m,g,"update",function(){},!1)||m[xo](h)}return xd(c)}var K$e,y_e,b_e,__e,AW,T3=R(()=>{"use strict";vt();nW();fg();yn();_l();kd();io();x3();RW();K$e="TelemetryPluginChain",y_e="_hasRun",b_e="_getTelCtx",__e=0;AW=function(){function t(e,r,n,o){var s=this,a=ma(e,r,n,o);Ec(s,a,bo(a))}return t}()});function jy(){var t=[];function e(n){n&&t[ar](n)}function r(n,o){_e(t,function(s){try{s(n,o)}catch(a){Me(n[Ka](),2,73,"Unexpected error calling unload handler - "+Ve(a))}}),t=[]}return{add:e,run:r}}var E3=R(()=>{vt();yn();_l()});function w3(){var t=[];function e(n){var o=t;t=[],_e(o,function(s){try{(s.rm||s.remove).call(s)}catch(a){Me(n,2,73,"Unloading:"+Ve(a))}})}function r(n){n&&mu(t,n)}return{run:e,add:r}}var PW=R(()=>{vt();_l()});var DW,yg,X$e,Nf,NW=R(()=>{"use strict";Ho();vt();fg();yn();_l();kd();io();T3();E3();PW();yg="getPlugin",X$e=(DW={},DW[Sf]={isVal:Ad,v:{}},DW),Nf=function(){function t(){var e=this,r,n,o,s,a;l(),nr(t,e,function(d){d[xf]=function(p,f,m,h){u(p,f,h),r=!0},d[Sc]=function(p,f){var m,h=d[pi];if(!h||p&&h!==p[pi]())return;var g,v=!1,y=p||gS(null,h,o&&o[yg]?o[yg]():o),_=f||(m={reason:0},m[gl]=!1,m);function b(){v||(v=!0,s.run(y,f),a.run(y[Ka]()),g===!0&&y[xo](_),l())}return!d[rg]||d[rg](y,_,b)!==!0?b():g=!0,g},d[wy]=function(p,f){var m=d[pi];if(!m||p&&m!==p[pi]())return;var h,g=!1,v=p||ck(null,m,o&&o[yg]?o[yg]():o),y=f||{reason:0};function _(){g||(g=!0,u(v.getCfg(),v.core(),v[Ic]()))}return!d._doUpdate||d._doUpdate(v,y,_)!==!0?_():h=!0,h},Cf(d,"_addUnloadCb",function(){return s},"add"),Cf(d,"_addHook",function(){return a},"add"),jr(d,"_unloadHooks",{g:function(){return a}})}),e[Ka]=function(d){return c(d)[Ka]()},e[$a]=function(){return r},e.setInitialized=function(d){r=d},e[ng]=function(d){o=d},e[xo]=function(d,p){p?p[xo](d):o&&pt(o[Qa])&&o[Qa](d,null)},e._getTelCtx=c;function c(d){d===void 0&&(d=null);var p=d;if(!p){var f=n||ma(null,{},e[pi]);o&&o[yg]?p=f[Td](null,o[yg]):p=f[Td](null,o)}return p}function u(d,p,f){Yn(d,X$e,bl(p)),!f&&p&&(f=p[jO]()[Ic]());var m=o;o&&o[yg]&&(m=o[yg]()),e[pi]=p,n=ma(f,d,p,m)}function l(){r=!1,e[pi]=null,n=null,o=null,a=w3(),s=jy()}}return t.__ieDyn=1,t}()});function J$e(t,e,r){var n={id:e,fn:r};mu(t,n);var o={remove:function(){_e(t,function(s,a){if(s.id===n.id)return t[Id](a,1),-1})}};return o}function Z$e(t,e,r){for(var n=!1,o=t[at],s=0;s<o;++s){var a=t[s];if(a)try{if(a.fn[Jh](null,[e])===!1){n=!0;break}}catch(c){Me(r,2,64,"Telemetry initializer failed: "+En(c),{exception:Ve(c)},!0)}}return!n}var x_e,S_e=R(()=>{Ga();Ho();vt();yn();NW();_l();kd();io();x_e=function(t){za(e,t);function e(){var r=t.call(this)||this;r.identifier="TelemetryInitializerPlugin",r.priority=199;var n,o;s(),nr(e,r,function(a,c){a.addTelemetryInitializer=function(u){return J$e(o,n++,u)},a[Qa]=function(u,l){Z$e(o,u,l?l[Ka]():a[Ka]())&&a[xo](u,l)},a[rg]=function(){s()}});function s(){n=0,o=[]}return r}return e.__ieDyn=1,e}(Nf)});function rWe(t,e){return new rk(e)}function nWe(t,e,r){var n,o=[],s=[],a={};return _e(r,function(c){(Te(c)||Te(c[xf]))&&ci(E_e);var u=c[Dy],l=c[Cd];c&&u&&(Te(a[u])?a[u]=l:fa(t,"Two extensions have same priority #"+u+" - "+a[u]+", "+l)),!u||u<e?o[ar](c):s[ar](c)}),n={},n[pi]=o,n[ag]=s,n}function C_e(t,e){var r=!1;return _e(e,function(n){if(n===t)return r=!0,-1}),r}function OW(t,e,r,n){r&&Ye(r,function(o,s){n&&_o(s)&&_o(e[o])&&OW(t,e[o],s,n),n&&_o(s)&&_o(e[o])?OW(t,e[o],s,n):t.set(e,o,s)})}function T_e(t,e){var r=null,n=-1;return _e(t,function(o,s){if(o.w===e)return r=o,n=s,-1}),{i:n,l:r}}function iWe(t,e){var r=T_e(t,e).l;return r||(r={w:e,rm:function(){var n=T_e(t,e);n.i!==-1&&t[Id](n.i,1)}},t[ar](r)),r}function oWe(t,e,r){_e(e,function(n){var o=oo(t,n.w,r);delete n.w,n.rm=function(){o.rm()}})}var bg,E_e,eWe,I_e,tWe,LW,Lf,w_e=R(()=>{"use strict";Ga();Ho();rS();vt();fg();yn();sW();cW();yW();lS();H$();_l();kd();io();bW();x3();T3();RW();S_e();E3();PW();E_e="Plugins must provide initialize method",eWe="_notificationManager",I_e="SDK is still unloading...",tWe="SDK is not initialized",LW=la((bg={cookieCfg:{}},bg[Py]={rdOnly:!0,ref:!0,v:[]},bg[ag]={rdOnly:!0,ref:!0,v:[]},bg[Sf]={ref:!0,v:{}},bg[JO]=Cc,bg.loggingLevelConsole=0,bg.diagnosticLogInterval=Cc,bg));Lf=function(){function t(){var e,r,n,o,s,a,c,u,l,d,p,f,m,h,g,v,y,_,b,S,I,w,O,U,z,M,re,ee;nr(t,this,function(N){q(),N._getDbgPlgTargets=function(){return[O]},N[$a]=function(){return r},N[xf]=function(H,le,pe,ke){m&&ci(I_e),N[$a]()&&ci("Core cannot be initialized more than once"),e=Yn(H,LW,pe||N[mn],!1),H=e.cfg,nt(e[vu](function(xt){I=xt.cfg.instrumentationKey;var rn=xt.ref(xt.cfg,Sf);Ye(rn,function(An){xt.ref(rn,An)}),Te(I)&&ci("Please provide instrumentation key")})),s=ke,ht(),We(),N[mn]=pe;var Ie=H[Py];if(d=[],d[ar].apply(d,AO(AO([],le,!1),Ie,!1)),p=H[ag],Z(null),(!f||f[at]===0)&&ci("No "+ag+" available"),p&&p[at]>1){var it=N[Zh]("TeeChannelController");(!it||!it.plugin)&&Me(n,1,28,"TeeChannel required")}oWe(H,w,n),w=null,r=!0,N.releaseQueue(),N[b$]()},N.getChannels=function(){var H=[];return f&&_e(f,function(le){H[ar](le)}),xd(H)},N.track=function(H){Ri(N[oS](),function(){return"AppInsightsCore:track"},function(){H===null&&(ye(H),ci("Invalid telemetry item")),!H[js]&&Te(H[js])&&(ye(H),ci("telemetry name required")),H.iKey=H.iKey||I,H[eg]=H[eg]||Tc(new Date),H.ver=H.ver||"4.0",!m&&N[$a]()?F()[xo](H):o[ar](H)},function(){return{item:H}},!H.sync)},N[jO]=F,N[G1]=function(){return s||(s=new ek(e.cfg),N[eWe]=s),s},N[V1]=function(H){N[G1]()[V1](H)},N[$1]=function(H){s&&s[$1](H)},N.getCookieMgr=function(){return u||(u=Af(e.cfg,N[mn])),u},N.setCookieMgr=function(H){u!==H&&(kf(u,!1),u=H)},N[oS]=function(){return!a&&!c&&nt(e[vu](function(H){if(H.cfg.enablePerfMgr){var le=H.cfg[JO];pt(le)&&(c=le(N,N[G1]()))}})),a||c||SW()},N.setPerfMgr=function(H){a=H},N.eventCnt=function(){return o[at]},N.releaseQueue=function(){if(r&&o[at]>0){var H=o;o=[],_e(H,function(le){F()[xo](le)})}},N[b$]=function(H){return g=H||null,ee=!1,M&&M[Ty](),E(!0)};function E(H){if((!M||!M[tg])&&!ee){var le=H||n&&n.queue[at]>0;le&&(re||(re=!0,nt(e[vu](function(pe){var ke=pe.cfg.diagnosticLogInterval;(!ke||!(ke>0))&&(ke=1e4);var Ie=!1;M&&(Ie=M[tg],M[Ty]()),M=i$(je,ke),M.unref(),M[tg]=Ie}))),M[tg]=!0)}return M}N[_$]=function(){ee=!0,M&&M[Ty](),je()},Ec(N,function(){return h},["addTelemetryInitializer"]),N[Wa]=function(H,le,pe){var ke;H===void 0&&(H=!0),r||ci(tWe),m&&ci(I_e);var Ie=(ke={reason:50},ke[gl]=H,ke.flushComplete=!1,ke),it;H&&!le&&(it=pa(function(An){le=An}));var xt=gS(te(),N);xt[AR](function(){_.run(N[mn]),g3([u,s,n],H,function(){q(),le&&le(Ie)})},N);function rn(An){Ie.flushComplete=An,m=!0,y.run(xt,Ie),N[_$](),xt[xo](Ie)}return je(),ne(H,rn,6,pe)||rn(!1),it},N[Zh]=ue,N.addPlugin=function(H,le,pe,ke){if(!H){ke&&ke(!1),xr(E_e);return}var Ie=ue(H[Cd]);if(Ie&&!le){ke&&ke(!1),xr("Plugin ["+H[Cd]+"] is already loaded!");return}var it={reason:16};function xt(hi){d[ar](H),it.added=[H],Z(it),ke&&ke(!0)}if(Ie){var rn=[Ie.plugin],An={reason:2,isAsync:!!pe};Q(rn,An,function(hi){hi?(it.removed=rn,it.reason|=32,xt(!0)):ke&&ke(!1)})}else xt(!1)},N.updateCfg=function(H,le){le===void 0&&(le=!0);var pe;if(N[$a]()){pe={reason:1,cfg:e.cfg,oldCfg:RO({},e.cfg),newConfig:RO({},H),merge:le},H=pe.newConfig;var ke=e.cfg;H[Py]=ke[Py],H[ag]=ke[ag]}e._block(function(Ie){var it=Ie.cfg;OW(Ie,it,H,le),le||Ye(it,function(xt){Ha(H,xt)||Ie.set(it,xt,Cc)}),Ie[hl](it,LW)},!0),e[Cy](),pe&&Ct(pe)},N.evtNamespace=function(){return v},N.flush=ne,N.getTraceCtx=function(H){return S||(S=v_e()),S},N.setTraceCtx=function(H){S=H||null},N.addUnloadHook=nt,Cf(N,"addUnloadCb",function(){return y},"add"),N.onCfgChange=function(H){var le;return r?le=oo(e.cfg,H,N[mn]):le=iWe(w,H),{rm:function(){le.rm()}}},N.getWParam=function(){return Wh()||e.cfg.enableWParam?0:-1};function P(){var H={};U=[];var le=function(pe){pe&&_e(pe,function(ke){if(ke[Cd]&&ke[Ey]&&!H[ke.identifier]){var Ie=ke[Cd]+"="+ke[Ey];U[ar](Ie),H[ke.identifier]=ke}})};le(f),p&&_e(p,function(pe){le(pe)}),le(d)}function q(){r=!1,e=Yn({},LW,N[mn]),e.cfg[zO]=1,jr(N,"config",{g:function(){return e.cfg},s:function(le){N.updateCfg(le,!1)}}),jr(N,"pluginVersionStringArr",{g:function(){return U||P(),U}}),jr(N,"pluginVersionString",{g:function(){return z||(U||P(),z=U.join(";")),z||Rt}}),jr(N,"logger",{g:function(){return n||(n=new pg(e.cfg),e[mn]=n),n},s:function(le){e[mn]=le,n!==le&&(kf(n,!1),n=le)}}),N[mn]=new pg(e.cfg),O=[];var H=N.config[Py]||[];H.splice(0,H[at]),mu(H,O),h=new x_e,o=[],kf(s,!1),s=null,a=null,c=null,kf(u,!1),u=null,l=null,d=[],p=null,f=null,m=!1,g=null,v=gs("AIBaseCore",!0),y=jy(),S=null,I=null,_=w3(),w=[],z=null,U=null,ee=!1}function F(){var H=ma(te(),e.cfg,N);return H[AR](E),H}function Z(H){var le=nWe(N[mn],r_e,d);l=null,z=null,U=null,f=(p||[])[0]||[],f=C3(mu(f,le[ag]));var pe=mu(C3(le[pi]),f);O=xd(pe);var ke=N.config[Py]||[];ke.splice(0,ke[at]),mu(ke,O);var Ie=F();f&&f[at]>0&&wW(Ie[Td](f),pe),wW(Ie,pe),H&&Ct(H)}function ue(H){var le=null,pe=null,ke=[];return _e(O,function(Ie){if(Ie[Cd]===H&&Ie!==h)return pe=Ie,-1;Ie.getChannel&&ke[ar](Ie)}),!pe&&ke[at]>0&&_e(ke,function(Ie){if(pe=Ie.getChannel(H),!pe)return-1}),pe&&(le={plugin:pe,setEnabled:function(Ie){Df(pe)[MR]=!Ie},isEnabled:function(){var Ie=Df(pe);return!Ie[Sc]&&!Ie[MR]},remove:function(Ie,it){var xt;Ie===void 0&&(Ie=!0);var rn=[pe],An=(xt={reason:1},xt[gl]=Ie,xt);Q(rn,An,function(hi){hi&&Z({reason:32,removed:rn}),it&&it(hi)})}}),le}function te(){if(!l){var H=(O||[]).slice();wr(H,h)===-1&&H[ar](h),l=vg(C3(H),e.cfg,N)}return l}function Q(H,le,pe){if(H&&H[at]>0){var ke=vg(H,e.cfg,N),Ie=gS(ke,N);Ie[AR](function(){var it=!1,xt=[];_e(d,function(An,hi){C_e(An,H)?it=!0:xt[ar](An)}),d=xt,z=null,U=null;var rn=[];p&&(_e(p,function(An,hi){var Js=[];_e(An,function(wp){C_e(wp,H)?it=!0:Js[ar](wp)}),rn[ar](Js)}),p=rn),pe&&pe(it),E()}),Ie[xo](le)}else pe(!1)}function je(){if(n&&n.queue){var H=n.queue.slice(0);n.queue[at]=0,_e(H,function(le){var pe,ke=(pe={},pe[js]=g||"InternalMessageId: "+le[W1],pe.iKey=I,pe[eg]=Tc(new Date),pe.baseType=Ly.dataType,pe.baseData={message:le[Ed]},pe);N.track(ke)})}}function ne(H,le,pe,ke){var Ie=1,it=!1,xt=null;ke=ke||5e3;function rn(){Ie--,it&&Ie===0&&(xt&&xt[Ty](),xt=null,le&&le(it),le=null)}if(f&&f[at]>0){var An=F()[Td](f);An.iterate(function(hi){if(hi.flush){Ie++;var Js=!1;hi.flush(H,function(){Js=!0,rn()},pe)||Js||(H&&xt==null?xt=ja(function(){xt=null,rn()},ke):rn())}})}return it=!0,rn(),!0}function ht(){!s&&N[G1](),nt(e[vu](function(H){var le=H.cfg.disableDbgExt;le===!0&&b&&(s[$1](b),b=null),s&&!b&&le!==!0&&(b=Nbe(H.cfg),s[V1](b))}))}function We(){nt(e[vu](function(H){var le=H.cfg.enablePerfMgr;!le&&c&&(c=null),le&&jR(H.cfg,JO,rWe)}))}function Ct(H){var le=ck(te(),N);le[AR](E),(!N._updateHook||N._updateHook(le,H)!==!0)&&le[xo](H)}function xr(H){var le=N[mn];le?(Me(le,2,73,H),E()):ci(H)}function ye(H){var le=N[G1]();le&&le[cg]([H],2)}function nt(H){_.add(H)}})}return t.__ieDyn=1,t}()});var Od,sWe,R_e,MW,zy,k_e=R(()=>{Ho();rS();vt();yn();cW();_l();dg();kd();Od="",sWe="NoResponseBody",R_e="&"+sWe+"=true",MW="POST",zy=function(){function t(){var e=0,r,n,o,s,a,c,u,l,d,p,f,m,h;nr(t,this,function(g,v){var y=!0;ee(),g[xf]=function(N,E){o=E,n&&Me(o,1,28,"Sender is already initialized"),g.SetConfig(N),n=!0},g._getDbgPlgTargets=function(){return[n,s,c,r]},g.SetConfig=function(N){try{if(a=N.senderOnCompleteCallBack||{},c=!!N.disableCredentials,s=!!N.isOneDs,r=!!N.enableSendPromise,l=!!N.disableXhr,d=!!N.disableBeacon,p=!!N.disableBeaconSync,h=N.timeWrapper,m=!!N.addNoResponse,f=!!N.disableFetchKeepAlive,u={sendPOST:z},s||(y=!1),c){var E=Ny();E&&E.protocol&&E.protocol[Va]()==="file:"&&(y=!1)}return!0}catch{}return!1},g.getSyncFetchPayload=function(){return e},g.getSenderInst=function(N,E){return N&&N[at]?I(N,E):null},g.getFallbackInst=function(){return u},g[rg]=function(N,E){ee()};function _(N,E){w(E,200,{},N)}function b(N,E){Me(o,2,26,"Failed to send telemetry.",{message:N}),w(E,400,{})}function S(N){b("No endpoint url is provided for the batch",N)}function I(N,E){for(var P,q=0,F=null,Z=0;F==null&&Z<N[at];)q=N[Z],!l&&q===1?HR()?F=re:aS()&&(F=z):q===2&&If(E)&&(!E||!f)?F=M:q===3&&Xa()&&(E?!p:!d)&&(F=U),Z++;return F?(P={_transport:q,_isSync:E},P[T$]=F,P):null}function w(N,E,P,q){try{N&&N(E,P,q)}catch{}}function O(N,E){var P=ro(),q=N[K1];if(!q)return S(E),!0;q=N[K1]+(m?R_e:Od);var F=N[ig],Z=s?F:new Blob([F],{type:"text/plain;charset=UTF-8"}),ue=P.sendBeacon(q,Z);return ue}function U(N,E,P){var q=N[ig];try{if(q)if(O(N,E))_(Od,E);else{var F=a&&a.beaconOnRetry;F&&pt(F)?F(N,E,O):(u&&u[T$](N,E,!0),Me(o,2,40,". Failed to send telemetry with Beacon API, retried with normal sender."))}}catch(Z){s&&fa(o,"Failed to send telemetry using sendBeacon API. Ex:"+Ve(Z)),w(E,s?0:400,{},Od)}}function z(N,E,P){var q,F,Z,ue=N[WO]||{};!P&&r&&(q=pa(function(ne,ht){F=ne,Z=ht})),s&&P&&N.disableXhrSync&&(P=!1);var te=N[K1];if(!te){S(E),F&&F(!1);return}var Q=tW(MW,te,y,!0,P,N[Ay]);Q[E$]("Content-type","application/json"),_e(bo(ue),function(ne){Q[E$](ne,ue[ne])}),Q.onreadystatechange=function(){s||(je(Q),Q.readyState===4&&F&&F(!0))},Q.onload=function(){s&&je(Q)};function je(ne){var ht=a&&a.xhrOnComplete,We=ht&&pt(ht);if(We)ht(ne,E,N);else{var Ct=xl(ne);w(E,ne[Ry],wf(ne,s),Ct)}}return Q.onerror=function(ne){w(E,s?Q[Ry]:400,wf(Q,s),s?Od:Tf(Q)),Z&&Z(ne)},Q.ontimeout=function(){w(E,s?Q[Ry]:500,wf(Q,s),s?Od:Tf(Q)),F&&F(!1)},Q.send(N[ig]),q}function M(N,E,P){var q,F=N[K1],Z=N[ig],ue=s?Z:new Blob([Z],{type:"application/json"}),te,Q,je,ne=new Headers,ht=Z[at],We=!1,Ct=!1,xr=N[WO]||{},ye=(q={method:MW,body:ue},q[aW]=!0,q);N.headers&&bo(N.headers)[at]>0&&(_e(bo(xr),function(pe){ne.append(pe,xr[pe])}),ye[WO]=ne),y&&s&&(ye.credentials="include"),P&&(ye.keepalive=!0,e+=ht,s?N._sendReason===2&&(We=!0,m&&(F+=R_e)):We=!0);var nt=new Request(F,ye);try{nt[aW]=!0}catch{}if(!P&&r&&(te=pa(function(pe,ke){Q=pe,je=ke})),!F){S(E),Q&&Q(!1);return}function H(pe){w(E,s?0:400,{},s?Od:pe)}function le(pe,ke,Ie){var it=pe[Ry],xt=a.fetchOnComplete;xt&&pt(xt)?xt(pe,E,Ie||Od,ke):w(E,it,{},Ie||Od)}try{sg(fetch(s?F:nt,s?ye:null),function(pe){if(P&&(e-=ht,ht=0),!Ct)if(Ct=!0,pe.rejected)H(pe.reason&&pe.reason[Ed]),je&&je(pe.reason);else{var ke=pe.value;try{!s&&!ke.ok?(H(ke.statusText),Q&&Q(!1)):s&&!ke.body?(le(ke,null,Od),Q&&Q(!0)):sg(ke.text(),function(Ie){le(ke,N,Ie.value),Q&&Q(!0)})}catch(Ie){H(Ve(Ie)),je&&je(Ie)}}})}catch(pe){Ct||(H(Ve(pe)),je&&je(pe))}return We&&!Ct&&(Ct=!0,w(E,200,{}),Q&&Q(!0)),s&&!Ct&&N[Ay]>0&&h&&h.set(function(){Ct||(Ct=!0,w(E,500,{}),Q&&Q(!0))},N[Ay]),te}function re(N,E,P){var q=li(),F=new XDomainRequest,Z=N[ig];F.onload=function(){var ne=xl(F),ht=a&&a.xdrOnComplete;ht&&pt(ht)?ht(F,E,N):w(E,200,{},ne)},F.onerror=function(){w(E,400,{},s?Od:My(F))},F.ontimeout=function(){w(E,500,{})},F.onprogress=function(){};var ue=q&&q.location&&q.location[GO]||"",te=N[K1];if(!te){S(E);return}if(!s&&te.lastIndexOf(ue,0)!==0){var Q="Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol.";Me(o,2,40,". "+Q),b(Q,E);return}var je=s?te:te[vl](/^(https?:)/,"");F.open(MW,je),N[Ay]&&(F[Ay]=N[Ay]),F.send(Z),s&&P?h&&h.set(function(){F.send(Z)},0):F.send(Z)}function ee(){e=0,n=!1,r=!1,o=null,s=null,a=null,c=null,u=null,l=!1,d=!1,p=!1,f=!1,m=!1,h=null}})}return t.__ieDyn=1,t}()});function L_e(t){return t&&t[vl]?t[vl](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,Rt):t}function A3(t,e){var r;if(e){var n=Rt;et(e)?(n=Rt,_e(e,function(s){s=L_e(s),s&&(s[0]!=="."&&(s="."+s),n+=s)})):n=L_e(e),n&&(n[0]!=="."&&(n="."+n),t=(t||Rt)+n)}var o=lWe.exec(t||Rt)||[];return r={},r[Ya]=o[1],r.ns=(o[2]||Rt).replace(aWe,".").replace(cWe,Rt)[yu](".").sort().join("."),r}function FW(t,e,r){var n=[],o=lk.get(t,R3,{},!1),s=A3(e,r);return Ye(o,function(a,c){_e(c,function(u){var l;(!s[Ya]||s[Ya]===u.evtName[Ya])&&(!s.ns||s.ns===s.ns)&&n[ar]((l={},l[js]=u.evtName[Ya]+(u.evtName.ns?"."+u.evtName.ns:Rt),l.handler=u[DR],l))})}),n}function j_e(t,e,r){r===void 0&&(r=!0);var n=lk.get(t,R3,{},r),o=n[e];return o||(o=n[e]=[]),o}function z_e(t,e,r,n){t&&e&&e[Ya]&&(t[N_e]?t[N_e](e[Ya],r,n):t[D_e]&&t[D_e](M_e+e[Ya],r))}function dWe(t,e,r,n){var o=!1;return t&&e&&e[Ya]&&r&&(t[P_e]?(t[P_e](e[Ya],r,n),o=!0):t[A_e]&&(t[A_e](M_e+e[Ya],r),o=!0)),o}function O_e(t,e,r,n){for(var o=e[at];o--;){var s=e[o];s&&(!r.ns||r.ns===s.evtName.ns)&&(!n||n(s))&&(z_e(t,s.evtName,s[DR],s.capture),e[Id](o,1))}}function pWe(t,e,r){if(e[Ya])O_e(t,j_e(t,e[Ya]),e,r);else{var n=lk.get(t,R3,{});Ye(n,function(o,s){O_e(t,s,e,r)}),bo(n)[at]===0&&lk.kill(t,R3)}}function wc(t,e){var r;return e?(et(e)?r=[t].concat(e):r=[t,e],r=A3("xx",r).ns[yu](".")):r=t,r}function Md(t,e,r,n,o){var s;o===void 0&&(o=!1);var a=!1;if(t)try{var c=A3(e,n);if(a=dWe(t,c,r,o),a&&lk.accept(t)){var u=(s={guid:uWe++,evtName:c},s[DR]=r,s.capture=o,s);j_e(t,c.type)[ar](u)}}catch{}return a}function Of(t,e,r,n,o){if(o===void 0&&(o=!1),t)try{var s=A3(e,n),a=!1;pWe(t,s,function(c){return s.ns&&!r||c[DR]===r?(a=!0,!0):!1}),a||z_e(t,s,r,o)}catch{}}function UW(t,e,r,n){return n===void 0&&(n=!1),Md(t,e,r,null,n)}function BW(t,e,r,n){n===void 0&&(n=!1),Of(t,e,r,null,n)}function P3(t,e,r){var n=!1,o=li();o&&(n=Md(o,t,e,r),n=Md(o.body,t,e,r)||n);var s=ui();return s&&(n=Md(s,t,e,r)||n),n}function D3(t,e,r){var n=li();n&&(Of(n,t,e,r),Of(n.body,t,e,r));var o=ui();o&&Of(o,t,e,r)}function vS(t,e,r,n){var o=!1;return e&&t&&t[at]>0&&_e(t,function(s){s&&(!r||wr(r,s)===-1)&&(o=P3(s,e,n)||o)}),o}function N3(t,e,r,n){var o=!1;return e&&t&&et(t)&&(o=vS(t,e,r,n),!o&&r&&r[at]>0&&(o=vS(t,e,null,n))),o}function _g(t,e,r){t&&et(t)&&_e(t,function(n){n&&D3(n,e,r)})}function dk(t,e,r){return N3([B_e,U_e,k3],t,e,r)}function pk(t,e){_g([B_e,U_e,k3],t,e)}function yS(t,e,r){function n(a){var c=ui();t&&c&&c.visibilityState==="hidden"&&t(a)}var o=wc(q_e,r),s=vS([k3],t,e,o);return(!e||wr(e,uk)===-1)&&(s=vS([uk],n,e,o)||s),!s&&e&&(s=yS(t,null,r)),s}function fk(t,e){var r=wc(q_e,e);_g([k3],t,r),_g([uk],null,r)}function bS(t,e,r){function n(a){var c=ui();t&&c&&c.visibilityState==="visible"&&t(a)}var o=wc(H_e,r),s=vS([F_e],t,e,o);return s=vS([uk],n,e,o)||s,!s&&e&&(s=bS(t,null,r)),s}function mk(t,e){var r=wc(H_e,e);_g([F_e],t,r),_g([uk],null,r)}var M_e,A_e,P_e,D_e,N_e,R3,uk,k3,F_e,U_e,B_e,q_e,H_e,aWe,cWe,uWe,lk,lWe,G_e=R(()=>{vt();yn();lS();io();M_e="on",A_e="attachEvent",P_e="addEventListener",D_e="detachEvent",N_e="removeEventListener",R3="events",uk="visibilitychange",k3="pagehide",F_e="pageshow",U_e="unload",B_e="beforeunload",q_e=gs("aiEvtPageHide"),H_e=gs("aiEvtPageShow"),aWe=/\.[\.]+/g,cWe=/[\.]+$/,uWe=1,lk=u3("events"),lWe=/^([^.]*)(?:\.(.+)|)/});var qW,V_e=R(()=>{qO();qW=no({DISABLED:0,CRITICAL:1,WARNING:2,DEBUG:3})});var Vr=R(()=>{mbe();hbe();w_e();NW();c3();IW();sW();kd();k_e();vt();qO();G_e();dg();Ga();bW();x3();_l();T3();V_e();yW();lS();E3();EW();fg();f3();lW()});var Fd,$_e,HW,L3,O3=R(()=>{Fd="",$_e="https://browser.events.data.microsoft.com/OneCollector/1.0/",HW="version",L3="properties"});var jW,zW,_S,Ud,GW,Qn,Gy,Mf,M3,F3,U3,B3,hk,q3=R(()=>{jW="initialize",zW="logger",_S="indexOf",Ud="timings",GW="pollInternalLogs",Qn="value",Gy="kind",Mf="length",M3="processTelemetryStart",F3="handleField",U3="rmSanitizer",B3="rmFieldSanitizer",hk="canHandle"});function jo(t){return!(t===Fd||Te(t))}function H3(t){if(t){var e=da(t,"-");if(e>-1)return $h(t,e)}return Fd}function X_e(){return VW===null&&(VW=!wt(Uint8Array)&&!vWe()&&!ug()),VW}function j3(t){return!!(t&&Bs(t)&&t>=1&&t<=4)}function z3(t,e,r){if(!e&&!jo(e)||typeof t!="string")return null;var n=typeof e;if(n==="string"||n==="number"||n==="boolean"||et(e))e={value:e};else if(n==="object"&&!K_e.call(e,"value"))e={value:r?JSON.stringify(e):e};else if(Te(e[Qn])||e[Qn]===Fd||!Ot(e[Qn])&&!Bs(e[Qn])&&!ul(e[Qn])&&!et(e[Qn]))return null;if(et(e[Qn])&&!WW(e[Qn]))return null;if(!Te(e[Gy])){if(et(e[Qn])||!gk(e[Gy]))return null;e[Qn]=e[Qn].toString()}return e}function SS(t,e,r){var n=-1;if(!wt(t))if(e>0&&(e===32?n=8192:e<=13&&(n=e<<5)),gWe(r))n===-1&&(n=0),n|=r;else{var o=hWe[Bd(t)]||-1;n!==-1&&o!==-1?n|=o:o===6&&(n=o)}return n}function J_e(t,e,r){r===void 0&&(r=!0);var n;return t&&(n=t.get(e),r&&n&&decodeURIComponent&&(n=decodeURIComponent(n))),n||Fd}function Z_e(t){t===void 0&&(t="D");var e=nk();return t==="B"?e="{"+e+"}":t==="P"?e="("+e+")":t==="N"&&(e=e.replace(/-/g,Fd)),e}function Vy(t,e,r,n,o){var s={},a=!1,c=0,u=arguments[Mf],l=arguments;for(ul(l[0])&&(a=l[0],c++);c<u;c++){var t=l[c];Ye(t,function(p,f){a&&f&&Tn(f)?et(f)?(s[p]=s[p]||[],_e(f,function(m,h){m&&Tn(m)?s[p][h]=Vy(!0,s[p][h],m):s[p][h]=m})):s[p]=Vy(!0,s[p],f):s[p]=f})}return s}function gk(t){return t===0||t>0&&t<=13||t===32}function gWe(t){return t>=0&&t<=9}function vWe(){var t=ro();if(!wt(t)&&t.userAgent){var e=t.userAgent.toLowerCase();if((e[_S]("safari")>=0||e[_S]("firefox")>=0)&&e[_S]("chrome")<0)return!0}return!1}function WW(t){return t[Mf]>0}function vk(t,e){var r=t;r[Ud]=r[Ud]||{},r[Ud][M3]=r[Ud][M3]||{},r[Ud][M3][e]=Ja()}function Bd(t){var e=0;if(t!=null){var r=typeof t;r==="string"?e=1:r==="number"?e=2:r==="boolean"?e=3:r===pf&&(e=4,et(t)?(e=4096,t[Mf]>0&&(e|=Bd(t[0]))):K_e.call(t,"value")&&(e=8192|Bd(t[Qn])))}return e}function G3(){return!!Zr("chrome")}function exe(t,e,r,n,o,s){n===void 0&&(n=!1),o===void 0&&(o=!1);function a(u,l,d){try{u[l]=d}catch{}}var c=new XMLHttpRequest;return n&&a(c,fWe,n),r&&a(c,W_e,r),c.open(t,e,!o),r&&a(c,W_e,r),!o&&s&&a(c,mWe,s),c}function xg(t){return t>0}var Ff,$W,xS,K_e,fWe,W_e,mWe,hWe,VW,Y_e,Q_e,Ja,V3=R(()=>{Vr();Ga();vt();O3();q3();$W="4.1.1",xS="1DS-Web-JS-"+$W,K_e=hR.hasOwnProperty,fWe="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",W_e="withCredentials",mWe="timeout",hWe=(Ff={},Ff[0]=0,Ff[2]=6,Ff[1]=1,Ff[3]=7,Ff[4098]=6,Ff[4097]=1,Ff[4099]=7,Ff),VW=null,Y_e=Wh(),Q_e=Kh();Ja=H1});function bWe(t){return t&&(!t.getProperty||!t.setProperty)&&ci("Invalid property storage override passed."),!0}var yWe,txe,rxe=R(()=>{Ga();Ho();Vr();vt();O3();V3();q3();yWe=la({endpointUrl:$_e,propertyStorageOverride:{isVal:bWe}});txe=function(t){za(e,t);function e(){var r=t.call(this)||this;return nr(e,r,function(n,o){n[jW]=function(s,a,c,u){Ri(n,function(){return"AppInsightsCore.initialize"},function(){try{o[jW](Yn(s,yWe,c||n[zW],!1).cfg,a,c,u)}catch(p){var l=n[zW],d=Ve(p);d[_S]("channels")!==-1&&(d+=`
 - Channels must be provided through config.channels only!`),Me(l,1,514,"SDK Initialization Failed - no telemetry will be sent: "+d)}},function(){return{config:s,extensions:a,logger:c,notificationManager:u}})},n.track=function(s){Ri(n,function(){return"AppInsightsCore.track"},function(){var a=s;if(a){a[Ud]=a[Ud]||{},a[Ud].trackStart=Ja(),j3(a.latency)||(a.latency=1);var c=a.ext=a.ext||{};c.sdk=c.sdk||{},c.sdk.ver=xS;var u=a.baseData=a.baseData||{};u[L3]=u[L3]||{};var l=u[L3];l[HW]=l[HW]||n.pluginVersionString||Fd}o.track(a)},function(){return{item:s}},!s.sync)},n[GW]=function(s){return o[GW](s||"InternalLog")}}),r}return e.__ieDyn=1,e}(Lf)});var nxe,ixe,oxe,sxe,axe,cxe=R(()=>{Vr();nxe=no({NotSet:0,Pii_DistinguishedName:1,Pii_GenericData:2,Pii_IPV4Address:3,Pii_IPv6Address:4,Pii_MailSubject:5,Pii_PhoneNumber:6,Pii_QueryString:7,Pii_SipAddress:8,Pii_SmtpAddress:9,Pii_Identity:10,Pii_Uri:11,Pii_Fqdn:12,Pii_IPV4AddressLegacy:13,Pii_IPv6ScrubLastHextets:14,Pii_DropValue:15,CustomerContent_GenericContent:32}),ixe=no({Normal:1,CostDeferred:2,RealTime:3,Immediate:4}),oxe=no({Unspecified:0,String:1,Int32:2,UInt32:3,Int64:4,UInt64:5,Double:6,Bool:7,Guid:8,DateTime:9}),sxe=no({Normal:1,Critical:2}),axe=no({NONE:0,ERROR:1,WARNING:2,INFORMATION:3})});var uxe,lxe=R(()=>{Vr();vt();O3();V3();q3();uxe=function(){function t(e){var r=this,n={},o=[],s=[];e&&s.push(e);function a(d,p){var f,m=n[d];if(m&&(f=m[p]),!f&&f!==null){if(Ot(d)&&Ot(p))if(s[Mf]>0){for(var h=0;h<s[Mf];h++)if(s[h][F3](d,p)){f={canHandle:!0,fieldHandler:s[h]};break}}else o[Mf]===0&&(f={canHandle:!0});if(!f&&f!==null){f=null;for(var h=0;h<o[Mf];h++)if(o[h][F3](d,p)){f={canHandle:!0,handler:o[h],fieldHandler:null};break}}m||(m=n[d]={}),m[p]=f}return f}r.clearCache=function(){n={}},r.addSanitizer=function(d){d&&(wO(o,d)||o.push(d),n={})},r.addFieldSanitizer=function(d){d&&(wO(s,d)||s.push(d),n={})},r[U3]=function(d){if(d){var p=wr(o,d);p!==-1&&(o.splice(p,1),n={}),_e(o,function(f){f&&f[U3]&&f[U3](d)})}},r[B3]=function(d){if(d){var p=wr(s,d);p!==-1&&(s.splice(p,1),n={}),_e(o,function(f){f&&f[B3]&&f[B3](d)})}},r.isEmpty=function(){return q1(o)+q1(s)===0},r[F3]=function(d,p){var f=a(d,p);return f?f[hk]:!1},r[Qn]=function(d,p,f,m){var h=a(d,p);if(h&&h[hk]){if(!h||!h[hk])return null;if(h.handler)return h.handler[Qn](d,p,f,m);if(!Ot(p)||Te(f)||f===Fd)return null;var g=null,v=Bd(f);if((v&8192)===8192){var y=v&-8193;if(g=f,!jo(g[Qn])||y!==1&&y!==2&&y!==3&&(y&4096)!==4096)return null}else v===1||v===2||v===3||(v&4096)===4096?g=u(d,p,f):v===4&&(g=u(d,p,m?JSON.stringify(f):f));if(g)return c(h,d,p,v,g,m)}return null},r.property=function(d,p,f,m){var h=a(d,p);if(!h||!h[hk]||!Ot(p)||Te(f)||!jo(f[Qn]))return null;var g=Bd(f[Qn]);return g===0?null:c(h,d,p,g,f,m)};function c(d,p,f,m,h,g){if(d.handler)return d.handler.property(p,f,h,g);if(!Te(h[Gy])){if((m&4096)===4096||!gk(h[Gy]))return null;h[Qn]=h[Qn].toString()}return l(d.fieldHandler,p,f,m,h)}function u(d,p,f){return jo(f)?{value:f}:null}function l(d,p,f,m,h){if(h&&d){var g=d.getSanitizer(p,f,m,h[Gy],h.propertyType);if(g)if(m===4){var v={},y=h[Qn];Ye(y,function(b,S){var I=p+"."+f;if(jo(S)){var w=u(I,b,S);w=l(d,I,b,Bd(S),w),w&&(v[b]=w[Qn])}}),h[Qn]=v}else{var _={path:p,name:f,type:m,prop:h,sanitizer:r};h=g.call(r,_)}}return h}}return t.getFieldType=Bd,t}()});var dxe={};dn(dxe,{AppInsightsCore:()=>txe,BaseTelemetryPlugin:()=>Nf,DiagnosticLogger:()=>pg,EventLatency:()=>ixe,EventPersistence:()=>sxe,EventPropertyType:()=>oxe,EventsDiscardedReason:()=>ml,FullVersionString:()=>xS,InternalAppInsightsCore:()=>Lf,LoggingSeverity:()=>qW,MinChannelPriorty:()=>v$,NotificationManager:()=>ek,PerfEvent:()=>By,PerfManager:()=>rk,ProcessTelemetryContext:()=>AW,SenderPostManager:()=>zy,TraceLevel:()=>axe,Undefined:()=>_d,ValueKind:()=>nxe,ValueSanitizer:()=>uxe,Version:()=>$W,_InternalLogMessage:()=>Ly,__getRegisteredEvents:()=>FW,_appendHeader:()=>uS,_getAllResponseHeaders:()=>wf,_logInternalMessage:()=>J$,_throwInternal:()=>Me,_warnToConsole:()=>fa,addEventHandler:()=>P3,addEventListeners:()=>N3,addPageHideEventListener:()=>yS,addPageShowEventListener:()=>bS,addPageUnloadEventListener:()=>dk,areCookiesSupported:()=>fS,arrForEach:()=>_e,arrIndexOf:()=>wr,arrMap:()=>Sd,arrReduce:()=>B1,attachEvent:()=>UW,blockDynamicConversion:()=>YR,convertAllHeadersToMap:()=>a3,cookieAvailable:()=>fS,createCookieMgr:()=>Af,createDynamicConfig:()=>Yn,createEnumStyle:()=>no,createGuid:()=>Z_e,createProcessTelemetryContext:()=>ma,createTraceParent:()=>ik,createUniqueNamespace:()=>gs,createUnloadHandlerContainer:()=>jy,dateNow:()=>di,detachEvent:()=>BW,disallowsSameSiteNone:()=>_3,doPerf:()=>Ri,dumpObj:()=>Ve,eventOff:()=>Of,eventOn:()=>Md,extend:()=>Vy,findW3cTraceParent:()=>ak,forceDynamicConversion:()=>oW,formatErrorMessageXdr:()=>My,formatErrorMessageXhr:()=>Tf,formatTraceParent:()=>sk,generateW3CId:()=>qy,getCommonSchemaMetaData:()=>SS,getConsole:()=>FR,getCookieValue:()=>J_e,getCrypto:()=>UR,getDocument:()=>ui,getDynamicConfigHandler:()=>KR,getExceptionName:()=>En,getFieldValueType:()=>Bd,getGlobal:()=>qs,getGlobalInst:()=>Zr,getHistory:()=>CR,getIEVersion:()=>qR,getISOString:()=>Tc,getJSON:()=>hs,getLocation:()=>Ny,getMsCrypto:()=>BR,getNavigator:()=>ro,getPerformance:()=>yf,getResponseText:()=>xl,getSetValue:()=>jR,getTenantId:()=>H3,getTime:()=>Ja,getWindow:()=>li,hasDocument:()=>Wh,hasHistory:()=>xO,hasJSON:()=>Rd,hasNavigator:()=>U1,hasOwnProperty:()=>Fi,hasWindow:()=>Kh,isArray:()=>et,isArrayValid:()=>WW,isBeaconsSupported:()=>Xa,isBoolean:()=>ul,isChromium:()=>G3,isDate:()=>L1,isDocumentObjectAvailable:()=>Y_e,isError:()=>Hh,isFetchSupported:()=>If,isFunction:()=>pt,isGreaterThanZero:()=>xg,isIE:()=>lg,isLatency:()=>j3,isNotTruthy:()=>cO,isNullOrUndefined:()=>Te,isNumber:()=>Bs,isObject:()=>Tn,isReactNative:()=>ug,isSampledFlag:()=>ok,isString:()=>Ot,isTruthy:()=>du,isTypeof:()=>sO,isUint8ArrayAvailable:()=>X_e,isUndefined:()=>wt,isValidSpanId:()=>Ld,isValidTraceId:()=>Nd,isValidTraceParent:()=>hS,isValueAssigned:()=>jo,isValueKind:()=>gk,isWindowObjectAvailable:()=>Q_e,isXhrSupported:()=>aS,mergeEvtNamespace:()=>wc,newGuid:()=>nk,newId:()=>$R,normalizeJsName:()=>Oy,objDefineAccessors:()=>_O,objForEachKey:()=>Ye,objFreeze:()=>xd,objKeys:()=>bo,objSeal:()=>pO,onConfigChange:()=>oo,openXhr:()=>exe,optimizeObject:()=>_u,parseResponse:()=>Fy,parseTraceParent:()=>Hy,perfNow:()=>H1,prependTransports:()=>Ef,proxyAssign:()=>Z$,proxyFunctionAs:()=>Cf,proxyFunctions:()=>Ec,random32:()=>Rf,randomValue:()=>VR,removeEventHandler:()=>D3,removeEventListeners:()=>_g,removePageHideEventListener:()=>fk,removePageShowEventListener:()=>mk,removePageUnloadEventListener:()=>pk,safeGetCookieMgr:()=>vW,safeGetLogger:()=>bl,sanitizeProperty:()=>z3,setEnableEnvMocks:()=>W$,setProcessTelemetryTimings:()=>vk,setValue:()=>bu,strContains:()=>Ui,strEndsWith:()=>Qh,strFunction:()=>R1,strObject:()=>pf,strPrototype:()=>cl,strStartsWith:()=>xy,strTrim:()=>Nr,strUndefined:()=>_d,throwError:()=>ci,toISOString:()=>Tc,useXDomainRequest:()=>HR});var $y=R(()=>{rxe();cxe();lxe();Vr();V3()});var Wy,$3,W3,KW=R(()=>{Wy="REAL_TIME",$3="NEAR_REAL_TIME",W3="BEST_EFFORT"});var Sl,K3,pxe,YW,fxe,mxe,hxe,QW,XW,Y3,gxe,vxe,yxe,Q3,JW,X3,J3,Z3,yk,ZW,eK,bxe,IS,tK,e5,bk=R(()=>{Sl="",K3="drop",pxe="send",YW="requeue",fxe="rspFail",mxe="oth",hxe="no-cache, no-store",QW="application/x-json-stream",XW="cache-control",Y3="content-type",gxe="kill-tokens",vxe="kill-duration",yxe="time-delta-millis",Q3="client-version",JW="client-id",X3="time-delta-to-apply-millis",J3="upload-time",Z3="apikey",yk="AuthMsaDeviceTicket",ZW="WebAuthToken",eK="AuthXToken",bxe="NoResponseBody",IS="msfpc",tK="trace",e5="user"});var _k,t5,r5,n5,xk,Qt,qd,Su,Bi,Hd,zo,jd,Ky,i5,Sg,o5,Yy,s5,a5,_xe,rK,nK,xxe,Sxe,c5,iK,oK,Ixe,Cxe,sK,aK,Txe,u5,l5,cK,Qy,CS,uK,zs,Za,Sk,Ik,TS,d5,Ck,Exe,p5,f5,ES,lK,Tk,m5,h5,wS,g5,v5,y5,Ek,wxe,Rxe,dK,pK,kxe,Axe,Pxe,b5,wk,Ig,Xy,RS=R(()=>{_k="allowRequestSending",t5="firstRequestSent",r5="shouldAddClockSkewHeaders",n5="getClockSkewHeaderValue",xk="setClockSkew",Qt="length",qd="concat",Su="iKey",Bi="count",Hd="events",zo="push",jd="split",Ky="splice",i5="toLowerCase",Sg="hdrs",o5="useHdrs",Yy="initialize",s5="setTimeoutOverride",a5="clearTimeoutOverride",_xe="payloadPreprocessor",rK="overrideEndpointUrl",nK="avoidOptions",xxe="disableEventTimings",Sxe="stringifyObjects",c5="enableCompoundKey",iK="disableXhrSync",oK="disableFetchKeepAlive",Ixe="addNoResponse",Cxe="excludeCsMetaData",sK="useSendBeacon",aK="alwaysUseXhrOverride",Txe="unloadTransports",u5="serializeOfflineEvt",l5="getOfflineRequestDetails",cK="createPayload",Qy="headers",CS="_thePayload",uK="urlString",zs="batches",Za="sendType",Sk="addHeader",Ik="canSendRequest",TS="sendQueuedRequests",d5="isCompletelyIdle",Ck="setUnloading",Exe="isTenantKilled",p5="sendSynchronousBatch",f5="_transport",ES="getWParam",lK="isBeacon",Tk="timings",m5="isTeardown",h5="isSync",wS="data",g5="_sendReason",v5="setKillSwitchTenants",y5="_backOffTransmission",Ek="identifier",wxe="disableOptimizeObj",Rxe="ignoreMc1Ms0CookieProcessing",dK="eventsLimitInMem",pK="autoFlushEventsLimit",kxe="disableAutoBatchFlushLimit",Axe="overrideInstrumentationKey",Pxe="disableTelemetry",b5="baseData",wk="sendAttempt",Ig="latency",Xy="sync"});function Nxe(t){var e=(t.ext||{}).intweb;return e&&jo(e[IS])?e[IS]:null}function Dxe(t){for(var e=null,r=0;e===null&&r<t[Qt];r++)e=Nxe(t[r]);return e}var kS,fK=R(()=>{$y();bk();RS();kS=function(){function t(e,r){var n=r?[][qd](r):[],o=this,s=Dxe(n);o[Su]=function(){return e},o.Msfpc=function(){return s||Sl},o[Bi]=function(){return n[Qt]},o[Hd]=function(){return n},o.addEvent=function(a){return a?(n[zo](a),s||(s=Nxe(a)),!0):!1},o[jd]=function(a,c){var u;if(a<n[Qt]){var l=n[Qt]-a;Te(c)||(l=c<l?c:l),u=n[Ky](a,l),s=Dxe(n)}return new t(e,u)}}return t.create=function(e,r){return new t(e,r)},t}()});var Lxe,Oxe=R(()=>{Ho();RS();Lxe=function(){function t(){var e=!0,r=!0,n=!0,o="use-collector-delta",s=!1;nr(t,this,function(a){a[_k]=function(){return e},a[t5]=function(){n&&(n=!1,s||(e=!1))},a[r5]=function(){return r},a[n5]=function(){return o},a[xk]=function(c){s||(c?(o=c,r=!0,s=!0):r=!1,e=!0)}})}return t.__ieDyn=1,t}()});var _We,Mxe,Fxe=R(()=>{Ho();$y();RS();_We=1e3,Mxe=function(){function t(){var e={};function r(n){var o=[];return n&&_e(n,function(s){o[zo](Nr(s))}),o}nr(t,this,function(n){n[v5]=function(o,s){if(o&&s)try{var a=r(o[jd](","));if(s==="this-request-only")return a;for(var c=parseInt(s,10)*_We,u=0;u<a[Qt];++u)e[a[u]]=di()+c}catch{return[]}return[]},n[Exe]=function(o){var s=e,a=Nr(o);return s[a]!==void 0&&s[a]>di()?!0:(delete s[a],!1)}})}return t.__ieDyn=1,t}()});function Bxe(t){return!(t>=300&&t<500&&t!=429||t==501||t==505)}function _5(t){var e=0,r=Uxe*xWe,n=Uxe*SWe,o=Math.floor(Math.random()*(n-r))+r;return e=Math.pow(2,t)*o,Math.min(e,IWe)}var xWe,SWe,Uxe,IWe,mK=R(()=>{xWe=.8,SWe=1.2,Uxe=3e3,IWe=6e5});function RWe(t,e,r,n,o){if(o&&e){var s=t(o.value,o.kind,o.propertyType);if(s>-1){var a=e[qxe];a||(a=e[qxe]={f:{}});var c=a[x5];if(c||(c=a[x5]={}),r)for(var u=0;u<r.length;u++){var l=r[u];c[l]||(c[l]={f:{}});var d=c[l][x5];d||(d=c[l][x5]={}),c=d}c=c[n]={},et(o.value)?c.a={t:s}:c.t=s}}}var CWe,TWe,Hxe,jxe,EWe,qxe,x5,wWe,zxe,Gxe=R(()=>{Ho();$y();fK();bk();vt();CWe=20,TWe=3984588,Hxe=65e3,jxe=2e6,EWe=Math.min(jxe,Hxe),qxe="metadata",x5="f",wWe=/\./,zxe=function(){function t(e,r,n,o,s,a){var c="data",u="baseData",l="ext",d=!!o,p=!0,f=r,m={},h=!!a,g=s||SS;nr(t,this,function(v){v.createPayload=function(b,S,I,w,O,U){return{apiKeys:[],payloadBlob:Sl,overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:b,isTeardown:S,isSync:I,isBeacon:w,sendType:U,sendReason:O}},v.appendPayload=function(b,S,I){var w=b&&S&&!b.overflow;return w&&Ri(e,function(){return"Serializer:appendPayload"},function(){for(var O=S.events(),U=b.payloadBlob,z=b.numEvents,M=!1,re=[],ee=[],N=b.isBeacon,E=N?Hxe:TWe,P=N?EWe:jxe,q=0,F=0;q<O.length;){var Z=O[q];if(Z){if(z>=I){b.overflow=S.split(q);break}var ue=v.getEventBlob(Z);if(ue&&ue.length<=P){var te=ue.length,Q=U.length;if(Q+te>E){b.overflow=S.split(q);break}U&&(U+=`
`),U+=ue,F++,F>CWe&&(dl(U,0,1),F=0),M=!0,z++}else ue?re.push(Z):ee.push(Z),O.splice(q,1),q--}q++}if(re.length>0&&b.sizeExceed.push(kS.create(S.iKey(),re)),ee.length>0&&b.failedEvts.push(kS.create(S.iKey(),ee)),M){b.batches.push(S),b.payloadBlob=U,b.numEvents=z;var je=S.iKey();wr(b.apiKeys,je)===-1&&b.apiKeys.push(je)}},function(){return{payload:b,theBatch:{iKey:S.iKey(),evts:S.events()},max:I}}),w},v.getEventBlob=function(b){try{return Ri(e,function(){return"Serializer.getEventBlob"},function(){var S={};S.name=b.name,S.time=b.time,S.ver=b.ver,S.iKey="o:"+H3(b.iKey);var I={},w;h||(w=function(M,re,ee){RWe(g,I,M,re,ee)});var O=b[l];O&&(S[l]=I,Ye(O,function(M,re){var ee=I[M]={};_(re,ee,"ext."+M,!0,null,null,!0)}));var U=S[c]={};U.baseType=b.baseType;var z=U[u]={};return _(b.baseData,z,u,!1,[u],w,p),_(b.data,U,c,!1,[],w,p),JSON.stringify(S)},function(){return{item:b}})}catch{return null}};function y(b,S){var I=m[b];return I===void 0&&(b.length>=7&&(I=xy(b,"ext.metadata")||xy(b,"ext.web")),m[b]=I),I}function _(b,S,I,w,O,U,z){Ye(b,function(M,re){var ee=null;if(re||jo(re)){var N=I,E=M,P=O,q=S;if(d&&!w&&wWe.test(M)){var F=M.split("."),Z=F.length;if(Z>1){P&&(P=P.slice());for(var ue=0;ue<Z-1;ue++){var te=F[ue];q=q[te]=q[te]||{},N+="."+te,P&&P.push(te)}E=F[Z-1]}}var Q=w&&y(N,E);if(!Q&&f&&f.handleField(N,E)?ee=f.value(N,E,re,n):ee=z3(E,re,n),ee){var je=ee.value;if(q[E]=je,U&&U(P,E,ee),z&&typeof je=="object"&&!et(je)){var ne=P;ne&&(ne=ne.slice(),ne.push(E)),_(re,je,N+"."+E,w,ne,U,z)}}}})}})}return t.__ieDyn=1,t}()});function AS(t,e){return{set:function(r,n){for(var o=[],s=2;s<arguments.length;s++)o[s-2]=arguments[s];return n$([t,e],r,n,o)}}}var hK=R(()=>{vt()});function Zy(t,e,r){vK[t]=e,r!==!1&&(yK[e]=t)}function Vxe(t,e){var r=!1;if(t&&e){var n=bo(t);if(n&&n[Qt]>0)for(var o=e[i5](),s=0;s<n[Qt];s++){var a=n[s];if(a&&Fi(e,a)&&a[i5]()===o){r=!0;break}}}return r}function PS(t,e,r,n){e&&r&&r[Qt]>0&&(n&&vK[e]?(t[Sg][vK[e]]=r,t[o5]=!0):t.url+="&"+e+"="+r)}function DWe(t,e,r){for(var n=0;n<t[Qt];n++)if(t[n].name===e){t[n].value=r;return}t[zo]({name:e,value:r})}function NWe(t,e){for(var r=0;r<t[Qt];r++)if(t[r].name===e){t[Ky](r,1);return}}var Jy,gK,kWe,AWe,PWe,vK,yK,$xe,Wxe=R(()=>{Ho();$y();vt();Oxe();bk();Fxe();mK();Gxe();hK();RS();gK="sendAttempt",kWe="&"+bxe+"=true",AWe="?cors=true&"+Y3[i5]()+"="+QW,PWe=(Jy={},Jy[1]=YW,Jy[100]=YW,Jy[200]="sent",Jy[8004]=K3,Jy[8003]=K3,Jy),vK={},yK={};Zy(yk,yk,!1);Zy(Q3,Q3);Zy(JW,"Client-Id");Zy(Z3,Z3);Zy(X3,X3);Zy(J3,J3);Zy(eK,eK);$xe=function(){function t(e,r,n,o){var s,a,c,u,l=!1,d,p,f,m,h,g,v,y,_,b,S,I,w,O,U,z,M,re,ee,N,E,P,q,F,Z,ue,te;nr(t,this,function(Q){Ct();var je=!0;Q[Yy]=function(X,Ae,He){F||(h=Ae,I=Ae.getCookieMgr(),p=He,f=p.diagLog(),mu(N,oo(X,function(ut){var V,ae=ut.cfg,he=ut.cfg.extensionConfig[He.identifier];Z=AS(he[s5],he[a5]),jo(ae.anonCookieName)?DWe(v,"anoncknm",ae.anonCookieName):NWe(v,"anoncknm"),E=he[_xe],P=he.payloadListener;var Ce=he.httpXHROverride,G=he[rK]?he[rK]:ae.endpointUrl;s=G+AWe,O=wt(he[nK])?!0:!he[nK],S=!he[xxe];var J=he.valueSanitizer,de=he[Sxe],Ee=!!ae[c5];wt(he[c5])||(Ee=!!he[c5]),U=he.xhrTimeout,z=!!he[iK],M=!!he[oK],ee=he[Ixe]!==!1,ue=!!he[Cxe],Ae.getPlugin("LocalStorage")&&(M=!0),l=!ug(),b=new zxe(h,J,de,Ee,SS,ue),Te(he[sK])||(l=!!he[sK]);var Qe=ht();te?te.SetConfig(Qe):(te=new zy,te[Yy](Qe,f));var Ne=Ce,mr=he[aK]?Ce:null,Cr=he[aK]?Ce:null,zi=[3,2];if(!Ce){g=!1;var ac=[];ug()?(ac=[2,1],zi=[2,1,3]):ac=[1,2,3],ac=Ef(ac,he.transports),Ce=ne(ac,!1),Ce||fa(f,"No available transport to send events"),Ne=ne(ac,!0)}mr||(zi=Ef(zi,he[Txe]),mr=ne(zi,!0)),re=!g&&(l&&Xa()||!M&&If(!0)),m=(V={},V[0]=Ce,V[1]=Ne||ne([1,2,3],!0),V[2]=mr||Ne||ne([1],!0),V[3]=Cr||ne([2,3],!0)||Ne||ne([1],!0),V)})),F=!0)},Q.addResponseHandler=function(X){return q[zo](X),{rm:function(){var Ae=q.indexOf(X);Ae>=0&&q[Ky](Ae,1)}}},Q[u5]=function(X){try{if(b)return b.getEventBlob(X)}catch{}return Sl},Q[l5]=function(){try{var X=b&&b[cK](0,!1,!1,!1,1,0);return An(X,O)}catch{}return null};function ne(X,Ae){try{return te&&te.getSenderInst(X,Ae)}catch{}return null}Q._getDbgPlgTargets=function(){return[m[0],a,b,m]};function ht(){try{var X={xdrOnComplete:We,fetchOnComplete:xr,xhrOnComplete:ye,beaconOnRetry:H},Ae={enableSendPromise:!1,isOneDs:!0,disableCredentials:!je,disableXhr:!1,disableBeacon:!l,disableBeaconSync:!l,disableFetchKeepAlive:M,timeWrapper:Z,addNoResponse:ee,senderOnCompleteCallBack:X};return Ae}catch{}return null}function We(X,Ae,He){var ut=xl(X);nt(Ae,200,{},ut),Ul(ut)}function Ct(){var X;s=null,a=new Mxe,c=!1,u=new Lxe,l=!1,d=0,p=null,f=null,m=null,h=null,g=!0,v=[],y={},_=[],b=null,S=!1,I=null,w=!1,O=!1,U=X,z=X,M=X,re=X,ee=X,N=[],E=X,P=X,q=[],F=!1,Z=AS(),ue=!1,te=null}function xr(X,Ae,He,ut){var V=function(Ce,G,J){nt(Ae,Ce,G,J),Ul(J)},ae={},he=X[Qy];he&&he.forEach(function(Ce,G){ae[G]=Ce}),V(X.status,ae,He||Sl)}function ye(X,Ae,He){var ut=xl(X);nt(Ae,X.status,wf(X,!0),ut),Ul(ut)}function nt(X,Ae,He,ut){try{X(Ae,He,ut)}catch(V){Me(f,2,518,Ve(V))}}function H(X,Ae,He){var ut=X,V=200,ae=ut[CS],he=X[uK]+(ee?kWe:Sl);try{var Ce=ro();if(ae){var G=!!h.getPlugin("LocalStorage"),J=[],de=[];_e(ae[zs],function(Ee){if(J&&Ee&&Ee[Bi]()>0)for(var Qe=Ee[Hd](),Ne=0;Ne<Qe[Qt];Ne++)if(Ce.sendBeacon(he,b.getEventBlob(Qe[Ne])))de[zo](Ee[Ne]);else{J[zo](Ee[jd](Ne));break}else J[zo](Ee[jd](0))}),de[Qt]>0&&(ae.sentEvts=de),G||Ca(J,8003,ae[Za],!0)}else V=0}catch(Ee){fa(f,"Failed to send telemetry using sendBeacon API. Ex:"+Ve(Ee)),V=0}finally{nt(Ae,V,{},Sl)}}function le(X){return X===2||X===3}function pe(X){return w&&le(X)&&(X=2),X}Q[Sk]=function(X,Ae){y[X]=Ae},Q.removeHeader=function(X){delete y[X]},Q[Ik]=function(){return ke()&&u[_k]()},Q[TS]=function(X,Ae){wt(X)&&(X=0),w&&(X=pe(X),Ae=2),it(_,X,0)&&rn(Ie(),0,!1,X,Ae||0)},Q[d5]=function(){return!c&&d===0&&_[Qt]===0},Q[Ck]=function(X){w=X},Q.addBatch=function(X){if(X&&X[Bi]()>0){if(a.isTenantKilled(X[Su]()))return!1;_[zo](X)}return!0},Q.teardown=function(){_[Qt]>0&&rn(Ie(),0,!0,2,2),_e(N,function(X){X&&X.rm&&X.rm()}),N=[]},Q.pause=function(){c=!0},Q.resume=function(){c=!1,Q[TS](0,4)},Q[p5]=function(X,Ae,He){X&&X[Bi]()>0&&(Te(Ae)&&(Ae=1),w&&(Ae=pe(Ae),He=2),rn([X],0,!1,Ae,He||0))};function ke(){return!c&&d<r}function Ie(){var X=_;return _=[],X}function it(X,Ae,He){var ut=!1;return X&&X[Qt]>0&&!c&&m[Ae]&&b&&(ut=Ae!==0||ke()&&(He>0||u[_k]())),ut}function xt(X){var Ae={};return X&&_e(X,function(He,ut){Ae[ut]={iKey:He[Su](),evts:He[Hd]()}}),Ae}function rn(X,Ae,He,ut,V){if(!(!X||X[Qt]===0)){if(c){Ca(X,1,ut);return}ut=pe(ut);try{var ae=X,he=ut!==0;Ri(h,function(){return"HttpManager:_sendBatches"},function(Ce){Ce&&(X=X.slice(0));for(var G=[],J=null,de=Ja(),Ee=m[ut]||(he?m[1]:m[0]),Qe=Ee&&Ee[f5],Ne=re&&(w||le(ut)||Qe===3||Ee._isSync&&Qe===2);it(X,ut,Ae);){var mr=X.shift();mr&&mr[Bi]()>0&&(a.isTenantKilled(mr[Su]())?G[zo](mr):(J=J||b[cK](Ae,He,he,Ne,V,ut),b.appendPayload(J,mr,e)?J.overflow!==null&&(X=[J.overflow][qd](X),J.overflow=null,Js(J,de,Ja(),V),de=Ja(),J=null):(Js(J,de,Ja(),V),de=Ja(),X=[mr][qd](X),J=null)))}J&&Js(J,de,Ja(),V),X[Qt]>0&&(_=X[qd](_)),Ca(G,8004,ut)},function(){return{batches:xt(ae),retryCount:Ae,isTeardown:He,isSynchronous:he,sendReason:V,useSendBeacon:le(ut),sendType:ut}},!he)}catch(Ce){Me(f,2,48,"Unexpected Exception sending batch: "+Ve(Ce))}}}function An(X,Ae){var He={url:s,hdrs:{},useHdrs:!1};Ae?(He[Sg]=Vy(He[Sg],y),He.useHdrs=bo(He.hdrs)[Qt]>0):Ye(y,function(Ce,G){yK[Ce]?PS(He,yK[Ce],G,!1):(He[Sg][Ce]=G,He[o5]=!0)}),PS(He,JW,"NO_AUTH",Ae),PS(He,Q3,xS,Ae);var ut=Sl;_e(X.apiKeys,function(Ce){ut[Qt]>0&&(ut+=","),ut+=Ce}),PS(He,Z3,ut,Ae),PS(He,J3,di().toString(),Ae);var V=rE(X);if(jo(V)&&(He.url+="&ext.intweb.msfpc="+V),u[r5]()&&PS(He,X3,u[n5](),Ae),h[ES]){var ae=h[ES]();ae>=0&&(He.url+="&w="+ae)}for(var he=0;he<v[Qt];he++)He.url+="&"+v[he].name+"="+v[he].value;return He}function hi(X,Ae,He){X[Ae]=X[Ae]||{},X[Ae][p.identifier]=He}function Js(X,Ae,He,ut){if(X&&X.payloadBlob&&X.payloadBlob[Qt]>0){var V=!!E,ae=m[X.sendType];!le(X[Za])&&X[lK]&&X.sendReason===2&&(ae=m[2]||m[3]||ae);var he=O;(X.isBeacon||ae[f5]===3)&&(he=!1);var Ce=An(X,he);he=he||Ce[o5];var G=Ja();Ri(h,function(){return"HttpManager:_doPayloadSend"},function(){for(var J=0;J<X.batches[Qt];J++)for(var de=X[zs][J],Ee=de[Hd](),Qe=0;Qe<Ee[Qt];Qe++){var Ne=Ee[Qe];if(S){var mr=Ne[Tk]=Ne[Tk]||{};hi(mr,"sendEventStart",G),hi(mr,"serializationStart",Ae),hi(mr,"serializationCompleted",He)}Ne[gK]>0?Ne[gK]++:Ne[gK]=1}Ca(X[zs],1e3+(ut||0),X[Za],!0);var Cr={data:X.payloadBlob,urlString:Ce.url,headers:Ce[Sg],_thePayload:X,_sendReason:ut,timeout:U,disableXhrSync:z,disableFetchKeepAlive:M};he&&(Vxe(Cr[Qy],XW)||(Cr[Qy][XW]=hxe),Vxe(Cr[Qy],Y3)||(Cr[Qy][Y3]=QW));var zi=null;ae&&(zi=function(ac){u[t5]();var Em=function(wm,i0){l_(wm,i0,X,ut)},Zs=X[m5]||X[h5];try{ae.sendPOST(ac,Em,Zs),P&&P(Cr,ac,Zs,X[lK])}catch(wm){fa(f,"Unexpected exception sending payload. Ex:"+Ve(wm)),nt(Em,0,{})}}),Ri(h,function(){return"HttpManager:_doPayloadSend.sender"},function(){if(zi)if(X[Za]===0&&d++,V&&!X.isBeacon&&ae[f5]!==3){var ac={data:Cr[wS],urlString:Cr[uK],headers:Vy({},Cr[Qy]),timeout:Cr.timeout,disableXhrSync:Cr[iK],disableFetchKeepAlive:Cr[oK]},Em=!1;Ri(h,function(){return"HttpManager:_doPayloadSend.sendHook"},function(){try{E(ac,function(Zs){Em=!0,!g&&!Zs[CS]&&(Zs[CS]=Zs[CS]||Cr[CS],Zs[g5]=Zs[g5]||Cr[g5]),zi(Zs)},X.isSync||X[m5])}catch{Em||zi(Cr)}})}else zi(Cr)})},function(){return{thePayload:X,serializationStart:Ae,serializationCompleted:He,sendReason:ut}},X[h5])}X.sizeExceed&&X.sizeExceed[Qt]>0&&Ca(X.sizeExceed,8003,X[Za]),X.failedEvts&&X.failedEvts[Qt]>0&&Ca(X.failedEvts,8002,X[Za])}function wp(X,Ae){S&&_e(X,function(He){var ut=He[Tk]=He[Tk]||{};hi(ut,"sendEventCompleted",Ae)})}function l_(X,Ae,He,ut){var V=9e3,ae=null,he=!1,Ce=!1;try{var G=!0;if(typeof X!==_d){if(Ae){u[xk](Ae[yxe]);var J=Ae[vxe]||Ae["kill-duration-seconds"];_e(a[v5](Ae[gxe],J),function(Ee){_e(He[zs],function(Qe){if(Qe[Su]()===Ee){ae=ae||[];var Ne=Qe[jd](0);He.numEvents-=Ne[Bi](),ae[zo](Ne)}})})}if(X==200||X==204){V=200;return}(!Bxe(X)||He.numEvents<=0)&&(G=!1),V=9e3+X%1e3}if(G){V=100;var de=He.retryCnt;He[Za]===0&&(de<n?(he=!0,Rp(function(){He[Za]===0&&d--,rn(He[zs],de+1,He[m5],w?2:He[Za],5)},w,_5(de))):(Ce=!0,w&&(V=8001)))}}finally{he||(u[xk](),n0(He,V,ut,Ce)),Ca(ae,8004,He[Za])}}function n0(X,Ae,He,ut){try{ut&&p[y5]();var V=X[zs];Ae===200&&(V=X.sentEvts||X[zs],!ut&&!X[h5]&&p._clearBackOff(),d_(V)),Ca(V,Ae,X[Za],!0)}finally{X[Za]===0&&(d--,He!==5&&Q.sendQueuedRequests(X[Za],He))}}function d_(X){if(S){var Ae=Ja();_e(X,function(He){He&&He[Bi]()>0&&wp(He[Hd](),Ae)})}}function Rp(X,Ae,He){Ae?X():Z.set(X,He)}function rE(X){for(var Ae=0;Ae<X.batches[Qt];Ae++){var He=X[zs][Ae].Msfpc();if(He)return encodeURIComponent(He)}return Sl}function Ul(X){var Ae=q;try{for(var He=0;He<Ae[Qt];He++)try{Ae[He](X)}catch(V){Me(f,1,519,"Response handler failed: "+V)}if(X){var ut=JSON.parse(X);jo(ut.webResult)&&jo(ut.webResult[IS])&&I.set("MSFPC",ut.webResult[IS],365*86400)}}catch{}}function Ca(X,Ae,He,ut){if(X&&X[Qt]>0&&o){var V=o[Tm(Ae)];if(V){var ae=He!==0;Ri(h,function(){return"HttpManager:_sendBatchesNotification"},function(){Rp(function(){try{V.call(o,X,Ae,ae,He)}catch(he){Me(f,1,74,"send request notification failed: "+he)}},ut||ae,0)},function(){return{batches:xt(X),reason:Ae,isSync:ae,sendSync:ut,sendType:He}},!ae)}}}function Tm(X){var Ae=PWe[X];return jo(Ae)||(Ae=mxe,X>=9e3&&X<=9999?Ae=fxe:X>=8e3&&X<=8999?Ae=K3:X>=1e3&&X<=1999&&(Ae=pxe)),Ae}})}return t.__ieDyn=1,t}()});function BWe(t){return t&&t.sendPOST}var LWe,Kxe,OWe,Xxe,Jxe,MWe,Yxe,FWe,bK,eb,Qxe,So,UWe,Zxe,e1e=R(()=>{Ga();Ho();$y();rS();vt();KW();fK();Wxe();bk();mK();hK();RS();LWe=.25,Kxe=500,OWe=20,Xxe=6,Jxe=2,MWe=4,Yxe=2,FWe=1,bK=1e4,eb="eventsDiscarded",Qxe="",So=void 0,UWe=la({eventsLimitInMem:{isVal:xg,v:bK},immediateEventLimit:{isVal:xg,v:500},autoFlushEventsLimit:{isVal:xg,v:0},disableAutoBatchFlushLimit:!1,httpXHROverride:{isVal:BWe,v:So},overrideInstrumentationKey:So,overrideEndpointUrl:So,disableTelemetry:!1,ignoreMc1Ms0CookieProcessing:!1,setTimeoutOverride:So,clearTimeoutOverride:So,payloadPreprocessor:So,payloadListener:So,disableEventTimings:So,valueSanitizer:So,stringifyObjects:So,enableCompoundKey:So,disableOptimizeObj:!1,transports:So,unloadTransports:So,useSendBeacon:So,disableFetchKeepAlive:So,avoidOptions:!1,xhrTimeout:So,disableXhrSync:So,alwaysUseXhrOverride:!1,maxEventRetryAttempts:{isVal:Bs,v:Xxe},maxUnloadEventRetryAttempts:{isVal:Bs,v:Jxe},addNoResponse:So,excludeCsMetaData:So});Zxe=function(t){za(e,t);function e(){var r=t.call(this)||this;r.identifier="PostChannel",r.priority=1011,r.version="4.1.1";var n,o=!1,s=[],a,c=!1,u=0,l,d=0,p,f={},m=Wy,h,g,v,y,_,b,S,I,w,O,U,z,M,re,ee,N,E,P,q,F,Z,ue;return nr(e,r,function(te,Q){ke(),te._getDbgPlgTargets=function(){return[_,n]},te[Yy]=function(G,J,de){Ri(J,function(){return"PostChannel:initialize"},function(){Q[Yy](G,J,de),q=J.getNotifyMgr();try{ee=wc(gs(te[Ek]),J.evtNamespace&&J.evtNamespace()),te._addHook(oo(G,function(Ee){var Qe=Ee.cfg,Ne=ma(null,Qe,J);n=Ne.getExtCfg(te[Ek],UWe),N=AS(n[s5],n[a5]),U=!n[wxe]&&G3(),E=n[Rxe],ne(J),p=n[dK],l=n.immediateEventLimit,S=n[pK],M=n.maxEventRetryAttempts,re=n.maxUnloadEventRetryAttempts,P=n[kxe],Ce(),Z=n[Axe],ue=!!n[Pxe],F&&je();var mr=Qe.disablePageUnloadEvents||[];F=dk(Ct,mr,ee),F=yS(Ct,mr,ee)||F,F=bS(xr,Qe.disablePageShowEvents,ee)||F})),_[Yy](G,te.core,te)}catch(Ee){throw te.setInitialized(!1),Ee}},function(){return{theConfig:G,core:J,extensions:de}})},te.processTelemetry=function(G,J){vk(G,te[Ek]),J=J||te._getTelCtx(J);var de=G;!ue&&!o&&(Z&&(de[Su]=Z),nt(de,!0),z?xt(2,2):pe()),te.processNext(de,J)},te.getOfflineSupport=function(){try{var G=_&&_[l5]();if(G)return{getUrl:function(){return G.url},serialize:We,batch:ht,shouldProcess:function(J){return!ue},createPayload:function(J){return{urlString:G.url,headers:G[Sg],data:J}}}}catch{}return null},te._doTeardown=function(G,J){xt(2,2),o=!0,_.teardown(),je(),ke()};function je(){pk(null,ee),fk(null,ee),mk(null,ee)}function ne(G){var J=G[ES];G[ES]=function(){var de=0;return E&&(de=de|2),de|J.call(G)}}function ht(G){var J=Qxe;return G&&G[Qt]&&_e(G,function(de){J&&(J+=`
`),J+=de}),J}function We(G){var J=Qxe;try{ye(G),J=_[u5](G)}catch{}return J}function Ct(G){var J=G||li().event;J.type!=="beforeunload"&&(z=!0,_[Ck](z)),xt(2,2)}function xr(G){z=!1,_[Ck](z)}function ye(G){G.ext&&G.ext[tK]&&delete G.ext[tK],G.ext&&G.ext[e5]&&G.ext[e5].id&&delete G.ext[e5].id,U&&(G.ext=_u(G.ext),G[b5]&&(G[b5]=_u(G[b5])),G[wS]&&(G[wS]=_u(G[wS])))}function nt(G,J){if(G[wk]||(G[wk]=0),G[Ig]||(G[Ig]=1),ye(G),G[Xy]){if(v||c)G[Ig]=3,G[Xy]=!1;else if(_){U&&(G=_u(G)),_[p5](kS.create(G[Su],[G]),G[Xy]===!0?1:G[Xy],3);return}}var de=G[Ig],Ee=d,Qe=p;de===4&&(Ee=u,Qe=l);var Ne=!1;if(Ee<Qe)Ne=!Js(G,J);else{var mr=1,Cr=OWe;de===4&&(mr=4,Cr=1),Ne=!0,wp(G[Su],G[Ig],mr,Cr)&&(Ne=!Js(G,J))}Ne&&X(eb,[G],ml.QueueFull)}te.setEventQueueLimits=function(G,J){n[dK]=p=xg(G)?G:bK,n[pK]=S=xg(J)?J:0,Ce();var de=d>G;if(!de&&I>0)for(var Ee=1;!de&&Ee<=3;Ee++){var Qe=b[Ee];Qe&&Qe[zs]&&_e(Qe[zs],function(Ne){Ne&&Ne[Bi]()>=I&&(de=!0)})}hi(!0,de)},te.pause=function(){it(),c=!0,_.pause()},te.resume=function(){c=!1,_.resume(),pe()},te._loadTransmitProfiles=function(G){rE(),Ye(G,function(J,de){var Ee=de[Qt];if(Ee>=2){var Qe=Ee>2?de[2]:0;if(de[Ky](0,Ee-2),de[1]<0&&(de[0]=-1),de[1]>0&&de[0]>0){var Ne=de[0]/de[1];de[0]=Math.ceil(Ne)*de[1]}Qe>=0&&de[1]>=0&&Qe>de[1]&&(Qe=de[1]),de[zo](Qe),f[J]=de}})},te.flush=function(G,J,de){G===void 0&&(G=!0);var Ee;if(!c)if(de=de||1,G)J||(Ee=pa(function(Ne){J=Ne})),a==null?(it(),n0(1,0,de),a=Ie(function(){a=null,d_(J,de)},0)):s[zo](J);else{var Qe=it();H(1,1,de),J&&J(),Qe&&pe()}return Ee},te.setMsaAuthTicket=function(G){_[Sk](yk,G)},te.setAuthPluginHeader=function(G){_[Sk](ZW,G)},te.removeAuthPluginHeader=function(){_.removeHeader(ZW)},te.hasEvents=le,te._setTransmitProfile=function(G){m!==G&&f[G]!==void 0&&(it(),m=G,pe())},Ec(te,function(){return _},["addResponseHandler"]);function H(G,J,de){var Ee=n0(G,J,de);return _[TS](J,de),Ee}function le(){return d>0}function pe(){if(w>=0&&n0(w,0,O)&&_[TS](0,O),u>0&&!g&&!c){var G=f[m][2];G>=0&&(g=Ie(function(){g=null,H(4,0,1),pe()},G))}var J=f[m][1];!h&&!a&&J>=0&&!c&&(le()?h=Ie(function(){h=null,H(y===0?3:1,0,1),y++,y%=2,pe()},J):y=0)}te[y5]=function(){v<MWe&&(v++,it(),pe())},te._clearBackOff=function(){v&&(v=0,it(),pe())};function ke(){n=null,o=!1,s=[],a=null,c=!1,u=0,l=500,d=0,p=bK,f={},m=Wy,h=null,g=null,v=0,y=0,b={},S=0,F=!1,I=0,w=-1,O=null,U=!0,z=!1,M=Xxe,re=Jxe,ee=null,Z=null,ue=!1,N=AS(),_=new $xe(Kxe,Yxe,FWe,{requeue:Ca,send:He,sent:ut,drop:V,rspFail:ae,oth:he}),Ul(),rn(),Ce()}function Ie(G,J){J===0&&v&&(J=1);var de=1e3;return v&&(de=_5(v-1)),N.set(G,J*de)}function it(){return h!==null?(h.cancel(),h=null,y=0,!0):!1}function xt(G,J){it(),a&&(a.cancel(),a=null),c||H(1,G,J)}function rn(){b[4]={batches:[],iKeyMap:{}},b[3]={batches:[],iKeyMap:{}},b[2]={batches:[],iKeyMap:{}},b[1]={batches:[],iKeyMap:{}}}function An(G,J,de){var Ee=b[J];Ee||(J=1,Ee=b[J]);var Qe=Ee.iKeyMap[G];return!Qe&&de&&(Qe=kS.create(G),Ee.batches[zo](Qe),Ee.iKeyMap[G]=Qe),Qe}function hi(G,J){_[Ik]()&&!v&&(S>0&&d>S&&(J=!0),J&&a==null&&te.flush(G,function(){},20))}function Js(G,J){U&&(G=_u(G));var de=G[Ig],Ee=An(G[Su],de,!0);return Ee.addEvent(G)?(de!==4?(d++,J&&G[wk]===0&&hi(!G.sync,I>0&&Ee[Bi]()>=I)):u++,!0):!1}function wp(G,J,de,Ee){for(;de<=J;){var Qe=An(G,J,!0);if(Qe&&Qe[Bi]()>0){var Ne=Qe[jd](0,Ee),mr=Ne[Bi]();if(mr>0)return de===4?u-=mr:d-=mr,Ae(eb,[Ne],ml.QueueFull),!0}de++}return l_(),!1}function l_(){for(var G=0,J=0,de=function(Qe){var Ne=b[Qe];Ne&&Ne[zs]&&_e(Ne[zs],function(mr){Qe===4?G+=mr[Bi]():J+=mr[Bi]()})},Ee=1;Ee<=4;Ee++)de(Ee);d=J,u=G}function n0(G,J,de){var Ee=!1,Qe=J===0;return!Qe||_[Ik]()?Ri(te.core,function(){return"PostChannel._queueBatches"},function(){for(var Ne=[],mr=4;mr>=G;){var Cr=b[mr];Cr&&Cr.batches&&Cr.batches[Qt]>0&&(_e(Cr[zs],function(zi){_.addBatch(zi)?Ee=Ee||zi&&zi[Bi]()>0:Ne=Ne[qd](zi[Hd]()),mr===4?u-=zi[Bi]():d-=zi[Bi]()}),Cr[zs]=[],Cr.iKeyMap={}),mr--}Ne[Qt]>0&&X(eb,Ne,ml.KillSwitch),Ee&&w>=G&&(w=-1,O=0)},function(){return{latency:G,sendType:J,sendReason:de}},!Qe):(w=w>=0?Math.min(w,G):G,O=Math.max(O,de)),Ee}function d_(G,J){H(1,0,J),l_(),Rp(function(){G&&G(),s[Qt]>0?a=Ie(function(){a=null,d_(s.shift(),J)},0):(a=null,pe())})}function Rp(G){_[d5]()?G():a=Ie(function(){a=null,Rp(G)},LWe)}function rE(){it(),Ul(),m=Wy,pe()}function Ul(){f={},f[Wy]=[2,1,0],f[$3]=[6,3,0],f[W3]=[18,9,0]}function Ca(G,J){var de=[],Ee=M;z&&(Ee=re),_e(G,function(Qe){Qe&&Qe[Bi]()>0&&_e(Qe[Hd](),function(Ne){Ne&&(Ne[Xy]&&(Ne[Ig]=4,Ne[Xy]=!1),Ne[wk]<Ee?(vk(Ne,te[Ek]),nt(Ne,!1)):de[zo](Ne))})}),de[Qt]>0&&X(eb,de,ml.NonRetryableStatus),z&&xt(2,2)}function Tm(G,J){var de=q||{},Ee=de[G];if(Ee)try{Ee.apply(de,J)}catch(Qe){Me(te.diagLog(),1,74,G+" notification failed: "+Qe)}}function X(G,J){for(var de=[],Ee=2;Ee<arguments.length;Ee++)de[Ee-2]=arguments[Ee];J&&J[Qt]>0&&Tm(G,[J][qd](de))}function Ae(G,J){for(var de=[],Ee=2;Ee<arguments.length;Ee++)de[Ee-2]=arguments[Ee];J&&J[Qt]>0&&_e(J,function(Qe){Qe&&Qe[Bi]()>0&&Tm(G,[Qe.events()][qd](de))})}function He(G,J,de){G&&G[Qt]>0&&Tm("eventsSendRequest",[J>=1e3&&J<=1999?J-1e3:0,de!==!0])}function ut(G,J){Ae("eventsSent",G,J),pe()}function V(G,J){Ae(eb,G,J>=8e3&&J<=8999?J-8e3:ml.Unknown)}function ae(G){Ae(eb,G,ml.NonRetryableStatus),pe()}function he(G,J){Ae(eb,G,ml.Unknown),pe()}function Ce(){P?I=0:I=Math.max(Kxe*(Yxe+1),p/6)}}),r}return e.__ieDyn=1,e}(Nf)});var t1e={};dn(t1e,{BE_PROFILE:()=>W3,NRT_PROFILE:()=>$3,PostChannel:()=>Zxe,RT_PROFILE:()=>Wy});var r1e=R(()=>{KW();e1e()});var i1e=L(zd=>{"use strict";var qWe=zd&&zd.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var o=Object.getOwnPropertyDescriptor(e,r);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,o)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),HWe=zd&&zd.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),n1e=zd&&zd.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&qWe(e,t,r);return HWe(e,t),e};Object.defineProperty(zd,"__esModule",{value:!0});zd.oneDataSystemClientFactory=void 0;var jWe=async(t,e,r)=>{let n=await Promise.resolve().then(()=>n1e(($y(),Gi(dxe)))),o=await Promise.resolve().then(()=>n1e((r1e(),Gi(t1e)))),s=new n.AppInsightsCore,a=new o.PostChannel,c={instrumentationKey:t,endpointUrl:"https://mobile.events.data.microsoft.com/OneCollector/1.0",loggingLevelTelemetry:0,loggingLevelConsole:0,disableCookiesUsage:!0,disableDbgExt:!0,disableInstrumentationKeyValidation:!0,channels:[[a]]};if(r){c.extensionConfig={};let d={alwaysUseXhrOverride:!0,httpXHROverride:r};c.extensionConfig[a.identifier]=d}let l=e.workspace.getConfiguration("telemetry").get("internalTesting");return s.initialize(c,[]),s.addTelemetryInitializer(d=>{d.ext=d.ext??{},d.ext.web=d.ext.web??{},d.ext.web.consentDetails='{"GPC_DataSharingOptIn":false}',l&&(d.ext.utc=d.ext.utc??{},d.ext.utc.flags=8462029)}),s},zWe=async(t,e,r)=>{let n=await jWe(t,e,r);return{logEvent:(a,c)=>{try{n?.track({name:a,baseData:{name:a,properties:c?.properties,measurements:c?.measurements}})}catch(u){throw new Error(`Failed to log event to app insights!
`+u.message)}},flush:async()=>{try{return new Promise((c,u)=>{if(!n){c();return}n.flush(!0,l=>{if(!l){u("Failed to flush app 1DS!");return}})})}catch(a){throw new Error(`Failed to flush 1DS!
`+a.message)}},dispose:async()=>new Promise(c=>{if(!n){c();return}n.unload(!1,()=>{c(),n=void 0},1e3)})}};zd.oneDataSystemClientFactory=zWe});var o1e,DS,NS,Rk,Cg,Gd,Io,S5,Iu=R(()=>{o1e="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",DS="sampleRate",NS="ProcessLegacy",Rk="http.method",Cg="https://dc.services.visualstudio.com",Gd="/v2/track",Io="not_specified",S5="iKey"});var tb,_K=R(()=>{Vr();tb=y$({requestContextHeader:[0,"Request-Context"],requestContextTargetKey:[1,"appId"],requestContextAppIdFormat:[2,"appId=cid-v1:"],requestIdHeader:[3,"Request-Id"],traceParentHeader:[4,"traceparent"],traceStateHeader:[5,"tracestate"],sdkContextHeader:[6,"Sdk-Context"],sdkContextHeaderAppIdRequest:[7,"appId"],requestContextHeaderLowerCase:[8,"request-context"]})});var Uf,kt,Vd,Tg,Bf,qf,I5,so,Il,Eg,C5,T5,E5,xK,w5,R5,rb,LS,SK,kk,nb,Cu,vs,Gs,ib,$d,ob,k5,A5,IK,sb,wg,Ak,Pk,ab,OS,cb,CK,Co=R(()=>{Uf="split",kt="length",Vd="toLowerCase",Tg="ingestionendpoint",Bf="toString",qf="push",I5="removeItem",so="name",Il="message",Eg="count",C5="preTriggerDate",T5="disabled",E5="interval",xK="daysOfMonth",w5="date",R5="getUTCDate",rb="stringify",LS="pathname",SK="correlationHeaderExcludePatterns",kk="extensionConfig",nb="exceptions",Cu="parsedStack",vs="properties",Gs="measurements",ib="sizeInBytes",$d="typeName",ob="severityLevel",k5="problemGroup",A5="isManual",IK="CreateFromInterface",sb="assembly",wg="fileName",Ak="hasFullStack",Pk="level",ab="method",OS="line",cb="duration",CK="receivedResponse"});function P5(t,e,r){var n=e[kt],o=TK(t,e);if(o[kt]!==n){for(var s=0,a=o;r[a]!==void 0;)s++,a=Ti(o,0,147)+EK(s);o=a}return o}function TK(t,e){var r;return e&&(e=Nr(Hn(e)),e[kt]>150&&(r=Ti(e,0,150),Me(t,2,57,"name is too long.  It has been truncated to 150 characters.",{name:e},!0))),r||e}function un(t,e,r){r===void 0&&(r=1024);var n;return e&&(r=r||1024,e=Nr(Hn(e)),e[kt]>r&&(n=Ti(e,0,r),Me(t,2,61,"string value is too long. It has been truncated to "+r+" characters.",{value:e},!0))),n||e}function Rg(t,e){return L5(t,e,2048,66)}function MS(t,e){var r;return e&&e[kt]>32768&&(r=Ti(e,0,32768),Me(t,2,56,"message is too long, it has been truncated to 32768 characters.",{message:e},!0)),r||e}function D5(t,e){var r;if(e){var n=""+e;n[kt]>32768&&(r=Ti(n,0,32768),Me(t,2,52,"exception is too long, it has been truncated to 32768 characters.",{exception:e},!0))}return r||e}function Vs(t,e){if(e){var r={};Ye(e,function(n,o){if(Tn(o)&&Rd())try{o=hs()[rb](o)}catch(s){Me(t,2,49,"custom property is not valid",{exception:s},!0)}o=un(t,o,8192),n=P5(t,n,r),r[n]=o}),e=r}return e}function $s(t,e){if(e){var r={};Ye(e,function(n,o){n=P5(t,n,r),r[n]=o}),e=r}return e}function N5(t,e){return e&&L5(t,e,128,69)[Bf]()}function L5(t,e,r,n){var o;return e&&(e=Nr(Hn(e)),e[kt]>r&&(o=Ti(e,0,r),Me(t,2,n,"input is too long, it has been truncated to "+r+" characters.",{data:e},!0))),o||e}function EK(t){var e="00"+t;return dl(e,e[kt]-3)}var Tu=R(()=>{Vr();vt();Co()});function ub(t){var e=a1e,r=GWe,n=r[e];return s1e.createElement?r[e]||(n=r[e]=s1e.createElement("a")):n={host:wK(t,!0)},n.href=t,e++,e>=r[kt]&&(e=0),a1e=e,n}function c1e(t){var e,r=ub(t);return r&&(e=r.href),e}function u1e(t){var e,r=ub(t);return r&&(e=r[LS]),e}function l1e(t,e){return t?t.toUpperCase()+" "+e:e}function wK(t,e){var r=Dk(t,e)||"";if(r){var n=r.match(/(www\d{0,5}\.)?([^\/:]{1,256})(:\d{1,20})?/i);if(n!=null&&n[kt]>3&&Ot(n[2])&&n[2][kt]>0)return n[2]+(n[3]||"")}return r}function Dk(t,e){var r=null;if(t){var n=t.match(/(\w{1,150}):\/\/([^\/:]{1,256})(:\d{1,20})?/i);if(n!=null&&n[kt]>2&&Ot(n[2])&&n[2][kt]>0&&(r=n[2]||"",e&&n[kt]>2)){var o=(n[1]||"")[Vd](),s=n[3]||"";(o==="http"&&s===":80"||o==="https"&&s===":443")&&(s=""),r+=s}}return r}var s1e,a1e,GWe,RK=R(()=>{Vr();Co();s1e=ui()||{},a1e=0,GWe=[null,null,null,null,null]});function Nk(t){return wr(VWe,t[Vd]())!==-1}function d1e(t){kK=t}function p1e(){return kK}function f1e(t,e,r){if(!e||t&&t.disableCorrelationHeaders)return!1;if(t&&t[SK]){for(var n=0;n<t.correlationHeaderExcludePatterns[kt];n++)if(t[SK][n].test(e))return!1}var o=ub(e).host[Vd]();if(o&&(da(o,":443")!==-1||da(o,":80")!==-1)&&(o=(Dk(e,!0)||"")[Vd]()),(!t||!t.enableCorsCorrelation)&&o&&o!==r)return!1;var s=t&&t.correlationHeaderDomains;if(s){var a;if(_e(s,function(l){var d=new RegExp(l.toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*"));a=a||d.test(o)}),!a)return!1}var c=t&&t.correlationHeaderExcludedDomains;if(!c||c[kt]===0)return!0;for(var n=0;n<c[kt];n++){var u=new RegExp(c[n].toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*"));if(u.test(o))return!1}return o&&o[kt]>0}function m1e(t){if(t){var e=AK(t,tb[1]);if(e&&e!==kK)return e}}function AK(t,e){if(t)for(var r=t[Uf](","),n=0;n<r[kt];++n){var o=r[n][Uf]("=");if(o[kt]===2&&o[0]===e)return o[1]}}function h1e(t,e,r,n){var o,s=n,a=n;if(e&&e[kt]>0){var c=ub(e);if(o=c.host,!s)if(c[LS]!=null){var u=c.pathname[kt]===0?"/":c[LS];u.charAt(0)!=="/"&&(u="/"+u),a=c[LS],s=un(t,r?r+" "+u:u)}else s=un(t,e)}else o=n,s=n;return{target:o,name:s,data:a}}function g1e(){var t=yf();if(t&&t.now&&t.timing){var e=t.now()+t.timing.navigationStart;if(e>0)return e}return di()}function v1e(t,e){var r=null;return t!==0&&e!==0&&!Te(t)&&!Te(e)&&(r=e-t),r}function y1e(t,e){var r=t||{};return{getName:function(){return r[so]},setName:function(n){e&&e.setName(n),r[so]=n},getTraceId:function(){return r.traceID},setTraceId:function(n){e&&e.setTraceId(n),Nd(n)&&(r.traceID=n)},getSpanId:function(){return r.parentID},setSpanId:function(n){e&&e.setSpanId(n),Ld(n)&&(r.parentID=n)},getTraceFlags:function(){return r.traceFlags},setTraceFlags:function(n){e&&e.setTraceFlags(n),r.traceFlags=n}}}var VWe,kK,PK=R(()=>{Vr();vt();Iu();_K();Tu();RK();Co();VWe=[Cg+Gd,"https://breeze.aimon.applicationinsights.io"+Gd,"https://dc-int.services.visualstudio.com"+Gd],kK="cid-v1:"});var FS,b1e,_1e,DK=R(()=>{Vr();FS=no({LocalStorage:0,SessionStorage:1}),b1e=no({AI:0,AI_AND_W3C:1,W3C:2}),_1e=no({Normal:1,Critical:2})});function NK(){return US()?O5(FS.LocalStorage):null}function O5(t){try{if(Te(qs()))return null;var e=new Date()[Bf](),r=Zr(t===FS.LocalStorage?"localStorage":"sessionStorage"),n=x1e+e;r.setItem(n,e);var o=r.getItem(n)!==e;if(r[I5](n),!o)return r}catch{}return null}function LK(){return lb()?O5(FS.SessionStorage):null}function S1e(){kg=!1,Ag=!1}function M5(t){x1e=t||""}function I1e(){kg=US(!0),Ag=lb(!0)}function US(t){return(t||kg===void 0)&&(kg=!!O5(FS.LocalStorage)),kg}function F5(t,e){var r=NK();if(r!==null)try{return r.getItem(e)}catch(n){kg=!1,Me(t,2,1,"Browser failed read of local storage. "+En(n),{exception:Ve(n)})}return null}function U5(t,e,r){var n=NK();if(n!==null)try{return n.setItem(e,r),!0}catch(o){kg=!1,Me(t,2,3,"Browser failed write to local storage. "+En(o),{exception:Ve(o)})}return!1}function C1e(t,e){var r=NK();if(r!==null)try{return r[I5](e),!0}catch(n){kg=!1,Me(t,2,5,"Browser failed removal of local storage item. "+En(n),{exception:Ve(n)})}return!1}function lb(t){return(t||Ag===void 0)&&(Ag=!!O5(FS.SessionStorage)),Ag}function T1e(){var t=[];return lb()&&Ye(Zr("sessionStorage"),function(e){t[qf](e)}),t}function B5(t,e){var r=LK();if(r!==null)try{return r.getItem(e)}catch(n){Ag=!1,Me(t,2,2,"Browser failed read of session storage. "+En(n),{exception:Ve(n)})}return null}function q5(t,e,r){var n=LK();if(n!==null)try{return n.setItem(e,r),!0}catch(o){Ag=!1,Me(t,2,4,"Browser failed write to session storage. "+En(o),{exception:Ve(o)})}return!1}function E1e(t,e){var r=LK();if(r!==null)try{return r[I5](e),!0}catch(n){Ag=!1,Me(t,2,6,"Browser failed removal of session storage item. "+En(n),{exception:Ve(n)})}return!1}var kg,Ag,x1e,OK=R(()=>{Vr();DK();Co();kg=void 0,Ag=void 0,x1e=""});var $We,w1e,R1e=R(()=>{Vr();vt();OK();Co();$We="appInsightsThrottle",w1e=function(){function t(e,r){var n=this,o,s,a,c,u,l,d,p=!1,f=!1;h(),n._getDbgPlgTargets=function(){return[d]},n.getConfig=function(){return a},n.canThrottle=function(E){var P=re(E),q=g(E);return _(q,o,P)},n.isTriggered=function(E){return ee(E)},n.isReady=function(){return p},n.flush=function(E){try{var P=N(E);if(P&&P[kt]>0){var q=P.slice(0);return d[E]=[],_e(q,function(F){m(F.msgID,F[Il],F.severity,!1)}),!0}}catch{}return!1},n.flushAll=function(){try{if(d){var E=!0;return Ye(d,function(P){var q=n.flush(parseInt(P));E=E&&q}),E}}catch{}return!1},n.onReadyState=function(E,P){return P===void 0&&(P=!0),p=Te(E)?!0:E,p&&P?n.flushAll():null},n.sendMessage=function(E,P,q){return m(E,P,q,!0)};function m(E,P,q,F){if(p){var Z=M(E);if(!Z)return;var ue=g(E),te=re(E),Q=_(ue,o,te),je=!1,ne=0,ht=ee(E);try{Q&&!ht?(ne=Math.min(ue.limit.maxSendNumber,te[Eg]+1),te[Eg]=0,je=!0,u[E]=!0,te[C5]=new Date):(u[E]=Q,te[Eg]+=1);var We=b(E);O(s,We,te);for(var Ct=0;Ct<ne;Ct++)z(E,s,P,q)}catch{}return{isThrottled:je,throttleNum:ne}}else if(F){var xr=N(E);xr[qf]({msgID:E,message:P,severity:q})}return null}function h(){s=bl(e),u={},c={},d={},a={},v(109),l=Ad(r)?r:"",e.addUnloadHook(oo(e.config,function(E){var P=E.cfg;o=US();var q=P.throttleMgrCfg||{};Ye(q,function(F,Z){v(parseInt(F),Z)})}))}function g(E){return a[E]||a[109]}function v(E,P){var q,F;try{var Z=P||{},ue={};ue[T5]=!!Z[T5];var te=Z[E5]||{};f=te?.daysOfMonth&&te?.daysOfMonth[kt]>0,ue[E5]=y(te);var Q={samplingRate:((q=Z.limit)===null||q===void 0?void 0:q.samplingRate)||100,maxSendNumber:((F=Z.limit)===null||F===void 0?void 0:F.maxSendNumber)||1};ue.limit=Q,a[E]=ue}catch{}}function y(E){E=E||{};var P=E?.monthInterval,q=E?.dayInterval;return Te(P)&&Te(q)&&(E.monthInterval=3,f||(E[xK]=[28],f=!0)),E={monthInterval:E?.monthInterval,dayInterval:E?.dayInterval,daysOfMonth:E?.daysOfMonth},E}function _(E,P,q){if(E&&!E[T5]&&P&&Ad(q)){var F=w(),Z=q[w5],ue=E[E5],te=1;if(ue?.monthInterval){var Q=(F.getUTCFullYear()-Z.getUTCFullYear())*12+F.getUTCMonth()-Z.getUTCMonth();te=U(ue.monthInterval,0,Q)}var je=1;if(f)je=wr(ue[xK],F[R5]());else if(ue?.dayInterval){var ne=Math.floor((F.getTime()-Z.getTime())/864e5);je=U(ue.dayInterval,0,ne)}return te>=0&&je>=0}return!1}function b(E,P){var q=Ad(P)?P:"";return E?$We+q+"-"+E:null}function S(E){try{if(E){var P=new Date;return E.getUTCFullYear()===P.getUTCFullYear()&&E.getUTCMonth()===P.getUTCMonth()&&E[R5]()===P[R5]()}}catch{}return!1}function I(E,P,q){try{var F={date:w(),count:0};if(E){var Z=JSON.parse(E),ue={date:w(Z[w5])||F[w5],count:Z[Eg]||F[Eg],preTriggerDate:Z.preTriggerDate?w(Z[C5]):void 0};return ue}else return O(P,q,F),F}catch{}return null}function w(E){try{if(E){var P=new Date(E);if(!isNaN(P.getDate()))return P}else return new Date}catch{}return null}function O(E,P,q){try{return U5(E,P,Nr(JSON[rb](q)))}catch{}return!1}function U(E,P,q){return E<=0?1:q>=P&&(q-P)%E==0?Math.floor((q-P)/E)+1:-1}function z(E,P,q,F){Me(P,F||1,E,q)}function M(E){try{var P=g(E);return VR(1e6)<=P.limit.samplingRate}catch{}return!1}function re(E){try{var P=c[E];if(!P){var q=b(E,l);P=I(F5(s,q),s,q),c[E]=P}return c[E]}catch{}return null}function ee(E){var P=u[E];if(Te(P)){P=!1;var q=re(E);q&&(P=S(q[C5])),u[E]=P}return u[E]}function N(E){return d=d||{},Te(d[E])&&(d[E]=[]),d[E]}}return t}()});function Lk(t){if(!t)return{};var e=t[Uf](WWe),r=B1(e,function(o,s){var a=s[Uf](KWe);if(a[kt]===2){var c=a[0][Vd](),u=a[1];o[c]=u}return o},{});if(bo(r)[kt]>0){if(r.endpointsuffix){var n=r.location?r.location+".":"";r[Tg]=r[Tg]||"https://"+n+"dc."+r.endpointsuffix}r[Tg]=r[Tg]||Cg,Qh(r[Tg],"/")&&(r[Tg]=r[Tg].slice(0,-1))}return r}var WWe,KWe,k1e,A1e=R(()=>{Vr();Iu();Co();WWe=";",KWe="=";k1e={parse:Lk}});var H5,P1e=R(()=>{Vr();Iu();Co();Tu();H5=function(){function t(e,r,n){var o=this,s=this;s.ver=1,s.sampleRate=100,s.tags={},s[so]=un(e,n)||Io,s.data=r,s.time=Tc(new Date),s.aiDataContract={time:1,iKey:1,name:1,sampleRate:function(){return o.sampleRate===100?4:1},tags:1,data:1}}return t}()});var Wd,D1e=R(()=>{Iu();Co();Tu();Wd=function(){function t(e,r,n,o){this.aiDataContract={ver:1,name:1,properties:0,measurements:0};var s=this;s.ver=2,s[so]=un(e,r)||Io,s[vs]=Vs(e,n),s[Gs]=$s(e,o)}return t.envelopeType="Microsoft.ApplicationInsights.{0}.Event",t.dataType="EventData",t}()});function BK(t,e){var r=t;return r&&!Ot(r)&&(JSON&&JSON[rb]?(r=JSON[rb](t),e&&(!r||r==="{}")&&(pt(t[Bf])?r=t[Bf]():r=""+t)):r=""+t+" - (Missing JSON.stringify)"),r||""}function F1e(t,e){var r=t;return t&&(r&&!Ot(r)&&(r=t[UK]||t[M1e]||r),r&&!Ot(r)&&(r=BK(r,!0)),t.filename&&(r=r+" @"+(t.filename||"")+":"+(t.lineno||"?")+":"+(t.colno||"?"))),e&&e!=="String"&&e!=="Object"&&e!=="Error"&&da(r||"",e)===-1&&(r=e+": "+r),r||""}function QWe(t){try{if(Tn(t))return"hasFullStack"in t&&"typeName"in t}catch{}return!1}function XWe(t){try{if(Tn(t))return"ver"in t&&"exceptions"in t&&"properties"in t}catch{}return!1}function L1e(t){return t&&t.src&&Ot(t.src)&&t.obj&&et(t.obj)}function db(t){var e=t||"";Ot(e)||(Ot(e[ec])?e=e[ec]:e=""+e);var r=e[Uf](`
`);return{src:e,obj:r}}function JWe(t){for(var e=[],r=t[Uf](`
`),n=0;n<r[kt];n++){var o=r[n];r[n+1]&&(o+="@"+r[n+1],n++),e[qf](o)}return{src:t,obj:e}}function U1e(t){var e=null;if(t)try{if(t[ec])e=db(t[ec]);else if(t[BS]&&t[BS][ec])e=db(t[BS][ec]);else if(t.exception&&t.exception[ec])e=db(t.exception[ec]);else if(L1e(t))e=t;else if(L1e(t[FK]))e=t[FK];else if(li()&&li().opera&&t[UK])e=JWe(t[Il]);else if(t.reason&&t.reason[ec])e=db(t.reason[ec]);else if(Ot(t))e=db(t);else{var r=t[UK]||t[M1e]||"";Ot(t[N1e])&&(r&&(r+=`
`),r+=" from "+t[N1e]),r&&(e=db(r))}}catch(n){e=db(n)}return e||{src:"",obj:null}}function ZWe(t){var e="";return t&&(t.obj?_e(t.obj,function(r){e+=r+`
`}):e=t.src||""),e}function eKe(t){var e,r=t.obj;if(r&&r[kt]>0){e=[];var n=0,o=0;_e(r,function(h){var g=h[Bf]();if(qK.regex.test(g)){var v=new qK(g,n++);o+=v[ib],e[qf](v)}});var s=32*1024;if(o>s)for(var a=0,c=e[kt]-1,u=0,l=a,d=c;a<c;){var p=e[a][ib],f=e[c][ib];if(u+=p+f,u>s){var m=d-l+1;e.splice(l,m);break}l=a,d=c,a++,c--}}return e}function j5(t){var e="";if(t&&(e=t.typeName||t[so]||"",!e))try{var r=/function (.{1,200})\(/,n=r.exec(t.constructor[Bf]());e=n&&n[kt]>1?n[1]:""}catch{}return e}function MK(t){if(t)try{if(!Ot(t)){var e=j5(t),r=BK(t,!1);return(!r||r==="{}")&&(t[BS]&&(t=t[BS],e=j5(t)),r=BK(t,!0)),da(r,e)!==0&&e!=="String"?e+":"+r:r}}catch{}return""+(t||"")}var YWe,BS,ec,FK,N1e,UK,M1e,Pg,O1e,qK,B1e=R(()=>{Ga();Vr();vt();Iu();Co();Tu();YWe="<no_method>",BS="error",ec="stack",FK="stackDetails",N1e="errorSrc",UK="message",M1e="description";Pg=function(){function t(e,r,n,o,s,a){this.aiDataContract={ver:1,exceptions:1,severityLevel:0,properties:0,measurements:0};var c=this;c.ver=2,XWe(r)?(c[nb]=r[nb]||[],c[vs]=r[vs],c[Gs]=r[Gs],r[ob]&&(c[ob]=r[ob]),r.id&&(c.id=r.id,r[vs].id=r.id),r[k5]&&(c[k5]=r[k5]),Te(r[A5])||(c[A5]=r[A5])):(n||(n={}),a&&(n.id=a),c[nb]=[new O1e(e,r,n)],c[vs]=Vs(e,n),c[Gs]=$s(e,o),s&&(c[ob]=s),a&&(c.id=a))}return t.CreateAutoException=function(e,r,n,o,s,a,c,u){var l,d=j5(s||a||e);return l={},l[Il]=F1e(e,d),l.url=r,l.lineNumber=n,l.columnNumber=o,l.error=MK(s||a||e),l.evt=MK(a||e),l[$d]=d,l.stackDetails=U1e(c||s||a),l.errorSrc=u,l},t.CreateFromInterface=function(e,r,n,o){var s=r[nb]&&Sd(r[nb],function(c){return O1e[IK](e,c)}),a=new t(e,gu(gu({},r),{exceptions:s}),n,o);return a},t.prototype.toInterface=function(){var e,r=this,n=r.exceptions,o=r.properties,s=r.measurements,a=r.severityLevel,c=r.problemGroup,u=r.id,l=r.isManual,d=n instanceof Array&&Sd(n,function(p){return p.toInterface()})||void 0;return e={ver:"4.0"},e[nb]=d,e.severityLevel=a,e.properties=o,e.measurements=s,e.problemGroup=c,e.id=u,e.isManual=l,e},t.CreateSimpleException=function(e,r,n,o,s,a){var c;return{exceptions:[(c={},c[Ak]=!0,c.message=e,c.stack=s,c.typeName=r,c)]}},t.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",t.dataType="ExceptionData",t.formatError=MK,t}(),O1e=function(){function t(e,r,n){this.aiDataContract={id:0,outerId:0,typeName:1,message:1,hasFullStack:0,stack:0,parsedStack:2};var o=this;if(QWe(r))o[$d]=r[$d],o[Il]=r[Il],o[ec]=r[ec],o[Cu]=r[Cu]||[],o[Ak]=r[Ak];else{var s=r,a=s&&s.evt;Hh(s)||(s=s[BS]||a||s),o[$d]=un(e,j5(s))||Io,o[Il]=MS(e,F1e(r||s,o[$d]))||Io;var c=r[FK]||U1e(r);o[Cu]=eKe(c),et(o[Cu])&&Sd(o[Cu],function(u){u[sb]=un(e,u[sb]),u[wg]=un(e,u[wg])}),o[ec]=D5(e,ZWe(c)),o.hasFullStack=et(o.parsedStack)&&o.parsedStack[kt]>0,n&&(n[$d]=n[$d]||o[$d])}}return t.prototype.toInterface=function(){var e,r=this,n=r[Cu]instanceof Array&&Sd(r[Cu],function(s){return s.toInterface()}),o=(e={id:r.id,outerId:r.outerId,typeName:r[$d],message:r[Il],hasFullStack:r[Ak],stack:r[ec]},e[Cu]=n||void 0,e);return o},t.CreateFromInterface=function(e,r){var n=r[Cu]instanceof Array&&Sd(r[Cu],function(s){return qK[IK](s)})||r[Cu],o=new t(e,gu(gu({},r),{parsedStack:n}));return o},t}(),qK=function(){function t(e,r){this.aiDataContract={level:1,method:1,assembly:0,fileName:0,line:0};var n=this;if(n[ib]=0,typeof e=="string"){var o=e;n[Pk]=r,n[ab]=YWe,n[sb]=Nr(o),n[wg]="",n[OS]=0;var s=o.match(t.regex);s&&s[kt]>=5&&(n[ab]=Nr(s[2])||n[ab],n[wg]=Nr(s[4]),n[OS]=parseInt(s[5])||0)}else n[Pk]=e[Pk],n[ab]=e[ab],n[sb]=e[sb],n[wg]=e[wg],n[OS]=e[OS],n[ib]=0;n.sizeInBytes+=n.method[kt],n.sizeInBytes+=n.fileName[kt],n.sizeInBytes+=n.assembly[kt],n[ib]+=t.baseSize,n.sizeInBytes+=n.level.toString()[kt],n.sizeInBytes+=n.line.toString()[kt]}return t.CreateFromInterface=function(e){return new t(e,null)},t.prototype.toInterface=function(){var e=this;return{level:e[Pk],method:e[ab],assembly:e[sb],fileName:e[wg],line:e[OS]}},t.regex=/^([\s]+at)?[\s]{0,50}([^\@\()]+?)[\s]{0,50}(\@|\()([^\(\n]+):([0-9]+):([0-9]+)(\)?)$/,t.baseSize=58,t}()});var q1e,H1e=R(()=>{q1e=function(){function t(){this.aiDataContract={name:1,kind:0,value:1,count:0,min:0,max:0,stdDev:0},this.kind=0}return t}()});var Kd,j1e=R(()=>{Iu();Co();H1e();Tu();Kd=function(){function t(e,r,n,o,s,a,c,u,l){this.aiDataContract={ver:1,metrics:1,properties:0};var d=this;d.ver=2;var p=new q1e;p[Eg]=o>0?o:void 0,p.max=isNaN(a)||a===null?void 0:a,p.min=isNaN(s)||s===null?void 0:s,p[so]=un(e,r)||Io,p.value=n,p.stdDev=isNaN(c)||c===null?void 0:c,d.metrics=[p],d[vs]=Vs(e,u),d[Gs]=$s(e,l)}return t.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",t.dataType="MetricData",t}()});function z1e(t,e){return e===void 0&&(e=!1),t==null?e:t.toString()[Vd]()==="true"}function qS(t){(isNaN(t)||t<0)&&(t=0),t=Math.round(t);var e=Ok+t%1e3,r=Ok+Math.floor(t/1e3)%60,n=Ok+Math.floor(t/(1e3*60))%60,o=Ok+Math.floor(t/(1e3*60*60))%24,s=Math.floor(t/(1e3*60*60*24));return e=e[kt]===1?"00"+e:e[kt]===2?"0"+e:e,r=r[kt]<2?"0"+r:r,n=n[kt]<2?"0"+n:n,o=o[kt]<2?"0"+o:o,(s>0?s+".":Ok)+o+":"+n+":"+r+"."+e}function G1e(t,e){var r=null;return _e(t,function(n){if(n.identifier===e)return r=n,-1}),r}function V1e(t,e,r,n,o){return!o&&Ot(t)&&(t==="Script error."||t==="Script error")}var Ok,z5=R(()=>{Vr();Co();Ok=""});var Dg,$1e=R(()=>{Iu();z5();Co();Tu();Dg=function(){function t(e,r,n,o,s,a,c){this.aiDataContract={ver:1,name:0,url:0,duration:0,properties:0,measurements:0,id:0};var u=this;u.ver=2,u.id=N5(e,c),u.url=Rg(e,n),u[so]=un(e,r)||Io,isNaN(o)||(u[cb]=qS(o)),u[vs]=Vs(e,s),u[Gs]=$s(e,a)}return t.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",t.dataType="PageviewData",t}()});var Ng,W1e=R(()=>{z5();PK();Co();Tu();Ng=function(){function t(e,r,n,o,s,a,c,u,l,d,p,f){l===void 0&&(l="Ajax"),this.aiDataContract={id:1,ver:1,name:0,resultCode:0,duration:0,success:0,data:0,target:0,type:0,properties:0,measurements:0,kind:0,value:0,count:0,min:0,max:0,stdDev:0,dependencyKind:0,dependencySource:0,commandName:0,dependencyTypeName:0};var m=this;m.ver=2,m.id=r,m[cb]=qS(s),m.success=a,m.resultCode=c+"",m.type=un(e,l);var h=h1e(e,n,u,o);m.data=Rg(e,o)||h.data,m.target=un(e,h.target),d&&(m.target="".concat(m.target," | ").concat(d)),m[so]=un(e,h[so]),m[vs]=Vs(e,p),m[Gs]=$s(e,f)}return t.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",t.dataType="RemoteDependencyData",t}()});var Lg,K1e=R(()=>{Iu();Co();Tu();Lg=function(){function t(e,r,n,o,s){this.aiDataContract={ver:1,message:1,severityLevel:0,properties:0};var a=this;a.ver=2,r=r||Io,a[Il]=MS(e,r),a[vs]=Vs(e,o),a[Gs]=$s(e,s),n&&(a[ob]=n)}return t.envelopeType="Microsoft.ApplicationInsights.{0}.Message",t.dataType="MessageData",t}()});var Og,Y1e=R(()=>{Iu();Co();Tu();Og=function(){function t(e,r,n,o,s,a,c){this.aiDataContract={ver:1,name:0,url:0,duration:0,perfTotal:0,networkConnect:0,sentRequest:0,receivedResponse:0,domProcessing:0,properties:0,measurements:0};var u=this;u.ver=2,u.url=Rg(e,n),u[so]=un(e,r)||Io,u[vs]=Vs(e,s),u[Gs]=$s(e,a),c&&(u.domProcessing=c.domProcessing,u[cb]=c[cb],u.networkConnect=c.networkConnect,u.perfTotal=c.perfTotal,u[CK]=c[CK],u.sentRequest=c.sentRequest)}return t.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",t.dataType="PageviewPerformanceData",t}()});var Yd,Q1e=R(()=>{Yd=function(){function t(e,r){this.aiDataContract={baseType:1,baseData:1},this.baseType=e,this.baseData=r}return t}()});var G5,X1e=R(()=>{Vr();G5=no({Verbose:0,Information:1,Warning:2,Error:3,Critical:4})});var J1e,Z1e=R(()=>{Vr();Co();J1e=function(){function t(){}return t.getConfig=function(e,r,n,o){o===void 0&&(o=!1);var s;return n&&e[kk]&&e[kk][n]&&!Te(e[kk][n][r])?s=e[kk][n][r]:s=e[r],Te(s)?o:s},t}()});function Fg(t){var e="ai."+t+".";return function(r){return e+r}}var Mk,To,V5,HS,HK,Mg,pb,Fk,jS,jK=R(()=>{Ga();Vr();Mk=Fg("application"),To=Fg("device"),V5=Fg("location"),HS=Fg("operation"),HK=Fg("session"),Mg=Fg("user"),pb=Fg("cloud"),Fk=Fg("internal"),jS=function(t){za(e,t);function e(){return t.call(this)||this}return e}(eW({applicationVersion:Mk("ver"),applicationBuild:Mk("build"),applicationTypeId:Mk("typeId"),applicationId:Mk("applicationId"),applicationLayer:Mk("layer"),deviceId:To("id"),deviceIp:To("ip"),deviceLanguage:To("language"),deviceLocale:To("locale"),deviceModel:To("model"),deviceFriendlyName:To("friendlyName"),deviceNetwork:To("network"),deviceNetworkName:To("networkName"),deviceOEMName:To("oemName"),deviceOS:To("os"),deviceOSVersion:To("osVersion"),deviceRoleInstance:To("roleInstance"),deviceRoleName:To("roleName"),deviceScreenResolution:To("screenResolution"),deviceType:To("type"),deviceMachineName:To("machineName"),deviceVMName:To("vmName"),deviceBrowser:To("browser"),deviceBrowserVersion:To("browserVersion"),locationIp:V5("ip"),locationCountry:V5("country"),locationProvince:V5("province"),locationCity:V5("city"),operationId:HS("id"),operationName:HS("name"),operationParentId:HS("parentId"),operationRootId:HS("rootId"),operationSyntheticSource:HS("syntheticSource"),operationCorrelationVector:HS("correlationVector"),sessionId:HK("id"),sessionIsFirst:HK("isFirst"),sessionIsNew:HK("isNew"),userAccountAcquisitionDate:Mg("accountAcquisitionDate"),userAccountId:Mg("accountId"),userAgent:Mg("userAgent"),userId:Mg("id"),userStoreRegion:Mg("storeRegion"),userAuthUserId:Mg("authUserId"),userAnonymousUserAcquisitionDate:Mg("anonUserAcquisitionDate"),userAuthenticatedUserAcquisitionDate:Mg("authUserAcquisitionDate"),cloudName:pb("name"),cloudRole:pb("role"),cloudRoleVer:pb("roleVer"),cloudRoleInstance:pb("roleInstance"),cloudEnvironment:pb("environment"),cloudLocation:pb("location"),cloudDeploymentUnit:pb("deploymentUnit"),internalNodeName:Fk("nodeName"),internalSdkVersion:Fk("sdkVersion"),internalAgentVersion:Fk("agentVersion"),internalSnippet:Fk("snippet"),internalSdkSrc:Fk("sdkSrc")}))});function zK(t,e,r,n,o,s){var a;r=un(n,r)||Io,(Te(t)||Te(e)||Te(r))&&ci("Input doesn't contain all required fields");var c="";t[S5]&&(c=t[S5],delete t[S5]);var u=(a={},a[so]=r,a.time=Tc(new Date),a.iKey=c,a.ext=s||{},a.tags=[],a.data={},a.baseType=e,a.baseData=t,a);return Te(o)||Ye(o,function(l,d){u.data[l]=d}),u}var eSe,tSe=R(()=>{Vr();Iu();Tu();Co();eSe=function(){function t(){}return t.create=zK,t}()});var rSe,ao,nSe=R(()=>{jK();rSe={UserExt:"user",DeviceExt:"device",TraceExt:"trace",WebExt:"web",AppExt:"app",OSExt:"os",SessionExt:"ses",SDKExt:"sdk"},ao=new jS});function iSe(t){var e=null;if(pt(Event))e=new Event(t);else{var r=ui();r&&r.createEvent&&(e=r.createEvent("Event"),e.initEvent(t,!0,!0))}return e}var oSe=R(()=>{Vr()});function sSe(t,e){Of(t,null,null,e)}function $5(t){var e=ui(),r=ro(),n=!1,o=[],s=1;r&&!Te(r.onLine)&&!r.onLine&&(s=2);var a=0,c=f(),u=wc(gs("OfflineListener"),t);try{if(d(li())&&(n=!0),e){var l=e.body||e;l.ononline&&d(l)&&(n=!0)}}catch{n=!1}function d(b){var S=!1;return b&&(S=Md(b,"online",g,u),S&&Md(b,"offline",v,u)),S}function p(){return c}function f(){return!(a===2||s===2)}function m(){var b=f();c!==b&&(c=b,_e(o,function(S){var I={isOnline:c,rState:s,uState:a};try{S(I)}catch{}}))}function h(b){a=b,m()}function g(){s=1,m()}function v(){s=2,m()}function y(){var b=li();if(b&&n){if(sSe(b,u),e){var S=e.body||e;wt(S.ononline)||sSe(S,u)}n=!1}}function _(b){return o[qf](b),{rm:function(){var S=o.indexOf(b);if(S>-1)return o.splice(S,1)}}}return{isOnline:p,isListening:function(){return n},unload:y,addListener:_,setOnlineState:h}}var aSe=R(()=>{Vr();Co()});var cSe={};dn(cSe,{AnalyticsPluginIdentifier:()=>rKe,BreezeChannelIdentifier:()=>GK,ConfigurationManager:()=>J1e,ConnectionStringParser:()=>k1e,ContextTagKeys:()=>jS,CtxTagKeys:()=>ao,DEFAULT_BREEZE_ENDPOINT:()=>Cg,DEFAULT_BREEZE_PATH:()=>Gd,Data:()=>Yd,DisabledPropertyName:()=>o1e,DistributedTracingModes:()=>b1e,Envelope:()=>H5,Event:()=>Wd,EventPersistence:()=>_1e,Exception:()=>Pg,Extensions:()=>rSe,HttpMethod:()=>Rk,Metric:()=>Kd,PageView:()=>Dg,PageViewPerformance:()=>Og,ProcessLegacy:()=>NS,PropertiesPluginIdentifier:()=>tKe,RemoteDependencyData:()=>Ng,RequestHeaders:()=>tb,SampleRate:()=>DS,SeverityLevel:()=>G5,TelemetryItemCreator:()=>eSe,ThrottleMgr:()=>w1e,Trace:()=>Lg,correlationIdCanIncludeCorrelationHeader:()=>f1e,correlationIdGetCorrelationContext:()=>m1e,correlationIdGetCorrelationContextValue:()=>AK,correlationIdGetPrefix:()=>p1e,correlationIdSetPrefix:()=>d1e,createDistributedTraceContextFromTrace:()=>y1e,createDomEvent:()=>iSe,createOfflineListener:()=>$5,createTelemetryItem:()=>zK,createTraceParent:()=>ik,dataSanitizeException:()=>D5,dataSanitizeId:()=>N5,dataSanitizeInput:()=>L5,dataSanitizeKey:()=>TK,dataSanitizeKeyAndAddUniqueness:()=>P5,dataSanitizeMeasurements:()=>$s,dataSanitizeMessage:()=>MS,dataSanitizeProperties:()=>Vs,dataSanitizeString:()=>un,dataSanitizeUrl:()=>Rg,dateTimeUtilsDuration:()=>v1e,dateTimeUtilsNow:()=>g1e,dsPadNumber:()=>EK,findW3cTraceParent:()=>ak,formatTraceParent:()=>sk,getExtensionByName:()=>G1e,isBeaconApiSupported:()=>Xa,isCrossOriginError:()=>V1e,isInternalApplicationInsightsEndpoint:()=>Nk,isSampledFlag:()=>ok,isValidSpanId:()=>Ld,isValidTraceId:()=>Nd,isValidTraceParent:()=>hS,msToTimeSpan:()=>qS,parseConnectionString:()=>Lk,parseTraceParent:()=>Hy,strNotSpecified:()=>Io,stringToBoolOrDefault:()=>z1e,urlGetAbsoluteUrl:()=>c1e,urlGetCompleteUrl:()=>l1e,urlGetPathName:()=>u1e,urlParseFullHost:()=>Dk,urlParseHost:()=>wK,urlParseUrl:()=>ub,utlCanUseLocalStorage:()=>US,utlCanUseSessionStorage:()=>lb,utlDisableStorage:()=>S1e,utlEnableStorage:()=>I1e,utlGetLocalStorage:()=>F5,utlGetSessionStorage:()=>B5,utlGetSessionStorageKeys:()=>T1e,utlRemoveSessionStorage:()=>E1e,utlRemoveStorage:()=>C1e,utlSetLocalStorage:()=>U5,utlSetSessionStorage:()=>q5,utlSetStoragePrefix:()=>M5});var tKe,GK,rKe,Hf=R(()=>{PK();R1e();A1e();_K();Iu();P1e();D1e();B1e();j1e();$1e();W1e();K1e();Y1e();Q1e();X1e();Z1e();jK();Tu();tSe();nSe();DK();z5();Vr();oSe();OK();RK();aSe();tKe="AppInsightsPropertiesPlugin",GK="AppInsightsChannelPlugin",rKe="ApplicationInsightsAnalytics"});var Ug,uSe=R(()=>{Ug="duration"});var co,W5,ys,Qd,fb,Vt,Bg,qg,Eu,Hg,jf,zS,zf,Gf,K5,Vf,Uk,jg,Bk,GS,mb,qk,Y5,$f,VS,$S,bs,Q5,WS,X5,VK,J5,Z5,$K,e6,WK,Wf,KK,YK,QK,XK,Hk,JK,ZK,eY,KS,zg,t6,jk,r6,lSe,n6,i6,YS,tY,o6,dSe,Gg=R(()=>{co="tags",W5="deviceType",ys="data",Qd="name",fb="traceID",Vt="length",Bg="stringify",qg="measurements",Eu="dataType",Hg="envelopeType",jf="toString",zS="_get",zf="enqueue",Gf="count",K5="eventsLimitInMem",Vf="push",Uk="emitLineDelimitedJson",jg="clear",Bk="createNew",GS="markAsSent",mb="clearSent",qk="bufferOverride",Y5="BUFFER_KEY",$f="SENT_BUFFER_KEY",VS="MAX_BUFFER_SIZE",$S="triggerSend",bs="diagLog",Q5="initialize",WS="_sender",X5="customHeaders",VK="maxBatchSizeInBytes",J5="onunloadDisableBeacon",Z5="isBeaconApiDisabled",$K="alwaysUseXhrOverride",e6="disableXhr",WK="enableSessionStorageBuffer",Wf="_buffer",KK="onunloadDisableFetch",YK="disableSendBeaconSplit",QK="instrumentationKey",XK="enableSendPromise",Hk="getSenderInst",JK="unloadTransports",ZK="convertUndefined",eY="maxBatchInterval",KS="serialize",zg="_onError",t6="_onPartialSuccess",jk="_onSuccess",r6="itemsAccepted",lSe="itemsReceived",n6="oriPayload",i6="baseType",YS="sampleRate",tY="eventsSendRequest",o6="getSamplingScore",dSe="getHashCodeScore"});function uo(t,e,r){return bu(t,e,r,du)}function nKe(t,e,r){var n=r[co]=r[co]||{},o=e.ext=e.ext||{},s=e[co]=e[co]||[],a=o.user;a&&(uo(n,ao.userAuthUserId,a.authId),uo(n,ao.userId,a.id||a.localId));var c=o.app;c&&uo(n,ao.sessionId,c.sesId);var u=o.device;u&&(uo(n,ao.deviceId,u.id||u.localId),uo(n,ao[W5],u.deviceClass),uo(n,ao.deviceIp,u.ip),uo(n,ao.deviceModel,u.model),uo(n,ao[W5],u[W5]));var l=e.ext.web;if(l){uo(n,ao.deviceLanguage,l.browserLang),uo(n,ao.deviceBrowserVersion,l.browserVer),uo(n,ao.deviceBrowser,l.browser);var d=r[ys]=r[ys]||{},p=d[Xn]=d[Xn]||{},f=p[Go]=p[Go]||{};uo(f,"domain",l.domain),uo(f,"isManual",l.isManual?pSe:null),uo(f,"screenRes",l.screenRes),uo(f,"userConsent",l.userConsent?pSe:null)}var m=o.os;m&&uo(n,ao.deviceOS,m[Qd]);var h=o.trace;h&&(uo(n,ao.operationParentId,h.parentID),uo(n,ao.operationName,un(t,h[Qd])),uo(n,ao.operationId,h[fb]));for(var g={},v=s[Vt]-1;v>=0;v--){var y=s[v];Ye(y,function(b,S){g[b]=S}),s.splice(v,1)}Ye(s,function(b,S){g[b]=S});var _=gu(gu({},n),g);_[ao.internalSdkVersion]||(_[ao.internalSdkVersion]=un(t,"javascript:".concat(iKe.Version),64)),r[co]=_u(_)}function Vg(t,e,r){Te(t)||Ye(t,function(n,o){Bs(o)?r[n]=o:Ot(o)?e[n]=o:Rd()&&(e[n]=hs()[Bg](o))})}function hb(t,e){Te(t)||Ye(t,function(r,n){t[r]=n||e})}function gb(t,e,r,n){var o=new H5(t,n,e);uo(o,"sampleRate",r[DS]),(r[Xn]||{}).startTime&&(o.time=Tc(r[Xn].startTime)),o.iKey=r.iKey;var s=r.iKey.replace(/-/g,"");return o[Qd]=o[Qd].replace("{0}",s),nKe(t,r,o),r[co]=r[co]||[],_u(o)}function vb(t,e){Te(e[Xn])&&Me(t,1,46,"telemetryItem.baseData cannot be null.")}function fSe(t,e,r){vb(t,e);var n=e[Xn][qg]||{},o=e[Xn][Go]||{};Vg(e[ys],o,n),Te(r)||hb(o,r);var s=e[Xn];if(Te(s))return fa(t,"Invalid input for dependency data"),null;var a=s[Go]&&s[Go][Rk]?s[Go][Rk]:"GET",c=new Ng(t,s.id,s.target,s[Qd],s[Ug],s.success,s.responseCode,a,s.type,s.correlationContext,o,n),u=new Yd(Ng[Eu],c);return gb(t,Ng[Hg],e,u)}function nY(t,e,r){vb(t,e);var n={},o={};e[rY]!==Wd[Eu]&&(n.baseTypeSource=e[rY]),e[rY]===Wd[Eu]?(n=e[Xn][Go]||{},o=e[Xn][qg]||{}):e[Xn]&&Vg(e[Xn],n,o),Vg(e[ys],n,o),Te(r)||hb(n,r);var s=e[Xn][Qd],a=new Wd(t,s,n,o),c=new Yd(Wd[Eu],a);return gb(t,Wd[Hg],e,c)}function mSe(t,e,r){vb(t,e);var n=e[Xn][qg]||{},o=e[Xn][Go]||{};Vg(e[ys],o,n),Te(r)||hb(o,r);var s=e[Xn],a=Pg.CreateFromInterface(t,s,o,n),c=new Yd(Pg[Eu],a);return gb(t,Pg[Hg],e,c)}function hSe(t,e,r){vb(t,e);var n=e[Xn],o=n[Go]||{},s=n[qg]||{};Vg(e[ys],o,s),Te(r)||hb(o,r);var a=new Kd(t,n[Qd],n.average,n.sampleCount,n.min,n.max,n.stdDev,o,s),c=new Yd(Kd[Eu],a);return gb(t,Kd[Hg],e,c)}function gSe(t,e,r){vb(t,e);var n,o=e[Xn];!Te(o)&&!Te(o[Go])&&!Te(o[Go][Ug])?(n=o[Go][Ug],delete o[Go][Ug]):!Te(e[ys])&&!Te(e[ys][Ug])&&(n=e[ys][Ug],delete e[ys][Ug]);var s=e[Xn],a;((e.ext||{}).trace||{})[fb]&&(a=e.ext.trace[fb]);var c=s.id||a,u=s[Qd],l=s.uri,d=s[Go]||{},p=s[qg]||{};if(Te(s.refUri)||(d.refUri=s.refUri),Te(s.pageType)||(d.pageType=s.pageType),Te(s.isLoggedIn)||(d.isLoggedIn=s.isLoggedIn[jf]()),!Te(s[Go])){var f=s[Go];Ye(f,function(g,v){d[g]=v})}Vg(e[ys],d,p),Te(r)||hb(d,r);var m=new Dg(t,u,l,n,d,p,c),h=new Yd(Dg[Eu],m);return gb(t,Dg[Hg],e,h)}function vSe(t,e,r){vb(t,e);var n=e[Xn],o=n[Qd],s=n.uri||n.url,a=n[Go]||{},c=n[qg]||{};Vg(e[ys],a,c),Te(r)||hb(a,r);var u=new Og(t,o,s,void 0,a,c,n),l=new Yd(Og[Eu],u);return gb(t,Og[Hg],e,l)}function ySe(t,e,r){vb(t,e);var n=e[Xn].message,o=e[Xn].severityLevel,s=e[Xn][Go]||{},a=e[Xn][qg]||{};Vg(e[ys],s,a),Te(r)||hb(s,r);var c=new Lg(t,n,o,s,a),u=new Yd(Lg[Eu],c);return gb(t,Lg[Hg],e,u)}var rY,Xn,Go,pSe,iKe,bSe=R(()=>{Ga();Hf();Vr();uSe();Gg();rY="baseType",Xn="baseData",Go="properties",pSe="true";iKe={Version:"3.1.1"}});var _Se,s6,iY,xSe=R(()=>{Ga();Ho();Hf();Vr();Gg();_Se=function(){function t(e,r){var n=[],o=!1;this[zS]=function(){return n},this._set=function(s){return n=s,n},nr(t,this,function(s){s[zf]=function(a){if(s[Gf]()>=r[K5]){o||(Me(e,2,105,"Maximum in-memory buffer size reached: "+s[Gf](),!0),o=!0);return}n[Vf](a)},s[Gf]=function(){return n[Vt]},s.size=function(){for(var a=n[Vt],c=0;c<n[Vt];c++)a+=n[c][Vt];return r[Uk]||(a+=2),a},s[jg]=function(){n=[],o=!1},s.getItems=function(){return n.slice(0)},s.batchPayloads=function(a){if(a&&a[Vt]>0){var c=r[Uk]?a.join(`
`):"["+a.join(",")+"]";return c}return null},s[Bk]=function(a,c,u){var l=n.slice(0);a=a||e,c=c||{};var d=u?new iY(a,c):new s6(a,c);return _e(l,function(p){d[zf](p)}),d}})}return t.__ieDyn=1,t}(),s6=function(t){za(e,t);function e(r,n){var o=t.call(this,r,n)||this;return nr(e,o,function(s,a){s[GS]=function(c){a[jg]()},s[mb]=function(c){}}),o}return e.__ieDyn=1,e}(_Se),iY=function(t){za(e,t);function e(r,n){var o=t.call(this,r,n)||this,s=!1,a=n?.namePrefix,c=n[qk]||{getItem:B5,setItem:q5},u=c.getItem,l=c.setItem;return nr(e,o,function(d,p){var f=v(e[Y5]),m=v(e[$f]),h=d._set(f.concat(m));h[Vt]>e[VS]&&(h[Vt]=e[VS]),y(e[$f],[]),y(e[Y5],h),d[zf]=function(_){if(d[Gf]()>=e[VS]){s||(Me(r,2,67,"Maximum buffer size reached: "+d[Gf](),!0),s=!0);return}p[zf](_),y(e.BUFFER_KEY,d[zS]())},d[jg]=function(){p[jg](),y(e.BUFFER_KEY,d[zS]()),y(e[$f],[]),s=!1},d[GS]=function(_){y(e[Y5],d._set(g(_,d[zS]())));var b=v(e[$f]);b instanceof Array&&_ instanceof Array&&(b=b.concat(_),b[Vt]>e[VS]&&(Me(r,1,67,"Sent buffer reached its maximum size: "+b[Vt],!0),b[Vt]=e[VS]),y(e[$f],b))},d[mb]=function(_){var b=v(e[$f]);b=g(_,b),y(e[$f],b)},d[Bk]=function(_,b,S){S=!!S;var I=d[zS]().slice(0),w=v(e[$f]).slice(0);_=_||r,b=b||{},d[jg]();var O=S?new e(_,b):new s6(_,b);return _e(I,function(U){O[zf](U)}),S&&O[GS](w),O};function g(_,b){var S=[];return _e(b,function(I){!pt(I)&&wr(_,I)===-1&&S[Vf](I)}),S}function v(_){var b=_;try{b=a?a+"_"+b:b;var S=u(r,b);if(S){var I=hs().parse(S);if(Ot(I)&&(I=hs().parse(I)),I&&et(I))return I}}catch(w){Me(r,1,42," storage key: "+b+", "+En(w),{exception:Ve(w)})}return[]}function y(_,b){var S=_;try{S=a?a+"_"+S:S;var I=JSON[Bg](b);l(r,S,I)}catch(w){l(r,S,JSON[Bg]([])),Me(r,2,41," storage key: "+S+", "+En(w)+". Buffer cleared",{exception:Ve(w)})}}}),o}return e.BUFFER_KEY="AI_buffer",e.SENT_BUFFER_KEY="AI_sentBuffer",e.MAX_BUFFER_SIZE=2e3,e}(_Se)});var SSe,ISe=R(()=>{Ho();Vr();Gg();SSe=function(){function t(e){nr(t,this,function(r){r[KS]=function(a){var c=n(a,"root");try{return hs()[Bg](c)}catch(u){Me(e,1,48,u&&pt(u[jf])?u[jf]():"Error serializing object",null,!0)}};function n(a,c){var u="__aiCircularRefCheck",l={};if(!a)return Me(e,1,48,"cannot serialize object because it is null or undefined",{name:c},!0),l;if(a[u])return Me(e,2,50,"Circular reference detected while serializing object",{name:c},!0),l;if(!a.aiDataContract){if(c==="measurements")l=s(a,"number",c);else if(c==="properties")l=s(a,"string",c);else if(c==="tags")l=s(a,"string",c);else if(et(a))l=o(a,c);else{Me(e,2,49,"Attempting to serialize an object which does not implement ISerializable",{name:c},!0);try{hs()[Bg](a),l=a}catch(d){Me(e,1,48,d&&pt(d[jf])?d[jf]():"Error serializing object",null,!0)}}return l}return a[u]=!0,Ye(a.aiDataContract,function(d,p){var f=pt(p)?p()&1:p&1,m=pt(p)?p()&4:p&4,h=p&2,g=a[d]!==void 0,v=Tn(a[d])&&a[d]!==null;if(f&&!g&&!h)Me(e,1,24,"Missing required field specification. The field is required but not present on source",{field:d,name:c});else if(!m){var y=void 0;v?h?y=o(a[d],d):y=n(a[d],d):y=a[d],y!==void 0&&(l[d]=y)}}),delete a[u],l}function o(a,c){var u;if(a)if(!et(a))Me(e,1,54,`This field was specified as an array in the contract but the item is not an array.\r
`,{name:c},!0);else{u=[];for(var l=0;l<a[Vt];l++){var d=a[l],p=n(d,c+"["+l+"]");u[Vf](p)}}return u}function s(a,c,u){var l;return a&&(l={},Ye(a,function(d,p){if(c==="string")p===void 0?l[d]="undefined":p===null?l[d]="null":p[jf]?l[d]=p[jf]():l[d]="invalid field: toString() is not defined.";else if(c==="number")if(p===void 0)l[d]="undefined";else if(p===null)l[d]="null";else{var f=parseFloat(p);l[d]=f}else l[d]="invalid field: "+u+" is of unknown type.",Me(e,1,l[d],null,!0)})),l}})}return t.__ieDyn=1,t}()});var oKe,CSe,TSe=R(()=>{Gg();oKe=8,CSe=function(){function t(){}return t.prototype.getHashCodeScore=function(e){var r=this.getHashCode(e)/t.INT_MAX_VALUE;return r*100},t.prototype.getHashCode=function(e){if(e==="")return 0;for(;e[Vt]<oKe;)e=e.concat(e);for(var r=5381,n=0;n<e[Vt];++n)r=(r<<5)+r+e.charCodeAt(n),r=r&r;return Math.abs(r)},t.INT_MAX_VALUE=2147483647,t}()});var ESe,wSe=R(()=>{Hf();Gg();TSe();ESe=function(){function t(){var e=this,r=new CSe,n=new jS;e[o6]=function(o){var s=0;return o[co]&&o[co][n.userId]?s=r.getHashCodeScore(o[co][n.userId]):o.ext&&o.ext.user&&o.ext.user.id?s=r[dSe](o.ext.user.id):o[co]&&o[co][n.operationId]?s=r.getHashCodeScore(o[co][n.operationId]):o.ext&&o.ext.telemetryTrace&&o.ext.telemetryTrace[fb]?s=r.getHashCodeScore(o.ext.telemetryTrace[fb]):s=Math.random()*100,s}}return t}()});var RSe,kSe=R(()=>{Hf();Vr();Gg();wSe();RSe=function(){function t(e,r){this.INT_MAX_VALUE=2147483647;var n=r||bl(null);(e>100||e<0)&&(n.throwInternal(2,58,"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.",{samplingRate:e},!0),e=100),this[YS]=e,this.samplingScoreGenerator=new ESe}return t.prototype.isSampledIn=function(e){var r=this[YS],n=!1;return r==null||r>=100||e.baseType===Kd[Eu]?!0:(n=this.samplingScoreGenerator[o6](e)<r,n)},t}()});function PSe(t){try{return t.responseText}catch{}return null}function aKe(t){return t&&t.sendPOST}function cKe(t){return!isNaN(t)&&t>0&&t<=100}var Jn,Kf,Xd,ASe,sKe,DSe,uKe,zk,NSe=R(()=>{Ga();Ho();Hf();Vr();vt();bSe();xSe();ISe();kSe();Gg();Xd=void 0,ASe="",sKe=65e3;DSe=la((Jn={endpointUrl:pS(du,Cg+Gd)},Jn[Uk]=xu(),Jn[eY]=15e3,Jn[VK]=102400,Jn.disableTelemetry=xu(),Jn[WK]=xu(!0),Jn.isRetryDisabled=xu(),Jn[Z5]=xu(!0),Jn[YK]=xu(!0),Jn[e6]=xu(),Jn[KK]=xu(),Jn[J5]=xu(),Jn[QK]=Xd,Jn.namePrefix=Xd,Jn.samplingPercentage=pS(cKe,100),Jn[X5]=Xd,Jn[ZK]=Xd,Jn[K5]=1e4,Jn[qk]=!1,Jn.httpXHROverride={isVal:aKe,v:Xd},Jn[$K]=xu(),Jn.transports=Xd,Jn.retryCodes=Xd,Jn));uKe=(Kf={},Kf[Wd.dataType]=nY,Kf[Lg.dataType]=ySe,Kf[Dg.dataType]=gSe,Kf[Og.dataType]=vSe,Kf[Pg.dataType]=mSe,Kf[Kd.dataType]=hSe,Kf[Ng.dataType]=fSe,Kf),zk=function(t){za(e,t);function e(){var r=t.call(this)||this;r.priority=1001,r.identifier=GK;var n,o,s,a,c,u,l,d,p=0,f,m,h,g,v,y,_,b,S,I,w,O,U,z,M,re,ee,N,E,P,q,F,Z,ue,te,Q,je;return nr(e,r,function(ne,ht){ut(),ne.pause=function(){Ca(),a=!0},ne.resume=function(){a&&(a=!1,o=null,hi(),Ul())},ne.flush=function(V,ae,he){if(V===void 0&&(V=!0),!a){Ca();try{return ne[$S](V,null,he||1)}catch(Ce){Me(ne[bs](),1,22,"flush failed, telemetry will not be collected: "+En(Ce),{exception:Ve(Ce)})}}},ne.onunloadFlush=function(){if(!a)if(_||P)try{return ne[$S](!0,l_,2)}catch(V){Me(ne[bs](),1,20,"failed to flush with beacon sender on page unload, telemetry will not be collected: "+En(V),{exception:Ve(V)})}else ne.flush(!1)},ne.addHeader=function(V,ae){d[V]=ae},ne[Q5]=function(V,ae,he,Ce){ne.isInitialized()&&Me(ne[bs](),1,28,"Sender is already initialized"),ht[Q5](V,ae,he,Ce);var G=ne.identifier;u=new SSe(ae.logger),n=0,o=null,s=0,ne[WS]=null,l=0;var J=ne[bs]();h=wc(gs("Sender"),ae.evtNamespace&&ae.evtNamespace()),m=$5(h),ne._addHook(oo(V,function(de){var Ee=de.cfg;Ee.storagePrefix&&M5(Ee.storagePrefix);var Qe=ma(null,Ee,ae),Ne=Qe.getExtCfg(G,DSe);jr(ne,"_senderConfig",{g:function(){return Ne}}),v!==Ne.endpointUrl&&(g=v=Ne.endpointUrl),I&&I!==Ne[X5]&&_e(I,function(rs){delete d[rs.header]}),y=Ne[VK],_=(Ne[J5]===!1||Ne[Z5]===!1)&&Xa(),b=Ne[J5]===!1&&Xa(),S=Ne[Z5]===!1&&Xa(),P=Ne[$K],q=!!Ne[e6],je=Ne.retryCodes;var mr=Ne[qk],Cr=!!Ne[WK]&&(!!mr||lb()),zi=Ne.namePrefix,ac=Cr!==re||Cr&&N!==zi||Cr&&ee!==mr;if(ne[Wf]){if(ac)try{ne._buffer=ne._buffer[Bk](J,Ne,Cr)}catch(rs){Me(ne[bs](),1,12,"failed to transfer telemetry to different buffer storage, telemetry will be lost: "+En(rs),{exception:Ve(rs)})}hi()}else ne[Wf]=Cr?new iY(J,Ne):new s6(J,Ne);N=zi,re=Cr,ee=mr,F=!Ne[KK]&&If(!0),te=!!Ne[YK],ne._sample=new RSe(Ne.samplingPercentage,J),O=Ne[QK],He(O,Ee)||Me(J,1,100,"Invalid Instrumentation key "+O),I=Ne[X5],!Nk(g)&&I&&I[Vt]>0?_e(I,function(rs){r.addHeader(rs.header,rs.value)}):I=null,E=Ne[XK];var Em=Ct();Q?Q.SetConfig(Em):(Q=new zy,Q[Q5](Em,J));var Zs=Ne.httpXHROverride,wm=null,i0=null,fDe=Ef([3,1,2],Ne.transports);wm=Q&&Q[Hk](fDe,!1);var C7=Q&&Q.getFallbackInst();Z=function(rs,o0){return xt(C7,rs,o0)},ue=function(rs,o0){return xt(C7,rs,o0,!1)},wm=P?Zs:wm||Zs||C7,ne[WS]=function(rs,o0){return xt(wm,rs,o0)},F&&(f=d_);var T7=Ef([3,1],Ne[JK]);F||(T7=T7.filter(function(rs){return rs!==2})),i0=Q&&Q[Hk](T7,!0),i0=P?Zs:i0||Zs,(P||Ne[JK]||!f)&&i0&&(f=function(rs,o0){return xt(i0,rs,o0)}),f||(f=Z),w=Ne.disableTelemetry,U=Ne[ZK]||Xd,z=Ne.isRetryDisabled,M=Ne[eY]}))},ne.processTelemetry=function(V,ae){ae=ne._getTelCtx(ae);var he=ae[bs]();try{var Ce=nt(V,he);if(!Ce)return;var G=H(V,he);if(!G)return;var J=u[KS](G),de=ne[Wf];hi(J),de[zf](J),Ul()}catch(Ee){Me(he,2,12,"Failed adding telemetry to the sender's buffer, some telemetry will be lost: "+En(Ee),{exception:Ve(Ee)})}ne.processNext(V,ae)},ne.isCompletelyIdle=function(){return!a&&p===0&&ne._buffer[Gf]()===0},ne._xhrReadyStateChange=function(V,ae,he){return xr(V,ae,he)},ne[$S]=function(V,ae,he){V===void 0&&(V=!0);var Ce;if(!a)try{var G=ne[Wf];if(w)G[jg]();else{if(G[Gf]()>0){var J=G.getItems();Ae(he||0,V),ae?Ce=ae.call(ne,J,V):Ce=ne[WS](J,V)}s=+new Date}Ca()}catch(Ee){var de=qR();(!de||de>9)&&Me(ne[bs](),1,40,"Telemetry transmission failed, some telemetry will be lost: "+En(Ee),{exception:Ve(Ee)})}return Ce},ne.getOfflineSupport=function(){var V;return V={getUrl:function(){return g},createPayload:ke},V[KS]=le,V.batch=pe,V.shouldProcess=function(ae){return!!nt(ae)},V},ne._doTeardown=function(V,ae){ne.onunloadFlush(),kf(m,!1),ut()},ne[zg]=function(V,ae,he){Me(ne[bs](),2,26,"Failed to send telemetry.",{message:ae}),ne._buffer&&ne._buffer[mb](V)},ne[t6]=function(V,ae){for(var he=[],Ce=[],G=ae.errors.reverse(),J=0,de=G;J<de.length;J++){var Ee=de[J],Qe=V.splice(Ee.index,1)[0];Tm(Ee.statusCode)?Ce[Vf](Qe):he[Vf](Qe)}V[Vt]>0&&ne[jk](V,ae[r6]),he[Vt]>0&&ne[zg](he,Tf(null,["partial success",ae[r6],"of",ae.itemsReceived].join(" "))),Ce[Vt]>0&&(Rp(Ce),Me(ne[bs](),2,40,"Partial success. Delivered: "+V[Vt]+", Failed: "+he[Vt]+". Will retry to send "+Ce[Vt]+" our of "+ae[lSe]+" items"))},ne[jk]=function(V,ae){ne._buffer&&ne._buffer[mb](V)},ne._xdrOnLoad=function(V,ae){return We(V,ae)};function We(V,ae){var he=PSe(V);if(V&&(he+""=="200"||he===""))n=0,ne[jk](ae,0);else{var Ce=Fy(he);Ce&&Ce.itemsReceived&&Ce.itemsReceived>Ce[r6]&&!z?ne[t6](ae,Ce):ne[zg](ae,My(V))}}function Ct(){var V;try{var ae={xdrOnComplete:function(Ce,G,J){var de=ye(J);if(de)return We(Ce,de)},fetchOnComplete:function(Ce,G,J,de){var Ee=ye(de);if(Ee)return Js(Ce.status,Ee,Ce.url,Ee[Vt],Ce.statusText,J||"")},xhrOnComplete:function(Ce,G,J){var de=ye(J);if(de)return xr(Ce,de,de[Vt])},beaconOnRetry:function(Ce,G,J){return n0(Ce,G,J)}},he=(V={},V[XK]=E,V.isOneDs=!1,V.disableCredentials=!1,V[e6]=q,V.disableBeacon=!S,V.disableBeaconSync=!b,V.senderOnCompleteCallBack=ae,V);return he}catch{}return null}function xr(V,ae,he){V.readyState===4&&Js(V.status,ae,V.responseURL,he,Tf(V),PSe(V)||V.response)}function ye(V){try{if(V){var ae=V,he=ae[n6];return he&&he[Vt]?he:null}}catch{}return null}function nt(V,ae){if(w)return!1;if(!V)return ae&&Me(ae,1,7,"Cannot send empty telemetry"),!1;if(V.baseData&&!V[i6])return ae&&Me(ae,1,70,"Cannot send telemetry without baseData and baseType"),!1;if(V[i6]||(V[i6]="EventData"),!ne[WS])return ae&&Me(ae,1,28,"Sender was not initialized"),!1;if(Ie(V))V[DS]=ne._sample[YS];else return ae&&Me(ae,2,33,"Telemetry item was sampled out and not sent",{SampleRate:ne._sample[YS]}),!1;return!0}function H(V,ae){var he=V.iKey||O,Ce=e.constructEnvelope(V,he,ae,U);if(!Ce){Me(ae,1,47,"Unable to create an AppInsights envelope");return}var G=!1;if(V[co]&&V[co][NS]&&(_e(V[co][NS],function(J){try{J&&J(Ce)===!1&&(G=!0,fa(ae,"Telemetry processor check returns false"))}catch(de){Me(ae,1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+En(de),{exception:Ve(de)},!0)}}),delete V[co][NS]),!G)return Ce}function le(V){var ae=ASe,he=ne[bs]();try{var Ce=nt(V,he),G=null;Ce&&(G=H(V,he)),G&&(ae=u[KS](G))}catch{}return ae}function pe(V){var ae=ASe;return V&&V[Vt]&&(ae="["+V.join(",")+"]"),ae}function ke(V){var ae,he=An();return ae={urlString:g},ae[ys]=V,ae.headers=he,ae}function Ie(V){return ne._sample.isSampledIn(V)}function it(V,ae,he,Ce){ae===200&&V?ne._onSuccess(V,V[Vt]):Ce&&ne[zg](V,Ce)}function xt(V,ae,he,Ce){Ce===void 0&&(Ce=!0);var G=function(Ee,Qe,Ne){return it(ae,Ee,Qe,Ne)},J=rn(ae),de=V&&V.sendPOST;return de&&J?(Ce&&ne._buffer[GS](ae),de(J,G,!he)):null}function rn(V){var ae;if(et(V)&&V[Vt]>0){var he=ne[Wf].batchPayloads(V),Ce=An(),G=(ae={},ae[ys]=he,ae.urlString=g,ae.headers=Ce,ae.disableXhrSync=q,ae.disableFetchKeepAlive=!F,ae[n6]=V,ae);return G}return null}function An(){try{var V=d||{};return Nk(g)&&(V[tb[6]]=tb[7]),V}catch{}return null}function hi(V){var ae=V?V[Vt]:0;return ne[Wf].size()+ae>y?((!m||m.isOnline())&&ne[$S](!0,null,10),!0):!1}function Js(V,ae,he,Ce,G,J){var de=null;if(ne._appId||(de=Fy(J),de&&de.appId&&(ne._appId=de.appId)),(V<200||V>=300)&&V!==0){if((V===301||V===307||V===308)&&!wp(he)){ne[zg](ae,G);return}!z&&Tm(V)?(Rp(ae),Me(ne[bs](),2,40,". Response code "+V+". Will retry to send "+ae[Vt]+" items.")):ne[zg](ae,G)}else if(m&&!m.isOnline()){if(!z){var Ee=10;Rp(ae,Ee),Me(ne[bs](),2,40,". Offline - Response Code: ".concat(V,". Offline status: ").concat(!m.isOnline(),". Will retry to send ").concat(ae.length," items."))}}else wp(he),V===206?(de||(de=Fy(J)),de&&!z?ne[t6](ae,de):ne[zg](ae,G)):(n=0,ne[jk](ae,Ce))}function wp(V){return l>=10?!1:!Te(V)&&V!==""&&V!==g?(g=V,++l,!0):!1}function l_(V,ae){if(f)f(V,!1);else{var he=Q&&Q[Hk]([3],!0);return xt(he,V,ae)}}function n0(V,ae,he){var Ce=V,G=Ce&&Ce[n6];if(te)ue&&ue(G,!0),Me(ne[bs](),2,40,". Failed to send telemetry with Beacon API, retried with normal sender.");else{for(var J=[],de=0;de<G[Vt];de++){var Ee=G[de],Qe=[Ee],Ne=rn(Qe);he(Ne,ae)?ne._onSuccess(Qe,Qe[Vt]):J[Vf](Ee)}J[Vt]>0&&(ue&&ue(J,!0),Me(ne[bs](),2,40,". Failed to send telemetry with Beacon API, retried with normal sender."))}}function d_(V,ae){var he=null;if(et(V)){for(var Ce=V[Vt],G=0;G<V[Vt];G++)Ce+=V[G][Vt];var J=Q.getSyncFetchPayload();J+Ce<=sKe?he=2:Xa()?he=3:(he=1,Me(ne[bs](),2,40,". Failed to send telemetry with Beacon API, retried with xhrSender."));var de=Q&&Q[Hk]([he],!0);return xt(de,V,ae)}return null}function Rp(V,ae){if(ae===void 0&&(ae=1),!(!V||V[Vt]===0)){var he=ne[Wf];he[mb](V),n++;for(var Ce=0,G=V;Ce<G.length;Ce++){var J=G[Ce];he[zf](J)}rE(ae),Ul()}}function rE(V){var ae=10,he;if(n<=1)he=ae;else{var Ce=(Math.pow(2,n)-1)/2,G=Math.floor(Math.random()*Ce*ae)+1;G=V*G,he=Math.max(Math.min(G,3600),ae)}var J=di()+he*1e3;o=J}function Ul(){if(!c&&!a){var V=o?Math.max(0,o-di()):0,ae=Math.max(M,V);c=ja(function(){c=null,ne[$S](!0,null,1)},ae)}}function Ca(){c&&c.cancel(),c=null,o=null}function Tm(V){return Te(je)?V===401||V===408||V===429||V===500||V===502||V===503||V===504:je[Vt]&&je.indexOf(V)>-1}function X(){var V="getNotifyMgr";return ne.core[V]?ne.core[V]():ne.core._notificationManager}function Ae(V,ae){var he=X();if(he&&he[tY])try{he[tY](V,ae)}catch(Ce){Me(ne[bs](),1,74,"send request notification failed: "+En(Ce),{exception:Ve(Ce)})}}function He(V,ae){var he=ae.disableInstrumentationKeyValidation,Ce=Te(he)?!1:he;if(Ce)return!0;var G="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",J=new RegExp(G);return J.test(V)}function ut(){ne[WS]=null,ne[Wf]=null,ne._appId=null,ne._sample=null,d={},m=null,n=0,o=null,s=null,a=!1,c=null,u=null,l=0,p=0,f=null,h=null,g=null,v=null,y=0,_=!1,I=null,w=!1,O=null,U=Xd,z=!1,re=null,N=Xd,q=!1,F=!1,te=!1,Z=null,ue=null,Q=null,jr(ne,"_senderConfig",{g:function(){return s3({},DSe)}})}}),r}return e.constructEnvelope=function(r,n,o,s){var a;n!==r.iKey&&!Te(n)?a=gu(gu({},r),{iKey:n}):a=r;var c=uKe[a.baseType]||nY;return c(o,a,s)},e}(Nf)});var oY=R(()=>{NSe()});var a6,c6,u6,Gk,LSe=R(()=>{a6="instrumentationKey",c6="connectionString",u6="endpointUrl",Gk="userOverrideEndpointUrl"});var OSe={};dn(OSe,{AppInsightsCore:()=>Lf,ApplicationInsights:()=>pKe,Sender:()=>zk,SeverityLevel:()=>G5,arrForEach:()=>_e,isNullOrUndefined:()=>Te,proxyFunctions:()=>Ec,throwError:()=>ci});function dKe(t){return t&&t>0}var lKe,pKe,MSe=R(()=>{Ho();oY();Hf();Vr();vt();LSe();Vr();Hf();oY();lKe={diagnosticLogInterval:pS(dKe,1e4)};pKe=function(){function t(e){var r=new Lf,n;(Te(e)||Te(e[a6])&&Te(e[c6]))&&ci("Invalid input configuration"),nr(t,this,function(s){jr(s,"config",{g:function(){return n}}),a(),s.initialize=a,s.track=o,Ec(s,r,["flush","pollInternalLogs","stopPollingInternalLogs","unload","getPlugin","addPlugin","evtNamespace","addUnloadCb","onCfgChange"]);function a(){var c=Yn(e||{},lKe);n=c.cfg,r.addUnloadHook(oo(c,function(){if(n[c6]){var u=Lk(n[c6]),l=u.ingestionendpoint;n[u6]=n[Gk]?n[Gk]:l+Gd,n[a6]=u.instrumentationkey||n[a6]}n[u6]=n[Gk]?n[Gk]:n[u6]})),r.initialize(n,[new zk])}});function o(s){s&&(s.baseData=s.baseData||{},s.baseType=s.baseType||"EventData"),r.track(s)}}return t.__ieDyn=1,t}()});var FSe=L(Jd=>{"use strict";var fKe=Jd&&Jd.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var o=Object.getOwnPropertyDescriptor(e,r);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,o)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),mKe=Jd&&Jd.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),hKe=Jd&&Jd.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&fKe(e,t,r);return mKe(e,t),e};Object.defineProperty(Jd,"__esModule",{value:!0});Jd.appInsightsClientFactory=void 0;var gKe=(Hf(),Gi(cSe)),vKe=vV(),yKe=async(t,e,r)=>{let n;try{let s=await Promise.resolve().then(()=>hKe((MSe(),Gi(OSe)))),a={};if(e){let c={alwaysUseXhrOverride:!0,httpXHROverride:e};a[gKe.BreezeChannelIdentifier]=c}n=new s.ApplicationInsights({instrumentationKey:t,disableAjaxTracking:!0,disableExceptionTracking:!0,disableFetchTracking:!0,disableCorrelationHeaders:!0,disableCookiesUsage:!0,autoTrackPageVisitTime:!1,emitLineDelimitedJson:!1,disableInstrumentationKeyValidation:!0,extensionConfig:a})}catch(s){return Promise.reject(s)}return{logEvent:(s,a)=>{let c={...a?.properties,...a?.measurements};r?.length&&vKe.TelemetryUtil.applyReplacements(c,r),n?.track({name:s,data:c,baseType:"EventData",baseData:{name:s,properties:a?.properties,measurements:a?.measurements}})},flush:async()=>{n?.flush(!1)},dispose:async()=>new Promise(a=>{n?.unload(!0,()=>{a(),n=void 0},1e3)})}};Jd.appInsightsClientFactory=yKe});var HSe=L(Yf=>{"use strict";var bKe=Yf&&Yf.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var o=Object.getOwnPropertyDescriptor(e,r);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,o)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),_Ke=Yf&&Yf.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),cY=Yf&&Yf.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&bKe(e,t,r);return _Ke(e,t),e};Object.defineProperty(Yf,"__esModule",{value:!0});var sY=cY(require("os")),USe=cY(require("vscode")),xKe=cY(require("https")),SKe=rye(),IKe=nye(),BSe=vV(),CKe=i1e(),TKe=FSe();function qSe(){return{sendPOST:(e,r)=>{let n={method:"POST",headers:{...e.headers,"Content-Type":"application/json","Content-Length":Buffer.byteLength(e.data)}};try{let o=xKe.request(e.urlString,n,s=>{s.on("data",function(a){r(s.statusCode??200,s.headers,a.toString())}),s.on("error",function(){r(0,{})})});o.write(e.data,s=>{s&&r(0,{})}),o.end()}catch{r(0,{})}}}}var aY=class extends SKe.BaseTelemetryReporter{constructor(e,r){let n=a=>(0,TKe.appInsightsClientFactory)(a,qSe(),r);BSe.TelemetryUtil.shouldUseOneDataSystemSDK(e)&&(n=a=>(0,CKe.oneDataSystemClientFactory)(a,USe,qSe()));let o={release:sY.release(),platform:sY.platform(),architecture:sY.arch()},s=new IKe.BaseTelemetrySender(e,n);if(e&&e.indexOf("AIF-")===0)throw new Error("AIF keys are no longer supported. Please switch to 1DS keys for 1st party extensions");super(s,USe,{additionalCommonProperties:BSe.TelemetryUtil.getAdditionalCommonProperties(o)})}};Yf.default=aY});var fCe=L(rv=>{"use strict";var PQe=rv&&rv.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})};Object.defineProperty(rv,"__esModule",{value:!0});rv.isBinaryFileSync=rv.isBinaryFile=void 0;var tv=require("fs"),TQ=require("util"),DQe=TQ.promisify(tv.stat),NQe=TQ.promisify(tv.open),LQe=TQ.promisify(tv.close),Qk=512,CQ=class{constructor(e,r){this.fileBuffer=e,this.size=r,this.offset=0,this.error=!1}hasError(){return this.error}nextByte(){return this.offset===this.size||this.hasError()?(this.error=!0,255):this.fileBuffer[this.offset++]}next(e){let r=new Array;for(let n=0;n<e;n++)r[n]=this.nextByte();return r}};function IQ(t){let e=0,r=0;for(;!t.hasError();){let n=t.nextByte();if(r=r|(n&127)<<7*e,!(n&128))break;e++}return r}function OQe(t){switch(IQ(t)&7){case 0:return IQ(t),!0;case 1:return t.next(8),!0;case 2:let n=IQ(t);return t.next(n),!0;case 5:return t.next(4),!0}return!1}function MQe(t,e){let r=new CQ(t,e),n=0;for(;;){if(!OQe(r)&&!r.hasError())return!1;if(r.hasError())break;n++}return n>0}function FQe(t,e){return PQe(this,void 0,void 0,function*(){if(dCe(t)){let r=yield DQe(t);pCe(r);let n=yield NQe(t,"r"),o=Buffer.alloc(Qk);return new Promise((s,a)=>{tv.read(n,o,0,Qk,0,(c,u,l)=>{LQe(n),c?a(c):s(B6(o,u))})})}else return e===void 0&&(e=t.length),B6(t,e)})}rv.isBinaryFile=FQe;function UQe(t,e){if(dCe(t)){let r=tv.statSync(t);pCe(r);let n=tv.openSync(t,"r"),o=Buffer.alloc(Qk),s=tv.readSync(n,o,0,Qk,0);return tv.closeSync(n),B6(o,s)}else return e===void 0&&(e=t.length),B6(t,e)}rv.isBinaryFileSync=UQe;function B6(t,e){if(e===0)return!1;let r=0,n=Math.min(e,Qk);if(e>=3&&t[0]===239&&t[1]===187&&t[2]===191||e>=4&&t[0]===0&&t[1]===0&&t[2]===254&&t[3]===255||e>=4&&t[0]===255&&t[1]===254&&t[2]===0&&t[3]===0||e>=4&&t[0]===132&&t[1]===49&&t[2]===149&&t[3]===51)return!1;if(n>=5&&t.slice(0,5).toString()==="%PDF-")return!0;if(e>=2&&t[0]===254&&t[1]===255||e>=2&&t[0]===255&&t[1]===254)return!1;for(let o=0;o<n;o++){if(t[o]===0)return!0;if((t[o]<7||t[o]>14)&&(t[o]<32||t[o]>127)){if(t[o]>193&&t[o]<224&&o+1<n){if(o++,t[o]>127&&t[o]<192)continue}else if(t[o]>223&&t[o]<240&&o+2<n&&(o++,t[o]>127&&t[o]<192&&t[o+1]>127&&t[o+1]<192)){o++;continue}if(r++,o>=32&&r*100/n>10)return!0}}return!!(r*100/n>10||r>1&&MQe(t,n))}function dCe(t){return typeof t=="string"}function pCe(t){if(!t.isFile())throw new Error("Path provided was not a file!")}});var Zk=L((PGt,xCe)=>{"use strict";var np="\\\\/",vCe=`[^${np}]`,Zf="\\.",KQe="\\+",YQe="\\?",j6="\\/",QQe="(?=.)",yCe="[^/]",DQ=`(?:${j6}|$)`,bCe=`(?:^|${j6})`,NQ=`${Zf}{1,2}${DQ}`,XQe=`(?!${Zf})`,JQe=`(?!${bCe}${NQ})`,ZQe=`(?!${Zf}{0,1}${DQ})`,eXe=`(?!${NQ})`,tXe=`[^.${j6}]`,rXe=`${yCe}*?`,nXe="/",_Ce={DOT_LITERAL:Zf,PLUS_LITERAL:KQe,QMARK_LITERAL:YQe,SLASH_LITERAL:j6,ONE_CHAR:QQe,QMARK:yCe,END_ANCHOR:DQ,DOTS_SLASH:NQ,NO_DOT:XQe,NO_DOTS:JQe,NO_DOT_SLASH:ZQe,NO_DOTS_SLASH:eXe,QMARK_NO_DOT:tXe,STAR:rXe,START_ANCHOR:bCe,SEP:nXe},iXe={..._Ce,SLASH_LITERAL:`[${np}]`,QMARK:vCe,STAR:`${vCe}*?`,DOTS_SLASH:`${Zf}{1,2}(?:[${np}]|$)`,NO_DOT:`(?!${Zf})`,NO_DOTS:`(?!(?:^|[${np}])${Zf}{1,2}(?:[${np}]|$))`,NO_DOT_SLASH:`(?!${Zf}{0,1}(?:[${np}]|$))`,NO_DOTS_SLASH:`(?!${Zf}{1,2}(?:[${np}]|$))`,QMARK_NO_DOT:`[^.${np}]`,START_ANCHOR:`(?:^|[${np}])`,END_ANCHOR:`(?:[${np}]|$)`,SEP:"\\"},oXe={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};xCe.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:oXe,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,extglobChars(t){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${t.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(t){return t===!0?iXe:_Ce}}});var z6=L(tc=>{"use strict";var{REGEX_BACKSLASH:sXe,REGEX_REMOVE_BACKSLASH:aXe,REGEX_SPECIAL_CHARS:cXe,REGEX_SPECIAL_CHARS_GLOBAL:uXe}=Zk();tc.isObject=t=>t!==null&&typeof t=="object"&&!Array.isArray(t);tc.hasRegexChars=t=>cXe.test(t);tc.isRegexChar=t=>t.length===1&&tc.hasRegexChars(t);tc.escapeRegex=t=>t.replace(uXe,"\\$1");tc.toPosixSlashes=t=>t.replace(sXe,"/");tc.removeBackslashes=t=>t.replace(aXe,e=>e==="\\"?"":e);tc.supportsLookbehinds=()=>{if(typeof process<"u"){let t=process.version.slice(1).split(".").map(Number);if(t.length===3&&t[0]>=9||t[0]===8&&t[1]>=10)return!0}return!1};tc.escapeLast=(t,e,r)=>{let n=t.lastIndexOf(e,r);return n===-1?t:t[n-1]==="\\"?tc.escapeLast(t,e,n-1):`${t.slice(0,n)}\\${t.slice(n)}`};tc.removePrefix=(t,e={})=>{let r=t;return r.startsWith("./")&&(r=r.slice(2),e.prefix="./"),r};tc.wrapOutput=(t,e={},r={})=>{let n=r.contains?"":"^",o=r.contains?"":"$",s=`${n}(?:${t})${o}`;return e.negated===!0&&(s=`(?:^(?!${s}).*$)`),s};tc.basename=(t,{windows:e}={})=>{let r=t.split(e?/[\\/]/:"/"),n=r[r.length-1];return n===""?r[r.length-2]:n}});var kCe=L((NGt,RCe)=>{"use strict";var SCe=z6(),{CHAR_ASTERISK:LQ,CHAR_AT:lXe,CHAR_BACKWARD_SLASH:e2,CHAR_COMMA:dXe,CHAR_DOT:OQ,CHAR_EXCLAMATION_MARK:MQ,CHAR_FORWARD_SLASH:wCe,CHAR_LEFT_CURLY_BRACE:FQ,CHAR_LEFT_PARENTHESES:UQ,CHAR_LEFT_SQUARE_BRACKET:pXe,CHAR_PLUS:fXe,CHAR_QUESTION_MARK:ICe,CHAR_RIGHT_CURLY_BRACE:mXe,CHAR_RIGHT_PARENTHESES:CCe,CHAR_RIGHT_SQUARE_BRACKET:hXe}=Zk(),TCe=t=>t===wCe||t===e2,ECe=t=>{t.isPrefix!==!0&&(t.depth=t.isGlobstar?1/0:1)},gXe=(t,e)=>{let r=e||{},n=t.length-1,o=r.parts===!0||r.scanToEnd===!0,s=[],a=[],c=[],u=t,l=-1,d=0,p=0,f=!1,m=!1,h=!1,g=!1,v=!1,y=!1,_=!1,b=!1,S=!1,I=!1,w=0,O,U,z={value:"",depth:0,isGlob:!1},M=()=>l>=n,re=()=>u.charCodeAt(l+1),ee=()=>(O=U,u.charCodeAt(++l));for(;l<n;){U=ee();let F;if(U===e2){_=z.backslashes=!0,U=ee(),U===FQ&&(y=!0);continue}if(y===!0||U===FQ){for(w++;M()!==!0&&(U=ee());){if(U===e2){_=z.backslashes=!0,ee();continue}if(U===FQ){w++;continue}if(y!==!0&&U===OQ&&(U=ee())===OQ){if(f=z.isBrace=!0,h=z.isGlob=!0,I=!0,o===!0)continue;break}if(y!==!0&&U===dXe){if(f=z.isBrace=!0,h=z.isGlob=!0,I=!0,o===!0)continue;break}if(U===mXe&&(w--,w===0)){y=!1,f=z.isBrace=!0,I=!0;break}}if(o===!0)continue;break}if(U===wCe){if(s.push(l),a.push(z),z={value:"",depth:0,isGlob:!1},I===!0)continue;if(O===OQ&&l===d+1){d+=2;continue}p=l+1;continue}if(r.noext!==!0&&(U===fXe||U===lXe||U===LQ||U===ICe||U===MQ)===!0&&re()===UQ){if(h=z.isGlob=!0,g=z.isExtglob=!0,I=!0,U===MQ&&l===d&&(S=!0),o===!0){for(;M()!==!0&&(U=ee());){if(U===e2){_=z.backslashes=!0,U=ee();continue}if(U===CCe){h=z.isGlob=!0,I=!0;break}}continue}break}if(U===LQ){if(O===LQ&&(v=z.isGlobstar=!0),h=z.isGlob=!0,I=!0,o===!0)continue;break}if(U===ICe){if(h=z.isGlob=!0,I=!0,o===!0)continue;break}if(U===pXe){for(;M()!==!0&&(F=ee());){if(F===e2){_=z.backslashes=!0,ee();continue}if(F===hXe){m=z.isBracket=!0,h=z.isGlob=!0,I=!0;break}}if(o===!0)continue;break}if(r.nonegate!==!0&&U===MQ&&l===d){b=z.negated=!0,d++;continue}if(r.noparen!==!0&&U===UQ){if(h=z.isGlob=!0,o===!0){for(;M()!==!0&&(U=ee());){if(U===UQ){_=z.backslashes=!0,U=ee();continue}if(U===CCe){I=!0;break}}continue}break}if(h===!0){if(I=!0,o===!0)continue;break}}r.noext===!0&&(g=!1,h=!1);let N=u,E="",P="";d>0&&(E=u.slice(0,d),u=u.slice(d),p-=d),N&&h===!0&&p>0?(N=u.slice(0,p),P=u.slice(p)):h===!0?(N="",P=u):N=u,N&&N!==""&&N!=="/"&&N!==u&&TCe(N.charCodeAt(N.length-1))&&(N=N.slice(0,-1)),r.unescape===!0&&(P&&(P=SCe.removeBackslashes(P)),N&&_===!0&&(N=SCe.removeBackslashes(N)));let q={prefix:E,input:t,start:d,base:N,glob:P,isBrace:f,isBracket:m,isGlob:h,isExtglob:g,isGlobstar:v,negated:b,negatedExtglob:S};if(r.tokens===!0&&(q.maxDepth=0,TCe(U)||a.push(z),q.tokens=a),r.parts===!0||r.tokens===!0){let F;for(let Z=0;Z<s.length;Z++){let ue=F?F+1:d,te=s[Z],Q=t.slice(ue,te);r.tokens&&(Z===0&&d!==0?(a[Z].isPrefix=!0,a[Z].value=E):a[Z].value=Q,ECe(a[Z]),q.maxDepth+=a[Z].depth),(Z!==0||Q!=="")&&c.push(Q),F=te}if(F&&F+1<t.length){let Z=t.slice(F+1);c.push(Z),r.tokens&&(a[a.length-1].value=Z,ECe(a[a.length-1]),q.maxDepth+=a[a.length-1].depth)}q.slashes=s,q.parts=c}return q};RCe.exports=gXe});var DCe=L((LGt,PCe)=>{"use strict";var G6=Zk(),El=z6(),{MAX_LENGTH:V6,POSIX_REGEX_SOURCE:vXe,REGEX_NON_SPECIAL_CHARS:yXe,REGEX_SPECIAL_CHARS_BACKREF:bXe,REPLACEMENTS:ACe}=G6,_Xe=(t,e)=>{if(typeof e.expandRange=="function")return e.expandRange(...t,e);t.sort();let r=`[${t.join("-")}]`;try{new RegExp(r)}catch{return t.map(o=>El.escapeRegex(o)).join("..")}return r},uI=(t,e)=>`Missing ${t}: "${e}" - use "\\\\${e}" to match literal characters`,BQ=(t,e)=>{if(typeof t!="string")throw new TypeError("Expected a string");t=ACe[t]||t;let r={...e},n=typeof r.maxLength=="number"?Math.min(V6,r.maxLength):V6,o=t.length;if(o>n)throw new SyntaxError(`Input length: ${o}, exceeds maximum allowed length: ${n}`);let s={type:"bos",value:"",output:r.prepend||""},a=[s],c=r.capture?"":"?:",u=G6.globChars(r.windows),l=G6.extglobChars(u),{DOT_LITERAL:d,PLUS_LITERAL:p,SLASH_LITERAL:f,ONE_CHAR:m,DOTS_SLASH:h,NO_DOT:g,NO_DOT_SLASH:v,NO_DOTS_SLASH:y,QMARK:_,QMARK_NO_DOT:b,STAR:S,START_ANCHOR:I}=u,w=ye=>`(${c}(?:(?!${I}${ye.dot?h:d}).)*?)`,O=r.dot?"":g,U=r.dot?_:b,z=r.bash===!0?w(r):S;r.capture&&(z=`(${z})`),typeof r.noext=="boolean"&&(r.noextglob=r.noext);let M={input:t,index:-1,start:0,dot:r.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:a};t=El.removePrefix(t,M),o=t.length;let re=[],ee=[],N=[],E=s,P,q=()=>M.index===o-1,F=M.peek=(ye=1)=>t[M.index+ye],Z=M.advance=()=>t[++M.index]||"",ue=()=>t.slice(M.index+1),te=(ye="",nt=0)=>{M.consumed+=ye,M.index+=nt},Q=ye=>{M.output+=ye.output!=null?ye.output:ye.value,te(ye.value)},je=()=>{let ye=1;for(;F()==="!"&&(F(2)!=="("||F(3)==="?");)Z(),M.start++,ye++;return ye%2===0?!1:(M.negated=!0,M.start++,!0)},ne=ye=>{M[ye]++,N.push(ye)},ht=ye=>{M[ye]--,N.pop()},We=ye=>{if(E.type==="globstar"){let nt=M.braces>0&&(ye.type==="comma"||ye.type==="brace"),H=ye.extglob===!0||re.length&&(ye.type==="pipe"||ye.type==="paren");ye.type!=="slash"&&ye.type!=="paren"&&!nt&&!H&&(M.output=M.output.slice(0,-E.output.length),E.type="star",E.value="*",E.output=z,M.output+=E.output)}if(re.length&&ye.type!=="paren"&&(re[re.length-1].inner+=ye.value),(ye.value||ye.output)&&Q(ye),E&&E.type==="text"&&ye.type==="text"){E.value+=ye.value,E.output=(E.output||"")+ye.value;return}ye.prev=E,a.push(ye),E=ye},Ct=(ye,nt)=>{let H={...l[nt],conditions:1,inner:""};H.prev=E,H.parens=M.parens,H.output=M.output;let le=(r.capture?"(":"")+H.open;ne("parens"),We({type:ye,value:nt,output:M.output?"":m}),We({type:"paren",extglob:!0,value:Z(),output:le}),re.push(H)},xr=ye=>{let nt=ye.close+(r.capture?")":""),H;if(ye.type==="negate"){let le=z;if(ye.inner&&ye.inner.length>1&&ye.inner.includes("/")&&(le=w(r)),(le!==z||q()||/^\)+$/.test(ue()))&&(nt=ye.close=`)$))${le}`),ye.inner.includes("*")&&(H=ue())&&/^\.[^\\/.]+$/.test(H)){let pe=BQ(H,{...e,fastpaths:!1}).output;nt=ye.close=`)${pe})${le})`}ye.prev.type==="bos"&&(M.negatedExtglob=!0)}We({type:"paren",extglob:!0,value:P,output:nt}),ht("parens")};if(r.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(t)){let ye=!1,nt=t.replace(bXe,(H,le,pe,ke,Ie,it)=>ke==="\\"?(ye=!0,H):ke==="?"?le?le+ke+(Ie?_.repeat(Ie.length):""):it===0?U+(Ie?_.repeat(Ie.length):""):_.repeat(pe.length):ke==="."?d.repeat(pe.length):ke==="*"?le?le+ke+(Ie?z:""):z:le?H:`\\${H}`);return ye===!0&&(r.unescape===!0?nt=nt.replace(/\\/g,""):nt=nt.replace(/\\+/g,H=>H.length%2===0?"\\\\":H?"\\":"")),nt===t&&r.contains===!0?(M.output=t,M):(M.output=El.wrapOutput(nt,M,e),M)}for(;!q();){if(P=Z(),P==="\0")continue;if(P==="\\"){let H=F();if(H==="/"&&r.bash!==!0||H==="."||H===";")continue;if(!H){P+="\\",We({type:"text",value:P});continue}let le=/^\\+/.exec(ue()),pe=0;if(le&&le[0].length>2&&(pe=le[0].length,M.index+=pe,pe%2!==0&&(P+="\\")),r.unescape===!0?P=Z():P+=Z(),M.brackets===0){We({type:"text",value:P});continue}}if(M.brackets>0&&(P!=="]"||E.value==="["||E.value==="[^")){if(r.posix!==!1&&P===":"){let H=E.value.slice(1);if(H.includes("[")&&(E.posix=!0,H.includes(":"))){let le=E.value.lastIndexOf("["),pe=E.value.slice(0,le),ke=E.value.slice(le+2),Ie=vXe[ke];if(Ie){E.value=pe+Ie,M.backtrack=!0,Z(),!s.output&&a.indexOf(E)===1&&(s.output=m);continue}}}(P==="["&&F()!==":"||P==="-"&&F()==="]")&&(P=`\\${P}`),P==="]"&&(E.value==="["||E.value==="[^")&&(P=`\\${P}`),r.posix===!0&&P==="!"&&E.value==="["&&(P="^"),E.value+=P,Q({value:P});continue}if(M.quotes===1&&P!=='"'){P=El.escapeRegex(P),E.value+=P,Q({value:P});continue}if(P==='"'){M.quotes=M.quotes===1?0:1,r.keepQuotes===!0&&We({type:"text",value:P});continue}if(P==="("){ne("parens"),We({type:"paren",value:P});continue}if(P===")"){if(M.parens===0&&r.strictBrackets===!0)throw new SyntaxError(uI("opening","("));let H=re[re.length-1];if(H&&M.parens===H.parens+1){xr(re.pop());continue}We({type:"paren",value:P,output:M.parens?")":"\\)"}),ht("parens");continue}if(P==="["){if(r.nobracket===!0||!ue().includes("]")){if(r.nobracket!==!0&&r.strictBrackets===!0)throw new SyntaxError(uI("closing","]"));P=`\\${P}`}else ne("brackets");We({type:"bracket",value:P});continue}if(P==="]"){if(r.nobracket===!0||E&&E.type==="bracket"&&E.value.length===1){We({type:"text",value:P,output:`\\${P}`});continue}if(M.brackets===0){if(r.strictBrackets===!0)throw new SyntaxError(uI("opening","["));We({type:"text",value:P,output:`\\${P}`});continue}ht("brackets");let H=E.value.slice(1);if(E.posix!==!0&&H[0]==="^"&&!H.includes("/")&&(P=`/${P}`),E.value+=P,Q({value:P}),r.literalBrackets===!1||El.hasRegexChars(H))continue;let le=El.escapeRegex(E.value);if(M.output=M.output.slice(0,-E.value.length),r.literalBrackets===!0){M.output+=le,E.value=le;continue}E.value=`(${c}${le}|${E.value})`,M.output+=E.value;continue}if(P==="{"&&r.nobrace!==!0){ne("braces");let H={type:"brace",value:P,output:"(",outputIndex:M.output.length,tokensIndex:M.tokens.length};ee.push(H),We(H);continue}if(P==="}"){let H=ee[ee.length-1];if(r.nobrace===!0||!H){We({type:"text",value:P,output:P});continue}let le=")";if(H.dots===!0){let pe=a.slice(),ke=[];for(let Ie=pe.length-1;Ie>=0&&(a.pop(),pe[Ie].type!=="brace");Ie--)pe[Ie].type!=="dots"&&ke.unshift(pe[Ie].value);le=_Xe(ke,r),M.backtrack=!0}if(H.comma!==!0&&H.dots!==!0){let pe=M.output.slice(0,H.outputIndex),ke=M.tokens.slice(H.tokensIndex);H.value=H.output="\\{",P=le="\\}",M.output=pe;for(let Ie of ke)M.output+=Ie.output||Ie.value}We({type:"brace",value:P,output:le}),ht("braces"),ee.pop();continue}if(P==="|"){re.length>0&&re[re.length-1].conditions++,We({type:"text",value:P});continue}if(P===","){let H=P,le=ee[ee.length-1];le&&N[N.length-1]==="braces"&&(le.comma=!0,H="|"),We({type:"comma",value:P,output:H});continue}if(P==="/"){if(E.type==="dot"&&M.index===M.start+1){M.start=M.index+1,M.consumed="",M.output="",a.pop(),E=s;continue}We({type:"slash",value:P,output:f});continue}if(P==="."){if(M.braces>0&&E.type==="dot"){E.value==="."&&(E.output=d);let H=ee[ee.length-1];E.type="dots",E.output+=P,E.value+=P,H.dots=!0;continue}if(M.braces+M.parens===0&&E.type!=="bos"&&E.type!=="slash"){We({type:"text",value:P,output:d});continue}We({type:"dot",value:P,output:d});continue}if(P==="?"){if(!(E&&E.value==="(")&&r.noextglob!==!0&&F()==="("&&F(2)!=="?"){Ct("qmark",P);continue}if(E&&E.type==="paren"){let le=F(),pe=P;if(le==="<"&&!El.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(E.value==="("&&!/[!=<:]/.test(le)||le==="<"&&!/<([!=]|\w+>)/.test(ue()))&&(pe=`\\${P}`),We({type:"text",value:P,output:pe});continue}if(r.dot!==!0&&(E.type==="slash"||E.type==="bos")){We({type:"qmark",value:P,output:b});continue}We({type:"qmark",value:P,output:_});continue}if(P==="!"){if(r.noextglob!==!0&&F()==="("&&(F(2)!=="?"||!/[!=<:]/.test(F(3)))){Ct("negate",P);continue}if(r.nonegate!==!0&&M.index===0){je();continue}}if(P==="+"){if(r.noextglob!==!0&&F()==="("&&F(2)!=="?"){Ct("plus",P);continue}if(E&&E.value==="("||r.regex===!1){We({type:"plus",value:P,output:p});continue}if(E&&(E.type==="bracket"||E.type==="paren"||E.type==="brace")||M.parens>0){We({type:"plus",value:P});continue}We({type:"plus",value:p});continue}if(P==="@"){if(r.noextglob!==!0&&F()==="("&&F(2)!=="?"){We({type:"at",extglob:!0,value:P,output:""});continue}We({type:"text",value:P});continue}if(P!=="*"){(P==="$"||P==="^")&&(P=`\\${P}`);let H=yXe.exec(ue());H&&(P+=H[0],M.index+=H[0].length),We({type:"text",value:P});continue}if(E&&(E.type==="globstar"||E.star===!0)){E.type="star",E.star=!0,E.value+=P,E.output=z,M.backtrack=!0,M.globstar=!0,te(P);continue}let ye=ue();if(r.noextglob!==!0&&/^\([^?]/.test(ye)){Ct("star",P);continue}if(E.type==="star"){if(r.noglobstar===!0){te(P);continue}let H=E.prev,le=H.prev,pe=H.type==="slash"||H.type==="bos",ke=le&&(le.type==="star"||le.type==="globstar");if(r.bash===!0&&(!pe||ye[0]&&ye[0]!=="/")){We({type:"star",value:P,output:""});continue}let Ie=M.braces>0&&(H.type==="comma"||H.type==="brace"),it=re.length&&(H.type==="pipe"||H.type==="paren");if(!pe&&H.type!=="paren"&&!Ie&&!it){We({type:"star",value:P,output:""});continue}for(;ye.slice(0,3)==="/**";){let xt=t[M.index+4];if(xt&&xt!=="/")break;ye=ye.slice(3),te("/**",3)}if(H.type==="bos"&&q()){E.type="globstar",E.value+=P,E.output=w(r),M.output=E.output,M.globstar=!0,te(P);continue}if(H.type==="slash"&&H.prev.type!=="bos"&&!ke&&q()){M.output=M.output.slice(0,-(H.output+E.output).length),H.output=`(?:${H.output}`,E.type="globstar",E.output=w(r)+(r.strictSlashes?")":"|$)"),E.value+=P,M.globstar=!0,M.output+=H.output+E.output,te(P);continue}if(H.type==="slash"&&H.prev.type!=="bos"&&ye[0]==="/"){let xt=ye[1]!==void 0?"|$":"";M.output=M.output.slice(0,-(H.output+E.output).length),H.output=`(?:${H.output}`,E.type="globstar",E.output=`${w(r)}${f}|${f}${xt})`,E.value+=P,M.output+=H.output+E.output,M.globstar=!0,te(P+Z()),We({type:"slash",value:"/",output:""});continue}if(H.type==="bos"&&ye[0]==="/"){E.type="globstar",E.value+=P,E.output=`(?:^|${f}|${w(r)}${f})`,M.output=E.output,M.globstar=!0,te(P+Z()),We({type:"slash",value:"/",output:""});continue}M.output=M.output.slice(0,-E.output.length),E.type="globstar",E.output=w(r),E.value+=P,M.output+=E.output,M.globstar=!0,te(P);continue}let nt={type:"star",value:P,output:z};if(r.bash===!0){nt.output=".*?",(E.type==="bos"||E.type==="slash")&&(nt.output=O+nt.output),We(nt);continue}if(E&&(E.type==="bracket"||E.type==="paren")&&r.regex===!0){nt.output=P,We(nt);continue}(M.index===M.start||E.type==="slash"||E.type==="dot")&&(E.type==="dot"?(M.output+=v,E.output+=v):r.dot===!0?(M.output+=y,E.output+=y):(M.output+=O,E.output+=O),F()!=="*"&&(M.output+=m,E.output+=m)),We(nt)}for(;M.brackets>0;){if(r.strictBrackets===!0)throw new SyntaxError(uI("closing","]"));M.output=El.escapeLast(M.output,"["),ht("brackets")}for(;M.parens>0;){if(r.strictBrackets===!0)throw new SyntaxError(uI("closing",")"));M.output=El.escapeLast(M.output,"("),ht("parens")}for(;M.braces>0;){if(r.strictBrackets===!0)throw new SyntaxError(uI("closing","}"));M.output=El.escapeLast(M.output,"{"),ht("braces")}if(r.strictSlashes!==!0&&(E.type==="star"||E.type==="bracket")&&We({type:"maybe_slash",value:"",output:`${f}?`}),M.backtrack===!0){M.output="";for(let ye of M.tokens)M.output+=ye.output!=null?ye.output:ye.value,ye.suffix&&(M.output+=ye.suffix)}return M};BQ.fastpaths=(t,e)=>{let r={...e},n=typeof r.maxLength=="number"?Math.min(V6,r.maxLength):V6,o=t.length;if(o>n)throw new SyntaxError(`Input length: ${o}, exceeds maximum allowed length: ${n}`);t=ACe[t]||t;let{DOT_LITERAL:s,SLASH_LITERAL:a,ONE_CHAR:c,DOTS_SLASH:u,NO_DOT:l,NO_DOTS:d,NO_DOTS_SLASH:p,STAR:f,START_ANCHOR:m}=G6.globChars(r.windows),h=r.dot?d:l,g=r.dot?p:l,v=r.capture?"":"?:",y={negated:!1,prefix:""},_=r.bash===!0?".*?":f;r.capture&&(_=`(${_})`);let b=O=>O.noglobstar===!0?_:`(${v}(?:(?!${m}${O.dot?u:s}).)*?)`,S=O=>{switch(O){case"*":return`${h}${c}${_}`;case".*":return`${s}${c}${_}`;case"*.*":return`${h}${_}${s}${c}${_}`;case"*/*":return`${h}${_}${a}${c}${g}${_}`;case"**":return h+b(r);case"**/*":return`(?:${h}${b(r)}${a})?${g}${c}${_}`;case"**/*.*":return`(?:${h}${b(r)}${a})?${g}${_}${s}${c}${_}`;case"**/.*":return`(?:${h}${b(r)}${a})?${s}${c}${_}`;default:{let U=/^(.*?)\.(\w+)$/.exec(O);if(!U)return;let z=S(U[1]);return z?z+s+U[2]:void 0}}},I=El.removePrefix(t,y),w=S(I);return w&&r.strictSlashes!==!0&&(w+=`${a}?`),w};PCe.exports=BQ});var OCe=L((OGt,LCe)=>{"use strict";var xXe=kCe(),qQ=DCe(),NCe=z6(),SXe=Zk(),IXe=t=>t&&typeof t=="object"&&!Array.isArray(t),qi=(t,e,r=!1)=>{if(Array.isArray(t)){let d=t.map(f=>qi(f,e,r));return f=>{for(let m of d){let h=m(f);if(h)return h}return!1}}let n=IXe(t)&&t.tokens&&t.input;if(t===""||typeof t!="string"&&!n)throw new TypeError("Expected pattern to be a non-empty string");let o=e||{},s=o.windows,a=n?qi.compileRe(t,e):qi.makeRe(t,e,!1,!0),c=a.state;delete a.state;let u=()=>!1;if(o.ignore){let d={...e,ignore:null,onMatch:null,onResult:null};u=qi(o.ignore,d,r)}let l=(d,p=!1)=>{let{isMatch:f,match:m,output:h}=qi.test(d,a,e,{glob:t,posix:s}),g={glob:t,state:c,regex:a,posix:s,input:d,output:h,match:m,isMatch:f};return typeof o.onResult=="function"&&o.onResult(g),f===!1?(g.isMatch=!1,p?g:!1):u(d)?(typeof o.onIgnore=="function"&&o.onIgnore(g),g.isMatch=!1,p?g:!1):(typeof o.onMatch=="function"&&o.onMatch(g),p?g:!0)};return r&&(l.state=c),l};qi.test=(t,e,r,{glob:n,posix:o}={})=>{if(typeof t!="string")throw new TypeError("Expected input to be a string");if(t==="")return{isMatch:!1,output:""};let s=r||{},a=s.format||(o?NCe.toPosixSlashes:null),c=t===n,u=c&&a?a(t):t;return c===!1&&(u=a?a(t):t,c=u===n),(c===!1||s.capture===!0)&&(s.matchBase===!0||s.basename===!0?c=qi.matchBase(t,e,r,o):c=e.exec(u)),{isMatch:!!c,match:c,output:u}};qi.matchBase=(t,e,r)=>(e instanceof RegExp?e:qi.makeRe(e,r)).test(NCe.basename(t));qi.isMatch=(t,e,r)=>qi(e,r)(t);qi.parse=(t,e)=>Array.isArray(t)?t.map(r=>qi.parse(r,e)):qQ(t,{...e,fastpaths:!1});qi.scan=(t,e)=>xXe(t,e);qi.compileRe=(t,e,r=!1,n=!1)=>{if(r===!0)return t.output;let o=e||{},s=o.contains?"":"^",a=o.contains?"":"$",c=`${s}(?:${t.output})${a}`;t&&t.negated===!0&&(c=`^(?!${c}).*$`);let u=qi.toRegex(c,e);return n===!0&&(u.state=t),u};qi.makeRe=(t,e={},r=!1,n=!1)=>{if(!t||typeof t!="string")throw new TypeError("Expected a non-empty string");let o={negated:!1,fastpaths:!0};return e.fastpaths!==!1&&(t[0]==="."||t[0]==="*")&&(o.output=qQ.fastpaths(t,e)),o.output||(o=qQ(t,e)),qi.compileRe(o,e,r,n)};qi.toRegex=(t,e)=>{try{let r=e||{};return new RegExp(t,r.flags||(r.nocase?"i":""))}catch(r){if(e&&e.debug===!0)throw r;return/$^/}};qi.constants=SXe;LCe.exports=qi});var MCe=L((MGt,ip)=>{"use strict";var CXe=require("os"),em=OCe(),TXe=CXe.platform()==="win32";function EXe(t,e,r=!1){return e&&(e.windows===null||e.windows===void 0)&&(e={...e,windows:TXe}),em(t,e,r)}ip.exports=EXe;ip.exports.test=em.test;ip.exports.matchBase=em.matchBase;ip.exports.isMatch=em.isMatch;ip.exports.parse=em.parse;ip.exports.scan=em.scan;ip.exports.compileRe=em.compileRe;ip.exports.toRegex=em.toRegex;ip.exports.makeRe=em.makeRe});var i2=L(op=>{"use strict";Object.defineProperty(op,"__esModule",{value:!0});op.BaseTokensPerName=op.BaseTokensPerMessage=op.BaseTokensPerCompletion=op.ChatRole=void 0;var qCe;(function(t){t.System="system",t.User="user",t.Assistant="assistant",t.Function="function"})(qCe||(op.ChatRole=qCe={}));op.BaseTokensPerCompletion=3;op.BaseTokensPerMessage=3;op.BaseTokensPerName=1});var jCe=L(()=>{"use strict";function AXe(t,e,...r){return{ctor:t,props:e,children:r.flat()}}function HCe(){throw new Error("This should not be invoked!")}HCe.isFragment=!0;globalThis.vscpp=AXe;globalThis.vscppf=HCe});var $Q=L(J6=>{"use strict";Object.defineProperty(J6,"__esModule",{value:!0});J6.PromptElement=void 0;jCe();var VQ=class{get priority(){return this.props.priority??Number.MAX_SAFE_INTEGER}get insertLineBreakBefore(){return!0}constructor(e){this.props=e}};J6.PromptElement=VQ});var XQ=L(Ko=>{"use strict";Object.defineProperty(Ko,"__esModule",{value:!0});Ko.PrioritizedList=Ko.TextChunk=Ko.FunctionMessage=Ko.AssistantMessage=Ko.UserMessage=Ko.SystemMessage=Ko.BaseChatMessage=Ko.isChatMessagePromptElement=void 0;var r8=i2(),QQ=$Q();function PXe(t){return t instanceof Z6||t instanceof e8||t instanceof t8}Ko.isChatMessagePromptElement=PXe;var Eb=class extends QQ.PromptElement{render(){return vscpp(vscppf,null,this.props.children)}};Ko.BaseChatMessage=Eb;var Z6=class extends Eb{constructor(e){e.role=r8.ChatRole.System,super(e)}};Ko.SystemMessage=Z6;var e8=class extends Eb{constructor(e){e.role=r8.ChatRole.User,super(e)}};Ko.UserMessage=e8;var t8=class extends Eb{constructor(e){e.role=r8.ChatRole.Assistant,super(e)}};Ko.AssistantMessage=t8;var WQ=class extends Eb{constructor(e){e.role=r8.ChatRole.Function,super(e)}};Ko.FunctionMessage=WQ;var KQ=class extends QQ.PromptElement{render(){return vscpp(vscppf,null,this.props.children)}};Ko.TextChunk=KQ;var YQ=class extends QQ.PromptElement{render(){let e=this.props.children;if(e)return vscpp(vscppf,null,e.map((r,n)=>(r.props??(r.props={}),r.props.priority=this.props.descending?this.props.priority-n:this.props.priority-e.length+n,r)))}};Ko.PrioritizedList=YQ});var zCe=L(n8=>{"use strict";Object.defineProperty(n8,"__esModule",{value:!0});n8.coalesce=void 0;function DXe(t){return t.filter(e=>!!e)}n8.coalesce=DXe});var iX=L(dI=>{"use strict";Object.defineProperty(dI,"__esModule",{value:!0});dI.PromptRenderer=dI.MetadataMap=void 0;var s8=XQ(),i8=zCe(),GCe;(function(t){t.empty={get:()=>{}}})(GCe||(dI.MetadataMap=GCe={}));var JQ=class{constructor(e,r,n,o){this._endpoint=e,this._ctor=r,this._props=n,this._tokenizer=o,this._meta=new Map,this._usedContext=[],this._ignoredFiles=[],this._root=new rX(null,0),this._references=[]}getAllMeta(){let e=this._meta;return{get(r){return e.get(r)}}}getIgnoredFiles(){return Array.from(new Set(this._ignoredFiles))}getMeta(e){return this._meta.get(e)}getUsedContext(){return this._usedContext}createElement(e){return new e.ctor(e.props)}async _processPromptPieces(e,r,n,o){let s=new Map;for(let[u,l]of r.entries()){if(Array.isArray(l.children)&&(l.props=l.props??{},l.props.children=l.children),!l.ctor)throw new Error("Invalid ChatMessage child! Child must be a TSX component that extends PromptElement.");let d=this.createElement(l);l.node.setObj(d);let p=l.props.flexGrow??1/0,f=s.get(p);f||(f=[],s.set(p,f)),f.push({order:u,element:l,promptElementInstance:d})}let a=[...s.entries()].sort(([u],[l])=>l-u).map(([u,l])=>l),c=(u,l)=>{let d=l?1:-1;for(let p=u+1;p<a.length;p++)for(let{element:f}of a[p])f.props.flexReserve&&e.consume(d*f.props.flexReserve)};for(let[u,l]of a.entries()){c(u,!0);let d=0;for(let{element:f}of l)d+=(f.props.flex||f.props.flexBasis)??1;let p=l.map(f=>{let m=(f.element.props.flexBasis??1)/d;return{tokenBudget:Math.floor(e.remainingTokenBudget*m),endpoint:e.endpoint}});c(u,!1),await Promise.all(l.map(async({element:f,promptElementInstance:m},h)=>{let g=await m.prepare?.(p[h],n,o);f.node.setState(g)}));for(let[f,{element:m,promptElementInstance:h,order:g}]of l.entries()){let v=p[f],y=h.render(m.node.getState(),v);if(!y)continue;let _=VCe(y),b=new a8(v.tokenBudget,this._endpoint),{tokensConsumed:S}=await NXe(this._tokenizer,m,h,_);b.consume(S),await this._handlePromptChildren(m,_,b,n,o),e.consume(b.consumed)}}}async _prioritize(e,r,n){let o=[],s=[],a=0;for(;a<e.length;){if(!e[a].isImplicitLinebreak){let u=e[a-1]?.isImplicitLinebreak?{index:a,precedingLinebreak:a-1}:{index:a};o.push(u),s[a]=null}a+=1}o.sort((u,l)=>r(e[u.index],e[l.index]));let c=this._endpoint.modelMaxPromptTokens;for(;o.length>0;){let u=o.shift(),l=u.index,d=e[l],p=await n(d),f;if(u.precedingLinebreak&&(f=e[u.precedingLinebreak],p+=await n(f)),p>c)break;s[l]=d,u.precedingLinebreak&&f&&(s[u.precedingLinebreak]=f),c-=p}return{result:(0,i8.coalesce)(s),tokenCount:this._endpoint.modelMaxPromptTokens-c}}async render(e,r){await this._processPromptPieces(new a8(this._endpoint.modelMaxPromptTokens,this._endpoint),[{node:this._root,ctor:this._ctor,props:this._props,children:[]}],e,r);let{result:n,resultChunks:o}=this._root.materialize(),s=new Set,{result:a}=await this._prioritize(o,(m,h)=>wb.cmp(m,h),async m=>{let h=await this._tokenizer.tokenLength(m.text);return s.has(m.message)||(s.add(m.message),h=await this._tokenizer.countMessageTokens(m.toChatMessage())),h}),c=new Map;for(let m of(0,i8.coalesce)(a)){let h=c.get(m.message)??[];h[m.childIndex]=m,c.set(m.message,h)}let u=[];for(let m of n){let h=c.get(m);if(h){m.chunks=(0,i8.coalesce)(h);for(let g of h)g&&g.references.length>0&&m.references.push(...g.references);u.push(m)}}let{result:l,tokenCount:d}=await this._prioritize(u,(m,h)=>c8.cmp(m,h),async m=>this._tokenizer.countMessageTokens(m.toChatMessage())),p=l.map(m=>m?.toChatMessage()),{references:f}=l.reduce((m,h)=>([...this._references,...h.references].forEach(g=>{let v="variableName"in g.anchor;v&&!m.names.has(g.anchor.variableName)?(m.references.push(g),m.names.add(g.anchor.variableName)):v||m.references.push(g)}),m),{references:[],names:new Set});return{messages:p,hasIgnoredFiles:this._ignoredFiles.length>0,tokenCount:d,references:(0,i8.coalesce)(f)}}_handlePromptChildren(e,r,n,o,s){let a=[];for(let c of r){if(c.kind==="literal"){e.node.appendStringChild(c.value,e.props.priority??Number.MAX_SAFE_INTEGER);continue}if(c.kind==="intrinsic"){this._handleIntrinsic(e.node,c.name,{priority:e.props.priority??Number.MAX_SAFE_INTEGER,...c.props},o8(c.children));continue}if(c.ctor===s8.TextChunk){this._handleExtrinsicTextChunk(e.node,{priority:e.props.priority??Number.MAX_SAFE_INTEGER,...c.props},o8(c.children));continue}let u=e.node.createChild();a.push({node:u,ctor:c.ctor,props:{priority:e.props.priority,...c.props},children:c.children})}return this._processPromptPieces(n,a,o,s)}_handleIntrinsic(e,r,n,o){switch(r){case"meta":return this._handleIntrinsicMeta(e,n,o);case"br":return this._handleIntrinsicLineBreak(e,n,o,n.priority);case"usedContext":return this._handleIntrinsicUsedContext(e,n,o);case"references":return this._handleIntrinsicReferences(e,n,o);case"ignoredFiles":return this._handleIntrinsicIgnoredFiles(e,n,o)}throw new Error(`Unknown intrinsic element ${r}!`)}_handleIntrinsicMeta(e,r,n){if(n.length>0)throw new Error("<meta /> must not have children!");let o=Object.getPrototypeOf(r.value).constructor;if(this._meta.has(o))throw new Error(`Duplicate metadata ${o.name}!`);this._meta.set(o,r.value)}_handleIntrinsicLineBreak(e,r,n,o){if(n.length>0)throw new Error("<br /> must not have children!");e.appendLineBreak(!0,o??Number.MAX_SAFE_INTEGER)}_handleIntrinsicUsedContext(e,r,n){if(n.length>0)throw new Error("<usedContext /> must not have children!");this._usedContext.push(...r.value)}_handleIntrinsicReferences(e,r,n){if(n.length>0)throw new Error("<reference /> must not have children!");e.addReferences(r.value),this._references.push(...r.value)}_handleIntrinsicIgnoredFiles(e,r,n){if(n.length>0)throw new Error("<ignoredFiles /> must not have children!");this._ignoredFiles.push(...r.value)}_handleExtrinsicTextChunk(e,r,n){let o=[],s=[];for(let a of n){if(a.kind==="extrinsic")throw new Error("TextChunk cannot have extrinsic children!");a.kind==="literal"&&o.push(a.value),a.kind==="intrinsic"&&(a.name==="br"?o.push(`
`):a.name==="references"?s.push(...a.props.value):this._handleIntrinsic(e,a.name,a.props,o8(a.children)))}e.appendLineBreak(!1),e.appendStringChild(o.join(""),r?.priority??Number.MAX_SAFE_INTEGER,s)}};dI.PromptRenderer=JQ;async function NXe(t,e,r,n){let o=0;if((0,s8.isChatMessagePromptElement)(r)){o+=await t.countMessageTokens({role:e.props.role,content:"",...e.props.name?{name:e.props.name}:void 0});for(let s of n)s.kind==="literal"&&(o+=await t.tokenLength(s.value))}return{tokensConsumed:o}}function VCe(t){return typeof t>"u"||typeof t=="boolean"?[]:typeof t=="string"||typeof t=="number"?[new tX(String(t))]:LXe(t)?[...o8(t.children)]:typeof t.ctor=="string"?[new ZQ(t.ctor,t.props,t.children)]:[new eX(t.ctor,t.props,t.children)]}function o8(t){return(t??[]).reduce((e,r)=>(e.push(...VCe(r)),e),[])}var ZQ=class{constructor(e,r,n){this.name=e,this.props=r,this.children=n,this.kind="intrinsic"}},eX=class{constructor(e,r,n){this.ctor=e,this.props=r,this.children=n,this.kind="extrinsic"}},tX=class{constructor(e,r){this.value=e,this.priority=r,this.kind="literal"}},a8=class{constructor(e,r){this.tokenBudget=e,this.endpoint=r,this._consumed=0}get consumed(){return this._consumed>this.tokenBudget?this.tokenBudget:this._consumed}get remainingTokenBudget(){return Math.max(0,this.tokenBudget-this._consumed)}consume(e){this._consumed+=e}},rX=class t{constructor(e=null,r){this.parent=e,this.childIndex=r,this.kind=0,this._obj=null,this._state=void 0,this._children=[],this._references=[]}setObj(e){this._obj=e}setState(e){this._state=e}getState(){return this._state}createChild(){let e=new t(this,this._children.length);return this._children.push(e),e}appendStringChild(e,r,n){this._children.push(new nX(this,e,r,n))}appendLineBreak(e=!0,r){this._children.push(new u8(this,e,r))}materialize(){let e=[],r=[];return this._materialize(e,r),{result:e,resultChunks:r}}_materialize(e,r){if(this._obj instanceof s8.BaseChatMessage){if(!this._obj.props.role)throw new Error("Invalid ChatMessage!");let n=[];for(let c of this._children)c.collectLeafs(n);let o=[],s=new c8(this._obj.props.role,this._obj.props.name,this._obj.props.priority,this.childIndex,o),a=r.length;n.forEach((c,u)=>{c.kind===1?o.push(new wb(s,c.text,c.priority,a++,!1,c.references??this._references)):c.isExplicit?o.push(new wb(s,`
`,c.priority,a++)):(o.length>0&&o[o.length-1].text!==`
`||o[u-1]&&o[u-1].text!==`
`)&&o.push(new wb(s,`
`,c.priority,a++,!0))}),r.push(...o),e.push(s)}else for(let n of this._children){if(n.kind===1)throw new Error(`Cannot have a text node outside a ChatMessage. Text: "${n.text}"`);if(n.kind===2)throw new Error("Cannot have a line break node outside a ChatMessage!");n._materialize(e,r)}}collectLeafs(e){if(this._obj instanceof s8.BaseChatMessage)throw new Error("Cannot have a ChatMessage nested inside a ChatMessage!");this._obj?.insertLineBreakBefore&&e.push(new u8(this,!1));for(let r of this._children)r.collectLeafs(e)}addReferences(e){this._references.push(...e)}},wb=class{constructor(e,r,n,o,s=!1,a=[]){this.message=e,this.text=r,this.priority=n,this.childIndex=o,this.isImplicitLinebreak=s,this.references=a}static cmp(e,r){return e.priority!==void 0&&r.priority!==void 0&&e.priority===r.priority?e.message===r.message?e.childIndex-r.childIndex:r.childIndex-e.childIndex:e.priority!==void 0&&r.priority!==void 0&&e.priority!==r.priority?r.priority-e.priority:e.childIndex-r.childIndex}toChatMessage(){return{role:this.message.role,content:this.text,...this.message.name?{name:this.message.name}:{}}}},c8=class{constructor(e,r,n,o,s,a=[]){this.role=e,this.name=r,this.priority=n,this.childIndex=o,this._chunks=s,this.references=a}set chunks(e){this._chunks=e.sort(wb.cmp)}get text(){return this._chunks.reduce((e,r,n)=>((n!==this._chunks.length-1||!r.isImplicitLinebreak)&&(e+=r.text),e),"")}toChatMessage(){return{role:this.role,content:this.text,...this.name?{name:this.name}:{}}}static cmp(e,r){return e.priority!==r.priority?(r.priority||0)-(e.priority||0):r.childIndex-e.childIndex}},nX=class{constructor(e,r,n,o){this.parent=e,this.text=r,this.priority=n,this.references=o,this.kind=1}collectLeafs(e){e.push(this)}},u8=class{constructor(e,r,n){this.parent=e,this.isExplicit=r,this.priority=n,this.kind=2}collectLeafs(e){e.push(this)}};function LXe(t){return(typeof t.ctor=="function"&&t.ctor.isFragment)??!1}});var $Ce=L(d8=>{"use strict";Object.defineProperty(d8,"__esModule",{value:!0});d8.AnyTokenizer=void 0;var l8=i2(),oX=class{constructor(e){this.countTokens=e}async tokenLength(e){return this.countTokens(e)}async countMessageTokens(e){return this.countTokens({role:this.toChatRole(e.role),content:e.content,name:e.name})}toChatRole(e){switch(e){case l8.ChatRole.User:return 1;case l8.ChatRole.Assistant:return 2;case l8.ChatRole.System:return 1;case l8.ChatRole.Function:return 5}}};d8.AnyTokenizer=oX});var WCe=L(pI=>{"use strict";Object.defineProperty(pI,"__esModule",{value:!0});pI.PromptReference=pI.PromptMetadata=void 0;var sX=class{toString(){return Object.getPrototypeOf(this).constructor.name}};pI.PromptMetadata=sX;var aX=class{constructor(e){this.anchor=e}};pI.PromptReference=aX});var YCe=L(KCe=>{"use strict";Object.defineProperty(KCe,"__esModule",{value:!0})});var XCe=L(QCe=>{"use strict";Object.defineProperty(QCe,"__esModule",{value:!0})});var ct=L(Lr=>{"use strict";var OXe=Lr&&Lr.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var o=Object.getOwnPropertyDescriptor(e,r);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,o)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),cX=Lr&&Lr.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&OXe(e,t,r)};Object.defineProperty(Lr,"__esModule",{value:!0});Lr.toVsCodeChatMessages=Lr.renderPrompt=Lr.PromptRenderer=Lr.MetadataMap=Lr.PromptElement=Lr.UserMessage=Lr.TextChunk=Lr.SystemMessage=Lr.PrioritizedList=Lr.FunctionMessage=Lr.AssistantMessage=Lr.ChatRole=void 0;var JCe=i2(),MXe=iX(),FXe=$Ce(),UXe=i2();Object.defineProperty(Lr,"ChatRole",{enumerable:!0,get:function(){return UXe.ChatRole}});cX(WCe(),Lr);cX(YCe(),Lr);cX(XCe(),Lr);var fI=XQ();Object.defineProperty(Lr,"AssistantMessage",{enumerable:!0,get:function(){return fI.AssistantMessage}});Object.defineProperty(Lr,"FunctionMessage",{enumerable:!0,get:function(){return fI.FunctionMessage}});Object.defineProperty(Lr,"PrioritizedList",{enumerable:!0,get:function(){return fI.PrioritizedList}});Object.defineProperty(Lr,"SystemMessage",{enumerable:!0,get:function(){return fI.SystemMessage}});Object.defineProperty(Lr,"TextChunk",{enumerable:!0,get:function(){return fI.TextChunk}});Object.defineProperty(Lr,"UserMessage",{enumerable:!0,get:function(){return fI.UserMessage}});var BXe=$Q();Object.defineProperty(Lr,"PromptElement",{enumerable:!0,get:function(){return BXe.PromptElement}});var ZCe=iX();Object.defineProperty(Lr,"MetadataMap",{enumerable:!0,get:function(){return ZCe.MetadataMap}});Object.defineProperty(Lr,"PromptRenderer",{enumerable:!0,get:function(){return ZCe.PromptRenderer}});async function qXe(t,e,r,n,o,s,a="vscode"){let c="countTokens"in n?new FXe.AnyTokenizer((h,g)=>n.countTokens(h,g)):n,u=new MXe.PromptRenderer(r,t,e,c),{messages:l,tokenCount:d,references:p}=await u.render(o,s),f=u.getAllMeta(),m=u.getUsedContext();return a==="vscode"&&(l=eTe(l)),{messages:l,tokenCount:d,metadatas:f,usedContext:m,references:p}}Lr.renderPrompt=qXe;function eTe(t){let e=require("vscode");return t.map(r=>{switch(r.role){case JCe.ChatRole.Assistant:return e.LanguageModelChatMessage.Assistant(r.content,r.name);case JCe.ChatRole.User:return e.LanguageModelChatMessage.User(r.content,r.name);default:throw new Error(`Converting chat message with role ${r.role} to VS Code chat message is not supported.`)}})}Lr.toVsCodeChatMessages=eTe});var vEe=L((Var,gEe)=>{function cEe(t){return Array.isArray(t)?t:[t]}var pEe="",uEe=" ",KX="\\",BJe=/^\s+$/,qJe=/(?:[^\\]|^)\\$/,HJe=/^\\!/,jJe=/^\\#/,zJe=/\r?\n/g,GJe=/^\.*\/|^\.+$/,YX="/",fEe="node-ignore";typeof Symbol<"u"&&(fEe=Symbol.for("node-ignore"));var lEe=fEe,VJe=(t,e,r)=>Object.defineProperty(t,e,{value:r}),$Je=/([0-z])-([0-z])/g,mEe=()=>!1,WJe=t=>t.replace($Je,(e,r,n)=>r.charCodeAt(0)<=n.charCodeAt(0)?e:pEe),KJe=t=>{let{length:e}=t;return t.slice(0,e-e%2)},YJe=[[/\\?\s+$/,t=>t.indexOf("\\")===0?uEe:pEe],[/\\\s/g,()=>uEe],[/[\\$.|*+(){^]/g,t=>`\\${t}`],[/(?!\\)\?/g,()=>"[^/]"],[/^\//,()=>"^"],[/\//g,()=>"\\/"],[/^\^*\\\*\\\*\\\//,()=>"^(?:.*\\/)?"],[/^(?=[^^])/,function(){return/\/(?!$)/.test(this)?"^":"(?:^|\\/)"}],[/\\\/\\\*\\\*(?=\\\/|$)/g,(t,e,r)=>e+6<r.length?"(?:\\/[^\\/]+)*":"\\/.+"],[/(^|[^\\]+)(\\\*)+(?=.+)/g,(t,e,r)=>{let n=r.replace(/\\\*/g,"[^\\/]*");return e+n}],[/\\\\\\(?=[$.|*+(){^])/g,()=>KX],[/\\\\/g,()=>KX],[/(\\)?\[([^\]/]*?)(\\*)($|\])/g,(t,e,r,n,o)=>e===KX?`\\[${r}${KJe(n)}${o}`:o==="]"&&n.length%2===0?`[${WJe(r)}${n}]`:"[]"],[/(?:[^*])$/,t=>/\/$/.test(t)?`${t}$`:`${t}(?=$|\\/$)`],[/(\^|\\\/)?\\\*$/,(t,e)=>`${e?`${e}[^/]+`:"[^/]*"}(?=$|\\/$)`]],dEe=Object.create(null),QJe=(t,e)=>{let r=dEe[t];return r||(r=YJe.reduce((n,o)=>n.replace(o[0],o[1].bind(t)),t),dEe[t]=r),e?new RegExp(r,"i"):new RegExp(r)},JX=t=>typeof t=="string",XJe=t=>t&&JX(t)&&!BJe.test(t)&&!qJe.test(t)&&t.indexOf("#")!==0,JJe=t=>t.split(zJe),QX=class{constructor(e,r,n,o){this.origin=e,this.pattern=r,this.negative=n,this.regex=o}},ZJe=(t,e)=>{let r=t,n=!1;t.indexOf("!")===0&&(n=!0,t=t.substr(1)),t=t.replace(HJe,"!").replace(jJe,"#");let o=QJe(t,e);return new QX(r,t,n,o)},eZe=(t,e)=>{throw new e(t)},um=(t,e,r)=>JX(t)?t?um.isNotRelative(t)?r(`path should be a \`path.relative()\`d string, but got "${e}"`,RangeError):!0:r("path must not be empty",TypeError):r(`path must be a string, but got \`${e}\``,TypeError),hEe=t=>GJe.test(t);um.isNotRelative=hEe;um.convert=t=>t;var XX=class{constructor({ignorecase:e=!0,ignoreCase:r=e,allowRelativePaths:n=!1}={}){VJe(this,lEe,!0),this._rules=[],this._ignoreCase=r,this._allowRelativePaths=n,this._initCache()}_initCache(){this._ignoreCache=Object.create(null),this._testCache=Object.create(null)}_addPattern(e){if(e&&e[lEe]){this._rules=this._rules.concat(e._rules),this._added=!0;return}if(XJe(e)){let r=ZJe(e,this._ignoreCase);this._added=!0,this._rules.push(r)}}add(e){return this._added=!1,cEe(JX(e)?JJe(e):e).forEach(this._addPattern,this),this._added&&this._initCache(),this}addPattern(e){return this.add(e)}_testOne(e,r){let n=!1,o=!1;return this._rules.forEach(s=>{let{negative:a}=s;if(o===a&&n!==o||a&&!n&&!o&&!r)return;s.regex.test(e)&&(n=!a,o=a)}),{ignored:n,unignored:o}}_test(e,r,n,o){let s=e&&um.convert(e);return um(s,e,this._allowRelativePaths?mEe:eZe),this._t(s,r,n,o)}_t(e,r,n,o){if(e in r)return r[e];if(o||(o=e.split(YX)),o.pop(),!o.length)return r[e]=this._testOne(e,n);let s=this._t(o.join(YX)+YX,r,n,o);return r[e]=s.ignored?s:this._testOne(e,n)}ignores(e){return this._test(e,this._ignoreCache,!1).ignored}createFilter(){return e=>!this.ignores(e)}filter(e){return cEe(e).filter(this.createFilter())}test(e){return this._test(e,this._testCache,!0)}},lM=t=>new XX(t),tZe=t=>um(t&&um.convert(t),t,mEe);lM.isPathValid=tZe;lM.default=lM;gEe.exports=lM;if(typeof process<"u"&&(process.env&&process.env.IGNORE_TEST_WIN32||process.platform==="win32")){let t=r=>/^\\\\\?\\/.test(r)||/["<>|\u0000-\u001F]+/u.test(r)?r:r.replace(/\\/g,"/");um.convert=t;let e=/^[a-z]:\//i;um.isNotRelative=r=>e.test(r)||hEe(r)}});var CEe=L((Qar,IEe)=>{"use strict";IEe.exports=xEe;function xEe(t,e,r){t instanceof RegExp&&(t=_Ee(t,r)),e instanceof RegExp&&(e=_Ee(e,r));var n=SEe(t,e,r);return n&&{start:n[0],end:n[1],pre:r.slice(0,n[0]),body:r.slice(n[0]+t.length,n[1]),post:r.slice(n[1]+e.length)}}function _Ee(t,e){var r=e.match(t);return r?r[0]:null}xEe.range=SEe;function SEe(t,e,r){var n,o,s,a,c,u=r.indexOf(t),l=r.indexOf(e,u+1),d=u;if(u>=0&&l>0){if(t===e)return[u,l];for(n=[],s=r.length;d>=0&&!c;)d==u?(n.push(d),u=r.indexOf(t,d+1)):n.length==1?c=[n.pop(),l]:(o=n.pop(),o<s&&(s=o,a=l),l=r.indexOf(e,d+1)),d=u<l&&u>=0?u:l;n.length&&(c=[s,a])}return c}});var DEe=L((Xar,PEe)=>{var TEe=CEe();PEe.exports=iZe;var EEe="\0SLASH"+Math.random()+"\0",wEe="\0OPEN"+Math.random()+"\0",eJ="\0CLOSE"+Math.random()+"\0",REe="\0COMMA"+Math.random()+"\0",kEe="\0PERIOD"+Math.random()+"\0";function ZX(t){return parseInt(t,10)==t?parseInt(t,10):t.charCodeAt(0)}function rZe(t){return t.split("\\\\").join(EEe).split("\\{").join(wEe).split("\\}").join(eJ).split("\\,").join(REe).split("\\.").join(kEe)}function nZe(t){return t.split(EEe).join("\\").split(wEe).join("{").split(eJ).join("}").split(REe).join(",").split(kEe).join(".")}function AEe(t){if(!t)return[""];var e=[],r=TEe("{","}",t);if(!r)return t.split(",");var n=r.pre,o=r.body,s=r.post,a=n.split(",");a[a.length-1]+="{"+o+"}";var c=AEe(s);return s.length&&(a[a.length-1]+=c.shift(),a.push.apply(a,c)),e.push.apply(e,a),e}function iZe(t){return t?(t.substr(0,2)==="{}"&&(t="\\{\\}"+t.substr(2)),k2(rZe(t),!0).map(nZe)):[]}function oZe(t){return"{"+t+"}"}function sZe(t){return/^-?0\d/.test(t)}function aZe(t,e){return t<=e}function cZe(t,e){return t>=e}function k2(t,e){var r=[],n=TEe("{","}",t);if(!n)return[t];var o=n.pre,s=n.post.length?k2(n.post,!1):[""];if(/\$$/.test(n.pre))for(var a=0;a<s.length;a++){var c=o+"{"+n.body+"}"+s[a];r.push(c)}else{var u=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(n.body),l=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(n.body),d=u||l,p=n.body.indexOf(",")>=0;if(!d&&!p)return n.post.match(/,.*\}/)?(t=n.pre+"{"+n.body+eJ+n.post,k2(t)):[t];var f;if(d)f=n.body.split(/\.\./);else if(f=AEe(n.body),f.length===1&&(f=k2(f[0],!1).map(oZe),f.length===1))return s.map(function(M){return n.pre+f[0]+M});var m;if(d){var h=ZX(f[0]),g=ZX(f[1]),v=Math.max(f[0].length,f[1].length),y=f.length==3?Math.abs(ZX(f[2])):1,_=aZe,b=g<h;b&&(y*=-1,_=cZe);var S=f.some(sZe);m=[];for(var I=h;_(I,g);I+=y){var w;if(l)w=String.fromCharCode(I),w==="\\"&&(w="");else if(w=String(I),S){var O=v-w.length;if(O>0){var U=new Array(O+1).join("0");I<0?w="-"+U+w.slice(1):w=U+w}}m.push(w)}}else{m=[];for(var z=0;z<f.length;z++)m.push.apply(m,k2(f[z],!1))}for(var z=0;z<m.length;z++)for(var a=0;a<s.length;a++){var c=o+m[z]+s[a];(!e||d||c)&&r.push(c)}}return r}});var tr=L((P3r,bke)=>{bke.exports={options:{usePureJavaScript:!1}}});var Ske=L((D3r,xke)=>{var JZ={};xke.exports=JZ;var _ke={};JZ.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=Rrt(t,e);else{var o=0,s=e.length,a=e.charAt(0),c=[0];for(o=0;o<t.length;++o){for(var u=0,l=t[o];u<c.length;++u)l+=c[u]<<8,c[u]=l%s,l=l/s|0;for(;l>0;)c.push(l%s),l=l/s|0}for(o=0;t[o]===0&&o<t.length-1;++o)n+=a;for(o=c.length-1;o>=0;--o)n+=e[c[o]]}if(r){var d=new RegExp(".{1,"+r+"}","g");n=n.match(d).join(`\r
`)}return n};JZ.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=_ke[e];if(!r){r=_ke[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var o=e.length,s=e.charAt(0),a=[0],n=0;n<t.length;n++){var c=r[t.charCodeAt(n)];if(c===void 0)return;for(var u=0,l=c;u<a.length;++u)l+=a[u]*o,a[u]=l&255,l>>=8;for(;l>0;)a.push(l&255),l>>=8}for(var d=0;t[d]===s&&d<t.length-1;++d)a.push(0);return typeof Buffer<"u"?Buffer.from(a.reverse()):new Uint8Array(a.reverse())};function Rrt(t,e){var r=0,n=e.length,o=e.charAt(0),s=[0];for(r=0;r<t.length();++r){for(var a=0,c=t.at(r);a<s.length;++a)c+=s[a]<<8,s[a]=c%n,c=c/n|0;for(;c>0;)s.push(c%n),c=c/n|0}var u="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)u+=o;for(r=s.length-1;r>=0;--r)u+=e[s[r]];return u}});var Or=L((N3r,Eke)=>{var Ike=tr(),Cke=Ske(),K=Eke.exports=Ike.util=Ike.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){K.nextTick=process.nextTick,typeof setImmediate=="function"?K.setImmediate=setImmediate:K.setImmediate=K.nextTick;return}if(typeof setImmediate=="function"){K.setImmediate=function(){return setImmediate.apply(void 0,arguments)},K.nextTick=function(c){return setImmediate(c)};return}if(K.setImmediate=function(c){setTimeout(c,0)},typeof window<"u"&&typeof window.postMessage=="function"){let c=function(u){if(u.source===window&&u.data===t){u.stopPropagation();var l=e.slice();e.length=0,l.forEach(function(d){d()})}};var a=c,t="forge.setImmediate",e=[];K.setImmediate=function(u){e.push(u),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",c,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,o=document.createElement("div"),e=[];new MutationObserver(function(){var u=e.slice();e.length=0,u.forEach(function(l){l()})}).observe(o,{attributes:!0});var s=K.setImmediate;K.setImmediate=function(u){Date.now()-r>15?(r=Date.now(),s(u)):(e.push(u),e.length===1&&o.setAttribute("a",n=!n))}}K.nextTick=K.setImmediate})();K.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;K.globalScope=function(){return K.isNodejs?global:typeof self>"u"?window:self}();K.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};K.isArrayBuffer=function(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer};K.isArrayBufferView=function(t){return t&&K.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function hA(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}K.ByteBuffer=ZZ;function ZZ(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(K.isArrayBuffer(t)||K.isArrayBufferView(t))if(typeof Buffer<"u"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch{for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof ZZ||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}K.ByteStringBuffer=ZZ;var krt=4096;K.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>krt&&(this.data.substr(0,1),this._constructedStringLength=0)};K.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};K.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};K.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};K.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};K.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};K.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(K.encodeUtf8(t))};K.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};K.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};K.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};K.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};K.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};K.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};K.ByteStringBuffer.prototype.putInt=function(t,e){hA(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};K.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};K.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};K.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};K.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};K.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};K.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};K.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};K.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};K.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};K.ByteStringBuffer.prototype.getInt=function(t){hA(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};K.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};K.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};K.ByteStringBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};K.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};K.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};K.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};K.ByteStringBuffer.prototype.copy=function(){var t=K.createBuffer(this.data);return t.read=this.read,t};K.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};K.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};K.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};K.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};K.ByteStringBuffer.prototype.toString=function(){return K.decodeUtf8(this.bytes())};function Art(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=K.isArrayBuffer(t),n=K.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}K.DataBuffer=Art;K.DataBuffer.prototype.length=function(){return this.write-this.read};K.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};K.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};K.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};K.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};K.DataBuffer.prototype.putBytes=function(t,e){if(K.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var o=new Uint8Array(this.data.buffer,this.write);return o.set(r),this.write+=n,this}if(K.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var o=new Uint8Array(this.data.buffer);return o.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof K.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&K.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var o=new Uint8Array(t.data.byteLength,this.write);return o.set(r),this.write+=r.byteLength,this}if(t instanceof K.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var s;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=K.binary.hex.decode(t,s,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=K.binary.base64.decode(t,s,this.write),this;if(e==="utf8"&&(t=K.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=K.binary.raw.decode(s),this;if(e==="utf16")return this.accommodate(t.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=K.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};K.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};K.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};K.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};K.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};K.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};K.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};K.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};K.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};K.DataBuffer.prototype.putInt=function(t,e){hA(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};K.DataBuffer.prototype.putSignedInt=function(t,e){return hA(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};K.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};K.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};K.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};K.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};K.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};K.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};K.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};K.DataBuffer.prototype.getInt=function(t){hA(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};K.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};K.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};K.DataBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};K.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};K.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};K.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};K.DataBuffer.prototype.copy=function(){return new K.DataBuffer(this)};K.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};K.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};K.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};K.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};K.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return K.binary.raw.encode(e);if(t==="hex")return K.binary.hex.encode(e);if(t==="base64")return K.binary.base64.encode(e);if(t==="utf8")return K.text.utf8.decode(e);if(t==="utf16")return K.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};K.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=K.encodeUtf8(t)),new K.ByteBuffer(t)};K.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};K.xorBytes=function(t,e,r){for(var n="",o="",s="",a=0,c=0;r>0;--r,++a)o=t.charCodeAt(a)^e.charCodeAt(a),c>=10&&(n+=s,s="",c=0),s+=String.fromCharCode(o),++c;return n+=s,n};K.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};K.bytesToHex=function(t){return K.createBuffer(t).toHex()};K.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var Gv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Vv=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],Tke="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";K.encode64=function(t,e){for(var r="",n="",o,s,a,c=0;c<t.length;)o=t.charCodeAt(c++),s=t.charCodeAt(c++),a=t.charCodeAt(c++),r+=Gv.charAt(o>>2),r+=Gv.charAt((o&3)<<4|s>>4),isNaN(s)?r+="==":(r+=Gv.charAt((s&15)<<2|a>>6),r+=isNaN(a)?"=":Gv.charAt(a&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};K.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,o,s,a=0;a<t.length;)r=Vv[t.charCodeAt(a++)-43],n=Vv[t.charCodeAt(a++)-43],o=Vv[t.charCodeAt(a++)-43],s=Vv[t.charCodeAt(a++)-43],e+=String.fromCharCode(r<<2|n>>4),o!==64&&(e+=String.fromCharCode((n&15)<<4|o>>2),s!==64&&(e+=String.fromCharCode((o&3)<<6|s)));return e};K.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};K.decodeUtf8=function(t){return decodeURIComponent(escape(t))};K.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:Cke.encode,decode:Cke.decode}};K.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};K.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var o=r,s=0;s<t.length;++s)n[o++]=t.charCodeAt(s);return e?o-r:n};K.binary.hex.encode=K.bytesToHex;K.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var o=0,s=r;for(t.length&1&&(o=1,n[s++]=parseInt(t[0],16));o<t.length;o+=2)n[s++]=parseInt(t.substr(o,2),16);return e?s-r:n};K.binary.base64.encode=function(t,e){for(var r="",n="",o,s,a,c=0;c<t.byteLength;)o=t[c++],s=t[c++],a=t[c++],r+=Gv.charAt(o>>2),r+=Gv.charAt((o&3)<<4|s>>4),isNaN(s)?r+="==":(r+=Gv.charAt((s&15)<<2|a>>6),r+=isNaN(a)?"=":Gv.charAt(a&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};K.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var o,s,a,c,u=0,l=r;u<t.length;)o=Vv[t.charCodeAt(u++)-43],s=Vv[t.charCodeAt(u++)-43],a=Vv[t.charCodeAt(u++)-43],c=Vv[t.charCodeAt(u++)-43],n[l++]=o<<2|s>>4,a!==64&&(n[l++]=(s&15)<<4|a>>2,c!==64&&(n[l++]=(a&3)<<6|c));return e?l-r:n.subarray(0,l)};K.binary.base58.encode=function(t,e){return K.binary.baseN.encode(t,Tke,e)};K.binary.base58.decode=function(t,e){return K.binary.baseN.decode(t,Tke,e)};K.text={utf8:{},utf16:{}};K.text.utf8.encode=function(t,e,r){t=K.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var o=r,s=0;s<t.length;++s)n[o++]=t.charCodeAt(s);return e?o-r:n};K.text.utf8.decode=function(t){return K.decodeUtf8(String.fromCharCode.apply(null,t))};K.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var o=new Uint16Array(n.buffer);r=r||0;for(var s=r,a=r,c=0;c<t.length;++c)o[a++]=t.charCodeAt(c),s+=2;return e?s-r:n};K.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};K.deflate=function(t,e,r){if(e=K.decode64(t.deflate(K.encode64(e)).rval),r){var n=2,o=e.charCodeAt(1);o&32&&(n=6),e=e.substring(n,e.length-4)}return e};K.inflate=function(t,e,r){var n=t.inflate(K.encode64(e)).rval;return n===null?null:K.decode64(n)};var eee=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=K.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n<"u"&&n.rval!==!0){var o=new Error(n.error.message);throw o.id=n.error.id,o.name=n.error.name,o}},tee=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(K.decode64(r))),r},Prt=function(t,e,r,n){var o=tee(t,e);o===null&&(o={}),o[r]=n,eee(t,e,o)},Drt=function(t,e,r){var n=tee(t,e);return n!==null&&(n=r in n?n[r]:null),n},Nrt=function(t,e,r){var n=tee(t,e);if(n!==null&&r in n){delete n[r];var o=!0;for(var s in n){o=!1;break}o&&(n=null),eee(t,e,n)}},Lrt=function(t,e){eee(t,e,null)},v9=function(t,e,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var o,s=!1,a=null;for(var c in r){o=r[c];try{if(o==="flash"||o==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),s=o==="flash"}(o==="web"||o==="both")&&(e[0]=localStorage,n=t.apply(this,e),s=!0)}catch(u){a=u}if(s)break}if(!s)throw a;return n};K.setItem=function(t,e,r,n,o){v9(Prt,arguments,o)};K.getItem=function(t,e,r,n){return v9(Drt,arguments,n)};K.removeItem=function(t,e,r,n){v9(Nrt,arguments,n)};K.clearItems=function(t,e,r){v9(Lrt,arguments,r)};K.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};K.format=function(t){for(var e=/%./g,r,n,o=0,s=[],a=0;r=e.exec(t);){n=t.substring(a,e.lastIndex-2),n.length>0&&s.push(n),a=e.lastIndex;var c=r[0][1];switch(c){case"s":case"o":o<arguments.length?s.push(arguments[o+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+c+"?>")}}return s.push(t.substring(a)),s.join("")};K.formatNumber=function(t,e,r,n){var o=t,s=isNaN(e=Math.abs(e))?2:e,a=r===void 0?",":r,c=n===void 0?".":n,u=o<0?"-":"",l=parseInt(o=Math.abs(+o||0).toFixed(s),10)+"",d=l.length>3?l.length%3:0;return u+(d?l.substr(0,d)+c:"")+l.substr(d).replace(/(\d{3})(?=\d)/g,"$1"+c)+(s?a+Math.abs(o-l).toFixed(s).slice(2):"")};K.formatSize=function(t){return t>=1073741824?t=K.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=K.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=K.formatNumber(t/1024,0)+" KiB":t=K.formatNumber(t,0)+" bytes",t};K.bytesFromIP=function(t){return t.indexOf(".")!==-1?K.bytesFromIPv4(t):t.indexOf(":")!==-1?K.bytesFromIPv6(t):null};K.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=K.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};K.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(a){return a.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=K.createBuffer(),o=0;o<8;++o){if(!t[o]||t[o].length===0){n.fillWithByte(0,r),r=0;continue}var s=K.hexToBytes(t[o]);s.length<2&&n.putByte(0),n.putBytes(s)}return n.getBytes()};K.bytesToIP=function(t){return t.length===4?K.bytesToIPv4(t):t.length===16?K.bytesToIPv6(t):null};K.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};K.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,o=0;o<t.length;o+=2){for(var s=K.bytesToHex(t[o]+t[o+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var a=r[r.length-1],c=e.length;!a||c!==a.end+1?r.push({start:c,end:c}):(a.end=c,a.end-a.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(s)}if(r.length>0){var u=r[n];u.end-u.start>0&&(e.splice(u.start,u.end-u.start+1,""),u.start===0&&e.unshift(""),u.end===7&&e.push(""))}return e.join(":")};K.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in K&&!t.update)return e(null,K.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return K.cores=navigator.hardwareConcurrency,e(null,K.cores);if(typeof Worker>"u")return K.cores=1,e(null,K.cores);if(typeof Blob>"u")return K.cores=2,e(null,K.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(a){for(var c=Date.now(),u=c+4;Date.now()<u;);self.postMessage({st:c,et:u})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(a,c,u){if(c===0){var l=Math.floor(a.reduce(function(d,p){return d+p},0)/a.length);return K.cores=Math.max(1,l),URL.revokeObjectURL(r),e(null,K.cores)}o(u,function(d,p){a.push(s(u,p)),n(a,c-1,u)})}function o(a,c){for(var u=[],l=[],d=0;d<a;++d){var p=new Worker(r);p.addEventListener("message",function(f){if(l.push(f.data),l.length===a){for(var m=0;m<a;++m)u[m].terminate();c(null,l)}}),u.push(p)}for(var d=0;d<a;++d)u[d].postMessage(d)}function s(a,c){for(var u=[],l=0;l<a;++l)for(var d=c[l],p=u[l]=[],f=0;f<a;++f)if(l!==f){var m=c[f];(d.st>m.st&&d.st<m.et||m.st>d.st&&m.st<d.et)&&p.push(f)}return u.reduce(function(h,g){return Math.max(h,g.length)},0)}}});var y9=L((L3r,wke)=>{var Jo=tr();Or();wke.exports=Jo.cipher=Jo.cipher||{};Jo.cipher.algorithms=Jo.cipher.algorithms||{};Jo.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Jo.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Jo.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};Jo.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Jo.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Jo.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};Jo.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),Jo.cipher.algorithms[t]=e};Jo.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in Jo.cipher.algorithms?Jo.cipher.algorithms[t]:null};var ree=Jo.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};ree.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=Jo.util.createBuffer(),this.output=t.output||Jo.util.createBuffer(),this.mode.start(e)};ree.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};ree.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var iee=L((O3r,Rke)=>{var Zo=tr();Or();Zo.cipher=Zo.cipher||{};var dr=Rke.exports=Zo.cipher.modes=Zo.cipher.modes||{};dr.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};dr.ecb.prototype.start=function(t){};dr.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};dr.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};dr.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};dr.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};dr.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};dr.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=b9(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};dr.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};dr.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};dr.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};dr.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};dr.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Zo.util.createBuffer(),this._partialBytes=0};dr.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=b9(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};dr.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var o=0;o<this._ints;++o)this._inBlock[o]=t.getInt32()^this._outBlock[o],e.putInt32(this._inBlock[o]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialBlock[o]=t.getInt32()^this._outBlock[o],this._partialOutput.putInt32(this._partialBlock[o]);if(s>0)t.read-=this.blockSize;else for(var o=0;o<this._ints;++o)this._inBlock[o]=this._partialBlock[o];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};dr.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var o=0;o<this._ints;++o)this._inBlock[o]=t.getInt32(),e.putInt32(this._inBlock[o]^this._outBlock[o]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialBlock[o]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[o]^this._outBlock[o]);if(s>0)t.read-=this.blockSize;else for(var o=0;o<this._ints;++o)this._inBlock[o]=this._partialBlock[o];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};dr.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Zo.util.createBuffer(),this._partialBytes=0};dr.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=b9(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};dr.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var o=0;o<this._ints;++o)e.putInt32(t.getInt32()^this._outBlock[o]),this._inBlock[o]=this._outBlock[o];return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialOutput.putInt32(t.getInt32()^this._outBlock[o]);if(s>0)t.read-=this.blockSize;else for(var o=0;o<this._ints;++o)this._inBlock[o]=this._outBlock[o];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};dr.ofb.prototype.decrypt=dr.ofb.prototype.encrypt;dr.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Zo.util.createBuffer(),this._partialBytes=0};dr.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=b9(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};dr.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var o=0;o<this._ints;++o)e.putInt32(t.getInt32()^this._outBlock[o]);else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialOutput.putInt32(t.getInt32()^this._outBlock[o]);if(s>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}_9(this._inBlock)};dr.ctr.prototype.decrypt=dr.ctr.prototype.encrypt;dr.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Zo.util.createBuffer(),this._partialBytes=0,this._R=3774873600};dr.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=Zo.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=Zo.util.createBuffer(t.additionalData):r=Zo.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=Zo.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(nee(n*8)))}this._inBlock=this._j0.slice(0),_9(this._inBlock),this._partialBytes=0,r=Zo.util.createBuffer(r),this._aDataLength=nee(r.length()*8);var o=r.length()%this.blockSize;for(o&&r.fillWithByte(0,this.blockSize-o),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};dr.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var o=0;o<this._ints;++o)e.putInt32(this._outBlock[o]^=t.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialOutput.putInt32(t.getInt32()^this._outBlock[o]);if(s<=0||r){if(r){var a=n%this.blockSize;this._cipherLength+=a,this._partialOutput.truncate(this.blockSize-a)}else this._cipherLength+=this.blockSize;for(var o=0;o<this._ints;++o)this._outBlock[o]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),_9(this._inBlock)};dr.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),_9(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var o=0;o<this._ints;++o)e.putInt32(this._outBlock[o]^this._hashBlock[o]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};dr.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=Zo.util.createBuffer();var n=this._aDataLength.concat(nee(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var o=[];this.cipher.encrypt(this._j0,o);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^o[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};dr.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),o=0;o<128;++o){var s=t[o/32|0]&1<<31-o%32;s&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};dr.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};dr.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,o=t[n]>>>(7-r%8)*4&15,s=this._m[r][o];e[0]^=s[0],e[1]^=s[1],e[2]^=s[2],e[3]^=s[3]}return e};dr.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};dr.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,o=16*r,s=new Array(o),a=0;a<o;++a){var c=[0,0,0,0],u=a/n|0,l=(n-1-a%n)*e;c[u]=1<<e-1<<l,s[a]=this.generateSubHashTable(this.multiply(c,t),e)}return s};dr.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,o=new Array(r);o[n]=t.slice(0);for(var s=n>>>1;s>0;)this.pow(o[2*s],o[s]=[]),s>>=1;for(s=2;s<n;){for(var a=1;a<s;++a){var c=o[s],u=o[a];o[s+a]=[c[0]^u[0],c[1]^u[1],c[2]^u[2],c[3]^u[3]]}s*=2}for(o[0]=[0,0,0,0],s=n+1;s<r;++s){var l=o[s^n];o[s]=[t[0]^l[0],t[1]^l[1],t[2]^l[2],t[3]^l[3]]}return o};function b9(t,e){if(typeof t=="string"&&(t=Zo.util.createBuffer(t)),Zo.util.isArray(t)&&t.length>4){var r=t;t=Zo.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!Zo.util.isArray(t)){for(var o=[],s=e/4,n=0;n<s;++n)o.push(t.getInt32());t=o}return t}function _9(t){t[t.length-1]=t[t.length-1]+1&4294967295}function nee(t){return[t/4294967296|0,t&4294967295]}});var $v=L((M3r,Dke)=>{var Rn=tr();y9();iee();Or();Dke.exports=Rn.aes=Rn.aes||{};Rn.aes.startEncrypting=function(t,e,r,n){var o=x9({key:t,output:r,decrypt:!1,mode:n});return o.start(e),o};Rn.aes.createEncryptionCipher=function(t,e){return x9({key:t,output:null,decrypt:!1,mode:e})};Rn.aes.startDecrypting=function(t,e,r,n){var o=x9({key:t,output:r,decrypt:!0,mode:n});return o.start(e),o};Rn.aes.createDecryptionCipher=function(t,e){return x9({key:t,output:null,decrypt:!0,mode:e})};Rn.aes.Algorithm=function(t,e){aee||Ake();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,o){return see(r._w,n,o,!1)},decrypt:function(n,o){return see(r._w,n,o,!0)}}}),r._init=!1};Rn.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=Rn.util.createBuffer(e);else if(Rn.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=Rn.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!Rn.util.isArray(e)){r=e,e=[];var o=r.length();if(o===16||o===24||o===32){o=o>>>2;for(var n=0;n<o;++n)e.push(r.getInt32())}}if(!Rn.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,a=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=Pke(e,t.decrypt&&!a),this._init=!0}};Rn.aes._expandKey=function(t,e){return aee||Ake(),Pke(t,e)};Rn.aes._updateBlock=see;RT("AES-ECB",Rn.cipher.modes.ecb);RT("AES-CBC",Rn.cipher.modes.cbc);RT("AES-CFB",Rn.cipher.modes.cfb);RT("AES-OFB",Rn.cipher.modes.ofb);RT("AES-CTR",Rn.cipher.modes.ctr);RT("AES-GCM",Rn.cipher.modes.gcm);function RT(t,e){var r=function(){return new Rn.aes.Algorithm(t,e)};Rn.cipher.registerAlgorithm(t,r)}var aee=!1,wT=4,_a,oee,kke,Qb,Nl;function Ake(){aee=!0,kke=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;_a=new Array(256),oee=new Array(256),Qb=new Array(4),Nl=new Array(4);for(var e=0;e<4;++e)Qb[e]=new Array(256),Nl[e]=new Array(256);for(var r=0,n=0,o,s,a,c,u,l,d,e=0;e<256;++e){c=n^n<<1^n<<2^n<<3^n<<4,c=c>>8^c&255^99,_a[r]=c,oee[c]=r,u=t[c],o=t[r],s=t[o],a=t[s],l=u<<24^c<<16^c<<8^(c^u),d=(o^s^a)<<24^(r^a)<<16^(r^s^a)<<8^(r^o^a);for(var p=0;p<4;++p)Qb[p][r]=l,Nl[p][c]=d,l=l<<24|l>>>8,d=d<<24|d>>>8;r===0?r=n=1:(r=o^t[t[t[o^a]]],n^=t[t[n]])}}function Pke(t,e){for(var r=t.slice(0),n,o=1,s=r.length,a=s+6+1,c=wT*a,u=s;u<c;++u)n=r[u-1],u%s===0?(n=_a[n>>>16&255]<<24^_a[n>>>8&255]<<16^_a[n&255]<<8^_a[n>>>24]^kke[o]<<24,o++):s>6&&u%s===4&&(n=_a[n>>>24]<<24^_a[n>>>16&255]<<16^_a[n>>>8&255]<<8^_a[n&255]),r[u]=r[u-s]^n;if(e){var l,d=Nl[0],p=Nl[1],f=Nl[2],m=Nl[3],h=r.slice(0);c=r.length;for(var u=0,g=c-wT;u<c;u+=wT,g-=wT)if(u===0||u===c-wT)h[u]=r[g],h[u+1]=r[g+3],h[u+2]=r[g+2],h[u+3]=r[g+1];else for(var v=0;v<wT;++v)l=r[g+v],h[u+(3&-v)]=d[_a[l>>>24]]^p[_a[l>>>16&255]]^f[_a[l>>>8&255]]^m[_a[l&255]];r=h}return r}function see(t,e,r,n){var o=t.length/4-1,s,a,c,u,l;n?(s=Nl[0],a=Nl[1],c=Nl[2],u=Nl[3],l=oee):(s=Qb[0],a=Qb[1],c=Qb[2],u=Qb[3],l=_a);var d,p,f,m,h,g,v;d=e[0]^t[0],p=e[n?3:1]^t[1],f=e[2]^t[2],m=e[n?1:3]^t[3];for(var y=3,_=1;_<o;++_)h=s[d>>>24]^a[p>>>16&255]^c[f>>>8&255]^u[m&255]^t[++y],g=s[p>>>24]^a[f>>>16&255]^c[m>>>8&255]^u[d&255]^t[++y],v=s[f>>>24]^a[m>>>16&255]^c[d>>>8&255]^u[p&255]^t[++y],m=s[m>>>24]^a[d>>>16&255]^c[p>>>8&255]^u[f&255]^t[++y],d=h,p=g,f=v;r[0]=l[d>>>24]<<24^l[p>>>16&255]<<16^l[f>>>8&255]<<8^l[m&255]^t[++y],r[n?3:1]=l[p>>>24]<<24^l[f>>>16&255]<<16^l[m>>>8&255]<<8^l[d&255]^t[++y],r[2]=l[f>>>24]<<24^l[m>>>16&255]<<16^l[d>>>8&255]<<8^l[p&255]^t[++y],r[n?1:3]=l[m>>>24]<<24^l[d>>>16&255]<<16^l[p>>>8&255]<<8^l[f&255]^t[++y]}function x9(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=Rn.cipher.createDecipher(r,t.key):n=Rn.cipher.createCipher(r,t.key);var o=n.start;return n.start=function(s,a){var c=null;a instanceof Rn.util.ByteBuffer&&(c=a,a={}),a=a||{},a.output=c,a.iv=s,o.call(n,a)},n}});var Wv=L((F3r,Nke)=>{var gA=tr();gA.pki=gA.pki||{};var cee=Nke.exports=gA.pki.oids=gA.oids=gA.oids||{};function Pe(t,e){cee[t]=e,cee[e]=t}function tn(t,e){cee[t]=e}Pe("1.2.840.113549.1.1.1","rsaEncryption");Pe("1.2.840.113549.1.1.4","md5WithRSAEncryption");Pe("1.2.840.113549.1.1.5","sha1WithRSAEncryption");Pe("1.2.840.113549.1.1.7","RSAES-OAEP");Pe("1.2.840.113549.1.1.8","mgf1");Pe("1.2.840.113549.1.1.9","pSpecified");Pe("1.2.840.113549.1.1.10","RSASSA-PSS");Pe("1.2.840.113549.1.1.11","sha256WithRSAEncryption");Pe("1.2.840.113549.1.1.12","sha384WithRSAEncryption");Pe("1.2.840.113549.1.1.13","sha512WithRSAEncryption");Pe("1.3.101.112","EdDSA25519");Pe("1.2.840.10040.4.3","dsa-with-sha1");Pe("1.3.14.3.2.7","desCBC");Pe("1.3.14.3.2.26","sha1");Pe("1.3.14.3.2.29","sha1WithRSASignature");Pe("2.16.840.1.101.3.4.2.1","sha256");Pe("2.16.840.1.101.3.4.2.2","sha384");Pe("2.16.840.1.101.3.4.2.3","sha512");Pe("2.16.840.1.101.3.4.2.4","sha224");Pe("2.16.840.1.101.3.4.2.5","sha512-224");Pe("2.16.840.1.101.3.4.2.6","sha512-256");Pe("1.2.840.113549.2.2","md2");Pe("1.2.840.113549.2.5","md5");Pe("1.2.840.113549.1.7.1","data");Pe("1.2.840.113549.1.7.2","signedData");Pe("1.2.840.113549.1.7.3","envelopedData");Pe("1.2.840.113549.1.7.4","signedAndEnvelopedData");Pe("1.2.840.113549.1.7.5","digestedData");Pe("1.2.840.113549.1.7.6","encryptedData");Pe("1.2.840.113549.1.9.1","emailAddress");Pe("1.2.840.113549.1.9.2","unstructuredName");Pe("1.2.840.113549.1.9.3","contentType");Pe("1.2.840.113549.1.9.4","messageDigest");Pe("1.2.840.113549.1.9.5","signingTime");Pe("1.2.840.113549.1.9.6","counterSignature");Pe("1.2.840.113549.1.9.7","challengePassword");Pe("1.2.840.113549.1.9.8","unstructuredAddress");Pe("1.2.840.113549.1.9.14","extensionRequest");Pe("1.2.840.113549.1.9.20","friendlyName");Pe("1.2.840.113549.1.9.21","localKeyId");Pe("1.2.840.113549.1.9.22.1","x509Certificate");Pe("1.2.840.113549.1.12.10.1.1","keyBag");Pe("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");Pe("1.2.840.113549.1.12.10.1.3","certBag");Pe("1.2.840.113549.1.12.10.1.4","crlBag");Pe("1.2.840.113549.1.12.10.1.5","secretBag");Pe("1.2.840.113549.1.12.10.1.6","safeContentsBag");Pe("1.2.840.113549.1.5.13","pkcs5PBES2");Pe("1.2.840.113549.1.5.12","pkcs5PBKDF2");Pe("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");Pe("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");Pe("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");Pe("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");Pe("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");Pe("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");Pe("1.2.840.113549.2.7","hmacWithSHA1");Pe("1.2.840.113549.2.8","hmacWithSHA224");Pe("1.2.840.113549.2.9","hmacWithSHA256");Pe("1.2.840.113549.2.10","hmacWithSHA384");Pe("1.2.840.113549.2.11","hmacWithSHA512");Pe("1.2.840.113549.3.7","des-EDE3-CBC");Pe("2.16.840.1.101.3.4.1.2","aes128-CBC");Pe("2.16.840.1.101.3.4.1.22","aes192-CBC");Pe("2.16.840.1.101.3.4.1.42","aes256-CBC");Pe("2.5.4.3","commonName");Pe("2.5.4.4","surname");Pe("2.5.4.5","serialNumber");Pe("2.5.4.6","countryName");Pe("2.5.4.7","localityName");Pe("2.5.4.8","stateOrProvinceName");Pe("2.5.4.9","streetAddress");Pe("2.5.4.10","organizationName");Pe("2.5.4.11","organizationalUnitName");Pe("2.5.4.12","title");Pe("2.5.4.13","description");Pe("2.5.4.15","businessCategory");Pe("2.5.4.17","postalCode");Pe("2.5.4.42","givenName");Pe("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");Pe("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");Pe("2.16.840.1.113730.1.1","nsCertType");Pe("2.16.840.1.113730.1.13","nsComment");tn("2.5.29.1","authorityKeyIdentifier");tn("2.5.29.2","keyAttributes");tn("2.5.29.3","certificatePolicies");tn("2.5.29.4","keyUsageRestriction");tn("2.5.29.5","policyMapping");tn("2.5.29.6","subtreesConstraint");tn("2.5.29.7","subjectAltName");tn("2.5.29.8","issuerAltName");tn("2.5.29.9","subjectDirectoryAttributes");tn("2.5.29.10","basicConstraints");tn("2.5.29.11","nameConstraints");tn("2.5.29.12","policyConstraints");tn("2.5.29.13","basicConstraints");Pe("2.5.29.14","subjectKeyIdentifier");Pe("2.5.29.15","keyUsage");tn("2.5.29.16","privateKeyUsagePeriod");Pe("2.5.29.17","subjectAltName");Pe("2.5.29.18","issuerAltName");Pe("2.5.29.19","basicConstraints");tn("2.5.29.20","cRLNumber");tn("2.5.29.21","cRLReason");tn("2.5.29.22","expirationDate");tn("2.5.29.23","instructionCode");tn("2.5.29.24","invalidityDate");tn("2.5.29.25","cRLDistributionPoints");tn("2.5.29.26","issuingDistributionPoint");tn("2.5.29.27","deltaCRLIndicator");tn("2.5.29.28","issuingDistributionPoint");tn("2.5.29.29","certificateIssuer");tn("2.5.29.30","nameConstraints");Pe("2.5.29.31","cRLDistributionPoints");Pe("2.5.29.32","certificatePolicies");tn("2.5.29.33","policyMappings");tn("2.5.29.34","policyConstraints");Pe("2.5.29.35","authorityKeyIdentifier");tn("2.5.29.36","policyConstraints");Pe("2.5.29.37","extKeyUsage");tn("2.5.29.46","freshestCRL");tn("2.5.29.54","inhibitAnyPolicy");Pe("1.3.6.1.4.1.11129.2.4.2","timestampList");Pe("1.3.6.1.5.5.7.1.1","authorityInfoAccess");Pe("1.3.6.1.5.5.7.3.1","serverAuth");Pe("1.3.6.1.5.5.7.3.2","clientAuth");Pe("1.3.6.1.5.5.7.3.3","codeSigning");Pe("1.3.6.1.5.5.7.3.4","emailProtection");Pe("1.3.6.1.5.5.7.3.8","timeStamping")});var Ll=L((U3r,Oke)=>{var jn=tr();Or();Wv();var $e=Oke.exports=jn.asn1=jn.asn1||{};$e.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};$e.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};$e.create=function(t,e,r,n,o){if(jn.util.isArray(n)){for(var s=[],a=0;a<n.length;++a)n[a]!==void 0&&s.push(n[a]);n=s}var c={tagClass:t,type:e,constructed:r,composed:r||jn.util.isArray(n),value:n};return o&&"bitStringContents"in o&&(c.bitStringContents=o.bitStringContents,c.original=$e.copy(c)),c};$e.copy=function(t,e){var r;if(jn.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push($e.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:$e.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};$e.equals=function(t,e,r){if(jn.util.isArray(t)){if(!jn.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!$e.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var o=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&$e.equals(t.value,e.value);return r&&r.includeBitStringContents&&(o=o&&t.bitStringContents===e.bitStringContents),o};$e.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function vA(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}var Ort=function(t,e){var r=t.getByte();if(e--,r!==128){var n,o=r&128;if(!o)n=r;else{var s=r&127;vA(t,e,s),n=t.getInt(s<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};$e.fromDer=function(t,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=jn.util.createBuffer(t));var r=t.length(),n=S9(t,t.length(),0,e);if(e.parseAllBytes&&t.length()!==0){var o=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw o.byteCount=r,o.remaining=t.length(),o}return n};function S9(t,e,r,n){var o;vA(t,e,2);var s=t.getByte();e--;var a=s&192,c=s&31;o=t.length();var u=Ort(t,e);if(e-=o-t.length(),u!==void 0&&u>e){if(n.strict){var l=new Error("Too few bytes to read ASN.1 value.");throw l.available=t.length(),l.remaining=e,l.requested=u,l}u=e}var d,p,f=(s&32)===32;if(f)if(d=[],u===void 0)for(;;){if(vA(t,e,2),t.bytes(2)==="\0\0"){t.getBytes(2),e-=2;break}o=t.length(),d.push(S9(t,e,r+1,n)),e-=o-t.length()}else for(;u>0;)o=t.length(),d.push(S9(t,u,r+1,n)),e-=o-t.length(),u-=o-t.length();if(d===void 0&&a===$e.Class.UNIVERSAL&&c===$e.Type.BITSTRING&&(p=t.bytes(u)),d===void 0&&n.decodeBitStrings&&a===$e.Class.UNIVERSAL&&c===$e.Type.BITSTRING&&u>1){var m=t.read,h=e,g=0;if(c===$e.Type.BITSTRING&&(vA(t,e,1),g=t.getByte(),e--),g===0)try{o=t.length();var v={strict:!0,decodeBitStrings:!0},y=S9(t,e,r+1,v),_=o-t.length();e-=_,c==$e.Type.BITSTRING&&_++;var b=y.tagClass;_===u&&(b===$e.Class.UNIVERSAL||b===$e.Class.CONTEXT_SPECIFIC)&&(d=[y])}catch{}d===void 0&&(t.read=m,e=h)}if(d===void 0){if(u===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");u=e}if(c===$e.Type.BMPSTRING)for(d="";u>0;u-=2)vA(t,e,2),d+=String.fromCharCode(t.getInt16()),e-=2;else d=t.getBytes(u),e-=u}var S=p===void 0?null:{bitStringContents:p};return $e.create(a,c,f,d,S)}$e.toDer=function(t){var e=jn.util.createBuffer(),r=t.tagClass|t.type,n=jn.util.createBuffer(),o=!1;if("bitStringContents"in t&&(o=!0,t.original&&(o=$e.equals(t,t.original))),o)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var s=0;s<t.value.length;++s)t.value[s]!==void 0&&n.putBuffer($e.toDer(t.value[s]))}else if(t.type===$e.Type.BMPSTRING)for(var s=0;s<t.value.length;++s)n.putInt16(t.value.charCodeAt(s));else t.type===$e.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&!(t.value.charCodeAt(1)&128)||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)===128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var a=n.length(),c="";do c+=String.fromCharCode(a&255),a=a>>>8;while(a>0);e.putByte(c.length|128);for(var s=c.length-1;s>=0;--s)e.putByte(c.charCodeAt(s))}return e.putBuffer(n),e};$e.oidToDer=function(t){var e=t.split("."),r=jn.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,o,s,a,c=2;c<e.length;++c){n=!0,o=[],s=parseInt(e[c],10);do a=s&127,s=s>>>7,n||(a|=128),o.push(a),n=!1;while(s>0);for(var u=o.length-1;u>=0;--u)r.putByte(o[u])}return r};$e.derToOid=function(t){var e;typeof t=="string"&&(t=jn.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};$e.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,o=parseInt(t.substr(4,2),10),s=parseInt(t.substr(6,2),10),a=parseInt(t.substr(8,2),10),c=0;if(t.length>11){var u=t.charAt(10),l=10;u!=="+"&&u!=="-"&&(c=parseInt(t.substr(10,2),10),l+=2)}if(e.setUTCFullYear(r,n,o),e.setUTCHours(s,a,c,0),l&&(u=t.charAt(l),u==="+"||u==="-")){var d=parseInt(t.substr(l+1,2),10),p=parseInt(t.substr(l+4,2),10),f=d*60+p;f*=6e4,u==="+"?e.setTime(+e-f):e.setTime(+e+f)}return e};$e.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,o=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),a=parseInt(t.substr(10,2),10),c=parseInt(t.substr(12,2),10),u=0,l=0,d=!1;t.charAt(t.length-1)==="Z"&&(d=!0);var p=t.length-5,f=t.charAt(p);if(f==="+"||f==="-"){var m=parseInt(t.substr(p+1,2),10),h=parseInt(t.substr(p+4,2),10);l=m*60+h,l*=6e4,f==="+"&&(l*=-1),d=!0}return t.charAt(14)==="."&&(u=parseFloat(t.substr(14),10)*1e3),d?(e.setUTCFullYear(r,n,o),e.setUTCHours(s,a,c,u),e.setTime(+e+l)):(e.setFullYear(r,n,o),e.setHours(s,a,c,u)),e};$e.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};$e.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};$e.integerToDer=function(t){var e=jn.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};$e.derToInteger=function(t){typeof t=="string"&&(t=jn.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};$e.validate=function(t,e,r,n){var o=!1;if((t.tagClass===e.tagClass||typeof e.tagClass>"u")&&(t.type===e.type||typeof e.type>"u"))if(t.constructed===e.constructed||typeof e.constructed>"u"){if(o=!0,e.value&&jn.util.isArray(e.value))for(var s=0,a=0;o&&a<e.value.length;++a)o=e.value[a].optional||!1,t.value[s]&&(o=$e.validate(t.value[s],e.value[a],r,n),o?++s:e.value[a].optional&&(o=!0)),!o&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(o&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var c;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var u=t.bitStringContents.charCodeAt(0);if(u!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return o};var Lke=/[^\\u0000-\\u00ff]/;$e.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var o="",s=0;s<e*r;++s)o+=" ";switch(n+=o+"Tag: ",t.tagClass){case $e.Class.UNIVERSAL:n+="Universal:";break;case $e.Class.APPLICATION:n+="Application:";break;case $e.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case $e.Class.PRIVATE:n+="Private:";break}if(t.tagClass===$e.Class.UNIVERSAL)switch(n+=t.type,t.type){case $e.Type.NONE:n+=" (None)";break;case $e.Type.BOOLEAN:n+=" (Boolean)";break;case $e.Type.INTEGER:n+=" (Integer)";break;case $e.Type.BITSTRING:n+=" (Bit string)";break;case $e.Type.OCTETSTRING:n+=" (Octet string)";break;case $e.Type.NULL:n+=" (Null)";break;case $e.Type.OID:n+=" (Object Identifier)";break;case $e.Type.ODESC:n+=" (Object Descriptor)";break;case $e.Type.EXTERNAL:n+=" (External or Instance of)";break;case $e.Type.REAL:n+=" (Real)";break;case $e.Type.ENUMERATED:n+=" (Enumerated)";break;case $e.Type.EMBEDDED:n+=" (Embedded PDV)";break;case $e.Type.UTF8:n+=" (UTF8)";break;case $e.Type.ROID:n+=" (Relative Object Identifier)";break;case $e.Type.SEQUENCE:n+=" (Sequence)";break;case $e.Type.SET:n+=" (Set)";break;case $e.Type.PRINTABLESTRING:n+=" (Printable String)";break;case $e.Type.IA5String:n+=" (IA5String (ASCII))";break;case $e.Type.UTCTIME:n+=" (UTC time)";break;case $e.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case $e.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=o+"Constructed: "+t.constructed+`
`,t.composed){for(var a=0,c="",s=0;s<t.value.length;++s)t.value[s]!==void 0&&(a+=1,c+=$e.prettyPrint(t.value[s],e+1,r),s+1<t.value.length&&(c+=","));n+=o+"Sub values: "+a+c}else{if(n+=o+"Value: ",t.type===$e.Type.OID){var u=$e.derToOid(t.value);n+=u,jn.pki&&jn.pki.oids&&u in jn.pki.oids&&(n+=" ("+jn.pki.oids[u]+") ")}if(t.type===$e.Type.INTEGER)try{n+=$e.derToInteger(t.value)}catch{n+="0x"+jn.util.bytesToHex(t.value)}else if(t.type===$e.Type.BITSTRING){if(t.value.length>1?n+="0x"+jn.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var l=t.value.charCodeAt(0);l==1?n+=" (1 unused bit shown)":l>1&&(n+=" ("+l+" unused bits shown)")}}else if(t.type===$e.Type.OCTETSTRING)Lke.test(t.value)||(n+="("+t.value+") "),n+="0x"+jn.util.bytesToHex(t.value);else if(t.type===$e.Type.UTF8)try{n+=jn.util.decodeUtf8(t.value)}catch(d){if(d.message==="URI malformed")n+="0x"+jn.util.bytesToHex(t.value)+" (malformed UTF8)";else throw d}else t.type===$e.Type.PRINTABLESTRING||t.type===$e.Type.IA5String?n+=t.value:Lke.test(t.value)?n+="0x"+jn.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var gp=L((B3r,Mke)=>{var I9=tr();Mke.exports=I9.md=I9.md||{};I9.md.algorithms=I9.md.algorithms||{}});var kT=L((q3r,Fke)=>{var gm=tr();gp();Or();var Mrt=Fke.exports=gm.hmac=gm.hmac||{};Mrt.create=function(){var t=null,e=null,r=null,n=null,o={};return o.start=function(s,a){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in gm.md.algorithms)e=gm.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else e=s;if(a===null)a=t;else{if(typeof a=="string")a=gm.util.createBuffer(a);else if(gm.util.isArray(a)){var c=a;a=gm.util.createBuffer();for(var u=0;u<c.length;++u)a.putByte(c[u])}var l=a.length();l>e.blockLength&&(e.start(),e.update(a.bytes()),a=e.digest()),r=gm.util.createBuffer(),n=gm.util.createBuffer(),l=a.length();for(var u=0;u<l;++u){var c=a.at(u);r.putByte(54^c),n.putByte(92^c)}if(l<e.blockLength)for(var c=e.blockLength-l,u=0;u<c;++u)r.putByte(54),n.putByte(92);t=a,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},o.update=function(s){e.update(s)},o.getMac=function(){var s=e.digest().bytes();return e.start(),e.update(n),e.update(s),e.digest()},o.digest=o.getMac,o}});var T9=L((H3r,Hke)=>{var vp=tr();gp();Or();var Bke=Hke.exports=vp.md5=vp.md5||{};vp.md.md5=vp.md.algorithms.md5=Bke;Bke.create=function(){qke||Frt();var t=null,e=vp.util.createBuffer(),r=new Array(16),n={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var o=n.messageLengthSize/4,s=0;s<o;++s)n.fullMessageLength.push(0);return e=vp.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},n},n.start(),n.update=function(o,s){s==="utf8"&&(o=vp.util.encodeUtf8(o));var a=o.length;n.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var c=n.fullMessageLength.length-1;c>=0;--c)n.fullMessageLength[c]+=a[1],a[1]=a[0]+(n.fullMessageLength[c]/4294967296>>>0),n.fullMessageLength[c]=n.fullMessageLength[c]>>>0,a[0]=a[1]/4294967296>>>0;return e.putBytes(o),Uke(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var o=vp.util.createBuffer();o.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,a=s&n.blockLength-1;o.putBytes(uee.substr(0,n.blockLength-a));for(var c,u=0,l=n.fullMessageLength.length-1;l>=0;--l)c=n.fullMessageLength[l]*8+u,u=c/4294967296>>>0,o.putInt32Le(c>>>0);var d={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3};Uke(d,r,o);var p=vp.util.createBuffer();return p.putInt32Le(d.h0),p.putInt32Le(d.h1),p.putInt32Le(d.h2),p.putInt32Le(d.h3),p},n};var uee=null,C9=null,yA=null,AT=null,qke=!1;function Frt(){uee="\x80",uee+=vp.util.fillString("\0",64),C9=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],yA=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],AT=new Array(64);for(var t=0;t<64;++t)AT[t]=Math.floor(Math.abs(Math.sin(t+1))*4294967296);qke=!0}function Uke(t,e,r){for(var n,o,s,a,c,u,l,d,p=r.length();p>=64;){for(o=t.h0,s=t.h1,a=t.h2,c=t.h3,d=0;d<16;++d)e[d]=r.getInt32Le(),u=c^s&(a^c),n=o+u+AT[d]+e[d],l=yA[d],o=c,c=a,a=s,s+=n<<l|n>>>32-l;for(;d<32;++d)u=a^c&(s^a),n=o+u+AT[d]+e[C9[d]],l=yA[d],o=c,c=a,a=s,s+=n<<l|n>>>32-l;for(;d<48;++d)u=s^a^c,n=o+u+AT[d]+e[C9[d]],l=yA[d],o=c,c=a,a=s,s+=n<<l|n>>>32-l;for(;d<64;++d)u=a^(s|~c),n=o+u+AT[d]+e[C9[d]],l=yA[d],o=c,c=a,a=s,s+=n<<l|n>>>32-l;t.h0=t.h0+o|0,t.h1=t.h1+s|0,t.h2=t.h2+a|0,t.h3=t.h3+c|0,p-=64}}});var Xb=L((j3r,zke)=>{var w9=tr();Or();var jke=zke.exports=w9.pem=w9.pem||{};jke.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=E9(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=E9(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=E9(n)),t.headers)for(var o=0;o<t.headers.length;++o)r+=E9(t.headers[o]);return t.procType&&(r+=`\r
`),r+=w9.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};jke.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,o=/\r?\n/,s;s=r.exec(t),!!s;){var a=s[1];a==="NEW CERTIFICATE REQUEST"&&(a="CERTIFICATE REQUEST");var c={type:a,procType:null,contentDomain:null,dekInfo:null,headers:[],body:w9.util.decode64(s[3])};if(e.push(c),!!s[2]){for(var u=s[2].split(o),l=0;s&&l<u.length;){for(var d=u[l].replace(/\s+$/,""),p=l+1;p<u.length;++p){var f=u[p];if(!/\s/.test(f[0]))break;d+=f,l=p}if(s=d.match(n),s){for(var m={name:s[1],values:[]},h=s[2].split(","),g=0;g<h.length;++g)m.values.push(Urt(h[g]));if(c.procType)if(!c.contentDomain&&m.name==="Content-Domain")c.contentDomain=h[0]||"";else if(!c.dekInfo&&m.name==="DEK-Info"){if(m.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');c.dekInfo={algorithm:h[0],parameters:h[1]||null}}else c.headers.push(m);else{if(m.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(m.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');c.procType={version:h[0],type:h[1]}}}++l}if(c.procType==="ENCRYPTED"&&!c.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function E9(t){for(var e=t.name+": ",r=[],n=function(u,l){return" "+l},o=0;o<t.values.length;++o)r.push(t.values[o].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var s=0,a=-1,o=0;o<e.length;++o,++s)if(s>65&&a!==-1){var c=e[a];c===","?(++a,e=e.substr(0,a)+`\r
 `+e.substr(a)):e=e.substr(0,a)+`\r
`+c+e.substr(a+1),s=o-a-1,a=-1,++o}else(e[o]===" "||e[o]==="	"||e[o]===",")&&(a=o);return e}function Urt(t){return t.replace(/^\s+/,"")}});var bA=L((z3r,Vke)=>{var ri=tr();y9();iee();Or();Vke.exports=ri.des=ri.des||{};ri.des.startEncrypting=function(t,e,r,n){var o=R9({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return o.start(e),o};ri.des.createEncryptionCipher=function(t,e){return R9({key:t,output:null,decrypt:!1,mode:e})};ri.des.startDecrypting=function(t,e,r,n){var o=R9({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return o.start(e),o};ri.des.createDecryptionCipher=function(t,e){return R9({key:t,output:null,decrypt:!0,mode:e})};ri.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,o){return Gke(r._keys,n,o,!1)},decrypt:function(n,o){return Gke(r._keys,n,o,!0)}}}),r._init=!1};ri.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=ri.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=Wrt(e),this._init=!0}};yp("DES-ECB",ri.cipher.modes.ecb);yp("DES-CBC",ri.cipher.modes.cbc);yp("DES-CFB",ri.cipher.modes.cfb);yp("DES-OFB",ri.cipher.modes.ofb);yp("DES-CTR",ri.cipher.modes.ctr);yp("3DES-ECB",ri.cipher.modes.ecb);yp("3DES-CBC",ri.cipher.modes.cbc);yp("3DES-CFB",ri.cipher.modes.cfb);yp("3DES-OFB",ri.cipher.modes.ofb);yp("3DES-CTR",ri.cipher.modes.ctr);function yp(t,e){var r=function(){return new ri.des.Algorithm(t,e)};ri.cipher.registerAlgorithm(t,r)}var Brt=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],qrt=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],Hrt=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],jrt=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],zrt=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],Grt=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],Vrt=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],$rt=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function Wrt(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],o=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],a=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],c=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],u=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],l=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],d=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],p=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],f=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],m=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],h=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=t.length()>8?3:1,v=[],y=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],_=0,b,S=0;S<g;S++){var I=t.getInt32(),w=t.getInt32();b=(I>>>4^w)&252645135,w^=b,I^=b<<4,b=(w>>>-16^I)&65535,I^=b,w^=b<<-16,b=(I>>>2^w)&858993459,w^=b,I^=b<<2,b=(w>>>-16^I)&65535,I^=b,w^=b<<-16,b=(I>>>1^w)&1431655765,w^=b,I^=b<<1,b=(w>>>8^I)&16711935,I^=b,w^=b<<8,b=(I>>>1^w)&1431655765,w^=b,I^=b<<1,b=I<<8|w>>>20&240,I=w<<24|w<<8&16711680|w>>>8&65280|w>>>24&240,w=b;for(var O=0;O<y.length;++O){y[O]?(I=I<<2|I>>>26,w=w<<2|w>>>26):(I=I<<1|I>>>27,w=w<<1|w>>>27),I&=-15,w&=-15;var U=e[I>>>28]|r[I>>>24&15]|n[I>>>20&15]|o[I>>>16&15]|s[I>>>12&15]|a[I>>>8&15]|c[I>>>4&15],z=u[w>>>28]|l[w>>>24&15]|d[w>>>20&15]|p[w>>>16&15]|f[w>>>12&15]|m[w>>>8&15]|h[w>>>4&15];b=(z>>>16^U)&65535,v[_++]=U^b,v[_++]=z^b<<16}}return v}function Gke(t,e,r,n){var o=t.length===32?3:9,s;o===3?s=n?[30,-2,-2]:[0,32,2]:s=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var a,c=e[0],u=e[1];a=(c>>>4^u)&252645135,u^=a,c^=a<<4,a=(c>>>16^u)&65535,u^=a,c^=a<<16,a=(u>>>2^c)&858993459,c^=a,u^=a<<2,a=(u>>>8^c)&16711935,c^=a,u^=a<<8,a=(c>>>1^u)&1431655765,u^=a,c^=a<<1,c=c<<1|c>>>31,u=u<<1|u>>>31;for(var l=0;l<o;l+=3){for(var d=s[l+1],p=s[l+2],f=s[l];f!=d;f+=p){var m=u^t[f],h=(u>>>4|u<<28)^t[f+1];a=c,c=u,u=a^(qrt[m>>>24&63]|jrt[m>>>16&63]|Grt[m>>>8&63]|$rt[m&63]|Brt[h>>>24&63]|Hrt[h>>>16&63]|zrt[h>>>8&63]|Vrt[h&63])}a=c,c=u,u=a}c=c>>>1|c<<31,u=u>>>1|u<<31,a=(c>>>1^u)&1431655765,u^=a,c^=a<<1,a=(u>>>8^c)&16711935,c^=a,u^=a<<8,a=(u>>>2^c)&858993459,c^=a,u^=a<<2,a=(c>>>16^u)&65535,u^=a,c^=a<<16,a=(c>>>4^u)&252645135,u^=a,c^=a<<4,r[0]=c,r[1]=u}function R9(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=ri.cipher.createDecipher(r,t.key):n=ri.cipher.createCipher(r,t.key);var o=n.start;return n.start=function(s,a){var c=null;a instanceof ri.util.ByteBuffer&&(c=a,a={}),a=a||{},a.output=c,a.iv=s,o.call(n,a)},n}});var k9=L((G3r,$ke)=>{var xa=tr();kT();gp();Or();var Krt=xa.pkcs5=xa.pkcs5||{},vm;xa.util.isNodejs&&!xa.options.usePureJavaScript&&(vm=require("crypto"));$ke.exports=xa.pbkdf2=Krt.pbkdf2=function(t,e,r,n,o,s){if(typeof o=="function"&&(s=o,o=null),xa.util.isNodejs&&!xa.options.usePureJavaScript&&vm.pbkdf2&&(o===null||typeof o!="object")&&(vm.pbkdf2Sync.length>4||!o||o==="sha1"))return typeof o!="string"&&(o="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),s?vm.pbkdf2Sync.length===4?vm.pbkdf2(t,e,r,n,function(b,S){if(b)return s(b);s(null,S.toString("binary"))}):vm.pbkdf2(t,e,r,n,o,function(b,S){if(b)return s(b);s(null,S.toString("binary"))}):vm.pbkdf2Sync.length===4?vm.pbkdf2Sync(t,e,r,n).toString("binary"):vm.pbkdf2Sync(t,e,r,n,o).toString("binary");if((typeof o>"u"||o===null)&&(o="sha1"),typeof o=="string"){if(!(o in xa.md.algorithms))throw new Error("Unknown hash algorithm: "+o);o=xa.md[o].create()}var a=o.digestLength;if(n>4294967295*a){var c=new Error("Derived key is too long.");if(s)return s(c);throw c}var u=Math.ceil(n/a),l=n-(u-1)*a,d=xa.hmac.create();d.start(o,t);var p="",f,m,h;if(!s){for(var g=1;g<=u;++g){d.start(null,null),d.update(e),d.update(xa.util.int32ToBytes(g)),f=h=d.digest().getBytes();for(var v=2;v<=r;++v)d.start(null,null),d.update(h),m=d.digest().getBytes(),f=xa.util.xorBytes(f,m,a),h=m;p+=g<u?f:f.substr(0,l)}return p}var g=1,v;function y(){if(g>u)return s(null,p);d.start(null,null),d.update(e),d.update(xa.util.int32ToBytes(g)),f=h=d.digest().getBytes(),v=2,_()}function _(){if(v<=r)return d.start(null,null),d.update(h),m=d.digest().getBytes(),f=xa.util.xorBytes(f,m,a),h=m,++v,xa.util.setImmediate(_);p+=g<u?f:f.substr(0,l),++g,y()}y()}});var dee=L((V3r,Xke)=>{var bp=tr();gp();Or();var Kke=Xke.exports=bp.sha256=bp.sha256||{};bp.md.sha256=bp.md.algorithms.sha256=Kke;Kke.create=function(){Yke||Yrt();var t=null,e=bp.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var o=n.messageLengthSize/4,s=0;s<o;++s)n.fullMessageLength.push(0);return e=bp.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(o,s){s==="utf8"&&(o=bp.util.encodeUtf8(o));var a=o.length;n.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var c=n.fullMessageLength.length-1;c>=0;--c)n.fullMessageLength[c]+=a[1],a[1]=a[0]+(n.fullMessageLength[c]/4294967296>>>0),n.fullMessageLength[c]=n.fullMessageLength[c]>>>0,a[0]=a[1]/4294967296>>>0;return e.putBytes(o),Wke(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var o=bp.util.createBuffer();o.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,a=s&n.blockLength-1;o.putBytes(lee.substr(0,n.blockLength-a));for(var c,u,l=n.fullMessageLength[0]*8,d=0;d<n.fullMessageLength.length-1;++d)c=n.fullMessageLength[d+1]*8,u=c/4294967296>>>0,l+=u,o.putInt32(l>>>0),l=c>>>0;o.putInt32(l);var p={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};Wke(p,r,o);var f=bp.util.createBuffer();return f.putInt32(p.h0),f.putInt32(p.h1),f.putInt32(p.h2),f.putInt32(p.h3),f.putInt32(p.h4),f.putInt32(p.h5),f.putInt32(p.h6),f.putInt32(p.h7),f},n};var lee=null,Yke=!1,Qke=null;function Yrt(){lee="\x80",lee+=bp.util.fillString("\0",64),Qke=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Yke=!0}function Wke(t,e,r){for(var n,o,s,a,c,u,l,d,p,f,m,h,g,v,y,_=r.length();_>=64;){for(l=0;l<16;++l)e[l]=r.getInt32();for(;l<64;++l)n=e[l-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,o=e[l-15],o=(o>>>7|o<<25)^(o>>>18|o<<14)^o>>>3,e[l]=n+e[l-7]+o+e[l-16]|0;for(d=t.h0,p=t.h1,f=t.h2,m=t.h3,h=t.h4,g=t.h5,v=t.h6,y=t.h7,l=0;l<64;++l)a=(h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7),c=v^h&(g^v),s=(d>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10),u=d&p|f&(d^p),n=y+a+c+Qke[l]+e[l],o=s+u,y=v,v=g,g=h,h=m+n>>>0,m=f,f=p,p=d,d=n+o>>>0;t.h0=t.h0+d|0,t.h1=t.h1+p|0,t.h2=t.h2+f|0,t.h3=t.h3+m|0,t.h4=t.h4+h|0,t.h5=t.h5+g|0,t.h6=t.h6+v|0,t.h7=t.h7+y|0,_-=64}}});var pee=L(($3r,Jke)=>{var _p=tr();Or();var A9=null;_p.util.isNodejs&&!_p.options.usePureJavaScript&&!process.versions["node-webkit"]&&(A9=require("crypto"));var Qrt=Jke.exports=_p.prng=_p.prng||{};Qrt.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),o=0;o<32;++o)n[o]=r.create();e.pools=n,e.pool=0,e.generate=function(l,d){if(!d)return e.generateSync(l);var p=e.plugin.cipher,f=e.plugin.increment,m=e.plugin.formatKey,h=e.plugin.formatSeed,g=_p.util.createBuffer();e.key=null,v();function v(y){if(y)return d(y);if(g.length()>=l)return d(null,g.getBytes(l));if(e.generated>1048575&&(e.key=null),e.key===null)return _p.util.nextTick(function(){s(v)});var _=p(e.key,e.seed);e.generated+=_.length,g.putBytes(_),e.key=m(p(e.key,f(e.seed))),e.seed=h(p(e.key,e.seed)),_p.util.setImmediate(v)}},e.generateSync=function(l){var d=e.plugin.cipher,p=e.plugin.increment,f=e.plugin.formatKey,m=e.plugin.formatSeed;e.key=null;for(var h=_p.util.createBuffer();h.length()<l;){e.generated>1048575&&(e.key=null),e.key===null&&a();var g=d(e.key,e.seed);e.generated+=g.length,h.putBytes(g),e.key=f(d(e.key,p(e.seed))),e.seed=m(d(e.key,e.seed))}return h.getBytes(l)};function s(l){if(e.pools[0].messageLength>=32)return c(),l();var d=32-e.pools[0].messageLength<<5;e.seedFile(d,function(p,f){if(p)return l(p);e.collect(f),c(),l()})}function a(){if(e.pools[0].messageLength>=32)return c();var l=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(l)),c()}function c(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var l=e.plugin.md.create();l.update(e.keyBytes);for(var d=1,p=0;p<32;++p)e.reseeds%d===0&&(l.update(e.pools[p].digest().getBytes()),e.pools[p].start()),d=d<<1;e.keyBytes=l.digest().getBytes(),l.start(),l.update(e.keyBytes);var f=l.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(f),e.generated=0}function u(l){var d=null,p=_p.util.globalScope,f=p.crypto||p.msCrypto;f&&f.getRandomValues&&(d=function(I){return f.getRandomValues(I)});var m=_p.util.createBuffer();if(d)for(;m.length()<l;){var h=Math.max(1,Math.min(l-m.length(),65536)/4),g=new Uint32Array(Math.floor(h));try{d(g);for(var v=0;v<g.length;++v)m.putInt32(g[v])}catch(I){if(!(typeof QuotaExceededError<"u"&&I instanceof QuotaExceededError))throw I}}if(m.length()<l)for(var y,_,b,S=Math.floor(Math.random()*65536);m.length()<l;){_=16807*(S&65535),y=16807*(S>>16),_+=(y&32767)<<16,_+=y>>15,_=(_&2147483647)+(_>>31),S=_&4294967295;for(var v=0;v<3;++v)b=S>>>(v<<3),b^=Math.floor(Math.random()*256),m.putByte(b&255)}return m.getBytes(l)}return A9?(e.seedFile=function(l,d){A9.randomBytes(l,function(p,f){if(p)return d(p);d(null,f.toString())})},e.seedFileSync=function(l){return A9.randomBytes(l).toString()}):(e.seedFile=function(l,d){try{d(null,u(l))}catch(p){d(p)}},e.seedFileSync=u),e.collect=function(l){for(var d=l.length,p=0;p<d;++p)e.pools[e.pool].update(l.substr(p,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(l,d){for(var p="",f=0;f<d;f+=8)p+=String.fromCharCode(l>>f&255);e.collect(p)},e.registerWorker=function(l){if(l===self)e.seedFile=function(p,f){function m(h){var g=h.data;g.forge&&g.forge.prng&&(self.removeEventListener("message",m),f(g.forge.prng.err,g.forge.prng.bytes))}self.addEventListener("message",m),self.postMessage({forge:{prng:{needed:p}}})};else{var d=function(p){var f=p.data;f.forge&&f.forge.prng&&e.seedFile(f.forge.prng.needed,function(m,h){l.postMessage({forge:{prng:{err:m,bytes:h}}})})};l.addEventListener("message",d)}},e}});var Mu=L((W3r,fee)=>{var es=tr();$v();dee();pee();Or();(function(){if(es.random&&es.random.getBytes){fee.exports=es.random;return}(function(t){var e={},r=new Array(4),n=es.util.createBuffer();e.formatKey=function(p){var f=es.util.createBuffer(p);return p=new Array(4),p[0]=f.getInt32(),p[1]=f.getInt32(),p[2]=f.getInt32(),p[3]=f.getInt32(),es.aes._expandKey(p,!1)},e.formatSeed=function(p){var f=es.util.createBuffer(p);return p=new Array(4),p[0]=f.getInt32(),p[1]=f.getInt32(),p[2]=f.getInt32(),p[3]=f.getInt32(),p},e.cipher=function(p,f){return es.aes._updateBlock(p,f,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(p){return++p[3],p},e.md=es.md.sha256;function o(){var p=es.prng.create(e);return p.getBytes=function(f,m){return p.generate(f,m)},p.getBytesSync=function(f){return p.generate(f)},p}var s=o(),a=null,c=es.util.globalScope,u=c.crypto||c.msCrypto;if(u&&u.getRandomValues&&(a=function(p){return u.getRandomValues(p)}),es.options.usePureJavaScript||!es.util.isNodejs&&!a){if(typeof window>"u"||window.document,s.collectInt(+new Date,32),typeof navigator<"u"){var l="";for(var d in navigator)try{typeof navigator[d]=="string"&&(l+=navigator[d])}catch{}s.collect(l),l=null}t&&(t().mousemove(function(p){s.collectInt(p.clientX,16),s.collectInt(p.clientY,16)}),t().keypress(function(p){s.collectInt(p.charCode,8)}))}if(!es.random)es.random=s;else for(var d in s)es.random[d]=s[d];es.random.createInstance=o,fee.exports=es.random})(typeof jQuery<"u"?jQuery:null)})()});var hee=L((K3r,t2e)=>{var oc=tr();Or();var mee=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],Zke=[1,2,3,5],Xrt=function(t,e){return t<<e&65535|(t&65535)>>16-e},Jrt=function(t,e){return(t&65535)>>e|t<<16-e&65535};t2e.exports=oc.rc2=oc.rc2||{};oc.rc2.expandKey=function(t,e){typeof t=="string"&&(t=oc.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),o=e,s=Math.ceil(o/8),a=255>>(o&7),c;for(c=n;c<128;c++)r.putByte(mee[r.at(c-1)+r.at(c-n)&255]);for(r.setAt(128-s,mee[r.at(128-s)&a]),c=127-s;c>=0;c--)r.setAt(c,mee[r.at(c+1)^r.at(c+s)]);return r};var e2e=function(t,e,r){var n=!1,o=null,s=null,a=null,c,u,l,d,p=[];for(t=oc.rc2.expandKey(t,e),l=0;l<64;l++)p.push(t.getInt16Le());r?(c=function(h){for(l=0;l<4;l++)h[l]+=p[d]+(h[(l+3)%4]&h[(l+2)%4])+(~h[(l+3)%4]&h[(l+1)%4]),h[l]=Xrt(h[l],Zke[l]),d++},u=function(h){for(l=0;l<4;l++)h[l]+=p[h[(l+3)%4]&63]}):(c=function(h){for(l=3;l>=0;l--)h[l]=Jrt(h[l],Zke[l]),h[l]-=p[d]+(h[(l+3)%4]&h[(l+2)%4])+(~h[(l+3)%4]&h[(l+1)%4]),d--},u=function(h){for(l=3;l>=0;l--)h[l]-=p[h[(l+3)%4]&63]});var f=function(h){var g=[];for(l=0;l<4;l++){var v=o.getInt16Le();a!==null&&(r?v^=a.getInt16Le():a.putInt16Le(v)),g.push(v&65535)}d=r?0:63;for(var y=0;y<h.length;y++)for(var _=0;_<h[y][0];_++)h[y][1](g);for(l=0;l<4;l++)a!==null&&(r?a.putInt16Le(g[l]):g[l]^=a.getInt16Le()),s.putInt16Le(g[l])},m=null;return m={start:function(h,g){h&&typeof h=="string"&&(h=oc.util.createBuffer(h)),n=!1,o=oc.util.createBuffer(),s=g||new oc.util.createBuffer,a=h,m.output=s},update:function(h){for(n||o.putBuffer(h);o.length()>=8;)f([[5,c],[1,u],[6,c],[1,u],[5,c]])},finish:function(h){var g=!0;if(r)if(h)g=h(8,o,!r);else{var v=o.length()===8?8:8-o.length();o.fillWithByte(v,v)}if(g&&(n=!0,m.update()),!r&&(g=o.length()===0,g))if(h)g=h(8,s,!r);else{var y=s.length(),_=s.at(y-1);_>y?g=!1:s.truncate(_)}return g}},m};oc.rc2.startEncrypting=function(t,e,r){var n=oc.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};oc.rc2.createEncryptionCipher=function(t,e){return e2e(t,e,!0)};oc.rc2.startDecrypting=function(t,e,r){var n=oc.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};oc.rc2.createDecryptionCipher=function(t,e){return e2e(t,e,!1)}});var xA=L((Y3r,u2e)=>{var gee=tr();u2e.exports=gee.jsbn=gee.jsbn||{};var ym,Zrt=0xdeadbeefcafe,r2e=(Zrt&16777215)==15715070;function xe(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}gee.jsbn.BigInteger=xe;function Mr(){return new xe(null)}function ent(t,e,r,n,o,s){for(;--s>=0;){var a=e*this.data[t++]+r.data[n]+o;o=Math.floor(a/67108864),r.data[n++]=a&67108863}return o}function tnt(t,e,r,n,o,s){for(var a=e&32767,c=e>>15;--s>=0;){var u=this.data[t]&32767,l=this.data[t++]>>15,d=c*u+l*a;u=a*u+((d&32767)<<15)+r.data[n]+(o&1073741823),o=(u>>>30)+(d>>>15)+c*l+(o>>>30),r.data[n++]=u&1073741823}return o}function n2e(t,e,r,n,o,s){for(var a=e&16383,c=e>>14;--s>=0;){var u=this.data[t]&16383,l=this.data[t++]>>14,d=c*u+l*a;u=a*u+((d&16383)<<14)+r.data[n]+o,o=(u>>28)+(d>>14)+c*l,r.data[n++]=u&268435455}return o}typeof navigator>"u"?(xe.prototype.am=n2e,ym=28):r2e&&navigator.appName=="Microsoft Internet Explorer"?(xe.prototype.am=tnt,ym=30):r2e&&navigator.appName!="Netscape"?(xe.prototype.am=ent,ym=26):(xe.prototype.am=n2e,ym=28);xe.prototype.DB=ym;xe.prototype.DM=(1<<ym)-1;xe.prototype.DV=1<<ym;var vee=52;xe.prototype.FV=Math.pow(2,vee);xe.prototype.F1=vee-ym;xe.prototype.F2=2*ym-vee;var rnt="0123456789abcdefghijklmnopqrstuvwxyz",P9=new Array,PT,Fu;PT=48;for(Fu=0;Fu<=9;++Fu)P9[PT++]=Fu;PT=97;for(Fu=10;Fu<36;++Fu)P9[PT++]=Fu;PT=65;for(Fu=10;Fu<36;++Fu)P9[PT++]=Fu;function i2e(t){return rnt.charAt(t)}function o2e(t,e){var r=P9[t.charCodeAt(e)];return r??-1}function nnt(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function int(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function Kv(t){var e=Mr();return e.fromInt(t),e}function ont(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,o=!1,s=0;--n>=0;){var a=r==8?t[n]&255:o2e(t,n);if(a<0){t.charAt(n)=="-"&&(o=!0);continue}o=!1,s==0?this.data[this.t++]=a:s+r>this.DB?(this.data[this.t-1]|=(a&(1<<this.DB-s)-1)<<s,this.data[this.t++]=a>>this.DB-s):this.data[this.t-1]|=a<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&t[0]&128&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),o&&xe.ZERO.subTo(this,this)}function snt(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function ant(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,o=!1,s="",a=this.t,c=this.DB-a*this.DB%e;if(a-- >0)for(c<this.DB&&(n=this.data[a]>>c)>0&&(o=!0,s=i2e(n));a>=0;)c<e?(n=(this.data[a]&(1<<c)-1)<<e-c,n|=this.data[--a]>>(c+=this.DB-e)):(n=this.data[a]>>(c-=e)&r,c<=0&&(c+=this.DB,--a)),n>0&&(o=!0),o&&(s+=i2e(n));return o?s:"0"}function cnt(){var t=Mr();return xe.ZERO.subTo(this,t),t}function unt(){return this.s<0?this.negate():this}function lnt(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function D9(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function dnt(){return this.t<=0?0:this.DB*(this.t-1)+D9(this.data[this.t-1]^this.s&this.DM)}function pnt(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function fnt(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function mnt(t,e){var r=t%this.DB,n=this.DB-r,o=(1<<n)-1,s=Math.floor(t/this.DB),a=this.s<<r&this.DM,c;for(c=this.t-1;c>=0;--c)e.data[c+s+1]=this.data[c]>>n|a,a=(this.data[c]&o)<<r;for(c=s-1;c>=0;--c)e.data[c]=0;e.data[s]=a,e.t=this.t+s+1,e.s=this.s,e.clamp()}function hnt(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,o=this.DB-n,s=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var a=r+1;a<this.t;++a)e.data[a-r-1]|=(this.data[a]&s)<<o,e.data[a-r]=this.data[a]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&s)<<o),e.t=this.t-r,e.clamp()}function gnt(t,e){for(var r=0,n=0,o=Math.min(t.t,this.t);r<o;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function vnt(t,e){var r=this.abs(),n=t.abs(),o=r.t;for(e.t=o+n.t;--o>=0;)e.data[o]=0;for(o=0;o<n.t;++o)e.data[o+r.t]=r.am(0,n.data[o],e,o,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&xe.ZERO.subTo(e,e)}function ynt(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function bnt(t,e,r){var n=t.abs();if(!(n.t<=0)){var o=this.abs();if(o.t<n.t){e?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=Mr());var s=Mr(),a=this.s,c=t.s,u=this.DB-D9(n.data[n.t-1]);u>0?(n.lShiftTo(u,s),o.lShiftTo(u,r)):(n.copyTo(s),o.copyTo(r));var l=s.t,d=s.data[l-1];if(d!=0){var p=d*(1<<this.F1)+(l>1?s.data[l-2]>>this.F2:0),f=this.FV/p,m=(1<<this.F1)/p,h=1<<this.F2,g=r.t,v=g-l,y=e??Mr();for(s.dlShiftTo(v,y),r.compareTo(y)>=0&&(r.data[r.t++]=1,r.subTo(y,r)),xe.ONE.dlShiftTo(l,y),y.subTo(s,s);s.t<l;)s.data[s.t++]=0;for(;--v>=0;){var _=r.data[--g]==d?this.DM:Math.floor(r.data[g]*f+(r.data[g-1]+h)*m);if((r.data[g]+=s.am(0,_,r,v,0,l))<_)for(s.dlShiftTo(v,y),r.subTo(y,r);r.data[g]<--_;)r.subTo(y,r)}e!=null&&(r.drShiftTo(l,e),a!=c&&xe.ZERO.subTo(e,e)),r.t=l,r.clamp(),u>0&&r.rShiftTo(u,r),a<0&&xe.ZERO.subTo(r,r)}}}function _nt(t){var e=Mr();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(xe.ZERO)>0&&t.subTo(e,e),e}function Jb(t){this.m=t}function xnt(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function Snt(t){return t}function Int(t){t.divRemTo(this.m,null,t)}function Cnt(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function Tnt(t,e){t.squareTo(e),this.reduce(e)}Jb.prototype.convert=xnt;Jb.prototype.revert=Snt;Jb.prototype.reduce=Int;Jb.prototype.mulTo=Cnt;Jb.prototype.sqrTo=Tnt;function Ent(){if(this.t<1)return 0;var t=this.data[0];if(!(t&1))return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function Zb(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function wnt(t){var e=Mr();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(xe.ZERO)>0&&this.m.subTo(e,e),e}function Rnt(t){var e=Mr();return t.copyTo(e),this.reduce(e),e}function knt(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function Ant(t,e){t.squareTo(e),this.reduce(e)}function Pnt(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Zb.prototype.convert=wnt;Zb.prototype.revert=Rnt;Zb.prototype.reduce=knt;Zb.prototype.mulTo=Pnt;Zb.prototype.sqrTo=Ant;function Dnt(){return(this.t>0?this.data[0]&1:this.s)==0}function Nnt(t,e){if(t>4294967295||t<1)return xe.ONE;var r=Mr(),n=Mr(),o=e.convert(this),s=D9(t)-1;for(o.copyTo(r);--s>=0;)if(e.sqrTo(r,n),(t&1<<s)>0)e.mulTo(n,o,r);else{var a=r;r=n,n=a}return e.revert(r)}function Lnt(t,e){var r;return t<256||e.isEven()?r=new Jb(e):r=new Zb(e),this.exp(t,r)}xe.prototype.copyTo=nnt;xe.prototype.fromInt=int;xe.prototype.fromString=ont;xe.prototype.clamp=snt;xe.prototype.dlShiftTo=pnt;xe.prototype.drShiftTo=fnt;xe.prototype.lShiftTo=mnt;xe.prototype.rShiftTo=hnt;xe.prototype.subTo=gnt;xe.prototype.multiplyTo=vnt;xe.prototype.squareTo=ynt;xe.prototype.divRemTo=bnt;xe.prototype.invDigit=Ent;xe.prototype.isEven=Dnt;xe.prototype.exp=Nnt;xe.prototype.toString=ant;xe.prototype.negate=cnt;xe.prototype.abs=unt;xe.prototype.compareTo=lnt;xe.prototype.bitLength=dnt;xe.prototype.mod=_nt;xe.prototype.modPowInt=Lnt;xe.ZERO=Kv(0);xe.ONE=Kv(1);function Ont(){var t=Mr();return this.copyTo(t),t}function Mnt(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function Fnt(){return this.t==0?this.s:this.data[0]<<24>>24}function Unt(){return this.t==0?this.s:this.data[0]<<16>>16}function Bnt(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function qnt(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function Hnt(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=Kv(r),o=Mr(),s=Mr(),a="";for(this.divRemTo(n,o,s);o.signum()>0;)a=(r+s.intValue()).toString(t).substr(1)+a,o.divRemTo(n,o,s);return s.intValue().toString(t)+a}function jnt(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),o=!1,s=0,a=0,c=0;c<t.length;++c){var u=o2e(t,c);if(u<0){t.charAt(c)=="-"&&this.signum()==0&&(o=!0);continue}a=e*a+u,++s>=r&&(this.dMultiply(n),this.dAddOffset(a,0),s=0,a=0)}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(a,0)),o&&xe.ZERO.subTo(this,this)}function znt(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(xe.ONE.shiftLeft(t-1),yee,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(xe.ONE.shiftLeft(t-1),this);else{var n=new Array,o=t&7;n.length=(t>>3)+1,e.nextBytes(n),o>0?n[0]&=(1<<o)-1:n[0]=0,this.fromString(n,256)}}function Gnt(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,o=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[o++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),n&128&&(n|=-256),o==0&&(this.s&128)!=(n&128)&&++o,(o>0||n!=this.s)&&(e[o++]=n);return e}function Vnt(t){return this.compareTo(t)==0}function $nt(t){return this.compareTo(t)<0?this:t}function Wnt(t){return this.compareTo(t)>0?this:t}function Knt(t,e,r){var n,o,s=Math.min(t.t,this.t);for(n=0;n<s;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(o=t.s&this.DM,n=s;n<this.t;++n)r.data[n]=e(this.data[n],o);r.t=this.t}else{for(o=this.s&this.DM,n=s;n<t.t;++n)r.data[n]=e(o,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function Ynt(t,e){return t&e}function Qnt(t){var e=Mr();return this.bitwiseTo(t,Ynt,e),e}function yee(t,e){return t|e}function Xnt(t){var e=Mr();return this.bitwiseTo(t,yee,e),e}function s2e(t,e){return t^e}function Jnt(t){var e=Mr();return this.bitwiseTo(t,s2e,e),e}function a2e(t,e){return t&~e}function Znt(t){var e=Mr();return this.bitwiseTo(t,a2e,e),e}function eit(){for(var t=Mr(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function tit(t){var e=Mr();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function rit(t){var e=Mr();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function nit(t){if(t==0)return-1;var e=0;return t&65535||(t>>=16,e+=16),t&255||(t>>=8,e+=8),t&15||(t>>=4,e+=4),t&3||(t>>=2,e+=2),t&1||++e,e}function iit(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+nit(this.data[t]);return this.s<0?this.t*this.DB:-1}function oit(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function sit(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=oit(this.data[r]^e);return t}function ait(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function cit(t,e){var r=xe.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function uit(t){return this.changeBit(t,yee)}function lit(t){return this.changeBit(t,a2e)}function dit(t){return this.changeBit(t,s2e)}function pit(t,e){for(var r=0,n=0,o=Math.min(t.t,this.t);r<o;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function fit(t){var e=Mr();return this.addTo(t,e),e}function mit(t){var e=Mr();return this.subTo(t,e),e}function hit(t){var e=Mr();return this.multiplyTo(t,e),e}function git(t){var e=Mr();return this.divRemTo(t,e,null),e}function vit(t){var e=Mr();return this.divRemTo(t,null,e),e}function yit(t){var e=Mr(),r=Mr();return this.divRemTo(t,e,r),new Array(e,r)}function bit(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function _it(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function _A(){}function c2e(t){return t}function xit(t,e,r){t.multiplyTo(e,r)}function Sit(t,e){t.squareTo(e)}_A.prototype.convert=c2e;_A.prototype.revert=c2e;_A.prototype.mulTo=xit;_A.prototype.sqrTo=Sit;function Iit(t){return this.exp(t,new _A)}function Cit(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var o;for(o=r.t-this.t;n<o;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(o=Math.min(t.t,e);n<o;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function Tit(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function DT(t){this.r2=Mr(),this.q3=Mr(),xe.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function Eit(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=Mr();return t.copyTo(e),this.reduce(e),e}function wit(t){return t}function Rit(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function kit(t,e){t.squareTo(e),this.reduce(e)}function Ait(t,e,r){t.multiplyTo(e,r),this.reduce(r)}DT.prototype.convert=Eit;DT.prototype.revert=wit;DT.prototype.reduce=Rit;DT.prototype.mulTo=Ait;DT.prototype.sqrTo=kit;function Pit(t,e){var r=t.bitLength(),n,o=Kv(1),s;if(r<=0)return o;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?s=new Jb(e):e.isEven()?s=new DT(e):s=new Zb(e);var a=new Array,c=3,u=n-1,l=(1<<n)-1;if(a[1]=s.convert(this),n>1){var d=Mr();for(s.sqrTo(a[1],d);c<=l;)a[c]=Mr(),s.mulTo(d,a[c-2],a[c]),c+=2}var p=t.t-1,f,m=!0,h=Mr(),g;for(r=D9(t.data[p])-1;p>=0;){for(r>=u?f=t.data[p]>>r-u&l:(f=(t.data[p]&(1<<r+1)-1)<<u-r,p>0&&(f|=t.data[p-1]>>this.DB+r-u)),c=n;!(f&1);)f>>=1,--c;if((r-=c)<0&&(r+=this.DB,--p),m)a[f].copyTo(o),m=!1;else{for(;c>1;)s.sqrTo(o,h),s.sqrTo(h,o),c-=2;c>0?s.sqrTo(o,h):(g=o,o=h,h=g),s.mulTo(h,a[f],o)}for(;p>=0&&!(t.data[p]&1<<r);)s.sqrTo(o,h),g=o,o=h,h=g,--r<0&&(r=this.DB-1,--p)}return s.revert(o)}function Dit(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var o=e.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return e;for(o<s&&(s=o),s>0&&(e.rShiftTo(s,e),r.rShiftTo(s,r));e.signum()>0;)(o=e.getLowestSetBit())>0&&e.rShiftTo(o,e),(o=r.getLowestSetBit())>0&&r.rShiftTo(o,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function Nit(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function Lit(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return xe.ZERO;for(var r=t.clone(),n=this.clone(),o=Kv(1),s=Kv(0),a=Kv(0),c=Kv(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!o.isEven()||!s.isEven())&&(o.addTo(this,o),s.subTo(t,s)),o.rShiftTo(1,o)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),e?((!a.isEven()||!c.isEven())&&(a.addTo(this,a),c.subTo(t,c)),a.rShiftTo(1,a)):c.isEven()||c.subTo(t,c),c.rShiftTo(1,c);r.compareTo(n)>=0?(r.subTo(n,r),e&&o.subTo(a,o),s.subTo(c,s)):(n.subTo(r,n),e&&a.subTo(o,a),c.subTo(s,c))}if(n.compareTo(xe.ONE)!=0)return xe.ZERO;if(c.compareTo(t)>=0)return c.subtract(t);if(c.signum()<0)c.addTo(t,c);else return c;return c.signum()<0?c.add(t):c}var Ol=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Oit=(1<<26)/Ol[Ol.length-1];function Mit(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=Ol[Ol.length-1]){for(e=0;e<Ol.length;++e)if(r.data[0]==Ol[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<Ol.length;){for(var n=Ol[e],o=e+1;o<Ol.length&&n<Oit;)n*=Ol[o++];for(n=r.modInt(n);e<o;)if(n%Ol[e++]==0)return!1}return r.millerRabin(t)}function Fit(t){var e=this.subtract(xe.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),o=Uit(),s,a=0;a<t;++a){do s=new xe(this.bitLength(),o);while(s.compareTo(xe.ONE)<=0||s.compareTo(e)>=0);var c=s.modPow(n,this);if(c.compareTo(xe.ONE)!=0&&c.compareTo(e)!=0){for(var u=1;u++<r&&c.compareTo(e)!=0;)if(c=c.modPowInt(2,this),c.compareTo(xe.ONE)==0)return!1;if(c.compareTo(e)!=0)return!1}}return!0}function Uit(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}xe.prototype.chunkSize=Bnt;xe.prototype.toRadix=Hnt;xe.prototype.fromRadix=jnt;xe.prototype.fromNumber=znt;xe.prototype.bitwiseTo=Knt;xe.prototype.changeBit=cit;xe.prototype.addTo=pit;xe.prototype.dMultiply=bit;xe.prototype.dAddOffset=_it;xe.prototype.multiplyLowerTo=Cit;xe.prototype.multiplyUpperTo=Tit;xe.prototype.modInt=Nit;xe.prototype.millerRabin=Fit;xe.prototype.clone=Ont;xe.prototype.intValue=Mnt;xe.prototype.byteValue=Fnt;xe.prototype.shortValue=Unt;xe.prototype.signum=qnt;xe.prototype.toByteArray=Gnt;xe.prototype.equals=Vnt;xe.prototype.min=$nt;xe.prototype.max=Wnt;xe.prototype.and=Qnt;xe.prototype.or=Xnt;xe.prototype.xor=Jnt;xe.prototype.andNot=Znt;xe.prototype.not=eit;xe.prototype.shiftLeft=tit;xe.prototype.shiftRight=rit;xe.prototype.getLowestSetBit=iit;xe.prototype.bitCount=sit;xe.prototype.testBit=ait;xe.prototype.setBit=uit;xe.prototype.clearBit=lit;xe.prototype.flipBit=dit;xe.prototype.add=fit;xe.prototype.subtract=mit;xe.prototype.multiply=hit;xe.prototype.divide=git;xe.prototype.remainder=vit;xe.prototype.divideAndRemainder=yit;xe.prototype.modPow=Pit;xe.prototype.modInverse=Lit;xe.prototype.pow=Iit;xe.prototype.gcd=Dit;xe.prototype.isProbablePrime=Mit});var NT=L((Q3r,f2e)=>{var xp=tr();gp();Or();var d2e=f2e.exports=xp.sha1=xp.sha1||{};xp.md.sha1=xp.md.algorithms.sha1=d2e;d2e.create=function(){p2e||Bit();var t=null,e=xp.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var o=n.messageLengthSize/4,s=0;s<o;++s)n.fullMessageLength.push(0);return e=xp.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(o,s){s==="utf8"&&(o=xp.util.encodeUtf8(o));var a=o.length;n.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var c=n.fullMessageLength.length-1;c>=0;--c)n.fullMessageLength[c]+=a[1],a[1]=a[0]+(n.fullMessageLength[c]/4294967296>>>0),n.fullMessageLength[c]=n.fullMessageLength[c]>>>0,a[0]=a[1]/4294967296>>>0;return e.putBytes(o),l2e(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var o=xp.util.createBuffer();o.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,a=s&n.blockLength-1;o.putBytes(bee.substr(0,n.blockLength-a));for(var c,u,l=n.fullMessageLength[0]*8,d=0;d<n.fullMessageLength.length-1;++d)c=n.fullMessageLength[d+1]*8,u=c/4294967296>>>0,l+=u,o.putInt32(l>>>0),l=c>>>0;o.putInt32(l);var p={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};l2e(p,r,o);var f=xp.util.createBuffer();return f.putInt32(p.h0),f.putInt32(p.h1),f.putInt32(p.h2),f.putInt32(p.h3),f.putInt32(p.h4),f},n};var bee=null,p2e=!1;function Bit(){bee="\x80",bee+=xp.util.fillString("\0",64),p2e=!0}function l2e(t,e,r){for(var n,o,s,a,c,u,l,d,p=r.length();p>=64;){for(o=t.h0,s=t.h1,a=t.h2,c=t.h3,u=t.h4,d=0;d<16;++d)n=r.getInt32(),e[d]=n,l=c^s&(a^c),n=(o<<5|o>>>27)+l+u+1518500249+n,u=c,c=a,a=(s<<30|s>>>2)>>>0,s=o,o=n;for(;d<20;++d)n=e[d-3]^e[d-8]^e[d-14]^e[d-16],n=n<<1|n>>>31,e[d]=n,l=c^s&(a^c),n=(o<<5|o>>>27)+l+u+1518500249+n,u=c,c=a,a=(s<<30|s>>>2)>>>0,s=o,o=n;for(;d<32;++d)n=e[d-3]^e[d-8]^e[d-14]^e[d-16],n=n<<1|n>>>31,e[d]=n,l=s^a^c,n=(o<<5|o>>>27)+l+u+1859775393+n,u=c,c=a,a=(s<<30|s>>>2)>>>0,s=o,o=n;for(;d<40;++d)n=e[d-6]^e[d-16]^e[d-28]^e[d-32],n=n<<2|n>>>30,e[d]=n,l=s^a^c,n=(o<<5|o>>>27)+l+u+1859775393+n,u=c,c=a,a=(s<<30|s>>>2)>>>0,s=o,o=n;for(;d<60;++d)n=e[d-6]^e[d-16]^e[d-28]^e[d-32],n=n<<2|n>>>30,e[d]=n,l=s&a|c&(s^a),n=(o<<5|o>>>27)+l+u+2400959708+n,u=c,c=a,a=(s<<30|s>>>2)>>>0,s=o,o=n;for(;d<80;++d)n=e[d-6]^e[d-16]^e[d-28]^e[d-32],n=n<<2|n>>>30,e[d]=n,l=s^a^c,n=(o<<5|o>>>27)+l+u+3395469782+n,u=c,c=a,a=(s<<30|s>>>2)>>>0,s=o,o=n;t.h0=t.h0+o|0,t.h1=t.h1+s|0,t.h2=t.h2+a|0,t.h3=t.h3+c|0,t.h4=t.h4+u|0,p-=64}}});var _ee=L((X3r,h2e)=>{var Sp=tr();Or();Mu();NT();var m2e=h2e.exports=Sp.pkcs1=Sp.pkcs1||{};m2e.encode_rsa_oaep=function(t,e,r){var n,o,s,a;typeof r=="string"?(n=r,o=arguments[3]||void 0,s=arguments[4]||void 0):r&&(n=r.label||void 0,o=r.seed||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(a=r.mgf1.md)),s?s.start():s=Sp.md.sha1.create(),a||(a=s);var c=Math.ceil(t.n.bitLength()/8),u=c-2*s.digestLength-2;if(e.length>u){var l=new Error("RSAES-OAEP input message length is too long.");throw l.length=e.length,l.maxLength=u,l}n||(n=""),s.update(n,"raw");for(var d=s.digest(),p="",f=u-e.length,m=0;m<f;m++)p+="\0";var h=d.getBytes()+p+""+e;if(!o)o=Sp.random.getBytes(s.digestLength);else if(o.length!==s.digestLength){var l=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw l.seedLength=o.length,l.digestLength=s.digestLength,l}var g=N9(o,c-s.digestLength-1,a),v=Sp.util.xorBytes(h,g,h.length),y=N9(v,s.digestLength,a),_=Sp.util.xorBytes(o,y,o.length);return"\0"+_+v};m2e.decode_rsa_oaep=function(t,e,r){var n,o,s;typeof r=="string"?(n=r,o=arguments[3]||void 0):r&&(n=r.label||void 0,o=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md));var a=Math.ceil(t.n.bitLength()/8);if(e.length!==a){var v=new Error("RSAES-OAEP encoded message length is invalid.");throw v.length=e.length,v.expectedLength=a,v}if(o===void 0?o=Sp.md.sha1.create():o.start(),s||(s=o),a<2*o.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),o.update(n,"raw");for(var c=o.digest().getBytes(),u=e.charAt(0),l=e.substring(1,o.digestLength+1),d=e.substring(1+o.digestLength),p=N9(d,o.digestLength,s),f=Sp.util.xorBytes(l,p,l.length),m=N9(f,a-o.digestLength-1,s),h=Sp.util.xorBytes(d,m,d.length),g=h.substring(0,o.digestLength),v=u!=="\0",y=0;y<o.digestLength;++y)v|=c.charAt(y)!==g.charAt(y);for(var _=1,b=o.digestLength,S=o.digestLength;S<h.length;S++){var I=h.charCodeAt(S),w=I&1^1,O=_?65534:0;v|=I&O,_=_&w,b+=_}if(v||h.charCodeAt(b)!==1)throw new Error("Invalid RSAES-OAEP padding.");return h.substring(b+1)};function N9(t,e,r){r||(r=Sp.md.sha1.create());for(var n="",o=Math.ceil(e/r.digestLength),s=0;s<o;++s){var a=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);r.start(),r.update(t+a),n+=r.digest().getBytes()}return n.substring(0,e)}});var See=L((J3r,xee)=>{var Yv=tr();Or();xA();Mu();(function(){if(Yv.prime){xee.exports=Yv.prime;return}var t=xee.exports=Yv.prime=Yv.prime||{},e=Yv.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var o=function(p,f){return p|f};t.generateProbablePrime=function(p,f,m){typeof f=="function"&&(m=f,f={}),f=f||{};var h=f.algorithm||"PRIMEINC";typeof h=="string"&&(h={name:h}),h.options=h.options||{};var g=f.prng||Yv.random,v={nextBytes:function(y){for(var _=g.getBytesSync(y.length),b=0;b<y.length;++b)y[b]=_.charCodeAt(b)}};if(h.name==="PRIMEINC")return s(p,v,h.options,m);throw new Error("Invalid prime generation algorithm: "+h.name)};function s(p,f,m,h){return"workers"in m?u(p,f,m,h):a(p,f,m,h)}function a(p,f,m,h){var g=l(p,f),v=0,y=d(g.bitLength());"millerRabinTests"in m&&(y=m.millerRabinTests);var _=10;"maxBlockTime"in m&&(_=m.maxBlockTime),c(g,p,f,v,y,_,h)}function c(p,f,m,h,g,v,y){var _=+new Date;do{if(p.bitLength()>f&&(p=l(f,m)),p.isProbablePrime(g))return y(null,p);p.dAddOffset(r[h++%8],0)}while(v<0||+new Date-_<v);Yv.util.setImmediate(function(){c(p,f,m,h,g,v,y)})}function u(p,f,m,h){if(typeof Worker>"u")return a(p,f,m,h);var g=l(p,f),v=m.workers,y=m.workLoad||100,_=y*30/8,b=m.workerScript||"forge/prime.worker.js";if(v===-1)return Yv.util.estimateCores(function(I,w){I&&(w=2),v=w-1,S()});S();function S(){v=Math.max(1,v);for(var I=[],w=0;w<v;++w)I[w]=new Worker(b);for(var O=v,w=0;w<v;++w)I[w].addEventListener("message",z);var U=!1;function z(M){if(!U){--O;var re=M.data;if(re.found){for(var ee=0;ee<I.length;++ee)I[ee].terminate();return U=!0,h(null,new e(re.prime,16))}g.bitLength()>p&&(g=l(p,f));var N=g.toString(16);M.target.postMessage({hex:N,workLoad:y}),g.dAddOffset(_,0)}}}}function l(p,f){var m=new e(p,f),h=p-1;return m.testBit(h)||m.bitwiseTo(e.ONE.shiftLeft(h),o,m),m.dAddOffset(31-m.mod(n).byteValue(),0),m}function d(p){return p<=100?27:p<=150?18:p<=200?15:p<=250?12:p<=300?9:p<=350?8:p<=400?7:p<=500?6:p<=600?5:p<=800?4:p<=1250?3:2}})()});var SA=L((Z3r,S2e)=>{var yt=tr();Ll();xA();Wv();_ee();See();Mu();Or();typeof Rr>"u"&&(Rr=yt.jsbn.BigInteger);var Rr,Iee=yt.util.isNodejs?require("crypto"):null,ie=yt.asn1,Uu=yt.util;yt.pki=yt.pki||{};S2e.exports=yt.pki.rsa=yt.rsa=yt.rsa||{};var Gt=yt.pki,qit=[6,4,2,4,2,4,6,2],Hit={name:"PrivateKeyInfo",tagClass:ie.Class.UNIVERSAL,type:ie.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:ie.Class.UNIVERSAL,type:ie.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:ie.Class.UNIVERSAL,type:ie.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:ie.Class.UNIVERSAL,type:ie.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:ie.Class.UNIVERSAL,type:ie.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},jit={name:"RSAPrivateKey",tagClass:ie.Class.UNIVERSAL,type:ie.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:ie.Class.UNIVERSAL,type:ie.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:ie.Class.UNIVERSAL,type:ie.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:ie.Class.UNIVERSAL,type:ie.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:ie.Class.UNIVERSAL,type:ie.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:ie.Class.UNIVERSAL,type:ie.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:ie.Class.UNIVERSAL,type:ie.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:ie.Class.UNIVERSAL,type:ie.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:ie.Class.UNIVERSAL,type:ie.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:ie.Class.UNIVERSAL,type:ie.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},zit={name:"RSAPublicKey",tagClass:ie.Class.UNIVERSAL,type:ie.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:ie.Class.UNIVERSAL,type:ie.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:ie.Class.UNIVERSAL,type:ie.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},Git=yt.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:ie.Class.UNIVERSAL,type:ie.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:ie.Class.UNIVERSAL,type:ie.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:ie.Class.UNIVERSAL,type:ie.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:ie.Class.UNIVERSAL,type:ie.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:ie.Class.UNIVERSAL,type:ie.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},Vit={name:"DigestInfo",tagClass:ie.Class.UNIVERSAL,type:ie.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:ie.Class.UNIVERSAL,type:ie.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:ie.Class.UNIVERSAL,type:ie.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:ie.Class.UNIVERSAL,type:ie.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:ie.Class.UNIVERSAL,type:ie.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},$it=function(t){var e;if(t.algorithm in Gt.oids)e=Gt.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=ie.oidToDer(e).getBytes(),o=ie.create(ie.Class.UNIVERSAL,ie.Type.SEQUENCE,!0,[]),s=ie.create(ie.Class.UNIVERSAL,ie.Type.SEQUENCE,!0,[]);s.value.push(ie.create(ie.Class.UNIVERSAL,ie.Type.OID,!1,n)),s.value.push(ie.create(ie.Class.UNIVERSAL,ie.Type.NULL,!1,""));var a=ie.create(ie.Class.UNIVERSAL,ie.Type.OCTETSTRING,!1,t.digest().getBytes());return o.value.push(s),o.value.push(a),ie.toDer(o).getBytes()},_2e=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(Rr.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(Rr.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new Rr(yt.util.bytesToHex(yt.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(Rr.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var o=t.mod(e.p).modPow(e.dP,e.p),s=t.mod(e.q).modPow(e.dQ,e.q);o.compareTo(s)<0;)o=o.add(e.p);var a=o.subtract(s).multiply(e.qInv).mod(e.p).multiply(e.q).add(s);return a=a.multiply(n.modInverse(e.n)).mod(e.n),a};Gt.rsa.encrypt=function(t,e,r){var n=r,o,s=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,o=x2e(t,e,r)):(o=yt.util.createBuffer(),o.putBytes(t));for(var a=new Rr(o.toHex(),16),c=_2e(a,e,n),u=c.toString(16),l=yt.util.createBuffer(),d=s-Math.ceil(u.length/2);d>0;)l.putByte(0),--d;return l.putBytes(yt.util.hexToBytes(u)),l.getBytes()};Gt.rsa.decrypt=function(t,e,r,n){var o=Math.ceil(e.n.bitLength()/8);if(t.length!==o){var s=new Error("Encrypted message length is invalid.");throw s.length=t.length,s.expected=o,s}var a=new Rr(yt.util.createBuffer(t).toHex(),16);if(a.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var c=_2e(a,e,r),u=c.toString(16),l=yt.util.createBuffer(),d=o-Math.ceil(u.length/2);d>0;)l.putByte(0),--d;return l.putBytes(yt.util.hexToBytes(u)),n!==!1?L9(l.getBytes(),e,r):l.getBytes()};Gt.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||yt.random,o={nextBytes:function(c){for(var u=n.getBytesSync(c.length),l=0;l<c.length;++l)c[l]=u.charCodeAt(l)}},s=r.algorithm||"PRIMEINC",a;if(s==="PRIMEINC")a={algorithm:s,state:0,bits:t,rng:o,eInt:e||65537,e:new Rr(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},a.e.fromInt(a.eInt);else throw new Error("Invalid key generation algorithm: "+s);return a};Gt.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new Rr(null);r.fromInt(30);for(var n=0,o=function(p,f){return p|f},s=+new Date,a,c=0;t.keys===null&&(e<=0||c<e);){if(t.state===0){var u=t.p===null?t.pBits:t.qBits,l=u-1;t.pqState===0?(t.num=new Rr(u,t.rng),t.num.testBit(l)||t.num.bitwiseTo(Rr.ONE.shiftLeft(l),o,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>u?t.pqState=0:t.num.isProbablePrime(Kit(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(qit[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(Rr.ONE).gcd(t.e).compareTo(Rr.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(Rr.ONE),t.q1=t.q.subtract(Rr.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(Rr.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var d=t.e.modInverse(t.phi);t.keys={privateKey:Gt.rsa.setPrivateKey(t.n,t.e,d,t.p,t.q,d.mod(t.p1),d.mod(t.q1),t.q.modInverse(t.p)),publicKey:Gt.rsa.setPublicKey(t.n,t.e)}}a=+new Date,c+=a-s,s=a}return t.keys!==null};Gt.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!yt.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(g2e("generateKeyPair"))return Iee.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(c,u,l){if(c)return n(c);n(null,{privateKey:Gt.privateKeyFromPem(l),publicKey:Gt.publicKeyFromPem(u)})});if(v2e("generateKey")&&v2e("exportKey"))return Uu.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:b2e(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(c){return Uu.globalScope.crypto.subtle.exportKey("pkcs8",c.privateKey)}).then(void 0,function(c){n(c)}).then(function(c){if(c){var u=Gt.privateKeyFromAsn1(ie.fromDer(yt.util.createBuffer(c)));n(null,{privateKey:u,publicKey:Gt.setRsaPublicKey(u.n,u.e)})}});if(y2e("generateKey")&&y2e("exportKey")){var o=Uu.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:b2e(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);o.oncomplete=function(c){var u=c.target.result,l=Uu.globalScope.msCrypto.subtle.exportKey("pkcs8",u.privateKey);l.oncomplete=function(d){var p=d.target.result,f=Gt.privateKeyFromAsn1(ie.fromDer(yt.util.createBuffer(p)));n(null,{privateKey:f,publicKey:Gt.setRsaPublicKey(f.n,f.e)})},l.onerror=function(d){n(d)}},o.onerror=function(c){n(c)};return}}else if(g2e("generateKeyPairSync")){var s=Iee.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:Gt.privateKeyFromPem(s.privateKey),publicKey:Gt.publicKeyFromPem(s.publicKey)}}}var a=Gt.rsa.createKeyPairGenerationState(t,e,r);if(!n)return Gt.rsa.stepKeyPairGenerationState(a,0),a.keys;Wit(a,r,n)};Gt.setRsaPublicKey=Gt.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,o,s){if(typeof o=="string"?o=o.toUpperCase():o===void 0&&(o="RSAES-PKCS1-V1_5"),o==="RSAES-PKCS1-V1_5")o={encode:function(c,u,l){return x2e(c,u,2).getBytes()}};else if(o==="RSA-OAEP"||o==="RSAES-OAEP")o={encode:function(c,u){return yt.pkcs1.encode_rsa_oaep(u,c,s)}};else if(["RAW","NONE","NULL",null].indexOf(o)!==-1)o={encode:function(c){return c}};else if(typeof o=="string")throw new Error('Unsupported encryption scheme: "'+o+'".');var a=o.encode(n,r,!0);return Gt.rsa.encrypt(a,r,!0)},r.verify=function(n,o,s,a){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),a===void 0&&(a={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in a||(a._parseAllDigestBytes=!0),s==="RSASSA-PKCS1-V1_5"?s={verify:function(u,l){l=L9(l,r,!0);var d=ie.fromDer(l,{parseAllBytes:a._parseAllDigestBytes}),p={},f=[];if(!ie.validate(d,Vit,p,f)){var m=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw m.errors=f,m}var h=ie.derToOid(p.algorithmIdentifier);if(!(h===yt.oids.md2||h===yt.oids.md5||h===yt.oids.sha1||h===yt.oids.sha224||h===yt.oids.sha256||h===yt.oids.sha384||h===yt.oids.sha512||h===yt.oids["sha512-224"]||h===yt.oids["sha512-256"])){var m=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw m.oid=h,m}if((h===yt.oids.md2||h===yt.oids.md5)&&!("parameters"in p))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return u===p.digest}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(u,l){return l=L9(l,r,!0),u===l}});var c=Gt.rsa.decrypt(o,r,!0,!1);return s.verify(n,c,r.n.bitLength())},r};Gt.setRsaPrivateKey=Gt.rsa.setPrivateKey=function(t,e,r,n,o,s,a,c){var u={n:t,e,d:r,p:n,q:o,dP:s,dQ:a,qInv:c};return u.decrypt=function(l,d,p){typeof d=="string"?d=d.toUpperCase():d===void 0&&(d="RSAES-PKCS1-V1_5");var f=Gt.rsa.decrypt(l,u,!1,!1);if(d==="RSAES-PKCS1-V1_5")d={decode:L9};else if(d==="RSA-OAEP"||d==="RSAES-OAEP")d={decode:function(m,h){return yt.pkcs1.decode_rsa_oaep(h,m,p)}};else if(["RAW","NONE","NULL",null].indexOf(d)!==-1)d={decode:function(m){return m}};else throw new Error('Unsupported encryption scheme: "'+d+'".');return d.decode(f,u,!1)},u.sign=function(l,d){var p=!1;typeof d=="string"&&(d=d.toUpperCase()),d===void 0||d==="RSASSA-PKCS1-V1_5"?(d={encode:$it},p=1):(d==="NONE"||d==="NULL"||d===null)&&(d={encode:function(){return l}},p=1);var f=d.encode(l,u.n.bitLength());return Gt.rsa.encrypt(f,u,p)},u};Gt.wrapRsaPrivateKey=function(t){return ie.create(ie.Class.UNIVERSAL,ie.Type.SEQUENCE,!0,[ie.create(ie.Class.UNIVERSAL,ie.Type.INTEGER,!1,ie.integerToDer(0).getBytes()),ie.create(ie.Class.UNIVERSAL,ie.Type.SEQUENCE,!0,[ie.create(ie.Class.UNIVERSAL,ie.Type.OID,!1,ie.oidToDer(Gt.oids.rsaEncryption).getBytes()),ie.create(ie.Class.UNIVERSAL,ie.Type.NULL,!1,"")]),ie.create(ie.Class.UNIVERSAL,ie.Type.OCTETSTRING,!1,ie.toDer(t).getBytes())])};Gt.privateKeyFromAsn1=function(t){var e={},r=[];if(ie.validate(t,Hit,e,r)&&(t=ie.fromDer(yt.util.createBuffer(e.privateKey))),e={},r=[],!ie.validate(t,jit,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var o,s,a,c,u,l,d,p;return o=yt.util.createBuffer(e.privateKeyModulus).toHex(),s=yt.util.createBuffer(e.privateKeyPublicExponent).toHex(),a=yt.util.createBuffer(e.privateKeyPrivateExponent).toHex(),c=yt.util.createBuffer(e.privateKeyPrime1).toHex(),u=yt.util.createBuffer(e.privateKeyPrime2).toHex(),l=yt.util.createBuffer(e.privateKeyExponent1).toHex(),d=yt.util.createBuffer(e.privateKeyExponent2).toHex(),p=yt.util.createBuffer(e.privateKeyCoefficient).toHex(),Gt.setRsaPrivateKey(new Rr(o,16),new Rr(s,16),new Rr(a,16),new Rr(c,16),new Rr(u,16),new Rr(l,16),new Rr(d,16),new Rr(p,16))};Gt.privateKeyToAsn1=Gt.privateKeyToRSAPrivateKey=function(t){return ie.create(ie.Class.UNIVERSAL,ie.Type.SEQUENCE,!0,[ie.create(ie.Class.UNIVERSAL,ie.Type.INTEGER,!1,ie.integerToDer(0).getBytes()),ie.create(ie.Class.UNIVERSAL,ie.Type.INTEGER,!1,Ip(t.n)),ie.create(ie.Class.UNIVERSAL,ie.Type.INTEGER,!1,Ip(t.e)),ie.create(ie.Class.UNIVERSAL,ie.Type.INTEGER,!1,Ip(t.d)),ie.create(ie.Class.UNIVERSAL,ie.Type.INTEGER,!1,Ip(t.p)),ie.create(ie.Class.UNIVERSAL,ie.Type.INTEGER,!1,Ip(t.q)),ie.create(ie.Class.UNIVERSAL,ie.Type.INTEGER,!1,Ip(t.dP)),ie.create(ie.Class.UNIVERSAL,ie.Type.INTEGER,!1,Ip(t.dQ)),ie.create(ie.Class.UNIVERSAL,ie.Type.INTEGER,!1,Ip(t.qInv))])};Gt.publicKeyFromAsn1=function(t){var e={},r=[];if(ie.validate(t,Git,e,r)){var n=ie.derToOid(e.publicKeyOid);if(n!==Gt.oids.rsaEncryption){var o=new Error("Cannot read public key. Unknown OID.");throw o.oid=n,o}t=e.rsaPublicKey}if(r=[],!ie.validate(t,zit,e,r)){var o=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw o.errors=r,o}var s=yt.util.createBuffer(e.publicKeyModulus).toHex(),a=yt.util.createBuffer(e.publicKeyExponent).toHex();return Gt.setRsaPublicKey(new Rr(s,16),new Rr(a,16))};Gt.publicKeyToAsn1=Gt.publicKeyToSubjectPublicKeyInfo=function(t){return ie.create(ie.Class.UNIVERSAL,ie.Type.SEQUENCE,!0,[ie.create(ie.Class.UNIVERSAL,ie.Type.SEQUENCE,!0,[ie.create(ie.Class.UNIVERSAL,ie.Type.OID,!1,ie.oidToDer(Gt.oids.rsaEncryption).getBytes()),ie.create(ie.Class.UNIVERSAL,ie.Type.NULL,!1,"")]),ie.create(ie.Class.UNIVERSAL,ie.Type.BITSTRING,!1,[Gt.publicKeyToRSAPublicKey(t)])])};Gt.publicKeyToRSAPublicKey=function(t){return ie.create(ie.Class.UNIVERSAL,ie.Type.SEQUENCE,!0,[ie.create(ie.Class.UNIVERSAL,ie.Type.INTEGER,!1,Ip(t.n)),ie.create(ie.Class.UNIVERSAL,ie.Type.INTEGER,!1,Ip(t.e))])};function x2e(t,e,r){var n=yt.util.createBuffer(),o=Math.ceil(e.n.bitLength()/8);if(t.length>o-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=t.length,s.max=o-11,s}n.putByte(0),n.putByte(r);var a=o-3-t.length,c;if(r===0||r===1){c=r===0?0:255;for(var u=0;u<a;++u)n.putByte(c)}else for(;a>0;){for(var l=0,d=yt.random.getBytes(a),u=0;u<a;++u)c=d.charCodeAt(u),c===0?++l:n.putByte(c);a=l}return n.putByte(0),n.putBytes(t),n}function L9(t,e,r,n){var o=Math.ceil(e.n.bitLength()/8),s=yt.util.createBuffer(t),a=s.getByte(),c=s.getByte();if(a!==0||r&&c!==0&&c!==1||!r&&c!=2||r&&c===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var u=0;if(c===0){u=o-3-n;for(var l=0;l<u;++l)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(c===1)for(u=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++u}else if(c===2)for(u=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++u}var d=s.getByte();if(d!==0||u!==o-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function Wit(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),o();function o(){s(t.pBits,function(c,u){if(c)return r(c);if(t.p=u,t.q!==null)return a(c,t.q);s(t.qBits,a)})}function s(c,u){yt.prime.generateProbablePrime(c,n,u)}function a(c,u){if(c)return r(c);if(t.q=u,t.p.compareTo(t.q)<0){var l=t.p;t.p=t.q,t.q=l}if(t.p.subtract(Rr.ONE).gcd(t.e).compareTo(Rr.ONE)!==0){t.p=null,o();return}if(t.q.subtract(Rr.ONE).gcd(t.e).compareTo(Rr.ONE)!==0){t.q=null,s(t.qBits,a);return}if(t.p1=t.p.subtract(Rr.ONE),t.q1=t.q.subtract(Rr.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(Rr.ONE)!==0){t.p=t.q=null,o();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,s(t.qBits,a);return}var d=t.e.modInverse(t.phi);t.keys={privateKey:Gt.rsa.setPrivateKey(t.n,t.e,d,t.p,t.q,d.mod(t.p1),d.mod(t.q1),t.q.modInverse(t.p)),publicKey:Gt.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function Ip(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=yt.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function Kit(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function g2e(t){return yt.util.isNodejs&&typeof Iee[t]=="function"}function v2e(t){return typeof Uu.globalScope<"u"&&typeof Uu.globalScope.crypto=="object"&&typeof Uu.globalScope.crypto.subtle=="object"&&typeof Uu.globalScope.crypto.subtle[t]=="function"}function y2e(t){return typeof Uu.globalScope<"u"&&typeof Uu.globalScope.msCrypto=="object"&&typeof Uu.globalScope.msCrypto.subtle=="object"&&typeof Uu.globalScope.msCrypto.subtle[t]=="function"}function b2e(t){for(var e=yt.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}});var Cee=L((e5r,w2e)=>{var Je=tr();$v();Ll();bA();gp();Wv();k9();Xb();Mu();hee();SA();Or();typeof I2e>"u"&&(I2e=Je.jsbn.BigInteger);var I2e,fe=Je.asn1,Jt=Je.pki=Je.pki||{};w2e.exports=Jt.pbe=Je.pbe=Je.pbe||{};var e_=Jt.oids,Yit={name:"EncryptedPrivateKeyInfo",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},Qit={name:"PBES2Algorithms",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:fe.Class.UNIVERSAL,type:fe.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:fe.Class.UNIVERSAL,type:fe.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},Xit={name:"pkcs-12PbeParams",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:fe.Class.UNIVERSAL,type:fe.Type.INTEGER,constructed:!1,capture:"iterations"}]};Jt.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=Je.random.getBytesSync(r.saltSize),o=r.count,s=fe.integerToDer(o),a,c,u;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var l,d,p;switch(r.algorithm){case"aes128":a=16,l=16,d=e_["aes128-CBC"],p=Je.aes.createEncryptionCipher;break;case"aes192":a=24,l=16,d=e_["aes192-CBC"],p=Je.aes.createEncryptionCipher;break;case"aes256":a=32,l=16,d=e_["aes256-CBC"],p=Je.aes.createEncryptionCipher;break;case"des":a=8,l=8,d=e_.desCBC,p=Je.des.createEncryptionCipher;break;default:var f=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw f.algorithm=r.algorithm,f}var m="hmacWith"+r.prfAlgorithm.toUpperCase(),h=E2e(m),g=Je.pkcs5.pbkdf2(e,n,o,a,h),v=Je.random.getBytesSync(l),y=p(g);y.start(v),y.update(fe.toDer(t)),y.finish(),u=y.output.getBytes();var _=Jit(n,s,a,m);c=fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OID,!1,fe.oidToDer(e_.pkcs5PBES2).getBytes()),fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OID,!1,fe.oidToDer(e_.pkcs5PBKDF2).getBytes()),_]),fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OID,!1,fe.oidToDer(d).getBytes()),fe.create(fe.Class.UNIVERSAL,fe.Type.OCTETSTRING,!1,v)])])])}else if(r.algorithm==="3des"){a=24;var b=new Je.util.ByteBuffer(n),g=Jt.pbe.generatePkcs12Key(e,b,1,o,a),v=Jt.pbe.generatePkcs12Key(e,b,2,o,a),y=Je.des.createEncryptionCipher(g);y.start(v),y.update(fe.toDer(t)),y.finish(),u=y.output.getBytes(),c=fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OID,!1,fe.oidToDer(e_["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OCTETSTRING,!1,n),fe.create(fe.Class.UNIVERSAL,fe.Type.INTEGER,!1,s.getBytes())])])}else{var f=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw f.algorithm=r.algorithm,f}var S=fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[c,fe.create(fe.Class.UNIVERSAL,fe.Type.OCTETSTRING,!1,u)]);return S};Jt.decryptPrivateKeyInfo=function(t,e){var r=null,n={},o=[];if(!fe.validate(t,Yit,n,o)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=o,s}var a=fe.derToOid(n.encryptionOid),c=Jt.pbe.getCipher(a,n.encryptionParams,e),u=Je.util.createBuffer(n.encryptedData);return c.update(u),c.finish()&&(r=fe.fromDer(c.output)),r};Jt.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:fe.toDer(t).getBytes()};return Je.pem.encode(r,{maxline:e})};Jt.encryptedPrivateKeyFromPem=function(t){var e=Je.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return fe.fromDer(e.body)};Jt.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=Jt.wrapRsaPrivateKey(Jt.privateKeyToAsn1(t));return n=Jt.encryptPrivateKeyInfo(n,e,r),Jt.encryptedPrivateKeyToPem(n)}var o,s,a,c;switch(r.algorithm){case"aes128":o="AES-128-CBC",a=16,s=Je.random.getBytesSync(16),c=Je.aes.createEncryptionCipher;break;case"aes192":o="AES-192-CBC",a=24,s=Je.random.getBytesSync(16),c=Je.aes.createEncryptionCipher;break;case"aes256":o="AES-256-CBC",a=32,s=Je.random.getBytesSync(16),c=Je.aes.createEncryptionCipher;break;case"3des":o="DES-EDE3-CBC",a=24,s=Je.random.getBytesSync(8),c=Je.des.createEncryptionCipher;break;case"des":o="DES-CBC",a=8,s=Je.random.getBytesSync(8),c=Je.des.createEncryptionCipher;break;default:var u=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw u.algorithm=r.algorithm,u}var l=Je.pbe.opensslDeriveBytes(e,s.substr(0,8),a),d=c(l);d.start(s),d.update(fe.toDer(Jt.privateKeyToAsn1(t))),d.finish();var p={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:o,parameters:Je.util.bytesToHex(s).toUpperCase()},body:d.output.getBytes()};return Je.pem.encode(p)};Jt.decryptRsaPrivateKey=function(t,e){var r=null,n=Je.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var o=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw o.headerType=o,o}if(n.procType&&n.procType.type==="ENCRYPTED"){var s,a;switch(n.dekInfo.algorithm){case"DES-CBC":s=8,a=Je.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,a=Je.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,a=Je.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,a=Je.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,a=Je.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,a=function(p){return Je.rc2.createDecryptionCipher(p,40)};break;case"RC2-64-CBC":s=8,a=function(p){return Je.rc2.createDecryptionCipher(p,64)};break;case"RC2-128-CBC":s=16,a=function(p){return Je.rc2.createDecryptionCipher(p,128)};break;default:var o=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw o.algorithm=n.dekInfo.algorithm,o}var c=Je.util.hexToBytes(n.dekInfo.parameters),u=Je.pbe.opensslDeriveBytes(e,c.substr(0,8),s),l=a(u);if(l.start(c),l.update(Je.util.createBuffer(n.body)),l.finish())r=l.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=Jt.decryptPrivateKeyInfo(fe.fromDer(r),e):r=fe.fromDer(r),r!==null&&(r=Jt.privateKeyFromAsn1(r)),r};Jt.pbe.generatePkcs12Key=function(t,e,r,n,o,s){var a,c;if(typeof s>"u"||s===null){if(!("sha1"in Je.md))throw new Error('"sha1" hash algorithm unavailable.');s=Je.md.sha1.create()}var u=s.digestLength,l=s.blockLength,d=new Je.util.ByteBuffer,p=new Je.util.ByteBuffer;if(t!=null){for(c=0;c<t.length;c++)p.putInt16(t.charCodeAt(c));p.putInt16(0)}var f=p.length(),m=e.length(),h=new Je.util.ByteBuffer;h.fillWithByte(r,l);var g=l*Math.ceil(m/l),v=new Je.util.ByteBuffer;for(c=0;c<g;c++)v.putByte(e.at(c%m));var y=l*Math.ceil(f/l),_=new Je.util.ByteBuffer;for(c=0;c<y;c++)_.putByte(p.at(c%f));var b=v;b.putBuffer(_);for(var S=Math.ceil(o/u),I=1;I<=S;I++){var w=new Je.util.ByteBuffer;w.putBytes(h.bytes()),w.putBytes(b.bytes());for(var O=0;O<n;O++)s.start(),s.update(w.getBytes()),w=s.digest();var U=new Je.util.ByteBuffer;for(c=0;c<l;c++)U.putByte(w.at(c%u));var z=Math.ceil(m/l)+Math.ceil(f/l),M=new Je.util.ByteBuffer;for(a=0;a<z;a++){var re=new Je.util.ByteBuffer(b.getBytes(l)),ee=511;for(c=U.length()-1;c>=0;c--)ee=ee>>8,ee+=U.at(c)+re.at(c),re.setAt(c,ee&255);M.putBuffer(re)}b=M,d.putBuffer(w)}return d.truncate(d.length()-o),d};Jt.pbe.getCipher=function(t,e,r){switch(t){case Jt.oids.pkcs5PBES2:return Jt.pbe.getCipherForPBES2(t,e,r);case Jt.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case Jt.oids["pbewithSHAAnd40BitRC2-CBC"]:return Jt.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};Jt.pbe.getCipherForPBES2=function(t,e,r){var n={},o=[];if(!fe.validate(e,Qit,n,o)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=o,s}if(t=fe.derToOid(n.kdfOid),t!==Jt.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=t,s.supportedOids=["pkcs5PBKDF2"],s}if(t=fe.derToOid(n.encOid),t!==Jt.oids["aes128-CBC"]&&t!==Jt.oids["aes192-CBC"]&&t!==Jt.oids["aes256-CBC"]&&t!==Jt.oids["des-EDE3-CBC"]&&t!==Jt.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=t,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var a=n.kdfSalt,c=Je.util.createBuffer(n.kdfIterationCount);c=c.getInt(c.length()<<3);var u,l;switch(Jt.oids[t]){case"aes128-CBC":u=16,l=Je.aes.createDecryptionCipher;break;case"aes192-CBC":u=24,l=Je.aes.createDecryptionCipher;break;case"aes256-CBC":u=32,l=Je.aes.createDecryptionCipher;break;case"des-EDE3-CBC":u=24,l=Je.des.createDecryptionCipher;break;case"desCBC":u=8,l=Je.des.createDecryptionCipher;break}var d=T2e(n.prfOid),p=Je.pkcs5.pbkdf2(r,a,c,u,d),f=n.encIv,m=l(p);return m.start(f),m};Jt.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},o=[];if(!fe.validate(e,Xit,n,o)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=o,s}var a=Je.util.createBuffer(n.salt),c=Je.util.createBuffer(n.iterations);c=c.getInt(c.length()<<3);var u,l,d;switch(t){case Jt.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:u=24,l=8,d=Je.des.startDecrypting;break;case Jt.oids["pbewithSHAAnd40BitRC2-CBC"]:u=5,l=8,d=function(g,v){var y=Je.rc2.createDecryptionCipher(g,40);return y.start(v,null),y};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=t,s}var p=T2e(n.prfOid),f=Jt.pbe.generatePkcs12Key(r,a,1,c,u,p);p.start();var m=Jt.pbe.generatePkcs12Key(r,a,2,c,l,p);return d(f,m)};Jt.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n>"u"||n===null){if(!("md5"in Je.md))throw new Error('"md5" hash algorithm unavailable.');n=Je.md.md5.create()}e===null&&(e="");for(var o=[C2e(n,t+e)],s=16,a=1;s<r;++a,s+=16)o.push(C2e(n,o[a-1]+t+e));return o.join("").substr(0,r)};function C2e(t,e){return t.start().update(e).digest().getBytes()}function T2e(t){var e;if(!t)e="hmacWithSHA1";else if(e=Jt.oids[fe.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return E2e(e)}function E2e(t){var e=Je.md;switch(t){case"hmacWithSHA224":e=Je.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function Jit(t,e,r,n){var o=fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OCTETSTRING,!1,t),fe.create(fe.Class.UNIVERSAL,fe.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&o.value.push(fe.create(fe.Class.UNIVERSAL,fe.Type.INTEGER,!1,Je.util.hexToBytes(r.toString(16))),fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OID,!1,fe.oidToDer(Jt.oids[n]).getBytes()),fe.create(fe.Class.UNIVERSAL,fe.Type.NULL,!1,"")])),o}});var Tee=L((t5r,A2e)=>{var LT=tr();Ll();Or();var Ke=LT.asn1,OT=A2e.exports=LT.pkcs7asn1=LT.pkcs7asn1||{};LT.pkcs7=LT.pkcs7||{};LT.pkcs7.asn1=OT;var R2e={name:"ContentInfo",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:Ke.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};OT.contentInfoValidator=R2e;var k2e={name:"EncryptedContentInfo",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:Ke.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:Ke.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};OT.envelopedDataValidator={name:"EnvelopedData",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(k2e)};OT.encryptedDataValidator={name:"EncryptedData",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.INTEGER,constructed:!1,capture:"version"}].concat(k2e)};var Zit={name:"SignerInfo",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:Ke.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:Ke.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:Ke.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};OT.signedDataValidator={name:"SignedData",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},R2e,{name:"SignedData.Certificates",tagClass:Ke.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:Ke.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SET,capture:"signerInfos",optional:!0,value:[Zit]}]};OT.recipientInfoValidator={name:"RecipientInfo",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:Ke.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:Ke.Class.UNIVERSAL,type:Ke.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}});var Eee=L((r5r,P2e)=>{var t_=tr();Or();t_.mgf=t_.mgf||{};var eot=P2e.exports=t_.mgf.mgf1=t_.mgf1=t_.mgf1||{};eot.create=function(t){var e={generate:function(r,n){for(var o=new t_.util.ByteBuffer,s=Math.ceil(n/t.digestLength),a=0;a<s;a++){var c=new t_.util.ByteBuffer;c.putInt32(a),t.start(),t.update(r+c.getBytes()),o.putBuffer(t.digest())}return o.truncate(o.length()-n),o.getBytes()}};return e}});var N2e=L((n5r,D2e)=>{var O9=tr();Eee();D2e.exports=O9.mgf=O9.mgf||{};O9.mgf.mgf1=O9.mgf1});var M9=L((i5r,L2e)=>{var r_=tr();Mu();Or();var tot=L2e.exports=r_.pss=r_.pss||{};tot.create=function(t){arguments.length===3&&(t={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var e=t.md,r=t.mgf,n=e.digestLength,o=t.salt||null;typeof o=="string"&&(o=r_.util.createBuffer(o));var s;if("saltLength"in t)s=t.saltLength;else if(o!==null)s=o.length();else throw new Error("Salt length not specified or specific salt not given.");if(o!==null&&o.length()!==s)throw new Error("Given salt length does not match length of given salt.");var a=t.prng||r_.random,c={};return c.encode=function(u,l){var d,p=l-1,f=Math.ceil(p/8),m=u.digest().getBytes();if(f<n+s+2)throw new Error("Message is too long to encrypt.");var h;o===null?h=a.getBytesSync(s):h=o.bytes();var g=new r_.util.ByteBuffer;g.fillWithByte(0,8),g.putBytes(m),g.putBytes(h),e.start(),e.update(g.getBytes());var v=e.digest().getBytes(),y=new r_.util.ByteBuffer;y.fillWithByte(0,f-s-n-2),y.putByte(1),y.putBytes(h);var _=y.getBytes(),b=f-n-1,S=r.generate(v,b),I="";for(d=0;d<b;d++)I+=String.fromCharCode(_.charCodeAt(d)^S.charCodeAt(d));var w=65280>>8*f-p&255;return I=String.fromCharCode(I.charCodeAt(0)&~w)+I.substr(1),I+v+"\xBC"},c.verify=function(u,l,d){var p,f=d-1,m=Math.ceil(f/8);if(l=l.substr(-m),m<n+s+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(l.charCodeAt(m-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var h=m-n-1,g=l.substr(0,h),v=l.substr(h,n),y=65280>>8*m-f&255;if(g.charCodeAt(0)&y)throw new Error("Bits beyond keysize not zero as expected.");var _=r.generate(v,h),b="";for(p=0;p<h;p++)b+=String.fromCharCode(g.charCodeAt(p)^_.charCodeAt(p));b=String.fromCharCode(b.charCodeAt(0)&~y)+b.substr(1);var S=m-n-s-2;for(p=0;p<S;p++)if(b.charCodeAt(p)!==0)throw new Error("Leftmost octets not zero as expected");if(b.charCodeAt(S)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var I=b.substr(-s),w=new r_.util.ByteBuffer;w.fillWithByte(0,8),w.putBytes(u),w.putBytes(I),e.start(),e.update(w.getBytes());var O=e.digest().getBytes();return v===O},c}});var B9=L((o5r,B2e)=>{var bt=tr();$v();Ll();bA();gp();N2e();Wv();Xb();M9();SA();Or();var k=bt.asn1,qe=B2e.exports=bt.pki=bt.pki||{},kr=qe.oids,Ai={};Ai.CN=kr.commonName;Ai.commonName="CN";Ai.C=kr.countryName;Ai.countryName="C";Ai.L=kr.localityName;Ai.localityName="L";Ai.ST=kr.stateOrProvinceName;Ai.stateOrProvinceName="ST";Ai.O=kr.organizationName;Ai.organizationName="O";Ai.OU=kr.organizationalUnitName;Ai.organizationalUnitName="OU";Ai.E=kr.emailAddress;Ai.emailAddress="E";var M2e=bt.pki.rsa.publicKeyValidator,rot={name:"Certificate",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:k.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:k.Class.UNIVERSAL,type:k.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:k.Class.UNIVERSAL,type:k.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:k.Class.UNIVERSAL,type:k.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:k.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:k.Class.UNIVERSAL,type:k.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:k.Class.UNIVERSAL,type:k.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:k.Class.UNIVERSAL,type:k.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:k.Class.UNIVERSAL,type:k.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},M2e,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:k.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:k.Class.UNIVERSAL,type:k.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:k.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:k.Class.UNIVERSAL,type:k.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:k.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:k.Class.UNIVERSAL,type:k.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:k.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:k.Class.UNIVERSAL,type:k.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},not={name:"rsapss",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:k.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:k.Class.UNIVERSAL,type:k.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:k.Class.UNIVERSAL,type:k.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:k.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:k.Class.UNIVERSAL,type:k.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:k.Class.UNIVERSAL,type:k.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:k.Class.UNIVERSAL,type:k.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:k.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:k.Class.UNIVERSAL,type:k.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:k.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:k.Class.UNIVERSAL,type:k.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},iot={name:"CertificationRequestInfo",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:k.Class.UNIVERSAL,type:k.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},M2e,{name:"CertificationRequestInfo.attributes",tagClass:k.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:k.Class.UNIVERSAL,type:k.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:k.Class.UNIVERSAL,type:k.Type.SET,constructed:!0}]}]}]},oot={name:"CertificationRequest",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[iot,{name:"CertificationRequest.signatureAlgorithm",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:k.Class.UNIVERSAL,type:k.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:k.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:k.Class.UNIVERSAL,type:k.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};qe.RDNAttributesAsArray=function(t,e){for(var r=[],n,o,s,a=0;a<t.value.length;++a){n=t.value[a];for(var c=0;c<n.value.length;++c)s={},o=n.value[c],s.type=k.derToOid(o.value[0].value),s.value=o.value[1].value,s.valueTagClass=o.value[1].type,s.type in kr&&(s.name=kr[s.type],s.name in Ai&&(s.shortName=Ai[s.name])),e&&(e.update(s.type),e.update(s.value)),r.push(s)}return r};qe.CRIAttributesAsArray=function(t){for(var e=[],r=0;r<t.length;++r)for(var n=t[r],o=k.derToOid(n.value[0].value),s=n.value[1].value,a=0;a<s.length;++a){var c={};if(c.type=o,c.value=s[a].value,c.valueTagClass=s[a].type,c.type in kr&&(c.name=kr[c.type],c.name in Ai&&(c.shortName=Ai[c.name])),c.type===kr.extensionRequest){c.extensions=[];for(var u=0;u<c.value.length;++u)c.extensions.push(qe.certificateExtensionFromAsn1(c.value[u]))}e.push(c)}return e};function Qv(t,e){typeof e=="string"&&(e={shortName:e});for(var r=null,n,o=0;r===null&&o<t.attributes.length;++o)n=t.attributes[o],(e.type&&e.type===n.type||e.name&&e.name===n.name||e.shortName&&e.shortName===n.shortName)&&(r=n);return r}var F9=function(t,e,r){var n={};if(t!==kr["RSASSA-PSS"])return n;r&&(n={hash:{algorithmOid:kr.sha1},mgf:{algorithmOid:kr.mgf1,hash:{algorithmOid:kr.sha1}},saltLength:20});var o={},s=[];if(!k.validate(e,not,o,s)){var a=new Error("Cannot read RSASSA-PSS parameter block.");throw a.errors=s,a}return o.hashOid!==void 0&&(n.hash=n.hash||{},n.hash.algorithmOid=k.derToOid(o.hashOid)),o.maskGenOid!==void 0&&(n.mgf=n.mgf||{},n.mgf.algorithmOid=k.derToOid(o.maskGenOid),n.mgf.hash=n.mgf.hash||{},n.mgf.hash.algorithmOid=k.derToOid(o.maskGenHashOid)),o.saltLength!==void 0&&(n.saltLength=o.saltLength.charCodeAt(0)),n},U9=function(t){switch(kr[t.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return bt.md.sha1.create();case"md5WithRSAEncryption":return bt.md.md5.create();case"sha256WithRSAEncryption":return bt.md.sha256.create();case"sha384WithRSAEncryption":return bt.md.sha384.create();case"sha512WithRSAEncryption":return bt.md.sha512.create();case"RSASSA-PSS":return bt.md.sha256.create();default:var e=new Error("Could not compute "+t.type+" digest. Unknown signature OID.");throw e.signatureOid=t.signatureOid,e}},F2e=function(t){var e=t.certificate,r;switch(e.signatureOid){case kr.sha1WithRSAEncryption:case kr.sha1WithRSASignature:break;case kr["RSASSA-PSS"]:var n,o;if(n=kr[e.signatureParameters.mgf.hash.algorithmOid],n===void 0||bt.md[n]===void 0){var s=new Error("Unsupported MGF hash function.");throw s.oid=e.signatureParameters.mgf.hash.algorithmOid,s.name=n,s}if(o=kr[e.signatureParameters.mgf.algorithmOid],o===void 0||bt.mgf[o]===void 0){var s=new Error("Unsupported MGF function.");throw s.oid=e.signatureParameters.mgf.algorithmOid,s.name=o,s}if(o=bt.mgf[o].create(bt.md[n].create()),n=kr[e.signatureParameters.hash.algorithmOid],n===void 0||bt.md[n]===void 0){var s=new Error("Unsupported RSASSA-PSS hash function.");throw s.oid=e.signatureParameters.hash.algorithmOid,s.name=n,s}r=bt.pss.create(bt.md[n].create(),o,e.signatureParameters.saltLength);break}return e.publicKey.verify(t.md.digest().getBytes(),t.signature,r)};qe.certificateFromPem=function(t,e,r){var n=bt.pem.decode(t)[0];if(n.type!=="CERTIFICATE"&&n.type!=="X509 CERTIFICATE"&&n.type!=="TRUSTED CERTIFICATE"){var o=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw o.headerType=n.type,o}if(n.procType&&n.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var s=k.fromDer(n.body,r);return qe.certificateFromAsn1(s,e)};qe.certificateToPem=function(t,e){var r={type:"CERTIFICATE",body:k.toDer(qe.certificateToAsn1(t)).getBytes()};return bt.pem.encode(r,{maxline:e})};qe.publicKeyFromPem=function(t){var e=bt.pem.decode(t)[0];if(e.type!=="PUBLIC KEY"&&e.type!=="RSA PUBLIC KEY"){var r=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var n=k.fromDer(e.body);return qe.publicKeyFromAsn1(n)};qe.publicKeyToPem=function(t,e){var r={type:"PUBLIC KEY",body:k.toDer(qe.publicKeyToAsn1(t)).getBytes()};return bt.pem.encode(r,{maxline:e})};qe.publicKeyToRSAPublicKeyPem=function(t,e){var r={type:"RSA PUBLIC KEY",body:k.toDer(qe.publicKeyToRSAPublicKey(t)).getBytes()};return bt.pem.encode(r,{maxline:e})};qe.getPublicKeyFingerprint=function(t,e){e=e||{};var r=e.md||bt.md.sha1.create(),n=e.type||"RSAPublicKey",o;switch(n){case"RSAPublicKey":o=k.toDer(qe.publicKeyToRSAPublicKey(t)).getBytes();break;case"SubjectPublicKeyInfo":o=k.toDer(qe.publicKeyToAsn1(t)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+e.type+'".')}r.start(),r.update(o);var s=r.digest();if(e.encoding==="hex"){var a=s.toHex();return e.delimiter?a.match(/.{2}/g).join(e.delimiter):a}else{if(e.encoding==="binary")return s.getBytes();if(e.encoding)throw new Error('Unknown encoding "'+e.encoding+'".')}return s};qe.certificationRequestFromPem=function(t,e,r){var n=bt.pem.decode(t)[0];if(n.type!=="CERTIFICATE REQUEST"){var o=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw o.headerType=n.type,o}if(n.procType&&n.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var s=k.fromDer(n.body,r);return qe.certificationRequestFromAsn1(s,e)};qe.certificationRequestToPem=function(t,e){var r={type:"CERTIFICATE REQUEST",body:k.toDer(qe.certificationRequestToAsn1(t)).getBytes()};return bt.pem.encode(r,{maxline:e})};qe.createCertificate=function(){var t={};return t.version=2,t.serialNumber="00",t.signatureOid=null,t.signature=null,t.siginfo={},t.siginfo.algorithmOid=null,t.validity={},t.validity.notBefore=new Date,t.validity.notAfter=new Date,t.issuer={},t.issuer.getField=function(e){return Qv(t.issuer,e)},t.issuer.addField=function(e){Bu([e]),t.issuer.attributes.push(e)},t.issuer.attributes=[],t.issuer.hash=null,t.subject={},t.subject.getField=function(e){return Qv(t.subject,e)},t.subject.addField=function(e){Bu([e]),t.subject.attributes.push(e)},t.subject.attributes=[],t.subject.hash=null,t.extensions=[],t.publicKey=null,t.md=null,t.setSubject=function(e,r){Bu(e),t.subject.attributes=e,delete t.subject.uniqueId,r&&(t.subject.uniqueId=r),t.subject.hash=null},t.setIssuer=function(e,r){Bu(e),t.issuer.attributes=e,delete t.issuer.uniqueId,r&&(t.issuer.uniqueId=r),t.issuer.hash=null},t.setExtensions=function(e){for(var r=0;r<e.length;++r)U2e(e[r],{cert:t});t.extensions=e},t.getExtension=function(e){typeof e=="string"&&(e={name:e});for(var r=null,n,o=0;r===null&&o<t.extensions.length;++o)n=t.extensions[o],(e.id&&n.id===e.id||e.name&&n.name===e.name)&&(r=n);return r},t.sign=function(e,r){t.md=r||bt.md.sha1.create();var n=kr[t.md.algorithm+"WithRSAEncryption"];if(!n){var o=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw o.algorithm=t.md.algorithm,o}t.signatureOid=t.siginfo.algorithmOid=n,t.tbsCertificate=qe.getTBSCertificate(t);var s=k.toDer(t.tbsCertificate);t.md.update(s.getBytes()),t.signature=e.sign(t.md)},t.verify=function(e){var r=!1;if(!t.issued(e)){var n=e.issuer,o=t.subject,s=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw s.expectedIssuer=o.attributes,s.actualIssuer=n.attributes,s}var a=e.md;if(a===null){a=U9({signatureOid:e.signatureOid,type:"certificate"});var c=e.tbsCertificate||qe.getTBSCertificate(e),u=k.toDer(c);a.update(u.getBytes())}return a!==null&&(r=F2e({certificate:t,md:a,signature:e.signature})),r},t.isIssuer=function(e){var r=!1,n=t.issuer,o=e.subject;if(n.hash&&o.hash)r=n.hash===o.hash;else if(n.attributes.length===o.attributes.length){r=!0;for(var s,a,c=0;r&&c<n.attributes.length;++c)s=n.attributes[c],a=o.attributes[c],(s.type!==a.type||s.value!==a.value)&&(r=!1)}return r},t.issued=function(e){return e.isIssuer(t)},t.generateSubjectKeyIdentifier=function(){return qe.getPublicKeyFingerprint(t.publicKey,{type:"RSAPublicKey"})},t.verifySubjectKeyIdentifier=function(){for(var e=kr.subjectKeyIdentifier,r=0;r<t.extensions.length;++r){var n=t.extensions[r];if(n.id===e){var o=t.generateSubjectKeyIdentifier().getBytes();return bt.util.hexToBytes(n.subjectKeyIdentifier)===o}}return!1},t};qe.certificateFromAsn1=function(t,e){var r={},n=[];if(!k.validate(t,rot,r,n)){var o=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw o.errors=n,o}var s=k.derToOid(r.publicKeyOid);if(s!==qe.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var a=qe.createCertificate();a.version=r.certVersion?r.certVersion.charCodeAt(0):0;var c=bt.util.createBuffer(r.certSerialNumber);a.serialNumber=c.toHex(),a.signatureOid=bt.asn1.derToOid(r.certSignatureOid),a.signatureParameters=F9(a.signatureOid,r.certSignatureParams,!0),a.siginfo.algorithmOid=bt.asn1.derToOid(r.certinfoSignatureOid),a.siginfo.parameters=F9(a.siginfo.algorithmOid,r.certinfoSignatureParams,!1),a.signature=r.certSignature;var u=[];if(r.certValidity1UTCTime!==void 0&&u.push(k.utcTimeToDate(r.certValidity1UTCTime)),r.certValidity2GeneralizedTime!==void 0&&u.push(k.generalizedTimeToDate(r.certValidity2GeneralizedTime)),r.certValidity3UTCTime!==void 0&&u.push(k.utcTimeToDate(r.certValidity3UTCTime)),r.certValidity4GeneralizedTime!==void 0&&u.push(k.generalizedTimeToDate(r.certValidity4GeneralizedTime)),u.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(u.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(a.validity.notBefore=u[0],a.validity.notAfter=u[1],a.tbsCertificate=r.tbsCertificate,e){a.md=U9({signatureOid:a.signatureOid,type:"certificate"});var l=k.toDer(a.tbsCertificate);a.md.update(l.getBytes())}var d=bt.md.sha1.create(),p=k.toDer(r.certIssuer);d.update(p.getBytes()),a.issuer.getField=function(h){return Qv(a.issuer,h)},a.issuer.addField=function(h){Bu([h]),a.issuer.attributes.push(h)},a.issuer.attributes=qe.RDNAttributesAsArray(r.certIssuer),r.certIssuerUniqueId&&(a.issuer.uniqueId=r.certIssuerUniqueId),a.issuer.hash=d.digest().toHex();var f=bt.md.sha1.create(),m=k.toDer(r.certSubject);return f.update(m.getBytes()),a.subject.getField=function(h){return Qv(a.subject,h)},a.subject.addField=function(h){Bu([h]),a.subject.attributes.push(h)},a.subject.attributes=qe.RDNAttributesAsArray(r.certSubject),r.certSubjectUniqueId&&(a.subject.uniqueId=r.certSubjectUniqueId),a.subject.hash=f.digest().toHex(),r.certExtensions?a.extensions=qe.certificateExtensionsFromAsn1(r.certExtensions):a.extensions=[],a.publicKey=qe.publicKeyFromAsn1(r.subjectPublicKeyInfo),a};qe.certificateExtensionsFromAsn1=function(t){for(var e=[],r=0;r<t.value.length;++r)for(var n=t.value[r],o=0;o<n.value.length;++o)e.push(qe.certificateExtensionFromAsn1(n.value[o]));return e};qe.certificateExtensionFromAsn1=function(t){var e={};if(e.id=k.derToOid(t.value[0].value),e.critical=!1,t.value[1].type===k.Type.BOOLEAN?(e.critical=t.value[1].value.charCodeAt(0)!==0,e.value=t.value[2].value):e.value=t.value[1].value,e.id in kr){if(e.name=kr[e.id],e.name==="keyUsage"){var r=k.fromDer(e.value),n=0,o=0;r.value.length>1&&(n=r.value.charCodeAt(1),o=r.value.length>2?r.value.charCodeAt(2):0),e.digitalSignature=(n&128)===128,e.nonRepudiation=(n&64)===64,e.keyEncipherment=(n&32)===32,e.dataEncipherment=(n&16)===16,e.keyAgreement=(n&8)===8,e.keyCertSign=(n&4)===4,e.cRLSign=(n&2)===2,e.encipherOnly=(n&1)===1,e.decipherOnly=(o&128)===128}else if(e.name==="basicConstraints"){var r=k.fromDer(e.value);r.value.length>0&&r.value[0].type===k.Type.BOOLEAN?e.cA=r.value[0].value.charCodeAt(0)!==0:e.cA=!1;var s=null;r.value.length>0&&r.value[0].type===k.Type.INTEGER?s=r.value[0].value:r.value.length>1&&(s=r.value[1].value),s!==null&&(e.pathLenConstraint=k.derToInteger(s))}else if(e.name==="extKeyUsage")for(var r=k.fromDer(e.value),a=0;a<r.value.length;++a){var c=k.derToOid(r.value[a].value);c in kr?e[kr[c]]=!0:e[c]=!0}else if(e.name==="nsCertType"){var r=k.fromDer(e.value),n=0;r.value.length>1&&(n=r.value.charCodeAt(1)),e.client=(n&128)===128,e.server=(n&64)===64,e.email=(n&32)===32,e.objsign=(n&16)===16,e.reserved=(n&8)===8,e.sslCA=(n&4)===4,e.emailCA=(n&2)===2,e.objCA=(n&1)===1}else if(e.name==="subjectAltName"||e.name==="issuerAltName"){e.altNames=[];for(var u,r=k.fromDer(e.value),l=0;l<r.value.length;++l){u=r.value[l];var d={type:u.type,value:u.value};switch(e.altNames.push(d),u.type){case 1:case 2:case 6:break;case 7:d.ip=bt.util.bytesToIP(u.value);break;case 8:d.oid=k.derToOid(u.value);break;default:}}}else if(e.name==="subjectKeyIdentifier"){var r=k.fromDer(e.value);e.subjectKeyIdentifier=bt.util.bytesToHex(r.value)}}return e};qe.certificationRequestFromAsn1=function(t,e){var r={},n=[];if(!k.validate(t,oot,r,n)){var o=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw o.errors=n,o}var s=k.derToOid(r.publicKeyOid);if(s!==qe.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var a=qe.createCertificationRequest();if(a.version=r.csrVersion?r.csrVersion.charCodeAt(0):0,a.signatureOid=bt.asn1.derToOid(r.csrSignatureOid),a.signatureParameters=F9(a.signatureOid,r.csrSignatureParams,!0),a.siginfo.algorithmOid=bt.asn1.derToOid(r.csrSignatureOid),a.siginfo.parameters=F9(a.siginfo.algorithmOid,r.csrSignatureParams,!1),a.signature=r.csrSignature,a.certificationRequestInfo=r.certificationRequestInfo,e){a.md=U9({signatureOid:a.signatureOid,type:"certification request"});var c=k.toDer(a.certificationRequestInfo);a.md.update(c.getBytes())}var u=bt.md.sha1.create();return a.subject.getField=function(l){return Qv(a.subject,l)},a.subject.addField=function(l){Bu([l]),a.subject.attributes.push(l)},a.subject.attributes=qe.RDNAttributesAsArray(r.certificationRequestInfoSubject,u),a.subject.hash=u.digest().toHex(),a.publicKey=qe.publicKeyFromAsn1(r.subjectPublicKeyInfo),a.getAttribute=function(l){return Qv(a,l)},a.addAttribute=function(l){Bu([l]),a.attributes.push(l)},a.attributes=qe.CRIAttributesAsArray(r.certificationRequestInfoAttributes||[]),a};qe.createCertificationRequest=function(){var t={};return t.version=0,t.signatureOid=null,t.signature=null,t.siginfo={},t.siginfo.algorithmOid=null,t.subject={},t.subject.getField=function(e){return Qv(t.subject,e)},t.subject.addField=function(e){Bu([e]),t.subject.attributes.push(e)},t.subject.attributes=[],t.subject.hash=null,t.publicKey=null,t.attributes=[],t.getAttribute=function(e){return Qv(t,e)},t.addAttribute=function(e){Bu([e]),t.attributes.push(e)},t.md=null,t.setSubject=function(e){Bu(e),t.subject.attributes=e,t.subject.hash=null},t.setAttributes=function(e){Bu(e),t.attributes=e},t.sign=function(e,r){t.md=r||bt.md.sha1.create();var n=kr[t.md.algorithm+"WithRSAEncryption"];if(!n){var o=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw o.algorithm=t.md.algorithm,o}t.signatureOid=t.siginfo.algorithmOid=n,t.certificationRequestInfo=qe.getCertificationRequestInfo(t);var s=k.toDer(t.certificationRequestInfo);t.md.update(s.getBytes()),t.signature=e.sign(t.md)},t.verify=function(){var e=!1,r=t.md;if(r===null){r=U9({signatureOid:t.signatureOid,type:"certification request"});var n=t.certificationRequestInfo||qe.getCertificationRequestInfo(t),o=k.toDer(n);r.update(o.getBytes())}return r!==null&&(e=F2e({certificate:t,md:r,signature:t.signature})),e},t};function MT(t){for(var e=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[]),r,n,o=t.attributes,s=0;s<o.length;++s){r=o[s];var a=r.value,c=k.Type.PRINTABLESTRING;"valueTagClass"in r&&(c=r.valueTagClass,c===k.Type.UTF8&&(a=bt.util.encodeUtf8(a))),n=k.create(k.Class.UNIVERSAL,k.Type.SET,!0,[k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(r.type).getBytes()),k.create(k.Class.UNIVERSAL,c,!1,a)])]),e.value.push(n)}return e}function Bu(t){for(var e,r=0;r<t.length;++r){if(e=t[r],typeof e.name>"u"&&(e.type&&e.type in qe.oids?e.name=qe.oids[e.type]:e.shortName&&e.shortName in Ai&&(e.name=qe.oids[Ai[e.shortName]])),typeof e.type>"u")if(e.name&&e.name in qe.oids)e.type=qe.oids[e.name];else{var n=new Error("Attribute type not specified.");throw n.attribute=e,n}if(typeof e.shortName>"u"&&e.name&&e.name in Ai&&(e.shortName=Ai[e.name]),e.type===kr.extensionRequest&&(e.valueConstructed=!0,e.valueTagClass=k.Type.SEQUENCE,!e.value&&e.extensions)){e.value=[];for(var o=0;o<e.extensions.length;++o)e.value.push(qe.certificateExtensionToAsn1(U2e(e.extensions[o])))}if(typeof e.value>"u"){var n=new Error("Attribute value not specified.");throw n.attribute=e,n}}}function U2e(t,e){if(e=e||{},typeof t.name>"u"&&t.id&&t.id in qe.oids&&(t.name=qe.oids[t.id]),typeof t.id>"u")if(t.name&&t.name in qe.oids)t.id=qe.oids[t.name];else{var r=new Error("Extension ID not specified.");throw r.extension=t,r}if(typeof t.value<"u")return t;if(t.name==="keyUsage"){var n=0,o=0,s=0;t.digitalSignature&&(o|=128,n=7),t.nonRepudiation&&(o|=64,n=6),t.keyEncipherment&&(o|=32,n=5),t.dataEncipherment&&(o|=16,n=4),t.keyAgreement&&(o|=8,n=3),t.keyCertSign&&(o|=4,n=2),t.cRLSign&&(o|=2,n=1),t.encipherOnly&&(o|=1,n=0),t.decipherOnly&&(s|=128,n=7);var a=String.fromCharCode(n);s!==0?a+=String.fromCharCode(o)+String.fromCharCode(s):o!==0&&(a+=String.fromCharCode(o)),t.value=k.create(k.Class.UNIVERSAL,k.Type.BITSTRING,!1,a)}else if(t.name==="basicConstraints")t.value=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[]),t.cA&&t.value.value.push(k.create(k.Class.UNIVERSAL,k.Type.BOOLEAN,!1,"\xFF")),"pathLenConstraint"in t&&t.value.value.push(k.create(k.Class.UNIVERSAL,k.Type.INTEGER,!1,k.integerToDer(t.pathLenConstraint).getBytes()));else if(t.name==="extKeyUsage"){t.value=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[]);var c=t.value.value;for(var u in t)t[u]===!0&&(u in kr?c.push(k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(kr[u]).getBytes())):u.indexOf(".")!==-1&&c.push(k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(u).getBytes())))}else if(t.name==="nsCertType"){var n=0,o=0;t.client&&(o|=128,n=7),t.server&&(o|=64,n=6),t.email&&(o|=32,n=5),t.objsign&&(o|=16,n=4),t.reserved&&(o|=8,n=3),t.sslCA&&(o|=4,n=2),t.emailCA&&(o|=2,n=1),t.objCA&&(o|=1,n=0);var a=String.fromCharCode(n);o!==0&&(a+=String.fromCharCode(o)),t.value=k.create(k.Class.UNIVERSAL,k.Type.BITSTRING,!1,a)}else if(t.name==="subjectAltName"||t.name==="issuerAltName"){t.value=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[]);for(var l,d=0;d<t.altNames.length;++d){l=t.altNames[d];var a=l.value;if(l.type===7&&l.ip){if(a=bt.util.bytesFromIP(l.ip),a===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=t,r}}else l.type===8&&(l.oid?a=k.oidToDer(k.oidToDer(l.oid)):a=k.oidToDer(a));t.value.value.push(k.create(k.Class.CONTEXT_SPECIFIC,l.type,!1,a))}}else if(t.name==="nsComment"&&e.cert){if(!/^[\x00-\x7F]*$/.test(t.comment)||t.comment.length<1||t.comment.length>128)throw new Error('Invalid "nsComment" content.');t.value=k.create(k.Class.UNIVERSAL,k.Type.IA5STRING,!1,t.comment)}else if(t.name==="subjectKeyIdentifier"&&e.cert){var p=e.cert.generateSubjectKeyIdentifier();t.subjectKeyIdentifier=p.toHex(),t.value=k.create(k.Class.UNIVERSAL,k.Type.OCTETSTRING,!1,p.getBytes())}else if(t.name==="authorityKeyIdentifier"&&e.cert){t.value=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[]);var c=t.value.value;if(t.keyIdentifier){var f=t.keyIdentifier===!0?e.cert.generateSubjectKeyIdentifier().getBytes():t.keyIdentifier;c.push(k.create(k.Class.CONTEXT_SPECIFIC,0,!1,f))}if(t.authorityCertIssuer){var m=[k.create(k.Class.CONTEXT_SPECIFIC,4,!0,[MT(t.authorityCertIssuer===!0?e.cert.issuer:t.authorityCertIssuer)])];c.push(k.create(k.Class.CONTEXT_SPECIFIC,1,!0,m))}if(t.serialNumber){var h=bt.util.hexToBytes(t.serialNumber===!0?e.cert.serialNumber:t.serialNumber);c.push(k.create(k.Class.CONTEXT_SPECIFIC,2,!1,h))}}else if(t.name==="cRLDistributionPoints"){t.value=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[]);for(var c=t.value.value,g=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[]),v=k.create(k.Class.CONTEXT_SPECIFIC,0,!0,[]),l,d=0;d<t.altNames.length;++d){l=t.altNames[d];var a=l.value;if(l.type===7&&l.ip){if(a=bt.util.bytesFromIP(l.ip),a===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=t,r}}else l.type===8&&(l.oid?a=k.oidToDer(k.oidToDer(l.oid)):a=k.oidToDer(a));v.value.push(k.create(k.Class.CONTEXT_SPECIFIC,l.type,!1,a))}g.value.push(k.create(k.Class.CONTEXT_SPECIFIC,0,!0,[v])),c.push(g)}if(typeof t.value>"u"){var r=new Error("Extension value not specified.");throw r.extension=t,r}return t}function wee(t,e){switch(t){case kr["RSASSA-PSS"]:var r=[];return e.hash.algorithmOid!==void 0&&r.push(k.create(k.Class.CONTEXT_SPECIFIC,0,!0,[k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(e.hash.algorithmOid).getBytes()),k.create(k.Class.UNIVERSAL,k.Type.NULL,!1,"")])])),e.mgf.algorithmOid!==void 0&&r.push(k.create(k.Class.CONTEXT_SPECIFIC,1,!0,[k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(e.mgf.algorithmOid).getBytes()),k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(e.mgf.hash.algorithmOid).getBytes()),k.create(k.Class.UNIVERSAL,k.Type.NULL,!1,"")])])])),e.saltLength!==void 0&&r.push(k.create(k.Class.CONTEXT_SPECIFIC,2,!0,[k.create(k.Class.UNIVERSAL,k.Type.INTEGER,!1,k.integerToDer(e.saltLength).getBytes())])),k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,r);default:return k.create(k.Class.UNIVERSAL,k.Type.NULL,!1,"")}}function sot(t){var e=k.create(k.Class.CONTEXT_SPECIFIC,0,!0,[]);if(t.attributes.length===0)return e;for(var r=t.attributes,n=0;n<r.length;++n){var o=r[n],s=o.value,a=k.Type.UTF8;"valueTagClass"in o&&(a=o.valueTagClass),a===k.Type.UTF8&&(s=bt.util.encodeUtf8(s));var c=!1;"valueConstructed"in o&&(c=o.valueConstructed);var u=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(o.type).getBytes()),k.create(k.Class.UNIVERSAL,k.Type.SET,!0,[k.create(k.Class.UNIVERSAL,a,c,s)])]);e.value.push(u)}return e}var aot=new Date("1950-01-01T00:00:00Z"),cot=new Date("2050-01-01T00:00:00Z");function O2e(t){return t>=aot&&t<cot?k.create(k.Class.UNIVERSAL,k.Type.UTCTIME,!1,k.dateToUtcTime(t)):k.create(k.Class.UNIVERSAL,k.Type.GENERALIZEDTIME,!1,k.dateToGeneralizedTime(t))}qe.getTBSCertificate=function(t){var e=O2e(t.validity.notBefore),r=O2e(t.validity.notAfter),n=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.CONTEXT_SPECIFIC,0,!0,[k.create(k.Class.UNIVERSAL,k.Type.INTEGER,!1,k.integerToDer(t.version).getBytes())]),k.create(k.Class.UNIVERSAL,k.Type.INTEGER,!1,bt.util.hexToBytes(t.serialNumber)),k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(t.siginfo.algorithmOid).getBytes()),wee(t.siginfo.algorithmOid,t.siginfo.parameters)]),MT(t.issuer),k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[e,r]),MT(t.subject),qe.publicKeyToAsn1(t.publicKey)]);return t.issuer.uniqueId&&n.value.push(k.create(k.Class.CONTEXT_SPECIFIC,1,!0,[k.create(k.Class.UNIVERSAL,k.Type.BITSTRING,!1,"\0"+t.issuer.uniqueId)])),t.subject.uniqueId&&n.value.push(k.create(k.Class.CONTEXT_SPECIFIC,2,!0,[k.create(k.Class.UNIVERSAL,k.Type.BITSTRING,!1,"\0"+t.subject.uniqueId)])),t.extensions.length>0&&n.value.push(qe.certificateExtensionsToAsn1(t.extensions)),n};qe.getCertificationRequestInfo=function(t){var e=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.INTEGER,!1,k.integerToDer(t.version).getBytes()),MT(t.subject),qe.publicKeyToAsn1(t.publicKey),sot(t)]);return e};qe.distinguishedNameToAsn1=function(t){return MT(t)};qe.certificateToAsn1=function(t){var e=t.tbsCertificate||qe.getTBSCertificate(t);return k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[e,k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(t.signatureOid).getBytes()),wee(t.signatureOid,t.signatureParameters)]),k.create(k.Class.UNIVERSAL,k.Type.BITSTRING,!1,"\0"+t.signature)])};qe.certificateExtensionsToAsn1=function(t){var e=k.create(k.Class.CONTEXT_SPECIFIC,3,!0,[]),r=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[]);e.value.push(r);for(var n=0;n<t.length;++n)r.value.push(qe.certificateExtensionToAsn1(t[n]));return e};qe.certificateExtensionToAsn1=function(t){var e=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[]);e.value.push(k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(t.id).getBytes())),t.critical&&e.value.push(k.create(k.Class.UNIVERSAL,k.Type.BOOLEAN,!1,"\xFF"));var r=t.value;return typeof t.value!="string"&&(r=k.toDer(r).getBytes()),e.value.push(k.create(k.Class.UNIVERSAL,k.Type.OCTETSTRING,!1,r)),e};qe.certificationRequestToAsn1=function(t){var e=t.certificationRequestInfo||qe.getCertificationRequestInfo(t);return k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[e,k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(t.signatureOid).getBytes()),wee(t.signatureOid,t.signatureParameters)]),k.create(k.Class.UNIVERSAL,k.Type.BITSTRING,!1,"\0"+t.signature)])};qe.createCaStore=function(t){var e={certs:{}};e.getIssuer=function(a){var c=r(a.issuer);return c},e.addCertificate=function(a){if(typeof a=="string"&&(a=bt.pki.certificateFromPem(a)),n(a.subject),!e.hasCertificate(a))if(a.subject.hash in e.certs){var c=e.certs[a.subject.hash];bt.util.isArray(c)||(c=[c]),c.push(a),e.certs[a.subject.hash]=c}else e.certs[a.subject.hash]=a},e.hasCertificate=function(a){typeof a=="string"&&(a=bt.pki.certificateFromPem(a));var c=r(a.subject);if(!c)return!1;bt.util.isArray(c)||(c=[c]);for(var u=k.toDer(qe.certificateToAsn1(a)).getBytes(),l=0;l<c.length;++l){var d=k.toDer(qe.certificateToAsn1(c[l])).getBytes();if(u===d)return!0}return!1},e.listAllCertificates=function(){var a=[];for(var c in e.certs)if(e.certs.hasOwnProperty(c)){var u=e.certs[c];if(!bt.util.isArray(u))a.push(u);else for(var l=0;l<u.length;++l)a.push(u[l])}return a},e.removeCertificate=function(a){var c;if(typeof a=="string"&&(a=bt.pki.certificateFromPem(a)),n(a.subject),!e.hasCertificate(a))return null;var u=r(a.subject);if(!bt.util.isArray(u))return c=e.certs[a.subject.hash],delete e.certs[a.subject.hash],c;for(var l=k.toDer(qe.certificateToAsn1(a)).getBytes(),d=0;d<u.length;++d){var p=k.toDer(qe.certificateToAsn1(u[d])).getBytes();l===p&&(c=u[d],u.splice(d,1))}return u.length===0&&delete e.certs[a.subject.hash],c};function r(a){return n(a),e.certs[a.hash]||null}function n(a){if(!a.hash){var c=bt.md.sha1.create();a.attributes=qe.RDNAttributesAsArray(MT(a),c),a.hash=c.digest().toHex()}}if(t)for(var o=0;o<t.length;++o){var s=t[o];e.addCertificate(s)}return e};qe.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};qe.verifyCertificateChain=function(t,e,r){typeof r=="function"&&(r={verify:r}),r=r||{},e=e.slice(0);var n=e.slice(0),o=r.validityCheckDate;typeof o>"u"&&(o=new Date);var s=!0,a=null,c=0;do{var u=e.shift(),l=null,d=!1;if(o&&(o<u.validity.notBefore||o>u.validity.notAfter)&&(a={message:"Certificate is not valid yet or has expired.",error:qe.certificateError.certificate_expired,notBefore:u.validity.notBefore,notAfter:u.validity.notAfter,now:o}),a===null){if(l=e[0]||t.getIssuer(u),l===null&&u.isIssuer(u)&&(d=!0,l=u),l){var p=l;bt.util.isArray(p)||(p=[p]);for(var f=!1;!f&&p.length>0;){l=p.shift();try{f=l.verify(u)}catch{}}f||(a={message:"Certificate signature is invalid.",error:qe.certificateError.bad_certificate})}a===null&&(!l||d)&&!t.hasCertificate(u)&&(a={message:"Certificate is not trusted.",error:qe.certificateError.unknown_ca})}if(a===null&&l&&!u.isIssuer(l)&&(a={message:"Certificate issuer is invalid.",error:qe.certificateError.bad_certificate}),a===null)for(var m={keyUsage:!0,basicConstraints:!0},h=0;a===null&&h<u.extensions.length;++h){var g=u.extensions[h];g.critical&&!(g.name in m)&&(a={message:"Certificate has an unsupported critical extension.",error:qe.certificateError.unsupported_certificate})}if(a===null&&(!s||e.length===0&&(!l||d))){var v=u.getExtension("basicConstraints"),y=u.getExtension("keyUsage");if(y!==null&&(!y.keyCertSign||v===null)&&(a={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:qe.certificateError.bad_certificate}),a===null&&v!==null&&!v.cA&&(a={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:qe.certificateError.bad_certificate}),a===null&&y!==null&&"pathLenConstraint"in v){var _=c-1;_>v.pathLenConstraint&&(a={message:"Certificate basicConstraints pathLenConstraint violated.",error:qe.certificateError.bad_certificate})}}var b=a===null?!0:a.error,S=r.verify?r.verify(b,c,n):b;if(S===!0)a=null;else throw b===!0&&(a={message:"The application rejected the certificate.",error:qe.certificateError.bad_certificate}),(S||S===0)&&(typeof S=="object"&&!bt.util.isArray(S)?(S.message&&(a.message=S.message),S.error&&(a.error=S.error)):typeof S=="string"&&(a.error=S)),a;s=!1,++c}while(e.length>0);return!0}});var kee=L((s5r,H2e)=>{var kn=tr();Ll();kT();Wv();Tee();Cee();Mu();SA();NT();Or();B9();var j=kn.asn1,pr=kn.pki,CA=H2e.exports=kn.pkcs12=kn.pkcs12||{},q2e={name:"ContentInfo",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:j.Class.UNIVERSAL,type:j.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:j.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},uot={name:"PFX",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:j.Class.UNIVERSAL,type:j.Type.INTEGER,constructed:!1,capture:"version"},q2e,{name:"PFX.macData",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:j.Class.UNIVERSAL,type:j.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:j.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:j.Class.UNIVERSAL,type:j.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:j.Class.UNIVERSAL,type:j.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:j.Class.UNIVERSAL,type:j.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},lot={name:"SafeBag",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:j.Class.UNIVERSAL,type:j.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:j.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:j.Class.UNIVERSAL,type:j.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},dot={name:"Attribute",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:j.Class.UNIVERSAL,type:j.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:j.Class.UNIVERSAL,type:j.Type.SET,constructed:!0,capture:"values"}]},pot={name:"CertBag",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:j.Class.UNIVERSAL,type:j.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:j.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:j.Class.UNIVERSAL,type:j.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function IA(t,e,r,n){for(var o=[],s=0;s<t.length;s++)for(var a=0;a<t[s].safeBags.length;a++){var c=t[s].safeBags[a];if(!(n!==void 0&&c.type!==n)){if(e===null){o.push(c);continue}c.attributes[e]!==void 0&&c.attributes[e].indexOf(r)>=0&&o.push(c)}}return o}CA.pkcs12FromAsn1=function(t,e,r){typeof e=="string"?(r=e,e=!0):e===void 0&&(e=!0);var n={},o=[];if(!j.validate(t,uot,n,o)){var s=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw s.errors=s,s}var a={version:n.version.charCodeAt(0),safeContents:[],getBags:function(v){var y={},_;return"localKeyId"in v?_=v.localKeyId:"localKeyIdHex"in v&&(_=kn.util.hexToBytes(v.localKeyIdHex)),_===void 0&&!("friendlyName"in v)&&"bagType"in v&&(y[v.bagType]=IA(a.safeContents,null,null,v.bagType)),_!==void 0&&(y.localKeyId=IA(a.safeContents,"localKeyId",_,v.bagType)),"friendlyName"in v&&(y.friendlyName=IA(a.safeContents,"friendlyName",v.friendlyName,v.bagType)),y},getBagsByFriendlyName:function(v,y){return IA(a.safeContents,"friendlyName",v,y)},getBagsByLocalKeyId:function(v,y){return IA(a.safeContents,"localKeyId",v,y)}};if(n.version.charCodeAt(0)!==3){var s=new Error("PKCS#12 PFX of version other than 3 not supported.");throw s.version=n.version.charCodeAt(0),s}if(j.derToOid(n.contentType)!==pr.oids.data){var s=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw s.oid=j.derToOid(n.contentType),s}var c=n.content.value[0];if(c.tagClass!==j.Class.UNIVERSAL||c.type!==j.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(c=Ree(c),n.mac){var u=null,l=0,d=j.derToOid(n.macAlgorithm);switch(d){case pr.oids.sha1:u=kn.md.sha1.create(),l=20;break;case pr.oids.sha256:u=kn.md.sha256.create(),l=32;break;case pr.oids.sha384:u=kn.md.sha384.create(),l=48;break;case pr.oids.sha512:u=kn.md.sha512.create(),l=64;break;case pr.oids.md5:u=kn.md.md5.create(),l=16;break}if(u===null)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+d);var p=new kn.util.ByteBuffer(n.macSalt),f="macIterations"in n?parseInt(kn.util.bytesToHex(n.macIterations),16):1,m=CA.generateKey(r,p,3,f,l,u),h=kn.hmac.create();h.start(u,m),h.update(c.value);var g=h.getMac();if(g.getBytes()!==n.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return fot(a,c.value,e,r),a};function Ree(t){if(t.composed||t.constructed){for(var e=kn.util.createBuffer(),r=0;r<t.value.length;++r)e.putBytes(t.value[r].value);t.composed=t.constructed=!1,t.value=e.getBytes()}return t}function fot(t,e,r,n){if(e=j.fromDer(e,r),e.tagClass!==j.Class.UNIVERSAL||e.type!==j.Type.SEQUENCE||e.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var o=0;o<e.value.length;o++){var s=e.value[o],a={},c=[];if(!j.validate(s,q2e,a,c)){var u=new Error("Cannot read ContentInfo.");throw u.errors=c,u}var l={encrypted:!1},d=null,p=a.content.value[0];switch(j.derToOid(a.contentType)){case pr.oids.data:if(p.tagClass!==j.Class.UNIVERSAL||p.type!==j.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");d=Ree(p).value;break;case pr.oids.encryptedData:d=mot(p,n),l.encrypted=!0;break;default:var u=new Error("Unsupported PKCS#12 contentType.");throw u.contentType=j.derToOid(a.contentType),u}l.safeBags=hot(d,r,n),t.safeContents.push(l)}}function mot(t,e){var r={},n=[];if(!j.validate(t,kn.pkcs7.asn1.encryptedDataValidator,r,n)){var o=new Error("Cannot read EncryptedContentInfo.");throw o.errors=n,o}var s=j.derToOid(r.contentType);if(s!==pr.oids.data){var o=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw o.oid=s,o}s=j.derToOid(r.encAlgorithm);var a=pr.pbe.getCipher(s,r.encParameter,e),c=Ree(r.encryptedContentAsn1),u=kn.util.createBuffer(c.value);if(a.update(u),!a.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return a.output.getBytes()}function hot(t,e,r){if(!e&&t.length===0)return[];if(t=j.fromDer(t,e),t.tagClass!==j.Class.UNIVERSAL||t.type!==j.Type.SEQUENCE||t.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var n=[],o=0;o<t.value.length;o++){var s=t.value[o],a={},c=[];if(!j.validate(s,lot,a,c)){var u=new Error("Cannot read SafeBag.");throw u.errors=c,u}var l={type:j.derToOid(a.bagId),attributes:got(a.bagAttributes)};n.push(l);var d,p,f=a.bagValue.value[0];switch(l.type){case pr.oids.pkcs8ShroudedKeyBag:if(f=pr.decryptPrivateKeyInfo(f,r),f===null)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case pr.oids.keyBag:try{l.key=pr.privateKeyFromAsn1(f)}catch{l.key=null,l.asn1=f}continue;case pr.oids.certBag:d=pot,p=function(){if(j.derToOid(a.certId)!==pr.oids.x509Certificate){var h=new Error("Unsupported certificate type, only X.509 supported.");throw h.oid=j.derToOid(a.certId),h}var g=j.fromDer(a.cert,e);try{l.cert=pr.certificateFromAsn1(g,!0)}catch{l.cert=null,l.asn1=g}};break;default:var u=new Error("Unsupported PKCS#12 SafeBag type.");throw u.oid=l.type,u}if(d!==void 0&&!j.validate(f,d,a,c)){var u=new Error("Cannot read PKCS#12 "+d.name);throw u.errors=c,u}p()}return n}function got(t){var e={};if(t!==void 0)for(var r=0;r<t.length;++r){var n={},o=[];if(!j.validate(t[r],dot,n,o)){var s=new Error("Cannot read PKCS#12 BagAttribute.");throw s.errors=o,s}var a=j.derToOid(n.oid);if(pr.oids[a]!==void 0){e[pr.oids[a]]=[];for(var c=0;c<n.values.length;++c)e[pr.oids[a]].push(n.values[c].value)}}return e}CA.toPkcs12Asn1=function(t,e,r,n){n=n||{},n.saltSize=n.saltSize||8,n.count=n.count||2048,n.algorithm=n.algorithm||n.encAlgorithm||"aes128","useMac"in n||(n.useMac=!0),"localKeyId"in n||(n.localKeyId=null),"generateLocalKeyId"in n||(n.generateLocalKeyId=!0);var o=n.localKeyId,s;if(o!==null)o=kn.util.hexToBytes(o);else if(n.generateLocalKeyId)if(e){var a=kn.util.isArray(e)?e[0]:e;typeof a=="string"&&(a=pr.certificateFromPem(a));var c=kn.md.sha1.create();c.update(j.toDer(pr.certificateToAsn1(a)).getBytes()),o=c.digest().getBytes()}else o=kn.random.getBytes(20);var u=[];o!==null&&u.push(j.create(j.Class.UNIVERSAL,j.Type.SEQUENCE,!0,[j.create(j.Class.UNIVERSAL,j.Type.OID,!1,j.oidToDer(pr.oids.localKeyId).getBytes()),j.create(j.Class.UNIVERSAL,j.Type.SET,!0,[j.create(j.Class.UNIVERSAL,j.Type.OCTETSTRING,!1,o)])])),"friendlyName"in n&&u.push(j.create(j.Class.UNIVERSAL,j.Type.SEQUENCE,!0,[j.create(j.Class.UNIVERSAL,j.Type.OID,!1,j.oidToDer(pr.oids.friendlyName).getBytes()),j.create(j.Class.UNIVERSAL,j.Type.SET,!0,[j.create(j.Class.UNIVERSAL,j.Type.BMPSTRING,!1,n.friendlyName)])])),u.length>0&&(s=j.create(j.Class.UNIVERSAL,j.Type.SET,!0,u));var l=[],d=[];e!==null&&(kn.util.isArray(e)?d=e:d=[e]);for(var p=[],f=0;f<d.length;++f){e=d[f],typeof e=="string"&&(e=pr.certificateFromPem(e));var m=f===0?s:void 0,h=pr.certificateToAsn1(e),g=j.create(j.Class.UNIVERSAL,j.Type.SEQUENCE,!0,[j.create(j.Class.UNIVERSAL,j.Type.OID,!1,j.oidToDer(pr.oids.certBag).getBytes()),j.create(j.Class.CONTEXT_SPECIFIC,0,!0,[j.create(j.Class.UNIVERSAL,j.Type.SEQUENCE,!0,[j.create(j.Class.UNIVERSAL,j.Type.OID,!1,j.oidToDer(pr.oids.x509Certificate).getBytes()),j.create(j.Class.CONTEXT_SPECIFIC,0,!0,[j.create(j.Class.UNIVERSAL,j.Type.OCTETSTRING,!1,j.toDer(h).getBytes())])])]),m]);p.push(g)}if(p.length>0){var v=j.create(j.Class.UNIVERSAL,j.Type.SEQUENCE,!0,p),y=j.create(j.Class.UNIVERSAL,j.Type.SEQUENCE,!0,[j.create(j.Class.UNIVERSAL,j.Type.OID,!1,j.oidToDer(pr.oids.data).getBytes()),j.create(j.Class.CONTEXT_SPECIFIC,0,!0,[j.create(j.Class.UNIVERSAL,j.Type.OCTETSTRING,!1,j.toDer(v).getBytes())])]);l.push(y)}var _=null;if(t!==null){var b=pr.wrapRsaPrivateKey(pr.privateKeyToAsn1(t));r===null?_=j.create(j.Class.UNIVERSAL,j.Type.SEQUENCE,!0,[j.create(j.Class.UNIVERSAL,j.Type.OID,!1,j.oidToDer(pr.oids.keyBag).getBytes()),j.create(j.Class.CONTEXT_SPECIFIC,0,!0,[b]),s]):_=j.create(j.Class.UNIVERSAL,j.Type.SEQUENCE,!0,[j.create(j.Class.UNIVERSAL,j.Type.OID,!1,j.oidToDer(pr.oids.pkcs8ShroudedKeyBag).getBytes()),j.create(j.Class.CONTEXT_SPECIFIC,0,!0,[pr.encryptPrivateKeyInfo(b,r,n)]),s]);var S=j.create(j.Class.UNIVERSAL,j.Type.SEQUENCE,!0,[_]),I=j.create(j.Class.UNIVERSAL,j.Type.SEQUENCE,!0,[j.create(j.Class.UNIVERSAL,j.Type.OID,!1,j.oidToDer(pr.oids.data).getBytes()),j.create(j.Class.CONTEXT_SPECIFIC,0,!0,[j.create(j.Class.UNIVERSAL,j.Type.OCTETSTRING,!1,j.toDer(S).getBytes())])]);l.push(I)}var w=j.create(j.Class.UNIVERSAL,j.Type.SEQUENCE,!0,l),O;if(n.useMac){var c=kn.md.sha1.create(),U=new kn.util.ByteBuffer(kn.random.getBytes(n.saltSize)),z=n.count,t=CA.generateKey(r,U,3,z,20),M=kn.hmac.create();M.start(c,t),M.update(j.toDer(w).getBytes());var re=M.getMac();O=j.create(j.Class.UNIVERSAL,j.Type.SEQUENCE,!0,[j.create(j.Class.UNIVERSAL,j.Type.SEQUENCE,!0,[j.create(j.Class.UNIVERSAL,j.Type.SEQUENCE,!0,[j.create(j.Class.UNIVERSAL,j.Type.OID,!1,j.oidToDer(pr.oids.sha1).getBytes()),j.create(j.Class.UNIVERSAL,j.Type.NULL,!1,"")]),j.create(j.Class.UNIVERSAL,j.Type.OCTETSTRING,!1,re.getBytes())]),j.create(j.Class.UNIVERSAL,j.Type.OCTETSTRING,!1,U.getBytes()),j.create(j.Class.UNIVERSAL,j.Type.INTEGER,!1,j.integerToDer(z).getBytes())])}return j.create(j.Class.UNIVERSAL,j.Type.SEQUENCE,!0,[j.create(j.Class.UNIVERSAL,j.Type.INTEGER,!1,j.integerToDer(3).getBytes()),j.create(j.Class.UNIVERSAL,j.Type.SEQUENCE,!0,[j.create(j.Class.UNIVERSAL,j.Type.OID,!1,j.oidToDer(pr.oids.data).getBytes()),j.create(j.Class.CONTEXT_SPECIFIC,0,!0,[j.create(j.Class.UNIVERSAL,j.Type.OCTETSTRING,!1,j.toDer(w).getBytes())])]),O])};CA.generateKey=kn.pbe.generatePkcs12Key});var Pee=L((a5r,j2e)=>{var Xv=tr();Ll();Wv();Cee();Xb();k9();kee();M9();SA();Or();B9();var Aee=Xv.asn1,FT=j2e.exports=Xv.pki=Xv.pki||{};FT.pemToDer=function(t){var e=Xv.pem.decode(t)[0];if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert PEM to DER; PEM is encrypted.");return Xv.util.createBuffer(e.body)};FT.privateKeyFromPem=function(t){var e=Xv.pem.decode(t)[0];if(e.type!=="PRIVATE KEY"&&e.type!=="RSA PRIVATE KEY"){var r=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert private key from PEM; PEM is encrypted.");var n=Aee.fromDer(e.body);return FT.privateKeyFromAsn1(n)};FT.privateKeyToPem=function(t,e){var r={type:"RSA PRIVATE KEY",body:Aee.toDer(FT.privateKeyToAsn1(t)).getBytes()};return Xv.pem.encode(r,{maxline:e})};FT.privateKeyInfoToPem=function(t,e){var r={type:"PRIVATE KEY",body:Aee.toDer(t).getBytes()};return Xv.pem.encode(r,{maxline:e})}});var Fee=L((c5r,Q2e)=>{var Se=tr();Ll();kT();T9();Xb();Pee();Mu();NT();Or();var z9=function(t,e,r,n){var o=Se.util.createBuffer(),s=t.length>>1,a=s+(t.length&1),c=t.substr(0,a),u=t.substr(s,a),l=Se.util.createBuffer(),d=Se.hmac.create();r=e+r;var p=Math.ceil(n/16),f=Math.ceil(n/20);d.start("MD5",c);var m=Se.util.createBuffer();l.putBytes(r);for(var h=0;h<p;++h)d.start(null,null),d.update(l.getBytes()),l.putBuffer(d.digest()),d.start(null,null),d.update(l.bytes()+r),m.putBuffer(d.digest());d.start("SHA1",u);var g=Se.util.createBuffer();l.clear(),l.putBytes(r);for(var h=0;h<f;++h)d.start(null,null),d.update(l.getBytes()),l.putBuffer(d.digest()),d.start(null,null),d.update(l.bytes()+r),g.putBuffer(d.digest());return o.putBytes(Se.util.xorBytes(m.getBytes(),g.getBytes(),n)),o},vot=function(t,e,r){var n=Se.hmac.create();n.start("SHA1",t);var o=Se.util.createBuffer();return o.putInt32(e[0]),o.putInt32(e[1]),o.putByte(r.type),o.putByte(r.version.major),o.putByte(r.version.minor),o.putInt16(r.length),o.putBytes(r.fragment.bytes()),n.update(o.getBytes()),n.digest().getBytes()},yot=function(t,e,r){var n=!1;try{var o=t.deflate(e.fragment.getBytes());e.fragment=Se.util.createBuffer(o),e.length=o.length,n=!0}catch{}return n},bot=function(t,e,r){var n=!1;try{var o=t.inflate(e.fragment.getBytes());e.fragment=Se.util.createBuffer(o),e.length=o.length,n=!0}catch{}return n},Mc=function(t,e){var r=0;switch(e){case 1:r=t.getByte();break;case 2:r=t.getInt16();break;case 3:r=t.getInt24();break;case 4:r=t.getInt32();break}return Se.util.createBuffer(t.getBytes(r))},qu=function(t,e,r){t.putInt(r.length(),e<<3),t.putBuffer(r)},D={};D.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}};D.SupportedVersions=[D.Versions.TLS_1_1,D.Versions.TLS_1_0];D.Version=D.SupportedVersions[0];D.MaxFragment=15360;D.ConnectionEnd={server:0,client:1};D.PRFAlgorithm={tls_prf_sha256:0};D.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2};D.CipherType={stream:0,block:1,aead:2};D.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4};D.CompressionMethod={none:0,deflate:1};D.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24};D.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20};D.Alert={};D.Alert.Level={warning:1,fatal:2};D.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100};D.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2};D.CipherSuites={};D.getCipherSuite=function(t){var e=null;for(var r in D.CipherSuites){var n=D.CipherSuites[r];if(n.id[0]===t.charCodeAt(0)&&n.id[1]===t.charCodeAt(1)){e=n;break}}return e};D.handleUnexpected=function(t,e){var r=!t.open&&t.entity===D.ConnectionEnd.client;r||t.error(t,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:D.Alert.Level.fatal,description:D.Alert.Description.unexpected_message}})};D.handleHelloRequest=function(t,e,r){!t.handshaking&&t.handshakes>0&&(D.queue(t,D.createAlert(t,{level:D.Alert.Level.warning,description:D.Alert.Description.no_renegotiation})),D.flush(t)),t.process()};D.parseHelloMessage=function(t,e,r){var n=null,o=t.entity===D.ConnectionEnd.client;if(r<38)t.error(t,{message:o?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:D.Alert.Level.fatal,description:D.Alert.Description.illegal_parameter}});else{var s=e.fragment,a=s.length();if(n={version:{major:s.getByte(),minor:s.getByte()},random:Se.util.createBuffer(s.getBytes(32)),session_id:Mc(s,1),extensions:[]},o?(n.cipher_suite=s.getBytes(2),n.compression_method=s.getByte()):(n.cipher_suites=Mc(s,2),n.compression_methods=Mc(s,1)),a=r-(a-s.length()),a>0){for(var c=Mc(s,2);c.length()>0;)n.extensions.push({type:[c.getByte(),c.getByte()],data:Mc(c,2)});if(!o)for(var u=0;u<n.extensions.length;++u){var l=n.extensions[u];if(l.type[0]===0&&l.type[1]===0)for(var d=Mc(l.data,2);d.length()>0;){var p=d.getByte();if(p!==0)break;t.session.extensions.server_name.serverNameList.push(Mc(d,2).getBytes())}}}if(t.session.version&&(n.version.major!==t.session.version.major||n.version.minor!==t.session.version.minor))return t.error(t,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:D.Alert.Level.fatal,description:D.Alert.Description.protocol_version}});if(o)t.session.cipherSuite=D.getCipherSuite(n.cipher_suite);else for(var f=Se.util.createBuffer(n.cipher_suites.bytes());f.length()>0&&(t.session.cipherSuite=D.getCipherSuite(f.getBytes(2)),t.session.cipherSuite===null););if(t.session.cipherSuite===null)return t.error(t,{message:"No cipher suites in common.",send:!0,alert:{level:D.Alert.Level.fatal,description:D.Alert.Description.handshake_failure},cipherSuite:Se.util.bytesToHex(n.cipher_suite)});o?t.session.compressionMethod=n.compression_method:t.session.compressionMethod=D.CompressionMethod.none}return n};D.createSecurityParameters=function(t,e){var r=t.entity===D.ConnectionEnd.client,n=e.random.bytes(),o=r?t.session.sp.client_random:n,s=r?n:D.createRandom().getBytes();t.session.sp={entity:t.entity,prf_algorithm:D.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:t.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:o,server_random:s}};D.handleServerHello=function(t,e,r){var n=D.parseHelloMessage(t,e,r);if(!t.fail){if(n.version.minor<=t.version.minor)t.version.minor=n.version.minor;else return t.error(t,{message:"Incompatible TLS version.",send:!0,alert:{level:D.Alert.Level.fatal,description:D.Alert.Description.protocol_version}});t.session.version=t.version;var o=n.session_id.bytes();o.length>0&&o===t.session.id?(t.expect=V2e,t.session.resuming=!0,t.session.sp.server_random=n.random.bytes()):(t.expect=xot,t.session.resuming=!1,D.createSecurityParameters(t,n)),t.session.id=o,t.process()}};D.handleClientHello=function(t,e,r){var n=D.parseHelloMessage(t,e,r);if(!t.fail){var o=n.session_id.bytes(),s=null;if(t.sessionCache&&(s=t.sessionCache.getSession(o),s===null?o="":(s.version.major!==n.version.major||s.version.minor>n.version.minor)&&(s=null,o="")),o.length===0&&(o=Se.random.getBytes(32)),t.session.id=o,t.session.clientHelloVersion=n.version,t.session.sp={},s)t.version=t.session.version=s.version,t.session.sp=s.sp;else{for(var a,c=1;c<D.SupportedVersions.length&&(a=D.SupportedVersions[c],!(a.minor<=n.version.minor));++c);t.version={major:a.major,minor:a.minor},t.session.version=t.version}s!==null?(t.expect=Oee,t.session.resuming=!0,t.session.sp.client_random=n.random.bytes()):(t.expect=t.verifyClient!==!1?Rot:Lee,t.session.resuming=!1,D.createSecurityParameters(t,n)),t.open=!0,D.queue(t,D.createRecord(t,{type:D.ContentType.handshake,data:D.createServerHello(t)})),t.session.resuming?(D.queue(t,D.createRecord(t,{type:D.ContentType.change_cipher_spec,data:D.createChangeCipherSpec()})),t.state.pending=D.createConnectionState(t),t.state.current.write=t.state.pending.write,D.queue(t,D.createRecord(t,{type:D.ContentType.handshake,data:D.createFinished(t)}))):(D.queue(t,D.createRecord(t,{type:D.ContentType.handshake,data:D.createCertificate(t)})),t.fail||(D.queue(t,D.createRecord(t,{type:D.ContentType.handshake,data:D.createServerKeyExchange(t)})),t.verifyClient!==!1&&D.queue(t,D.createRecord(t,{type:D.ContentType.handshake,data:D.createCertificateRequest(t)})),D.queue(t,D.createRecord(t,{type:D.ContentType.handshake,data:D.createServerHelloDone(t)})))),D.flush(t),t.process()}};D.handleCertificate=function(t,e,r){if(r<3)return t.error(t,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:D.Alert.Level.fatal,description:D.Alert.Description.illegal_parameter}});var n=e.fragment,o={certificate_list:Mc(n,3)},s,a,c=[];try{for(;o.certificate_list.length()>0;)s=Mc(o.certificate_list,3),a=Se.asn1.fromDer(s),s=Se.pki.certificateFromAsn1(a,!0),c.push(s)}catch(l){return t.error(t,{message:"Could not parse certificate list.",cause:l,send:!0,alert:{level:D.Alert.Level.fatal,description:D.Alert.Description.bad_certificate}})}var u=t.entity===D.ConnectionEnd.client;(u||t.verifyClient===!0)&&c.length===0?t.error(t,{message:u?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:D.Alert.Level.fatal,description:D.Alert.Description.illegal_parameter}}):c.length===0?t.expect=u?z2e:Lee:(u?t.session.serverCertificate=c[0]:t.session.clientCertificate=c[0],D.verifyCertificateChain(t,c)&&(t.expect=u?z2e:Lee)),t.process()};D.handleServerKeyExchange=function(t,e,r){if(r>0)return t.error(t,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:D.Alert.Level.fatal,description:D.Alert.Description.unsupported_certificate}});t.expect=Sot,t.process()};D.handleClientKeyExchange=function(t,e,r){if(r<48)return t.error(t,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:D.Alert.Level.fatal,description:D.Alert.Description.unsupported_certificate}});var n=e.fragment,o={enc_pre_master_secret:Mc(n,2).getBytes()},s=null;if(t.getPrivateKey)try{s=t.getPrivateKey(t,t.session.serverCertificate),s=Se.pki.privateKeyFromPem(s)}catch(u){t.error(t,{message:"Could not get private key.",cause:u,send:!0,alert:{level:D.Alert.Level.fatal,description:D.Alert.Description.internal_error}})}if(s===null)return t.error(t,{message:"No private key set.",send:!0,alert:{level:D.Alert.Level.fatal,description:D.Alert.Description.internal_error}});try{var a=t.session.sp;a.pre_master_secret=s.decrypt(o.enc_pre_master_secret);var c=t.session.clientHelloVersion;if(c.major!==a.pre_master_secret.charCodeAt(0)||c.minor!==a.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch{a.pre_master_secret=Se.random.getBytes(48)}t.expect=Oee,t.session.clientCertificate!==null&&(t.expect=kot),t.process()};D.handleCertificateRequest=function(t,e,r){if(r<3)return t.error(t,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:D.Alert.Level.fatal,description:D.Alert.Description.illegal_parameter}});var n=e.fragment,o={certificate_types:Mc(n,1),certificate_authorities:Mc(n,2)};t.session.certificateRequest=o,t.expect=Iot,t.process()};D.handleCertificateVerify=function(t,e,r){if(r<2)return t.error(t,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:D.Alert.Level.fatal,description:D.Alert.Description.illegal_parameter}});var n=e.fragment;n.read-=4;var o=n.bytes();n.read+=4;var s={signature:Mc(n,2).getBytes()},a=Se.util.createBuffer();a.putBuffer(t.session.md5.digest()),a.putBuffer(t.session.sha1.digest()),a=a.getBytes();try{var c=t.session.clientCertificate;if(!c.publicKey.verify(a,s.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");t.session.md5.update(o),t.session.sha1.update(o)}catch{return t.error(t,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:D.Alert.Level.fatal,description:D.Alert.Description.handshake_failure}})}t.expect=Oee,t.process()};D.handleServerHelloDone=function(t,e,r){if(r>0)return t.error(t,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:D.Alert.Level.fatal,description:D.Alert.Description.record_overflow}});if(t.serverCertificate===null){var n={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:D.Alert.Level.fatal,description:D.Alert.Description.insufficient_security}},o=0,s=t.verify(t,n.alert.description,o,[]);if(s!==!0)return(s||s===0)&&(typeof s=="object"&&!Se.util.isArray(s)?(s.message&&(n.message=s.message),s.alert&&(n.alert.description=s.alert)):typeof s=="number"&&(n.alert.description=s)),t.error(t,n)}t.session.certificateRequest!==null&&(e=D.createRecord(t,{type:D.ContentType.handshake,data:D.createCertificate(t)}),D.queue(t,e)),e=D.createRecord(t,{type:D.ContentType.handshake,data:D.createClientKeyExchange(t)}),D.queue(t,e),t.expect=Eot;var a=function(c,u){c.session.certificateRequest!==null&&c.session.clientCertificate!==null&&D.queue(c,D.createRecord(c,{type:D.ContentType.handshake,data:D.createCertificateVerify(c,u)})),D.queue(c,D.createRecord(c,{type:D.ContentType.change_cipher_spec,data:D.createChangeCipherSpec()})),c.state.pending=D.createConnectionState(c),c.state.current.write=c.state.pending.write,D.queue(c,D.createRecord(c,{type:D.ContentType.handshake,data:D.createFinished(c)})),c.expect=V2e,D.flush(c),c.process()};if(t.session.certificateRequest===null||t.session.clientCertificate===null)return a(t,null);D.getClientSignature(t,a)};D.handleChangeCipherSpec=function(t,e){if(e.fragment.getByte()!==1)return t.error(t,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:D.Alert.Level.fatal,description:D.Alert.Description.illegal_parameter}});var r=t.entity===D.ConnectionEnd.client;(t.session.resuming&&r||!t.session.resuming&&!r)&&(t.state.pending=D.createConnectionState(t)),t.state.current.read=t.state.pending.read,(!t.session.resuming&&r||t.session.resuming&&!r)&&(t.state.pending=null),t.expect=r?Cot:Aot,t.process()};D.handleFinished=function(t,e,r){var n=e.fragment;n.read-=4;var o=n.bytes();n.read+=4;var s=e.fragment.getBytes();n=Se.util.createBuffer(),n.putBuffer(t.session.md5.digest()),n.putBuffer(t.session.sha1.digest());var a=t.entity===D.ConnectionEnd.client,c=a?"server finished":"client finished",u=t.session.sp,l=12,d=z9;if(n=d(u.master_secret,c,n.getBytes(),l),n.getBytes()!==s)return t.error(t,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:D.Alert.Level.fatal,description:D.Alert.Description.decrypt_error}});t.session.md5.update(o),t.session.sha1.update(o),(t.session.resuming&&a||!t.session.resuming&&!a)&&(D.queue(t,D.createRecord(t,{type:D.ContentType.change_cipher_spec,data:D.createChangeCipherSpec()})),t.state.current.write=t.state.pending.write,t.state.pending=null,D.queue(t,D.createRecord(t,{type:D.ContentType.handshake,data:D.createFinished(t)}))),t.expect=a?Tot:Pot,t.handshaking=!1,++t.handshakes,t.peerCertificate=a?t.session.serverCertificate:t.session.clientCertificate,D.flush(t),t.isConnected=!0,t.connected(t),t.process()};D.handleAlert=function(t,e){var r=e.fragment,n={level:r.getByte(),description:r.getByte()},o;switch(n.description){case D.Alert.Description.close_notify:o="Connection closed.";break;case D.Alert.Description.unexpected_message:o="Unexpected message.";break;case D.Alert.Description.bad_record_mac:o="Bad record MAC.";break;case D.Alert.Description.decryption_failed:o="Decryption failed.";break;case D.Alert.Description.record_overflow:o="Record overflow.";break;case D.Alert.Description.decompression_failure:o="Decompression failed.";break;case D.Alert.Description.handshake_failure:o="Handshake failure.";break;case D.Alert.Description.bad_certificate:o="Bad certificate.";break;case D.Alert.Description.unsupported_certificate:o="Unsupported certificate.";break;case D.Alert.Description.certificate_revoked:o="Certificate revoked.";break;case D.Alert.Description.certificate_expired:o="Certificate expired.";break;case D.Alert.Description.certificate_unknown:o="Certificate unknown.";break;case D.Alert.Description.illegal_parameter:o="Illegal parameter.";break;case D.Alert.Description.unknown_ca:o="Unknown certificate authority.";break;case D.Alert.Description.access_denied:o="Access denied.";break;case D.Alert.Description.decode_error:o="Decode error.";break;case D.Alert.Description.decrypt_error:o="Decrypt error.";break;case D.Alert.Description.export_restriction:o="Export restriction.";break;case D.Alert.Description.protocol_version:o="Unsupported protocol version.";break;case D.Alert.Description.insufficient_security:o="Insufficient security.";break;case D.Alert.Description.internal_error:o="Internal error.";break;case D.Alert.Description.user_canceled:o="User canceled.";break;case D.Alert.Description.no_renegotiation:o="Renegotiation not supported.";break;default:o="Unknown error.";break}if(n.description===D.Alert.Description.close_notify)return t.close();t.error(t,{message:o,send:!1,origin:t.entity===D.ConnectionEnd.client?"server":"client",alert:n}),t.process()};D.handleHandshake=function(t,e){var r=e.fragment,n=r.getByte(),o=r.getInt24();if(o>r.length())return t.fragmented=e,e.fragment=Se.util.createBuffer(),r.read-=4,t.process();t.fragmented=null,r.read-=4;var s=r.bytes(o+4);r.read+=4,n in j9[t.entity][t.expect]?(t.entity===D.ConnectionEnd.server&&!t.open&&!t.fail&&(t.handshaking=!0,t.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:Se.md.md5.create(),sha1:Se.md.sha1.create()}),n!==D.HandshakeType.hello_request&&n!==D.HandshakeType.certificate_verify&&n!==D.HandshakeType.finished&&(t.session.md5.update(s),t.session.sha1.update(s)),j9[t.entity][t.expect][n](t,e,o)):D.handleUnexpected(t,e)};D.handleApplicationData=function(t,e){t.data.putBuffer(e.fragment),t.dataReady(t),t.process()};D.handleHeartbeat=function(t,e){var r=e.fragment,n=r.getByte(),o=r.getInt16(),s=r.getBytes(o);if(n===D.HeartbeatMessageType.heartbeat_request){if(t.handshaking||o>s.length)return t.process();D.queue(t,D.createRecord(t,{type:D.ContentType.heartbeat,data:D.createHeartbeat(D.HeartbeatMessageType.heartbeat_response,s)})),D.flush(t)}else if(n===D.HeartbeatMessageType.heartbeat_response){if(s!==t.expectedHeartbeatPayload)return t.process();t.heartbeatReceived&&t.heartbeatReceived(t,Se.util.createBuffer(s))}t.process()};var _ot=0,xot=1,z2e=2,Sot=3,Iot=4,V2e=5,Cot=6,Tot=7,Eot=8,wot=0,Rot=1,Lee=2,kot=3,Oee=4,Aot=5,Pot=6,A=D.handleUnexpected,$2e=D.handleChangeCipherSpec,Es=D.handleAlert,Sa=D.handleHandshake,W2e=D.handleApplicationData,ws=D.handleHeartbeat,Mee=[];Mee[D.ConnectionEnd.client]=[[A,Es,Sa,A,ws],[A,Es,Sa,A,ws],[A,Es,Sa,A,ws],[A,Es,Sa,A,ws],[A,Es,Sa,A,ws],[$2e,Es,A,A,ws],[A,Es,Sa,A,ws],[A,Es,Sa,W2e,ws],[A,Es,Sa,A,ws]];Mee[D.ConnectionEnd.server]=[[A,Es,Sa,A,ws],[A,Es,Sa,A,ws],[A,Es,Sa,A,ws],[A,Es,Sa,A,ws],[$2e,Es,A,A,ws],[A,Es,Sa,A,ws],[A,Es,Sa,W2e,ws],[A,Es,Sa,A,ws]];var Jv=D.handleHelloRequest,Dot=D.handleServerHello,K2e=D.handleCertificate,G2e=D.handleServerKeyExchange,Dee=D.handleCertificateRequest,q9=D.handleServerHelloDone,Y2e=D.handleFinished,j9=[];j9[D.ConnectionEnd.client]=[[A,A,Dot,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A],[Jv,A,A,A,A,A,A,A,A,A,A,K2e,G2e,Dee,q9,A,A,A,A,A,A],[Jv,A,A,A,A,A,A,A,A,A,A,A,G2e,Dee,q9,A,A,A,A,A,A],[Jv,A,A,A,A,A,A,A,A,A,A,A,A,Dee,q9,A,A,A,A,A,A],[Jv,A,A,A,A,A,A,A,A,A,A,A,A,A,q9,A,A,A,A,A,A],[Jv,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A],[Jv,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,Y2e],[Jv,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A],[Jv,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A]];var Not=D.handleClientHello,Lot=D.handleClientKeyExchange,Oot=D.handleCertificateVerify;j9[D.ConnectionEnd.server]=[[A,Not,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A],[A,A,A,A,A,A,A,A,A,A,A,K2e,A,A,A,A,A,A,A,A,A],[A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,Lot,A,A,A,A],[A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,Oot,A,A,A,A,A],[A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A],[A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,Y2e],[A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A],[A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A]];D.generateKeys=function(t,e){var r=z9,n=e.client_random+e.server_random;t.session.resuming||(e.master_secret=r(e.pre_master_secret,"master secret",n,48).bytes(),e.pre_master_secret=null),n=e.server_random+e.client_random;var o=2*e.mac_key_length+2*e.enc_key_length,s=t.version.major===D.Versions.TLS_1_0.major&&t.version.minor===D.Versions.TLS_1_0.minor;s&&(o+=2*e.fixed_iv_length);var a=r(e.master_secret,"key expansion",n,o),c={client_write_MAC_key:a.getBytes(e.mac_key_length),server_write_MAC_key:a.getBytes(e.mac_key_length),client_write_key:a.getBytes(e.enc_key_length),server_write_key:a.getBytes(e.enc_key_length)};return s&&(c.client_write_IV=a.getBytes(e.fixed_iv_length),c.server_write_IV=a.getBytes(e.fixed_iv_length)),c};D.createConnectionState=function(t){var e=t.entity===D.ConnectionEnd.client,r=function(){var s={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(a){return!0},compressionState:null,compressFunction:function(a){return!0},updateSequenceNumber:function(){s.sequenceNumber[1]===4294967295?(s.sequenceNumber[1]=0,++s.sequenceNumber[0]):++s.sequenceNumber[1]}};return s},n={read:r(),write:r()};if(n.read.update=function(s,a){return n.read.cipherFunction(a,n.read)?n.read.compressFunction(s,a,n.read)||s.error(s,{message:"Could not decompress record.",send:!0,alert:{level:D.Alert.Level.fatal,description:D.Alert.Description.decompression_failure}}):s.error(s,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:D.Alert.Level.fatal,description:D.Alert.Description.bad_record_mac}}),!s.fail},n.write.update=function(s,a){return n.write.compressFunction(s,a,n.write)?n.write.cipherFunction(a,n.write)||s.error(s,{message:"Could not encrypt record.",send:!1,alert:{level:D.Alert.Level.fatal,description:D.Alert.Description.internal_error}}):s.error(s,{message:"Could not compress record.",send:!1,alert:{level:D.Alert.Level.fatal,description:D.Alert.Description.internal_error}}),!s.fail},t.session){var o=t.session.sp;switch(t.session.cipherSuite.initSecurityParameters(o),o.keys=D.generateKeys(t,o),n.read.macKey=e?o.keys.server_write_MAC_key:o.keys.client_write_MAC_key,n.write.macKey=e?o.keys.client_write_MAC_key:o.keys.server_write_MAC_key,t.session.cipherSuite.initConnectionState(n,t,o),o.compression_algorithm){case D.CompressionMethod.none:break;case D.CompressionMethod.deflate:n.read.compressFunction=bot,n.write.compressFunction=yot;break;default:throw new Error("Unsupported compression algorithm.")}}return n};D.createRandom=function(){var t=new Date,e=+t+t.getTimezoneOffset()*6e4,r=Se.util.createBuffer();return r.putInt32(e),r.putBytes(Se.random.getBytes(28)),r};D.createRecord=function(t,e){if(!e.data)return null;var r={type:e.type,version:{major:t.version.major,minor:t.version.minor},length:e.data.length(),fragment:e.data};return r};D.createAlert=function(t,e){var r=Se.util.createBuffer();return r.putByte(e.level),r.putByte(e.description),D.createRecord(t,{type:D.ContentType.alert,data:r})};D.createClientHello=function(t){t.session.clientHelloVersion={major:t.version.major,minor:t.version.minor};for(var e=Se.util.createBuffer(),r=0;r<t.cipherSuites.length;++r){var n=t.cipherSuites[r];e.putByte(n.id[0]),e.putByte(n.id[1])}var o=e.length(),s=Se.util.createBuffer();s.putByte(D.CompressionMethod.none);var a=s.length(),c=Se.util.createBuffer();if(t.virtualHost){var u=Se.util.createBuffer();u.putByte(0),u.putByte(0);var l=Se.util.createBuffer();l.putByte(0),qu(l,2,Se.util.createBuffer(t.virtualHost));var d=Se.util.createBuffer();qu(d,2,l),qu(u,2,d),c.putBuffer(u)}var p=c.length();p>0&&(p+=2);var f=t.session.id,m=f.length+1+2+4+28+2+o+1+a+p,h=Se.util.createBuffer();return h.putByte(D.HandshakeType.client_hello),h.putInt24(m),h.putByte(t.version.major),h.putByte(t.version.minor),h.putBytes(t.session.sp.client_random),qu(h,1,Se.util.createBuffer(f)),qu(h,2,e),qu(h,1,s),p>0&&qu(h,2,c),h};D.createServerHello=function(t){var e=t.session.id,r=e.length+1+2+4+28+2+1,n=Se.util.createBuffer();return n.putByte(D.HandshakeType.server_hello),n.putInt24(r),n.putByte(t.version.major),n.putByte(t.version.minor),n.putBytes(t.session.sp.server_random),qu(n,1,Se.util.createBuffer(e)),n.putByte(t.session.cipherSuite.id[0]),n.putByte(t.session.cipherSuite.id[1]),n.putByte(t.session.compressionMethod),n};D.createCertificate=function(t){var e=t.entity===D.ConnectionEnd.client,r=null;if(t.getCertificate){var n;e?n=t.session.certificateRequest:n=t.session.extensions.server_name.serverNameList,r=t.getCertificate(t,n)}var o=Se.util.createBuffer();if(r!==null)try{Se.util.isArray(r)||(r=[r]);for(var s=null,a=0;a<r.length;++a){var c=Se.pem.decode(r[a])[0];if(c.type!=="CERTIFICATE"&&c.type!=="X509 CERTIFICATE"&&c.type!=="TRUSTED CERTIFICATE"){var u=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw u.headerType=c.type,u}if(c.procType&&c.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var l=Se.util.createBuffer(c.body);s===null&&(s=Se.asn1.fromDer(l.bytes(),!1));var d=Se.util.createBuffer();qu(d,3,l),o.putBuffer(d)}r=Se.pki.certificateFromAsn1(s),e?t.session.clientCertificate=r:t.session.serverCertificate=r}catch(m){return t.error(t,{message:"Could not send certificate list.",cause:m,send:!0,alert:{level:D.Alert.Level.fatal,description:D.Alert.Description.bad_certificate}})}var p=3+o.length(),f=Se.util.createBuffer();return f.putByte(D.HandshakeType.certificate),f.putInt24(p),qu(f,3,o),f};D.createClientKeyExchange=function(t){var e=Se.util.createBuffer();e.putByte(t.session.clientHelloVersion.major),e.putByte(t.session.clientHelloVersion.minor),e.putBytes(Se.random.getBytes(46));var r=t.session.sp;r.pre_master_secret=e.getBytes();var n=t.session.serverCertificate.publicKey;e=n.encrypt(r.pre_master_secret);var o=e.length+2,s=Se.util.createBuffer();return s.putByte(D.HandshakeType.client_key_exchange),s.putInt24(o),s.putInt16(e.length),s.putBytes(e),s};D.createServerKeyExchange=function(t){var e=0,r=Se.util.createBuffer();return e>0&&(r.putByte(D.HandshakeType.server_key_exchange),r.putInt24(e)),r};D.getClientSignature=function(t,e){var r=Se.util.createBuffer();r.putBuffer(t.session.md5.digest()),r.putBuffer(t.session.sha1.digest()),r=r.getBytes(),t.getSignature=t.getSignature||function(n,o,s){var a=null;if(n.getPrivateKey)try{a=n.getPrivateKey(n,n.session.clientCertificate),a=Se.pki.privateKeyFromPem(a)}catch(c){n.error(n,{message:"Could not get private key.",cause:c,send:!0,alert:{level:D.Alert.Level.fatal,description:D.Alert.Description.internal_error}})}a===null?n.error(n,{message:"No private key set.",send:!0,alert:{level:D.Alert.Level.fatal,description:D.Alert.Description.internal_error}}):o=a.sign(o,null),s(n,o)},t.getSignature(t,r,e)};D.createCertificateVerify=function(t,e){var r=e.length+2,n=Se.util.createBuffer();return n.putByte(D.HandshakeType.certificate_verify),n.putInt24(r),n.putInt16(e.length),n.putBytes(e),n};D.createCertificateRequest=function(t){var e=Se.util.createBuffer();e.putByte(1);var r=Se.util.createBuffer();for(var n in t.caStore.certs){var o=t.caStore.certs[n],s=Se.pki.distinguishedNameToAsn1(o.subject),a=Se.asn1.toDer(s);r.putInt16(a.length()),r.putBuffer(a)}var c=1+e.length()+2+r.length(),u=Se.util.createBuffer();return u.putByte(D.HandshakeType.certificate_request),u.putInt24(c),qu(u,1,e),qu(u,2,r),u};D.createServerHelloDone=function(t){var e=Se.util.createBuffer();return e.putByte(D.HandshakeType.server_hello_done),e.putInt24(0),e};D.createChangeCipherSpec=function(){var t=Se.util.createBuffer();return t.putByte(1),t};D.createFinished=function(t){var e=Se.util.createBuffer();e.putBuffer(t.session.md5.digest()),e.putBuffer(t.session.sha1.digest());var r=t.entity===D.ConnectionEnd.client,n=t.session.sp,o=12,s=z9,a=r?"client finished":"server finished";e=s(n.master_secret,a,e.getBytes(),o);var c=Se.util.createBuffer();return c.putByte(D.HandshakeType.finished),c.putInt24(e.length()),c.putBuffer(e),c};D.createHeartbeat=function(t,e,r){typeof r>"u"&&(r=e.length);var n=Se.util.createBuffer();n.putByte(t),n.putInt16(r),n.putBytes(e);var o=n.length(),s=Math.max(16,o-r-3);return n.putBytes(Se.random.getBytes(s)),n};D.queue=function(t,e){if(e&&!(e.fragment.length()===0&&(e.type===D.ContentType.handshake||e.type===D.ContentType.alert||e.type===D.ContentType.change_cipher_spec))){if(e.type===D.ContentType.handshake){var r=e.fragment.bytes();t.session.md5.update(r),t.session.sha1.update(r),r=null}var n;if(e.fragment.length()<=D.MaxFragment)n=[e];else{n=[];for(var o=e.fragment.bytes();o.length>D.MaxFragment;)n.push(D.createRecord(t,{type:e.type,data:Se.util.createBuffer(o.slice(0,D.MaxFragment))})),o=o.slice(D.MaxFragment);o.length>0&&n.push(D.createRecord(t,{type:e.type,data:Se.util.createBuffer(o)}))}for(var s=0;s<n.length&&!t.fail;++s){var a=n[s],c=t.state.current.write;c.update(t,a)&&t.records.push(a)}}};D.flush=function(t){for(var e=0;e<t.records.length;++e){var r=t.records[e];t.tlsData.putByte(r.type),t.tlsData.putByte(r.version.major),t.tlsData.putByte(r.version.minor),t.tlsData.putInt16(r.fragment.length()),t.tlsData.putBuffer(t.records[e].fragment)}return t.records=[],t.tlsDataReady(t)};var Nee=function(t){switch(t){case!0:return!0;case Se.pki.certificateError.bad_certificate:return D.Alert.Description.bad_certificate;case Se.pki.certificateError.unsupported_certificate:return D.Alert.Description.unsupported_certificate;case Se.pki.certificateError.certificate_revoked:return D.Alert.Description.certificate_revoked;case Se.pki.certificateError.certificate_expired:return D.Alert.Description.certificate_expired;case Se.pki.certificateError.certificate_unknown:return D.Alert.Description.certificate_unknown;case Se.pki.certificateError.unknown_ca:return D.Alert.Description.unknown_ca;default:return D.Alert.Description.bad_certificate}},Mot=function(t){switch(t){case!0:return!0;case D.Alert.Description.bad_certificate:return Se.pki.certificateError.bad_certificate;case D.Alert.Description.unsupported_certificate:return Se.pki.certificateError.unsupported_certificate;case D.Alert.Description.certificate_revoked:return Se.pki.certificateError.certificate_revoked;case D.Alert.Description.certificate_expired:return Se.pki.certificateError.certificate_expired;case D.Alert.Description.certificate_unknown:return Se.pki.certificateError.certificate_unknown;case D.Alert.Description.unknown_ca:return Se.pki.certificateError.unknown_ca;default:return Se.pki.certificateError.bad_certificate}};D.verifyCertificateChain=function(t,e){try{var r={};for(var n in t.verifyOptions)r[n]=t.verifyOptions[n];r.verify=function(s,a,c){var u=Nee(s),l=t.verify(t,s,a,c);if(l!==!0){if(typeof l=="object"&&!Se.util.isArray(l)){var d=new Error("The application rejected the certificate.");throw d.send=!0,d.alert={level:D.Alert.Level.fatal,description:D.Alert.Description.bad_certificate},l.message&&(d.message=l.message),l.alert&&(d.alert.description=l.alert),d}l!==s&&(l=Mot(l))}return l},Se.pki.verifyCertificateChain(t.caStore,e,r)}catch(s){var o=s;(typeof o!="object"||Se.util.isArray(o))&&(o={send:!0,alert:{level:D.Alert.Level.fatal,description:Nee(s)}}),"send"in o||(o.send=!0),"alert"in o||(o.alert={level:D.Alert.Level.fatal,description:Nee(o.error)}),t.error(t,o)}return!t.fail};D.createSessionCache=function(t,e){var r=null;if(t&&t.getSession&&t.setSession&&t.order)r=t;else{r={},r.cache=t||{},r.capacity=Math.max(e||100,1),r.order=[];for(var n in t)r.order.length<=e?r.order.push(n):delete t[n];r.getSession=function(o){var s=null,a=null;if(o?a=Se.util.bytesToHex(o):r.order.length>0&&(a=r.order[0]),a!==null&&a in r.cache){s=r.cache[a],delete r.cache[a];for(var c in r.order)if(r.order[c]===a){r.order.splice(c,1);break}}return s},r.setSession=function(o,s){if(r.order.length===r.capacity){var a=r.order.shift();delete r.cache[a]}var a=Se.util.bytesToHex(o);r.order.push(a),r.cache[a]=s}}return r};D.createConnection=function(t){var e=null;t.caStore?Se.util.isArray(t.caStore)?e=Se.pki.createCaStore(t.caStore):e=t.caStore:e=Se.pki.createCaStore();var r=t.cipherSuites||null;if(r===null){r=[];for(var n in D.CipherSuites)r.push(D.CipherSuites[n])}var o=t.server?D.ConnectionEnd.server:D.ConnectionEnd.client,s=t.sessionCache?D.createSessionCache(t.sessionCache):null,a={version:{major:D.Version.major,minor:D.Version.minor},entity:o,sessionId:t.sessionId,caStore:e,sessionCache:s,cipherSuites:r,connected:t.connected,virtualHost:t.virtualHost||null,verifyClient:t.verifyClient||!1,verify:t.verify||function(d,p,f,m){return p},verifyOptions:t.verifyOptions||{},getCertificate:t.getCertificate||null,getPrivateKey:t.getPrivateKey||null,getSignature:t.getSignature||null,input:Se.util.createBuffer(),tlsData:Se.util.createBuffer(),data:Se.util.createBuffer(),tlsDataReady:t.tlsDataReady,dataReady:t.dataReady,heartbeatReceived:t.heartbeatReceived,closed:t.closed,error:function(d,p){p.origin=p.origin||(d.entity===D.ConnectionEnd.client?"client":"server"),p.send&&(D.queue(d,D.createAlert(d,p.alert)),D.flush(d));var f=p.fatal!==!1;f&&(d.fail=!0),t.error(d,p),f&&d.close(!1)},deflate:t.deflate||null,inflate:t.inflate||null};a.reset=function(d){a.version={major:D.Version.major,minor:D.Version.minor},a.record=null,a.session=null,a.peerCertificate=null,a.state={pending:null,current:null},a.expect=a.entity===D.ConnectionEnd.client?_ot:wot,a.fragmented=null,a.records=[],a.open=!1,a.handshakes=0,a.handshaking=!1,a.isConnected=!1,a.fail=!(d||typeof d>"u"),a.input.clear(),a.tlsData.clear(),a.data.clear(),a.state.current=D.createConnectionState(a)},a.reset();var c=function(d,p){var f=p.type-D.ContentType.change_cipher_spec,m=Mee[d.entity][d.expect];f in m?m[f](d,p):D.handleUnexpected(d,p)},u=function(d){var p=0,f=d.input,m=f.length();if(m<5)p=5-m;else{d.record={type:f.getByte(),version:{major:f.getByte(),minor:f.getByte()},length:f.getInt16(),fragment:Se.util.createBuffer(),ready:!1};var h=d.record.version.major===d.version.major;h&&d.session&&d.session.version&&(h=d.record.version.minor===d.version.minor),h||d.error(d,{message:"Incompatible TLS version.",send:!0,alert:{level:D.Alert.Level.fatal,description:D.Alert.Description.protocol_version}})}return p},l=function(d){var p=0,f=d.input,m=f.length();if(m<d.record.length)p=d.record.length-m;else{d.record.fragment.putBytes(f.getBytes(d.record.length)),f.compact();var h=d.state.current.read;h.update(d,d.record)&&(d.fragmented!==null&&(d.fragmented.type===d.record.type?(d.fragmented.fragment.putBuffer(d.record.fragment),d.record=d.fragmented):d.error(d,{message:"Invalid fragmented record.",send:!0,alert:{level:D.Alert.Level.fatal,description:D.Alert.Description.unexpected_message}})),d.record.ready=!0)}return p};return a.handshake=function(d){if(a.entity!==D.ConnectionEnd.client)a.error(a,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(a.handshaking)a.error(a,{message:"Handshake already in progress.",fatal:!1});else{a.fail&&!a.open&&a.handshakes===0&&(a.fail=!1),a.handshaking=!0,d=d||"";var p=null;d.length>0&&(a.sessionCache&&(p=a.sessionCache.getSession(d)),p===null&&(d="")),d.length===0&&a.sessionCache&&(p=a.sessionCache.getSession(),p!==null&&(d=p.id)),a.session={id:d,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:Se.md.md5.create(),sha1:Se.md.sha1.create()},p&&(a.version=p.version,a.session.sp=p.sp),a.session.sp.client_random=D.createRandom().getBytes(),a.open=!0,D.queue(a,D.createRecord(a,{type:D.ContentType.handshake,data:D.createClientHello(a)})),D.flush(a)}},a.process=function(d){var p=0;return d&&a.input.putBytes(d),a.fail||(a.record!==null&&a.record.ready&&a.record.fragment.isEmpty()&&(a.record=null),a.record===null&&(p=u(a)),!a.fail&&a.record!==null&&!a.record.ready&&(p=l(a)),!a.fail&&a.record!==null&&a.record.ready&&c(a,a.record)),p},a.prepare=function(d){return D.queue(a,D.createRecord(a,{type:D.ContentType.application_data,data:Se.util.createBuffer(d)})),D.flush(a)},a.prepareHeartbeatRequest=function(d,p){return d instanceof Se.util.ByteBuffer&&(d=d.bytes()),typeof p>"u"&&(p=d.length),a.expectedHeartbeatPayload=d,D.queue(a,D.createRecord(a,{type:D.ContentType.heartbeat,data:D.createHeartbeat(D.HeartbeatMessageType.heartbeat_request,d,p)})),D.flush(a)},a.close=function(d){if(!a.fail&&a.sessionCache&&a.session){var p={id:a.session.id,version:a.session.version,sp:a.session.sp};p.sp.keys=null,a.sessionCache.setSession(p.id,p)}a.open&&(a.open=!1,a.input.clear(),(a.isConnected||a.handshaking)&&(a.isConnected=a.handshaking=!1,D.queue(a,D.createAlert(a,{level:D.Alert.Level.warning,description:D.Alert.Description.close_notify})),D.flush(a)),a.closed(a)),a.reset(d)},a};Q2e.exports=Se.tls=Se.tls||{};for(H9 in D)typeof D[H9]!="function"&&(Se.tls[H9]=D[H9]);var H9;Se.tls.prf_tls1=z9;Se.tls.hmac_sha1=vot;Se.tls.createSessionCache=D.createSessionCache;Se.tls.createConnection=D.createConnection});var Z2e=L((u5r,J2e)=>{var Zv=tr();$v();Fee();var Hu=J2e.exports=Zv.tls;Hu.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(t){t.bulk_cipher_algorithm=Hu.BulkCipherAlgorithm.aes,t.cipher_type=Hu.CipherType.block,t.enc_key_length=16,t.block_length=16,t.fixed_iv_length=16,t.record_iv_length=16,t.mac_algorithm=Hu.MACAlgorithm.hmac_sha1,t.mac_length=20,t.mac_key_length=20},initConnectionState:X2e};Hu.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(t){t.bulk_cipher_algorithm=Hu.BulkCipherAlgorithm.aes,t.cipher_type=Hu.CipherType.block,t.enc_key_length=32,t.block_length=16,t.fixed_iv_length=16,t.record_iv_length=16,t.mac_algorithm=Hu.MACAlgorithm.hmac_sha1,t.mac_length=20,t.mac_key_length=20},initConnectionState:X2e};function X2e(t,e,r){var n=e.entity===Zv.tls.ConnectionEnd.client;t.read.cipherState={init:!1,cipher:Zv.cipher.createDecipher("AES-CBC",n?r.keys.server_write_key:r.keys.client_write_key),iv:n?r.keys.server_write_IV:r.keys.client_write_IV},t.write.cipherState={init:!1,cipher:Zv.cipher.createCipher("AES-CBC",n?r.keys.client_write_key:r.keys.server_write_key),iv:n?r.keys.client_write_IV:r.keys.server_write_IV},t.read.cipherFunction=qot,t.write.cipherFunction=Fot,t.read.macLength=t.write.macLength=r.mac_length,t.read.macFunction=t.write.macFunction=Hu.hmac_sha1}function Fot(t,e){var r=!1,n=e.macFunction(e.macKey,e.sequenceNumber,t);t.fragment.putBytes(n),e.updateSequenceNumber();var o;t.version.minor===Hu.Versions.TLS_1_0.minor?o=e.cipherState.init?null:e.cipherState.iv:o=Zv.random.getBytesSync(16),e.cipherState.init=!0;var s=e.cipherState.cipher;return s.start({iv:o}),t.version.minor>=Hu.Versions.TLS_1_1.minor&&s.output.putBytes(o),s.update(t.fragment),s.finish(Uot)&&(t.fragment=s.output,t.length=t.fragment.length(),r=!0),r}function Uot(t,e,r){if(!r){var n=t-e.length()%t;e.fillWithByte(n-1,n)}return!0}function Bot(t,e,r){var n=!0;if(r){for(var o=e.length(),s=e.last(),a=o-1-s;a<o-1;++a)n=n&&e.at(a)==s;n&&e.truncate(s+1)}return n}function qot(t,e){var r=!1,n;t.version.minor===Hu.Versions.TLS_1_0.minor?n=e.cipherState.init?null:e.cipherState.iv:n=t.fragment.getBytes(16),e.cipherState.init=!0;var o=e.cipherState.cipher;o.start({iv:n}),o.update(t.fragment),r=o.finish(Bot);var s=e.macLength,a=Zv.random.getBytesSync(s),c=o.output.length();c>=s?(t.fragment=o.output.getBytes(c-s),a=o.output.getBytes(s)):t.fragment=o.output.getBytes(),t.fragment=Zv.util.createBuffer(t.fragment),t.length=t.fragment.length();var u=e.macFunction(e.macKey,e.sequenceNumber,t);return e.updateSequenceNumber(),r=Hot(e.macKey,a,u)&&r,r}function Hot(t,e,r){var n=Zv.hmac.create();return n.start("SHA1",t),n.update(e),e=n.digest().getBytes(),n.start(null,null),n.update(r),r=n.digest().getBytes(),e===r}});var qee=L((l5r,nAe)=>{var zn=tr();gp();Or();var TA=nAe.exports=zn.sha512=zn.sha512||{};zn.md.sha512=zn.md.algorithms.sha512=TA;var tAe=zn.sha384=zn.sha512.sha384=zn.sha512.sha384||{};tAe.create=function(){return TA.create("SHA-384")};zn.md.sha384=zn.md.algorithms.sha384=tAe;zn.sha512.sha256=zn.sha512.sha256||{create:function(){return TA.create("SHA-512/256")}};zn.md["sha512/256"]=zn.md.algorithms["sha512/256"]=zn.sha512.sha256;zn.sha512.sha224=zn.sha512.sha224||{create:function(){return TA.create("SHA-512/224")}};zn.md["sha512/224"]=zn.md.algorithms["sha512/224"]=zn.sha512.sha224;TA.create=function(t){if(rAe||jot(),typeof t>"u"&&(t="SHA-512"),!(t in n_))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=n_[t],r=null,n=zn.util.createBuffer(),o=new Array(80),s=0;s<80;++s)o[s]=new Array(2);var a=64;switch(t){case"SHA-384":a=48;break;case"SHA-512/256":a=32;break;case"SHA-512/224":a=28;break}var c={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:a,messageLength:0,fullMessageLength:null,messageLengthSize:16};return c.start=function(){c.messageLength=0,c.fullMessageLength=c.messageLength128=[];for(var u=c.messageLengthSize/4,l=0;l<u;++l)c.fullMessageLength.push(0);n=zn.util.createBuffer(),r=new Array(e.length);for(var l=0;l<e.length;++l)r[l]=e[l].slice(0);return c},c.start(),c.update=function(u,l){l==="utf8"&&(u=zn.util.encodeUtf8(u));var d=u.length;c.messageLength+=d,d=[d/4294967296>>>0,d>>>0];for(var p=c.fullMessageLength.length-1;p>=0;--p)c.fullMessageLength[p]+=d[1],d[1]=d[0]+(c.fullMessageLength[p]/4294967296>>>0),c.fullMessageLength[p]=c.fullMessageLength[p]>>>0,d[0]=d[1]/4294967296>>>0;return n.putBytes(u),eAe(r,o,n),(n.read>2048||n.length()===0)&&n.compact(),c},c.digest=function(){var u=zn.util.createBuffer();u.putBytes(n.bytes());var l=c.fullMessageLength[c.fullMessageLength.length-1]+c.messageLengthSize,d=l&c.blockLength-1;u.putBytes(Uee.substr(0,c.blockLength-d));for(var p,f,m=c.fullMessageLength[0]*8,h=0;h<c.fullMessageLength.length-1;++h)p=c.fullMessageLength[h+1]*8,f=p/4294967296>>>0,m+=f,u.putInt32(m>>>0),m=p>>>0;u.putInt32(m);for(var g=new Array(r.length),h=0;h<r.length;++h)g[h]=r[h].slice(0);eAe(g,o,u);var v=zn.util.createBuffer(),y;t==="SHA-512"?y=g.length:t==="SHA-384"?y=g.length-2:y=g.length-4;for(var h=0;h<y;++h)v.putInt32(g[h][0]),(h!==y-1||t!=="SHA-512/224")&&v.putInt32(g[h][1]);return v},c};var Uee=null,rAe=!1,Bee=null,n_=null;function jot(){Uee="\x80",Uee+=zn.util.fillString("\0",128),Bee=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],n_={},n_["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],n_["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],n_["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],n_["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],rAe=!0}function eAe(t,e,r){for(var n,o,s,a,c,u,l,d,p,f,m,h,g,v,y,_,b,S,I,w,O,U,z,M,re,ee,N,E,P,q,F,Z,ue,te,Q,je=r.length();je>=128;){for(P=0;P<16;++P)e[P][0]=r.getInt32()>>>0,e[P][1]=r.getInt32()>>>0;for(;P<80;++P)Z=e[P-2],q=Z[0],F=Z[1],n=((q>>>19|F<<13)^(F>>>29|q<<3)^q>>>6)>>>0,o=((q<<13|F>>>19)^(F<<3|q>>>29)^(q<<26|F>>>6))>>>0,te=e[P-15],q=te[0],F=te[1],s=((q>>>1|F<<31)^(q>>>8|F<<24)^q>>>7)>>>0,a=((q<<31|F>>>1)^(q<<24|F>>>8)^(q<<25|F>>>7))>>>0,ue=e[P-7],Q=e[P-16],F=o+ue[1]+a+Q[1],e[P][0]=n+ue[0]+s+Q[0]+(F/4294967296>>>0)>>>0,e[P][1]=F>>>0;for(g=t[0][0],v=t[0][1],y=t[1][0],_=t[1][1],b=t[2][0],S=t[2][1],I=t[3][0],w=t[3][1],O=t[4][0],U=t[4][1],z=t[5][0],M=t[5][1],re=t[6][0],ee=t[6][1],N=t[7][0],E=t[7][1],P=0;P<80;++P)l=((O>>>14|U<<18)^(O>>>18|U<<14)^(U>>>9|O<<23))>>>0,d=((O<<18|U>>>14)^(O<<14|U>>>18)^(U<<23|O>>>9))>>>0,p=(re^O&(z^re))>>>0,f=(ee^U&(M^ee))>>>0,c=((g>>>28|v<<4)^(v>>>2|g<<30)^(v>>>7|g<<25))>>>0,u=((g<<4|v>>>28)^(v<<30|g>>>2)^(v<<25|g>>>7))>>>0,m=(g&y|b&(g^y))>>>0,h=(v&_|S&(v^_))>>>0,F=E+d+f+Bee[P][1]+e[P][1],n=N+l+p+Bee[P][0]+e[P][0]+(F/4294967296>>>0)>>>0,o=F>>>0,F=u+h,s=c+m+(F/4294967296>>>0)>>>0,a=F>>>0,N=re,E=ee,re=z,ee=M,z=O,M=U,F=w+o,O=I+n+(F/4294967296>>>0)>>>0,U=F>>>0,I=b,w=S,b=y,S=_,y=g,_=v,F=o+a,g=n+s+(F/4294967296>>>0)>>>0,v=F>>>0;F=t[0][1]+v,t[0][0]=t[0][0]+g+(F/4294967296>>>0)>>>0,t[0][1]=F>>>0,F=t[1][1]+_,t[1][0]=t[1][0]+y+(F/4294967296>>>0)>>>0,t[1][1]=F>>>0,F=t[2][1]+S,t[2][0]=t[2][0]+b+(F/4294967296>>>0)>>>0,t[2][1]=F>>>0,F=t[3][1]+w,t[3][0]=t[3][0]+I+(F/4294967296>>>0)>>>0,t[3][1]=F>>>0,F=t[4][1]+U,t[4][0]=t[4][0]+O+(F/4294967296>>>0)>>>0,t[4][1]=F>>>0,F=t[5][1]+M,t[5][0]=t[5][0]+z+(F/4294967296>>>0)>>>0,t[5][1]=F>>>0,F=t[6][1]+ee,t[6][0]=t[6][0]+re+(F/4294967296>>>0)>>>0,t[6][1]=F>>>0,F=t[7][1]+E,t[7][0]=t[7][0]+N+(F/4294967296>>>0)>>>0,t[7][1]=F>>>0,je-=128}}});var iAe=L(Hee=>{var zot=tr();Ll();var ts=zot.asn1;Hee.privateKeyValidator={name:"PrivateKeyInfo",tagClass:ts.Class.UNIVERSAL,type:ts.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:ts.Class.UNIVERSAL,type:ts.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:ts.Class.UNIVERSAL,type:ts.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:ts.Class.UNIVERSAL,type:ts.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:ts.Class.UNIVERSAL,type:ts.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]};Hee.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:ts.Class.UNIVERSAL,type:ts.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:ts.Class.UNIVERSAL,type:ts.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:ts.Class.UNIVERSAL,type:ts.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:ts.Class.UNIVERSAL,type:ts.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]}});var vAe=L((p5r,gAe)=>{var Rs=tr();xA();Mu();qee();Or();var lAe=iAe(),Got=lAe.publicKeyValidator,Vot=lAe.privateKeyValidator;typeof oAe>"u"&&(oAe=Rs.jsbn.BigInteger);var oAe,Gee=Rs.util.ByteBuffer,sc=typeof Buffer>"u"?Uint8Array:Buffer;Rs.pki=Rs.pki||{};gAe.exports=Rs.pki.ed25519=Rs.ed25519=Rs.ed25519||{};var fr=Rs.ed25519;fr.constants={};fr.constants.PUBLIC_KEY_BYTE_LENGTH=32;fr.constants.PRIVATE_KEY_BYTE_LENGTH=64;fr.constants.SEED_BYTE_LENGTH=32;fr.constants.SIGN_BYTE_LENGTH=64;fr.constants.HASH_BYTE_LENGTH=64;fr.generateKeyPair=function(t){t=t||{};var e=t.seed;if(e===void 0)e=Rs.random.getBytesSync(fr.constants.SEED_BYTE_LENGTH);else if(typeof e=="string"){if(e.length!==fr.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+fr.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');e=bm({message:e,encoding:"binary"});for(var r=new sc(fr.constants.PUBLIC_KEY_BYTE_LENGTH),n=new sc(fr.constants.PRIVATE_KEY_BYTE_LENGTH),o=0;o<32;++o)n[o]=e[o];return Yot(r,n),{publicKey:r,privateKey:n}};fr.privateKeyFromAsn1=function(t){var e={},r=[],n=Rs.asn1.validate(t,Vot,e,r);if(!n){var o=new Error("Invalid Key.");throw o.errors=r,o}var s=Rs.asn1.derToOid(e.privateKeyOid),a=Rs.oids.EdDSA25519;if(s!==a)throw new Error('Invalid OID "'+s+'"; OID must be "'+a+'".');var c=e.privateKey,u=bm({message:Rs.asn1.fromDer(c).value,encoding:"binary"});return{privateKeyBytes:u}};fr.publicKeyFromAsn1=function(t){var e={},r=[],n=Rs.asn1.validate(t,Got,e,r);if(!n){var o=new Error("Invalid Key.");throw o.errors=r,o}var s=Rs.asn1.derToOid(e.publicKeyOid),a=Rs.oids.EdDSA25519;if(s!==a)throw new Error('Invalid OID "'+s+'"; OID must be "'+a+'".');var c=e.ed25519PublicKey;if(c.length!==fr.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return bm({message:c,encoding:"binary"})};fr.publicKeyFromPrivateKey=function(t){t=t||{};var e=bm({message:t.privateKey,encoding:"binary"});if(e.length!==fr.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+fr.constants.PRIVATE_KEY_BYTE_LENGTH);for(var r=new sc(fr.constants.PUBLIC_KEY_BYTE_LENGTH),n=0;n<r.length;++n)r[n]=e[32+n];return r};fr.sign=function(t){t=t||{};var e=bm(t),r=bm({message:t.privateKey,encoding:"binary"});if(r.length===fr.constants.SEED_BYTE_LENGTH){var n=fr.generateKeyPair({seed:r});r=n.privateKey}else if(r.length!==fr.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+fr.constants.SEED_BYTE_LENGTH+" or "+fr.constants.PRIVATE_KEY_BYTE_LENGTH);var o=new sc(fr.constants.SIGN_BYTE_LENGTH+e.length);Qot(o,e,e.length,r);for(var s=new sc(fr.constants.SIGN_BYTE_LENGTH),a=0;a<s.length;++a)s[a]=o[a];return s};fr.verify=function(t){t=t||{};var e=bm(t);if(t.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var r=bm({message:t.signature,encoding:"binary"});if(r.length!==fr.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+fr.constants.SIGN_BYTE_LENGTH);var n=bm({message:t.publicKey,encoding:"binary"});if(n.length!==fr.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+fr.constants.PUBLIC_KEY_BYTE_LENGTH);var o=new sc(fr.constants.SIGN_BYTE_LENGTH+e.length),s=new sc(fr.constants.SIGN_BYTE_LENGTH+e.length),a;for(a=0;a<fr.constants.SIGN_BYTE_LENGTH;++a)o[a]=r[a];for(a=0;a<e.length;++a)o[a+fr.constants.SIGN_BYTE_LENGTH]=e[a];return Xot(s,o,o.length,n)>=0};function bm(t){var e=t.message;if(e instanceof Uint8Array||e instanceof sc)return e;var r=t.encoding;if(e===void 0)if(t.md)e=t.md.digest().getBytes(),r="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof e=="string"&&!r)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.from(e,r);e=new Gee(e,r)}else if(!(e instanceof Gee))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var n=new sc(e.length()),o=0;o<n.length;++o)n[o]=e.at(o);return n}var Vee=Et(),G9=Et([1]),$ot=Et([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),Wot=Et([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),sAe=Et([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),aAe=Et([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),jee=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),Kot=Et([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function EA(t,e){var r=Rs.md.sha512.create(),n=new Gee(t);r.update(n.getBytes(e),"binary");var o=r.digest().getBytes();if(typeof Buffer<"u")return Buffer.from(o,"binary");for(var s=new sc(fr.constants.HASH_BYTE_LENGTH),a=0;a<64;++a)s[a]=o.charCodeAt(a);return s}function Yot(t,e){var r=[Et(),Et(),Et(),Et()],n,o=EA(e,32);for(o[0]&=248,o[31]&=127,o[31]|=64,Yee(r,o),Kee(t,r),n=0;n<32;++n)e[n+32]=t[n];return 0}function Qot(t,e,r,n){var o,s,a=new Float64Array(64),c=[Et(),Et(),Et(),Et()],u=EA(n,32);u[0]&=248,u[31]&=127,u[31]|=64;var l=r+64;for(o=0;o<r;++o)t[64+o]=e[o];for(o=0;o<32;++o)t[32+o]=u[32+o];var d=EA(t.subarray(32),r+32);for($ee(d),Yee(c,d),Kee(t,c),o=32;o<64;++o)t[o]=n[o];var p=EA(t,r+64);for($ee(p),o=32;o<64;++o)a[o]=0;for(o=0;o<32;++o)a[o]=d[o];for(o=0;o<32;++o)for(s=0;s<32;s++)a[o+s]+=p[o]*u[s];return dAe(t.subarray(32),a),l}function Xot(t,e,r,n){var o,s,a=new sc(32),c=[Et(),Et(),Et(),Et()],u=[Et(),Et(),Et(),Et()];if(s=-1,r<64||Jot(u,n))return-1;for(o=0;o<r;++o)t[o]=e[o];for(o=0;o<32;++o)t[o+32]=n[o];var l=EA(t,r);if($ee(l),mAe(c,u,l),Yee(u,e.subarray(32)),Wee(c,u),Kee(a,c),r-=64,pAe(e,0,a,0)){for(o=0;o<r;++o)t[o]=0;return-1}for(o=0;o<r;++o)t[o]=e[o+64];return s=r,s}function dAe(t,e){var r,n,o,s;for(n=63;n>=32;--n){for(r=0,o=n-32,s=n-12;o<s;++o)e[o]+=r-16*e[n]*jee[o-(n-32)],r=e[o]+128>>8,e[o]-=r*256;e[o]+=r,e[n]=0}for(r=0,o=0;o<32;++o)e[o]+=r-(e[31]>>4)*jee[o],r=e[o]>>8,e[o]&=255;for(o=0;o<32;++o)e[o]-=r*jee[o];for(n=0;n<32;++n)e[n+1]+=e[n]>>8,t[n]=e[n]&255}function $ee(t){for(var e=new Float64Array(64),r=0;r<64;++r)e[r]=t[r],t[r]=0;dAe(t,e)}function Wee(t,e){var r=Et(),n=Et(),o=Et(),s=Et(),a=Et(),c=Et(),u=Et(),l=Et(),d=Et();BT(r,t[1],t[0]),BT(d,e[1],e[0]),_n(r,r,d),UT(n,t[0],t[1]),UT(d,e[0],e[1]),_n(n,n,d),_n(o,t[3],e[3]),_n(o,o,Wot),_n(s,t[2],e[2]),UT(s,s,s),BT(a,n,r),BT(c,s,o),UT(u,s,o),UT(l,n,r),_n(t[0],a,c),_n(t[1],l,u),_n(t[2],u,c),_n(t[3],a,l)}function cAe(t,e,r){for(var n=0;n<4;++n)hAe(t[n],e[n],r)}function Kee(t,e){var r=Et(),n=Et(),o=Et();rst(o,e[2]),_n(r,e[0],o),_n(n,e[1],o),V9(t,n),t[31]^=fAe(r)<<7}function V9(t,e){var r,n,o,s=Et(),a=Et();for(r=0;r<16;++r)a[r]=e[r];for(zee(a),zee(a),zee(a),n=0;n<2;++n){for(s[0]=a[0]-65517,r=1;r<15;++r)s[r]=a[r]-65535-(s[r-1]>>16&1),s[r-1]&=65535;s[15]=a[15]-32767-(s[14]>>16&1),o=s[15]>>16&1,s[14]&=65535,hAe(a,s,1-o)}for(r=0;r<16;r++)t[2*r]=a[r]&255,t[2*r+1]=a[r]>>8}function Jot(t,e){var r=Et(),n=Et(),o=Et(),s=Et(),a=Et(),c=Et(),u=Et();return e0(t[2],G9),Zot(t[1],e),i_(o,t[1]),_n(s,o,$ot),BT(o,o,t[2]),UT(s,t[2],s),i_(a,s),i_(c,a),_n(u,c,a),_n(r,u,o),_n(r,r,s),est(r,r),_n(r,r,o),_n(r,r,s),_n(r,r,s),_n(t[0],r,s),i_(n,t[0]),_n(n,n,s),uAe(n,o)&&_n(t[0],t[0],Kot),i_(n,t[0]),_n(n,n,s),uAe(n,o)?-1:(fAe(t[0])===e[31]>>7&&BT(t[0],Vee,t[0]),_n(t[3],t[0],t[1]),0)}function Zot(t,e){var r;for(r=0;r<16;++r)t[r]=e[2*r]+(e[2*r+1]<<8);t[15]&=32767}function est(t,e){var r=Et(),n;for(n=0;n<16;++n)r[n]=e[n];for(n=250;n>=0;--n)i_(r,r),n!==1&&_n(r,r,e);for(n=0;n<16;++n)t[n]=r[n]}function uAe(t,e){var r=new sc(32),n=new sc(32);return V9(r,t),V9(n,e),pAe(r,0,n,0)}function pAe(t,e,r,n){return tst(t,e,r,n,32)}function tst(t,e,r,n,o){var s,a=0;for(s=0;s<o;++s)a|=t[e+s]^r[n+s];return(1&a-1>>>8)-1}function fAe(t){var e=new sc(32);return V9(e,t),e[0]&1}function mAe(t,e,r){var n,o;for(e0(t[0],Vee),e0(t[1],G9),e0(t[2],G9),e0(t[3],Vee),o=255;o>=0;--o)n=r[o/8|0]>>(o&7)&1,cAe(t,e,n),Wee(e,t),Wee(t,t),cAe(t,e,n)}function Yee(t,e){var r=[Et(),Et(),Et(),Et()];e0(r[0],sAe),e0(r[1],aAe),e0(r[2],G9),_n(r[3],sAe,aAe),mAe(t,r,e)}function e0(t,e){var r;for(r=0;r<16;r++)t[r]=e[r]|0}function rst(t,e){var r=Et(),n;for(n=0;n<16;++n)r[n]=e[n];for(n=253;n>=0;--n)i_(r,r),n!==2&&n!==4&&_n(r,r,e);for(n=0;n<16;++n)t[n]=r[n]}function zee(t){var e,r,n=1;for(e=0;e<16;++e)r=t[e]+n+65535,n=Math.floor(r/65536),t[e]=r-n*65536;t[0]+=n-1+37*(n-1)}function hAe(t,e,r){for(var n,o=~(r-1),s=0;s<16;++s)n=o&(t[s]^e[s]),t[s]^=n,e[s]^=n}function Et(t){var e,r=new Float64Array(16);if(t)for(e=0;e<t.length;++e)r[e]=t[e];return r}function UT(t,e,r){for(var n=0;n<16;++n)t[n]=e[n]+r[n]}function BT(t,e,r){for(var n=0;n<16;++n)t[n]=e[n]-r[n]}function i_(t,e){_n(t,e,e)}function _n(t,e,r){var n,o,s=0,a=0,c=0,u=0,l=0,d=0,p=0,f=0,m=0,h=0,g=0,v=0,y=0,_=0,b=0,S=0,I=0,w=0,O=0,U=0,z=0,M=0,re=0,ee=0,N=0,E=0,P=0,q=0,F=0,Z=0,ue=0,te=r[0],Q=r[1],je=r[2],ne=r[3],ht=r[4],We=r[5],Ct=r[6],xr=r[7],ye=r[8],nt=r[9],H=r[10],le=r[11],pe=r[12],ke=r[13],Ie=r[14],it=r[15];n=e[0],s+=n*te,a+=n*Q,c+=n*je,u+=n*ne,l+=n*ht,d+=n*We,p+=n*Ct,f+=n*xr,m+=n*ye,h+=n*nt,g+=n*H,v+=n*le,y+=n*pe,_+=n*ke,b+=n*Ie,S+=n*it,n=e[1],a+=n*te,c+=n*Q,u+=n*je,l+=n*ne,d+=n*ht,p+=n*We,f+=n*Ct,m+=n*xr,h+=n*ye,g+=n*nt,v+=n*H,y+=n*le,_+=n*pe,b+=n*ke,S+=n*Ie,I+=n*it,n=e[2],c+=n*te,u+=n*Q,l+=n*je,d+=n*ne,p+=n*ht,f+=n*We,m+=n*Ct,h+=n*xr,g+=n*ye,v+=n*nt,y+=n*H,_+=n*le,b+=n*pe,S+=n*ke,I+=n*Ie,w+=n*it,n=e[3],u+=n*te,l+=n*Q,d+=n*je,p+=n*ne,f+=n*ht,m+=n*We,h+=n*Ct,g+=n*xr,v+=n*ye,y+=n*nt,_+=n*H,b+=n*le,S+=n*pe,I+=n*ke,w+=n*Ie,O+=n*it,n=e[4],l+=n*te,d+=n*Q,p+=n*je,f+=n*ne,m+=n*ht,h+=n*We,g+=n*Ct,v+=n*xr,y+=n*ye,_+=n*nt,b+=n*H,S+=n*le,I+=n*pe,w+=n*ke,O+=n*Ie,U+=n*it,n=e[5],d+=n*te,p+=n*Q,f+=n*je,m+=n*ne,h+=n*ht,g+=n*We,v+=n*Ct,y+=n*xr,_+=n*ye,b+=n*nt,S+=n*H,I+=n*le,w+=n*pe,O+=n*ke,U+=n*Ie,z+=n*it,n=e[6],p+=n*te,f+=n*Q,m+=n*je,h+=n*ne,g+=n*ht,v+=n*We,y+=n*Ct,_+=n*xr,b+=n*ye,S+=n*nt,I+=n*H,w+=n*le,O+=n*pe,U+=n*ke,z+=n*Ie,M+=n*it,n=e[7],f+=n*te,m+=n*Q,h+=n*je,g+=n*ne,v+=n*ht,y+=n*We,_+=n*Ct,b+=n*xr,S+=n*ye,I+=n*nt,w+=n*H,O+=n*le,U+=n*pe,z+=n*ke,M+=n*Ie,re+=n*it,n=e[8],m+=n*te,h+=n*Q,g+=n*je,v+=n*ne,y+=n*ht,_+=n*We,b+=n*Ct,S+=n*xr,I+=n*ye,w+=n*nt,O+=n*H,U+=n*le,z+=n*pe,M+=n*ke,re+=n*Ie,ee+=n*it,n=e[9],h+=n*te,g+=n*Q,v+=n*je,y+=n*ne,_+=n*ht,b+=n*We,S+=n*Ct,I+=n*xr,w+=n*ye,O+=n*nt,U+=n*H,z+=n*le,M+=n*pe,re+=n*ke,ee+=n*Ie,N+=n*it,n=e[10],g+=n*te,v+=n*Q,y+=n*je,_+=n*ne,b+=n*ht,S+=n*We,I+=n*Ct,w+=n*xr,O+=n*ye,U+=n*nt,z+=n*H,M+=n*le,re+=n*pe,ee+=n*ke,N+=n*Ie,E+=n*it,n=e[11],v+=n*te,y+=n*Q,_+=n*je,b+=n*ne,S+=n*ht,I+=n*We,w+=n*Ct,O+=n*xr,U+=n*ye,z+=n*nt,M+=n*H,re+=n*le,ee+=n*pe,N+=n*ke,E+=n*Ie,P+=n*it,n=e[12],y+=n*te,_+=n*Q,b+=n*je,S+=n*ne,I+=n*ht,w+=n*We,O+=n*Ct,U+=n*xr,z+=n*ye,M+=n*nt,re+=n*H,ee+=n*le,N+=n*pe,E+=n*ke,P+=n*Ie,q+=n*it,n=e[13],_+=n*te,b+=n*Q,S+=n*je,I+=n*ne,w+=n*ht,O+=n*We,U+=n*Ct,z+=n*xr,M+=n*ye,re+=n*nt,ee+=n*H,N+=n*le,E+=n*pe,P+=n*ke,q+=n*Ie,F+=n*it,n=e[14],b+=n*te,S+=n*Q,I+=n*je,w+=n*ne,O+=n*ht,U+=n*We,z+=n*Ct,M+=n*xr,re+=n*ye,ee+=n*nt,N+=n*H,E+=n*le,P+=n*pe,q+=n*ke,F+=n*Ie,Z+=n*it,n=e[15],S+=n*te,I+=n*Q,w+=n*je,O+=n*ne,U+=n*ht,z+=n*We,M+=n*Ct,re+=n*xr,ee+=n*ye,N+=n*nt,E+=n*H,P+=n*le,q+=n*pe,F+=n*ke,Z+=n*Ie,ue+=n*it,s+=38*I,a+=38*w,c+=38*O,u+=38*U,l+=38*z,d+=38*M,p+=38*re,f+=38*ee,m+=38*N,h+=38*E,g+=38*P,v+=38*q,y+=38*F,_+=38*Z,b+=38*ue,o=1,n=s+o+65535,o=Math.floor(n/65536),s=n-o*65536,n=a+o+65535,o=Math.floor(n/65536),a=n-o*65536,n=c+o+65535,o=Math.floor(n/65536),c=n-o*65536,n=u+o+65535,o=Math.floor(n/65536),u=n-o*65536,n=l+o+65535,o=Math.floor(n/65536),l=n-o*65536,n=d+o+65535,o=Math.floor(n/65536),d=n-o*65536,n=p+o+65535,o=Math.floor(n/65536),p=n-o*65536,n=f+o+65535,o=Math.floor(n/65536),f=n-o*65536,n=m+o+65535,o=Math.floor(n/65536),m=n-o*65536,n=h+o+65535,o=Math.floor(n/65536),h=n-o*65536,n=g+o+65535,o=Math.floor(n/65536),g=n-o*65536,n=v+o+65535,o=Math.floor(n/65536),v=n-o*65536,n=y+o+65535,o=Math.floor(n/65536),y=n-o*65536,n=_+o+65535,o=Math.floor(n/65536),_=n-o*65536,n=b+o+65535,o=Math.floor(n/65536),b=n-o*65536,n=S+o+65535,o=Math.floor(n/65536),S=n-o*65536,s+=o-1+37*(o-1),o=1,n=s+o+65535,o=Math.floor(n/65536),s=n-o*65536,n=a+o+65535,o=Math.floor(n/65536),a=n-o*65536,n=c+o+65535,o=Math.floor(n/65536),c=n-o*65536,n=u+o+65535,o=Math.floor(n/65536),u=n-o*65536,n=l+o+65535,o=Math.floor(n/65536),l=n-o*65536,n=d+o+65535,o=Math.floor(n/65536),d=n-o*65536,n=p+o+65535,o=Math.floor(n/65536),p=n-o*65536,n=f+o+65535,o=Math.floor(n/65536),f=n-o*65536,n=m+o+65535,o=Math.floor(n/65536),m=n-o*65536,n=h+o+65535,o=Math.floor(n/65536),h=n-o*65536,n=g+o+65535,o=Math.floor(n/65536),g=n-o*65536,n=v+o+65535,o=Math.floor(n/65536),v=n-o*65536,n=y+o+65535,o=Math.floor(n/65536),y=n-o*65536,n=_+o+65535,o=Math.floor(n/65536),_=n-o*65536,n=b+o+65535,o=Math.floor(n/65536),b=n-o*65536,n=S+o+65535,o=Math.floor(n/65536),S=n-o*65536,s+=o-1+37*(o-1),t[0]=s,t[1]=a,t[2]=c,t[3]=u,t[4]=l,t[5]=d,t[6]=p,t[7]=f,t[8]=m,t[9]=h,t[10]=g,t[11]=v,t[12]=y,t[13]=_,t[14]=b,t[15]=S}});var xAe=L((f5r,_Ae)=>{var Fc=tr();Or();Mu();xA();_Ae.exports=Fc.kem=Fc.kem||{};var yAe=Fc.jsbn.BigInteger;Fc.kem.rsa={};Fc.kem.rsa.create=function(t,e){e=e||{};var r=e.prng||Fc.random,n={};return n.encrypt=function(o,s){var a=Math.ceil(o.n.bitLength()/8),c;do c=new yAe(Fc.util.bytesToHex(r.getBytesSync(a)),16).mod(o.n);while(c.compareTo(yAe.ONE)<=0);c=Fc.util.hexToBytes(c.toString(16));var u=a-c.length;u>0&&(c=Fc.util.fillString("\0",u)+c);var l=o.encrypt(c,"NONE"),d=t.generate(c,s);return{encapsulation:l,key:d}},n.decrypt=function(o,s,a){var c=o.decrypt(s,"NONE");return t.generate(c,a)},n};Fc.kem.kdf1=function(t,e){bAe(this,t,0,e||t.digestLength)};Fc.kem.kdf2=function(t,e){bAe(this,t,1,e||t.digestLength)};function bAe(t,e,r,n){t.generate=function(o,s){for(var a=new Fc.util.ByteBuffer,c=Math.ceil(s/n)+r,u=new Fc.util.ByteBuffer,l=r;l<c;++l){u.putInt32(l),e.start(),e.update(o+u.getBytes());var d=e.digest();a.putBytes(d.getBytes(n))}return a.truncate(a.length()-s),a.getBytes()}}});var TAe=L((m5r,CAe)=>{var _r=tr();Or();CAe.exports=_r.log=_r.log||{};_r.log.levels=["none","error","warning","info","debug","verbose","max"];var $9={},Jee=[],RA=null;_r.log.LEVEL_LOCKED=2;_r.log.NO_LEVEL_CHECK=4;_r.log.INTERPOLATE=8;for(Cp=0;Cp<_r.log.levels.length;++Cp)Qee=_r.log.levels[Cp],$9[Qee]={index:Cp,name:Qee.toUpperCase()};var Qee,Cp;_r.log.logMessage=function(t){for(var e=$9[t.level].index,r=0;r<Jee.length;++r){var n=Jee[r];if(n.flags&_r.log.NO_LEVEL_CHECK)n.f(t);else{var o=$9[n.level].index;e<=o&&n.f(n,t)}}};_r.log.prepareStandard=function(t){"standard"in t||(t.standard=$9[t.level].name+" ["+t.category+"] "+t.message)};_r.log.prepareFull=function(t){if(!("full"in t)){var e=[t.message];e=e.concat([]),t.full=_r.util.format.apply(this,e)}};_r.log.prepareStandardFull=function(t){"standardFull"in t||(_r.log.prepareStandard(t),t.standardFull=t.standard)};for(Xee=["error","warning","info","debug","verbose"],Cp=0;Cp<Xee.length;++Cp)(function(e){_r.log[e]=function(r,n){var o=Array.prototype.slice.call(arguments).slice(2),s={timestamp:new Date,level:e,category:r,message:n,arguments:o};_r.log.logMessage(s)}})(Xee[Cp]);var Xee,Cp;_r.log.makeLogger=function(t){var e={flags:0,f:t};return _r.log.setLevel(e,"none"),e};_r.log.setLevel=function(t,e){var r=!1;if(t&&!(t.flags&_r.log.LEVEL_LOCKED))for(var n=0;n<_r.log.levels.length;++n){var o=_r.log.levels[n];if(e==o){t.level=e,r=!0;break}}return r};_r.log.lock=function(t,e){typeof e>"u"||e?t.flags|=_r.log.LEVEL_LOCKED:t.flags&=~_r.log.LEVEL_LOCKED};_r.log.addLogger=function(t){Jee.push(t)};typeof console<"u"&&"log"in console?(console.error&&console.warn&&console.info&&console.debug?(SAe={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},kA=function(t,e){_r.log.prepareStandard(e);var r=SAe[e.level],n=[e.standard];n=n.concat(e.arguments.slice()),r.apply(console,n)},qT=_r.log.makeLogger(kA)):(kA=function(e,r){_r.log.prepareStandardFull(r),console.log(r.standardFull)},qT=_r.log.makeLogger(kA)),_r.log.setLevel(qT,"debug"),_r.log.addLogger(qT),RA=qT):console={log:function(){}};var qT,SAe,kA;RA!==null&&typeof window<"u"&&window.location&&(wA=new URL(window.location.href).searchParams,wA.has("console.level")&&_r.log.setLevel(RA,wA.get("console.level").slice(-1)[0]),wA.has("console.lock")&&(IAe=wA.get("console.lock").slice(-1)[0],IAe=="true"&&_r.log.lock(RA)));var wA,IAe;_r.log.consoleLogger=RA});var wAe=L((h5r,EAe)=>{EAe.exports=gp();T9();NT();dee();qee()});var AAe=L((g5r,kAe)=>{var Ge=tr();$v();Ll();bA();Wv();Xb();Tee();Mu();Or();B9();var $=Ge.asn1,Ia=kAe.exports=Ge.pkcs7=Ge.pkcs7||{};Ia.messageFromPem=function(t){var e=Ge.pem.decode(t)[0];if(e.type!=="PKCS7"){var r=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var n=$.fromDer(e.body);return Ia.messageFromAsn1(n)};Ia.messageToPem=function(t,e){var r={type:"PKCS7",body:$.toDer(t.toAsn1()).getBytes()};return Ge.pem.encode(r,{maxline:e})};Ia.messageFromAsn1=function(t){var e={},r=[];if(!$.validate(t,Ia.asn1.contentInfoValidator,e,r)){var n=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw n.errors=r,n}var o=$.derToOid(e.contentType),s;switch(o){case Ge.pki.oids.envelopedData:s=Ia.createEnvelopedData();break;case Ge.pki.oids.encryptedData:s=Ia.createEncryptedData();break;case Ge.pki.oids.signedData:s=Ia.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+o+" is not (yet) supported.")}return s.fromAsn1(e.content.value[0]),s};Ia.createSignedData=function(){var t=null;return t={type:Ge.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(n){if(ete(t,n,Ia.asn1.signedDataValidator),t.certificates=[],t.crls=[],t.digestAlgorithmIdentifiers=[],t.contentInfo=null,t.signerInfos=[],t.rawCapture.certificates)for(var o=t.rawCapture.certificates.value,s=0;s<o.length;++s)t.certificates.push(Ge.pki.certificateFromAsn1(o[s]))},toAsn1:function(){t.contentInfo||t.sign();for(var n=[],o=0;o<t.certificates.length;++o)n.push(Ge.pki.certificateToAsn1(t.certificates[o]));var s=[],a=$.create($.Class.CONTEXT_SPECIFIC,0,!0,[$.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,[$.create($.Class.UNIVERSAL,$.Type.INTEGER,!1,$.integerToDer(t.version).getBytes()),$.create($.Class.UNIVERSAL,$.Type.SET,!0,t.digestAlgorithmIdentifiers),t.contentInfo])]);return n.length>0&&a.value[0].value.push($.create($.Class.CONTEXT_SPECIFIC,0,!0,n)),s.length>0&&a.value[0].value.push($.create($.Class.CONTEXT_SPECIFIC,1,!0,s)),a.value[0].value.push($.create($.Class.UNIVERSAL,$.Type.SET,!0,t.signerInfos)),$.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,[$.create($.Class.UNIVERSAL,$.Type.OID,!1,$.oidToDer(t.type).getBytes()),a])},addSigner:function(n){var o=n.issuer,s=n.serialNumber;if(n.certificate){var a=n.certificate;typeof a=="string"&&(a=Ge.pki.certificateFromPem(a)),o=a.issuer.attributes,s=a.serialNumber}var c=n.key;if(!c)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof c=="string"&&(c=Ge.pki.privateKeyFromPem(c));var u=n.digestAlgorithm||Ge.pki.oids.sha1;switch(u){case Ge.pki.oids.sha1:case Ge.pki.oids.sha256:case Ge.pki.oids.sha384:case Ge.pki.oids.sha512:case Ge.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+u)}var l=n.authenticatedAttributes||[];if(l.length>0){for(var d=!1,p=!1,f=0;f<l.length;++f){var m=l[f];if(!d&&m.type===Ge.pki.oids.contentType){if(d=!0,p)break;continue}if(!p&&m.type===Ge.pki.oids.messageDigest){if(p=!0,d)break;continue}}if(!d||!p)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}t.signers.push({key:c,version:1,issuer:o,serialNumber:s,digestAlgorithm:u,signatureAlgorithm:Ge.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:l,unauthenticatedAttributes:[]})},sign:function(n){if(n=n||{},(typeof t.content!="object"||t.contentInfo===null)&&(t.contentInfo=$.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,[$.create($.Class.UNIVERSAL,$.Type.OID,!1,$.oidToDer(Ge.pki.oids.data).getBytes())]),"content"in t)){var o;t.content instanceof Ge.util.ByteBuffer?o=t.content.bytes():typeof t.content=="string"&&(o=Ge.util.encodeUtf8(t.content)),n.detached?t.detachedContent=$.create($.Class.UNIVERSAL,$.Type.OCTETSTRING,!1,o):t.contentInfo.value.push($.create($.Class.CONTEXT_SPECIFIC,0,!0,[$.create($.Class.UNIVERSAL,$.Type.OCTETSTRING,!1,o)]))}if(t.signers.length!==0){var s=e();r(s)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(n){typeof n=="string"&&(n=Ge.pki.certificateFromPem(n)),t.certificates.push(n)},addCertificateRevokationList:function(n){throw new Error("PKCS#7 CRL support not yet implemented.")}},t;function e(){for(var n={},o=0;o<t.signers.length;++o){var s=t.signers[o],a=s.digestAlgorithm;a in n||(n[a]=Ge.md[Ge.pki.oids[a]].create()),s.authenticatedAttributes.length===0?s.md=n[a]:s.md=Ge.md[Ge.pki.oids[a]].create()}t.digestAlgorithmIdentifiers=[];for(var a in n)t.digestAlgorithmIdentifiers.push($.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,[$.create($.Class.UNIVERSAL,$.Type.OID,!1,$.oidToDer(a).getBytes()),$.create($.Class.UNIVERSAL,$.Type.NULL,!1,"")]));return n}function r(n){var o;if(t.detachedContent?o=t.detachedContent:(o=t.contentInfo.value[1],o=o.value[0]),!o)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var s=$.derToOid(t.contentInfo.value[0].value),a=$.toDer(o);a.getByte(),$.getBerValueLength(a),a=a.getBytes();for(var c in n)n[c].start().update(a);for(var u=new Date,l=0;l<t.signers.length;++l){var d=t.signers[l];if(d.authenticatedAttributes.length===0){if(s!==Ge.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{d.authenticatedAttributesAsn1=$.create($.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var p=$.create($.Class.UNIVERSAL,$.Type.SET,!0,[]),f=0;f<d.authenticatedAttributes.length;++f){var m=d.authenticatedAttributes[f];m.type===Ge.pki.oids.messageDigest?m.value=n[d.digestAlgorithm].digest():m.type===Ge.pki.oids.signingTime&&(m.value||(m.value=u)),p.value.push(Zee(m)),d.authenticatedAttributesAsn1.value.push(Zee(m))}a=$.toDer(p).getBytes(),d.md.start().update(a)}d.signature=d.key.sign(d.md,"RSASSA-PKCS1-V1_5")}t.signerInfos=cst(t.signers)}};Ia.createEncryptedData=function(){var t=null;return t={type:Ge.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:Ge.pki.oids["aes256-CBC"]},fromAsn1:function(e){ete(t,e,Ia.asn1.encryptedDataValidator)},decrypt:function(e){e!==void 0&&(t.encryptedContent.key=e),RAe(t)}},t};Ia.createEnvelopedData=function(){var t=null;return t={type:Ge.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:Ge.pki.oids["aes256-CBC"]},fromAsn1:function(e){var r=ete(t,e,Ia.asn1.envelopedDataValidator);t.recipients=ost(r.recipientInfos.value)},toAsn1:function(){return $.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,[$.create($.Class.UNIVERSAL,$.Type.OID,!1,$.oidToDer(t.type).getBytes()),$.create($.Class.CONTEXT_SPECIFIC,0,!0,[$.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,[$.create($.Class.UNIVERSAL,$.Type.INTEGER,!1,$.integerToDer(t.version).getBytes()),$.create($.Class.UNIVERSAL,$.Type.SET,!0,sst(t.recipients)),$.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,ust(t.encryptedContent))])])])},findRecipient:function(e){for(var r=e.issuer.attributes,n=0;n<t.recipients.length;++n){var o=t.recipients[n],s=o.issuer;if(o.serialNumber===e.serialNumber&&s.length===r.length){for(var a=!0,c=0;c<r.length;++c)if(s[c].type!==r[c].type||s[c].value!==r[c].value){a=!1;break}if(a)return o}}return null},decrypt:function(e,r){if(t.encryptedContent.key===void 0&&e!==void 0&&r!==void 0)switch(e.encryptedContent.algorithm){case Ge.pki.oids.rsaEncryption:case Ge.pki.oids.desCBC:var n=r.decrypt(e.encryptedContent.content);t.encryptedContent.key=Ge.util.createBuffer(n);break;default:throw new Error("Unsupported asymmetric cipher, OID "+e.encryptedContent.algorithm)}RAe(t)},addRecipient:function(e){t.recipients.push({version:0,issuer:e.issuer.attributes,serialNumber:e.serialNumber,encryptedContent:{algorithm:Ge.pki.oids.rsaEncryption,key:e.publicKey}})},encrypt:function(e,r){if(t.encryptedContent.content===void 0){r=r||t.encryptedContent.algorithm,e=e||t.encryptedContent.key;var n,o,s;switch(r){case Ge.pki.oids["aes128-CBC"]:n=16,o=16,s=Ge.aes.createEncryptionCipher;break;case Ge.pki.oids["aes192-CBC"]:n=24,o=16,s=Ge.aes.createEncryptionCipher;break;case Ge.pki.oids["aes256-CBC"]:n=32,o=16,s=Ge.aes.createEncryptionCipher;break;case Ge.pki.oids["des-EDE3-CBC"]:n=24,o=8,s=Ge.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+r)}if(e===void 0)e=Ge.util.createBuffer(Ge.random.getBytes(n));else if(e.length()!=n)throw new Error("Symmetric key has wrong length; got "+e.length()+" bytes, expected "+n+".");t.encryptedContent.algorithm=r,t.encryptedContent.key=e,t.encryptedContent.parameter=Ge.util.createBuffer(Ge.random.getBytes(o));var a=s(e);if(a.start(t.encryptedContent.parameter.copy()),a.update(t.content),!a.finish())throw new Error("Symmetric encryption failed.");t.encryptedContent.content=a.output}for(var c=0;c<t.recipients.length;++c){var u=t.recipients[c];if(u.encryptedContent.content===void 0)switch(u.encryptedContent.algorithm){case Ge.pki.oids.rsaEncryption:u.encryptedContent.content=u.encryptedContent.key.encrypt(t.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+u.encryptedContent.algorithm)}}}},t};function nst(t){var e={},r=[];if(!$.validate(t,Ia.asn1.recipientInfoValidator,e,r)){var n=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw n.errors=r,n}return{version:e.version.charCodeAt(0),issuer:Ge.pki.RDNAttributesAsArray(e.issuer),serialNumber:Ge.util.createBuffer(e.serial).toHex(),encryptedContent:{algorithm:$.derToOid(e.encAlgorithm),parameter:e.encParameter?e.encParameter.value:void 0,content:e.encKey}}}function ist(t){return $.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,[$.create($.Class.UNIVERSAL,$.Type.INTEGER,!1,$.integerToDer(t.version).getBytes()),$.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,[Ge.pki.distinguishedNameToAsn1({attributes:t.issuer}),$.create($.Class.UNIVERSAL,$.Type.INTEGER,!1,Ge.util.hexToBytes(t.serialNumber))]),$.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,[$.create($.Class.UNIVERSAL,$.Type.OID,!1,$.oidToDer(t.encryptedContent.algorithm).getBytes()),$.create($.Class.UNIVERSAL,$.Type.NULL,!1,"")]),$.create($.Class.UNIVERSAL,$.Type.OCTETSTRING,!1,t.encryptedContent.content)])}function ost(t){for(var e=[],r=0;r<t.length;++r)e.push(nst(t[r]));return e}function sst(t){for(var e=[],r=0;r<t.length;++r)e.push(ist(t[r]));return e}function ast(t){var e=$.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,[$.create($.Class.UNIVERSAL,$.Type.INTEGER,!1,$.integerToDer(t.version).getBytes()),$.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,[Ge.pki.distinguishedNameToAsn1({attributes:t.issuer}),$.create($.Class.UNIVERSAL,$.Type.INTEGER,!1,Ge.util.hexToBytes(t.serialNumber))]),$.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,[$.create($.Class.UNIVERSAL,$.Type.OID,!1,$.oidToDer(t.digestAlgorithm).getBytes()),$.create($.Class.UNIVERSAL,$.Type.NULL,!1,"")])]);if(t.authenticatedAttributesAsn1&&e.value.push(t.authenticatedAttributesAsn1),e.value.push($.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,[$.create($.Class.UNIVERSAL,$.Type.OID,!1,$.oidToDer(t.signatureAlgorithm).getBytes()),$.create($.Class.UNIVERSAL,$.Type.NULL,!1,"")])),e.value.push($.create($.Class.UNIVERSAL,$.Type.OCTETSTRING,!1,t.signature)),t.unauthenticatedAttributes.length>0){for(var r=$.create($.Class.CONTEXT_SPECIFIC,1,!0,[]),n=0;n<t.unauthenticatedAttributes.length;++n){var o=t.unauthenticatedAttributes[n];r.values.push(Zee(o))}e.value.push(r)}return e}function cst(t){for(var e=[],r=0;r<t.length;++r)e.push(ast(t[r]));return e}function Zee(t){var e;if(t.type===Ge.pki.oids.contentType)e=$.create($.Class.UNIVERSAL,$.Type.OID,!1,$.oidToDer(t.value).getBytes());else if(t.type===Ge.pki.oids.messageDigest)e=$.create($.Class.UNIVERSAL,$.Type.OCTETSTRING,!1,t.value.bytes());else if(t.type===Ge.pki.oids.signingTime){var r=new Date("1950-01-01T00:00:00Z"),n=new Date("2050-01-01T00:00:00Z"),o=t.value;if(typeof o=="string"){var s=Date.parse(o);isNaN(s)?o.length===13?o=$.utcTimeToDate(o):o=$.generalizedTimeToDate(o):o=new Date(s)}o>=r&&o<n?e=$.create($.Class.UNIVERSAL,$.Type.UTCTIME,!1,$.dateToUtcTime(o)):e=$.create($.Class.UNIVERSAL,$.Type.GENERALIZEDTIME,!1,$.dateToGeneralizedTime(o))}return $.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,[$.create($.Class.UNIVERSAL,$.Type.OID,!1,$.oidToDer(t.type).getBytes()),$.create($.Class.UNIVERSAL,$.Type.SET,!0,[e])])}function ust(t){return[$.create($.Class.UNIVERSAL,$.Type.OID,!1,$.oidToDer(Ge.pki.oids.data).getBytes()),$.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,[$.create($.Class.UNIVERSAL,$.Type.OID,!1,$.oidToDer(t.algorithm).getBytes()),t.parameter?$.create($.Class.UNIVERSAL,$.Type.OCTETSTRING,!1,t.parameter.getBytes()):void 0]),$.create($.Class.CONTEXT_SPECIFIC,0,!0,[$.create($.Class.UNIVERSAL,$.Type.OCTETSTRING,!1,t.content.getBytes())])]}function ete(t,e,r){var n={},o=[];if(!$.validate(e,r,n,o)){var s=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw s.errors=s,s}var a=$.derToOid(n.contentType);if(a!==Ge.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(n.encryptedContent){var c="";if(Ge.util.isArray(n.encryptedContent))for(var u=0;u<n.encryptedContent.length;++u){if(n.encryptedContent[u].type!==$.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");c+=n.encryptedContent[u].value}else c=n.encryptedContent;t.encryptedContent={algorithm:$.derToOid(n.encAlgorithm),parameter:Ge.util.createBuffer(n.encParameter.value),content:Ge.util.createBuffer(c)}}if(n.content){var c="";if(Ge.util.isArray(n.content))for(var u=0;u<n.content.length;++u){if(n.content[u].type!==$.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");c+=n.content[u].value}else c=n.content;t.content=Ge.util.createBuffer(c)}return t.version=n.version.charCodeAt(0),t.rawCapture=n,n}function RAe(t){if(t.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(t.content===void 0){var e;switch(t.encryptedContent.algorithm){case Ge.pki.oids["aes128-CBC"]:case Ge.pki.oids["aes192-CBC"]:case Ge.pki.oids["aes256-CBC"]:e=Ge.aes.createDecryptionCipher(t.encryptedContent.key);break;case Ge.pki.oids.desCBC:case Ge.pki.oids["des-EDE3-CBC"]:e=Ge.des.createDecryptionCipher(t.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+t.encryptedContent.algorithm)}if(e.start(t.encryptedContent.parameter),e.update(t.encryptedContent.content),!e.finish())throw new Error("Symmetric decryption failed.");t.content=e.output}}});var DAe=L((v5r,PAe)=>{var fo=tr();$v();kT();T9();NT();Or();var K9=PAe.exports=fo.ssh=fo.ssh||{};K9.privateKeyToPutty=function(t,e,r){r=r||"",e=e||"";var n="ssh-rsa",o=e===""?"none":"aes256-cbc",s="PuTTY-User-Key-File-2: "+n+`\r
`;s+="Encryption: "+o+`\r
`,s+="Comment: "+r+`\r
`;var a=fo.util.createBuffer();HT(a,n),Tp(a,t.e),Tp(a,t.n);var c=fo.util.encode64(a.bytes(),64),u=Math.floor(c.length/66)+1;s+="Public-Lines: "+u+`\r
`,s+=c;var l=fo.util.createBuffer();Tp(l,t.d),Tp(l,t.p),Tp(l,t.q),Tp(l,t.qInv);var d;if(!e)d=fo.util.encode64(l.bytes(),64);else{var p=l.length()+16-1;p-=p%16;var f=W9(l.bytes());f.truncate(f.length()-p+l.length()),l.putBuffer(f);var m=fo.util.createBuffer();m.putBuffer(W9("\0\0\0\0",e)),m.putBuffer(W9("\0\0\0",e));var h=fo.aes.createEncryptionCipher(m.truncate(8),"CBC");h.start(fo.util.createBuffer().fillWithByte(0,16)),h.update(l.copy()),h.finish();var g=h.output;g.truncate(16),d=fo.util.encode64(g.bytes(),64)}u=Math.floor(d.length/66)+1,s+=`\r
Private-Lines: `+u+`\r
`,s+=d;var v=W9("putty-private-key-file-mac-key",e),y=fo.util.createBuffer();HT(y,n),HT(y,o),HT(y,r),y.putInt32(a.length()),y.putBuffer(a),y.putInt32(l.length()),y.putBuffer(l);var _=fo.hmac.create();return _.start("sha1",v),_.update(y.bytes()),s+=`\r
Private-MAC: `+_.digest().toHex()+`\r
`,s};K9.publicKeyToOpenSSH=function(t,e){var r="ssh-rsa";e=e||"";var n=fo.util.createBuffer();return HT(n,r),Tp(n,t.e),Tp(n,t.n),r+" "+fo.util.encode64(n.bytes())+" "+e};K9.privateKeyToOpenSSH=function(t,e){return e?fo.pki.encryptRsaPrivateKey(t,e,{legacy:!0,algorithm:"aes128"}):fo.pki.privateKeyToPem(t)};K9.getPublicKeyFingerprint=function(t,e){e=e||{};var r=e.md||fo.md.md5.create(),n="ssh-rsa",o=fo.util.createBuffer();HT(o,n),Tp(o,t.e),Tp(o,t.n),r.start(),r.update(o.getBytes());var s=r.digest();if(e.encoding==="hex"){var a=s.toHex();return e.delimiter?a.match(/.{2}/g).join(e.delimiter):a}else{if(e.encoding==="binary")return s.getBytes();if(e.encoding)throw new Error('Unknown encoding "'+e.encoding+'".')}return s};function Tp(t,e){var r=e.toString(16);r[0]>="8"&&(r="00"+r);var n=fo.util.hexToBytes(r);t.putInt32(n.length),t.putBytes(n)}function HT(t,e){t.putInt32(e.length),t.putString(e)}function W9(){for(var t=fo.md.sha1.create(),e=arguments.length,r=0;r<e;++r)t.update(arguments[r]);return t.digest()}});var LAe=L((y5r,NAe)=>{NAe.exports=tr();$v();Z2e();Ll();y9();bA();vAe();kT();xAe();TAe();wAe();Eee();k9();Xb();_ee();kee();AAe();Pee();See();pee();M9();Mu();hee();DAe();Fee();Or()});var OAe=L((b5r,lst)=>{lst.exports={name:"@roamhq/mac-ca",version:"1.0.7",description:"Get Mac OS Root certificates",main:"index.js",repository:{type:"git",url:"https://github.com/WonderInventions/mac-ca.git"},scripts:{test:'echo "Error: no test specified" && exit 1',lint:"eslint ."},license:"BSD-3-Clause",dependencies:{"node-forge":"^1.3.1"},devDependencies:{eslint:"^8.22.0"}}});var UAe=L((_5r,tte)=>{var Q9=LAe(),MAe=OAe(),Y9=tte.exports.validFormats={der:0,pem:1,txt:2,asn1:3};function FAe(t){let e=Q9.pki.pemToDer(t),r=Q9.asn1,n=r.fromDer(e.data.toString("binary")).value[0].value,o=n[0],s=o.tagClass===r.Class.CONTEXT_SPECIFIC&&o.type===0&&o.constructed,a=n.slice(s);return{serial:a[0],issuer:a[2],valid:a[3],subject:a[4]}}function dst(t){let e=FAe(t),r=new Date,n=e.subject.value.map(a=>a.value[0].value[1].value).join("/"),o=e.valid.value.map(a=>a.value).join(" - "),s=r.toTimeString().replace(/\s*\(.*\)\s*/,"");return[`Subject	${n}`,`Valid	${o}`,`Saved	${r.toLocaleDateString()} ${s} by ${MAe.name}@${MAe.version}`,String(t)].join(`
`)}tte.exports.transform=function(t){return function(e){try{switch(t){case Y9.der:return Q9.pki.pemToDer(e);case Y9.pem:return e;case Y9.txt:return dst(e);case Y9.asn1:return FAe(e);default:return Q9.pki.certificateFromPem(e)}}catch{return}}}});var BAe=L((x5r,jT)=>{var rte=require("https"),nte=UAe();if(process.platform!=="darwin")jT.exports.all=()=>[],jT.exports.each=()=>{};else{let c=function(l,d,p){return p.indexOf(l)===d};pst=c;let t=require("child_process"),e=/(?=-----BEGIN\sCERTIFICATE-----)/g,r="/System/Library/Keychains/SystemRootCertificates.keychain",n=["find-certificate","-a","-p"],o=t.spawnSync("/usr/bin/security",n).stdout.toString().split(e),s=t.spawnSync("/usr/bin/security",n.concat(r)).stdout.toString().split(e);rte.globalAgent.options.ca=rte.globalAgent.options.ca||[];let a=rte.globalAgent.options.ca,u=o.concat(s);u.filter(c).forEach(l=>a.push(l)),jT.exports.der2=nte.validFormats,jT.exports.all=function(l){return u.map(nte.transform(l)).filter(d=>d)},jT.exports.each=function(l,d){return typeof l=="function"&&(d=l,l=void 0),u.map(nte.transform(l)).filter(p=>p).forEach(d)}}var pst});var Ite=L((X5r,KAe)=>{var AA=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,xst=typeof AbortController=="function",Z9=xst?AbortController:class{constructor(){this.signal=new VAe}abort(){this.signal.dispatchEvent("abort")}},Sst=typeof AbortSignal=="function",Ist=typeof Z9.AbortSignal=="function",VAe=Sst?AbortSignal:Ist?Z9.AbortController:class{constructor(){this.aborted=!1,this._listeners=[]}dispatchEvent(e){if(e==="abort"){this.aborted=!0;let r={type:e,target:this};this.onabort(r),this._listeners.forEach(n=>n(r),this)}}onabort(){}addEventListener(e,r){e==="abort"&&this._listeners.push(r)}removeEventListener(e,r){e==="abort"&&(this._listeners=this._listeners.filter(n=>n!==r))}},xte=new Set,yte=(t,e)=>{let r=`LRU_CACHE_OPTION_${t}`;e7(r)&&Ste(r,`${t} option`,`options.${e}`,$T)},bte=(t,e)=>{let r=`LRU_CACHE_METHOD_${t}`;if(e7(r)){let{prototype:n}=$T,{get:o}=Object.getOwnPropertyDescriptor(n,t);Ste(r,`${t} method`,`cache.${e}()`,o)}},Cst=(t,e)=>{let r=`LRU_CACHE_PROPERTY_${t}`;if(e7(r)){let{prototype:n}=$T,{get:o}=Object.getOwnPropertyDescriptor(n,t);Ste(r,`${t} property`,`cache.${e}`,o)}},$Ae=(...t)=>{typeof process=="object"&&process&&typeof process.emitWarning=="function"?process.emitWarning(...t):console.error(...t)},e7=t=>!xte.has(t),Ste=(t,e,r,n)=>{xte.add(t);let o=`The ${e} is deprecated. Please use ${r} instead.`;$Ae(o,"DeprecationWarning",t,n)},o_=t=>t&&t===Math.floor(t)&&t>0&&isFinite(t),WAe=t=>o_(t)?t<=Math.pow(2,8)?Uint8Array:t<=Math.pow(2,16)?Uint16Array:t<=Math.pow(2,32)?Uint32Array:t<=Number.MAX_SAFE_INTEGER?VT:null:null,VT=class extends Array{constructor(e){super(e),this.fill(0)}},_te=class{constructor(e){if(e===0)return[];let r=WAe(e);this.heap=new r(e),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}},$T=class t{constructor(e={}){let{max:r=0,ttl:n,ttlResolution:o=1,ttlAutopurge:s,updateAgeOnGet:a,updateAgeOnHas:c,allowStale:u,dispose:l,disposeAfter:d,noDisposeOnSet:p,noUpdateTTL:f,maxSize:m=0,sizeCalculation:h,fetchMethod:g,fetchContext:v,noDeleteOnFetchRejection:y,noDeleteOnStaleGet:_}=e,{length:b,maxAge:S,stale:I}=e instanceof t?{}:e;if(r!==0&&!o_(r))throw new TypeError("max option must be a nonnegative integer");let w=r?WAe(r):Array;if(!w)throw new Error("invalid max value: "+r);if(this.max=r,this.maxSize=m,this.sizeCalculation=h||b,this.sizeCalculation){if(!this.maxSize)throw new TypeError("cannot set sizeCalculation without setting maxSize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(this.fetchMethod=g||null,this.fetchMethod&&typeof this.fetchMethod!="function")throw new TypeError("fetchMethod must be a function if specified");if(this.fetchContext=v,!this.fetchMethod&&v!==void 0)throw new TypeError("cannot set fetchContext without fetchMethod");if(this.keyMap=new Map,this.keyList=new Array(r).fill(null),this.valList=new Array(r).fill(null),this.next=new w(r),this.prev=new w(r),this.head=0,this.tail=0,this.free=new _te(r),this.initialFill=1,this.size=0,typeof l=="function"&&(this.dispose=l),typeof d=="function"?(this.disposeAfter=d,this.disposed=[]):(this.disposeAfter=null,this.disposed=null),this.noDisposeOnSet=!!p,this.noUpdateTTL=!!f,this.noDeleteOnFetchRejection=!!y,this.maxSize!==0){if(!o_(this.maxSize))throw new TypeError("maxSize must be a positive integer if specified");this.initializeSizeTracking()}if(this.allowStale=!!u||!!I,this.noDeleteOnStaleGet=!!_,this.updateAgeOnGet=!!a,this.updateAgeOnHas=!!c,this.ttlResolution=o_(o)||o===0?o:1,this.ttlAutopurge=!!s,this.ttl=n||S||0,this.ttl){if(!o_(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.initializeTTLTracking()}if(this.max===0&&this.ttl===0&&this.maxSize===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.max&&!this.maxSize){let O="LRU_CACHE_UNBOUNDED";e7(O)&&(xte.add(O),$Ae("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",O,t))}I&&yte("stale","allowStale"),S&&yte("maxAge","ttl"),b&&yte("length","sizeCalculation")}getRemainingTTL(e){return this.has(e,{updateAgeOnHas:!1})?1/0:0}initializeTTLTracking(){this.ttls=new VT(this.max),this.starts=new VT(this.max),this.setItemTTL=(n,o,s=AA.now())=>{if(this.starts[n]=o!==0?s:0,this.ttls[n]=o,o!==0&&this.ttlAutopurge){let a=setTimeout(()=>{this.isStale(n)&&this.delete(this.keyList[n])},o+1);a.unref&&a.unref()}},this.updateItemAge=n=>{this.starts[n]=this.ttls[n]!==0?AA.now():0};let e=0,r=()=>{let n=AA.now();if(this.ttlResolution>0){e=n;let o=setTimeout(()=>e=0,this.ttlResolution);o.unref&&o.unref()}return n};this.getRemainingTTL=n=>{let o=this.keyMap.get(n);return o===void 0?0:this.ttls[o]===0||this.starts[o]===0?1/0:this.starts[o]+this.ttls[o]-(e||r())},this.isStale=n=>this.ttls[n]!==0&&this.starts[n]!==0&&(e||r())-this.starts[n]>this.ttls[n]}updateItemAge(e){}setItemTTL(e,r,n){}isStale(e){return!1}initializeSizeTracking(){this.calculatedSize=0,this.sizes=new VT(this.max),this.removeItemSize=e=>{this.calculatedSize-=this.sizes[e],this.sizes[e]=0},this.requireSize=(e,r,n,o)=>{if(!o_(n))if(o){if(typeof o!="function")throw new TypeError("sizeCalculation must be a function");if(n=o(r,e),!o_(n))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer)");return n},this.addItemSize=(e,r)=>{this.sizes[e]=r;let n=this.maxSize-this.sizes[e];for(;this.calculatedSize>n;)this.evict(!0);this.calculatedSize+=this.sizes[e]}}removeItemSize(e){}addItemSize(e,r){}requireSize(e,r,n,o){if(n||o)throw new TypeError("cannot set size without setting maxSize on cache")}*indexes({allowStale:e=this.allowStale}={}){if(this.size)for(let r=this.tail;!(!this.isValidIndex(r)||((e||!this.isStale(r))&&(yield r),r===this.head));)r=this.prev[r]}*rindexes({allowStale:e=this.allowStale}={}){if(this.size)for(let r=this.head;!(!this.isValidIndex(r)||((e||!this.isStale(r))&&(yield r),r===this.tail));)r=this.next[r]}isValidIndex(e){return this.keyMap.get(this.keyList[e])===e}*entries(){for(let e of this.indexes())yield[this.keyList[e],this.valList[e]]}*rentries(){for(let e of this.rindexes())yield[this.keyList[e],this.valList[e]]}*keys(){for(let e of this.indexes())yield this.keyList[e]}*rkeys(){for(let e of this.rindexes())yield this.keyList[e]}*values(){for(let e of this.indexes())yield this.valList[e]}*rvalues(){for(let e of this.rindexes())yield this.valList[e]}[Symbol.iterator](){return this.entries()}find(e,r={}){for(let n of this.indexes())if(e(this.valList[n],this.keyList[n],this))return this.get(this.keyList[n],r)}forEach(e,r=this){for(let n of this.indexes())e.call(r,this.valList[n],this.keyList[n],this)}rforEach(e,r=this){for(let n of this.rindexes())e.call(r,this.valList[n],this.keyList[n],this)}get prune(){return bte("prune","purgeStale"),this.purgeStale}purgeStale(){let e=!1;for(let r of this.rindexes({allowStale:!0}))this.isStale(r)&&(this.delete(this.keyList[r]),e=!0);return e}dump(){let e=[];for(let r of this.indexes({allowStale:!0})){let n=this.keyList[r],o=this.valList[r],a={value:this.isBackgroundFetch(o)?o.__staleWhileFetching:o};if(this.ttls){a.ttl=this.ttls[r];let c=AA.now()-this.starts[r];a.start=Math.floor(Date.now()-c)}this.sizes&&(a.size=this.sizes[r]),e.unshift([n,a])}return e}load(e){this.clear();for(let[r,n]of e){if(n.start){let o=Date.now()-n.start;n.start=AA.now()-o}this.set(r,n.value,n)}}dispose(e,r,n){}set(e,r,{ttl:n=this.ttl,start:o,noDisposeOnSet:s=this.noDisposeOnSet,size:a=0,sizeCalculation:c=this.sizeCalculation,noUpdateTTL:u=this.noUpdateTTL}={}){if(a=this.requireSize(e,r,a,c),this.maxSize&&a>this.maxSize)return this;let l=this.size===0?void 0:this.keyMap.get(e);if(l===void 0)l=this.newIndex(),this.keyList[l]=e,this.valList[l]=r,this.keyMap.set(e,l),this.next[this.tail]=l,this.prev[l]=this.tail,this.tail=l,this.size++,this.addItemSize(l,a),u=!1;else{let d=this.valList[l];r!==d&&(this.isBackgroundFetch(d)?d.__abortController.abort():s||(this.dispose(d,e,"set"),this.disposeAfter&&this.disposed.push([d,e,"set"])),this.removeItemSize(l),this.valList[l]=r,this.addItemSize(l,a)),this.moveToTail(l)}if(n!==0&&this.ttl===0&&!this.ttls&&this.initializeTTLTracking(),u||this.setItemTTL(l,n,o),this.disposeAfter)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return this}newIndex(){return this.size===0?this.tail:this.size===this.max&&this.max!==0?this.evict(!1):this.free.length!==0?this.free.pop():this.initialFill++}pop(){if(this.size){let e=this.valList[this.head];return this.evict(!0),e}}evict(e){let r=this.head,n=this.keyList[r],o=this.valList[r];return this.isBackgroundFetch(o)?o.__abortController.abort():(this.dispose(o,n,"evict"),this.disposeAfter&&this.disposed.push([o,n,"evict"])),this.removeItemSize(r),e&&(this.keyList[r]=null,this.valList[r]=null,this.free.push(r)),this.head=this.next[r],this.keyMap.delete(n),this.size--,r}has(e,{updateAgeOnHas:r=this.updateAgeOnHas}={}){let n=this.keyMap.get(e);return n!==void 0&&!this.isStale(n)?(r&&this.updateItemAge(n),!0):!1}peek(e,{allowStale:r=this.allowStale}={}){let n=this.keyMap.get(e);if(n!==void 0&&(r||!this.isStale(n))){let o=this.valList[n];return this.isBackgroundFetch(o)?o.__staleWhileFetching:o}}backgroundFetch(e,r,n,o){let s=r===void 0?void 0:this.valList[r];if(this.isBackgroundFetch(s))return s;let a=new Z9,c={signal:a.signal,options:n,context:o},u=f=>(a.signal.aborted||this.set(e,f,c.options),f),l=f=>{if(this.valList[r]===p&&(!n.noDeleteOnFetchRejection||p.__staleWhileFetching===void 0?this.delete(e):this.valList[r]=p.__staleWhileFetching),p.__returned===p)throw f},d=f=>f(this.fetchMethod(e,s,c)),p=new Promise(d).then(u,l);return p.__abortController=a,p.__staleWhileFetching=s,p.__returned=null,r===void 0?(this.set(e,p,c.options),r=this.keyMap.get(e)):this.valList[r]=p,p}isBackgroundFetch(e){return e&&typeof e=="object"&&typeof e.then=="function"&&Object.prototype.hasOwnProperty.call(e,"__staleWhileFetching")&&Object.prototype.hasOwnProperty.call(e,"__returned")&&(e.__returned===e||e.__returned===null)}async fetch(e,{allowStale:r=this.allowStale,updateAgeOnGet:n=this.updateAgeOnGet,noDeleteOnStaleGet:o=this.noDeleteOnStaleGet,ttl:s=this.ttl,noDisposeOnSet:a=this.noDisposeOnSet,size:c=0,sizeCalculation:u=this.sizeCalculation,noUpdateTTL:l=this.noUpdateTTL,noDeleteOnFetchRejection:d=this.noDeleteOnFetchRejection,fetchContext:p=this.fetchContext,forceRefresh:f=!1}={}){if(!this.fetchMethod)return this.get(e,{allowStale:r,updateAgeOnGet:n,noDeleteOnStaleGet:o});let m={allowStale:r,updateAgeOnGet:n,noDeleteOnStaleGet:o,ttl:s,noDisposeOnSet:a,size:c,sizeCalculation:u,noUpdateTTL:l,noDeleteOnFetchRejection:d},h=this.keyMap.get(e);if(h===void 0){let g=this.backgroundFetch(e,h,m,p);return g.__returned=g}else{let g=this.valList[h];if(this.isBackgroundFetch(g))return r&&g.__staleWhileFetching!==void 0?g.__staleWhileFetching:g.__returned=g;if(!f&&!this.isStale(h))return this.moveToTail(h),n&&this.updateItemAge(h),g;let v=this.backgroundFetch(e,h,m,p);return r&&v.__staleWhileFetching!==void 0?v.__staleWhileFetching:v.__returned=v}}get(e,{allowStale:r=this.allowStale,updateAgeOnGet:n=this.updateAgeOnGet,noDeleteOnStaleGet:o=this.noDeleteOnStaleGet}={}){let s=this.keyMap.get(e);if(s!==void 0){let a=this.valList[s],c=this.isBackgroundFetch(a);return this.isStale(s)?c?r?a.__staleWhileFetching:void 0:(o||this.delete(e),r?a:void 0):c?void 0:(this.moveToTail(s),n&&this.updateItemAge(s),a)}}connect(e,r){this.prev[r]=e,this.next[e]=r}moveToTail(e){e!==this.tail&&(e===this.head?this.head=this.next[e]:this.connect(this.prev[e],this.next[e]),this.connect(this.tail,e),this.tail=e)}get del(){return bte("del","delete"),this.delete}delete(e){let r=!1;if(this.size!==0){let n=this.keyMap.get(e);if(n!==void 0)if(r=!0,this.size===1)this.clear();else{this.removeItemSize(n);let o=this.valList[n];this.isBackgroundFetch(o)?o.__abortController.abort():(this.dispose(o,e,"delete"),this.disposeAfter&&this.disposed.push([o,e,"delete"])),this.keyMap.delete(e),this.keyList[n]=null,this.valList[n]=null,n===this.tail?this.tail=this.prev[n]:n===this.head?this.head=this.next[n]:(this.next[this.prev[n]]=this.next[n],this.prev[this.next[n]]=this.prev[n]),this.size--,this.free.push(n)}}if(this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return r}clear(){for(let e of this.rindexes({allowStale:!0})){let r=this.valList[e];if(this.isBackgroundFetch(r))r.__abortController.abort();else{let n=this.keyList[e];this.dispose(r,n,"delete"),this.disposeAfter&&this.disposed.push([r,n,"delete"])}}if(this.keyMap.clear(),this.valList.fill(null),this.keyList.fill(null),this.ttls&&(this.ttls.fill(0),this.starts.fill(0)),this.sizes&&this.sizes.fill(0),this.head=0,this.tail=0,this.initialFill=1,this.free.length=0,this.calculatedSize=0,this.size=0,this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift())}get reset(){return bte("reset","clear"),this.clear}get length(){return Cst("length","size"),this.size}static get AbortController(){return Z9}static get AbortSignal(){return VAe}};KAe.exports=$T});var Ete=L((J5r,YAe)=>{"use strict";var PA=class extends Error{constructor(e,r){super(e),this.type=r}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}},Cte=class extends PA{constructor(e,r,n){super(e,r),n&&(this.code=n.code,this.errno=n.errno,this.erroredSysCall=n.syscall)}},Tte=class extends PA{constructor(e,r="aborted"){super(e,r)}};YAe.exports={FetchBaseError:PA,FetchError:Cte,AbortError:Tte}});var xm=L((Z5r,XAe)=>{"use strict";var{constants:{MAX_LENGTH:Tst}}=require("buffer"),{pipeline:t7,PassThrough:Est}=require("stream"),{promisify:wst}=require("util"),{createGunzip:Rst,createInflate:kst,createBrotliDecompress:Ast,constants:{Z_SYNC_FLUSH:QAe}}=require("zlib"),Pst=al()("helix-fetch:utils"),Dst=wst(t7),Nst=(t,e)=>t===204||t===304||+e["content-length"]==0?!1:/^\s*(?:(x-)?deflate|(x-)?gzip|br)\s*$/.test(e["content-encoding"]),Lst=(t,e,r,n)=>{if(!Nst(t,e))return r;let o=s=>{s&&(Pst(`encountered error while decoding stream: ${s}`),n(s))};switch(e["content-encoding"].trim()){case"gzip":case"x-gzip":return t7(r,Rst({flush:QAe,finishFlush:QAe}),o);case"deflate":case"x-deflate":return t7(r,kst(),o);case"br":return t7(r,Ast(),o);default:return r}},Ost=t=>{if(!t||typeof t!="object"||Object.prototype.toString.call(t)!=="[object Object]")return!1;if(Object.getPrototypeOf(t)===null)return!0;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e},r7=(t,e)=>{if(Buffer.isBuffer(t))return t.length;switch(typeof t){case"string":return t.length*2;case"boolean":return 4;case"number":return 8;case"symbol":return Symbol.keyFor(t)?Symbol.keyFor(t).length*2:(t.toString().length-8)*2;case"object":return Array.isArray(t)?Mst(t,e):Fst(t,e);default:return 0}},Mst=(t,e)=>(e.add(t),t.map(r=>e.has(r)?0:r7(r,e)).reduce((r,n)=>r+n,0)),Fst=(t,e)=>{if(t==null)return 0;e.add(t);let r=0,n=[];for(let o in t)n.push(o);return n.push(...Object.getOwnPropertySymbols(t)),n.forEach(o=>{if(r+=r7(o,e),typeof t[o]=="object"&&t[o]!==null){if(e.has(t[o]))return;e.add(t[o])}r+=r7(t[o],e)}),r},Ust=t=>r7(t,new WeakSet),Bst=async t=>{let e=new Est,r=0,n=[];return e.on("data",o=>{if(r+o.length>Tst)throw new Error("Buffer.constants.MAX_SIZE exceeded");n.push(o),r+=o.length}),await Dst(t,e),Buffer.concat(n,r)};XAe.exports={decodeStream:Lst,isPlainObject:Ost,sizeof:Ust,streamToBuffer:Bst}});var i7=L((e6r,tPe)=>{"use strict";var{PassThrough:JAe,Readable:Sm}=require("stream"),{types:{isAnyArrayBuffer:ePe}}=require("util"),{FetchError:qst,FetchBaseError:Hst}=Ete(),{streamToBuffer:jst}=xm(),zst=Buffer.alloc(0),ju=Symbol("Body internals"),Gst=t=>t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength),ZAe=async t=>{if(t[ju].disturbed)throw new TypeError("Already read");if(t[ju].error)throw new TypeError(`Stream had error: ${t[ju].error.message}`);t[ju].disturbed=!0;let{stream:e}=t[ju];return e===null?zst:jst(e)},n7=class{constructor(e){let r;e==null?r=null:e instanceof URLSearchParams?r=Sm.from(e.toString()):e instanceof Sm?r=e:Buffer.isBuffer(e)?r=Sm.from(e):ePe(e)?r=Sm.from(Buffer.from(e)):typeof e=="string"||e instanceof String?r=Sm.from(e):r=Sm.from(String(e)),this[ju]={stream:r,disturbed:!1,error:null},e instanceof Sm&&r.on("error",n=>{let o=n instanceof Hst?n:new qst(`Invalid response body while trying to fetch ${this.url}: ${n.message}`,"system",n);this[ju].error=o})}get body(){return this[ju].stream}get bodyUsed(){return this[ju].disturbed}async buffer(){return ZAe(this)}async arrayBuffer(){return Gst(await this.buffer())}async text(){return(await ZAe(this)).toString()}async json(){return JSON.parse(await this.text())}};Object.defineProperties(n7.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}});var Vst=t=>{if(t[ju].disturbed)throw new TypeError("Cannot clone: already read");let{stream:e}=t[ju],r=e;if(e instanceof Sm){r=new JAe;let n=new JAe;e.pipe(r),e.pipe(n),t[ju].stream=n}return r},$st=t=>t===null?null:typeof t=="string"?"text/plain; charset=utf-8":t instanceof URLSearchParams?"application/x-www-form-urlencoded; charset=utf-8":Buffer.isBuffer(t)||ePe(t)||t instanceof Sm?null:"text/plain; charset=utf-8";tPe.exports={Body:n7,cloneStream:Vst,guessContentType:$st}});var WT=L((t6r,oPe)=>{"use strict";var{validateHeaderName:rPe,validateHeaderValue:nPe}=require("http"),{isPlainObject:Wst}=xm(),Im=Symbol("Headers internals"),DA=t=>{let e=typeof t!="string"?String(t):t;if(typeof rPe=="function")rPe(e);else if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(e)){let r=new TypeError(`Header name must be a valid HTTP token [${e}]`);throw Object.defineProperty(r,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),r}return e.toLowerCase()},iPe=(t,e)=>{let r=typeof t!="string"?String(t):t;if(typeof nPe=="function")nPe(e,r);else if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(r)){let n=new TypeError(`Invalid character in header content ["${e}"]`);throw Object.defineProperty(n,"code",{value:"ERR_INVALID_CHAR"}),n}return r},o7=class t{constructor(e={}){if(this[Im]={map:new Map},e instanceof t)e.forEach((r,n)=>{this.append(n,r)});else if(Array.isArray(e))e.forEach(([r,n])=>{this.append(r,n)});else if(Wst(e))for(let[r,n]of Object.entries(e))this.append(r,n)}set(e,r){this[Im].map.set(DA(e),iPe(r,e))}has(e){return this[Im].map.has(DA(e))}get(e){let r=this[Im].map.get(DA(e));return r===void 0?null:r}append(e,r){let n=DA(e),o=iPe(r,e),s=this[Im].map.get(n);this[Im].map.set(n,s?`${s}, ${o}`:o)}delete(e){this[Im].map.delete(DA(e))}forEach(e,r){for(let n of this.keys())e.call(r,this.get(n),n)}keys(){return Array.from(this[Im].map.keys()).sort()}*values(){for(let e of this.keys())yield this.get(e)}*entries(){for(let e of this.keys())yield[e,this.get(e)]}[Symbol.iterator](){return this.entries()}get[Symbol.toStringTag](){return this.constructor.name}plain(){return Object.fromEntries(this[Im].map)}};Object.defineProperties(o7.prototype,["append","delete","entries","forEach","get","has","keys","set","values"].reduce((t,e)=>(t[e]={enumerable:!0},t),{}));oPe.exports={Headers:o7}});var wte=L((r6r,sPe)=>{"use strict";var{EventEmitter:Kst}=require("events"),Ml=Symbol("AbortSignal internals"),KT=class{constructor(){this[Ml]={eventEmitter:new Kst,onabort:null,aborted:!1}}get aborted(){return this[Ml].aborted}get onabort(){return this[Ml].onabort}set onabort(e){this[Ml].onabort=e}get[Symbol.toStringTag](){return this.constructor.name}removeEventListener(e,r){this[Ml].eventEmitter.removeListener(e,r)}addEventListener(e,r){this[Ml].eventEmitter.on(e,r)}dispatchEvent(e){let r={type:e,target:this},n=`on${e}`;typeof this[Ml][n]=="function"&&this[n](r),this[Ml].eventEmitter.emit(e,r)}fire(){this[Ml].aborted=!0,this.dispatchEvent("abort")}};Object.defineProperties(KT.prototype,{addEventListener:{enumerable:!0},removeEventListener:{enumerable:!0},dispatchEvent:{enumerable:!0},aborted:{enumerable:!0},onabort:{enumerable:!0}});var a7=class extends KT{constructor(e){if(!Number.isInteger(e))throw new TypeError(`Expected an integer, got ${typeof e}`);super(),this[Ml].timerId=setTimeout(()=>{this.fire()},e)}clear(){clearTimeout(this[Ml].timerId)}};Object.defineProperties(a7.prototype,{clear:{enumerable:!0}});var s7=Symbol("AbortController internals"),c7=class{constructor(){this[s7]={signal:new KT}}get signal(){return this[s7].signal}get[Symbol.toStringTag](){return this.constructor.name}abort(){this[s7].signal.aborted||this[s7].signal.fire()}};Object.defineProperties(c7.prototype,{signal:{enumerable:!0},abort:{enumerable:!0}});sPe.exports={AbortController:c7,AbortSignal:KT,TimeoutSignal:a7}});var NA=L((n6r,uPe)=>{"use strict";var{randomBytes:Yst}=require("crypto"),{Readable:Qst}=require("stream"),kte=t=>typeof t=="object"&&["arrayBuffer","stream","text","slice","constructor"].map(e=>typeof t[e]).filter(e=>e!=="function").length===0&&typeof t.type=="string"&&typeof t.size=="number"&&/^(Blob|File)$/.test(t[Symbol.toStringTag]),Xst=t=>t!=null&&typeof t=="object"&&["append","delete","get","getAll","has","set","keys","values","entries","constructor"].map(e=>typeof t[e]).filter(e=>e!=="function").length===0&&t[Symbol.toStringTag]==="FormData",aPe=t=>`--${t}--\r
\r
`,cPe=(t,e,r)=>{let n="";return n+=`--${t}\r
`,n+=`Content-Disposition: form-data; name="${e}"`,kte(r)&&(n+=`; filename="${r.name}"\r
`,n+=`Content-Type: ${r.type||"application/octet-stream"}`),`${n}\r
\r
`};async function*Jst(t,e){for(let[r,n]of t)yield cPe(e,r,n),kte(n)?yield*n.stream():yield n,yield`\r
`;yield aPe(e)}var Zst=(t,e)=>{let r=0;for(let[n,o]of t)r+=Buffer.byteLength(cPe(e,n,o)),r+=kte(o)?o.size:Buffer.byteLength(String(o)),r+=Buffer.byteLength(`\r
`);return r+=Buffer.byteLength(aPe(e)),r},Rte=class{constructor(e){this.fd=e,this.boundary=Yst(8).toString("hex")}length(){return typeof this._length>"u"&&(this._length=Zst(this.fd,this.boundary)),this._length}contentType(){return`multipart/form-data; boundary=${this.boundary}`}stream(){return Qst.from(Jst(this.fd,this.boundary))}};uPe.exports={isFormData:Xst,FormDataSerializer:Rte}});var dPe=L((i6r,lPe)=>{"use strict";var{AbortSignal:eat}=wte(),{Body:tat,cloneStream:rat,guessContentType:nat}=i7(),{Headers:iat}=WT(),{isPlainObject:oat}=xm(),{isFormData:sat,FormDataSerializer:aat}=NA(),cat=20,t0=Symbol("Request internals"),u7=class t extends tat{constructor(e,r={}){let n=e instanceof t?e:null,o=n?new URL(n.url):new URL(e),s=r.method||n&&n.method||"GET";if(s=s.toUpperCase(),(r.body!=null||n&&n.body!==null)&&["GET","HEAD"].includes(s))throw new TypeError("Request with GET/HEAD method cannot have body");let a=r.body||(n&&n.body?rat(n):null),c=new iat(r.headers||n&&n.headers||{});if(sat(a)&&!c.has("content-type")){let p=new aat(a);a=p.stream(),c.set("content-type",p.contentType()),!c.has("transfer-encoding")&&!c.has("content-length")&&c.set("content-length",p.length())}if(!c.has("content-type"))if(oat(a))a=JSON.stringify(a),c.set("content-type","application/json");else{let p=nat(a);p&&c.set("content-type",p)}super(a);let u=n?n.signal:null;if("signal"in r&&(u=r.signal),u&&!(u instanceof eat))throw new TypeError("signal needs to be an instance of AbortSignal");let l=r.redirect||n&&n.redirect||"follow";if(!["follow","error","manual"].includes(l))throw new TypeError(`'${l}' is not a valid redirect option`);let d=r.cache||n&&n.cache||"default";if(!["default","no-store","reload","no-cache","force-cache","only-if-cached"].includes(d))throw new TypeError(`'${d}' is not a valid cache option`);this[t0]={init:{...r},method:s,redirect:l,cache:d,headers:c,parsedURL:o,signal:u},r.follow===void 0?!n||n.follow===void 0?this.follow=cat:this.follow=n.follow:this.follow=r.follow,this.counter=r.counter||n&&n.counter||0,r.compress===void 0?!n||n.compress===void 0?this.compress=!0:this.compress=n.compress:this.compress=r.compress,r.decode===void 0?!n||n.decode===void 0?this.decode=!0:this.decode=n.decode:this.decode=r.decode}get method(){return this[t0].method}get url(){return this[t0].parsedURL.toString()}get headers(){return this[t0].headers}get redirect(){return this[t0].redirect}get cache(){return this[t0].cache}get signal(){return this[t0].signal}clone(){return new t(this)}get init(){return this[t0].init}get[Symbol.toStringTag](){return this.constructor.name}};Object.defineProperties(u7.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},cache:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0}});lPe.exports={Request:u7}});var Ate=L((o6r,pPe)=>{"use strict";var{Body:uat,cloneStream:lat,guessContentType:dat}=i7(),{Headers:pat}=WT(),{isPlainObject:fat}=xm(),{isFormData:mat,FormDataSerializer:hat}=NA(),Fl=Symbol("Response internals"),l7=class t extends uat{constructor(e=null,r={}){let n=new pat(r.headers),o=e;if(mat(o)&&!n.has("content-type")){let s=new hat(o);o=s.stream(),n.set("content-type",s.contentType()),!n.has("transfer-encoding")&&!n.has("content-length")&&n.set("content-length",s.length())}if(o!==null&&!n.has("content-type"))if(fat(o))o=JSON.stringify(o),n.set("content-type","application/json");else{let s=dat(o);s&&n.set("content-type",s)}super(o),this[Fl]={url:r.url,status:r.status||200,statusText:r.statusText||"",headers:n,httpVersion:r.httpVersion,decoded:r.decoded,counter:r.counter}}get url(){return this[Fl].url||""}get status(){return this[Fl].status}get statusText(){return this[Fl].statusText}get ok(){return this[Fl].status>=200&&this[Fl].status<300}get redirected(){return this[Fl].counter>0}get headers(){return this[Fl].headers}get httpVersion(){return this[Fl].httpVersion}get decoded(){return this[Fl].decoded}static redirect(e,r=302){if(![301,302,303,307,308].includes(r))throw new RangeError("Invalid status code");return new t(null,{headers:{location:new URL(e).toString()},status:r})}clone(){if(this.bodyUsed)throw new TypeError("Cannot clone: already read");return new t(lat(this),{...this[Fl]})}get[Symbol.toStringTag](){return this.constructor.name}};Object.defineProperties(l7.prototype,{url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});pPe.exports={Response:l7}});var mPe=L((a6r,fPe)=>{"use strict";var gat=new Set([200,203,204,206,300,301,308,404,405,410,414,501]),vat=new Set([200,203,204,300,301,302,303,307,308,404,405,410,414,501]),yat=new Set([500,502,503,504]),bat={date:!0,connection:!0,"keep-alive":!0,"proxy-authenticate":!0,"proxy-authorization":!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0},_at={"content-length":!0,"content-encoding":!0,"transfer-encoding":!0,"content-range":!0};function s_(t){let e=parseInt(t,10);return isFinite(e)?e:0}function xat(t){return t?yat.has(t.status):!0}function Pte(t){let e={};if(!t)return e;let r=t.trim().split(/,/);for(let n of r){let[o,s]=n.split(/=/,2);e[o.trim()]=s===void 0?!0:s.trim().replace(/^"|"$/g,"")}return e}function Sat(t){let e=[];for(let r in t){let n=t[r];e.push(n===!0?r:r+"="+n)}if(e.length)return e.join(", ")}fPe.exports=class{constructor(e,r,{shared:n,cacheHeuristic:o,immutableMinTimeToLive:s,ignoreCargoCult:a,_fromObject:c}={}){if(c){this._fromObject(c);return}if(!r||!r.headers)throw Error("Response headers missing");this._assertRequestHasHeaders(e),this._responseTime=this.now(),this._isShared=n!==!1,this._cacheHeuristic=o!==void 0?o:.1,this._immutableMinTtl=s!==void 0?s:24*3600*1e3,this._status="status"in r?r.status:200,this._resHeaders=r.headers,this._rescc=Pte(r.headers["cache-control"]),this._method="method"in e?e.method:"GET",this._url=e.url,this._host=e.headers.host,this._noAuthorization=!e.headers.authorization,this._reqHeaders=r.headers.vary?e.headers:null,this._reqcc=Pte(e.headers["cache-control"]),a&&"pre-check"in this._rescc&&"post-check"in this._rescc&&(delete this._rescc["pre-check"],delete this._rescc["post-check"],delete this._rescc["no-cache"],delete this._rescc["no-store"],delete this._rescc["must-revalidate"],this._resHeaders=Object.assign({},this._resHeaders,{"cache-control":Sat(this._rescc)}),delete this._resHeaders.expires,delete this._resHeaders.pragma),r.headers["cache-control"]==null&&/no-cache/.test(r.headers.pragma)&&(this._rescc["no-cache"]=!0)}now(){return Date.now()}storable(){return!!(!this._reqcc["no-store"]&&(this._method==="GET"||this._method==="HEAD"||this._method==="POST"&&this._hasExplicitExpiration())&&vat.has(this._status)&&!this._rescc["no-store"]&&(!this._isShared||!this._rescc.private)&&(!this._isShared||this._noAuthorization||this._allowsStoringAuthenticated())&&(this._resHeaders.expires||this._rescc["max-age"]||this._isShared&&this._rescc["s-maxage"]||this._rescc.public||gat.has(this._status)))}_hasExplicitExpiration(){return this._isShared&&this._rescc["s-maxage"]||this._rescc["max-age"]||this._resHeaders.expires}_assertRequestHasHeaders(e){if(!e||!e.headers)throw Error("Request headers missing")}satisfiesWithoutRevalidation(e){this._assertRequestHasHeaders(e);let r=Pte(e.headers["cache-control"]);return r["no-cache"]||/no-cache/.test(e.headers.pragma)||r["max-age"]&&this.age()>r["max-age"]||r["min-fresh"]&&this.timeToLive()<1e3*r["min-fresh"]||this.stale()&&!(r["max-stale"]&&!this._rescc["must-revalidate"]&&(r["max-stale"]===!0||r["max-stale"]>this.age()-this.maxAge()))?!1:this._requestMatches(e,!1)}_requestMatches(e,r){return(!this._url||this._url===e.url)&&this._host===e.headers.host&&(!e.method||this._method===e.method||r&&e.method==="HEAD")&&this._varyMatches(e)}_allowsStoringAuthenticated(){return this._rescc["must-revalidate"]||this._rescc.public||this._rescc["s-maxage"]}_varyMatches(e){if(!this._resHeaders.vary)return!0;if(this._resHeaders.vary==="*")return!1;let r=this._resHeaders.vary.trim().toLowerCase().split(/\s*,\s*/);for(let n of r)if(e.headers[n]!==this._reqHeaders[n])return!1;return!0}_copyWithoutHopByHopHeaders(e){let r={};for(let n in e)bat[n]||(r[n]=e[n]);if(e.connection){let n=e.connection.trim().split(/\s*,\s*/);for(let o of n)delete r[o]}if(r.warning){let n=r.warning.split(/,/).filter(o=>!/^\s*1[0-9][0-9]/.test(o));n.length?r.warning=n.join(",").trim():delete r.warning}return r}responseHeaders(){let e=this._copyWithoutHopByHopHeaders(this._resHeaders),r=this.age();return r>3600*24&&!this._hasExplicitExpiration()&&this.maxAge()>3600*24&&(e.warning=(e.warning?`${e.warning}, `:"")+'113 - "rfc7234 5.5.4"'),e.age=`${Math.round(r)}`,e.date=new Date(this.now()).toUTCString(),e}date(){let e=Date.parse(this._resHeaders.date);return isFinite(e)?e:this._responseTime}age(){let e=this._ageValue(),r=(this.now()-this._responseTime)/1e3;return e+r}_ageValue(){return s_(this._resHeaders.age)}maxAge(){if(!this.storable()||this._rescc["no-cache"]||this._isShared&&this._resHeaders["set-cookie"]&&!this._rescc.public&&!this._rescc.immutable||this._resHeaders.vary==="*")return 0;if(this._isShared){if(this._rescc["proxy-revalidate"])return 0;if(this._rescc["s-maxage"])return s_(this._rescc["s-maxage"])}if(this._rescc["max-age"])return s_(this._rescc["max-age"]);let e=this._rescc.immutable?this._immutableMinTtl:0,r=this.date();if(this._resHeaders.expires){let n=Date.parse(this._resHeaders.expires);return Number.isNaN(n)||n<r?0:Math.max(e,(n-r)/1e3)}if(this._resHeaders["last-modified"]){let n=Date.parse(this._resHeaders["last-modified"]);if(isFinite(n)&&r>n)return Math.max(e,(r-n)/1e3*this._cacheHeuristic)}return e}timeToLive(){let e=this.maxAge()-this.age(),r=e+s_(this._rescc["stale-if-error"]),n=e+s_(this._rescc["stale-while-revalidate"]);return Math.max(0,e,r,n)*1e3}stale(){return this.maxAge()<=this.age()}_useStaleIfError(){return this.maxAge()+s_(this._rescc["stale-if-error"])>this.age()}useStaleWhileRevalidate(){return this.maxAge()+s_(this._rescc["stale-while-revalidate"])>this.age()}static fromObject(e){return new this(void 0,void 0,{_fromObject:e})}_fromObject(e){if(this._responseTime)throw Error("Reinitialized");if(!e||e.v!==1)throw Error("Invalid serialization");this._responseTime=e.t,this._isShared=e.sh,this._cacheHeuristic=e.ch,this._immutableMinTtl=e.imm!==void 0?e.imm:24*3600*1e3,this._status=e.st,this._resHeaders=e.resh,this._rescc=e.rescc,this._method=e.m,this._url=e.u,this._host=e.h,this._noAuthorization=e.a,this._reqHeaders=e.reqh,this._reqcc=e.reqcc}toObject(){return{v:1,t:this._responseTime,sh:this._isShared,ch:this._cacheHeuristic,imm:this._immutableMinTtl,st:this._status,resh:this._resHeaders,rescc:this._rescc,m:this._method,u:this._url,h:this._host,a:this._noAuthorization,reqh:this._reqHeaders,reqcc:this._reqcc}}revalidationHeaders(e){this._assertRequestHasHeaders(e);let r=this._copyWithoutHopByHopHeaders(e.headers);if(delete r["if-range"],!this._requestMatches(e,!0)||!this.storable())return delete r["if-none-match"],delete r["if-modified-since"],r;if(this._resHeaders.etag&&(r["if-none-match"]=r["if-none-match"]?`${r["if-none-match"]}, ${this._resHeaders.etag}`:this._resHeaders.etag),r["accept-ranges"]||r["if-match"]||r["if-unmodified-since"]||this._method&&this._method!="GET"){if(delete r["if-modified-since"],r["if-none-match"]){let o=r["if-none-match"].split(/,/).filter(s=>!/^\s*W\//.test(s));o.length?r["if-none-match"]=o.join(",").trim():delete r["if-none-match"]}}else this._resHeaders["last-modified"]&&!r["if-modified-since"]&&(r["if-modified-since"]=this._resHeaders["last-modified"]);return r}revalidatedPolicy(e,r){if(this._assertRequestHasHeaders(e),this._useStaleIfError()&&xat(r))return{modified:!1,matches:!1,policy:this};if(!r||!r.headers)throw Error("Response headers missing");let n=!1;if(r.status!==void 0&&r.status!=304?n=!1:r.headers.etag&&!/^\s*W\//.test(r.headers.etag)?n=this._resHeaders.etag&&this._resHeaders.etag.replace(/^\s*W\//,"")===r.headers.etag:this._resHeaders.etag&&r.headers.etag?n=this._resHeaders.etag.replace(/^\s*W\//,"")===r.headers.etag.replace(/^\s*W\//,""):this._resHeaders["last-modified"]?n=this._resHeaders["last-modified"]===r.headers["last-modified"]:!this._resHeaders.etag&&!this._resHeaders["last-modified"]&&!r.headers.etag&&!r.headers["last-modified"]&&(n=!0),!n)return{policy:new this.constructor(e,r),modified:r.status!=304,matches:!1};let o={};for(let a in this._resHeaders)o[a]=a in r.headers&&!_at[a]?r.headers[a]:this._resHeaders[a];let s=Object.assign({},r,{status:this._status,method:this._method,headers:o});return{policy:new this.constructor(e,s,{shared:this._isShared,cacheHeuristic:this._cacheHeuristic,immutableMinTimeToLive:this._immutableMinTtl}),modified:!1,matches:!0}}}});var yPe=L((c6r,vPe)=>{"use strict";var Iat=mPe(),{Headers:Cat}=WT(),hPe=t=>({url:t.url,method:t.method,headers:t.headers.plain()}),gPe=t=>({status:t.status,headers:t.headers.plain()}),Dte=class{constructor(e,r,n){this.policy=new Iat(hPe(e),gPe(r),n)}storable(){return this.policy.storable()}satisfiesWithoutRevalidation(e){return this.policy.satisfiesWithoutRevalidation(hPe(e))}responseHeaders(e){return new Cat(this.policy.responseHeaders(gPe(e)))}timeToLive(){return this.policy.timeToLive()}};vPe.exports=Dte});var xPe=L((u6r,_Pe)=>{"use strict";var{Readable:Tat}=require("stream"),{Headers:bPe}=WT(),{Response:Eat}=Ate(),r0=Symbol("CacheableResponse internals"),wat=t=>t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength),Nte=class t extends Eat{constructor(e,r){super(e,r);let n=new bPe(r.headers);this[r0]={headers:n,bufferedBody:e}}get headers(){return this[r0].headers}set headers(e){if(e instanceof bPe)this[r0].headers=e;else throw new TypeError("instance of Headers expected")}get body(){return Tat.from(this[r0].bufferedBody)}get bodyUsed(){return!1}async buffer(){return this[r0].bufferedBody}async arrayBuffer(){return wat(this[r0].bufferedBody)}async text(){return this[r0].bufferedBody.toString()}async json(){return JSON.parse(await this.text())}clone(){let{url:e,status:r,statusText:n,headers:o,httpVersion:s,decoded:a,counter:c}=this;return new t(this[r0].bufferedBody,{url:e,status:r,statusText:n,headers:o,httpVersion:s,decoded:a,counter:c})}get[Symbol.toStringTag](){return this.constructor.name}},Rat=async t=>{let e=await t.buffer(),{url:r,status:n,statusText:o,headers:s,httpVersion:a,decoded:c,counter:u}=t;return new Nte(e,{url:r,status:n,statusText:o,headers:s,httpVersion:a,decoded:c,counter:u})};_Pe.exports={cacheableResponse:Rat}});var d7=L((l6r,SPe)=>{"use strict";var Lte=class extends Error{get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}};SPe.exports={RequestAbortedError:Lte}});var wPe=L((d6r,EPe)=>{"use strict";var CPe=require("http"),TPe=require("https"),{Readable:kat}=require("stream"),Cm=al()("helix-fetch:h1"),{RequestAbortedError:IPe}=d7(),{decodeStream:Aat}=xm(),Pat=(t,e)=>{let{h1:r,options:{h1:n,rejectUnauthorized:o}}=t;return e==="https:"?r.httpsAgent?r.httpsAgent:n||typeof o=="boolean"?(r.httpsAgent=new TPe.Agent(typeof o=="boolean"?{...n||{},rejectUnauthorized:o}:n),r.httpsAgent):void 0:r.httpAgent?r.httpAgent:n?(r.httpAgent=new CPe.Agent(n),r.httpAgent):void 0},Dat=t=>{t.h1={}},Nat=async({h1:t})=>{t.httpAgent&&(Cm("resetContext: destroying httpAgent"),t.httpAgent.destroy(),delete t.httpAgent),t.httpsAgent&&(Cm("resetContext: destroying httpsAgent"),t.httpsAgent.destroy(),delete t.httpsAgent)},Lat=(t,e,r)=>{let{statusCode:n,statusMessage:o,httpVersion:s,httpVersionMajor:a,httpVersionMinor:c,headers:u}=t,l=e?Aat(n,u,t,r):t;return{statusCode:n,statusText:o,httpVersion:s,httpVersionMajor:a,httpVersionMinor:c,headers:u,readable:l,decoded:!!(e&&l!==t)}},Oat=async(t,e,r)=>{let{request:n}=e.protocol==="https:"?TPe:CPe,o=Pat(t,e.protocol),s={...r,agent:o},{socket:a,body:c}=s;return a&&(delete s.socket,a.assigned||(a.assigned=!0,o?s.agent=new Proxy(o,{get:(u,l)=>l==="createConnection"&&!a.inUse?(d,p)=>{Cm(`agent reusing socket #${a.id} (${a.servername})`),a.inUse=!0,p(null,a)}:u[l]}):s.createConnection=(u,l)=>{Cm(`reusing socket #${a.id} (${a.servername})`),a.inUse=!0,l(null,a)})),new Promise((u,l)=>{Cm(`${s.method} ${e.href}`);let d,{signal:p}=s,f=()=>{p.removeEventListener("abort",f),a&&!a.inUse&&(Cm(`discarding redundant socket used for ALPN: #${a.id} ${a.servername}`),a.destroy()),l(new IPe),d&&d.abort()};if(p){if(p.aborted){l(new IPe);return}p.addEventListener("abort",f)}d=n(e,s),d.once("response",m=>{p&&p.removeEventListener("abort",f),a&&!a.inUse&&(Cm(`discarding redundant socket used for ALPN: #${a.id} ${a.servername}`),a.destroy()),u(Lat(m,s.decode,l))}),d.once("error",m=>{p&&p.removeEventListener("abort",f),a&&!a.inUse&&(Cm(`discarding redundant socket used for ALPN: #${a.id} ${a.servername}`),a.destroy()),d.aborted||(Cm(`${s.method} ${e.href} failed with: ${m.message}`),d.abort(),l(m))}),c instanceof kat?c.pipe(d):(c&&d.write(c),d.end())})};EPe.exports={request:Oat,setupContext:Dat,resetContext:Nat}});var PPe=L((p6r,APe)=>{"use strict";var{connect:Mat,constants:Fat}=require("http2"),{Readable:Uat}=require("stream"),Gn=al()("helix-fetch:h2"),{RequestAbortedError:RPe}=d7(),{decodeStream:Bat}=xm(),{NGHTTP2_CANCEL:LA}=Fat,qat=5*60*1e3,Hat=5e3,jat=t=>{t.h2={sessionCache:{}}},zat=async({h2:t})=>Promise.all(Object.values(t.sessionCache).map(e=>new Promise(r=>{e.on("close",r),Gn(`resetContext: destroying session (socket #${e.socket&&e.socket.id}, ${e.socket&&e.socket.servername})`),e.destroy()}))),kPe=(t,e,r,n=()=>{})=>{let o={...t},s=o[":status"];delete o[":status"];let a=r?Bat(s,t,e,n):e;return{statusCode:s,statusText:"",httpVersion:"2.0",httpVersionMajor:2,httpVersionMinor:0,headers:o,readable:a,decoded:!!(r&&a!==e)}},Gat=(t,e,r,n,o,s)=>{let{options:{h2:{pushPromiseHandler:a,pushHandler:c,pushedStreamIdleTimeout:u=Hat}}}=t,l=o[":path"],d=`${e}${l}`;Gn(`received PUSH_PROMISE: ${d}, stream #${n.id}, headers: ${JSON.stringify(o)}, flags: ${s}`),a&&a(d,o,()=>{n.close(LA)}),n.on("push",(p,f)=>{Gn(`received push headers for ${e}${l}, stream #${n.id}, headers: ${JSON.stringify(p)}, flags: ${f}`),n.setTimeout(u,()=>{Gn(`closing pushed stream #${n.id} after ${u} ms of inactivity`),n.close(LA)}),c&&c(d,o,kPe(p,n,r))}),n.on("aborted",()=>{Gn(`pushed stream #${n.id} aborted`)}),n.on("error",p=>{Gn(`pushed stream #${n.id} encountered error: ${p}`)}),n.on("frameError",(p,f,m)=>{Gn(`pushed stream #${n.id} encountered frameError: type: ${p}, code: ${f}, id: ${m}`)})},Vat=async(t,e,r)=>{let{origin:n,pathname:o,search:s,hash:a}=e,c=`${o}${s}${a}`,{options:{h2:u={}},h2:{sessionCache:l}}=t,{idleSessionTimeout:d=qat,pushPromiseHandler:p,pushHandler:f}=u,m={...r},{method:h,headers:g,socket:v,body:y,decode:_}=m;return v&&delete m.socket,g.host&&(g[":authority"]=g.host,delete g.host),new Promise((b,S)=>{let I=l[n];if(!I||I.closed||I.destroyed){let M=!(t.options.rejectUnauthorized===!1||u.rejectUnauthorized===!1),re={...u,rejectUnauthorized:M};v&&!v.inUse&&(re.createConnection=()=>(Gn(`reusing socket #${v.id} (${v.servername})`),v.inUse=!0,v)),I=Mat(n,{...re,settings:{enablePush:!!(p||f)}}),I.setMaxListeners(1e3),I.setTimeout(d,()=>{Gn(`closing session ${n} after ${d} ms of inactivity`),I.close()}),I.once("connect",()=>{Gn(`session ${n} established`),Gn(`caching session ${n}`),l[n]=I}),I.on("localSettings",N=>{Gn(`session ${n} localSettings: ${JSON.stringify(N)}`)}),I.on("remoteSettings",N=>{Gn(`session ${n} remoteSettings: ${JSON.stringify(N)}`)}),I.once("close",()=>{Gn(`session ${n} closed`),l[n]===I&&(Gn(`discarding cached session ${n}`),delete l[n])}),I.once("error",N=>{Gn(`session ${n} encountered error: ${N}`),l[n]===I&&(Gn(`discarding cached session ${n}`),delete l[n])}),I.on("frameError",(N,E,P)=>{Gn(`session ${n} encountered frameError: type: ${N}, code: ${E}, id: ${P}`)}),I.once("goaway",(N,E,P)=>{Gn(`session ${n} received GOAWAY frame: errorCode: ${N}, lastStreamID: ${E}, opaqueData: ${P?P.toString():void 0}`)}),I.on("stream",(N,E,P)=>{Gat(t,n,_,N,E,P)})}else v&&v.id!==I.socket.id&&!v.inUse&&(Gn(`discarding redundant socket used for ALPN: #${v.id} ${v.servername}`),v.destroy());Gn(`${h} ${e.host}${c}`);let w,{signal:O}=m,U=()=>{O.removeEventListener("abort",U),S(new RPe),w&&w.close(LA)};if(O){if(O.aborted){S(new RPe);return}O.addEventListener("abort",U)}let z=M=>{Gn(`session ${n} encountered error during ${m.method} ${e.href}: ${M}`),S(M)};I.once("error",z),w=I.request({":method":h,":path":c,...g}),w.once("response",M=>{I.off("error",z),O&&O.removeEventListener("abort",U),b(kPe(M,w,m.decode,S))}),w.once("error",M=>{I.off("error",z),O&&O.removeEventListener("abort",U),w.rstCode!==LA&&(Gn(`${m.method} ${e.href} failed with: ${M.message}`),w.close(LA),S(M))}),w.once("frameError",(M,re,ee)=>{I.off("error",z),Gn(`encountered frameError during ${m.method} ${e.href}: type: ${M}, code: ${re}, id: ${ee}`)}),w.on("push",(M,re)=>{Gn(`received 'push' event: headers: ${JSON.stringify(M)}, flags: ${re}`)}),y instanceof Uat?y.pipe(w):(y&&w.write(y),w.end())})};APe.exports={request:Vat,setupContext:jat,resetContext:zat}});var NPe=L((f6r,DPe)=>{"use strict";var{EventEmitter:$at}=require("events"),Wat=()=>{let t={},e=new $at;return e.setMaxListeners(0),{acquire:r=>new Promise(n=>{if(!t[r]){t[r]=!0,n();return}let o=s=>{t[r]||(t[r]=!0,e.removeListener(r,o),n(s))};e.on(r,o)}),release:(r,n)=>{Reflect.deleteProperty(t,r),setImmediate(()=>e.emit(r,n))}}};DPe.exports=Wat});var LPe=L((m6r,Kat)=>{Kat.exports={name:"@adobe/helix-fetch",version:"3.1.1",description:"Light-weight Fetch implementation transparently supporting both HTTP/1(.1) and HTTP/2",main:"src/index.js",scripts:{test:"nyc mocha",lint:"./node_modules/.bin/eslint .","semantic-release":"semantic-release"},mocha:{timeout:"5000",recursive:"true",reporter:"mocha-multi-reporters","reporter-options":"configFile=.mocha-multi.json"},engines:{node:">=12.0"},types:"src/index.d.ts",exports:{import:"./src/index.mjs",require:"./src/index.js"},repository:{type:"git",url:"https://github.com/adobe/helix-fetch"},author:"",license:"Apache-2.0",bugs:{url:"https://github.com/adobe/helix-fetch/issues"},homepage:"https://github.com/adobe/helix-fetch#readme",keywords:["fetch","whatwg","Fetch API","http","https","http2","h2","promise","async","request","RFC 7234","7234","caching","cache"],dependencies:{debug:"4.3.4","http-cache-semantics":"^4.1.1","lru-cache":"7.13.1"},devDependencies:{"@adobe/eslint-config-helix":"1.3.2","@semantic-release/changelog":"6.0.1","@semantic-release/git":"10.0.1",chai:"4.3.6","chai-as-promised":"7.1.1","chai-bytes":"0.1.2","chai-iterator":"3.0.2",eslint:"8.21.0","eslint-plugin-header":"3.1.1","eslint-plugin-import":"2.26.0","formdata-node":"4.3.3","lint-staged":"13.0.3",mocha:"10.0.0","mocha-multi-reporters":"1.5.1",nock:"13.2.9",nyc:"15.1.0","parse-cache-control":"1.0.1",pem:"1.14.6",proxy:"^1.0.2","semantic-release":"19.0.3",sinon:"14.0.0","stream-buffers":"3.0.2",tunnel:"^0.0.6"},"lint-staged":{"*.js":"eslint"},config:{commitizen:{path:"node_modules/cz-conventional-changelog"},ghooks:{"pre-commit":"npx lint-staged"}}}});var BPe=L((h6r,UPe)=>{"use strict";var{Readable:Yat}=require("stream"),Qat=require("tls"),{types:{isAnyArrayBuffer:Xat}}=require("util"),Jat=Ite(),Ote=al()("helix-fetch:core"),{RequestAbortedError:p7}=d7(),Mte=wPe(),f7=PPe(),Zat=NPe(),{isPlainObject:ect}=xm(),{isFormData:tct,FormDataSerializer:rct}=NA(),{version:nct}=LPe(),Fte="h2",Ute="h2c",Bte="http/1.0",a_="http/1.1",ict=100,oct=60*60*1e3,sct=[Fte,a_,Bte],act=`helix-fetch/${nct}`,cct={method:"GET",compress:!0,decode:!0},OPe=0,MPe=Zat(),FPe=(t,e)=>new Promise((r,n)=>{let{signal:o}=e,s,a=()=>{o.removeEventListener("abort",a);let l=new p7;n(l),s&&s.destroy(l)};if(o){if(o.aborted){n(new p7);return}o.addEventListener("abort",a)}let c=+t.port||443,u=l=>{o&&o.removeEventListener("abort",a),l instanceof p7||(Ote(`connecting to ${t.hostname}:${c} failed with: ${l.message}`),n(l))};s=Qat.connect(c,t.hostname,e),s.once("secureConnect",()=>{o&&o.removeEventListener("abort",a),s.off("error",u),OPe+=1,s.id=OPe,s.secureConnecting=!1,Ote(`established TLS connection: #${s.id} (${s.servername})`),r(s)}),s.once("error",u)}),uct=async(t,e)=>{let r=await MPe.acquire(t.origin);try{return r||(r=await FPe(t,e)),r}finally{MPe.release(t.origin,r)}},lct=async(t,e,r)=>{let n=`${e.protocol}//${e.host}`,o=t.alpnCache.get(n);if(o)return{protocol:o};switch(e.protocol){case"http:":return o=a_,t.alpnCache.set(n,o),{protocol:o};case"http2:":return o=Ute,t.alpnCache.set(n,o),{protocol:o};case"https:":break;default:throw new TypeError(`unsupported protocol: ${e.protocol}`)}let{options:{rejectUnauthorized:s,h1:a={},h2:c={}}}=t,u=!(s===!1||a.rejectUnauthorized===!1||c.rejectUnauthorized===!1),l={servername:e.hostname,ALPNProtocols:t.alpnProtocols,signal:r,rejectUnauthorized:u};t.options.ca&&(l.ca=t.options.ca);let d=await uct(e,l);return o=d.alpnProtocol,o||(o=a_),t.alpnCache.set(n,o),{protocol:o,socket:d}},dct=t=>{let e={};return Object.keys(t).forEach(r=>{e[r.toLowerCase()]=t[r]}),e},pct=async(t,e,r,n)=>{let o=e.protocol==="https:",s;e.port?s=e.port:o?s=443:s=80;let a={...r,host:e.host,hostname:e.hostname,port:s},c=await t(a);if(o){let l={...a,ALPNProtocols:n};l.socket=c,l.servername=a.host;let d=await FPe(e,l);return{protocol:d.alpnProtocol||a_,socket:d}}return{protocol:c.alpnProtocol||a_,socket:c}},fct=async(t,e,r)=>{let n=new URL(e),o={...cct,...r||{}};typeof o.method=="string"&&(o.method=o.method.toUpperCase()),o.headers=dct(o.headers||{}),o.headers.host===void 0&&(o.headers.host=n.host),t.userAgent&&o.headers["user-agent"]===void 0&&(o.headers["user-agent"]=t.userAgent);let s;if(o.body instanceof URLSearchParams)s="application/x-www-form-urlencoded; charset=utf-8",o.body=o.body.toString();else if(tct(o.body)){let l=new rct(o.body);s=l.contentType(),o.body=l.stream(),o.headers["transfer-encoding"]===void 0&&o.headers["content-length"]===void 0&&(o.headers["content-length"]=String(l.length()))}else typeof o.body=="string"||o.body instanceof String?s="text/plain; charset=utf-8":ect(o.body)?(o.body=JSON.stringify(o.body),s="application/json"):Xat(o.body)&&(o.body=Buffer.from(o.body));o.headers["content-type"]===void 0&&s!==void 0&&(o.headers["content-type"]=s),o.body!=null&&(o.body instanceof Yat||(!(typeof o.body=="string"||o.body instanceof String)&&!Buffer.isBuffer(o.body)&&(o.body=String(o.body)),o.headers["transfer-encoding"]===void 0&&o.headers["content-length"]===void 0&&(o.headers["content-length"]=String(Buffer.isBuffer(o.body)?o.body.length:Buffer.byteLength(o.body,"utf-8"))))),o.headers.accept===void 0&&(o.headers.accept="*/*"),o.body==null&&["POST","PUT"].includes(o.method)&&(o.headers["content-length"]="0"),o.compress&&o.headers["accept-encoding"]===void 0&&(o.headers["accept-encoding"]="gzip,deflate,br");let{signal:a}=o,{protocol:c,socket:u=null}=t.socketFactory?await pct(t.socketFactory,n,o,t.alpnProtocols):await lct(t,n,a);switch(Ote(`${n.host} -> ${c}`),c){case Fte:try{return await f7.request(t,n,u?{...o,socket:u}:o)}catch(l){let{code:d,message:p}=l;throw d==="ERR_HTTP2_ERROR"&&p==="Protocol error"&&t.alpnCache.delete(`${n.protocol}//${n.host}`),l}case Ute:return f7.request(t,new URL(`http://${n.host}${n.pathname}${n.hash}${n.search}`),u?{...o,socket:u}:o);case Bte:case a_:return Mte.request(t,n,u?{...o,socket:u}:o);default:throw new TypeError(`unsupported protocol: ${c}`)}},mct=async t=>(t.alpnCache.clear(),Promise.all([Mte.resetContext(t),f7.resetContext(t)])),hct=t=>{let{options:{alpnProtocols:e=sct,alpnCacheTTL:r=oct,alpnCacheSize:n=ict,userAgent:o=act,socketFactory:s}}=t;t.alpnProtocols=e,t.alpnCache=new Jat({max:n,ttl:r}),t.userAgent=o,t.socketFactory=s,Mte.setupContext(t),f7.setupContext(t)};UPe.exports={request:fct,setupContext:hct,resetContext:mct,RequestAbortedError:p7,ALPN_HTTP2:Fte,ALPN_HTTP2C:Ute,ALPN_HTTP1_1:a_,ALPN_HTTP1_0:Bte}});var HPe=L((g6r,qPe)=>{"use strict";var gct=al()("helix-fetch:core"),{request:vct,setupContext:yct,resetContext:bct,RequestAbortedError:_ct,ALPN_HTTP2:xct,ALPN_HTTP2C:Sct,ALPN_HTTP1_1:Ict,ALPN_HTTP1_0:Cct}=BPe(),qte=class t{constructor(e){this.options={...e||{}},yct(this)}api(){return{request:async(e,r)=>this.request(e,r),context:(e={})=>new t(e).api(),setCA:e=>this.setCA(e),reset:async()=>this.reset(),RequestAbortedError:_ct,ALPN_HTTP2:xct,ALPN_HTTP2C:Sct,ALPN_HTTP1_1:Ict,ALPN_HTTP1_0:Cct}}async request(e,r){return vct(this,e,r)}setCA(e){this.options.ca=e}async reset(){return gct("resetting context"),bct(this)}};qPe.exports=new qte().api()});var $Pe=L((v6r,VPe)=>{"use strict";var{EventEmitter:Tct}=require("events"),{Readable:OA}=require("stream"),Hte=al()("helix-fetch"),Ect=Ite(),{Body:wct}=i7(),{Headers:Vte}=WT(),{Request:c_}=dPe(),{Response:zte}=Ate(),{FetchBaseError:Rct,FetchError:MA,AbortError:m7}=Ete(),{AbortController:kct,AbortSignal:Act,TimeoutSignal:Pct}=wte(),Dct=yPe(),{cacheableResponse:Nct}=xPe(),{sizeof:Lct}=xm(),{isFormData:Oct}=NA(),{context:Mct,RequestAbortedError:Fct}=HPe(),jPe=["GET","HEAD"],Uct=500,Bct=100*1024*1024,jte="push",zPe=async(t,e,r)=>{let{request:n}=t.context,o=e instanceof c_&&typeof r>"u"?e:new c_(e,r),{method:s,body:a,signal:c,compress:u,decode:l,follow:d,redirect:p,init:{body:f}}=o,m;if(c&&c.aborted){let I=new m7("The operation was aborted.");throw o.init.body instanceof OA&&o.init.body.destroy(I),I}try{m=await n(o.url,{...r,method:s,headers:o.headers.plain(),body:f&&!(f instanceof OA)&&!Oct(f)?f:a,compress:u,decode:l,follow:d,redirect:p,signal:c})}catch(I){throw f instanceof OA&&f.destroy(I),I instanceof TypeError?I:I instanceof Fct?new m7("The operation was aborted."):new MA(I.message,"system",I)}let h=()=>{c.removeEventListener("abort",h);let I=new m7("The operation was aborted.");o.init.body instanceof OA&&o.init.body.destroy(I),m.readable.emit("error",I)};c&&c.addEventListener("abort",h);let{statusCode:g,statusText:v,httpVersion:y,headers:_,readable:b,decoded:S}=m;if([301,302,303,307,308].includes(g)){let{location:I}=_,w=I==null?null:new URL(I,o.url);switch(o.redirect){case"manual":break;case"error":throw c&&c.removeEventListener("abort",h),new MA(`uri requested responds with a redirect, redirect mode is set to 'error': ${o.url}`,"no-redirect");case"follow":{if(w===null)break;if(o.counter>=o.follow)throw c&&c.removeEventListener("abort",h),new MA(`maximum redirect reached at: ${o.url}`,"max-redirect");let O={headers:new Vte(o.headers),follow:o.follow,compress:o.compress,decode:o.decode,counter:o.counter+1,method:o.method,body:o.body,signal:o.signal};if(g!==303&&o.body&&o.init.body instanceof OA)throw c&&c.removeEventListener("abort",h),new MA("Cannot follow redirect with body being a readable stream","unsupported-redirect");return(g===303||(g===301||g===302)&&o.method==="POST")&&(O.method="GET",O.body=void 0,O.headers.delete("content-length")),c&&c.removeEventListener("abort",h),zPe(t,new c_(w,O))}default:}}return c&&(b.once("end",()=>{c.removeEventListener("abort",h)}),b.once("error",()=>{c.removeEventListener("abort",h)})),new zte(b,{url:o.url,status:g,statusText:v,headers:_,httpVersion:y,decoded:S,counter:o.counter})},GPe=async(t,e,r)=>{if(t.options.maxCacheSize===0||!jPe.includes(e.method))return r;let n=new Dct(e,r,{shared:!1});if(n.storable()){let o=await Nct(r);return t.cache.set(e.url,{policy:n,response:o},n.timeToLive()),o}else return r},qct=async(t,e,r)=>{let n=new c_(e,r);if(t.options.maxCacheSize!==0&&jPe.includes(n.method)&&!["no-store","reload"].includes(n.cache)){let{policy:a,response:c}=t.cache.get(n.url)||{};if(a&&a.satisfiesWithoutRevalidation(n)){c.headers=new Vte(a.responseHeaders(c));let u=c.clone();return u.fromCache=!0,u}}let s=await zPe(t,n);return n.cache!=="no-store"?GPe(t,n,s):s},Hct=(t,e={})=>{let r=new URL(t);if(typeof e!="object"||Array.isArray(e))throw new TypeError("qs: object expected");return Object.entries(e).forEach(([n,o])=>{Array.isArray(o)?o.forEach(s=>r.searchParams.append(n,s)):r.searchParams.append(n,o)}),r.href},jct=t=>new Pct(t),Gte=class t{constructor(e){this.options={...e};let{maxCacheSize:r}=this.options,n=typeof r=="number"&&r>=0?r:Bct,o=Uct;n===0&&(n=1,o=1);let s=({response:c},u)=>Lct(c);this.cache=new Ect({max:o,maxSize:n,sizeCalculation:s}),this.eventEmitter=new Tct,this.options.h2=this.options.h2||{},typeof this.options.h2.enablePush>"u"&&(this.options.h2.enablePush=!0);let{enablePush:a}=this.options.h2;a&&(this.options.h2.pushPromiseHandler=(c,u,l)=>{let d={...u};Object.keys(d).filter(p=>p.startsWith(":")).forEach(p=>delete d[p]),this.pushPromiseHandler(c,d,l)},this.options.h2.pushHandler=(c,u,l)=>{let d={...u};Object.keys(d).filter(y=>y.startsWith(":")).forEach(y=>delete d[y]);let{statusCode:p,statusText:f,httpVersion:m,headers:h,readable:g,decoded:v}=l;this.pushHandler(c,d,new zte(g,{url:c,status:p,statusText:f,headers:h,httpVersion:m,decoded:v}))}),this.context=Mct(this.options)}api(){return{fetch:async(e,r)=>this.fetch(e,r),Body:wct,Headers:Vte,Request:c_,Response:zte,AbortController:kct,AbortSignal:Act,FetchBaseError:Rct,FetchError:MA,AbortError:m7,context:(e={})=>new t(e).api(),setCA:e=>this.setCA(e),noCache:(e={})=>new t({...e,maxCacheSize:0}).api(),h1:(e={})=>new t({...e,alpnProtocols:[this.context.ALPN_HTTP1_1]}).api(),keepAlive:(e={})=>new t({...e,alpnProtocols:[this.context.ALPN_HTTP1_1],h1:{keepAlive:!0}}).api(),h1NoCache:(e={})=>new t({...e,maxCacheSize:0,alpnProtocols:[this.context.ALPN_HTTP1_1]}).api(),keepAliveNoCache:(e={})=>new t({...e,maxCacheSize:0,alpnProtocols:[this.context.ALPN_HTTP1_1],h1:{keepAlive:!0}}).api(),reset:async()=>this.context.reset(),onPush:e=>this.onPush(e),offPush:e=>this.offPush(e),createUrl:Hct,timeoutSignal:jct,clearCache:()=>this.clearCache(),cacheStats:()=>this.cacheStats(),ALPN_HTTP2:this.context.ALPN_HTTP2,ALPN_HTTP2C:this.context.ALPN_HTTP2C,ALPN_HTTP1_1:this.context.ALPN_HTTP1_1,ALPN_HTTP1_0:this.context.ALPN_HTTP1_0}}async fetch(e,r){return qct(this,e,r)}setCA(e){this.options.ca=e,this.context.setCA(e)}onPush(e){return this.eventEmitter.on(jte,e)}offPush(e){return this.eventEmitter.off(jte,e)}clearCache(){this.cache.clear()}cacheStats(){return{size:this.cache.calculatedSize,count:this.cache.size}}pushPromiseHandler(e,r,n){Hte(`received server push promise: ${e}, headers: ${JSON.stringify(r)}`);let o=new c_(e,{headers:r}),{policy:s}=this.cache.get(e)||{};s&&s.satisfiesWithoutRevalidation(o)&&(Hte(`already cached, reject push promise: ${e}, headers: ${JSON.stringify(r)}`),n())}async pushHandler(e,r,n){Hte(`caching resource pushed by server: ${e}, reqHeaders: ${JSON.stringify(r)}, status: ${n.status}, respHeaders: ${JSON.stringify(n.headers)}`);let o=await GPe(this,new c_(e,{headers:r}),n);this.eventEmitter.emit(jte,e,o)}};VPe.exports=new Gte().api()});var KPe=L((y6r,WPe)=>{"use strict";WPe.exports=$Pe()});var Jct={};dn(Jct,{activate:()=>Yct,createExtensionContext:()=>dDe,onDeactivate:()=>pDe});module.exports=Gi(Jct);var tE=W(Tr()),uDe=W(require("path")),mo=require("vscode");var Gu;(o=>{o.serviceIds=new Map,o.DI_TARGET="$di$target",o.DI_DEPENDENCIES="$di$dependencies";function n(s){return s[o.DI_DEPENDENCIES]||[]}o.getServiceDependencies=n})(Gu||={});var or=se("instantiationService");function ADe(t,e,r){e[Gu.DI_TARGET]===e?e[Gu.DI_DEPENDENCIES].push({id:t,index:r}):(e[Gu.DI_DEPENDENCIES]=[{id:t,index:r}],e[Gu.DI_TARGET]=e)}function se(t){if(Gu.serviceIds.has(t))return Gu.serviceIds.get(t);let e=function(r,n,o){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");ADe(e,r,o)};return e.toString=()=>t,Gu.serviceIds.set(t,e),e}var w7=class{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(()=>{throw e.stack?qA.isErrorNoTelemetry(e)?new qA(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}addListener(e){return this.listeners.push(e),()=>{this._removeListener(e)}}emit(e){this.listeners.forEach(r=>{r(e)})}_removeListener(e){this.listeners.splice(this.listeners.indexOf(e),1)}setUnexpectedErrorHandler(e){this.unexpectedErrorHandler=e}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}},PDe=new w7;function Rm(t){kp(t)||PDe.onUnexpectedError(t)}var R7="Canceled";function kp(t){return t instanceof ns?!0:t instanceof Error&&t.name===R7&&t.message===R7}var ns=class extends Error{constructor(){super(R7),this.name=this.message}};function Ar(t){return t?new Error(`Illegal argument: ${t}`):new Error("Illegal argument")}function Zte(t){return t?new Error(`Illegal state: ${t}`):new Error("Illegal state")}function HA(t){return t?t.message?t.message:t.stack?t.stack.split(`
`)[0]:String(t):"Error"}var qA=class t extends Error{constructor(e){super(e),this.name="CodeExpectedError"}static fromError(e){if(e instanceof t)return e;let r=new t;return r.message=e.message,r.stack=e.stack,r}static isErrorNoTelemetry(e){return e.name==="CodeExpectedError"}},Qr=class t extends Error{constructor(e){super(e||"An unexpected bug occurred."),Object.setPrototypeOf(this,t.prototype)}};function k7(t,e){let r=this,n=!1,o;return function(){if(n)return o;if(n=!0,e)try{o=t.apply(r,arguments)}finally{e()}else o=t.apply(r,arguments);return o}}function tre(t,e){let r=A7(t,e);if(r!==-1)return t[r]}function A7(t,e,r=t.length-1){for(let n=r;n>=0;n--){let o=t[n];if(e(o))return n}return-1}function P7(t,e){let r=Bl(t,e);return r===-1?void 0:t[r]}function Bl(t,e,r=0,n=t.length){let o=r,s=n;for(;o<s;){let a=Math.floor((o+s)/2);e(t[a])?o=a+1:s=a}return o-1}function p_(t,e,r=0,n=t.length){let o=r,s=n;for(;o<s;){let a=Math.floor((o+s)/2);e(t[a])?s=a:o=a+1}return o}var ere=class t{constructor(e){this._array=e;this._findLastMonotonousLastIdx=0}static{this.assertInvariants=!1}findLastMonotonous(e){if(t.assertInvariants){if(this._prevFindLastPredicate){for(let n of this._array)if(this._prevFindLastPredicate(n)&&!e(n))throw new Error("MonotonousArray: current predicate must be weaker than (or equal to) the previous predicate.")}this._prevFindLastPredicate=e}let r=Bl(this._array,e,this._findLastMonotonousLastIdx);return this._findLastMonotonousLastIdx=r+1,r===-1?void 0:this._array[r]}};function jA(t,e){for(let r of t){let n=e(r);if(n!==void 0)return n}}function D7(t,e,r=(n,o)=>n===o){if(t===e)return!0;if(!t||!e||t.length!==e.length)return!1;for(let n=0,o=t.length;n<o;n++)if(!r(t[n],e[n]))return!1;return!0}function nre(t,e){let r=0,n=t-1;for(;r<=n;){let o=(r+n)/2|0,s=e(o);if(s<0)r=o+1;else if(s>0)n=o-1;else return o}return-(r+1)}function Kt(t){return t.filter(e=>!!e)}function ire(t,e){let r;if(typeof e=="number"){let n=e;r=()=>{let o=Math.sin(n++)*179426549;return o-Math.floor(o)}}else r=Math.random;for(let n=t.length-1;n>0;n-=1){let o=Math.floor(r()*(n+1)),s=t[n];t[n]=t[o],t[o]=s}}var ore;(c=>{function t(u){return u<0}c.isLessThan=t;function e(u){return u<=0}c.isLessThanOrEqual=e;function r(u){return u>0}c.isGreaterThan=r;function n(u){return u===0}c.isNeitherLessOrGreaterThan=n,c.greaterThan=1,c.lessThan=-1,c.neitherLessOrGreaterThan=0})(ore||={});function zA(t,e){return(r,n)=>e(t(r),t(n))}var GA=(t,e)=>t-e;var rre=class t{constructor(e){this.iterate=e}static{this.empty=new t(e=>{})}forEach(e){this.iterate(r=>(e(r),!0))}toArray(){let e=[];return this.iterate(r=>(e.push(r),!0)),e}filter(e){return new t(r=>this.iterate(n=>e(n)?r(n):!0))}map(e){return new t(r=>this.iterate(n=>r(e(n))))}some(e){let r=!1;return this.iterate(n=>(r=e(n),!r)),r}findFirst(e){let r;return this.iterate(n=>e(n)?(r=n,!1):!0),r}findLast(e){let r;return this.iterate(n=>(e(n)&&(r=n),!0)),r}findLastMaxBy(e){let r,n=!0;return this.iterate(o=>((n||ore.isGreaterThan(e(o,r)))&&(n=!1,r=o),!0)),r}};function sre(t,e){let r=Object.create(null);for(let n of t){let o=e(n),s=r[o];s||(s=r[o]=[]),s.push(n)}return r}var L7=class{constructor(e,r){this.uri=e;this.value=r}};function NDe(t){return Array.isArray(t)}var LDe,Pn=class t{constructor(e,r){this[LDe]="ResourceMap";if(e instanceof t)this.map=new Map(e.map),this.toKey=r??t.defaultToKey;else if(NDe(e)){this.map=new Map,this.toKey=r??t.defaultToKey;for(let[n,o]of e)this.set(n,o)}else this.map=new Map,this.toKey=e??t.defaultToKey}static{this.defaultToKey=e=>e.toString()}set(e,r){return this.map.set(this.toKey(e),new L7(e,r)),this}get(e){return this.map.get(this.toKey(e))?.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,r){typeof r<"u"&&(e=e.bind(r));for(let[n,o]of this.map)e(o.value,o.uri,this)}*values(){for(let e of this.map.values())yield e.value}*keys(){for(let e of this.map.values())yield e.uri}*entries(){for(let e of this.map.values())yield[e.uri,e.value]}*[(LDe=Symbol.toStringTag,Symbol.iterator)](){for(let[,e]of this.map)yield[e.uri,e.value]}},ODe,are=class{constructor(e,r){this[ODe]="ResourceSet";!e||typeof e=="function"?this._map=new Pn(e):(this._map=new Pn(r),e.forEach(this.add,this))}get size(){return this._map.size}add(e){return this._map.set(e,e),this}clear(){this._map.clear()}delete(e){return this._map.delete(e)}forEach(e,r){this._map.forEach((n,o)=>e.call(r,o,o,this))}has(e){return this._map.has(e)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[(ODe=Symbol.toStringTag,Symbol.iterator)](){return this.keys()}};var MDe,O7=class{constructor(){this[MDe]="LinkedMap";this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,r=0){let n=this._map.get(e);if(n)return r!==0&&this.touch(n,r),n.value}set(e,r,n=0){let o=this._map.get(e);if(o)o.value=r,n!==0&&this.touch(o,n);else{switch(o={key:e,value:r,next:void 0,previous:void 0},n){case 0:this.addItemLast(o);break;case 1:this.addItemFirst(o);break;case 2:this.addItemLast(o);break;default:this.addItemLast(o);break}this._map.set(e,o),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let r=this._map.get(e);if(r)return this._map.delete(e),this.removeItem(r),this._size--,r.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,r){let n=this._state,o=this._head;for(;o;){if(r?e.bind(r)(o.value,o.key,this):e(o.value,o.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");o=o.next}}keys(){let e=this,r=this._state,n=this._head,o={[Symbol.iterator](){return o},next(){if(e._state!==r)throw new Error("LinkedMap got modified during iteration.");if(n){let s={value:n.key,done:!1};return n=n.next,s}else return{value:void 0,done:!0}}};return o}values(){let e=this,r=this._state,n=this._head,o={[Symbol.iterator](){return o},next(){if(e._state!==r)throw new Error("LinkedMap got modified during iteration.");if(n){let s={value:n.value,done:!1};return n=n.next,s}else return{value:void 0,done:!0}}};return o}entries(){let e=this,r=this._state,n=this._head,o={[Symbol.iterator](){return o},next(){if(e._state!==r)throw new Error("LinkedMap got modified during iteration.");if(n){let s={value:[n.key,n.value],done:!1};return n=n.next,s}else return{value:void 0,done:!0}}};return o}[(MDe=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let r=this._head,n=this.size;for(;r&&n>e;)this._map.delete(r.key),r=r.next,n--;this._head=r,this._size=n,r&&(r.previous=void 0),this._state++}trimNew(e){if(e>=this.size)return;if(e===0){this.clear();return}let r=this._tail,n=this.size;for(;r&&n>e;)this._map.delete(r.key),r=r.previous,n--;this._tail=r,this._size=n,r&&(r.next=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let r=e.next,n=e.previous;if(!r||!n)throw new Error("Invalid list");r.previous=n,n.next=r}e.next=void 0,e.previous=void 0,this._state++}touch(e,r){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(r!==1&&r!==2)){if(r===1){if(e===this._head)return;let n=e.next,o=e.previous;e===this._tail?(o.next=void 0,this._tail=o):(n.previous=o,o.next=n),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(r===2){if(e===this._tail)return;let n=e.next,o=e.previous;e===this._head?(n.previous=void 0,this._head=n):(n.previous=o,o.next=n),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((r,n)=>{e.push([n,r])}),e}fromJSON(e){this.clear();for(let[r,n]of e)this.set(r,n)}},M7=class extends O7{constructor(e,r=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,r),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,r=2){return super.get(e,r)}peek(e){return super.get(e,0)}set(e,r){return super.set(e,r,2),this}checkTrim(){this.size>this._limit&&this.trim(Math.round(this._limit*this._ratio))}},km=class extends M7{constructor(e,r=1){super(e,r)}trim(e){this.trimOld(e)}set(e,r){return super.set(e,r),this.checkTrim(),this}};var VA=class{constructor(){this.map=new Map}add(e,r){let n=this.map.get(e);n||(n=new Set,this.map.set(e,n)),n.add(r)}delete(e,r){let n=this.map.get(e);n&&(n.delete(r),n.size===0&&this.map.delete(e))}forEach(e,r){let n=this.map.get(e);n&&n.forEach(r)}get(e){let r=this.map.get(e);return r||new Set}};var ks;(_=>{function t(b){return b&&typeof b=="object"&&typeof b[Symbol.iterator]=="function"}_.is=t;let e=Object.freeze([]);function r(){return e}_.empty=r;function*n(b){yield b}_.single=n;function o(b){return t(b)?b:n(b)}_.wrap=o;function s(b){return b||e}_.from=s;function*a(b){for(let S=b.length-1;S>=0;S--)yield b[S]}_.reverse=a;function c(b){return!b||b[Symbol.iterator]().next().done===!0}_.isEmpty=c;function u(b){return b[Symbol.iterator]().next().value}_.first=u;function l(b,S){for(let I of b)if(S(I))return!0;return!1}_.some=l;function d(b,S){for(let I of b)if(S(I))return I}_.find=d;function*p(b,S){for(let I of b)S(I)&&(yield I)}_.filter=p;function*f(b,S){let I=0;for(let w of b)yield S(w,I++)}_.map=f;function*m(...b){for(let S of b)yield*S}_.concat=m;function h(b,S,I){let w=I;for(let O of b)w=S(w,O);return w}_.reduce=h;function*g(b,S,I=b.length){for(S<0&&(S+=b.length),I<0?I+=b.length:I>b.length&&(I=b.length);S<I;S++)yield b[S]}_.slice=g;function v(b,S=Number.POSITIVE_INFINITY){let I=[];if(S===0)return[I,b];let w=b[Symbol.iterator]();for(let O=0;O<S;O++){let U=w.next();if(U.done)return[I,_.empty()];I.push(U.value)}return[I,{[Symbol.iterator](){return w}}]}_.consume=v;async function y(b){let S=[];for await(let I of b)S.push(I);return Promise.resolve(S)}_.asyncToArray=y})(ks||={});var FDe=!1,f_=null,cre=class t{constructor(){this.livingDisposables=new Map}static{this.idx=0}getDisposableData(e){let r=this.livingDisposables.get(e);return r||(r={parent:null,source:null,isSingleton:!1,value:e,idx:t.idx++},this.livingDisposables.set(e,r)),r}trackDisposable(e){let r=this.getDisposableData(e);r.source||(r.source=new Error().stack)}setParent(e,r){let n=this.getDisposableData(e);n.parent=r}markAsDisposed(e){this.livingDisposables.delete(e)}markAsSingleton(e){this.getDisposableData(e).isSingleton=!0}getRootParent(e,r){let n=r.get(e);if(n)return n;let o=e.parent?this.getRootParent(this.getDisposableData(e.parent),r):e;return r.set(e,o),o}getTrackedDisposables(){let e=new Map;return[...this.livingDisposables.entries()].filter(([,n])=>n.source!==null&&!this.getRootParent(n,e).isSingleton).flatMap(([n])=>n)}computeLeakingDisposables(e=10,r){let n;if(r)n=r;else{let u=new Map,l=[...this.livingDisposables.values()].filter(p=>p.source!==null&&!this.getRootParent(p,u).isSingleton);if(l.length===0)return;let d=new Set(l.map(p=>p.value));if(n=l.filter(p=>!(p.parent&&d.has(p.parent))),n.length===0)throw new Error("There are cyclic diposable chains!")}if(!n)return;function o(u){function l(p,f){for(;p.length>0&&f.some(m=>typeof m=="string"?m===p[0]:p[0].match(m));)p.shift()}let d=u.source.split(`
`).map(p=>p.trim().replace("at ","")).filter(p=>p!=="");return l(d,["Error",/^trackDisposable \(.*\)$/,/^DisposableTracker.trackDisposable \(.*\)$/]),d.reverse()}let s=new VA;for(let u of n){let l=o(u);for(let d=0;d<=l.length;d++)s.add(l.slice(0,d).join(`
`),u)}n.sort(zA(u=>u.idx,GA));let a="",c=0;for(let u of n.slice(0,e)){c++;let l=o(u),d=[];for(let p=0;p<l.length;p++){let f=l[p];f=`(shared with ${s.get(l.slice(0,p+1).join(`
`)).size}/${n.length} leaks) at ${f}`;let h=s.get(l.slice(0,p).join(`
`)),g=sre([...h].map(v=>o(v)[p]),v=>v);delete g[l[p]];for(let[v,y]of Object.entries(g))d.unshift(`    - stacktraces of ${y.length} other leaks continue with ${v}`);d.unshift(f)}a+=`


==================== Leaking disposable ${c}/${n.length}: ${u.value.constructor.name} ====================
${d.join(`
`)}
============================================================

`}return n.length>e&&(a+=`


... and ${n.length-e} more leaking disposables

`),{leaks:n,details:a}}};function UDe(t){f_=t}if(FDe){let t="__is_disposable_tracked__";UDe(new class{trackDisposable(e){let r=new Error("Potentially leaked disposable").stack;setTimeout(()=>{e[t]||console.log(r)},3e3)}setParent(e,r){if(e&&e!==St.None)try{e[t]=!0}catch{}}markAsDisposed(e){if(e&&e!==St.None)try{e[t]=!0}catch{}}markAsSingleton(e){}})}function h_(t){return f_?.trackDisposable(t),t}function g_(t){f_?.markAsDisposed(t)}function F7(t,e){f_?.setParent(t,e)}function BDe(t,e){if(f_)for(let r of t)f_.setParent(r,e)}function $A(t){return typeof t=="object"&&t!==null&&typeof t.dispose=="function"&&t.dispose.length===0}function Am(t){if(ks.is(t)){let e=[];for(let r of t)if(r)try{r.dispose()}catch(n){e.push(n)}if(e.length===1)throw e[0];if(e.length>1)throw new AggregateError(e,"Encountered errors while disposing of store");return Array.isArray(t)?[]:t}else if(t)return t.dispose(),t}function WA(...t){let e=Ta(()=>Am(t));return BDe(t,e),e}function Ta(t){let e=h_({dispose:k7(()=>{g_(e),t()})});return e}var Nt=class t{constructor(){this._toDispose=new Set;this._isDisposed=!1;h_(this)}static{this.DISABLE_DISPOSED_WARNING=!1}dispose(){this._isDisposed||(g_(this),this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{Am(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return F7(e,this),this._isDisposed?t.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}delete(e){if(e){if(e===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(e),e.dispose()}}deleteAndLeak(e){e&&this._toDispose.has(e)&&(this._toDispose.delete(e),F7(e,null))}},St=class{constructor(){this._store=new Nt;h_(this),F7(this._store,this)}static{this.None=Object.freeze({dispose(){}})}dispose(){g_(this),this._store.dispose()}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}};var m_=class{constructor(){this._store=new Map;this._isDisposed=!1;h_(this)}dispose(){g_(this),this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{Am(this._store.values())}finally{this._store.clear()}}has(e){return this._store.has(e)}get size(){return this._store.size}get(e){return this._store.get(e)}set(e,r,n=!1){this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),n||this._store.get(e)?.dispose(),this._store.set(e,r)}deleteAndDispose(e){this._store.get(e)?.dispose(),this._store.delete(e)}deleteAndLeak(e){let r=this._store.get(e);return this._store.delete(e),r}keys(){return this._store.keys()}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}};var Dn=class t{static{this.Undefined=new t(void 0)}constructor(e){this.element=e,this.next=t.Undefined,this.prev=t.Undefined}},oE=class{constructor(){this._first=Dn.Undefined;this._last=Dn.Undefined;this._size=0}get size(){return this._size}isEmpty(){return this._first===Dn.Undefined}clear(){let e=this._first;for(;e!==Dn.Undefined;){let r=e.next;e.prev=Dn.Undefined,e.next=Dn.Undefined,e=r}this._first=Dn.Undefined,this._last=Dn.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,r){let n=new Dn(e);if(this._first===Dn.Undefined)this._first=n,this._last=n;else if(r){let s=this._last;this._last=n,n.prev=s,s.next=n}else{let s=this._first;this._first=n,n.next=s,s.prev=n}this._size+=1;let o=!1;return()=>{o||(o=!0,this._remove(n))}}shift(){if(this._first!==Dn.Undefined){let e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==Dn.Undefined){let e=this._last.element;return this._remove(this._last),e}}_remove(e){if(e.prev!==Dn.Undefined&&e.next!==Dn.Undefined){let r=e.prev;r.next=e.next,e.next.prev=r}else e.prev===Dn.Undefined&&e.next===Dn.Undefined?(this._first=Dn.Undefined,this._last=Dn.Undefined):e.next===Dn.Undefined?(this._last=this._last.prev,this._last.next=Dn.Undefined):e.prev===Dn.Undefined&&(this._first=this._first.next,this._first.prev=Dn.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==Dn.Undefined;)yield e.element,e=e.next}};var qDe=globalThis.performance&&typeof globalThis.performance.now=="function",ql=class t{static create(e){return new t(e)}constructor(e){this._now=qDe&&e===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}};var HDe=!1,ure=!1,jDe=!1,Vu;(ee=>{ee.None=()=>St.None;function e(N){if(jDe){let{onDidAddListener:E}=N,P=sE.create(),q=0;N.onDidAddListener=()=>{++q===2&&(console.warn("snapshotted emitter LIKELY used public and SHOULD HAVE BEEN created with DisposableStore. snapshotted here"),P.print()),E?.()}}}function r(N,E){return f(N,()=>{},0,void 0,!0,void 0,E)}ee.defer=r;function n(N){return(E,P=null,q)=>{let F=!1,Z;return Z=N(ue=>{if(!F)return Z?Z.dispose():F=!0,E.call(P,ue)},null,q),F&&Z.dispose(),Z}}ee.once=n;function o(N,E,P){return d((q,F=null,Z)=>N(ue=>q.call(F,E(ue)),null,Z),P)}ee.map=o;function s(N,E,P){return d((q,F=null,Z)=>N(ue=>{E(ue),q.call(F,ue)},null,Z),P)}ee.forEach=s;function a(N,E,P){return d((q,F=null,Z)=>N(ue=>E(ue)&&q.call(F,ue),null,Z),P)}ee.filter=a;function c(N){return N}ee.signal=c;function u(...N){return(E,P=null,q)=>{let F=WA(...N.map(Z=>Z(ue=>E.call(P,ue))));return p(F,q)}}ee.any=u;function l(N,E,P,q){let F=P;return o(N,Z=>(F=E(F,Z),F),q)}ee.reduce=l;function d(N,E){let P,q={onWillAddFirstListener(){P=N(F.fire,F)},onDidRemoveLastListener(){P?.dispose()}};E||e(q);let F=new Ht(q);return E?.add(F),F.event}function p(N,E){return E instanceof Array?E.push(N):E&&E.add(N),N}function f(N,E,P=100,q=!1,F=!1,Z,ue){let te,Q,je,ne=0,ht,We={leakWarningThreshold:Z,onWillAddFirstListener(){te=N(xr=>{ne++,Q=E(Q,xr),q&&!je&&(Ct.fire(Q),Q=void 0),ht=()=>{let ye=Q;Q=void 0,je=void 0,(!q||ne>1)&&Ct.fire(ye),ne=0},typeof P=="number"?(clearTimeout(je),je=setTimeout(ht,P)):je===void 0&&(je=0,queueMicrotask(ht))})},onWillRemoveListener(){F&&ne>0&&ht?.()},onDidRemoveLastListener(){ht=void 0,te.dispose()}};ue||e(We);let Ct=new Ht(We);return ue?.add(Ct),Ct.event}ee.debounce=f;function m(N,E=0,P){return ee.debounce(N,(q,F)=>q?(q.push(F),q):[F],E,void 0,!0,void 0,P)}ee.accumulate=m;function h(N,E=(q,F)=>q===F,P){let q=!0,F;return a(N,Z=>{let ue=q||!E(Z,F);return q=!1,F=Z,ue},P)}ee.latch=h;function g(N,E,P){return[ee.filter(N,E,P),ee.filter(N,q=>!E(q),P)]}ee.split=g;function v(N,E=!1,P=[],q){let F=P.slice(),Z=N(Q=>{F?F.push(Q):te.fire(Q)});q&&q.add(Z);let ue=()=>{F?.forEach(Q=>te.fire(Q)),F=null},te=new Ht({onWillAddFirstListener(){Z||(Z=N(Q=>te.fire(Q)),q&&q.add(Z))},onDidAddFirstListener(){F&&(E?setTimeout(ue):ue())},onDidRemoveLastListener(){Z&&Z.dispose(),Z=null}});return q&&q.add(te),te.event}ee.buffer=v;function y(N,E){return(q,F,Z)=>{let ue=E(new b);return N(function(te){let Q=ue.evaluate(te);Q!==_&&q.call(F,Q)},void 0,Z)}}ee.chain=y;let _=Symbol("HaltChainable");class b{constructor(){this.steps=[]}map(E){return this.steps.push(E),this}forEach(E){return this.steps.push(P=>(E(P),P)),this}filter(E){return this.steps.push(P=>E(P)?P:_),this}reduce(E,P){let q=P;return this.steps.push(F=>(q=E(q,F),q)),this}latch(E=(P,q)=>P===q){let P=!0,q;return this.steps.push(F=>{let Z=P||!E(F,q);return P=!1,q=F,Z?F:_}),this}evaluate(E){for(let P of this.steps)if(E=P(E),E===_)break;return E}}function S(N,E,P=q=>q){let q=(...te)=>ue.fire(P(...te)),F=()=>N.on(E,q),Z=()=>N.removeListener(E,q),ue=new Ht({onWillAddFirstListener:F,onDidRemoveLastListener:Z});return ue.event}ee.fromNodeEventEmitter=S;function I(N,E,P=q=>q){let q=(...te)=>ue.fire(P(...te)),F=()=>N.addEventListener(E,q),Z=()=>N.removeEventListener(E,q),ue=new Ht({onWillAddFirstListener:F,onDidRemoveLastListener:Z});return ue.event}ee.fromDOMEventEmitter=I;function w(N){return new Promise(E=>n(N)(E))}ee.toPromise=w;function O(N){let E=new Ht;return N.then(P=>{E.fire(P)},()=>{E.fire(void 0)}).finally(()=>{E.dispose()}),E.event}ee.fromPromise=O;function U(N,E,P){return E(P),N(q=>E(q))}ee.runAndSubscribe=U;class z{constructor(E,P){this._observable=E;this._counter=0;this._hasChanged=!1;let q={onWillAddFirstListener:()=>{E.addObserver(this)},onDidRemoveLastListener:()=>{E.removeObserver(this)}};P||e(q),this.emitter=new Ht(q),P&&P.add(this.emitter)}beginUpdate(E){this._counter++}handlePossibleChange(E){}handleChange(E,P){this._hasChanged=!0}endUpdate(E){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function M(N,E){return new z(N,E).emitter.event}ee.fromObservable=M;function re(N){return(E,P,q)=>{let F=0,Z=!1,ue={beginUpdate(){F++},endUpdate(){F--,F===0&&(N.reportChanges(),Z&&(Z=!1,E.call(P)))},handlePossibleChange(){},handleChange(){Z=!0}};N.addObserver(ue),N.reportChanges();let te={dispose(){N.removeObserver(ue)}};return q instanceof Nt?q.add(te):Array.isArray(q)&&q.push(te),te}}ee.fromObservableLight=re})(Vu||={});var B7=class t{constructor(e){this.listenerCount=0;this.invocationCount=0;this.elapsedOverall=0;this.durations=[];this.name=`${e}_${t._idPool++}`,t.all.add(this)}static{this.all=new Set}static{this._idPool=0}start(e){this._stopWatch=new ql,this.listenerCount=e}stop(){if(this._stopWatch){let e=this._stopWatch.elapsed();this.durations.push(e),this.elapsedOverall+=e,this.invocationCount+=1,this._stopWatch=void 0}}},lre=-1;var q7=class{constructor(e,r,n=Math.random().toString(18).slice(2,5)){this._errorHandler=e;this.threshold=r;this.name=n;this._warnCountdown=0}dispose(){this._stacks?.clear()}check(e,r){let n=this.threshold;if(n<=0||r<n)return;this._stacks||(this._stacks=new Map);let o=this._stacks.get(e.value)||0;if(this._stacks.set(e.value,o+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=n*.5;let[s,a]=this.getMostFrequentStack(),c=`[${this.name}] potential listener LEAK detected, having ${r} listeners already. MOST frequent listener (${a}):`;console.warn(c),console.warn(s);let u=new H7(c,s);this._errorHandler(u)}return()=>{let s=this._stacks.get(e.value)||0;this._stacks.set(e.value,s-1)}}getMostFrequentStack(){if(!this._stacks)return;let e,r=0;for(let[n,o]of this._stacks)(!e||r<o)&&(e=[n,o],r=o);return e}},sE=class t{constructor(e){this.value=e}static create(){let e=new Error;return new t(e.stack??"")}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}},H7=class extends Error{constructor(e,r){super(e),this.name="ListenerLeakError",this.stack=r}},j7=class extends Error{constructor(e,r){super(e),this.name="ListenerRefusalError",this.stack=r}},zDe=0,v_=class{constructor(e){this.value=e;this.id=zDe++}},GDe=2,VDe=(t,e)=>{if(t instanceof v_)e(t);else for(let r=0;r<t.length;r++){let n=t[r];n&&e(n)}},U7=HDe?new FinalizationRegistry(t=>{typeof t=="string"&&(console.warn("[LEAKING LISTENER] GC'ed a listener that was NOT yet disposed. This is where is was created:"),console.warn(t))}):void 0,Ht=class{constructor(e){this._size=0;this._options=e,this._leakageMon=lre>0||this._options?.leakWarningThreshold?new q7(e?.onListenerError??Rm,this._options?.leakWarningThreshold??lre):void 0,this._perfMon=this._options?._profName?new B7(this._options._profName):void 0,this._deliveryQueue=this._options?.deliveryQueue}dispose(){if(!this._disposed){if(this._disposed=!0,this._deliveryQueue?.current===this&&this._deliveryQueue.reset(),this._listeners){if(ure){let e=this._listeners;queueMicrotask(()=>{VDe(e,r=>r.stack?.print())})}this._listeners=void 0,this._size=0}this._options?.onDidRemoveLastListener?.(),this._leakageMon?.dispose()}}get event(){return this._event??=(e,r,n)=>{if(this._leakageMon&&this._size>this._leakageMon.threshold**2){let u=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(u);let l=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],d=new j7(`${u}. HINT: Stack shows most frequent listener (${l[1]}-times)`,l[0]);return(this._options?.onListenerError||Rm)(d),St.None}if(this._disposed)return St.None;r&&(e=e.bind(r));let o=new v_(e),s,a;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(o.stack=sE.create(),s=this._leakageMon.check(o.stack,this._size+1)),ure&&(o.stack=a??sE.create()),this._listeners?this._listeners instanceof v_?(this._deliveryQueue??=new z7,this._listeners=[this._listeners,o]):this._listeners.push(o):(this._options?.onWillAddFirstListener?.(this),this._listeners=o,this._options?.onDidAddFirstListener?.(this)),this._size++;let c=Ta(()=>{U7?.unregister(c),s?.(),this._removeListener(o)});if(n instanceof Nt?n.add(c):Array.isArray(n)&&n.push(c),U7){let u=new Error().stack.split(`
`).slice(2).join(`
`).trim();U7.register(c,u,c)}return c},this._event}_removeListener(e){if(this._options?.onWillRemoveListener?.(this),!this._listeners)return;if(this._size===1){this._listeners=void 0,this._options?.onDidRemoveLastListener?.(this),this._size=0;return}let r=this._listeners,n=r.indexOf(e);if(n===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,r[n]=void 0;let o=this._deliveryQueue.current===this;if(this._size*GDe<=r.length){let s=0;for(let a=0;a<r.length;a++)r[a]?r[s++]=r[a]:o&&(this._deliveryQueue.end--,s<this._deliveryQueue.i&&this._deliveryQueue.i--);r.length=s}}_deliver(e,r){if(!e)return;let n=this._options?.onListenerError||Rm;if(!n){e.value(r);return}try{e.value(r)}catch(o){n(o)}}_deliverQueue(e){let r=e.current._listeners;for(;e.i<e.end;)this._deliver(r[e.i++],e.value);e.reset()}fire(e){if(this._deliveryQueue?.current&&(this._deliverQueue(this._deliveryQueue),this._perfMon?.stop()),this._perfMon?.start(this._size),this._listeners)if(this._listeners instanceof v_)this._deliver(this._listeners,e);else{let r=this._deliveryQueue;r.enqueue(this,e,this._listeners.length),this._deliverQueue(r)}this._perfMon?.stop()}hasListeners(){return this._size>0}};var z7=class{constructor(){this.i=-1;this.end=0}enqueue(e,r,n){this.i=0,this.end=n,this.current=e,this.value=r}reset(){this.i=this.end,this.current=void 0,this.value=void 0}};var dre=Object.freeze(function(t,e){let r=setTimeout(t.bind(e),0);return{dispose(){clearTimeout(r)}}}),Fr;(n=>{function t(o){return o===n.None||o===n.Cancelled||o instanceof y_?!0:!o||typeof o!="object"?!1:typeof o.isCancellationRequested=="boolean"&&typeof o.onCancellationRequested=="function"}n.isCancellationToken=t,n.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Vu.None}),n.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:dre})})(Fr||={});var y_=class{constructor(){this._isCancelled=!1;this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?dre:(this._emitter||(this._emitter=new Ht),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}},s0=class{constructor(e){this._token=void 0;this._parentListener=void 0;this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new y_),this._token}cancel(){this._token?this._token instanceof y_&&this._token.cancel():this._token=Fr.Cancelled}dispose(e=!1){e&&this.cancel(),this._parentListener?.dispose(),this._token?this._token instanceof y_&&this._token.dispose():this._token=Fr.None}};function $De(t,e){let r;return e.length===0?r=t:r=t.replace(/\{(\d+)\}/g,function(n,o){let s=o[0];return typeof e[s]<"u"?e[s]:n}),r}function KA(t,e,...r){return $De(e,r)}var b_="en",JA=!1,ZA=!1,aE=!1,KDe=!1,fre=!1,G7=!1,YDe=!1,QDe=!1,XDe=!1,JDe=!1,YA,QA=b_,pre=b_,ZDe,Ap,Pp=globalThis,cc;typeof Pp.vscode<"u"&&typeof Pp.vscode.process<"u"?cc=Pp.vscode.process:typeof process<"u"&&typeof process?.versions?.node=="string"&&(cc=process);var mre=typeof cc?.versions?.electron=="string",eNe=mre&&cc?.type==="renderer";if(typeof cc=="object"){JA=cc.platform==="win32",ZA=cc.platform==="darwin",aE=cc.platform==="linux",KDe=aE&&!!cc.env.SNAP&&!!cc.env.SNAP_REVISION,YDe=mre,XDe=!!cc.env.CI||!!cc.env.BUILD_ARTIFACTSTAGINGDIRECTORY,YA=b_,QA=b_;let t=cc.env.VSCODE_NLS_CONFIG;if(t)try{let e=JSON.parse(t),r=e.availableLanguages["*"];YA=e.locale,pre=e.osLocale,QA=r||b_,ZDe=e._translationsConfigFile}catch{}fre=!0}else typeof navigator=="object"&&!eNe?(Ap=navigator.userAgent,JA=Ap.indexOf("Windows")>=0,ZA=Ap.indexOf("Macintosh")>=0,QDe=(Ap.indexOf("Macintosh")>=0||Ap.indexOf("iPad")>=0||Ap.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,aE=Ap.indexOf("Linux")>=0,JDe=Ap?.indexOf("Mobi")>=0,G7=!0,YA=(KA({key:"ensureLoaderPluginIsLoaded",comment:["{Locked}"]},"_"),void 0)||b_,QA=YA,pre=navigator.language):console.error("Unable to resolve platform.");var XA=0;ZA?XA=1:JA?XA=3:aE&&(XA=2);var jl=JA,hre=ZA,gre=aE;var vre=fre;var yre=G7,tNe=G7&&typeof Pp.importScripts=="function",bre=tNe?Pp.origin:void 0;var _re=XA,Hl=Ap,Pm=QA,rNe;(n=>{function t(){return Pm}n.value=t;function e(){return Pm.length===2?Pm==="en":Pm.length>=3?Pm[0]==="e"&&Pm[1]==="n"&&Pm[2]==="-":!1}n.isDefaultVariant=e;function r(){return Pm==="en"}n.isDefault=r})(rNe||={});var nNe=typeof Pp.postMessage=="function"&&!Pp.importScripts,xre=(()=>{if(nNe){let t=[];Pp.addEventListener("message",r=>{if(r.data&&r.data.vscodeScheduleAsyncWork)for(let n=0,o=t.length;n<o;n++){let s=t[n];if(s.id===r.data.vscodeScheduleAsyncWork){t.splice(n,1),s.callback();return}}});let e=0;return r=>{let n=++e;t.push({id:n,callback:r}),Pp.postMessage({vscodeScheduleAsyncWork:n},"*")}}return t=>setTimeout(t)})();var iNe=!!(Hl&&Hl.indexOf("Chrome")>=0),Aut=!!(Hl&&Hl.indexOf("Firefox")>=0),Put=!!(!iNe&&Hl&&Hl.indexOf("Safari")>=0),Dut=!!(Hl&&Hl.indexOf("Edg/")>=0),Nut=!!(Hl&&Hl.indexOf("Android")>=0);var a0,V7=globalThis.vscode;if(typeof V7<"u"&&typeof V7.process<"u"){let t=V7.process;a0={get platform(){return t.platform},get arch(){return t.arch},get env(){return t.env},cwd(){return t.cwd()}}}else typeof process<"u"?a0={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()}}:a0={get platform(){return jl?"win32":hre?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};var cE=a0.cwd,Sre=a0.env,Ire=a0.platform,Mut=a0.arch;var aNe=65,cNe=97,uNe=90,lNe=122,Lm=46,No=47,Ea=92,Dm=58,dNe=63,eP=class extends Error{constructor(e,r,n){let o;typeof r=="string"&&r.indexOf("not ")===0?(o="must not be",r=r.replace(/^not /,"")):o="must be";let s=e.indexOf(".")!==-1?"property":"argument",a=`The "${e}" ${s} ${o} of type ${r}`;a+=`. Received type ${typeof n}`,super(a),this.code="ERR_INVALID_ARG_TYPE"}};function pNe(t,e){if(t===null||typeof t!="object")throw new eP(e,"Object",t)}function gi(t,e){if(typeof t!="string")throw new eP(e,"string",t)}var wa=Ire==="win32";function Yt(t){return t===No||t===Ea}function $7(t){return t===No}function Nm(t){return t>=aNe&&t<=uNe||t>=cNe&&t<=lNe}function tP(t,e,r,n){let o="",s=0,a=-1,c=0,u=0;for(let l=0;l<=t.length;++l){if(l<t.length)u=t.charCodeAt(l);else{if(n(u))break;u=No}if(n(u)){if(!(a===l-1||c===1))if(c===2){if(o.length<2||s!==2||o.charCodeAt(o.length-1)!==Lm||o.charCodeAt(o.length-2)!==Lm){if(o.length>2){let d=o.lastIndexOf(r);d===-1?(o="",s=0):(o=o.slice(0,d),s=o.length-1-o.lastIndexOf(r)),a=l,c=0;continue}else if(o.length!==0){o="",s=0,a=l,c=0;continue}}e&&(o+=o.length>0?`${r}..`:"..",s=2)}else o.length>0?o+=`${r}${t.slice(a+1,l)}`:o=t.slice(a+1,l),s=l-a-1;a=l,c=0}else u===Lm&&c!==-1?++c:c=-1}return o}function Cre(t,e){pNe(e,"pathObject");let r=e.dir||e.root,n=e.base||`${e.name||""}${e.ext||""}`;return r?r===e.root?`${r}${n}`:`${r}${t}${n}`:n}var vi={resolve(...t){let e="",r="",n=!1;for(let o=t.length-1;o>=-1;o--){let s;if(o>=0){if(s=t[o],gi(s,"path"),s.length===0)continue}else e.length===0?s=cE():(s=Sre[`=${e}`]||cE(),(s===void 0||s.slice(0,2).toLowerCase()!==e.toLowerCase()&&s.charCodeAt(2)===Ea)&&(s=`${e}\\`));let a=s.length,c=0,u="",l=!1,d=s.charCodeAt(0);if(a===1)Yt(d)&&(c=1,l=!0);else if(Yt(d))if(l=!0,Yt(s.charCodeAt(1))){let p=2,f=p;for(;p<a&&!Yt(s.charCodeAt(p));)p++;if(p<a&&p!==f){let m=s.slice(f,p);for(f=p;p<a&&Yt(s.charCodeAt(p));)p++;if(p<a&&p!==f){for(f=p;p<a&&!Yt(s.charCodeAt(p));)p++;(p===a||p!==f)&&(u=`\\\\${m}\\${s.slice(f,p)}`,c=p)}}}else c=1;else Nm(d)&&s.charCodeAt(1)===Dm&&(u=s.slice(0,2),c=2,a>2&&Yt(s.charCodeAt(2))&&(l=!0,c=3));if(u.length>0)if(e.length>0){if(u.toLowerCase()!==e.toLowerCase())continue}else e=u;if(n){if(e.length>0)break}else if(r=`${s.slice(c)}\\${r}`,n=l,l&&e.length>0)break}return r=tP(r,!n,"\\",Yt),n?`${e}\\${r}`:`${e}${r}`||"."},normalize(t){gi(t,"path");let e=t.length;if(e===0)return".";let r=0,n,o=!1,s=t.charCodeAt(0);if(e===1)return $7(s)?"\\":t;if(Yt(s))if(o=!0,Yt(t.charCodeAt(1))){let c=2,u=c;for(;c<e&&!Yt(t.charCodeAt(c));)c++;if(c<e&&c!==u){let l=t.slice(u,c);for(u=c;c<e&&Yt(t.charCodeAt(c));)c++;if(c<e&&c!==u){for(u=c;c<e&&!Yt(t.charCodeAt(c));)c++;if(c===e)return`\\\\${l}\\${t.slice(u)}\\`;c!==u&&(n=`\\\\${l}\\${t.slice(u,c)}`,r=c)}}}else r=1;else Nm(s)&&t.charCodeAt(1)===Dm&&(n=t.slice(0,2),r=2,e>2&&Yt(t.charCodeAt(2))&&(o=!0,r=3));let a=r<e?tP(t.slice(r),!o,"\\",Yt):"";return a.length===0&&!o&&(a="."),a.length>0&&Yt(t.charCodeAt(e-1))&&(a+="\\"),n===void 0?o?`\\${a}`:a:o?`${n}\\${a}`:`${n}${a}`},isAbsolute(t){gi(t,"path");let e=t.length;if(e===0)return!1;let r=t.charCodeAt(0);return Yt(r)||e>2&&Nm(r)&&t.charCodeAt(1)===Dm&&Yt(t.charCodeAt(2))},join(...t){if(t.length===0)return".";let e,r;for(let s=0;s<t.length;++s){let a=t[s];gi(a,"path"),a.length>0&&(e===void 0?e=r=a:e+=`\\${a}`)}if(e===void 0)return".";let n=!0,o=0;if(typeof r=="string"&&Yt(r.charCodeAt(0))){++o;let s=r.length;s>1&&Yt(r.charCodeAt(1))&&(++o,s>2&&(Yt(r.charCodeAt(2))?++o:n=!1))}if(n){for(;o<e.length&&Yt(e.charCodeAt(o));)o++;o>=2&&(e=`\\${e.slice(o)}`)}return vi.normalize(e)},relative(t,e){if(gi(t,"from"),gi(e,"to"),t===e)return"";let r=vi.resolve(t),n=vi.resolve(e);if(r===n||(t=r.toLowerCase(),e=n.toLowerCase(),t===e))return"";let o=0;for(;o<t.length&&t.charCodeAt(o)===Ea;)o++;let s=t.length;for(;s-1>o&&t.charCodeAt(s-1)===Ea;)s--;let a=s-o,c=0;for(;c<e.length&&e.charCodeAt(c)===Ea;)c++;let u=e.length;for(;u-1>c&&e.charCodeAt(u-1)===Ea;)u--;let l=u-c,d=a<l?a:l,p=-1,f=0;for(;f<d;f++){let h=t.charCodeAt(o+f);if(h!==e.charCodeAt(c+f))break;h===Ea&&(p=f)}if(f!==d){if(p===-1)return n}else{if(l>d){if(e.charCodeAt(c+f)===Ea)return n.slice(c+f+1);if(f===2)return n.slice(c+f)}a>d&&(t.charCodeAt(o+f)===Ea?p=f:f===2&&(p=3)),p===-1&&(p=0)}let m="";for(f=o+p+1;f<=s;++f)(f===s||t.charCodeAt(f)===Ea)&&(m+=m.length===0?"..":"\\..");return c+=p,m.length>0?`${m}${n.slice(c,u)}`:(n.charCodeAt(c)===Ea&&++c,n.slice(c,u))},toNamespacedPath(t){if(typeof t!="string"||t.length===0)return t;let e=vi.resolve(t);if(e.length<=2)return t;if(e.charCodeAt(0)===Ea){if(e.charCodeAt(1)===Ea){let r=e.charCodeAt(2);if(r!==dNe&&r!==Lm)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(Nm(e.charCodeAt(0))&&e.charCodeAt(1)===Dm&&e.charCodeAt(2)===Ea)return`\\\\?\\${e}`;return t},dirname(t){gi(t,"path");let e=t.length;if(e===0)return".";let r=-1,n=0,o=t.charCodeAt(0);if(e===1)return Yt(o)?t:".";if(Yt(o)){if(r=n=1,Yt(t.charCodeAt(1))){let c=2,u=c;for(;c<e&&!Yt(t.charCodeAt(c));)c++;if(c<e&&c!==u){for(u=c;c<e&&Yt(t.charCodeAt(c));)c++;if(c<e&&c!==u){for(u=c;c<e&&!Yt(t.charCodeAt(c));)c++;if(c===e)return t;c!==u&&(r=n=c+1)}}}}else Nm(o)&&t.charCodeAt(1)===Dm&&(r=e>2&&Yt(t.charCodeAt(2))?3:2,n=r);let s=-1,a=!0;for(let c=e-1;c>=n;--c)if(Yt(t.charCodeAt(c))){if(!a){s=c;break}}else a=!1;if(s===-1){if(r===-1)return".";s=r}return t.slice(0,s)},basename(t,e){e!==void 0&&gi(e,"ext"),gi(t,"path");let r=0,n=-1,o=!0,s;if(t.length>=2&&Nm(t.charCodeAt(0))&&t.charCodeAt(1)===Dm&&(r=2),e!==void 0&&e.length>0&&e.length<=t.length){if(e===t)return"";let a=e.length-1,c=-1;for(s=t.length-1;s>=r;--s){let u=t.charCodeAt(s);if(Yt(u)){if(!o){r=s+1;break}}else c===-1&&(o=!1,c=s+1),a>=0&&(u===e.charCodeAt(a)?--a===-1&&(n=s):(a=-1,n=c))}return r===n?n=c:n===-1&&(n=t.length),t.slice(r,n)}for(s=t.length-1;s>=r;--s)if(Yt(t.charCodeAt(s))){if(!o){r=s+1;break}}else n===-1&&(o=!1,n=s+1);return n===-1?"":t.slice(r,n)},extname(t){gi(t,"path");let e=0,r=-1,n=0,o=-1,s=!0,a=0;t.length>=2&&t.charCodeAt(1)===Dm&&Nm(t.charCodeAt(0))&&(e=n=2);for(let c=t.length-1;c>=e;--c){let u=t.charCodeAt(c);if(Yt(u)){if(!s){n=c+1;break}continue}o===-1&&(s=!1,o=c+1),u===Lm?r===-1?r=c:a!==1&&(a=1):r!==-1&&(a=-1)}return r===-1||o===-1||a===0||a===1&&r===o-1&&r===n+1?"":t.slice(r,o)},format:Cre.bind(null,"\\"),parse(t){gi(t,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;let r=t.length,n=0,o=t.charCodeAt(0);if(r===1)return Yt(o)?(e.root=e.dir=t,e):(e.base=e.name=t,e);if(Yt(o)){if(n=1,Yt(t.charCodeAt(1))){let p=2,f=p;for(;p<r&&!Yt(t.charCodeAt(p));)p++;if(p<r&&p!==f){for(f=p;p<r&&Yt(t.charCodeAt(p));)p++;if(p<r&&p!==f){for(f=p;p<r&&!Yt(t.charCodeAt(p));)p++;p===r?n=p:p!==f&&(n=p+1)}}}}else if(Nm(o)&&t.charCodeAt(1)===Dm){if(r<=2)return e.root=e.dir=t,e;if(n=2,Yt(t.charCodeAt(2))){if(r===3)return e.root=e.dir=t,e;n=3}}n>0&&(e.root=t.slice(0,n));let s=-1,a=n,c=-1,u=!0,l=t.length-1,d=0;for(;l>=n;--l){if(o=t.charCodeAt(l),Yt(o)){if(!u){a=l+1;break}continue}c===-1&&(u=!1,c=l+1),o===Lm?s===-1?s=l:d!==1&&(d=1):s!==-1&&(d=-1)}return c!==-1&&(s===-1||d===0||d===1&&s===c-1&&s===a+1?e.base=e.name=t.slice(a,c):(e.name=t.slice(a,s),e.base=t.slice(a,c),e.ext=t.slice(s,c))),a>0&&a!==n?e.dir=t.slice(0,a-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null},fNe=(()=>{if(wa){let t=/\\/g;return()=>{let e=cE().replace(t,"/");return e.slice(e.indexOf("/"))}}return()=>cE()})(),hr={resolve(...t){let e="",r=!1;for(let n=t.length-1;n>=-1&&!r;n--){let o=n>=0?t[n]:fNe();gi(o,"path"),o.length!==0&&(e=`${o}/${e}`,r=o.charCodeAt(0)===No)}return e=tP(e,!r,"/",$7),r?`/${e}`:e.length>0?e:"."},normalize(t){if(gi(t,"path"),t.length===0)return".";let e=t.charCodeAt(0)===No,r=t.charCodeAt(t.length-1)===No;return t=tP(t,!e,"/",$7),t.length===0?e?"/":r?"./":".":(r&&(t+="/"),e?`/${t}`:t)},isAbsolute(t){return gi(t,"path"),t.length>0&&t.charCodeAt(0)===No},join(...t){if(t.length===0)return".";let e;for(let r=0;r<t.length;++r){let n=t[r];gi(n,"path"),n.length>0&&(e===void 0?e=n:e+=`/${n}`)}return e===void 0?".":hr.normalize(e)},relative(t,e){if(gi(t,"from"),gi(e,"to"),t===e||(t=hr.resolve(t),e=hr.resolve(e),t===e))return"";let r=1,n=t.length,o=n-r,s=1,a=e.length-s,c=o<a?o:a,u=-1,l=0;for(;l<c;l++){let p=t.charCodeAt(r+l);if(p!==e.charCodeAt(s+l))break;p===No&&(u=l)}if(l===c)if(a>c){if(e.charCodeAt(s+l)===No)return e.slice(s+l+1);if(l===0)return e.slice(s+l)}else o>c&&(t.charCodeAt(r+l)===No?u=l:l===0&&(u=0));let d="";for(l=r+u+1;l<=n;++l)(l===n||t.charCodeAt(l)===No)&&(d+=d.length===0?"..":"/..");return`${d}${e.slice(s+u)}`},toNamespacedPath(t){return t},dirname(t){if(gi(t,"path"),t.length===0)return".";let e=t.charCodeAt(0)===No,r=-1,n=!0;for(let o=t.length-1;o>=1;--o)if(t.charCodeAt(o)===No){if(!n){r=o;break}}else n=!1;return r===-1?e?"/":".":e&&r===1?"//":t.slice(0,r)},basename(t,e){e!==void 0&&gi(e,"ext"),gi(t,"path");let r=0,n=-1,o=!0,s;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e===t)return"";let a=e.length-1,c=-1;for(s=t.length-1;s>=0;--s){let u=t.charCodeAt(s);if(u===No){if(!o){r=s+1;break}}else c===-1&&(o=!1,c=s+1),a>=0&&(u===e.charCodeAt(a)?--a===-1&&(n=s):(a=-1,n=c))}return r===n?n=c:n===-1&&(n=t.length),t.slice(r,n)}for(s=t.length-1;s>=0;--s)if(t.charCodeAt(s)===No){if(!o){r=s+1;break}}else n===-1&&(o=!1,n=s+1);return n===-1?"":t.slice(r,n)},extname(t){gi(t,"path");let e=-1,r=0,n=-1,o=!0,s=0;for(let a=t.length-1;a>=0;--a){let c=t.charCodeAt(a);if(c===No){if(!o){r=a+1;break}continue}n===-1&&(o=!1,n=a+1),c===Lm?e===-1?e=a:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||n===-1||s===0||s===1&&e===n-1&&e===r+1?"":t.slice(e,n)},format:Cre.bind(null,"/"),parse(t){gi(t,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;let r=t.charCodeAt(0)===No,n;r?(e.root="/",n=1):n=0;let o=-1,s=0,a=-1,c=!0,u=t.length-1,l=0;for(;u>=n;--u){let d=t.charCodeAt(u);if(d===No){if(!c){s=u+1;break}continue}a===-1&&(c=!1,a=u+1),d===Lm?o===-1?o=u:l!==1&&(l=1):o!==-1&&(l=-1)}if(a!==-1){let d=s===0&&r?1:s;o===-1||l===0||l===1&&o===a-1&&o===s+1?e.base=e.name=t.slice(d,a):(e.name=t.slice(d,o),e.base=t.slice(d,a),e.ext=t.slice(o,a))}return s>0?e.dir=t.slice(0,s-1):r&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};hr.win32=vi.win32=vi;hr.posix=vi.posix=hr;var W7=wa?vi.normalize:hr.normalize,mNe=wa?vi.isAbsolute:hr.isAbsolute,hNe=wa?vi.join:hr.join,Tre=wa?vi.resolve:hr.resolve,Ere=wa?vi.relative:hr.relative,wre=wa?vi.dirname:hr.dirname,rP=wa?vi.basename:hr.basename,Fut=wa?vi.extname:hr.extname,Uut=wa?vi.format:hr.format,But=wa?vi.parse:hr.parse,qut=wa?vi.toNamespacedPath:hr.toNamespacedPath,__=wa?vi.sep:hr.sep,Hut=wa?vi.delimiter:hr.delimiter;function Rre(t){return t}var iP=class{constructor(e,r){this.lastCache=void 0;this.lastArgKey=void 0;typeof e=="function"?(this._fn=e,this._computeKey=Rre):(this._fn=r,this._computeKey=e.getCacheKey)}get(e){let r=this._computeKey(e);return this.lastArgKey!==r&&(this.lastArgKey=r,this.lastCache=this._fn(e)),this.lastCache}},uE=class{constructor(e,r){this._map=new Map;this._map2=new Map;typeof e=="function"?(this._fn=e,this._computeKey=Rre):(this._fn=r,this._computeKey=e.getCacheKey)}get cachedValues(){return this._map}get(e){let r=this._computeKey(e);if(this._map2.has(r))return this._map2.get(r);let n=this._fn(e);return this._map.set(e,n),this._map2.set(r,n),n}};var Lo=class{constructor(e){this.executor=e;this._didRun=!1}get hasValue(){return this._didRun}get value(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}};function c0(t){return t.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function x_(t,e){let r=0,n=t.indexOf(e);for(;n!==-1;)r++,n=t.indexOf(e,n+e.length);return r}function oP(t){return t.split(/\r\n|\r|\n/)}function Nre(t){for(let e=0,r=t.length;e<r;e++){let n=t.charCodeAt(e);if(n!==32&&n!==9)return e}return-1}function lE(t,e,r){let n=[],o=0;for(let s of t.matchAll(e)){if(n.push(t.slice(o,s.index)),s.index===void 0)throw new Error("match.index should be defined");o=s.index+s[0].length,n.push(r(s[0],...s.slice(1),s.index,t,s.groups))}return n.push(t.slice(o)),Promise.all(n).then(s=>s.join(""))}function Lre(t,e){return t<e?-1:t>e?1:0}function vNe(t,e,r=0,n=t.length,o=0,s=e.length){for(;r<n&&o<s;r++,o++){let u=t.charCodeAt(r),l=e.charCodeAt(o);if(u<l)return-1;if(u>l)return 1}let a=n-r,c=s-o;return a<c?-1:a>c?1:0}function Ore(t,e,r=0,n=t.length,o=0,s=e.length){for(;r<n&&o<s;r++,o++){let u=t.charCodeAt(r),l=e.charCodeAt(o);if(u===l)continue;if(u>=128||l>=128)return vNe(t.toLowerCase(),e.toLowerCase(),r,n,o,s);kre(u)&&(u-=32),kre(l)&&(l-=32);let d=u-l;if(d!==0)return d}let a=n-r,c=s-o;return a<c?-1:a>c?1:0}function kre(t){return t>=97&&t<=122}function sP(t,e){return t.length===e.length&&Ore(t,e)===0}function dE(t,e){let r=e.length;return e.length>t.length?!1:Ore(t,e,0,r)===0}function aP(t,e){let r=Math.min(t.length,e.length),n;for(n=0;n<r;n++)if(t.charCodeAt(n)!==e.charCodeAt(n))return n;return r}function Mre(t,e){let r=Math.min(t.length,e.length),n,o=t.length-1,s=e.length-1;for(n=0;n<r;n++)if(t.charCodeAt(o-n)!==e.charCodeAt(s-n))return n;return r}var Xut=String.fromCharCode(65279);var Are=class t{static{this._INSTANCE=null}static getInstance(){return t._INSTANCE||(t._INSTANCE=new t),t._INSTANCE}constructor(){this._data=yNe()}getGraphemeBreakType(e){if(e<32)return e===10?3:e===13?2:4;if(e<127)return 0;let r=this._data,n=r.length/3,o=1;for(;o<=n;)if(e<r[3*o])o=2*o;else if(e>r[3*o+1])o=2*o+1;else return r[3*o+2];return 0}};function yNe(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}var Pre=class t{constructor(e){this.confusableDictionary=e}static{this.ambiguousCharacterData=new Lo(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}'))}static{this.cache=new iP({getCacheKey:JSON.stringify},e=>{function r(d){let p=new Map;for(let f=0;f<d.length;f+=2)p.set(d[f],d[f+1]);return p}function n(d,p){let f=new Map(d);for(let[m,h]of p)f.set(m,h);return f}function o(d,p){if(!d)return p;let f=new Map;for(let[m,h]of d)p.has(m)&&f.set(m,h);return f}let s=this.ambiguousCharacterData.value,a=e.filter(d=>!d.startsWith("_")&&d in s);a.length===0&&(a=["_default"]);let c;for(let d of a){let p=r(s[d]);c=o(c,p)}let u=r(s._common),l=n(u,c);return new t(l)})}static getInstance(e){return t.cache.get(Array.from(e))}static{this._locales=new Lo(()=>Object.keys(t.ambiguousCharacterData.value).filter(e=>!e.startsWith("_")))}static getLocales(){return t._locales.value}isAmbiguous(e){return this.confusableDictionary.has(e)}containsAmbiguousCharacter(e){for(let r=0;r<e.length;r++){let n=e.codePointAt(r);if(typeof n=="number"&&this.isAmbiguous(n))return!0}return!1}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}},Dre=class t{static getRawData(){return JSON.parse("[9,10,11,12,13,32,127,160,173,847,1564,4447,4448,6068,6069,6155,6156,6157,6158,7355,7356,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8203,8204,8205,8206,8207,8234,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,8293,8294,8295,8296,8297,8298,8299,8300,8301,8302,8303,10240,12288,12644,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65279,65440,65520,65521,65522,65523,65524,65525,65526,65527,65528,65532,78844,119155,119156,119157,119158,119159,119160,119161,119162,917504,917505,917506,917507,917508,917509,917510,917511,917512,917513,917514,917515,917516,917517,917518,917519,917520,917521,917522,917523,917524,917525,917526,917527,917528,917529,917530,917531,917532,917533,917534,917535,917536,917537,917538,917539,917540,917541,917542,917543,917544,917545,917546,917547,917548,917549,917550,917551,917552,917553,917554,917555,917556,917557,917558,917559,917560,917561,917562,917563,917564,917565,917566,917567,917568,917569,917570,917571,917572,917573,917574,917575,917576,917577,917578,917579,917580,917581,917582,917583,917584,917585,917586,917587,917588,917589,917590,917591,917592,917593,917594,917595,917596,917597,917598,917599,917600,917601,917602,917603,917604,917605,917606,917607,917608,917609,917610,917611,917612,917613,917614,917615,917616,917617,917618,917619,917620,917621,917622,917623,917624,917625,917626,917627,917628,917629,917630,917631,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999]")}static{this._data=void 0}static getData(){return this._data||(this._data=new Set(t.getRawData())),this._data}static isInvisibleCharacter(e){return t.getData().has(e)}static containsInvisibleCharacter(e){for(let r=0;r<e.length;r++){let n=e.codePointAt(r);if(typeof n=="number"&&t.isInvisibleCharacter(n))return!0}return!1}static get codePoints(){return t.getData()}};function pE(t){return typeof t=="string"}function cP(t){return Array.isArray(t)&&t.every(e=>pE(e))}function K7(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)&&!(t instanceof RegExp)&&!(t instanceof Date)}function S_(t){return typeof t=="number"&&!isNaN(t)}function bNe(t){return typeof t>"u"}function I_(t){return!_Ne(t)}function _Ne(t){return bNe(t)||t===null}function uP(t,e){if(!t)throw new Error(e?`Unexpected type, expected '${e}'`:"Unexpected type")}function Mm(t){return t===47||t===92}function C_(t){return t.replace(/[\\/]/g,hr.sep)}function Ure(t){return t.indexOf("/")===-1&&(t=C_(t)),/^[a-zA-Z]:(\/|$)/.test(t)&&(t="/"+t),t}function Y7(t,e=hr.sep){if(!t)return"";let r=t.length,n=t.charCodeAt(0);if(Mm(n)){if(Mm(t.charCodeAt(1))&&!Mm(t.charCodeAt(2))){let s=3,a=s;for(;s<r&&!Mm(t.charCodeAt(s));s++);if(a!==s&&!Mm(t.charCodeAt(s+1))){for(s+=1;s<r;s++)if(Mm(t.charCodeAt(s)))return t.slice(0,s+1).replace(/[\\/]/g,e)}}return e}else if(SNe(n)&&t.charCodeAt(1)===58)return Mm(t.charCodeAt(2))?t.slice(0,2)+e:t.slice(0,2);let o=t.indexOf("://");if(o!==-1){for(o+=3;o<r;o++)if(Mm(t.charCodeAt(o)))return t.slice(0,o+1)}return""}function Q7(t,e,r,n=__){if(t===e)return!0;if(!t||!e||e.length>t.length)return!1;if(r){if(!dE(t,e))return!1;if(e.length===t.length)return!0;let s=e.length;return e.charAt(e.length-1)===n&&s--,t.charAt(s)===n}return e.charAt(e.length-1)!==n&&(e+=n),t.indexOf(e)===0}function SNe(t){return t>=65&&t<=90||t>=97&&t<=122}var CNe=/^\w[\w\d+.-]*$/,TNe=/^\//,ENe=/^\/\//;function wNe(t,e){if(!t.scheme&&e)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${t.authority}", path: "${t.path}", query: "${t.query}", fragment: "${t.fragment}"}`);if(t.scheme&&!CNe.test(t.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(t.path){if(t.authority){if(!TNe.test(t.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(ENe.test(t.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function RNe(t,e){return!t&&!e?"file":t}function kNe(t,e){switch(t){case"https":case"http":case"file":e?e[0]!==$u&&(e=$u+e):e=$u;break}return e}var hn="",$u="/",ANe=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,lt=class t{static isUri(e){return e instanceof t?!0:e?typeof e.authority=="string"&&typeof e.fragment=="string"&&typeof e.path=="string"&&typeof e.query=="string"&&typeof e.scheme=="string"&&typeof e.fsPath=="string"&&typeof e.with=="function"&&typeof e.toString=="function":!1}constructor(e,r,n,o,s,a=!1){typeof e=="object"?(this.scheme=e.scheme||hn,this.authority=e.authority||hn,this.path=e.path||hn,this.query=e.query||hn,this.fragment=e.fragment||hn):(this.scheme=RNe(e,a),this.authority=r||hn,this.path=kNe(this.scheme,n||hn),this.query=o||hn,this.fragment=s||hn,wNe(this,a))}get fsPath(){return fE(this,!1)}with(e){if(!e)return this;let{scheme:r,authority:n,path:o,query:s,fragment:a}=e;return r===void 0?r=this.scheme:r===null&&(r=hn),n===void 0?n=this.authority:n===null&&(n=hn),o===void 0?o=this.path:o===null&&(o=hn),s===void 0?s=this.query:s===null&&(s=hn),a===void 0?a=this.fragment:a===null&&(a=hn),r===this.scheme&&n===this.authority&&o===this.path&&s===this.query&&a===this.fragment?this:new Fm(r,n,o,s,a)}static parse(e,r=!1){let n=ANe.exec(e);return n?new Fm(n[2]||hn,lP(n[4]||hn),lP(n[5]||hn),lP(n[7]||hn),lP(n[9]||hn),r):new Fm(hn,hn,hn,hn,hn)}static file(e){let r=hn;if(jl&&(e=e.replace(/\\/g,$u)),e[0]===$u&&e[1]===$u){let n=e.indexOf($u,2);n===-1?(r=e.substring(2),e=$u):(r=e.substring(2,n),e=e.substring(n)||$u)}return new Fm("file",r,e,hn,hn)}static from(e,r){return new Fm(e.scheme,e.authority,e.path,e.query,e.fragment,r)}static joinPath(e,...r){if(!e.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let n;return jl&&e.scheme==="file"?n=t.file(vi.join(fE(e,!0),...r)).path:n=hr.join(e.path,...r),e.with({path:n})}toString(e=!1){return X7(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof t)return e;{let r=new Fm(e);return r._formatted=e.external??null,r._fsPath=e._sep===Hre?e.fsPath??null:null,r}}else return e}};function u0(t){return!t||typeof t!="object"?!1:typeof t.scheme=="string"&&(typeof t.authority=="string"||typeof t.authority>"u")&&(typeof t.path=="string"||typeof t.path>"u")&&(typeof t.query=="string"||typeof t.query>"u")&&(typeof t.fragment=="string"||typeof t.fragment>"u")}var Hre=jl?1:void 0,Fm=class extends lt{constructor(){super(...arguments);this._formatted=null;this._fsPath=null}get fsPath(){return this._fsPath||(this._fsPath=fE(this,!1)),this._fsPath}toString(r=!1){return r?X7(this,!0):(this._formatted||(this._formatted=X7(this,!1)),this._formatted)}toJSON(){let r={$mid:1};return this._fsPath&&(r.fsPath=this._fsPath,r._sep=Hre),this._formatted&&(r.external=this._formatted),this.path&&(r.path=this.path),this.scheme&&(r.scheme=this.scheme),this.authority&&(r.authority=this.authority),this.query&&(r.query=this.query),this.fragment&&(r.fragment=this.fragment),r}},jre={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function Bre(t,e,r){let n,o=-1;for(let s=0;s<t.length;s++){let a=t.charCodeAt(s);if(a>=97&&a<=122||a>=65&&a<=90||a>=48&&a<=57||a===45||a===46||a===95||a===126||e&&a===47||r&&a===91||r&&a===93||r&&a===58)o!==-1&&(n+=encodeURIComponent(t.substring(o,s)),o=-1),n!==void 0&&(n+=t.charAt(s));else{n===void 0&&(n=t.substr(0,s));let c=jre[a];c!==void 0?(o!==-1&&(n+=encodeURIComponent(t.substring(o,s)),o=-1),n+=c):o===-1&&(o=s)}}return o!==-1&&(n+=encodeURIComponent(t.substring(o))),n!==void 0?n:t}function PNe(t){let e;for(let r=0;r<t.length;r++){let n=t.charCodeAt(r);n===35||n===63?(e===void 0&&(e=t.substr(0,r)),e+=jre[n]):e!==void 0&&(e+=t[r])}return e!==void 0?e:t}function fE(t,e){let r;return t.authority&&t.path.length>1&&t.scheme==="file"?r=`//${t.authority}${t.path}`:t.path.charCodeAt(0)===47&&(t.path.charCodeAt(1)>=65&&t.path.charCodeAt(1)<=90||t.path.charCodeAt(1)>=97&&t.path.charCodeAt(1)<=122)&&t.path.charCodeAt(2)===58?e?r=t.path.substr(1):r=t.path[1].toLowerCase()+t.path.substr(2):r=t.path,jl&&(r=r.replace(/\//g,"\\")),r}function X7(t,e){let r=e?PNe:Bre,n="",{scheme:o,authority:s,path:a,query:c,fragment:u}=t;if(o&&(n+=o,n+=":"),(s||o==="file")&&(n+=$u,n+=$u),s){let l=s.indexOf("@");if(l!==-1){let d=s.substr(0,l);s=s.substr(l+1),l=d.lastIndexOf(":"),l===-1?n+=r(d,!1,!1):(n+=r(d.substr(0,l),!1,!1),n+=":",n+=r(d.substr(l+1),!1,!0)),n+="@"}s=s.toLowerCase(),l=s.lastIndexOf(":"),l===-1?n+=r(s,!1,!0):(n+=r(s.substr(0,l),!1,!0),n+=s.substr(l))}if(a){if(a.length>=3&&a.charCodeAt(0)===47&&a.charCodeAt(2)===58){let l=a.charCodeAt(1);l>=65&&l<=90&&(a=`/${String.fromCharCode(l+32)}:${a.substr(3)}`)}else if(a.length>=2&&a.charCodeAt(1)===58){let l=a.charCodeAt(0);l>=65&&l<=90&&(a=`${String.fromCharCode(l+32)}:${a.substr(2)}`)}n+=r(a,!0,!1)}return c&&(n+="?",n+=r(c,!1,!1)),u&&(n+="#",n+=e?u:Bre(u,!1,!1)),n}function zre(t){try{return decodeURIComponent(t)}catch{return t.length>3?t.substr(0,3)+zre(t.substr(3)):t}}var qre=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function lP(t){return t.match(qre)?t.replace(qre,e=>zre(e)):t}var nn;(Q=>(Q.inMemory="inmemory",Q.vscode="vscode",Q.internal="private",Q.walkThrough="walkThrough",Q.walkThroughSnippet="walkThroughSnippet",Q.http="http",Q.https="https",Q.file="file",Q.mailto="mailto",Q.untitled="untitled",Q.data="data",Q.command="command",Q.vscodeRemote="vscode-remote",Q.vscodeRemoteResource="vscode-remote-resource",Q.vscodeManagedRemoteResource="vscode-managed-remote-resource",Q.vscodeUserData="vscode-userdata",Q.vscodeCustomEditor="vscode-custom-editor",Q.vscodeNotebookCell="vscode-notebook-cell",Q.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",Q.vscodeNotebookCellOutput="vscode-notebook-cell-output",Q.vscodeInteractiveInput="vscode-interactive-input",Q.vscodeSettings="vscode-settings",Q.vscodeWorkspaceTrust="vscode-workspace-trust",Q.vscodeTerminal="vscode-terminal",Q.vscodeChatCodeBlock="vscode-chat-code-block",Q.vscodeCopilotBackingChatCodeBlock="vscode-copilot-chat-code-block",Q.vscodeChatCodeCompareBlock="vscode-chat-code-compare-block",Q.vscodeChatSesssion="vscode-chat-editor",Q.webviewPanel="webview-panel",Q.vscodeWebview="vscode-webview",Q.extension="extension",Q.vscodeFileResource="vscode-file",Q.tmp="tmp",Q.vsls="vsls",Q.vscodeSourceControl="vscode-scm",Q.commentsInput="comment",Q.codeSetting="code-setting"))(nn||={});var DNe="tkn",J7=class{constructor(){this._hosts=Object.create(null);this._ports=Object.create(null);this._connectionTokens=Object.create(null);this._preferredWebSchema="http";this._delegate=null;this._serverRootPath="/"}setPreferredWebSchema(e){this._preferredWebSchema=e}setDelegate(e){this._delegate=e}setServerRootPath(e,r){this._serverRootPath=LNe(e,r)}getServerRootPath(){return this._serverRootPath}get _remoteResourcesPath(){return hr.join(this._serverRootPath,nn.vscodeRemoteResource)}set(e,r,n){this._hosts[e]=r,this._ports[e]=n}setConnectionToken(e,r){this._connectionTokens[e]=r}getPreferredWebSchema(){return this._preferredWebSchema}rewrite(e){if(this._delegate)try{return this._delegate(e)}catch(c){return Rm(c),e}let r=e.authority,n=this._hosts[r];n&&n.indexOf(":")!==-1&&n.indexOf("[")===-1&&(n=`[${n}]`);let o=this._ports[r],s=this._connectionTokens[r],a=`path=${encodeURIComponent(e.path)}`;return typeof s=="string"&&(a+=`&${DNe}=${encodeURIComponent(s)}`),lt.from({scheme:yre?this._preferredWebSchema:nn.vscodeRemoteResource,authority:`${n}:${o}`,path:this._remoteResourcesPath,query:a})}},NNe=new J7;function LNe(t,e){return hr.join(e??"/",`${t.quality??"oss"}-${t.commit??"dev"}`)}var ONe="vscode-app",Z7=class t{static{this.FALLBACK_AUTHORITY=ONe}asBrowserUri(e){let r=this.toUri(e,require);return this.uriToBrowserUri(r)}uriToBrowserUri(e){return e.scheme===nn.vscodeRemote?NNe.rewrite(e):e.scheme===nn.file&&(vre||bre===`${nn.vscodeFileResource}://${t.FALLBACK_AUTHORITY}`)?e.with({scheme:nn.vscodeFileResource,authority:e.authority||t.FALLBACK_AUTHORITY,query:null,fragment:null}):e}asFileUri(e){let r=this.toUri(e,require);return this.uriToFileUri(r)}uriToFileUri(e){return e.scheme===nn.vscodeFileResource?e.with({scheme:nn.file,authority:e.authority!==t.FALLBACK_AUTHORITY?e.authority:null,query:null,fragment:null}):e}toUri(e,r){return lt.isUri(e)?e:lt.parse(r.toUrl(e))}},plt=new Z7,MNe;(s=>{let t=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);s.CoopAndCoep=Object.freeze(t.get("3"));let r="vscode-coi";function n(a){let c;typeof a=="string"?c=new URL(a).searchParams:a instanceof URL?c=a.searchParams:lt.isUri(a)&&(c=new URL(a.toString(!0)).searchParams);let u=c?.get(r);if(u)return t.get(u)}s.getHeadersFromQuery=n;function o(a,c,u){if(!globalThis.crossOriginIsolated)return;let l=c&&u?"3":u?"2":"1";a instanceof URLSearchParams?a.set(r,l):a[r]=l}s.addSearchParam=o})(MNe||={});function Dp(t){return fE(t,!0)}var mE=class{constructor(e){this._ignorePathCasing=e}compare(e,r,n=!1){return e===r?0:Lre(this.getComparisonKey(e,n),this.getComparisonKey(r,n))}isEqual(e,r,n=!1){return e===r?!0:!e||!r?!1:this.getComparisonKey(e,n)===this.getComparisonKey(r,n)}getComparisonKey(e,r=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:r?null:void 0}).toString()}ignorePathCasing(e){return this._ignorePathCasing(e)}isEqualOrParent(e,r,n=!1){if(e.scheme===r.scheme){if(e.scheme===nn.file)return Q7(Dp(e),Dp(r),this._ignorePathCasing(e))&&e.query===r.query&&(n||e.fragment===r.fragment);if(Gre(e.authority,r.authority))return Q7(e.path,r.path,this._ignorePathCasing(e),"/")&&e.query===r.query&&(n||e.fragment===r.fragment)}return!1}joinPath(e,...r){return lt.joinPath(e,...r)}basenameOrAuthority(e){return Uc(e)||e.authority}basename(e){return hr.basename(e.path)}extname(e){return hr.extname(e.path)}dirname(e){if(e.path.length===0)return e;let r;return e.scheme===nn.file?r=lt.file(wre(Dp(e))).path:(r=hr.dirname(e.path),e.authority&&r.length&&r.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),r="/")),e.with({path:r})}normalizePath(e){if(!e.path.length)return e;let r;return e.scheme===nn.file?r=lt.file(W7(Dp(e))).path:r=hr.normalize(e.path),e.with({path:r})}relativePath(e,r){if(e.scheme!==r.scheme||!Gre(e.authority,r.authority))return;if(e.scheme===nn.file){let s=Ere(Dp(e),Dp(r));return jl?C_(s):s}let n=e.path||"/",o=r.path||"/";if(this._ignorePathCasing(e)){let s=0;for(let a=Math.min(n.length,o.length);s<a&&!(n.charCodeAt(s)!==o.charCodeAt(s)&&n.charAt(s).toLowerCase()!==o.charAt(s).toLowerCase());s++);n=o.substr(0,s)+n.substr(s)}return hr.relative(n,o)}resolvePath(e,r){if(e.scheme===nn.file){let n=lt.file(Tre(Dp(e),r));return e.with({authority:n.authority,path:n.path})}return r=Ure(r),e.with({path:hr.resolve(e.path,r)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,r){return e===r||e!==void 0&&r!==void 0&&sP(e,r)}hasTrailingPathSeparator(e,r=__){if(e.scheme===nn.file){let n=Dp(e);return n.length>Y7(n).length&&n[n.length-1]===r}else{let n=e.path;return n.length>1&&n.charCodeAt(n.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,r=__){return Vre(e,r)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,r=__){let n=!1;if(e.scheme===nn.file){let o=Dp(e);n=o!==void 0&&o.length===Y7(o).length&&o[o.length-1]===r}else{r="/";let o=e.path;n=o.length===1&&o.charCodeAt(o.length-1)===47}return!n&&!Vre(e,r)?e.with({path:e.path+"/"}):e}},Pr=new mE(()=>!1),blt=new mE(t=>t.scheme===nn.file?!gre:!0),_lt=new mE(t=>!0),T_=Pr.isEqual.bind(Pr),xlt=Pr.isEqualOrParent.bind(Pr),Slt=Pr.getComparisonKey.bind(Pr),Ilt=Pr.basenameOrAuthority.bind(Pr),Uc=Pr.basename.bind(Pr),uc=Pr.extname.bind(Pr),Clt=Pr.dirname.bind(Pr),Tlt=Pr.joinPath.bind(Pr),Elt=Pr.normalizePath.bind(Pr),$re=Pr.relativePath.bind(Pr),wlt=Pr.resolvePath.bind(Pr),Rlt=Pr.isAbsolutePath.bind(Pr),Gre=Pr.isEqualAuthority.bind(Pr),Vre=Pr.hasTrailingPathSeparator.bind(Pr),klt=Pr.removeTrailingPathSeparator.bind(Pr),Alt=Pr.addTrailingPathSeparator.bind(Pr);var FNe;(s=>{s.META_DATA_LABEL="label",s.META_DATA_DESCRIPTION="description",s.META_DATA_SIZE="size",s.META_DATA_MIME="mime";function o(a){let c=new Map;a.path.substring(a.path.indexOf(";")+1,a.path.lastIndexOf(";")).split(";").forEach(d=>{let[p,f]=d.split(":");p&&f&&c.set(p,f)});let l=a.path.substring(0,a.path.indexOf(";"));return l&&c.set(s.META_DATA_MIME,l),c}s.parseMetaData=o})(FNe||={});var Kre=Symbol("MicrotaskDelay");function nU(t){let e=new s0,r=t(e.token),n=new Promise((o,s)=>{let a=e.token.onCancellationRequested(()=>{a.dispose(),s(new ns)});Promise.resolve(r).then(c=>{a.dispose(),e.dispose(),o(c)},c=>{a.dispose(),e.dispose(),s(c)})});return new class{cancel(){e.cancel(),e.dispose()}then(o,s){return n.then(o,s)}catch(o){return this.then(void 0,o)}finally(o){return n.finally(o)}}}function Um(t,e,r){return new Promise((n,o)=>{let s=e.onCancellationRequested(()=>{s.dispose(),n(r)});t.then(n,o).finally(()=>s.dispose())})}function d0(t,e,r){let n,o=setTimeout(()=>{n?.(void 0),r?.()},e);return Promise.race([t.finally(()=>clearTimeout(o)),new Promise(s=>n=s)])}var eU=class{constructor(){this.isDisposed=!1;this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(e){if(this.isDisposed)return Promise.reject(new Error("Throttler is disposed"));if(this.activePromise){if(this.queuedPromiseFactory=e,!this.queuedPromise){let r=()=>{if(this.queuedPromise=null,this.isDisposed)return;let n=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,n};this.queuedPromise=new Promise(n=>{this.activePromise.then(r,r).then(n)})}return new Promise((r,n)=>{this.queuedPromise.then(r,n)})}return this.activePromise=e(),new Promise((r,n)=>{this.activePromise.then(o=>{this.activePromise=null,r(o)},o=>{this.activePromise=null,n(o)})})}dispose(){this.isDisposed=!0}};var UNe=(t,e)=>{let r=!0,n=setTimeout(()=>{r=!1,e()},t);return{isTriggered:()=>r,dispose:()=>{clearTimeout(n),r=!1}}},BNe=t=>{let e=!0;return queueMicrotask(()=>{e&&(e=!1,t())}),{isTriggered:()=>e,dispose:()=>{e=!1}}},tU=class{constructor(e){this.defaultDelay=e;this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(e,r=this.defaultDelay){this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((o,s)=>{this.doResolve=o,this.doReject=s}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){let o=this.task;return this.task=null,o()}}));let n=()=>{this.deferred=null,this.doResolve?.(null)};return this.deferred=r===Kre?BNe(n):UNe(r,n),this.completionPromise}isTriggered(){return!!this.deferred?.isTriggered()}cancel(){this.cancelTimeout(),this.completionPromise&&(this.doReject?.(new ns),this.completionPromise=null)}cancelTimeout(){this.deferred?.dispose(),this.deferred=null}dispose(){this.cancel()}},pP=class{constructor(e){this.delayer=new tU(e),this.throttler=new eU}trigger(e,r){return this.delayer.trigger(()=>this.throttler.queue(e),r)}isTriggered(){return this.delayer.isTriggered()}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose(),this.throttler.dispose()}};function w_(t,e){return e?new Promise((r,n)=>{let o=setTimeout(()=>{s.dispose(),r()},t),s=e.onCancellationRequested(()=>{clearTimeout(o),s.dispose(),n(new ns)})}):nU(r=>w_(t,r))}var E_=class{constructor(e){this._size=0;this._isDisposed=!1;this.maxDegreeOfParalellism=e,this.outstandingPromises=[],this.runningPromises=0,this._onDrained=new Ht}whenIdle(){return this.size>0?Vu.toPromise(this.onDrained):Promise.resolve()}get onDrained(){return this._onDrained.event}get size(){return this._size}queue(e){if(this._isDisposed)throw new Error("Object has been disposed");return this._size++,new Promise((r,n)=>{this.outstandingPromises.push({factory:e,c:r,e:n}),this.consume()})}consume(){for(;this.outstandingPromises.length&&this.runningPromises<this.maxDegreeOfParalellism;){let e=this.outstandingPromises.shift();this.runningPromises++;let r=e.factory();r.then(e.c,e.e),r.then(()=>this.consumed(),()=>this.consumed())}}consumed(){this._isDisposed||(this.runningPromises--,--this._size===0&&this._onDrained.fire(),this.outstandingPromises.length>0&&this.consume())}clear(){if(this._isDisposed)throw new Error("Object has been disposed");this.outstandingPromises.length=0,this._size=this.runningPromises}dispose(){this._isDisposed=!0,this.outstandingPromises.length=0,this._size=0,this._onDrained.dispose()}};var fP=class{constructor(e,r){this._isDisposed=!1;this._token=-1,typeof e=="function"&&typeof r=="number"&&this.setIfNotSet(e,r)}dispose(){this.cancel(),this._isDisposed=!0}cancel(){this._token!==-1&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(e,r){if(this._isDisposed)throw new Qr("Calling 'cancelAndSet' on a disposed TimeoutTimer");this.cancel(),this._token=setTimeout(()=>{this._token=-1,e()},r)}setIfNotSet(e,r){if(this._isDisposed)throw new Qr("Calling 'setIfNotSet' on a disposed TimeoutTimer");this._token===-1&&(this._token=setTimeout(()=>{this._token=-1,e()},r))}},mP=class{constructor(){this.disposable=void 0;this.isDisposed=!1}cancel(){this.disposable?.dispose(),this.disposable=void 0}cancelAndSet(e,r,n=globalThis){if(this.isDisposed)throw new Qr("Calling 'cancelAndSet' on a disposed IntervalTimer");this.cancel();let o=n.setInterval(()=>{e()},r);this.disposable=Ta(()=>{n.clearInterval(o),this.disposable=void 0})}dispose(){this.cancel(),this.isDisposed=!0}},hP=class{constructor(e,r){this.timeoutToken=-1,this.runner=e,this.timeout=r,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(e=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,e)}get delay(){return this.timeout}set delay(e){this.timeout=e}isScheduled(){return this.timeoutToken!==-1}flush(){this.isScheduled()&&(this.cancel(),this.doRun())}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){this.runner?.()}};var qNe,dP;(function(){typeof globalThis.requestIdleCallback!="function"||typeof globalThis.cancelIdleCallback!="function"?dP=(t,e)=>{xre(()=>{if(r)return;let n=Date.now()+15;e(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,n-Date.now())}}))});let r=!1;return{dispose(){r||(r=!0)}}}:dP=(t,e,r)=>{let n=t.requestIdleCallback(e,typeof r=="number"?{timeout:r}:void 0),o=!1;return{dispose(){o||(o=!0,t.cancelIdleCallback(n))}}},qNe=t=>dP(globalThis,t)})();var rU=class{constructor(e,r){this._didRun=!1;this._executor=()=>{try{this._value=r()}catch(n){this._error=n}finally{this._didRun=!0}},this._handle=dP(e,()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}},gP=class extends rU{constructor(e){super(globalThis,e)}};var Np=class{get isRejected(){return this.outcome?.outcome===1}get isResolved(){return this.outcome?.outcome===0}get isSettled(){return!!this.outcome}get value(){return this.outcome?.outcome===0?this.outcome?.value:void 0}constructor(){this.p=new Promise((e,r)=>{this.completeCallback=e,this.errorCallback=r})}complete(e){return new Promise(r=>{this.completeCallback(e),this.outcome={outcome:0,value:e},r()})}error(e){return new Promise(r=>{this.errorCallback(e),this.outcome={outcome:1,value:e},r()})}cancel(){return this.error(new ns)}},HNe;(r=>{async function t(n){let o,s=await Promise.all(n.map(a=>a.then(c=>c,c=>{o||(o=c)})));if(typeof o<"u")throw o;return s}r.settled=t;function e(n){return new Promise(async(o,s)=>{try{await n(o,s)}catch(a){s(a)}})}r.withAsyncBody=e})(HNe||={});var Oo=class t{static fromArray(e){return new t(r=>{r.emitMany(e)})}static fromPromise(e){return new t(async r=>{r.emitMany(await e)})}static fromPromises(e){return new t(async r=>{await Promise.all(e.map(async n=>r.emitOne(await n)))})}static merge(e){return new t(async r=>{await Promise.all(e.map(async n=>{for await(let o of n)r.emitOne(o)}))})}static{this.EMPTY=t.fromArray([])}constructor(e,r){this._state=0,this._results=[],this._error=null,this._onReturn=r,this._onStateChanged=new Ht,queueMicrotask(async()=>{let n={emitOne:o=>this.emitOne(o),emitMany:o=>this.emitMany(o),reject:o=>this.reject(o)};try{await Promise.resolve(e(n)),this.resolve()}catch(o){this.reject(o)}finally{n.emitOne=void 0,n.emitMany=void 0,n.reject=void 0}})}[Symbol.asyncIterator](){let e=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(e<this._results.length)return{done:!1,value:this._results[e++]};if(this._state===1)return{done:!0,value:void 0};await Vu.toPromise(this._onStateChanged.event)}while(!0)},return:async()=>(this._onReturn?.(),{done:!0,value:void 0})}}static map(e,r){return new t(async n=>{for await(let o of e)n.emitOne(r(o))})}map(e){return t.map(this,e)}static filter(e,r){return new t(async n=>{for await(let o of e)r(o)&&n.emitOne(o)})}filter(e){return t.filter(this,e)}static coalesce(e){return t.filter(e,r=>!!r)}coalesce(){return t.coalesce(this)}static async toPromise(e){let r=[];for await(let n of e)r.push(n);return r}toPromise(){return t.toPromise(this)}emitOne(e){this._state===0&&(this._results.push(e),this._onStateChanged.fire())}emitMany(e){this._state===0&&(this._results=this._results.concat(e),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(e){this._state===0&&(this._state=2,this._error=e,this._onStateChanged.fire())}};var l0=class{constructor(e){this._deferred=new Np;this._asyncIterable=new Oo(o=>{if(r){o.reject(r);return}return n&&o.emitMany(n),this._errorFn=s=>o.reject(s),this._emitFn=s=>o.emitOne(s),this._deferred.p},e);let r,n;this._emitFn=o=>{n||(n=[]),n.push(o)},this._errorFn=o=>{r||(r=o)}}get asyncIterable(){return this._asyncIterable}resolve(){this._deferred.complete()}reject(e){this._errorFn(e),this._deferred.complete()}emitOne(e){this._emitFn(e)}};var Ue=class{constructor(e,r=[],n=!1){this.ctor=e,this.staticArguments=r,this.supportsDelayedInstantiation=n}};var iU=class{constructor(e,r){this.key=e;this.data=r;this.incoming=new Map;this.outgoing=new Map}},hE=class{constructor(e){this._hashFn=e;this._nodes=new Map}roots(){let e=[];for(let r of this._nodes.values())r.outgoing.size===0&&e.push(r);return e}insertEdge(e,r){let n=this.lookupOrInsertNode(e),o=this.lookupOrInsertNode(r);n.outgoing.set(o.key,o),o.incoming.set(n.key,n)}removeNode(e){let r=this._hashFn(e);this._nodes.delete(r);for(let n of this._nodes.values())n.outgoing.delete(r),n.incoming.delete(r)}lookupOrInsertNode(e){let r=this._hashFn(e),n=this._nodes.get(r);return n||(n=new iU(r,e),this._nodes.set(r,n)),n}lookup(e){return this._nodes.get(this._hashFn(e))}isEmpty(){return this._nodes.size===0}toString(){let e=[];for(let[r,n]of this._nodes)e.push(`${r}
	(-> incoming)[${[...n.incoming.keys()].join(", ")}]
	(outgoing ->)[${[...n.outgoing.keys()].join(",")}]
`);return e.join(`
`)}findCycleSlow(){for(let[e,r]of this._nodes){let n=new Set([e]),o=this._findCycle(r,n);if(o)return o}}_findCycle(e,r){for(let[n,o]of e.outgoing){if(r.has(n))return[...r,n].join(" -> ");r.add(n);let s=this._findCycle(o,r);if(s)return s;r.delete(n)}}};var p0=class{constructor(...e){this._entries=new Map;for(let[r,n]of e)this.set(r,n)}set(e,r){let n=this._entries.get(e);return this._entries.set(e,r),n}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}};var jNe=!1,vP=class extends Error{constructor(e){super("cyclic dependency between services"),this.message=e.findCycleSlow()??`UNABLE to detect cycle, dumping graph: 
${e.toString()}`}},yP=class t{constructor(e=new p0,r=!1,n,o=jNe){this._services=e;this._strict=r;this._parent=n;this._enableTracing=o;this._isDisposed=!1;this._servicesToMaybeDispose=new Set;this._children=new Set;this._activeInstantiations=new Set;this._services.set(or,this),this._globalGraph=o?n?._globalGraph??new hE(s=>s):void 0}dispose(){if(!this._isDisposed){this._isDisposed=!0,Am(this._children),this._children.clear();for(let e of this._servicesToMaybeDispose)$A(e)&&e.dispose();this._servicesToMaybeDispose.clear()}}_throwIfDisposed(){if(this._isDisposed)throw new Error("InstantiationService has been disposed")}createChild(e,r){this._throwIfDisposed();let n=this,o=new class extends t{dispose(){n._children.delete(o),super.dispose()}}(e,this._strict,this,this._enableTracing);return this._children.add(o),r?.add(o),o}invokeFunction(e,...r){this._throwIfDisposed();let n=gE.traceInvocation(this._enableTracing,e),o=!1;try{return e({get:a=>{if(o)throw Zte("service accessor is only valid during the invocation of its target method");let c=this._getOrCreateServiceInstance(a,n);if(!c)throw new Error(`[invokeFunction] unknown service '${a}'`);return c}},...r)}finally{o=!0,n.stop()}}createInstance(e,...r){this._throwIfDisposed();let n,o;return e instanceof Ue?(n=gE.traceCreation(this._enableTracing,e.ctor),o=this._createInstance(e.ctor,e.staticArguments.concat(r),n)):(n=gE.traceCreation(this._enableTracing,e),o=this._createInstance(e,r,n)),n.stop(),o}_createInstance(e,r=[],n){let o=Gu.getServiceDependencies(e).sort((c,u)=>c.index-u.index),s=[];for(let c of o){let u=this._getOrCreateServiceInstance(c.id,n);u||this._throwIfStrict(`[createInstance] ${e.name} depends on UNKNOWN service ${c.id}.`,!1),s.push(u)}let a=o.length>0?o[0].index:r.length;if(r.length!==a){console.trace(`[createInstance] First service dependency of ${e.name} at position ${a+1} conflicts with ${r.length} static arguments`);let c=a-r.length;c>0?r=r.concat(new Array(c)):r=r.slice(0,a)}return Reflect.construct(e,r.concat(s))}_setCreatedServiceInstance(e,r){if(this._services.get(e)instanceof Ue)this._services.set(e,r);else if(this._parent)this._parent._setCreatedServiceInstance(e,r);else throw new Error("illegalState - setting UNKNOWN service instance")}_getServiceInstanceOrDescriptor(e){let r=this._services.get(e);return!r&&this._parent?this._parent._getServiceInstanceOrDescriptor(e):r}_getOrCreateServiceInstance(e,r){this._globalGraph&&this._globalGraphImplicitDependency&&this._globalGraph.insertEdge(this._globalGraphImplicitDependency,String(e));let n=this._getServiceInstanceOrDescriptor(e);return n instanceof Ue?this._safeCreateAndCacheServiceInstance(e,n,r.branch(e,!0)):(r.branch(e,!1),n)}_safeCreateAndCacheServiceInstance(e,r,n){if(this._activeInstantiations.has(e))throw new Error(`illegal state - RECURSIVELY instantiating service '${e}'`);this._activeInstantiations.add(e);try{return this._createAndCacheServiceInstance(e,r,n)}finally{this._activeInstantiations.delete(e)}}_createAndCacheServiceInstance(e,r,n){let o=new hE(c=>c.id.toString()),s=0,a=[{id:e,desc:r,_trace:n}];for(;a.length;){let c=a.pop();if(o.lookupOrInsertNode(c),s++>1e3)throw new vP(o);for(let u of Gu.getServiceDependencies(c.desc.ctor)){let l=this._getServiceInstanceOrDescriptor(u.id);if(l||this._throwIfStrict(`[createInstance] ${e} depends on ${u.id} which is NOT registered.`,!0),this._globalGraph?.insertEdge(String(c.id),String(u.id)),l instanceof Ue){let d={id:u.id,desc:l,_trace:c._trace.branch(u.id,!0)};o.insertEdge(c,d),a.push(d)}}}for(;;){let c=o.roots();if(c.length===0){if(!o.isEmpty())throw new vP(o);break}for(let{data:u}of c){if(this._getServiceInstanceOrDescriptor(u.id)instanceof Ue){let d=this._createServiceInstanceWithOwner(u.id,u.desc.ctor,u.desc.staticArguments,u.desc.supportsDelayedInstantiation,u._trace);this._setCreatedServiceInstance(u.id,d)}o.removeNode(u)}}return this._getServiceInstanceOrDescriptor(e)}_createServiceInstanceWithOwner(e,r,n=[],o,s){if(this._services.get(e)instanceof Ue)return this._createServiceInstance(e,r,n,o,s,this._servicesToMaybeDispose);if(this._parent)return this._parent._createServiceInstanceWithOwner(e,r,n,o,s);throw new Error(`illegalState - creating UNKNOWN service instance ${r.name}`)}_createServiceInstance(e,r,n=[],o,s,a){if(o){let c=new t(void 0,this._strict,this,this._enableTracing);c._globalGraphImplicitDependency=String(e);let u=new Map,l=new gP(()=>{let d=c._createInstance(r,n,s);for(let[p,f]of u){let m=d[p];if(typeof m=="function")for(let h of f)h.disposable=m.apply(d,h.listener)}return u.clear(),a.add(d),d});return new Proxy(Object.create(null),{get(d,p){if(!l.isInitialized&&typeof p=="string"&&(p.startsWith("onDid")||p.startsWith("onWill"))){let h=u.get(p);return h||(h=new oE,u.set(p,h)),(v,y,_)=>{if(l.isInitialized)return l.value[p](v,y,_);{let b={listener:[v,y,_],disposable:void 0},S=h.push(b);return Ta(()=>{S(),b.disposable?.dispose()})}}}if(p in d)return d[p];let f=l.value,m=f[p];return typeof m!="function"||(m=m.bind(f),d[p]=m),m},set(d,p,f){return l.value[p]=f,!0},getPrototypeOf(d){return r.prototype}})}else{let c=this._createInstance(r,n,s);return a.add(c),c}}_throwIfStrict(e,r){if(r&&console.warn(e),this._strict)throw new Error(e)}};var gE=class t{constructor(e,r){this.type=e;this.name=r;this._start=Date.now();this._dep=[]}static{this.all=new Set}static{this._None=new class extends t{constructor(){super(0,null)}stop(){}branch(){return this}}}static traceInvocation(e,r){return e?new t(2,r.name||new Error().stack.split(`
`).slice(3,4).join(`
`)):t._None}static traceCreation(e,r){return e?new t(1,r.name):t._None}static{this._totals=0}branch(e,r){let n=new t(3,e.toString());return this._dep.push([e,r,n]),n}stop(){let e=Date.now()-this._start;t._totals+=e;let r=!1;function n(s,a){let c=[],u=new Array(s+1).join("	");for(let[l,d,p]of a._dep)if(d&&p){r=!0,c.push(`${u}CREATES -> ${l}`);let f=n(s+1,p);f&&c.push(f)}else c.push(`${u}uses -> ${l}`);return c.join(`
`)}let o=[`${this.type===1?"CREATE":"CALL"} ${this.name}`,`${n(1,this)}`,`DONE, took ${e.toFixed(2)}ms (grand total ${t._totals.toFixed(2)}ms)`];(e>2||r)&&t.all.add(o.join(`
`))}};var rt=se("IServicesAccessor"),bP=class{constructor(e,r){this._isSealed=!1;let n=Array.isArray(e)?new p0(...e):e??new p0;n.set(rt,this);let o=r?r._pair.insta.createChild(n):new yP(n,!0);this._pair={services:n,insta:o}}dispose(){this._pair.insta.dispose()}get(e){return this._pair.insta.invokeFunction(r=>r.get(e))}safeGet(e){try{return this.get(e)}catch{return}}define(e,r){if(this._isSealed)throw new Error("This accessor is sealed and cannot be modified anymore.");this._pair.services.set(e,r)}defineIfNotDefined(e,r){this.safeGet(e)===void 0&&this.define(e,r())}seal(){this._isSealed=!0}toString(){return""}};var f0=["user:email"],oU=["read:user"],m0=["read:user","user:email","repo","workflow"],Lp=class{constructor(e){this._info=e;this.tokenMap=this.parseToken(e.token)}parseToken(e){let r=new Map,o=e?.split(":")[0]?.split(";");for(let s of o){let[a,c]=s.split("=");r.set(a,c)}return r}get token(){return this._info.token}get sku(){return this._info.sku}get organizationList(){return this._info.organization_list||[]}get enterpriseList(){return this._info.enterprise_list||[]}get endpoints(){return this._info.endpoints||{api:"https://api.githubcopilot.com",telemetry:"https://copilot-telemetry.githubusercontent.com"}}get isInternal(){let e=["4535c7beffc844b46bb1ed4aa04d759a","a5db0bcaae94032fe715fb34a5e4bce2","7184f66dfcee98cb5f08a1cb936d5225","1cb18ac6eedd49b43d74a1c5beb0b955"];for(let r of this.organizationList)if(e.includes(r))return!0;return!1}isTelemetryEnabled(){return this._isTelemetryEnabled===void 0&&(this._isTelemetryEnabled=this._info.telemetry==="enabled"),this._isTelemetryEnabled}isPublicSuggestionsEnabled(){return this._isPublicSuggestionsEnabled===void 0&&(this._isPublicSuggestionsEnabled=this._info.public_suggestions==="enabled"),this._isPublicSuggestionsEnabled}isChatEnabled(){return this._info.chat_enabled??!1}isCopilotIgnoreEnabled(){return this._info.copilotignore_enabled??!1}getTokenValue(e){return this.tokenMap.get(e)}},Nn=se("ICopilotTokenManager");var Vi=se("ICopilotTokenNotifier"),_P=class{constructor(){this._onCopilotToken=new Ht;this.onCopilotToken=this._onCopilotToken.event}dispose(){this._onCopilotToken.dispose()}emit(e,r){this._onCopilotToken.fire({token:e,envelope:r})}};var OP=W(require("fs"));var Ra=require("../package.json"),xP=Ra.buildType!=="dev",lc=Ra.isPreRelease||!xP,Cdt=Ra.engines.vscode;var Bm="github.copilot",be=se("IConfigurationService"),IP=class{getConfigMixedWithDefaults(e){let r=this.getConfig(e);return r===void 0?e.defaultValue:K7(r)&&K7(e.defaultValue)?{...e.defaultValue,...r}:r}};var SP;function zNe(){if(!SP){SP=new Map;let t=Ra.contributes.configuration.properties;for(let e of Object.keys(t))typeof t[e].default<"u"&&SP.set(e,t[e].default)}return SP}function Yre(t,e){let r=zNe().get(`${Bm}.${t}`);if(typeof r<"u"&&e!==r)throw new Error(`The default value for setting ${t} is different in package.json and in code`);let n=t.indexOf("."),o=t.substring(0,n);if(o!=="editor"&&o!=="chat"&&o!=="advanced"&&o!=="notebook"&&o!=="renameSuggestions")throw new Error(`Unexpected setting section ${o} in setting ${t}`);let s=t.substring(n+1);return{id:t,firstPart:o,secondPart:s,defaultValue:e}}function Mt(t,e){return{...Yre(t,e),configType:0}}function zl(t,e){return{...Yre(t,e),configType:1}}var ge={EnableCodeActions:Mt("editor.enableCodeActions",!0),LocaleOverride:Mt("chat.localeOverride","auto"),WelcomeMessage:Mt("chat.welcomeMessage","first"),TerminalChatLocation:Mt("chat.terminalChatLocation","chatView"),AuthProvider:Mt("advanced.authProvider","github"),NotebookIterativeImproving:Mt("notebook.iterativeImproving",!1),AutomaticRenameSuggestions:Mt("renameSuggestions.triggerAutomatically",!0),DebugOverrideCAPIUrl:Mt("advanced.debug.overrideCAPIUrl","https://api.githubcopilot.com"),DebugOverrideChatEngine:Mt("advanced.debug.overrideChatEngine",void 0),DebugOverrideEmbeddingsModel:Mt("advanced.debug.overrideEmbeddingsModel",void 0),DebugOverrideChatMaxTokenNum:Mt("advanced.debug.overrideChatMaxTokenNum",0),DebugOverrideChatOffTopicModel:Mt("advanced.debug.overrideChatOffTopicModel",""),DebugOverrideChatOffTopicModelTokenizer:Mt("advanced.debug.overrideChatOffTopicModelTokenizer",""),DebugOverrideChatOffTopicModelThreshold:Mt("advanced.debug.overrideChatOffTopicModelThreshold",0),DebugOverrideLogLevels:Mt("advanced.debug.overrideLogLevels",{}),DebugFilterLogCategories:Mt("advanced.debug.filterLogCategories",[]),DebugReportFeedback:Mt("advanced.debug.reportFeedback",!1),DebugUseNodeFetcher:Mt("advanced.debug.useNodeFetcher",!1),DebugUseElectronFetcher:Mt("advanced.debug.useElectronFetcher",!1),ConversationSlashCommandEnablements:Mt("advanced.slashCommands",{"*":!1}),ConversationVariablesEnablements:Mt("advanced.variables",{"*":lc}),ConversationAdditionalPromptContext:Mt("advanced.conversationAdditionalPromptContext","firstTurn"),ConversationLoggingEnabled:Mt("advanced.conversationLoggingEnabled",!1),NotebookLoggingEnabled:Mt("chat.notebookLogEnabled",!1),ConversationIntentDetection:Mt("advanced.conversationIntentDetection",!1),IntentDetectionWithFunctionCalling:zl("advanced.intentDetectionWithFunctionCalling",!1),ConversationPromptEval:zl("advanced.promptEval",!1),ConversationPromptEvalRequestContext:zl("advanced.promptEval.requestContext",0),KerberosServicePrincipal:Mt("advanced.kerberosServicePrincipal",void 0),ExplainIntentRefer:Mt("advanced.explain.refer",!0),FixInlineChatEndpoint:zl("advanced.fix.inlineChatEndpoint",void 0),FixUseWorkspaceChunksFromSelection:zl("advanced.fix.useWorkspaceChunksFromSelection",!1),FixUseWorkspaceChunksFromDiagnostics:zl("advanced.fix.useWorkspaceChunksFromDiagnostics",!1),CodeMapperChatEndpoint:zl("advanced.codeMapper.chatEndpoint",void 0),GPT4TurboExperimentEnabled:Mt("advanced.gpt4TurboExperimentEnabled",!1),ProjectLabelsExpanded:zl("advanced.projectLabels.expanded",!1),ProjectLabelsChat:zl("advanced.projectLabels.chat",!1),ProjectLabelsInline:zl("advanced.projectLabels.inline",!1),WorkspaceNewFlowEnabled:Mt("advanced.workspace.useNewFlow",!0),WorkspaceCodeSearchEnabled:Mt("advanced.workspace.codeSearchEnabled",void 0),WorkspaceUseAdaEnabled:Mt("advanced.workspace.useAda",void 0),WorkspaceRerankStrategy:Mt("advanced.workspace.rerankStrategy",void 0),WorkspaceCodeSearchReturnRawChunks:Mt("advanced.workspace.codeSearchReturnRawChunks",void 0),WorkspaceUseFilesVariable:Mt("advanced.workspace.useFilesVariable",!1),UseProjectTemplates:Mt("chat.useProjectTemplates",!0),ExplainScopeSelection:Mt("chat.scopeSelection",!1),UseMessageNames:Mt("advanced.useMessageNames",!0),FeedbackOnChange:Mt("advanced.feedback.onChange",!1),ReviewContextMenu:Mt("advanced.review.contextMenu",lc),ReviewSCMViewlet:Mt("advanced.review.scmViewlet",lc),ReviewIntent:Mt("advanced.review.intent",!1),NotebookPrioritiesExperimentEnabled:Mt("advanced.notebook.prioritiesExperimentEnabled",!1),NotebookPackagesExperimentEnabled:Mt("advanced.notebook.packagesExperimentEnabled",!1),NotebookAdditionalCodeGenerationRuleEnabled:Mt("advanced.notebook.additionalCodeGenerationRule",!1),NotebookSummaryExperimentEnabled:Mt("advanced.notebook.summaryExperimentEnabled",!1),RunCommandEnabled:Mt("advanced.runCommandEnabled",!1)};var Ln=se("IDomainService");var vE=class{constructor(e,r){this.name=e;this.version=r}format(){return`${this.name}/${this.version}`}},Pt=se("IEnvService");var mt=(n=>(n[n.InlineChat=1]="InlineChat",n[n.PanelChat=2]="PanelChat",n[n.Other=3]="Other",n))(mt||{});(e=>{function t(r){switch(r){case 1:return"conversationInline";case 2:return"conversationPanel";default:return"none"}}e.toString=t})(mt||={});var qm=se("INotebookLogService");var ce=se("ILogService"),Op=class{constructor(e,r,n){this.logTargets=e;this.configurationService=r;this.notebookLogService=n;this.loggers=new Map;this.promptResponseLoggers=new Map;this.myLogTarget={logIt:(o,s,...a)=>{this.logTargets.forEach(c=>c.logIt(o,s,...a))}}}get defaultLogger(){return this.getLogger("extension")}getLogger(e){return Op._getLogger(e,this.loggers,r=>new EP(r,this.myLogTarget,this.configurationService))}getPromptResponseLogger(e){return Op._getLogger(e,this.promptResponseLoggers,r=>new sU(r,this.myLogTarget,this.configurationService))}getPromptResponseLogger2(){return this.notebookLogService}registerAppender(e){return this.logTargets.push(e),Ta(()=>{let r=this.logTargets.indexOf(e);r!==-1&&this.logTargets.splice(r,1)})}static _getLogger(e,r,n){let o=r.get(e);return typeof o>"u"&&(o=n(e),r.set(e,o)),o}};Op=B([T(1,be),T(2,qm)],Op);var yE=(o=>(o[o.DEBUG=0]="DEBUG",o[o.INFO=1]="INFO",o[o.WARN=2]="WARN",o[o.ERROR=3]="ERROR",o))(yE||{}),CP=class{logIt(e,r,...n){e===3?console.error(r,...n):e===2&&console.warn(r,...n)}},TP=class{constructor(e){this.output=e}logIt(e,r,...n){this.output.appendLine(`${r} ${n.map(GNe).join(", ")}`)}},EP=class{constructor(e,r,n){this.category=e;this.target=r;this.configurationService=n}stringToLevel(e){return yE[e]}log(e,...r){if(!this.shouldLog(e,this.category))return;let n=`[${this.category}]`;this.target.logIt(e,n,...r)}shouldLog(e,r){let n=this.configurationService.getConfig(ge.DebugFilterLogCategories);if(n.length>0&&!n.includes(r))return!1;let o=this.configurationService.getConfig(ge.DebugOverrideLogLevels),s=this.stringToLevel(o[this.category])??this.stringToLevel(o["*"])??1;return e>=s}debug(...e){this.log(0,...e)}info(...e){this.log(1,...e)}warn(...e){this.log(2,...e)}error(...e){this.log(3,...e)}exception(e,r){let n=r?`${r}: `:"",o=e instanceof Error?e:new Error("Non-error thrown: "+e);this.log(3,`${n}${o.stack}`)}},sU=class extends EP{logPrompt(e){if(!this.conversationLoggingEnabled())return;let r=`
---------------------------------
`;super.info(r+e.map(n=>`${n.role.toUpperCase()}:
${n.content}`).join(r)+r)}logResponse(e){if(!this.conversationLoggingEnabled())return;let r=`
---------------------------------
`;if(typeof e!="string"){if(e.type!=="success"){super.info(`${r}RESPONSE FAILED DUE TO ${e.type}${r}`);return}Array.isArray(e.value)?e.value.length===1?e=e.value[0]:e=`${e.value.map(n=>`<<${n}>>`).join(", ")}`:e=e.value}super.info(`${r}ASSISTANT:
${e}${r}`)}debug(e,...r){this.conversationLoggingEnabled()&&super.debug(e,...r)}info(e,...r){this.conversationLoggingEnabled()&&super.info(e,...r)}warn(e,...r){this.conversationLoggingEnabled()&&super.warn(e,...r)}error(e,...r){this.conversationLoggingEnabled()&&super.error(e,...r)}conversationLoggingEnabled(){return this.configurationService.getConfig(ge.ConversationLoggingEnabled)}};function GNe(t){switch(typeof t){case"object":return t instanceof Error&&(t.stack||t.message)||JSON.stringify(t);default:return String(t)}}var Ur=se("IFetcherService"),Hm=class{constructor(e,r,n,o,s,a){this.status=e;this.statusText=r;this.headers=n;this.getText=o;this.getJson=s;this.getBody=a;this.ok=this.status>=200&&this.status<300}async text(){return this.getText()}async json(){return this.getJson()}async body(){return this.getBody()}};var tt=W(require("vscode")),Xr=tt.Position,ze=tt.Range,jm=tt.Selection,Qre=tt.EventEmitter,Xre=tt.CancellationTokenSource;var On=tt.TextEdit,zm=tt.WorkspaceEdit,pn=tt.Uri,Bc=tt.MarkdownString;var R_=tt.DiagnosticSeverity,qc=tt.ExtensionMode,yi=tt.Location;var Pi=tt.ChatResponseMarkdownPart;var Gm=tt.ChatResponseFileTreePart,wP=tt.ChatResponseAnchorPart,Wi=tt.ChatResponseProgressPart,Jre=tt.ChatResponseProgressPart2,k_=tt.ChatResponseReferencePart,h0=tt.ChatResponseCommandButtonPart,RP=tt.ChatResponseWarningPart,kP=tt.ChatResponseMarkdownWithVulnerabilitiesPart,Mp=tt.ChatResponseTextEditPart,AP=tt.ChatResponseConfirmationPart,bE=tt.ChatResponseDetectedParticipantPart,Zre=tt.ChatRequestTurn;var ene=tt.NewSymbolName,tne=tt.NewSymbolNameTag,_E=tt.NewSymbolNameTriggerKind;var Ki={t:tt.l10n.t};var A_=se("IUrlOpener"),PP=class{constructor(){this.openedUrls=[]}open(e){this.openedUrls.push(e)}};var DP=se("INotificationSender");var VNe=["UNABLE_TO_VERIFY_LEAF_SIGNATURE","CERT_SIGNATURE_FAILURE"],Vm=se("IUserErrorNotifier"),P_=class{constructor(e,r,n){this.logService=e;this.notificationSender=r;this.urlOpener=n;this.notifiedErrorCodes=[]}async notifyUser(e){VNe.includes(e.code)&&!this.didNotifyBefore(e.code)&&(this.displayCertificateErrorNotification(e),this.notifiedErrorCodes.push(e.code))}displayCertificateErrorNotification(e){let r="https://aka.ms/copilot-ssc",n=Ki.t("Your current Copilot license doesn't support proxy connections with self-signed certificates.");this.logService.getLogger("certificates").error(`${n} Please visit ${r} to learn more. Original cause: ${JSON.stringify(e)}`),this.showCertificateWarningMessage(n,r)}showCertificateWarningMessage(e,r){let n={title:Ki.t("Learn more")};this.notificationSender.showWarningMessage(e,n).then(o=>{o?.title===n.title&&this.urlOpener.open(r)})}didNotifyBefore(e){return this.notifiedErrorCodes.indexOf(e)!==-1}};P_=B([T(0,ce),T(1,DP),T(2,A_)],P_);var $m=se("ICopilotTokenStore"),NP=class extends St{constructor(){super(...arguments);this._onDidStoreUpdate=this._register(new Ht);this.onDidStoreUpdate=this._onDidStoreUpdate.event}get copilotToken(){return this._copilotToken}set copilotToken(r){this._copilotToken=r,this._onDidStoreUpdate.fire()}};var LP=se("ITelemetryUserConfig"),D_=class{constructor(e,r,n){this._tokenStore=e;this.trackingId=r,this.optedIn=n??!1,this.setupUpdateOnToken()}setupUpdateOnToken(){this._tokenStore.onDidStoreUpdate(()=>{let e=this._tokenStore.copilotToken;if(!e)return;let r=e.getTokenValue("rt")==="1",n=e.getTokenValue("tid");n!==void 0&&(this.trackingId=n,this.organizationsList=e.organizationList.toString(),this.optedIn=r)})}};D_=B([T(0,$m)],D_);var me=se("ITelemetryService");var Br=function(){if(typeof crypto=="object"&&typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);let t;typeof crypto=="object"&&typeof crypto.getRandomValues=="function"?t=crypto.getRandomValues.bind(crypto):t=function(n){for(let o=0;o<n.length;o++)n[o]=Math.floor(Math.random()*256);return n};let e=new Uint8Array(16),r=[];for(let n=0;n<256;n++)r.push(n.toString(16).padStart(2,"0"));return function(){t(e),e[6]=e[6]&15|64,e[8]=e[8]&63|128;let o=0,s="";return s+=r[e[o++]],s+=r[e[o++]],s+=r[e[o++]],s+=r[e[o++]],s+="-",s+=r[e[o++]],s+=r[e[o++]],s+="-",s+=r[e[o++]],s+=r[e[o++]],s+="-",s+=r[e[o++]],s+=r[e[o++]],s+="-",s+=r[e[o++]],s+=r[e[o++]],s+=r[e[o++]],s+=r[e[o++]],s+=r[e[o++]],s+=r[e[o++]],s}}();var Vn=class t{static{this.keysExemptedFromSanitization=["VSCode.ABExp.Features","abexp.assignmentcontext"]}constructor(e,r,n){this.properties=e,this.measurements=r,this.issuedTime=n}static createAndMarkAsIssued(e,r){return new t(e||{},r||{},Date.now())}extendedBy(e,r){let n={...this.properties,...e},o={...this.measurements,...r},s=new t(n,o,this.issuedTime);return s.displayedTime=this.displayedTime,s}markAsDisplayed(){this.displayedTime===void 0&&(this.displayedTime=Date.now())}extendWithEditorAgnosticFields(e){this.properties.editor_version=e.getEditorInfo().format(),this.properties.editor_plugin_version=e.getEditorPluginInfo().format(),this.properties.client_machineid=e.machineId,this.properties.client_sessionid=e.sessionId,this.properties.copilot_version=`copilot/${e.getVersion()}`,this.properties.common_extname=e.getEditorPluginInfo().name,this.properties.common_extversion=e.getEditorPluginInfo().version,this.properties.common_vscodeversion=e.getEditorInfo().format()}extendWithConfigProperties(e,r,n){let o=e.dumpConfig();o["copilot.build"]=r.getBuild(),o["copilot.buildType"]=r.getBuildType(),n.trackingId&&(o["copilot.trackingId"]=n.trackingId),n.organizationsList&&(o.organizations_list=n.organizationsList),this.properties={...this.properties,...o}}extendWithRequestId(e){let r={completionId:e.completionId,created:e.created.toString(),headerRequestId:e.headerRequestId,serverExperiments:e.serverExperiments,deploymentId:e.deploymentId};this.properties={...this.properties,...r}}static{this.keysToRemoveFromStandardTelemetryHack=["gitRepoHost","gitRepoName","gitRepoOwner","gitRepoUrl","gitRepoPath","repo","request_option_nwo","userKind"]}static maybeRemoveRepoInfoFromPropertiesHack(e,r){if(e)return r;let n={};for(let o in r)t.keysToRemoveFromStandardTelemetryHack.includes(o)||(n[o]=r[o]);return n}sanitizeKeys(){this.properties=t.sanitizeKeys(this.properties),this.measurements=t.sanitizeKeys(this.measurements)}static sanitizeKeys(e){e=e||{};let r={};for(let n in e){let o=t.keysExemptedFromSanitization.includes(n)?n:n.replace(/\./g,"_");r[o]=e[n]}return r}updateTimeSinceIssuedAndDisplayed(){let e=Date.now()-this.issuedTime;if(this.measurements.timeSinceIssuedMs=e,this.displayedTime!==void 0){let r=Date.now()-this.displayedTime;this.measurements.timeSinceDisplayedMs=r}}makeReadyForSending(e,r,n){this.extendWithConfigProperties(e,r,n),this.extendWithEditorAgnosticFields(r),this.sanitizeKeys(),this.updateTimeSinceIssuedAndDisplayed();for(let o in this.properties)this.properties[o]===void 0&&delete this.properties[o];$Ne(r,this.properties)}};function rne(t){if(!t)return;let e={};for(let r in t){let n=t[r];n&&(n.value?e[r]=n.value:e[r]=n)}return e}function $Ne(t,e){e.unique_id=Br(),e.common_extname=t.getEditorPluginInfo().name,e.common_extversion=t.getEditorPluginInfo().version,e.common_vscodeversion=t.getEditorInfo().format()}var L_=class{constructor(){this._copilotTokenRefreshEmitter=new Ht;this.onDidCopilotTokenRefresh=this._copilotTokenRefreshEmitter.event;this._githubTokenChangedEmitter=new Ht;this.onDidGitHubTokenChanged=this._githubTokenChangedEmitter.event}static{this._refreshRunningCountByTokenManager=new WeakMap}},xE=class extends L_{async fetchCopilotToken(e){let r=this.domainService.tokenURL;try{return await this.fetcherService.fetch(r,{headers:{Authorization:`token ${e}`,...this.envService.getEditorVersionHeaders()}})}catch(n){throw this.userErrorNotifier.notifyUser(n),n}}async authFromGitHubToken(e){let r=nne(this.logService);this.telemetryService.sendGHTelemetryEvent("auth.new_login");let n=await this.fetchCopilotToken(e);if(!n)return r.info("Failed to get copilot token"),this.telemetryService.sendGHTelemetryErrorEvent("auth.request_failed"),{kind:"failure",reason:"FailedToGetToken"};let o=await n.json();if(!o)return r.info("Failed to get copilot token"),this.telemetryService.sendGHTelemetryErrorEvent("auth.request_read_failed"),{kind:"failure",reason:"FailedToGetToken"};if(n.status===401)return r.info("Failed to get copilot token due to 401 status"),this.telemetryService.sendGHTelemetryErrorEvent("auth.unknown_401"),{kind:"failure",reason:"HTTP401"};if(!n.ok||!o.token){r.info(`Invalid copilot token: missing token: ${n.status} ${n.statusText}`);let u=Vn.createAndMarkAsIssued({status:n.status.toString(),status_text:n.statusText});return this.telemetryService.sendGHTelemetryErrorEvent("auth.invalid_token",u.properties,u.measurements),{kind:"failure",reason:"NotAuthorized",...o.error_details}}let s=o.expires_at;o.expires_at=Wm()+o.refresh_in+WNe;let a=new Lp(o);this.copilotTokenNotifier.emit(a,o);let c=Vn.createAndMarkAsIssued({},{adjusted_expires_at:o.expires_at,expires_at:s,current_time:Wm()});return this.telemetryService.sendGHTelemetryEvent("auth.new_token",c.properties,c.measurements),{kind:"success",...o}}async _refreshToken(e){let r=Wm(),n=L_._refreshRunningCountByTokenManager.get(this)??L_._refreshRunningCountByTokenManager.set(this,{value:0}).get(this);n.value>0||(n.value++,setTimeout(async()=>{let o,s="";try{n.value--,await this.getCopilotToken(!0),o="success",this._copilotTokenRefreshEmitter.fire()}catch(c){o="failure",s=c.toString()}let a=Vn.createAndMarkAsIssued({result:o},{time_taken:Wm()-r,refresh_count:n.value});s&&(a.properties.reason=s),this.telemetryService.sendGHTelemetryEvent("auth.token_refresh",a.properties,a.measurements)},e*1e3))}};function nne(t){return t.getLogger("auth")}var WNe=60;function Wm(){return Math.floor(Date.now()/1e3)}var SE=class extends L_{constructor(r,n){super();this.completionsToken=r;this.embeddingsToken=n;this.wasReset=!1}getAnyGitHubSession(){return Promise.resolve({id:this.completionsToken,accessToken:this.completionsToken,scopes:f0,account:{id:"user",label:"User"}})}getPermissiveGitHubSession(){return Promise.resolve({id:this.completionsToken,accessToken:this.completionsToken,scopes:m0,account:{id:"user",label:"User"}})}async getCopilotToken(){return new Lp({token:this.completionsToken,expires_at:0,refresh_in:0})}async getEmbeddingsToken(r){return new Lp({token:this.embeddingsToken??this.completionsToken,expires_at:0,refresh_in:0})}resetCopilotToken(r){this.wasReset=!0}async checkCopilotToken(){return{status:"OK"}}async _refreshToken(r){}},N_=class extends xE{constructor(r,n,o,s,a,c,u,l,d){super();this.githubToken=r;this.configurationService=n;this.logService=o;this.telemetryService=s;this.copilotTokenNotifier=a;this.domainService=c;this.fetcherService=u;this.envService=l;this.userErrorNotifier=d;this.copilotToken=void 0}getAnyGitHubSession(){return Promise.resolve({id:this.githubToken,accessToken:this.githubToken,scopes:f0,account:{id:"user",label:"User"}})}getPermissiveGitHubSession(){return Promise.resolve({id:this.githubToken,accessToken:this.githubToken,scopes:m0,account:{id:"user",label:"User"}})}async getCopilotToken(r){if(!this.copilotToken||this.copilotToken.expires_at<Wm()||r){let n=await this.authFromGitHubToken(this.githubToken);if(n.kind==="failure")throw Error(`Failed to get copilot token: ${n.reason.toString()} ${n.message??""}`);this.copilotToken={...n},this._refreshToken(n.refresh_in)}return new Lp(this.copilotToken)}async checkCopilotToken(){if(!this.copilotToken||this.copilotToken.expires_at<Wm()){let n=await this.authFromGitHubToken(this.githubToken);if(n.kind==="failure")return n;this.copilotToken={...n},this._refreshToken(n.refresh_in)}return{status:"OK"}}resetCopilotToken(r){r!==void 0&&this.telemetryService.sendGHTelemetryEvent("auth.reset_token_"+r),nne(this.logService).debug(`Resetting copilot token on HTTP error ${r||"unknown"}`),this.copilotToken=void 0}};N_=B([T(1,be),T(2,ce),T(3,me),T(4,Vi),T(5,Ln),T(6,Ur),T(7,Pt),T(8,Vm)],N_);var cU=`${process.env.HOME||process.env.USERPROFILE}/.copilot-testing-gh-token`,aU;function ine(t,e,r,n,o,s,a,c){return aU||(aU=KNe(t,e,r,n,o,s,a,c)),aU}var KNe=(t,e,r,n,o,s,a,c)=>{if(process.env.GITHUB_PAT)return new SE(process.env.GITHUB_PAT);if(process.env.GITHUB_OAUTH_TOKEN)return new N_(process.env.GITHUB_OAUTH_TOKEN,t,e,r,n,o,s,a,c);let u=YNe();if(u)return new N_(u.trim(),t,e,r,n,o,s,a,c);throw new Error(`Tests: either GITHUB_PAT must be set, or there must be a GitHub token from an app with access to Copilot in ${cU}. Run "npm run get_token" to get one.`)};function YNe(){if(OP.existsSync(cU))return OP.readFileSync(cU).toString()}var Km=require("vscode");var is=require("vscode");var sne="You are not signed in to GitHub. Please sign in to use Copilot.";function MP(t){return t.getConfig(ge.AuthProvider)==="github-enterprise"?"github-enterprise":"github"}async function ane(t,e){if(!t.length)return;if(t.length===1)return t[0];let r=new Set(t.map(s=>s.account.label));if(r.size===1)return t[0];let n=is.workspace.getConfiguration();if(e?.forceNewSession)return await n.update("github.copilot.preferredAccount",t[0].account.label,is.ConfigurationTarget.Global),t[0];let o=n.get("github.copilot.preferredAccount");if(o)return t.find(s=>s.account.label===o);if(e?.createIfNone){let s=await is.window.showQuickPick([...r.values()],{placeHolder:is.l10n.t("Choose the account you would like to use with GitHub Copilot")});if(s)return await n.update("github.copilot.preferredAccount",s,is.ConfigurationTarget.Global),t.find(a=>a.account.label===s)}}async function Fp(t,e){let r=MP(t),n=[is.authentication.getSession(r,m0,{silent:!0}),is.authentication.getSession(r,oU,{silent:!0})];e?.forceNewSession?n.unshift(is.authentication.getSession(r,f0,e)):n.push(is.authentication.getSession(r,f0,e));let o=(await Promise.all(n)).filter(s=>!!s);return await ane(o,e)}async function cne(t,e){let r=MP(t),n=await Promise.all([is.authentication.getSession(r,m0,e),is.authentication.getSession(r,oU,{silent:!0}),is.authentication.getSession(r,f0,{silent:!0})]);if(!n[0])return;let o=n.filter(a=>!!a),s=await ane(o,e);return s?.scopes.length===m0.length?s:void 0}var une=!1,IE=class extends Error{},CE=class extends Error{},TE=class extends Error{},EE=class extends Error{},O_=class extends xE{constructor(r,n,o,s,a,c,u,l){super();this.configurationService=r;this.logService=n;this.telemetryService=o;this.domainService=s;this.copilotTokenNotifier=a;this.fetcherService=c;this.envService=u;this.userErrorNotifier=l;this._cachedAnySession=null;this._cachedPermissiveSession=null;this.copilotToken=void 0,this._disposable=Km.Disposable.from(Km.authentication.onDidChangeSessions(d=>{d.provider.id===MP(r)&&this._handleAuthChangeEvent()}),this.domainService.onDidChangeDomains(d=>{d.dotcomUrlChanged&&this.resetCopilotToken()}),Km.workspace.onDidChangeConfiguration(async d=>{(d.affectsConfiguration("github.copilot.preferredAccount")||d.affectsConfiguration("github.copilot.advanced"))&&this._handleAuthChangeEvent()}))}dispose(){this._disposable.dispose()}async getAnyGitHubSession(r){return this._cachedAnySession!==null&&!this.isInteractiveRequest(r)?this._cachedAnySession:(this._cachedAnySession=await Fp(this.configurationService,r),this._cachedAnySession)}async getPermissiveGitHubSession(r){return this._cachedPermissiveSession!==null&&!this.isInteractiveRequest(r)?this._cachedPermissiveSession:(this._cachedPermissiveSession=await cne(this.configurationService,r),this._cachedPermissiveSession)}async getCopilotToken(r){return(!this.copilotToken||this.copilotToken.expires_at<Wm()||r)&&(this.copilotToken=await this.authShowWarnings(),this._refreshToken(this.copilotToken.refresh_in)),new Lp(this.copilotToken)}resetCopilotToken(r){r!==void 0&&this.telemetryService.sendGHTelemetryEvent("auth.reset_token_"+r),this.logService.getLogger("auth").debug(`Resetting copilot token on HTTP error ${r||"unknown"}`),this.copilotToken=void 0}async _handleAuthChangeEvent(){this._cachedAnySession=null,this._cachedPermissiveSession=null;try{await this._resetOrRefreshCopilotToken()}catch{}this._githubTokenChangedEmitter.fire()}async _resetOrRefreshCopilotToken(){if(!await this.getAnyGitHubSession()){this.resetCopilotToken();return}await this.getCopilotToken(!0)}isInteractiveRequest(r){return r?.createIfNone||r?.forceNewSession}async auth(){let r=this.logService.getLogger("auth"),n=await Fp(this.configurationService,{silent:!0});if(!n)return r.info("GitHub login failed"),this.telemetryService.sendGHTelemetryErrorEvent("auth.github_login_failed"),{kind:"failure",reason:"GitHubLoginFailed"};r.info(`Logged in as ${n.account.label}`);let o=await this.authFromGitHubToken(n.accessToken);return o.kind==="success"&&r.info(`Got Copilot token for ${n.account.label}`),o}async authShowWarnings(){let r=await this.auth();if(r.kind==="failure"&&r.reason==="NotAuthorized"){let n=r.message;if(n?.includes("No access to GitHub Copilot found"))throw new IE(n??"User not authorized");if(n?.includes("Your subscription has ended"))throw new CE(n);if(n?.includes("Contact Support."))throw new TE(n)}if(r.kind==="failure"){let n=r.message;if(n?.includes("Please contact your enterprise admin to enable your managed account for Copilot for Business"))throw new EE(n)}if(r.kind==="failure"&&r.reason==="HTTP401"){let n="Your GitHub token is invalid. Please sign out from your GitHub account using the VS Code accounts menu and try again.";throw une||(une=!0,Km.window.showWarningMessage(n)),Error(n)}if(r.kind==="failure"&&r.reason==="GitHubLoginFailed")throw Error("GitHubLoginFailed");if(r.kind==="failure")throw Error("Failed to get copilot token");return r}};O_=B([T(0,be),T(1,ce),T(2,me),T(3,Ln),T(4,Vi),T(5,Ur),T(6,Pt),T(7,Vm)],O_);var fn=se("IAuthenticationService"),M_=class extends St{constructor(r,n,o){super();this._tokenStore=r;this._tokenManager=n;this._onDidAuthenticationChange=this._register(new Ht);this.onDidAuthenticationChange=this._onDidAuthenticationChange.event;this._register(Vu.any(n.onDidGitHubTokenChanged,o.onCopilotToken)(()=>this._handleAuthChangeEvent())),this._handleAuthChangeEvent()}get anyGitHubSession(){return this._anyGitHubSession}async getAnyGitHubSession(r){let n=await this._tokenManager.getAnyGitHubSession(r);return this._anyGitHubSession=n,n}get permissiveGitHubSession(){return this._permissiveGitHubSession}async getPermissiveGitHubSession(r){let n=await this._tokenManager.getPermissiveGitHubSession(r);return this._permissiveGitHubSession=n,n}get copilotToken(){return this._tokenStore.copilotToken}async getCopilotToken(r){try{let n=await this._tokenManager.getCopilotToken(r);return this._tokenStore.copilotToken=n,this._copilotTokenError=void 0,n}catch(n){throw this._tokenStore.copilotToken=void 0,this._copilotTokenError=n,n}}resetCopilotToken(r){this._tokenStore.copilotToken=void 0,this._tokenManager.resetCopilotToken(r),this._onDidAuthenticationChange.fire()}async _handleAuthChangeEvent(){let r=this._anyGitHubSession,n=this._permissiveGitHubSession,o=this._tokenStore.copilotToken,s=this._copilotTokenError;await Promise.allSettled([this.getAnyGitHubSession({silent:!0}),this.getPermissiveGitHubSession({silent:!0}),this.getCopilotToken()]),(r?.accessToken!==this._anyGitHubSession?.accessToken||n?.accessToken!==this._permissiveGitHubSession?.accessToken||o?.token!==this._tokenStore.copilotToken?.token||s?.message!==this._copilotTokenError?.message)&&this._onDidAuthenticationChange.fire()}};M_=B([T(0,$m),T(1,Nn),T(2,Vi)],M_);var UP=se("IBlockedExtensionService"),FP=class{constructor(){this.blockedExtensions=new Map}reportBlockedExtension(e,r){this.blockedExtensions.has(e)&&clearTimeout(this.blockedExtensions.get(e));let n=setTimeout(()=>{this.blockedExtensions.delete(e)},r*1e3);this.blockedExtensions.set(e,n)}isExtensionBlocked(e){return this.blockedExtensions.has(e)}};var BP=se("IChatAgentService"),uU="default",wE="editor",Up="workspace",RE="vscode",g0="terminal",lne=[uU,wE,Up,RE,g0];function F_(t){return`github.copilot.${t}`}function dne(t){return t.replace(/^github\.copilot\./,"")}var jt=se("IChatMLFetcher"),U_=class{constructor(){this._stream=new l0;this._seenAnnotationTypes=new Set}get stream(){return this._stream.asyncIterable}update(e,r){r.codeVulnAnnotations&&(!((e.match(/(^|\n)```/g)?.length??0)%2===1)||e.match(/(^|\n)```\w*\s*$/))&&(r.codeVulnAnnotations=void 0),r.codeVulnAnnotations&&(r.codeVulnAnnotations=r.codeVulnAnnotations.filter(n=>!this._seenAnnotationTypes.has(n.details.type)),r.codeVulnAnnotations.forEach(n=>this._seenAnnotationTypes.add(n.details.type))),this._stream.emitOne({text:e,delta:r})}resolve(){this._stream.resolve()}};var $n=se("ConversationOptions");var QNe=Object.freeze({abap:{lineComment:{start:"'"}},bat:{lineComment:{start:"REM"},aliases:["Batch","bat"],extensions:[".bat",".cmd"]},bibtex:{lineComment:{start:"%"},aliases:["BibTeX","bibtex"],extensions:[".bib"]},blade:{lineComment:{start:"#"}},c:{lineComment:{start:"//"},aliases:["C","c"],extensions:[".c",".i"]},clojure:{lineComment:{start:";"},aliases:["Clojure","clojure"],extensions:[".clj",".cljs",".cljc",".cljx",".clojure",".edn"]},coffeescript:{lineComment:{start:"//"},aliases:["CoffeeScript","coffeescript","coffee"],extensions:[".coffee",".cson",".iced"]},cpp:{lineComment:{start:"//"},aliases:["C++","Cpp","cpp"],extensions:[".cpp",".cc",".cxx",".c++",".hpp",".hh",".hxx",".h++",".h",".ii",".ino",".inl",".ipp",".ixx",".tpp",".txx",".hpp.in",".h.in"]},csharp:{lineComment:{start:"//"},aliases:["C#","csharp"],extensions:[".cs",".csx",".cake"]},css:{lineComment:{start:"/*",end:"*/"},aliases:["CSS","css"],extensions:[".css"]},dart:{lineComment:{start:"//"},aliases:["Dart"],extensions:[".dart"]},dockerfile:{lineComment:{start:"#"},aliases:["Docker","Dockerfile","Containerfile"],extensions:[".dockerfile",".containerfile"]},elixir:{lineComment:{start:"#"}},erb:{lineComment:{start:"<%#",end:"%>"}},erlang:{lineComment:{start:"%"}},fsharp:{lineComment:{start:"//"},aliases:["F#","FSharp","fsharp"],extensions:[".fs",".fsi",".fsx",".fsscript"]},go:{lineComment:{start:"//"},aliases:["Go"],extensions:[".go"]},groovy:{lineComment:{start:"//"},aliases:["Groovy","groovy"],extensions:[".groovy",".gvy",".gradle",".jenkinsfile",".nf"]},haml:{lineComment:{start:"-#"}},handlebars:{lineComment:{start:"{{!",end:"}}"},extensions:[".hbs",".handlebars"]},haskell:{lineComment:{start:"--"}},html:{lineComment:{start:"<!--",end:"-->"},aliases:["HTML","htm","html","xhtml"],extensions:[".html",".htm",".shtml",".xhtml",".xht",".mdoc",".jsp",".asp",".aspx",".jshtm",".volt",".ejs",".rhtml"]},ini:{lineComment:{start:";"}},java:{lineComment:{start:"//"},extensions:[".java",".class"]},javascript:{lineComment:{start:"//"},aliases:["JavaScript","javascript","js"],extensions:[".js",".es6",".mjs",".cjs",".pac"]},javascriptreact:{lineComment:{start:"//"},aliases:["JavaScript JSX","JavaScript React","jsx"],extensions:[".jsx"]},json:{extensions:[".json"],lineComment:{start:"//"}},jsonc:{lineComment:{start:"//"}},jsx:{lineComment:{start:"//"}},julia:{lineComment:{start:"#"},aliases:["Julia","julia"],extensions:[".jl"]},kotlin:{lineComment:{start:"//"}},latex:{lineComment:{start:"%"},aliases:["LaTeX","latex"],extensions:[".tex",".ltx",".ctx"]},less:{lineComment:{start:"//"},aliases:["Less","less"],extensions:[".less"]},lua:{lineComment:{start:"--"},aliases:["Lua","lua"],extensions:[".lua"]},makefile:{lineComment:{start:"#"},aliases:["Makefile","makefile"],extensions:[".mak",".mk"]},markdown:{lineComment:{start:"[]: #"},aliases:["Markdown","markdown"],extensions:[".md",".mkd",".mdwn",".mdown",".markdown",".markdn",".mdtxt",".mdtext",".workbook"]},"objective-c":{lineComment:{start:"//"},aliases:["Objective-C"],extensions:[".m"]},"objective-cpp":{lineComment:{start:"//"},aliases:["Objective-C++"],extensions:[".mm"]},perl:{lineComment:{start:"#"},aliases:["Perl","perl"],extensions:[".pl",".pm",".pod",".t",".PL",".psgi"]},php:{lineComment:{start:"//"},aliases:["PHP","php"],extensions:[".php",".php4",".php5",".phtml",".ctp"]},powershell:{lineComment:{start:"#"},aliases:["PowerShell","powershell","ps","ps1"],extensions:[".ps1",".psm1",".psd1",".pssc",".psrc"]},pug:{lineComment:{start:"//"}},python:{lineComment:{start:"#"},aliases:["Python","py"],extensions:[".py",".rpy",".pyw",".cpy",".gyp",".gypi",".pyi",".ipy",".pyt"]},ql:{lineComment:{start:"//"}},r:{lineComment:{start:"#"},aliases:["R","r"],extensions:[".r",".rhistory",".rprofile",".rt"]},razor:{lineComment:{start:"<!--",end:"-->"},aliases:["Razor","razor"],extensions:[".cshtml",".razor"]},ruby:{lineComment:{start:"#"},aliases:["Ruby","rb"],extensions:[".rb",".rbx",".rjs",".gemspec",".rake",".ru",".erb",".podspec",".rbi"]},rust:{lineComment:{start:"//"},aliases:["Rust","rust"],extensions:[".rs"]},sass:{lineComment:{start:"//"}},scala:{lineComment:{start:"//"}},scss:{lineComment:{start:"//"},aliases:["SCSS","scss"],extensions:[".scss"]},shellscript:{lineComment:{start:"#"},aliases:["Shell Script","shellscript","bash","fish","sh","zsh","ksh","csh"],extensions:[".sh",".bash",".bashrc",".bash_aliases",".bash_profile",".bash_login",".ebuild",".profile",".bash_logout",".xprofile",".xsession",".xsessionrc",".Xsession",".zsh",".zshrc",".zprofile",".zlogin",".zlogout",".zshenv",".zsh-theme",".fish",".ksh",".csh",".cshrc",".tcshrc",".yashrc",".yash_profile"]},slim:{lineComment:{start:"/"}},solidity:{lineComment:{start:"//"}},sql:{lineComment:{start:"--"},aliases:["SQL"],extensions:[".sql",".dsql"]},stylus:{lineComment:{start:"//"}},svelte:{lineComment:{start:"<!--",end:"-->"}},swift:{lineComment:{start:"//"},aliases:["Swift","swift"],extensions:[".swift"]},terraform:{lineComment:{start:"#"}},tex:{lineComment:{start:"%"},aliases:["TeX","tex"],extensions:[".sty",".cls",".bbx",".cbx"]},typescript:{lineComment:{start:"//"},aliases:["TypeScript","ts","typescript"],extensions:[".ts",".cts",".mts"]},typescriptreact:{lineComment:{start:"//"},aliases:["TypeScript JSX","TypeScript React","tsx"],extensions:[".tsx"]},vb:{lineComment:{start:"'"},aliases:["Visual Basic","vb"],extensions:[".vb",".brs",".vbs",".bas",".vba"]},verilog:{lineComment:{start:"//"}},"vue-html":{lineComment:{start:"<!--",end:"-->"}},vue:{lineComment:{start:"//"},extensions:[".vue"]},xml:{lineComment:{start:"<!--",end:"-->"},aliases:["XML","xml"],extensions:[".xml",".xsd",".ascx",".atom",".axml",".axaml",".bpmn",".cpt",".csl",".csproj",".csproj.user",".dita",".ditamap",".dtd",".ent",".mod",".dtml",".fsproj",".fxml",".iml",".isml",".jmx",".launch",".menu",".mxml",".nuspec",".opml",".owl",".proj",".props",".pt",".publishsettings",".pubxml",".pubxml.user",".rbxlx",".rbxmx",".rdf",".rng",".rss",".shproj",".storyboard",".svg",".targets",".tld",".tmx",".vbproj",".vbproj.user",".vcxproj",".vcxproj.filters",".wsdl",".wxi",".wxl",".wxs",".xaml",".xbl",".xib",".xlf",".xliff",".xpdl",".xul",".xoml"]},xsl:{lineComment:{start:"<!--",end:"-->"},aliases:["XSL","xsl"],extensions:[".xsl",".xslt"]},yaml:{lineComment:{start:"#"}}}),kE=new Map(Object.entries(QNe).map(([t,e])=>[t,{languageId:t,...e}]));function As(t){let e=typeof t=="string"?t:t.languageId,r=kE.get(e.toLowerCase());return r||{languageId:e,lineComment:{start:"//"}}}function Ym(t){let e=uc(t).toLowerCase();for(let r of kE.values())if(r.extensions?.includes(e))return r;return As("plaintext")}var B_=W(Tne()),_U=require("path");var ve=se("ITokenizerProvider"),Ene=3,mLe=3,hLe=1,$P=class{constructor(){this._cl100kTokenizer=new WP((0,_U.join)(__dirname,"./cl100k_base.tiktoken"),"cl100k_base");this._o200kTokenizer=new WP((0,_U.join)(__dirname,"./o200k_base.tiktoken"),"o200k_base")}acquireTokenizer(e){return e==="gpt-4o"?this._o200kTokenizer:this._cl100kTokenizer}},WP=class{constructor(e,r){this._tokenFilePath=e;this._encoderName=r;this.baseTokensPerMessage=mLe;this.baseTokensPerName=hLe}tokenize(e){return this._tokenizer||(this._tokenizer=this.initTokenizer()),this._tokenizer.encode(e)}tokenLength(e){return e?this.tokenize(e).length:0}countMessageTokens(e){let r=this.baseTokensPerMessage;for(let[n,o]of Object.entries(e))o&&(r+=this.tokenLength(o),n==="name"&&o!==void 0&&(r+=this.baseTokensPerName));return r}initTokenizer(){return(0,B_.createTokenizer)(this._tokenFilePath,(0,B_.getSpecialTokensByEncoder)(this._encoderName),(0,B_.getRegexByEncoder)(this._encoderName),64e3)}};function wne(t,e,r){return Math.min(Math.max(t,e),r)}var qr=class t{constructor(e,r){this.lineNumber=e,this.column=r}with(e=this.lineNumber,r=this.column){return e===this.lineNumber&&r===this.column?this:new t(e,r)}delta(e=0,r=0){return this.with(this.lineNumber+e,this.column+r)}equals(e){return t.equals(this,e)}static equals(e,r){return!e&&!r?!0:!!e&&!!r&&e.lineNumber===r.lineNumber&&e.column===r.column}isBefore(e){return t.isBefore(this,e)}static isBefore(e,r){return e.lineNumber<r.lineNumber?!0:r.lineNumber<e.lineNumber?!1:e.column<r.column}isBeforeOrEqual(e){return t.isBeforeOrEqual(this,e)}static isBeforeOrEqual(e,r){return e.lineNumber<r.lineNumber?!0:r.lineNumber<e.lineNumber?!1:e.column<=r.column}static compare(e,r){let n=e.lineNumber|0,o=r.lineNumber|0;if(n===o){let s=e.column|0,a=r.column|0;return s-a}return n-o}clone(){return new t(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(e){return new t(e.lineNumber,e.column)}static isIPosition(e){return e&&typeof e.lineNumber=="number"&&typeof e.column=="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}};var gt=class t{constructor(e,r,n,o){e>n||e===n&&r>o?(this.startLineNumber=n,this.startColumn=o,this.endLineNumber=e,this.endColumn=r):(this.startLineNumber=e,this.startColumn=r,this.endLineNumber=n,this.endColumn=o)}isEmpty(){return t.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return t.containsPosition(this,e)}static containsPosition(e,r){return!(r.lineNumber<e.startLineNumber||r.lineNumber>e.endLineNumber||r.lineNumber===e.startLineNumber&&r.column<e.startColumn||r.lineNumber===e.endLineNumber&&r.column>e.endColumn)}static strictContainsPosition(e,r){return!(r.lineNumber<e.startLineNumber||r.lineNumber>e.endLineNumber||r.lineNumber===e.startLineNumber&&r.column<=e.startColumn||r.lineNumber===e.endLineNumber&&r.column>=e.endColumn)}containsRange(e){return t.containsRange(this,e)}static containsRange(e,r){return!(r.startLineNumber<e.startLineNumber||r.endLineNumber<e.startLineNumber||r.startLineNumber>e.endLineNumber||r.endLineNumber>e.endLineNumber||r.startLineNumber===e.startLineNumber&&r.startColumn<e.startColumn||r.endLineNumber===e.endLineNumber&&r.endColumn>e.endColumn)}strictContainsRange(e){return t.strictContainsRange(this,e)}static strictContainsRange(e,r){return!(r.startLineNumber<e.startLineNumber||r.endLineNumber<e.startLineNumber||r.startLineNumber>e.endLineNumber||r.endLineNumber>e.endLineNumber||r.startLineNumber===e.startLineNumber&&r.startColumn<=e.startColumn||r.endLineNumber===e.endLineNumber&&r.endColumn>=e.endColumn)}plusRange(e){return t.plusRange(this,e)}static plusRange(e,r){let n,o,s,a;return r.startLineNumber<e.startLineNumber?(n=r.startLineNumber,o=r.startColumn):r.startLineNumber===e.startLineNumber?(n=r.startLineNumber,o=Math.min(r.startColumn,e.startColumn)):(n=e.startLineNumber,o=e.startColumn),r.endLineNumber>e.endLineNumber?(s=r.endLineNumber,a=r.endColumn):r.endLineNumber===e.endLineNumber?(s=r.endLineNumber,a=Math.max(r.endColumn,e.endColumn)):(s=e.endLineNumber,a=e.endColumn),new t(n,o,s,a)}intersectRanges(e){return t.intersectRanges(this,e)}static intersectRanges(e,r){let n=e.startLineNumber,o=e.startColumn,s=e.endLineNumber,a=e.endColumn,c=r.startLineNumber,u=r.startColumn,l=r.endLineNumber,d=r.endColumn;return n<c?(n=c,o=u):n===c&&(o=Math.max(o,u)),s>l?(s=l,a=d):s===l&&(a=Math.min(a,d)),n>s||n===s&&o>a?null:new t(n,o,s,a)}equalsRange(e){return t.equalsRange(this,e)}static equalsRange(e,r){return!e&&!r?!0:!!e&&!!r&&e.startLineNumber===r.startLineNumber&&e.startColumn===r.startColumn&&e.endLineNumber===r.endLineNumber&&e.endColumn===r.endColumn}getEndPosition(){return t.getEndPosition(this)}static getEndPosition(e){return new qr(e.endLineNumber,e.endColumn)}getStartPosition(){return t.getStartPosition(this)}static getStartPosition(e){return new qr(e.startLineNumber,e.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,r){return new t(this.startLineNumber,this.startColumn,e,r)}setStartPosition(e,r){return new t(e,r,this.endLineNumber,this.endColumn)}collapseToStart(){return t.collapseToStart(this)}static collapseToStart(e){return new t(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}collapseToEnd(){return t.collapseToEnd(this)}static collapseToEnd(e){return new t(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn)}delta(e){return new t(this.startLineNumber+e,this.startColumn,this.endLineNumber+e,this.endColumn)}static fromPositions(e,r=e){return new t(e.lineNumber,e.column,r.lineNumber,r.column)}static lift(e){return e?new t(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):null}static isIRange(e){return e&&typeof e.startLineNumber=="number"&&typeof e.startColumn=="number"&&typeof e.endLineNumber=="number"&&typeof e.endColumn=="number"}static areIntersectingOrTouching(e,r){return!(e.endLineNumber<r.startLineNumber||e.endLineNumber===r.startLineNumber&&e.endColumn<r.startColumn||r.endLineNumber<e.startLineNumber||r.endLineNumber===e.startLineNumber&&r.endColumn<e.startColumn)}static areIntersecting(e,r){return!(e.endLineNumber<r.startLineNumber||e.endLineNumber===r.startLineNumber&&e.endColumn<=r.startColumn||r.endLineNumber<e.startLineNumber||r.endLineNumber===e.startLineNumber&&r.endColumn<=e.startColumn)}static compareRangesUsingStarts(e,r){if(e&&r){let s=e.startLineNumber|0,a=r.startLineNumber|0;if(s===a){let c=e.startColumn|0,u=r.startColumn|0;if(c===u){let l=e.endLineNumber|0,d=r.endLineNumber|0;if(l===d){let p=e.endColumn|0,f=r.endColumn|0;return p-f}return l-d}return c-u}return s-a}return(e?1:0)-(r?1:0)}static compareRangesUsingEnds(e,r){return e.endLineNumber===r.endLineNumber?e.endColumn===r.endColumn?e.startLineNumber===r.startLineNumber?e.startColumn-r.startColumn:e.startLineNumber-r.startLineNumber:e.endColumn-r.endColumn:e.endLineNumber-r.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}toJSON(){return this}};function xU(t){return t.capabilities.type==="chat"}function Rne(t){return t.capabilities.type==="embeddings"}async function Mn(t,e){let r=SU(e);return t.getChatEndpoint(r)}function SU(t){return t===2?"gpt-4":"gpt-3.5-turbo"}var Le=se("IEndpointProvider");var KP=class extends Error{constructor(e){super(`Unrecognized language: ${e}`)}},kne={python:"python",javascript:"javascript",javascriptreact:"javascript",jsx:"javascript",typescript:"typescript",typescriptreact:"tsx",tsx:"tsx",go:"go",ruby:"ruby",csharp:"csharp",cpp:"cpp",java:"java",rust:"rust"};function Bp(t){if(t in kne)return kne[t]}function $l(t,e,r){if(t===0)return{text:e,range:r};let n=typeof t=="number"?{0:e.slice(0,t),index:t}:e.match(t);if(!n)return{text:e,range:r};let o=n[0],s=x_(o,`
`);return{text:e.slice(o.length),range:{startLineNumber:r.startLineNumber+s,startColumn:s>0?o.length-(o.lastIndexOf(`
`)+1):r.startColumn+o.length,endColumn:r.endColumn,endLineNumber:r.endLineNumber}}}function Wl(t,e,r){if(t===0)return{text:e,range:r};let n=typeof t=="number"?{0:e.slice(-t),index:e.length-t}:e.match(t);if(!n)return{text:e,range:r};let o=n[0],s=x_(o,`
`),a=r.endLineNumber-s;return{text:e.slice(0,n.index),range:{startColumn:r.startColumn,startLineNumber:r.startLineNumber,endLineNumber:a,endColumn:s>0?(a===r.startLineNumber?r.startColumn:0)+n.index-(e.lastIndexOf(`
`,n.index-1)+1):Math.max(0,r.endColumn-o.length)}}}function Ane(t){let e=t.lastIndexOf(`
`);return e===-1?{lineNumber:0,column:t.length}:{lineNumber:x_(t.slice(0,e),`
`)+1,column:t.length-(e+1)}}function Pne(t,e,r,n){let o=r?gLe(r,t,e):{text:t,range:e};return n?vLe(n,o.text,o.range):o}function gLe(t,e,r){let n=gt.lift(r),o=qr.lift(t);if(o.equals(n.getStartPosition()))return{text:e,range:r};if(o.isBefore(n.getStartPosition()))return{text:e,range:r};let s=0;if(o.lineNumber===n.getStartPosition().lineNumber)s=o.column-n.getStartPosition().column;else{let a=e.split(`
`);for(let[c,u]of a.entries())if(n.getStartPosition().lineNumber+c===o.lineNumber){s+=o.column;break}else s+=u.length+1}return{text:e.substring(s),range:{startLineNumber:o.lineNumber,startColumn:o.column,endColumn:r.endColumn,endLineNumber:r.endLineNumber}}}function vLe(t,e,r){let n=gt.lift(r),o=qr.lift(t);if(o.equals(n.getEndPosition()))return{text:e,range:r};if(n.getEndPosition().isBefore(o))return{text:e,range:r};let s="";if(o.lineNumber===n.getStartPosition().lineNumber)s=e.substring(0,o.column-n.getStartPosition().column);else{let a=e.split(`
`),c=[];for(let[u,l]of a.entries())if(n.getStartPosition().lineNumber+u===o.lineNumber){c.push(l.substring(0,o.column));break}else c.push(l+`
`);s=c.join("")}return{text:s,range:{startLineNumber:r.startLineNumber,startColumn:r.startColumn,endColumn:o.column,endLineNumber:o.lineNumber}}}function Xm(t,e=0,r=0){let n=t.row+e,o=t.column+r;return{lineNumber:n<0?0:n,column:o<0?0:o}}function dc(t){return{startLineNumber:t.range.startPosition.row,startColumn:t.range.startPosition.column,endLineNumber:t.range.endPosition.row,endColumn:t.range.endPosition.column}}var v0=/\s+$/;function Dne(t){return t.replace(v0,"")}function Hc(t,e){return{startLineNumber:t.lineNumber,startColumn:t.column,endLineNumber:e.lineNumber,endColumn:e.column}}function Nne(t,e,r){if(t===0)return{text:e,sources:r};let n=typeof t=="number"?{0:e.slice(-t),index:e.length-t}:e.match(t);if(!n)return{text:e,sources:r};let o=n.index;return{text:e.slice(0,o),sources:r.filter(s=>s.start<o).map(s=>({start:s.start,end:Math.min(s.end,o),range:Wl(Math.max(0,s.end-o),e.slice(0,s.end),s.range).range}))}}var _t=se("IParserService");function YP(t){return{startPosition:{row:t.start.line,column:t.start.character},endPosition:{row:t.end.line,column:t.end.character}}}function QP(t){return new ze(t.startPosition.row,t.startPosition.column,t.endPosition.row,t.endPosition.column)}function Xi(t,e){return{startIndex:e.offsetAt(t.start),endIndex:e.offsetAt(t.end)}}function Ps(t,e){return new ze(t.positionAt(e.startIndex),t.positionAt(e.endIndex))}var JP=t=>{let e=dc(t);return{sources:[{start:0,end:t.text.length,range:e}],text:t.text,range:e}},Kl=class{constructor(e){this.tokenizer=e.acquireTokenizer("gpt4")}genericWholeFileChunking(e,{maxTokenLength:r=XP,removeEmptyLines:n=!0,rangeLimit:o=void 0}){e=e.replace(/\r\n/g,`
`);let s=e,a=Ane(e),c={startLineNumber:0,startColumn:0,endLineNumber:a.lineNumber,endColumn:a.column};if(o){let l=DE(gt.lift(o),e,gt.lift(c));s=l.newTextRange.text,c=l.newTextRange.range}return this._processLinesIntoChunks(s,c.startLineNumber,[{start:c.startLineNumber,end:e.length,range:c}],r,!0,n).filter(l=>!n||l.text.length&&/[\w\d]{2}/.test(l.text))}genericChunking({lineRangeText:e,maxTokenLength:r=XP,removeEmptyLines:n=!0,extraLineRangeSeparator:o="",numTokensInEllipsis:s=0}){if(r<0)throw Error("Cannot chunk text, not enough chunk room");if(e.length===0)return[];let a=this.tokenizer.tokenLength(o),c=[],u,l=!1;for(let d=0;d<e.length;d++){let p=e[d];if(u){let m=r-this.tokenizer.tokenLength(u.text)-a;if(m>0&&p.text.length<2e4&&this.tokenizer.tokenLength(p.text)<=m){let h=o||(l?`
`:""),g=u.text.length+h.length,v=u.text+h+p.text,y={startLineNumber:u.range.startLineNumber,startColumn:u.range.startColumn,endColumn:p.range.endColumn,endLineNumber:p.range.endLineNumber},_=p.sources.map(b=>({start:b.start+g,end:b.end+g,range:b.range}));for(let b of u.sources)_.push(b);l=!1,u={sources:_,text:v,range:y};continue}c.push(u)}let f=this._processLinesIntoChunks(p.text,p.range.startLineNumber,p.sources,r,!1,n,s,d===0);u=f.pop(),l=!0,c.push(...f)}return u&&c.push(u),c.filter(d=>!n||d.text.length&&/[^\s]/.test(d.text)).map(d=>{let{text:p,sources:f}=Nne(v0,d.text,d.sources);return{range:d.range,text:p,sources:f}})}_processLinesIntoChunks(e,r,n,o,s,a,c=0,u=!1){let l=0,d=0,p=e.split(`
`),f=[];for(let h=0;h<p.length;h++){let g=p[h],v=d;if(d+=g.length+1,a&&g.length===0)continue;let y=g.slice(0,o*4);f.push({text:y,lineNumber:h+r,originalStart:v,originalEnd:v+y.length,tokens:this.tokenizer.tokenLength(y)})}let m=[];for(;l<f.length;){let h=o-c-(u?0:c),g=l+1,v="";for(let re=f[l].tokens;g<f.length;g++){let ee=re+f[g].tokens;if(ee>h){v=f.slice(l,g+1).map(E=>E.text).join(`
`);let N=this.tokenizer.tokenLength(v);for(;N<=h&&g<f.length-1;)g++,v+=`
`+f[g].text,N=this.tokenizer.tokenLength(v);break}re=ee}let y=f.slice(l,g),_=g;if(s){let{chunks:re,usedFromRemaining:ee}=this._dedentAndAddLinesToChunk(y,f.slice(g),h);y=re,l=_+ee}else for(l=_;l<f.length&&f[l].text.length===0;)l++;if(y.length===0)continue;for(;y.length;){let re=y[y.length-1],ee=re.text.trimEnd();if(ee==="")y.pop();else if(ee!==re.text){re.text=ee,re.originalEnd=ee.length;break}else break}if(y.length===0)continue;let b=[];n.sort((re,ee)=>re.start-ee.start);let S=0,I=0,w=0,O=y[0]?.originalStart||0,U=(re,ee)=>{if(I===re){I=ee;return}for(;S<n.length&&n[S].start<I;){let N=n[S++];if(N.end<O)continue;let E=Math.max(0,N.end-I),P=Math.max(0,O-N.start),q=Wl(E,e.slice(N.start,N.end),N.range),F=$l(P,q.text,q.range);b.push({start:N.start+P-w,end:N.end-E-w,range:F.range})}I=ee,O=re},z="";for(let re=0;re<y.length;re++){let ee=y[re];U(ee.originalStart,ee.originalEnd),z+=ee.text,w=ee.originalEnd-z.length,re<y.length-1&&(z+=`
`,e[ee.originalEnd]===`
`&&U(ee.originalEnd,ee.originalEnd+1))}U(1/0,1/0);let M=y[y.length-1];m.push({text:z,range:{startLineNumber:y[0].lineNumber,startColumn:0,endLineNumber:M.lineNumber,endColumn:M.text.length},sources:b})}return m}_dedentAndAddLinesToChunk(e,r,n){let o=PE(e.map(d=>d.text)),s=o.shortestLeadingCommonWhitespace;if(!s)return{chunks:e,usedFromRemaining:0};let a=e;for(let d=0;d<a.length;d++)a[d].originalStart+=s.length,a[d].text=o.trimmedLines[d]||"";let c=0,u=this.tokenizer.tokenLength(a.map(d=>d.text).join(`
`)),l=r[c];for(u+=l?.tokens||0;l&&u<n&&(l.text.length===0||l.text.startsWith(s));)a.push({...l,text:l.text.slice(s.length),originalStart:l.originalEnd+s.length}),c++,l=r[c],u+=l?.tokens||0;return{chunks:a,usedFromRemaining:c}}};Kl=B([T(0,ve)],Kl);function PE(t){let e=t.map(s=>{if(!s)return;let a=s.match(/^\s+/),c=a?a[0]:"",u=s.substring(c?.length);return[c,u]}),r=Kt(e),n=yLe(r)??"",o=n.length;return{trimmedLines:e.map(s=>s?s[0].substring(o)+s[1]:void 0),shortestLeadingCommonWhitespace:n}}function yLe(t){let e;for(let r of t){if(e===void 0){e=r[0];continue}e=bLe(e,r[0])}return e??""}function bLe(t,e){let r=aP(t,e);return t.substring(0,r)}var XP=250;function DE(t,e,r){let n=r.getStartPosition().isBefore(t.getStartPosition()),o=t.getEndPosition().isBefore(r.getEndPosition());return{newTextRange:Pne(e,r,t.getStartPosition(),t.getEndPosition()),trimmedLeft:n,trimmedRight:o}}function _Le(t){return t&&Array.isArray(t.text)&&(t.needsLeadingElipsis===void 0||typeof t.needsLeadingElipsis=="boolean")&&(t.needsTrailingElipsis===void 0||typeof t.needsTrailingElipsis=="boolean")}function xLe(t){return t&&typeof t.bodyIndent=="string"&&typeof t.fullRange=="object"&&t.body&&Array.isArray(t.body.content)&&(t.body.outline===void 0||_Le(t.body.outline))&&(t.suffix===void 0||typeof t.suffix=="string")&&(t.header===void 0||typeof t.header=="object"&&typeof t.header.original=="string"&&(t.header.outline===void 0||typeof t.header.outline=="string"))}var q_=class t{constructor(e,r){this.lang=r;this._tokenizerProvider=e.get(ve),this._naiveChunker=new Kl(this._tokenizerProvider),this._parserService=e.get(_t);let n=t.getFileChunkingOptions(r);this._inlineComment=n?.blockWrap??{start:"",end:""},this._elipsisPlaceholder=n?.elipsisPlaceholder??"...",this._lookForIndentInHeader=n?.lookForIndentInHeader??!0,this._numTokensInEllipsis=this._tokenizerProvider.acquireTokenizer("gpt4").tokenLength(this._elipsisPlaceholder)+1}static getFileChunkingOptions(e){return e!=="python"&&e!=="ruby"?{elipsisPlaceholder:"/*...*/",blockWrap:{start:"{",end:"}"},lookForIndentInHeader:!1}:{}}get _summaryPlaceHolder(){return this._inlineComment.start+this._elipsisPlaceholder+this._inlineComment.end}async parse(e,r,n){let o=await this.createChunkTree(e,r,n);return o?this.createSummaryFromSemanticChunkTree(o,!0):[]}async createChunkTree(e,r,n){let o=await this.provideQueryTree(e);if(!n.isCancellationRequested)return this.createChunkTreeFromQueryTree(o,r,n)}async createSummaryFromSemanticChunkTree(e,r=!1){let n=[];if(e.body.content.length!==0&&n.push(this._makeChunksFromStructure(e.bodyIndent,e.body.content,e.fullRange,!r,e.header?.original,e.suffix)),e.body.outline&&e.body.outline.text.length!==0){let o=e.header?.outline??e.header?.original;n.push(this._makeChunksFromStructure(e.bodyIndent,e.body.outline.text,e.fullRange,!0,o,e.suffix,e.body.outline.needsLeadingElipsis,e.body.outline.needsTrailingElipsis).then(s=>(r&&s.length===1&&(s[0]={...s[0],isFullFile:!0}),s)))}return(await Promise.all(n)).flat()}async createChunkTreeFromQueryTree(e,r,n){let o=gt.lift(r.limitToRange),s=this._parseBlocks(e.roots,"",r.maxTokenLength,r.maxHeaderLengthFactor,o??void 0),a=s.content.flat(),c=s.outline??[],u=this.createOutlineSummaryBody(r.maxTokenLength,JP(e.syntaxTreeRoot),c,"",o??void 0);return{bodyIndent:"",fullRange:dc(e.syntaxTreeRoot),body:{content:a,outline:u}}}provideQueryTree(e){let r=e.replace(/\r\n/g,`
`);return this._parserService.getSemanticChunkTree(this.lang,r)}chunkWholeText(e,r,n,o=0,s=r,a,c=""){if(e.trim().length===0)return{content:{text:[],isFull:!0}};let u;try{let l={range:r,text:e},d=s,p=l.text;if(a){let f=gt.lift(s),m=DE(a,e,f);l=m.newTextRange;let h=f.intersectRanges(a);if(!h)throw Error("Invalid Body Text Range");d=h,p=this._constructLimitedRange(m.trimmedRight,m.trimmedLeft,l.text,c)}u=this._naiveChunker.genericChunking({lineRangeText:[{range:l.range,text:p,sources:[{start:o,end:p.length,range:d}]}],maxTokenLength:n,numTokensInEllipsis:this._numTokensInEllipsis})}catch{return{content:{text:[],isFull:!1},outline:[]}}return{content:{text:u,isFull:!0}}}_parseBlocks(e,r,n,o,s){return this._parseSemanticStructure(e,r,n,o,(a,c,u,l)=>{let d=l+c.text;if(this._tokenizerProvider.acquireTokenizer("gpt4").tokenLength(d)<=u){let h=$l(/^\s*\n/g,d,c.range),g=$l(/(\n\s*$)/g,h.text,h.range);if(s){let v=DE(s,g.text,gt.lift(g.range)),y=this._constructLimitedRange(v.trimmedRight,v.trimmedLeft,v.newTextRange.text,l);return{content:{text:[{sources:[{start:0,end:y.length,range:v.newTextRange.range}],range:v.newTextRange.range,text:y}],isFull:!0}}}else return{content:{text:[{sources:[{start:l.length,end:g.text.length,range:g.range}],range:g.range,text:g.text}],isFull:!0}}}if(a.length===0)return this.chunkWholeText(d,c.range,u,s?0:l.length,void 0,s,l);let p=this._parseBlocks(a,l,u,o,s),f=p.content,m=p.outline;return{content:{text:f,isFull:!1},outline:m}},s)}_createOutlineBody(e,r){let n=e.text.split(`
`),o={lineNumber:e.range.startLineNumber,column:e.range.startColumn},s=[],a=o,c=p=>{let f=p.lineNumber-o.lineNumber,m=p.column;return o.lineNumber===p.lineNumber&&(m=p.column-o.column),{lineNumber:f,column:m}},u=p=>{let f=p.lineNumber-o.lineNumber,m=f>=n.length||p.column===n[f].length-1;return{newPosition:{lineNumber:p.lineNumber,column:p.column+1},isNewLine:m}},l=(p,f)=>{if(p.lineNumber>f.lineNumber||p.lineNumber===f.lineNumber&&p.column>f.column)return;let m=[],h=c(p),g=c(f),v=Hc(p,f),y=n[h.lineNumber].substring(h.column);if(h.lineNumber===g.lineNumber){let S=y.substring(0,g.column-h.column),I=u(f);a=I.newPosition,I.isNewLine&&(S+=`
`),m.push(S)}else{let S=n[g.lineNumber].substring(0,g.column),I=u(f);a=I.newPosition,I.isNewLine&&(S+=`
`),m.push(y+`
`);for(let w=h.lineNumber+1;w<g.lineNumber;w++)m.push(n[w]+`
`);m.push(S)}let _=m.join(""),b=$l(/^\s+\n/,_,v);b.text.length>0&&s.push({sources:[{start:0,end:b.text.length,range:b.range}],text:b.text,range:v})},d=p=>{s.push({sources:p.sources,text:p.summary+`

`,range:p.range})};return r.sort((p,f)=>p.range.startLineNumber-f.range.startLineNumber||p.range.endLineNumber-f.range.endLineNumber),r.forEach(p=>{l(a,{lineNumber:p.range.startLineNumber,column:p.range.startColumn}),d(p),a=u({lineNumber:p.range.endLineNumber,column:p.range.endColumn}).newPosition}),l(a,{lineNumber:e.range.endLineNumber,column:e.range.endColumn}),s}createOutlineSummaryBody(e,r,n,o,s){let a=r;if(a.range.startColumn>=o.length){let p={startLineNumber:a.range.startLineNumber,startColumn:a.range.startColumn-o.length,endLineNumber:a.range.endLineNumber,endColumn:a.range.endColumn},f=o+a.text;a={text:f,range:p,sources:[{start:0,end:f.length,range:p}]}}let c=!1,u=!1;if(s){if(n.length===1&&gt.lift(n[0].range).containsRange(s))return{text:[]};let p=DE(s,r.text,gt.lift(r.range));u=p.trimmedLeft,c=p.trimmedRight,a={text:p.newTextRange.text,range:p.newTextRange.range,sources:[{start:0,end:p.newTextRange.text.length,range:p.newTextRange.range}]}}let l=this._createOutlineBody(a,n.map(p=>({sources:p.sources,summary:Dne(p.summary),range:p.range,needsTrailingElipsis:c,needsLeadingElipsis:u}))),d;try{d=this._naiveChunker.genericChunking({lineRangeText:l,removeEmptyLines:!1,maxTokenLength:e,numTokensInEllipsis:this._numTokensInEllipsis})}catch{return console.error("caught error in naive chunker: {e}"),{text:[]}}return{text:d,needsLeadingElipsis:u,needsTrailingElipsis:c}}async _makeChunksFromStructure(e,r,n,o,s,a,c,u){return Kt(await Promise.all(r.map(async(l,d)=>{let p=xLe(l)?await this.createSummaryFromSemanticChunkTree(l):l,f=s&&s.length>0?s:"";(c||o&&d!==0)&&(f+=`${e}${this._elipsisPlaceholder}
`);let m="";if((u||o&&d!==r.length-1)&&(m+=`
${e}${this._elipsisPlaceholder}`),a&&a.length>0&&(m+=a),Array.isArray(p))return Kt(p.map(g=>{if(g.text.trim().length!==0)return{range:g.range,text:f+g.text+m,sources:g.sources.map(v=>({start:v.start+f.length,end:v.end+f.length,range:v.range}))}}));if(p.text.trim().length===0)return;let h={startColumn:(d===0?n:p.range).startColumn,startLineNumber:(d===0?n:p.range).startLineNumber,endColumn:n.endColumn,endLineNumber:n.endLineNumber};return{sources:p.sources.map(g=>({start:g.start+f.length,end:g.end+f.length,range:g.range})),range:h,text:f+p.text+m}}))).flat()}findNewIndent(e,r,n){let s=(this._lookForIndentInHeader?r.text.substring(0,n.startIndex-r.startIndex):n.text).match(new RegExp(`\\n+(\\s*)${e}${this._lookForIndentInHeader?"$":""}`));return s&&s.length>1?s[1]:""}_constructLimitedRange(e,r,n,o){return n.length===0?"":(r?`${o}${this._elipsisPlaceholder}
`:"")+n+(e?`
${o}${this._elipsisPlaceholder}`:"")}};var jc=class extends q_{_parseSemanticStructure(e,r,n,o,s,a){let c=[],u=d=>{let p=d.info,f=p.mainBlock,m=p.detailBlocks.comments,h=p.detailBlocks.body,g=dc(h),v=this._getInnerLineRangeText(h),y=h.startIndex-f.startIndex+v.prefix.length,_=this.findNewIndent(r,f,h),b="";for(let Z of m)b+=r+Z.text+`
`;let S=r+f.text.substring(0,y),I=b+S,w=dc(f),O=Hc(Xm((m.length>0?m[0]:f).range.startPosition,0,-r.length),{column:w.endColumn,lineNumber:w.endLineNumber});if(a&&!gt.lift(O).intersectRanges(a))return;let U=o*n,z=I.replace(/(\n*)(\n\s*)$/g,`
`),M=this._tokenizerProvider.acquireTokenizer("gpt4").tokenLength(z);if(M>U&&(z=S.replace(/(\n*)(\n\s*)$/g,`
`),M=this._tokenizerProvider.acquireTokenizer("gpt4").tokenLength(S),M>U)){z="",M=0;let Z=this.chunkWholeText(b+r+f.text,dc(f),n,b.length+r.length,void 0,a,r);return{bodyIndent:r,body:{content:Z.content.text},fullRange:O}}let re=v.suffix+f.text.substring(h.endIndex-f.startIndex),ee=this._tokenizerProvider.acquireTokenizer("gpt4").tokenLength(z+`
`+re),N=n-ee,E=s(d.children,v.body,N,r+_);O=Hc({column:O.startColumn,lineNumber:O.startLineNumber},Xm(f.range.endPosition));let P=Wl(v0,f.text.substring(0,h.startIndex-f.startIndex),{startColumn:w.startColumn,startLineNumber:w.startLineNumber,endLineNumber:g.startLineNumber,endColumn:g.startColumn}),q,F=b+r;return c.push({summary:F+P.text+" "+this._summaryPlaceHolder,range:O,sources:[{start:F.length,end:F.length+P.text.length,range:P.range}]}),E.outline!==void 0&&(q=this.createOutlineSummaryBody(N,v.body,E.outline,r+_,a)),{header:{original:z},bodyIndent:r+_,body:{content:E.content.text,outline:q},fullRange:O,suffix:re}},l=Kt(e.map(d=>u(d)));return{outline:c,content:l}}_getInnerLineRangeText(e){let r=dc(e),n=e.text,o=$l(/^\s*\{\s*/,n,r),s=Wl(/\s*\}\s*$/,o.text,o.range);return{prefix:n.slice(0,n.length-o.text.length),body:{sources:[{start:0,end:s.text.length,range:s.range}],text:s.text,range:s.range},suffix:o.text.slice(s.text.length)}}};var ZP=class{constructor(e){this.accessor=e;this.naiveChunker=new Kl(e.get(ve))}async parse(e,r,n){let o=this._getLineRangeText(e,r.limitToRange);return this.naiveChunker.genericChunking({lineRangeText:o,maxTokenLength:r.maxTokenLength,extraLineRangeSeparator:`

`})}_getLineRangeText(e,r){e=e.replace(/\r\n/g,`
`);let n=e.split(`
`),o=[],s={lineNumber:0,column:0},a=[],c=r?r.startLineNumber:0,u=r?r.startColumn:void 0,l=Math.min(r?r.endLineNumber+1:n.length,n.length),d=r?r.endColumn:void 0;for(let p=c;p<l;p++)if(p===0&&u?n[p]=n[p].substring(u):p===l-1&&d&&(n[p]=n[p].substring(0,d)),n[p].trim().length===0){if(o.length>0){let f=o.join(`
`),m=Hc(s,{lineNumber:p-1,column:n[p-1].length});a.push({sources:[{start:0,end:f.length,range:m}],text:f,range:m}),o.length=0}s={lineNumber:p+1,column:0};continue}else o.push(n[p]);if(o.length>0){let p=o.join(`
`),f=Hc(s,{lineNumber:n.length-1,column:n[n.length-1].length});a.push({sources:[{start:0,end:p.length,range:f}],text:p,range:f})}return a}};var eD=class extends q_{_parseSemanticStructure(e,r,n,o,s,a){let c=[],u=d=>{let p=d.info,f=p.mainBlock,m=p.detailBlocks.decorator,h=p.detailBlocks.docstring,g=p.detailBlocks.body,v={start:0,end:0,range:null};if(h)v.end=h.endIndex-f.startIndex,v.range={startLineNumber:f.range.startPosition.row,startColumn:f.range.startPosition.column,endLineNumber:h.range.endPosition.row,endColumn:h.range.endPosition.column};else if(g)v.end=g.startIndex-f.startIndex,v.range={startLineNumber:f.range.startPosition.row,startColumn:f.range.startPosition.column,endLineNumber:g.range.startPosition.row,endColumn:g.range.startPosition.column};else{let E=Wl(1,f.text,v.range);v.end=f.text.length,v.range=E.range}let y=this.findNewIndent(r,f,g),_=[],b="";m&&(b=r+m.text+`
`,_.push({start:r.length,end:m.text.length+r.length,range:dc(m)}));let S=Wl(v0,f.text.substring(0,v.end),v.range);_.push({start:b.length+r.length,end:b.length+r.length+S.text.length,range:S.range});let I=b+r+S.text+`
`,w=Hc(Xm(f.range.startPosition,0,-r.length),Xm(f.range.endPosition));if(m&&(w=Hc(Xm(m.range.startPosition,0,-r.length),{column:w.endColumn,lineNumber:w.endLineNumber})),a&&!gt.lift(w).intersectRanges(a))return;let O=o*n,U=I.replace(/\n+\s*$/g,`
`),z=this._tokenizerProvider.acquireTokenizer("gpt4").tokenLength(U);if(z>O&&(U=r+S.text.substring(0,g.startIndex-f.startIndex),z=this._tokenizerProvider.acquireTokenizer("gpt4").tokenLength(U),z>O)){U="",z=0;let E=$l(h?h.endIndex-g.startIndex:0,g.text,dc(g)),P=this.chunkWholeText(I+`
`+E.text,dc(f),n,I.length+1,E.range,a,r);return{fullRange:w,body:{content:P.content.text},bodyIndent:r}}w=Hc({column:w.startColumn,lineNumber:w.startLineNumber},Xm(f.range.endPosition)),c.push({summary:(h?I+y:I.slice(0,-1)+" ")+this._summaryPlaceHolder,sources:_,range:w});let M=JP(g),re=s(d.children,M,n-z,r+y),ee=r+f.text.substring(0,g.startIndex-f.startIndex).replace(/\n+\s*$/g,`
`);re.content.isFull&&(U=ee);let N;return re.outline!==void 0&&(N=this.createOutlineSummaryBody(n-z,M,re.outline,r+y,a)),{header:{original:U,outline:ee},bodyIndent:r+y,body:{content:re.content.text,outline:N},fullRange:w}},l=Kt(e.map(d=>u(d)));return{outline:c,content:l}}};var SLe=.6,Wu=se("ChunkingService"),Lne=(t,e)=>({file:t,text:e.text,sources:e.sources.map(r=>({start:r.start,end:r.end,range:gt.lift(r.range)})),range:gt.lift(e.range),isFullFile:e.isFullFile}),Jm=class{constructor(e){this.accessor=e;this.semanticChunkers=new Map;this.tokenizerProvider=this.accessor.get(ve),this.naiveChunker=new Kl(this.tokenizerProvider),this.logger=this.accessor.get(ce).getLogger("WorkspaceChunkSearch")}canSemanticallyChunk(e){return!!this.getSemanticChunker(e)}async chunkFileNaive(e,r,n,o){let s=o?.maxTokenLength??await One(this.accessor);if(n.isCancellationRequested)return[];let c=this.naiveChunker.genericWholeFileChunking(r,{maxTokenLength:s,rangeLimit:o?.limitToRange}).map(u=>Lne(e,u));return o?.validateChunkLengths&&this.validateChunkLengths(c,s),c.filter(u=>u.text)}async chunkFileSemantic(e,r,n,o){let s=o?.maxTokenLength??await One(this.accessor);if(n.isCancellationRequested)return[];let a=o?.maxHeaderLengthFactor??SLe,c=[];try{let u=await this.getSemanticChunker(e)?.parse(r,{maxTokenLength:s,maxHeaderLengthFactor:a,limitToRange:o?.limitToRange},n);if(n.isCancellationRequested)return[];c.push(...Array.from(u??[],l=>Lne(e,l)))}catch(u){this.logger.error("Error parsing semantic chunks for the following file: "+e.fsPath),this.logger.error(u),c=[]}return c.length?(o?.validateChunkLengths&&this.validateChunkLengths(c,s),c.filter(u=>u.text)):this.chunkFileNaive(e,r,n,{maxTokenLength:s,validateChunkLengths:o?.validateChunkLengths,limitToRange:o?.limitToRange})}validateChunkLengths(e,r){for(let n of e){let o=this.tokenizerProvider.acquireTokenizer("gpt4").tokenLength(n.text);o>r*1.2&&console.warn("Produced chunk that is over length limit",{file:n.file+"",range:n.range,chunkTokenLength:o,maxLength:r})}}getSemanticChunker(e){let r=Ym(e),n=this.semanticChunkers.get(r.languageId);if(n)return n;let o;switch(r.languageId){case"typescript":o=new jc(this.accessor,"typescript");break;case"typescriptreact":o=new jc(this.accessor,"tsx");break;case"javascript":case"javascriptreact":o=new jc(this.accessor,"javascript");break;case"python":o=new eD(this.accessor,"python");break;case"java":o=new jc(this.accessor,"java");break;case"cpp":case"c":o=new jc(this.accessor,"cpp");break;case"csharp":o=new jc(this.accessor,"csharp");break;case"go":o=new jc(this.accessor,"go");break;case"markdown":o=new ZP(this.accessor);break;case"ruby":o=new jc(this.accessor,"ruby");break;case"rust":o=new jc(this.accessor,"rust");break}return o&&this.semanticChunkers.set(r.languageId,o),o}};Jm=B([T(0,rt)],Jm);async function One(t){return y0(t,{valueFor4096:XP,maxMultiplier:4})}function Zm(t){return new ze(t.startLineNumber,t.startColumn,t.endLineNumber,t.endColumn)}async function y0(t,e){let n=(await t.get(Le).getChatEndpoint("gpt-3.5-turbo")).modelMaxPromptTokens/4096;return wne(Math.round(e.valueFor4096*n),e.valueFor4096,e.valueFor4096*e.maxMultiplier)}var b0=se("IRunCommandExecutionService");var j_=W(require("vscode"));var H_=class extends St{constructor(r){super();this._configurationService=r;this._register(j_.workspace.onDidChangeConfiguration(n=>{n.affectsConfiguration("github.copilot.advanced")&&j_.commands.executeCommand("setContext","github.copilot.advanced.runCommandEnabled",r.getConfig(ge.RunCommandEnabled))}))}async executeCommand(r,n,...o){try{j_.commands.executeCommand(r,...o),n.sendMSFTTelemetryEvent("automaticCommandExecutedSucceeded",{command:r,args:o?.join(",")})}catch(s){n.sendMSFTTelemetryEvent("automaticCommandExecutedFailed",{command:r,args:o?.join(","),e:s})}}updateContextValues(){j_.commands.executeCommand("setContext","github.copilot.advanced.runCommandEnabled",this._configurationService.getConfig(ge.RunCommandEnabled))}};H_=B([T(0,be)],H_);var Yl=W(require("vscode"));function Mne(t){return typeof t=="string"?t:JSON.stringify(t)}var tD=class extends IP{constructor(){super();this._onDidChangeConfiguration=new Ht;this.onDidChangeConfiguration=this._onDidChangeConfiguration.event;this.config=Yl.workspace.getConfiguration(Bm),Yl.workspace.onDidChangeConfiguration(r=>{r.affectsConfiguration(Bm)&&(this.config=Yl.workspace.getConfiguration(Bm)),this._onDidChangeConfiguration.fire(r)})}getConfig(r){let n=this._getConfiguredValue(r);return n!==void 0?n:r.defaultValue}getNonExtensionConfig(r){return Yl.workspace.getConfiguration().get(r)}_getTargetFromInspect(r){let n;return r?r.workspaceFolderValue!==void 0?n=Yl.ConfigurationTarget.WorkspaceFolder:r.workspaceValue!==void 0?n=Yl.ConfigurationTarget.Workspace:n=Yl.ConfigurationTarget.Global:n=Yl.ConfigurationTarget.Global,n}_setAdvancedConfig(r,n){let o=this.config.get(r.firstPart);return o?o[r.secondPart]=n:o={[r.secondPart]:n},this.config.update(r.firstPart,o,this._getTargetFromInspect(this.config.inspect(r.firstPart)))}_setRegularConfig(r,n){return this.config.update(r.id,n,this._getTargetFromInspect(this.config.inspect(r.id)))}setConfig(r,n){return r.firstPart==="advanced"?this._setAdvancedConfig(r,n):this._setRegularConfig(r,n)}async getExperimentBasedConfig(r,n){let o=this._getConfiguredValue(r);if(o!==void 0)return o;let s=await n.getTreatmentVariableAsync("vscode",`copilotchat.config.${r.id}`,!0);return s!==void 0?s:r.defaultValue}_getConfiguredValue(r){if(this.config[r.firstPart]&&this.config[r.firstPart][r.secondPart]!==void 0)return this.config[r.firstPart][r.secondPart];let n=this.config.get(r.id);if(n!==void 0)return n}dumpConfig(){let r={};try{let n=Ra.contributes.configuration?.properties??{};for(let o in n){let a=o.replace(`${Bm}.`,"").split(".").reduce((c,u)=>c[u],this.config);typeof a=="object"&&a!==null?Object.keys(a).filter(c=>c!=="secret_key").forEach(c=>r[`${o}.${c}`]=Mne(a[c])):r[o]=Mne(a)}}catch(n){console.error(`Failed to retrieve configuration properties ${n}`)}return r}};var z_=se("IDebugOutputService");var EU=require("vscode"),Fne=[];function Une(){return Fne.join(`
`)}function ILe(t,e){t.push(CLe(e)),t.length>40&&t.shift()}var CU=class{constructor(e){this.session=e}onWillStartSession(){}onWillReceiveMessage(e){}onDidSendMessage(e){if(EU.debug.activeDebugSession!==this.session)return;let r=this.extractOutput(e);r&&ILe(Fne,r)}extractOutput(e){if(e.event==="output"&&(e.body.category==="stdout"||e.body.category==="stderr"))return e.body.output}onWillStopSession(){}onError(e){}onExit(e,r){}};function CLe(t){let e=/(:?\x1b\[|\x9B)[=?>!]?[\d;:]*["$#'* ]?[a-zA-Z@^`{}|~]/g;return t&&(t=t.replace(e,"")),t}function Bne(){return[EU.debug.registerDebugAdapterTrackerFactory("*",new TU)]}var TU=class{createDebugAdapterTracker(e){return new CU(e)}};var rD=class extends St{constructor(){super();for(let e of Bne())this._register(e)}get consoleOutput(){return Une()}};var nD=se("IDevContainerConfigurationService");var iD=se("IDialogService");var qne=W(require("vscode")),oD=class{showQuickPick(e,r,n){return qne.window.showQuickPick(e,r,n)}};var Mo=se("IEmbeddingsComputer"),TLe=.72;function Hne(t,e,r,n=TLe){return e.map(([o,s])=>{let a=0;for(let c=0;c<s.length;c++)a+=s[c]*t[c];return{score:a,item:o}}).filter(o=>o.score>n).sort((o,s)=>s.score-o.score).slice(0,r).map(o=>o.item)}function eh(t,e){let r=t.reduce((s,a,c)=>s+a*e[c],0),n=Math.sqrt(t.reduce((s,a)=>s+a*a,0)),o=Math.sqrt(e.reduce((s,a)=>s+a*a,0));return r/(n*o)}var zt=se("IVSCodeExtensionContext");var on=se("IFileSystemService");var qp=se("IWorkbenchService");function wLe(t){switch(t){case"copilot-preview-ada-centralus":return"text-3-small";case"text-embedding-ada-002":default:return"text-ada-002"}}var sD=class{constructor(e,r,n,o){this.accessor=e;this.cacheType=r;this.cacheKey=n;this.cacheVersion=o;this.cacheVersionKey=`${n}-version`,this.fileSystem=e.get(on)}get cacheStorageUri(){return this.cacheType===2?this.accessor.get(zt).storageUri:this.accessor.get(zt).globalStorageUri}get cacheVersionMementoStorage(){return this.cacheType===2?this.accessor.get(zt).workspaceState:this.accessor.get(zt).globalState}async updateCache(e){if(!this.cacheStorageUri||!this.fileSystem.isWritableFileSystem(this.cacheStorageUri.scheme))return;try{await this.fileSystem.stat(this.cacheStorageUri)}catch{await this.fileSystem.createDirectory(this.cacheStorageUri)}await this.cacheVersionMementoStorage.update(this.cacheVersionKey,this.cacheVersion),this.cacheVersionMementoStorage.get(this.cacheKey)&&await this.cacheVersionMementoStorage.update(this.cacheKey,void 0);let n=lt.joinPath(this.cacheStorageUri,`${this.cacheKey}.json`);try{await(e===void 0?this.fileSystem.delete(n,{useTrash:!1}):this.fileSystem.writeFile(n,Buffer.from(JSON.stringify(e))))}catch{e!==void 0&&console.error(`Failed to write embeddings cache to ${n}`)}}async getCache(){if(!(!this.cacheStorageUri||this.cacheVersionMementoStorage.get(this.cacheVersionKey)!==this.cacheVersion))try{let r=await this.fileSystem.readFile(lt.joinPath(this.cacheStorageUri,`${this.cacheKey}.json`));return JSON.parse(r.toString())}catch{return}}async clearCache(){return this.updateCache(void 0)}},th=class t extends sD{constructor(r,n,o,s,a){super(r,n,o,s);this.remoteCacheType=a;this.fetcher=r.get(Ur),this.remoteCacheVersionKey=`${o}-version-remote`}async getRemoteContainer(){let n=(await this.accessor.get(Le).getEmbeddingsEndpoint("ada")).model;return wLe(n)}async getRemoteCacheURL(){if(!this._remoteCacheURL){let r=await this.getRemoteContainer();this._remoteCacheURL=t.calculateRemoteCDNURL(r,this.remoteCacheType,this.cacheVersion)}return this._remoteCacheURL}async getRemoteCacheLatestUpdateURL(){if(!this._remoteCacheLatestUpdateURL){let r=await this.getRemoteContainer();this._remoteCacheLatestUpdateURL=t.calculateRemoteCDNLatestURL(r,this.remoteCacheType,this.cacheVersion)}return this._remoteCacheLatestUpdateURL}async fetchRemoteCache(){if(this._remoteCache)return this._remoteCache;let r=await this.getRemoteCacheURL();try{let n=await this.getRemoteCacheURL(),o=await this.fetcher.fetch(n,{method:"GET"});if(o.ok)return this._remoteCache=await o.json(),this._remoteCache;console.error(`Failed to fetch remote embeddings cache from ${n}`);return}catch{console.error(`Failed to fetch remote embeddings cache from ${r}`);return}}async fetchRemoteCacheLatest(){let r=await this.getRemoteCacheLatestUpdateURL();try{let n=await this.fetcher.fetch(r,{method:"GET"});if(n.ok)return n.text();console.error(`Failed to fetch remote embeddings cache from ${r}`);return}catch{console.error(`Failed to fetch remote embeddings cache from ${r}`);return}}async getCache(){let r=await this.fetchRemoteCacheLatest(),n=await super.getCache();if(n&&r===this.cacheVersionMementoStorage.get(this.remoteCacheVersionKey))return n;let o=await this.fetchRemoteCache();return await this.cacheVersionMementoStorage.update(this.remoteCacheVersionKey,r),await this.updateCache(o),o}async updateCache(r,n){if(r===void 0)return super.updateCache(r);if(!await super.getCache()||n)return super.updateCache(r)}static calculateRemoteCDNURL(r,n,o){return`https://embeddings.vscode-cdn.net/${r}/v${o}/${n}/core.json`}static calculateRemoteCDNLatestURL(r,n,o){return`https://embeddings.vscode-cdn.net/${r}/v${o}/${n}/latest.txt`}},wU=class t extends th{constructor(r,n,o,s,a){super(r,n,o,s,a);this._wasRemoteExtensionCacheUpdated=!1}async getBaseExtensionCDNURL(){if(!this._baseExtensionCDNURL){let r=await this.getRemoteContainer();this._baseExtensionCDNURL=t.calculateBaseRemoteExtensionCDNURL(r,this.remoteCacheType,this.cacheVersion)}return this._baseExtensionCDNURL}constructExposedCache(){if(!this._remoteExtensionCache)return;let r={...this._remoteExtensionCache.core};for(let n in this._remoteExtensionCache.extensions){let o=this._remoteExtensionCache.extensions[n];for(let s in o)r[s]=o[s]}return r}async fetchRemoteExtensionCache(r){let o=`${await this.getBaseExtensionCDNURL()}/${r}.json`;try{let s=await this.fetcher.fetch(o,{method:"GET"});if(s.ok)return await s.json();if(s.status===404)return{};console.error(`Failed to fetch remote embeddings cache from ${o}`);return}catch{console.error(`Failed to fetch remote embeddings cache from ${o}`);return}}async getCache(){let r=await super.getCache();if(r===void 0)return;let n={core:{},extensions:{}};r&&t.isEmbeddingsCacheEntriesWithExtensions(r)?n=r:n={core:r,extensions:{}};let o=t.getInstalledExtensionIds(this.accessor),s=!1;for(let c in n.extensions)o.includes(c)||(delete n.extensions[c],s=!0);let a=o.filter(c=>!(c in n.extensions)||n.extensions[c]===void 0);for(let c of a){let u=await this.fetchRemoteExtensionCache(c);u&&(n.extensions[c]=u)}return this._remoteExtensionCache=n,this._wasRemoteExtensionCacheUpdated=a.length>0||s,this.constructExposedCache()}async updateCache(r,n){let o=r?super.updateCache(this._remoteExtensionCache,n||this._wasRemoteExtensionCacheUpdated):super.updateCache(r,n||this._wasRemoteExtensionCacheUpdated);return this._wasRemoteExtensionCacheUpdated=!1,o}static isEmbeddingsCacheEntriesWithExtensions(r){return"core"in r&&"extensions"in r}static getInstalledExtensionIds(r){return r.get(qp).getAllExtensions().filter(n=>!n.id.startsWith("vscode")).map(n=>n.id)}static calculateBaseRemoteExtensionCDNURL(r,n,o){return`https://embeddings.vscode-cdn.net/${r}/v${o}/${n}`}},aD=class{constructor(e,r,n,o,s,a,c,u){this._endpointProvider=n;this.cacheKey=s;this.embeddingsComputer=c;this._isIndexLoaded=!1;this._logger=r.get(ce).getPromptResponseLogger(e),this._items=new Map,u?.type&&!u.supportsExtensions?this._embeddingsCache=new th(r,o,s,a,u.type):u?.type&&u.supportsExtensions?this._embeddingsCache=new wU(r,o,s,a,u.type):this._embeddingsCache=new sD(r,o,s,a)}get isIndexLoaded(){return this._isIndexLoaded}set isIndexLoaded(e){this._isIndexLoaded=e}async rebuildCache(){return await this._embeddingsCache.clearCache(),this._items.clear(),this.calculateEmbeddings()}nClosestValues(e,r){let n=Array.from(this._items.values()).map(o=>{if(!o.embedding)return{item:o,similarity:0};let s=eh(e,o.embedding);return{item:o,similarity:s}});return n=n.filter(o=>o.similarity>0),n.sort((o,s)=>s.similarity-o.similarity),n.slice(0,r).map(o=>o.item)}hasItem(e){return this._items.has(e)}getItem(e){return this._items.get(e)}async calculateEmbeddings(){return this._calculationPromise?this._calculationPromise:(this._calculationPromise=this._calculateEmbeddings(),this._calculationPromise.then(()=>this._calculationPromise=void 0))}async _calculateEmbeddings(){let e=Date.now(),r=await this.getLatestItems(),n=await this._embeddingsCache.getCache(),o=new Map;for(let s of r){let a=s,c=this._items.get(s.key),u=s.key;c?.embedding?a=c:n&&n[u]&&(a={...s,...n[u]}),o.set(u,a)}this._items=o,await this._embeddingsCache.updateCache(n),this._logger.debug(`Embeddings for ${this.cacheKey} calculated in ${Date.now()-e}ms`),this.isIndexLoaded=!0}async fetchEmbeddingsForItems(e){return this._embeddingEndpoint??=await this._endpointProvider.getEmbeddingsEndpoint("ada"),this.embeddingsComputer.computeEmbeddings(this._embeddingEndpoint,e.map(r=>this.getEmbeddingQueryString(r)),void 0)}};function _0(t){let e=t.split(".");return`${e[0]}.${e[1]}`}var cD=se("IProjectTemplatesIndex"),G_=class{constructor(e){this._isIndexLoaded=!1;let r=_0(e.get(Pt).getEditorInfo().version);this.embeddingsCache=new th(e,1,"projectTemplateEmbeddings",r,"project-templates")}async updateIndex(){this._isIndexLoaded||(this._isIndexLoaded=!0,this._embeddings=await this.embeddingsCache.getCache())}async nClosestValues(e,r,n=0){if(await this.updateIndex(),!this._embeddings)return[];let o=Object.entries(this._embeddings).map(s=>{if(!s[1].embedding)return{key:`${s[0]}`,similarity:0};let a=eh(e,s[1].embedding);return{key:`${s[0]} `,similarity:a}});return o=o.filter(s=>s.similarity>n),o.sort((s,a)=>a.similarity-s.similarity),o.slice(0,r).map(s=>s.key)}};G_=B([T(0,rt)],G_);function AU(t){let e=`Setting Id: ${t.key}
`;if(e+=`Type: ${t.type}
`,e+=`Description: ${t.description??t.markdownDescription??""}
`,t.enum){e+=`Possible values:
`;for(let r=0;r<t.enum.length;r++)e+=` - ${t.enum[r]} - ${t.enumDescriptions?.[r]??""}
`}return e+=`
`,e}var uD=class extends aD{constructor(r,n,o,s,a,c,u,l){super(r,n,n.get(Le),o,s,a,c,l);this.relatedInformationConfig=u;this.isIndexLoaded=!1,this._telemetryLogger=n.get(me)}async provideRelatedInformation(r,n){let o=Date.now();if(!this.isIndexLoaded)return this.calculateEmbeddings(),this._logger.debug(`Related Information: Index not loaded yet triggering background calculation, returning ${Date.now()-o}ms`),[];if(n.isCancellationRequested)return this._logger.debug(`Related Information: Request cancelled, returning ${Date.now()-o}ms`),[];let s=Date.now(),a=await this._endpointProvider.getEmbeddingsEndpoint("ada"),c=await this.embeddingsComputer.computeEmbeddings(a,[r],{},n);if(this._logger.debug(`Related Information: Remote similarly request took ${Date.now()-s}ms`),n.isCancellationRequested||!c||!c[0])return this._logger.debug(`Related Information: Request cancelled or no embeddings computed, returning ${Date.now()-o}ms`),[];let u=[];for(let d of this._items.values()){if(n.isCancellationRequested){this._logger.debug(`Related Information: Request cancelled, returning ${Date.now()-o}ms`);break}if(d.embedding){let p=eh(c[0],d.embedding);p>this.relatedInformationConfig.threshold&&u.push(this.toRelatedInformation(d,p))}}return this._logger.debug(`Related Information: Successfully Calculated, returning ${Date.now()-o}ms`),this.relatedInformationConfig.type===4&&this._telemetryLogger.sendInternalMSFTTelemetryEvent("relatedInformationSettings",{query:r}),u.sort((d,p)=>p.weight-d.weight).slice(0,this.relatedInformationConfig.maxResults)}},RU=class extends uD{constructor(r,n){super("CommandIdIndex",r,1,"commandEmbeddings",_0(r.get(Pt).getEditorInfo().version),n,{type:2,threshold:.7,maxResults:100},{type:"commands",supportsExtensions:!0});this.accessor=r}async getLatestItems(){let r=await this.accessor.get(qp).getAllCommands();return r.push({label:"Extensions: Search the marketplace for extensions",command:"workbench.extensions.search",keybinding:"Not set"}),r.push({label:"Extensions: Install extension from marketplace",command:"workbench.extensions.installExtension",keybinding:"Not set"}),r.map(n=>({key:n.command,label:n.label.replace("View: Toggle","View: Toggle or Show or Hide"),originalLabel:n.label,keybinding:n.keybinding??"Not set"}))}getEmbeddingQueryString(r){return`${r.label} - ${r.key}`}toRelatedInformation(r,n){return{type:2,weight:n,command:r.key}}},kU=class extends uD{constructor(r,n){super("SettingsIndex",r,1,"settingEmbeddings",_0(r.get(Pt).getEditorInfo().version),n,{type:4,threshold:.7,maxResults:100},{type:"settings",supportsExtensions:!0});this.accessor=r;this.isIndexLoaded=!1}async getLatestItems(){let r=await this.accessor.get(qp).getAllSettings(),n=[];for(let o of Object.keys(r)){let s=r[o];s.deprecationMessage||s.markdownDeprecationMessage||n.push({...s,key:o})}return n}getEmbeddingQueryString(r){return AU(r)}toRelatedInformation(r,n){return{type:4,weight:n,setting:r.key}}},Ku=se("ICombinedEmbeddingIndex"),V_=class{constructor(e){this.commandIdIndex=new RU(e,e.get(Mo)),this.settingsIndex=new kU(e,e.get(Mo))}async loadIndexes(){await Promise.all([this.commandIdIndex.isIndexLoaded?Promise.resolve():this.commandIdIndex.calculateEmbeddings(),this.settingsIndex.isIndexLoaded?Promise.resolve():this.settingsIndex.calculateEmbeddings()])}async nClosestValues(e,r){return await this.loadIndexes(),{commands:this.commandIdIndex.nClosestValues(e,r),settings:this.settingsIndex.nClosestValues(e,r)}}hasSetting(e){return this.settingsIndex.hasItem(e)}hasCommand(e){return this.commandIdIndex.hasItem(e)}getSetting(e){return this.settingsIndex.getItem(e)}getCommand(e){return this.commandIdIndex.getItem(e)}};V_=B([T(0,rt)],V_);var lD=se("IGitCommitMessageService");var ka=se("IGitExtensionService");var Fo=se("IGitService");function $_(t){if(!t)return;if(t.remoteFetchUrls?.length===1)return PU(t.remoteFetchUrls[0]);let e=t.remotes.findIndex(n=>n===t.upstreamRemote);if(e!==-1){let n=t.remoteFetchUrls?.[e];if(n){let o=PU(n);if(o)return o}}let r=t.remotes.findIndex(n=>n==="origin");if(r!==-1){let n=t.remoteFetchUrls?.[r];if(n){let o=PU(n);if(o)return o}}}function PU(t){t=t.replace(/^git@/,"").replace(/\.git$/,"");try{let e=lt.parse(t);if(e.authority!=="github.com"&&e.scheme!=="github.com")return;let r=e.path.replace(/^\//,"").trim(),[n,o,s]=r.split("/");return n&&o?`${n}/${o}`:void 0}catch{return}}function Gne(t){if(t.includes("@")&&t.includes(":")){let e="https://"+t.substring(t.indexOf("@")+1).replace(":","/"),r=new URL(e);return r.username="",r.password="",r.search="",r.toString()}else{let e=new URL(t);return e.protocol="https",e.username="",e.password="",e.search="",e.toString()}}var rh=W(require("vscode"));var W_=class{constructor(e){this._onDidChange=new rh.EventEmitter;this.onDidChange=this._onDidChange.event;this._extensionEnablement=void 0;this._disposables=[];this._logger=e.getLogger("gitExtensionService"),this._logger.info("Initializing Git extension service."),this._disposables.push(...this._initializeExtensionApi())}getExtensionApi(){return this._api}get extensionAvaiable(){return this._extensionEnablement===void 0?!!rh.extensions.getExtension("vscode.git"):this._extensionEnablement}_initializeExtensionApi(){let e=[],r=rh.extensions.getExtension("vscode.git"),n=async()=>{let o;try{o=await r.activate(),this._logger.info("Successfully activated the vscode.git extension.")}catch(a){this._logger.error("Failed to activate the vscode.git extension.",a);return}let s=a=>{this._logger.info(`Enablement state of the vscode.git extension: ${a}.`),this._extensionEnablement=a,a?(this._api=o.getAPI(1),this._onDidChange.fire({enabled:!0}),this._logger.info("Successfully registered Git commit message provider.")):(this._api=void 0,this._onDidChange.fire({enabled:!1}))};e.push(o.onDidChangeEnablement(s)),s(o.enabled)};if(r)n();else{this._logger.info("vscode.git extension is not yet activated.");let o=rh.extensions.onDidChange(()=>{!r&&rh.extensions.getExtension("vscode.git")&&(r=rh.extensions.getExtension("vscode.git"),n(),o.dispose())})}return e}};W_=B([T(0,ce)],W_);var DU=W(require("vscode"));var Yu=class extends St{constructor(r){super();this.gitExtensionService=r;this._onDidOpenRepository=new Ht;this.onDidOpenRepository=this._onDidOpenRepository.event;this._onDidCloseRepository=new Ht;this.onDidCloseRepository=this._onDidCloseRepository.event;this._onDidFinishInitialRepositoryDiscovery=new Ht;this.onDidFinishInitialization=this._onDidFinishInitialRepositoryDiscovery.event;this._isInitialized=!1;this._register(this._onDidOpenRepository),this._register(this._onDidCloseRepository),this._register(this._onDidFinishInitialRepositoryDiscovery);let n=this.gitExtensionService.getExtensionApi();n?this.registerGitAPIListeners(n):this._register(this.gitExtensionService.onDidChange(o=>{if(o.enabled){let s=this.gitExtensionService.getExtensionApi();s&&this.registerGitAPIListeners(s)}else this._onDidFinishInitialRepositoryDiscovery.fire()}))}registerGitAPIListeners(r){this._register(r.onDidOpenRepository(n=>{let o=Yu.repoToRepoContext(n);o&&this._onDidOpenRepository.fire(o)})),this._register(r.onDidCloseRepository(n=>{let o=Yu.repoToRepoContext(n);o&&this._onDidCloseRepository.fire(o)})),r.state==="initialized"&&(this._onDidFinishInitialRepositoryDiscovery.fire(),this._isInitialized=!0),this._register(r.onDidChangeState(n=>{n==="initialized"&&(this._onDidFinishInitialRepositoryDiscovery.fire(),this._isInitialized=!0)}))}get isInitialized(){return this._isInitialized}getRepository(r){let n=this.gitExtensionService.getExtensionApi();if(n)return Yu.repoToRepoContext(n.getRepository(r))}async initialize(){if(this._isInitialized)return;let r=DU.workspace.workspaceFolders;if(!r)return;let n=this.gitExtensionService.getExtensionApi();if(n)for(let o of r)await n.openRepository(o.uri).catch(()=>{})}static repoToRepoContext(r){if(r)return{rootUri:r.rootUri,headBranchName:r.state.HEAD?.name,upstreamBranchName:r.state.HEAD?.upstream?.name,upstreamRemote:r.state.HEAD?.upstream?.remote,isRebasing:r.state.rebaseCommit!==null,remotes:r.state.remotes.map(n=>n.name),remoteFetchUrls:r.state.remotes.map(n=>n.fetchUrl)}}get repositories(){if(!DU.workspace.workspaceFolders)return[];let n=this.gitExtensionService.getExtensionApi();return n?Kt(n.repositories.map(o=>Yu.repoToRepoContext(o))):[]}};Yu=B([T(0,ka)],Yu);var zc=se("IGithubRepositoryService"),dD=se("IOctoKitService");var K_=class{constructor(e,r,n){this._authService=e;this._domainService=r;this._fetcherService=n}async getCurrentAuthedUser(){let e=(await this._authService.getAnyGitHubSession())?.accessToken;if(!e)return;let r=await this._fetcherService.fetch(`${this._domainService.dotComAPIURL}/user`,{method:"GET",headers:{Accept:"application/vnd.github+json","X-GitHub-Api-Version":"2022-11-28",Authorization:`Bearer ${e}`}});if(r.ok)try{return await r.json()}catch{return}}async getTeamMembership(e){let r=await this._authService.getAnyGitHubSession(),n=r?.accessToken,o=r?.account.label;if(!n||!o)return;let s=await this._fetcherService.fetch(`${this._domainService.dotComAPIURL}/teams/${e}/memberships/${o}`,{method:"GET",headers:{Accept:"application/vnd.github.v3+json",Authorization:`Bearer ${n}`}});if(!s.ok)return!1;try{return await s.json()}catch{return}}};K_=B([T(0,fn),T(1,Ln),T(2,Ur)],K_);var Y_=class{constructor(e){this.accessor=e;this.githubRepositoryInfoCache=new Map;this.fetcherService=e.get(Ur)}async _doGetRepositoryInfo(e,r){let n=this.accessor.get(fn).anyGitHubSession?.accessToken,o={Accept:"application/vnd.github+json","X-GitHub-Api-Version":"2022-11-28"};return n&&(o.Authorization=`Bearer ${n}`),this.fetcherService.fetch(`https://api.github.com/repos/${e}/${r}`,{method:"GET",headers:o})}async getRepositoryInfo(e,r){let n=this.githubRepositoryInfoCache.get(`${e}/${r}`);if(n)return n;let o=await this._doGetRepositoryInfo(e,r);if(o.ok){let s=await o.json();return this.githubRepositoryInfoCache.set(`${e}/${r}`,s),s}throw new Error(`Failed to fetch repository info for ${e}/${r}`)}async isAvailable(e,r){try{return(await this._doGetRepositoryInfo(e,r)).ok}catch{return!1}}async getRepositoryItems(e,r,n){let o=[];try{let s=this.accessor.get(fn).permissiveGitHubSession?.accessToken,a=n.split("/").map(u=>encodeURIComponent(u)).join("/"),c=await this.fetcherService.fetch(`https://api.github.com/repos/${e}/${r}/contents/${a}`,{method:"GET",headers:{Accept:"application/vnd.github+json","X-GitHub-Api-Version":"2022-11-28",Authorization:`Bearer ${s}`}});if(c.ok){let u=await c.json();if(Array.isArray(u))for(let l of u)"name"in l&&"path"in l&&"type"in l&&"html_url"in l&&(o.push({name:l.name,path:l.path,type:l.type,html_url:l.html_url}),l.type==="dir"&&o.push(...await this.getRepositoryItems(e,r,l.path)))}else return console.error(`Failed to fetch contents from ${e}:${r}:${n}`),[]}catch{return console.error(`Failed to fetch contents from ${e}:${r}:${n}`),[]}return o}async getRepositoryItemContent(e,r,n){try{let o=this.accessor.get(fn).permissiveGitHubSession?.accessToken,s=n.split("/").map(c=>encodeURIComponent(c)).join("/"),a=await this.fetcherService.fetch(`https://api.github.com/repos/${e}/${r}/contents/${s}`,{method:"GET",headers:{Accept:"application/vnd.github+json","X-GitHub-Api-Version":"2022-11-28",Authorization:`Bearer ${o}`}});if(a.ok){let c=await a.json();if("content"in c){let u=Buffer.from(c.content,"base64");return new Uint8Array(u)}throw new Error("Unexpected data from GitHub")}}catch{console.error(`Failed to contents from ${e}:${r}:${n}`)}}};Y_=B([T(0,rt)],Y_);var pD=`

**Note:** Some files were excluded from the context due to content exclusion rules. Click [here](https://docs.github.com/en/copilot/managing-github-copilot-in-your-organization/configuring-content-exclusions-for-github-copilot) to learn more.`,De=se("IIgnoreService"),Vne=class t{static{this.Instance=new t}dispose(){}async init(){}async isCopilotIgnored(e){return!1}async asMinimatchPattern(){}async sessionInfo(){return""}};var ho=se("ILanguageDiagnosticService"),Q_=class{constructor(e){this._ignoreService=e}waitForNewDiagnostics(e,r,n=5e3){let o,s,a;return new Promise(c=>{o=r.onCancellationRequested(()=>c([])),a=setTimeout(()=>c(this.getDiagnostics(e)),n),s=this.onDidChangeDiagnostics(u=>{for(let l of u.uris)if(T_(l,e)){c(this.getDiagnostics(e));break}})}).finally(()=>{o.dispose(),s.dispose(),clearTimeout(a)})}};Q_=B([T(0,De)],Q_);function $ne(t){return t.map(e=>e.range).reduce((e,r)=>e.union(r))}function Wne(t){return t.severity===R_.Error}function NU(t,e,r=[R_.Error,R_.Warning]){return t.find(n=>n.range.contains(e)&&r.includes(n.severity))}var Di=se("ILanguageFeaturesService");function Hp(t){return typeof t=="object"&&t!==null&&"targetUri"in t}var LU=W(require("vscode"));var fD=class extends Q_{constructor(){super(...arguments);this.onDidChangeDiagnostics=LU.languages.onDidChangeDiagnostics}getDiagnostics(r){return LU.languages.getDiagnostics(r)}};var nh=W(require("vscode")),mD=class{constructor(){}async getDefinitions(e,r){return await nh.commands.executeCommand("vscode.executeDefinitionProvider",e,r)}async getImplementations(e,r){return await nh.commands.executeCommand("vscode.executeImplementationProvider",e,r)}async getReferences(e,r){return await nh.commands.executeCommand("vscode.executeReferenceProvider",e,r)}async getWorkspaceSymbols(e){return await nh.commands.executeCommand("vscode.executeWorkspaceSymbolProvider",e)}async getDocumentSymbols(e){return await nh.commands.executeCommand("vscode.executeDocumentSymbolProvider",e)}getDiagnostics(e){return nh.languages.getDiagnostics(e)}};var hD=se("IKerberosLoader");var gD=se("IWindowsCaCertsLoader");var OU=W(require("vscode")),vD=class{async loadKerberos(){try{return require(`${OU.env.appRoot}/node_modules.asar/kerberos`)}catch{}try{return require(`${OU.env.appRoot}/node_modules/kerberos`)}catch{}}};var Kne=W(require("os")),MU=W(require("vscode")),yD=class{async loadCaCerts(){let e=await this.loadBuiltInWinCAModule(),r=new Set,n=new e.Crypt32;try{let o;for(;o=n.next();)r.add(RLe(o))}finally{n.done()}return Array.from(r)}async loadBuiltInWinCAModule(){try{return require(`${MU.env.appRoot}/node_modules.asar/@vscode/windows-ca-certs`)}catch{}try{return require(`${MU.env.appRoot}/node_modules/@vscode/windows-ca-certs`)}catch{}}};function RLe(t){let e=["-----BEGIN CERTIFICATE-----"],r=t.toString("base64");for(let n=0;n<r.length;n+=64)e.push(r.substr(n,64));return e.push("-----END CERTIFICATE-----",""),e.join(Kne.EOL)}var X_=se("INotebookService");var J_=require("vscode");var Yne=require("vscode");var bD=class{constructor(){this._onDidChangeNotebookCellExecutionStateEmitter=new Ht;this.onDidChangeNotebookCellExecutionState=this._onDidChangeNotebookCellExecutionStateEmitter.event;this._disposables=[];this._cellExecution=new WeakMap;this._disposables.push(Yne.workspace.onDidChangeNotebookDocument(e=>{for(let r of e.cellChanges)r.executionSummary&&(r.executionSummary.success===void 0?this._cellExecution.has(r.cell)||(this._cellExecution.set(r.cell,!0),this._onDidChangeNotebookCellExecutionStateEmitter.fire({cell:r.cell,state:2})):(this._cellExecution.delete(r.cell),this._onDidChangeNotebookCellExecutionStateEmitter.fire({cell:r.cell,state:1})))}))}dispose(){this._disposables.forEach(e=>e.dispose())}};var _D=class{constructor(){this._cellExecution=new Map;this._executionService=new bD;this._disposables=[];this._registerExecutionListener()}_hasJupyterExtension(){return J_.extensions.getExtension("ms-toolsai.jupyter")?.isActive}async getVariables(e){if(!this._hasJupyterExtension())try{let r=await J_.commands.executeCommand("vscode.executeNotebookVariableProvider",e);return r&&Array.isArray(r)?r.map(this._convertResult):[]}catch{return[]}try{let r=await J_.commands.executeCommand("jupyter.listVariables",e);return r&&Array.isArray(r)?r.map(this._convertResult):[]}catch{return[]}}_convertResult(e){return"variable"in e?e:{variable:e,hasNamedChildren:!1,indexedChildrenCount:0}}async getPipPackages(e){if(!this._hasJupyterExtension())return[];try{return await J_.commands.executeCommand("jupyter.listPipPackages",e)}catch{return[]}}setVariables(e,r){}_registerExecutionListener(){this._disposables.push(this._executionService.onDidChangeNotebookCellExecutionState(e=>{let r=e.cell,o=r.notebook.uri.toString(),s=this._cellExecution.get(o);s||(s=[],this._cellExecution.set(o,s));let a=s.findIndex(c=>c.cell===r);a!==-1&&s.splice(a,1),s.push({cell:r,executionCount:r.executionSummary?.executionOrder})}))}getCellExecutions(e){return this._cellExecution.get(e.toString())?.map(r=>r.cell)||[]}dispose(){this._disposables.forEach(e=>e.dispose())}};var Qne=require("vscode"),xD=class{async showWarningMessage(e,...r){return{title:await Qne.window.showWarningMessage(e,...r.map(o=>o.title))}}};var Sie=W(require("path"));var Xne=require("worker_threads"),FU=class{constructor(e,r,n){this.logger=n;this.handlers=new Map;this.nextId=1;this.worker=new Xne.Worker(e,r),this.worker.on("message",({id:o,err:s,res:a})=>{let c=this.handlers.get(o);c&&(this.handlers.delete(o),s?c.reject(s):c.resolve(a))}),this.worker.on("error",o=>this.handleError(o)),this.worker.on("exit",o=>{o!==0&&this.handleError(new Error(`Worker thread exited with code ${o}.`))})}terminate(){this.worker.removeAllListeners(),this.worker.terminate(),this.handlers.clear()}handleError(e){this.logger?.exception(e);for(let r of this.handlers.values())r.reject(e);this.handlers.clear()}remoteCall(e,r){let n=this.nextId++,o,s,a=new Promise((c,u)=>{o=c,s=u});return this.handlers.set(n,{resolve:o,reject:s}),this.worker.postMessage({id:n,fn:e,args:r}),a}},ih=class{constructor(e,r,n){this.worker=new FU(e,r,n);let o={get:(s,a)=>(typeof a=="string"&&!s[a]&&(s[a]=(...c)=>{if(!this.worker)throw new Error("Worker was terminated!");return this.worker.remoteCall(a,c)}),s[a])};this.proxy=new Proxy(Object.create(null),o)}terminate(){this.worker.terminate()}};var XU={};dn(XU,{_clean:()=>DLe,_extractDoc:()=>i4e,_getCallExpressions:()=>qLe,_getClassDeclarations:()=>jLe,_getClassReferences:()=>VLe,_getCoarseParentScope:()=>QLe,_getDocumentableNodeIfOnIdentifier:()=>JLe,_getFineScopes:()=>e4e,_getFixSelectionOfInterest:()=>XLe,_getFunctionBodies:()=>YLe,_getFunctionDefinitions:()=>HLe,_getFunctionPositions:()=>KLe,_getNodeMatchingSelection:()=>TD,_getNodeToDocument:()=>t4e,_getNodeToExplain:()=>r4e,_getSemanticChunkTree:()=>WLe,_getStructure:()=>s4e,_getSymbols:()=>$Le,_getTestableNode:()=>ZLe,_getTypeDeclarations:()=>zLe,_getTypeReferences:()=>GLe,_parse:()=>Zi});var OE=W(require("path"));function Jne(t,e,r){let n=0,o=t.length;for(;n<o;){let s=n+o>>>1;r(t[s],e)?n=s+1:o=s}return n}function NE(t,e){if(t.length===0)return;let r=t[0];for(let n=1;n<t.length;n++){let o=t[n];e(o,r)>0&&(r=o)}return r}var UU=class{constructor(e=10){this.values=new Map;this.lruKeys=[];if(e<1)throw new Error("Cache size must be at least 1");this.size=e}removeKeyFromLRU(e){let r=this.lruKeys.indexOf(e);r!==-1&&this.lruKeys.splice(r,1)}touchKeyInLRU(e){this.removeKeyFromLRU(e),this.lruKeys.push(e)}clear(){this.values.clear(),this.lruKeys=[]}deleteKey(e){this.removeKeyFromLRU(e);let r=this.values.get(e);return r!==void 0&&this.values.delete(e),r}get(e){if(this.values.has(e)){let r=this.values.get(e);return this.touchKeyInLRU(e),r}}keys(){return this.lruKeys.slice()}getValues(){return this.values.values()}put(e,r){let n;if(!this.values.has(e)&&this.lruKeys.length===this.size){let o=this.lruKeys.shift(),s=this.deleteKey(o);n=[o,s]}return this.values.set(e,r),this.touchKeyInLRU(e),n}},SD=class{constructor(e){this.actual=new UU(e)}dispose(){this.clear()}clear(){let e=this.actual.getValues();for(let r of e)r.dispose();this.actual.clear()}deleteKey(e){let r=this.actual.deleteKey(e);r&&r.dispose()}get(e){return this.actual.get(e)}keys(){return this.actual.keys()}getValues(){return this.actual.getValues()}put(e,r){let n=this.actual.put(e,r);n&&n[1].dispose()}};var Ji={doesContain:(t,e)=>t.startIndex<=e.startIndex&&e.endIndex<=t.endIndex,ofSyntaxNode:t=>({startIndex:t.startIndex,endIndex:t.endIndex}),compare:(t,e)=>t.startIndex-e.startIndex||e.endIndex-t.endIndex,isEqual:(t,e)=>Ji.compare(t,e)===0,doIntersect:(t,e)=>{let r=Math.max(t.startIndex,e.startIndex),n=Math.min(t.endIndex,e.endIndex);return r<n},len:t=>t.endIndex-t.startIndex,intersectionSize:(t,e)=>{let r=Math.max(t.startIndex,e.startIndex),n=Math.min(t.endIndex,e.endIndex);return Math.max(n-r,0)},isTreeSitterOffsetRange(t){return typeof t.startIndex=="number"&&typeof t.endIndex=="number"}},Qu={isEqual(t,e){return t.row===e.row&&t.column===e.column},isBefore(t,e){return t.row<e.row||t.row===e.row&&t.column<e.column},isAfter(t,e){return Qu.isBefore(e,t)},isBeforeOrEqual(t,e){let r=Qu.isBefore(t,e),n=Qu.isEqual(t,e);return!!(r||n)},equals(t,e){return t.column===e.column&&t.row===e.row},isAfterOrEqual(t,e){return Qu.isBeforeOrEqual(e,t)},ofPoint:t=>({row:t.row,column:t.column})},oh={doesContain:(t,e)=>Qu.isBeforeOrEqual(t.startPosition,e.startPosition)&&Qu.isAfterOrEqual(t.endPosition,e.endPosition),equals:(t,e)=>Qu.equals(t.startPosition,e.startPosition)&&Qu.equals(t.endPosition,e.endPosition),ofSyntaxNode:t=>({startPosition:t.startPosition,endPosition:t.endPosition})},ID={ofSyntaxNode:t=>({type:t.type,startIndex:t.startIndex,endIndex:t.endIndex})},Xu={ofSyntaxNode:t=>({range:oh.ofSyntaxNode(t),startIndex:t.startIndex,text:t.text,endIndex:t.endIndex})},Ql=class{constructor(e,r,n,o){this.startIndex=e;this.endIndex=r;this.kind=n;this.children=o;if(e>r)throw new Qr("startIndex must be less than endIndex");let s=e;for(let a of o){if(a.startIndex<s)throw new Qr("Invalid child startIndex");if(a.endIndex>r)throw new Qr("Invalid child endIndex");s=Math.max(a.endIndex,s)}}toString(){let e=[];function r(n,o=""){e.push(`${o}${n.kind} [${n.startIndex}, ${n.endIndex}]`),n.children.forEach(s=>r(s,o+"    "))}return r(this),e.join(`
`)}};var CD=class{constructor(e,r){this.syntaxTreeRoot=r;this.roots=[];this.formTree(e)}formTree(e){e.sort((s,a)=>s.mainBlock.startIndex-a.mainBlock.startIndex||s.mainBlock.endIndex-a.mainBlock.endIndex);let r=[],n=()=>r[r.length-1],o=(s,a)=>s.mainBlock.startIndex===a.mainBlock.startIndex&&s.mainBlock.endIndex===a.mainBlock.endIndex;for(let s of e){let a={info:s,children:[]},c=n();if(!c){this.roots.push(a),r.push(a);continue}if(!o(c.info,s)){for(;c&&!Ji.doesContain(c.info.mainBlock,s.mainBlock);)r.pop(),c=n();c?c.children.push(a):this.roots.push(a),r.push(a)}}}};var Er=(()=>{function t(e,...r){return e.length===1?e[0]:e.reduce((n,o,s)=>`${n}${o}${r[s]||""}`,"")}return{typescript:t,javascript:t,python:t,go:t,ruby:t,csharp:t,cpp:t,java:t,rust:t}})();function Gc(t,e){return Object.fromEntries(t.map(r=>[r,e]))}var kLe={javascript:[],typescript:[],tsx:[],python:[],csharp:[],go:[],java:[],ruby:[],cpp:[],rust:[]};function Vc(t){for(let e in t){let r=t[e];kLe[e].push(...r)}return t}var Zne=Vc({...Gc(["javascript","typescript","tsx"],[`[
			(call_expression
				function: (identifier) @identifier)
			(call_expression
				function: (member_expression
					(property_identifier) @identifier))
		] @call_expression`]),python:[`[
			(call
				function: (identifier) @identifier)
			(call
				function: (attribute
					attribute: (identifier) @identifier))
		] @call_expression`],csharp:[`[
			(invocation_expression
				function: (identifier) @identifier)
			(invocation_expression
				function: (member_access_expression
					name: (identifier) @identifier))
		] @call_expression`],go:[`[
			(call_expression
				((selector_expression
					(field_identifier) @identifier)))
			(call_expression
				(identifier) @identifier)
		] @call_expression`],java:[`[
			(method_invocation
				name: (identifier) @identifier)
		] @call_expression`],ruby:[`[
			(call (identifier) @identifier
				(#not-match? @identifier "new|send|public_send|method"))
			(call
				receiver: (identifier)
				method: (identifier) @method
				(#match? @method "^(send|public_send|method)")
				arguments: (argument_list
					(simple_symbol) @symbol))
		] @call_expression`],cpp:[`[
			(function_declarator
				(identifier) @identifier)
			(function_declarator
				(field_identifier) @identifier)
			(call_expression (identifier) @identifier)
			(call_expression
				(field_expression
					field: (field_identifier) @identifier))
			(call_expression
				(call_expression
					(primitive_type)
					(argument_list
						(pointer_expression
						(identifier) @identifier))))
		] @call_expression`],rust:[`[
			(call_expression (identifier) @identifier)
			(call_expression (field_expression (identifier) (field_identifier) @identifier))
			(call_expression (scoped_identifier (identifier) (identifier) @identifier (#not-match? @identifier "new")))
		] @call_expression`]}),eie=Vc({...Gc(["javascript","typescript","tsx"],["(class_declaration) @class_declaration"]),java:["(class_declaration) @class_declaration"],csharp:["(class_declaration) @class_declaration"],python:["(class_definition) @class_declaration"],cpp:["(class_specifier) @class_declaration"],ruby:["(class) @class_declaration"],go:[`(type_declaration
			(type_spec
				(type_identifier) @type_identifier)) @class_declaration`],rust:["(impl_item (type_identifier) @type_identifier) @class_declaration"]}),tie=Vc({typescript:[`[
			(interface_declaration)
			(type_alias_declaration)
		] @type_declaration`],csharp:[`(interface_declaration
			(identifier) @type_identifier) @type_declaration`],cpp:[`[
			(struct_specifier
				(type_identifier) @type_identifier)
			(union_specifier
				(type_identifier) @type_identifier)
			(enum_specifier
				(type_identifier) @type_identifier)
		] @type_declaration`],java:[`(interface_declaration
			(identifier) @type_identifier) @type_declaration`],go:[`(type_declaration
			(type_spec
				(type_identifier) @type_identifier)) @type_declaration`],ruby:["((constant) @type_identifier) @type_declaration"],python:[`(class_definition
			(identifier) @type_identifier) @type_declaration`]}),rie=Vc({typescript:["(type_identifier) @type_identifier"],go:["(type_identifier) @type_identifier"],ruby:["(constant) @type_identifier"],csharp:[`[
			(base_list
				(identifier) @type_identifier)
			(variable_declaration
				(identifier) @type_identifier)
		]`],cpp:["(type_identifier) @type_identifier"],java:["(type_identifier) @type_identifier"],python:[`[
			(type (identifier) @type_identifier)
			(argument_list
				(identifier) @type_identifier)
		]`]}),nie=Vc({...Gc(["javascript","typescript","tsx"],[`(new_expression
			constructor: (identifier) @new_expression)`]),python:[`(call
			function: (identifier) @new_expression)`],csharp:[`(object_creation_expression
			(identifier) @new_expression)`],java:[`(object_creation_expression
			(type_identifier) @new_expression)`],cpp:[`[
			(declaration
				(type_identifier) @new_expression)
			(class_specifier
				(type_identifier) @new_expression)
		]`],go:["(composite_literal (type_identifier) @new_expression)"],ruby:[`((call
			receiver: ((constant) @new_expression)
			method: (identifier) @method)
				(#eq? @method "new"))`],rust:[`(call_expression
			(scoped_identifier
				(identifier) @new_expression
				(identifier) @identifier
				(#eq? @identifier "new")))`]}),iie=Vc({python:[`[
			(function_definition
				name: (identifier) @identifier
				body: (block
						(expression_statement (string))? @docstring) @body)
			(assignment
				left: (identifier) @identifier
				right: (lambda) @body)
		] @function`,'(ERROR ("def" (identifier) (parameters))) @function'],...Gc(["javascript","typescript","tsx"],[`[
			(function_expression
				name: (identifier)? @identifier
				body: (statement_block) @body)
			(function_declaration
				name: (identifier)? @identifier
				body: (statement_block) @body)
			(generator_function
				name: (identifier)? @identifier
				body: (statement_block) @body)
			(generator_function_declaration
				name: (identifier)? @identifier
				body: (statement_block) @body)
			(method_definition
				name: (property_identifier)? @identifier
				body: (statement_block) @body)
			(arrow_function
				body: (statement_block) @body)
		] @function`]),go:[`[
			(function_declaration
				name: (identifier) @identifier
				body: (block) @body)
			(method_declaration
				name: (field_identifier) @identifier
				body: (block) @body)
		] @function`],ruby:[`[
			(method
				name: (_) @identifier
				parameters: (method_parameters)? @params
				[(_)+ "end"] @body)
			(singleton_method
				name: (_) @identifier
				parameters: (method_parameters)? @params
				[(_)+ "end"] @body)
		] @function`],csharp:[`[
			(constructor_declaration
				(identifier) @identifier
				(block) @body)
			(destructor_declaration
				(identifier) @identifier
				(block) @body)
			(operator_declaration
				(block) @body)
			(method_declaration
				(identifier) @identifier
				(block) @body)
			(local_function_statement
				(identifier) @identifier
				(block) @body)
		] @function`],cpp:[`[
			(function_definition
				(_
					(identifier) @identifier)
					(compound_statement) @body)
			(function_definition
				(function_declarator
					(qualified_identifier
						(identifier) @identifier))
					(compound_statement) @body)
		] @function`],java:[`[
			(constructor_declaration
				name: (identifier) @identifier
				body: (constructor_body) @body)
			(method_declaration
				name: (_) @identifier
				body: (block) @body)
			(lambda_expression
				body: (block) @body)
		] @function`],rust:[`[
			(function_item (identifier) @identifier)
			(let_declaration (identifier) @identifier)
		] @function`]}),oie=Vc({javascript:[Er.javascript`((comment) @comment
			(#match? @comment "^\\\\/\\\\*\\\\*")) @docComment`],...Gc(["typescript","tsx"],[Er.typescript`((comment) @comment
			(#match? @comment "^\\\\/\\\\*\\\\*")) @docComment`]),java:[Er.java`((block_comment) @block_comment
			(#match? @block_comment "^\\\\/\\\\*\\\\*")) @docComment`],cpp:[Er.cpp`((comment) @comment
			(#match? @comment "^\\\\/\\\\*\\\\*")) @docComment`],csharp:[Er.csharp`(
			((comment) @c
				(#match? @c "^\\\\/\\\\/\\\\/"))+
		) @docComment`],rust:[Er.rust`((line_comment) @comment
			(#match? @comment "^\/\/\/|^\/\/!"))+ @docComment`],go:[Er.go`((comment)+) @docComment`],ruby:[Er.ruby`((comment)+) @docComment`],python:[`(expression_statement
			(string) @docComment)`]}),sie=Vc({javascript:[Er.javascript`[
			(function_declaration
				(identifier) @function.identifier
			) @function

			(generator_function_declaration
				name: (identifier) @generator_function.identifier
			) @generator_function

			(class_declaration
				name: (identifier) @class.identifier ;; note: (type_identifier) in typescript
				body: (class_body
							(method_definition
								name: (property_identifier) @method.identifier
							) @method
						)
			) @class
		]`],...Gc(["typescript","tsx"],[Er.typescript`[
				(function_declaration
					(identifier) @function.identifier
				) @function

				(generator_function_declaration
					name: (identifier) @generator_function.identifier
				) @generator_function

				(class_declaration
					name: (type_identifier) @class.identifier
					body: (class_body
								(method_definition
									name: (property_identifier) @method.identifier
								) @method
							)
				) @class
			]`]),python:[Er.python`[
				(function_definition
					name: (identifier) @function.identifier
				) @function
			]`],go:[Er.go`[
				(function_declaration
					name: (identifier) @function.identifier
				) @function

				(method_declaration
					name: (field_identifier) @method.identifier
				) @method
			]`],ruby:[Er.ruby`[
				(method
					name: (identifier) @method.identifier
				) @method

				(singleton_method
					name: (_) @singleton_method.identifier
				) @singleton_method
			]`],csharp:[Er.csharp`[
				(constructor_declaration
					(identifier) @constructor.identifier
				) @constructor

				(destructor_declaration
					(identifier) @destructor.identifier
				) @destructor

				(method_declaration
					(identifier) @method.identifier
				) @method

				(local_function_statement
					(identifier) @local_function.identifier
				) @local_function
			]`],cpp:[Er.cpp`[
				(function_definition
					(_
						(identifier) @identifier)
				) @function
			]`],java:[Er.java`(class_declaration
			body: (_
						[
							(constructor_declaration
								(modifiers)? @constructor.modifiers
								(#not-eq? @constructor.modifiers "private")
								name: (identifier) @constructor.identifier
							) @constructor

							(method_declaration
								(modifiers)? @method.modifiers
								(#not-eq? @method.modifiers "private")
								name: (identifier) @method.identifier
							) @method
						]
					)
		) @class`],rust:[Er.rust`[
				(function_item
					(identifier) @function.identifier
				) @function
			]`]}),aie=Vc({javascript:[Er.javascript`[
			(identifier) @symbol
			(property_identifier) @symbol
			(private_property_identifier) @symbol
		]`],...Gc(["typescript","tsx"],[Er.typescript`[
			(identifier) @symbol
			(type_identifier) @symbol
			(property_identifier) @symbol
			(private_property_identifier) @symbol
		]`]),cpp:[Er.cpp`[
			(identifier) @symbol
			(type_identifier) @symbol
		]`],csharp:[Er.csharp`[
			(identifier) @symbol
		]`],go:[Er.go`[
			(identifier) @symbol
		]`],java:[Er.java`[
			(identifier) @symbol
		]`],python:[Er.python`[
			(identifier) @symbol
		]`],ruby:[Er.ruby`[
			(identifier) @symbol
		]`],rust:[Er.rust`[
			(identifier) @symbol
		]`]}),cie=Vc({...Gc(["typescript","tsx"],[Er.typescript`
			[
				(comment) @comment ;; split into multiple comment kinds?

				(declaration) @declaration

				;; class declaration related
				(public_field_definition) @public_field_definition
				(method_definition) @method_definition
				(class_declaration (_ (method_signature) @method_signature))
				(abstract_method_signature) @abstract_method_signature

				;; enum declaration related
				(enum_assignment) @enum_assignment

				;; interface declaration related
				(interface_declaration (_ (method_signature) @method_signature))
				(interface_declaration (_ (property_signature) @property_signature))

				;; statements

				(import_statement) @import_statement
				(export_statement) @export_statement

				(expression_statement) @expression_statement

				(for_in_statement) @for_in_statement
				;; exclude any children found in the for loop condition
				(for_statement condition: (_) @for_statement.exclude_captures ) @for_statement
				(break_statement) @break_statement
				(continue_statement) @continue_statement
				(do_statement) @do_statement
				(if_statement) @if_statement
				(if_statement
					consequence: [
						(expression_statement)
						(if_statement)
					] @if_statement.exclude_captures)
				(else_clause
					[
						(expression_statement)
						(if_statement) ; for if-else chains
					] @else_clause.exclude_captures)
				(switch_statement) @switch_statement
				(switch_case) @switch_case
				(try_statement) @try_statement
				(throw_statement) @throw_statement
				(debugger_statement) @debugger_statement
				(return_statement) @return_statement
			]
		`]),python:[Er.python`
			[
				(comment) @comment

				;; simple statements
				(assert_statement) @assert_statement
				(break_statement) @break_statement
				(continue_statement) @continue_statement
				(delete_statement) @delete_statement
				(exec_statement) @exec_statement
				(expression_statement) @expression_statement
				(future_import_statement) @future_import_statement
				(global_statement) @global_statement
				(import_from_statement) @import_from_statement
				(import_statement) @import_statement
				(nonlocal_statement) @nonlocal_statement
				(pass_statement) @pass_statement
				(print_statement) @print_statement
				(raise_statement) @raise_statement
				(return_statement) @return_statement
				(type_alias_statement) @type_alias_statement


				;; compound statements

				(class_definition) @class_definition
				(decorated_definition) @decorated_definition
				(for_statement) @for_statement
				(function_definition) @function_definition
				(if_statement) @if_statement
				(try_statement) @try_statement
				(while_statement) @while_statement
				(with_statement) @with_statement


				;; expressions

				(expression_list) @expression_list
				(expression_statement) @expression_statement
			]
		`],javascript:[Er.javascript`
			[
				(comment) @comment ;; split into multiple comment kinds?

				(declaration) @declaration

				;; class declaration related

				(field_definition) @field_definition
				(method_definition) @method_definition

				;; statements

				(import_statement) @import_statement
				(export_statement) @export_statement

				(expression_statement) @expression_statement

				(for_in_statement) @for_in_statement
				;; exclude any children found in the for loop condition
				(for_statement condition: (_) @for_statement.exclude_captures ) @for_statement
				(break_statement) @break_statement
				(continue_statement) @continue_statement
				(do_statement) @do_statement
				(if_statement) @if_statement
				(switch_statement) @switch_statement
				(switch_case) @switch_case
				(try_statement) @try_statement
				(throw_statement) @throw_statement
				(debugger_statement) @debugger_statement
				(return_statement) @return_statement
			]`],go:[Er.go`
		[
			(_statement) @statement
			(function_declaration) @function_declaration
			(import_declaration) @import_declaration
			(method_declaration) @method_declaration
			(package_clause) @package_clause

			(if_statement
				initializer: (_) @for_statement.exclude_captures) @for_statement

			(expression_case) @expression_case ;; e.g., case 0:
		]
		`],ruby:[Er.ruby`
			[
				(comment) @comment

				(assignment) @assignment

				(if) @if

				(call) @call

				(case) @case

				(when) @when

				(while) @while

				(for) @for

				(method) @method

				(class) @class

				(module) @module

				(begin) @begin
			]
		`],csharp:[Er.csharp`
			[
				(comment) @comment

				(class_declaration) @class_declaration
				(constructor_declaration) @constructor_declaration
				(method_declaration) @method_declaration
				(delegate_declaration) @delegate_declaration
				(enum_declaration) @enum_declaration
				(extern_alias_directive) @extern_alias_directive
				(file_scoped_namespace_declaration) @file_scoped_namespace_declaration
				(global_attribute) @global_attribute
				(global_statement) @global_statement
				(interface_declaration) @interface_declaration
				(namespace_declaration) @namespace_declaration
				(record_declaration) @record_declaration
				(struct_declaration) @struct_declaration
				(using_directive) @using_directive

				(local_declaration_statement) @local_declaration_statement
				(expression_statement) @expression_statement
				(for_statement) @for_statement
				(foreach_statement) @foreach_statement
				(continue_statement) @continue_statement
				(break_statement) @break_statement
				(throw_statement) @throw_statement
				(return_statement) @return_statement
				(try_statement) @try_statement
			]
		`],cpp:[Er.cpp`
			[
				(declaration) @declaration

				(expression_statement) @expression_statement

				(comment) @comment

				(preproc_include) @preproc_include

				(namespace_definition) @namespace_definition

				(enum_specifier) @enum_specifier

				(struct_specifier) @struct_specifier

				(template_declaration) @template_declaration

				(function_definition) @function_definition

				(return_statement) @return_statement

				(class_specifier) @class_specifier

				(try_statement) @try_statement

				(throw_statement) @throw_statement

				(for_statement) @for_statement
				(for_statement
					initializer:(_) @for_statement.exclude_captures) @for_statement

				(for_range_loop) @for_range_loop
			]
		`],java:[Er.java`
		[
			(statement) @statement ;; @ulugbekna: this includes (declaration); but somehow it can't capture inner classes

			(line_comment) @line_comment
			(block_comment) @block_comment

			(for_statement
				init: (_) @for_statement.exclude_captures)

			(block) @block.exclude_captures

			(field_declaration) @field_declaration
		]
		`],rust:[]}),uie={...Gc(["typescript","tsx"],["program","interface_declaration","class_declaration","function_declaration","function_expression","type_alias_declaration","method_definition"]),javascript:["program","class_declaration","function_declaration","function_expression","method_definition"],java:["program","class_declaration","interface_declaration","method_declaration"],cpp:["translation_unit","class_specifier","function_definition"],csharp:["compilation_unit","class_declaration","interface_declaration","method_declaration"],python:["module","class_definition","function_definition"],go:["source_file","type_declaration","function_declaration","method_declaration"],ruby:["program","method","class","method"],rust:["source_file","function_item","impl_item","let_declaration"]},lie=Vc({typescript:[Xl("typescript")],tsx:[Xl("tsx")],javascript:[Xl("javascript")],java:[Xl("java")],cpp:[Xl("cpp")],csharp:[Xl("csharp")],python:[Xl("python")],go:[Xl("go")],ruby:[Xl("ruby")],rust:[Xl("rust")]}),die={...Gc(["typescript","tsx","javascript"],["for_in_statement","for_statement","if_statement","while_statement","do_statement","try_statement","switch_statement"]),java:["for_statement","enhanced_for_statement","if_statement","while_statement","do_statement","try_statement","switch_expression"],cpp:["for_statement","for_range_loop","if_statement","while_statement","do_statement","try_statement","switch_statement"],csharp:["for_statement","for_each_statement","if_statement","while_statement","do_statement","try_statement","switch_expression"],python:["for_statement","if_statement","while_statement","try_statement"],go:["for_statement","if_statement","type_switch_statement"],ruby:["while","for","if","case"],rust:["for_statement","if_statement","while_statement","loop_statement","match_expression"]},ALe={...Gc(["typescript","tsx"],["lexical_declaration","expression_statement","public_field_definition"]),javascript:["call_expression","expression_statement","variable_declaration","public_field_definition"],java:["expression_statement","local_variable_declaration","field_declaration"],cpp:["field_declaration","expression_statement","declaration"],csharp:["field_declaration","expression_statement"],python:["expression_statement"],go:["short_var_declaration","call_expression"],ruby:["call","assignment"],rust:["expression_statement","let_declaration","use_declaration","assignment_expression","macro_definition","extern_crate_declaration"]},PLe={...Gc(["typescript","tsx"],["class_declaration","function_declaration","generator_function_declaration","interface_declaration","internal_module","method_definition","abstract_class_declaration"]),javascript:["class_declaration","function_declaration","generator_function_declaration","method_definition"],java:["class_declaration","constructor_declaration","enum_declaration","interface_declaration","method_declaration","module_declaration"],cpp:["class_specifier","function_definition","namespace_definition","struct_specifier"],csharp:["class_declaration","constructor_declaration","destructor_declaration","enum_declaration","interface_declaration","method_declaration","namespace_declaration","struct_declaration"],python:["function_definition","class_definition"],go:["function_declaration","method_declaration"],ruby:["class","method","module"],rust:["function_item","impl_item","mod_item","struct_item","trait_item","union_item"]},pie=Vc({typescript:[Jl("typescript")],tsx:[Jl("tsx")],javascript:[Jl("javascript")],java:[Jl("java")],cpp:[Jl("cpp")],csharp:[Jl("csharp")],python:[Jl("python")],go:[Jl("go")],rust:[Jl("rust")],ruby:[Jl("ruby")]});function Xl(t){return uie[t].map(e=>`(${e}) @scope`).join(`
`)}function Jl(t){return`[
		${PLe[t].map(r=>`(${r})`).join(`
`)}
	] @definition`}function LE(t,e){return uie[t].includes(e.type)||die[t].includes(e.type)}function fie(t,e){return die[t].includes(e.type)}function BU(t,e){return ALe[t].includes(e.type)}var qU=mie(),HU=class{constructor(){this.loadedLanguagesCache=new Map}loadLanguage(e){return this.loadedLanguagesCache.has(e)||this.loadedLanguagesCache.set(e,this._doLoadLanguage(e)),this.loadedLanguagesCache.get(e)}_doLoadLanguage(e){let n=`tree-sitter-${e==="csharp"?"c-sharp":e}.wasm`,o=OE.basename(__dirname)==="dist"?OE.resolve(__dirname,n):OE.resolve(__dirname,"../../../../dist",n);return qU.Language.load(o)}},jU=class t{static{this.CACHE_SIZE_PER_LANGUAGE=5}constructor(){this.caches=new Map,this.languageLoader=new HU,this._parser=null}get parser(){return this._parser||(this._parser=new qU),this._parser}async parse(e,r){await qU.init();let n=this.getParseTreeCache(e),o=n.get(r);if(o)return o.createReference();let s=await this.languageLoader.loadLanguage(e);this.parser.setLanguage(s);let a=this.parser.parse(r),c=new GU(a);return n.put(r,c),c.createReference()}delete(){this._parser&&(this.parser.delete(),this._parser=null);for(let e of this.caches.values())e.dispose()}getParseTreeCache(e){let r=this.caches.get(e);return r||(r=new SD(t.CACHE_SIZE_PER_LANGUAGE),this.caches.set(e,r)),r}},zU=class{constructor(e){this._tree=e;this._refCount=1}get tree(){if(this._refCount===0)throw new Error("Cannot access disposed RefCountedParseTree");return this._tree}ref(){if(this._refCount===0)throw new Error("Cannot ref disposed RefCountedParseTree");this._refCount++}deref(){if(this._refCount===0)throw new Error("Cannot deref disposed RefCountedParseTree");this._refCount--,this._refCount===0&&this._tree.delete()}},GU=class{constructor(e){this._tree=new zU(e)}dispose(){this._tree.deref()}createReference(){return new VU(this._tree)}},VU=class{constructor(e){this._parseTree=e;this._parseTree.ref()}get tree(){return this._parseTree.tree}dispose(){this._parseTree.deref()}},vie=new jU;function DLe(){vie.delete()}function Zi(t,e){return vie.parse(t,e)}var $U=class{constructor(e){this.language=e;this.map=new Map}getQuery(e){return this.map.has(e)||this.map.set(e,this.language.query(e)),this.map.get(e)}},WU=class t{constructor(){this.map=new Map}static{this.INSTANCE=new t}getQuery(e,r){return this.map.has(e)||this.map.set(e,new $U(e)),this.map.get(e).getQuery(r)}};function $c(t,e){let r=[];for(let n of t){let o=WU.INSTANCE.getQuery(e.tree.getLanguage(),n);r.push(...o.matches(e))}return r}function NLe(t,e){let r=lie[t];return $c(r,e)}function YU(t,e){let r=iie[t];return $c(r,e)}function LLe(t,e){let r=Zne[t];return r?$c(r,e):[]}function OLe(t,e){let r=eie[t];return r?$c(r,e):[]}function MLe(t,e){let r=tie[t];return r?$c(r,e):[]}function FLe(t,e){let r=rie[t];return r?$c(r,e):[]}function ULe(t,e){let r=nie[t];return r?$c(r,e):[]}function BLe(t,e){let r=pie[t];return $c(r,e)}async function qLe(t,e,r){let n=await Zi(t,e);try{return LLe(t,n.tree.rootNode).reduce((a,c)=>{let u=c.captures.find(l=>l.name==="call_expression").node;if(Ji.doIntersect(r,u)){let l,d;t==="ruby"&&(d=c.captures.find(p=>p.name==="symbol")?.node,l=d?.text?.slice(1)),d??=c.captures.find(p=>p.name==="identifier")?.node,l??=d?.text,a.push({identifier:l??"",text:u.text,startIndex:(d??u).startIndex,endIndex:(d??u).endIndex})}return a},[])}finally{n.dispose()}}async function HLe(t,e){let r=await Zi(t,e);try{return YU(t,r.tree.rootNode).map(s=>{let a=s.captures.find(u=>u.name==="function").node;return{identifier:s.captures.find(u=>u.name==="identifier")?.node.text??"",text:a.text,startIndex:a.startIndex,endIndex:a.endIndex}})}finally{r.dispose()}}async function jLe(t,e){let r=await Zi(t,e);try{return OLe(t,r.tree.rootNode).map(s=>{let a=s.captures.find(u=>u.name==="class_declaration").node;return{identifier:a?.children.find(u=>u.type==="type_identifier"||u.type==="identifier"||u.type==="constant")?.text??"",text:a.text,startIndex:a.startIndex,endIndex:a.endIndex}})}finally{r.dispose()}}async function zLe(t,e){let r=await Zi(t,e);try{return MLe(t,r.tree.rootNode).map(s=>{let a=s.captures.find(u=>u.name==="type_declaration").node,c=s.captures.find(u=>u.name==="type_identifier")?.node.text;return c||(c=a?.children.find(u=>u.type==="type_identifier")?.text),{identifier:c??"",text:a.text,startIndex:a.startIndex,endIndex:a.endIndex}})}finally{r.dispose()}}async function GLe(t,e,r){let n=await Zi(t,e);try{return FLe(t,n.tree.rootNode).reduce((a,c)=>{let u=c.captures.find(l=>l.name==="type_identifier").node;return Ji.doIntersect(r,u)&&a.push({identifier:u.text,text:u.text,startIndex:u.startIndex,endIndex:u.endIndex}),a},[])}finally{n.dispose()}}async function VLe(t,e,r){let n=await Zi(t,e);try{return ULe(t,n.tree.rootNode).reduce((a,c)=>{let u=c.captures.find(l=>l.name==="new_expression").node;return Ji.doIntersect(r,u)&&a.push({identifier:u.text,text:u.text,startIndex:u.startIndex,endIndex:u.endIndex}),a},[])}finally{n.dispose()}}async function $Le(t,e,r){let n=await Zi(t,e);try{let o=aie[t];return $c(o,n.tree.rootNode).reduce((c,u)=>{let l=u.captures.find(d=>d.name==="symbol").node;return Ji.doIntersect(r,l)&&c.push({identifier:l.text,text:l.text,startIndex:l.startIndex,endIndex:l.endIndex}),c},[])}finally{n.dispose()}}async function WLe(t,e){let r=await Zi(t,e);try{let n=BLe(t,r.tree.rootNode);return a4e(t,n,r.tree.rootNode)}finally{r.dispose()}}async function KLe(t,e){let r=await Zi(t,e);try{return YU(t,r.tree.rootNode).map(s=>{let a=s.captures.find(c=>c.name==="function").node;return{startIndex:a.startIndex,endIndex:a.endIndex}})}finally{r.dispose()}}async function YLe(t,e){let r=await Zi(t,e);try{return YU(t,r.tree.rootNode).map(s=>{let a=s.captures.find(c=>c.name==="body").node;return{startIndex:a.startIndex,endIndex:a.endIndex}})}finally{r.dispose()}}async function QLe(t,e,r){let n=await Zi(t,e);try{let o=NLe(t,n.tree.rootNode),s;for(let a of o){let c=a.captures[0].node,u=oh.ofSyntaxNode(c);if(oh.doesContain(u,r)&&(s=c),Qu.isBefore(r.endPosition,u.startPosition))break}if(s)return oh.ofSyntaxNode(s);throw new Error("No parent node found")}finally{n.dispose()}}async function XLe(t,e,r,n){let o=await Zi(t,e);try{let s=o.tree.rootNode.descendantForPosition(r.startPosition,r.endPosition),a={startPosition:s.startPosition,endPosition:s.endPosition},c=bie(t,s,n,r,!0);return oh.equals(a,c)?yie(t,s):c}finally{o.dispose()}}function yie(t,e){let r=e.parent,n={startPosition:e.startPosition,endPosition:e.endPosition};if(LE(t,e)||!r)return n;let{filteredRanges:o,indexOfInterest:s}=_ie(t,r.children,n,!1);if(s-1>=0&&s+1<=o.length-1){let a=o[s-1],c=o[s+1];return{startPosition:a.startPosition,endPosition:c.endPosition}}return yie(t,r)}function bie(t,e,r,n,o){let s=e.children;if(e.endPosition.row-e.startPosition.row+1<=r){let c=LE(t,e)?{startPosition:e.startPosition,endPosition:e.endPosition}:gie(t,s,r,n,o),u=e.parent;return u?bie(t,u,r,c,!1):c}return gie(t,s,r,n,o)}function hie(t,e){return e.endPosition.row-t.startPosition.row+1}function gie(t,e,r,n,o){if(e.length===0)return n;let{filteredRanges:s,indexOfInterest:a}=_ie(t,e,n,o),c=0,u=s.length-1,l=s[c],d=s[u];for(;hie(l,d)>r&&c!==u;)a-c<u-a?(u--,d=s[u]):(c++,l=s[c]);return hie(l,d)<=r?{startPosition:l.startPosition,endPosition:d.endPosition}:n}function _ie(t,e,r,n){let o,s;if(n?(o=e.filter(a=>LE(t,a)||BU(t,a)),s=Jne(o,r,(a,c)=>Qu.isBefore(a.startPosition,c.startPosition)),o.splice(s,0,r)):(o=e.filter(a=>oh.doesContain(a,r)||LE(t,a)||BU(t,a)),s=o.findIndex(a=>oh.doesContain(a,r))),s===-1)throw new Error("Valid index not found");return{filteredRanges:o,indexOfInterest:s}}function TD(t,e,r,n=QU){let o=[t.rootNode],s=[];for(;;){let a=o.map(c=>[c,Ji.intersectionSize(c,e)]).filter(([c,u])=>u>0).sort(([c,u],[l,d])=>d-u);if(a.length===0)return s.length===0?void 0:NE(s,([c,u],[l,d])=>u-d)[0];{let c=a.map(([u,l])=>{let d=Ji.len(u),p=Math.abs(Ji.len(e)-l),m=(l-p)/d;return[u,m]});s.push(...c.filter(([u,l])=>n(u,r))),o=[],o.push(...c.flatMap(([u,l])=>u.children))}}}async function JLe(t,e,r){let n=await Zi(t,e);try{let o=n.tree.rootNode.descendantForIndex(r.startIndex,r.endIndex);if(o.type.match(/identifier/)&&(o.parent===null||QU(o.parent,t))){let s=o.parent,a=s===null?void 0:{startIndex:s.startIndex,endIndex:s.endIndex};return{identifier:o.text,nodeRange:a}}}finally{n.dispose()}}async function ZLe(t,e,r){let n=await Zi(t,e);try{let o=sie[t],c=$c(o,n.tree.rootNode).flatMap(({captures:u})=>u).filter(({name:u})=>u.endsWith("identifier")).find(({node:u})=>Ji.doesContain(u,r));return c?{identifier:c.node.text}:void 0}catch{return}finally{n.dispose()}}async function e4e(t,e,r){let n=[],a=(await Zi(t,e)).tree.rootNode.descendantForIndex(r.startIndex,r.endIndex);for(;a!==null;)fie(t,a)&&n.push({startIndex:a.startIndex,endIndex:a.endIndex}),a=a.parent;return n}async function t4e(t,e,r){let n=await Zi(t,e);try{let s=r.startIndex===r.endIndex?void 0:TD(n.tree,r,t);if(s)return{nodeIdentifier:KU(s,t),nodeToDocument:ID.ofSyntaxNode(s),nodeSelectionBy:"matchingSelection"};let c=n.tree.rootNode.descendantForIndex(r.startIndex,r.endIndex),u=0;for(;!QU(c,t)&&c.parent!==null;)c=c.parent,++u;return{nodeIdentifier:KU(c,t),nodeToDocument:ID.ofSyntaxNode(c),nodeSelectionBy:"expanding"}}finally{n.dispose()}}async function r4e(t,e,r){let n=await Zi(t,e);try{let o=r.startIndex===r.endIndex;if(o)return;let s=o?void 0:TD(n.tree,r,t),a=o?void 0:TD(n.tree,r,t,n4e);if(a&&s)return{nodeIdentifier:KU(s,t),nodeToExplain:ID.ofSyntaxNode(a)}}finally{n.dispose()}}function KU(t,e){switch(e){case"python":case"csharp":return t.children.find(r=>r.type.match(/identifier/))?.text;case"go":{let r=t.children.find(o=>o.type.match(/identifier/));return r?r.text:t.children.find(o=>o.type.match(/spec/))?.children.find(o=>o.type.match(/identifier/))?.text}case"javascript":case"javascriptreact":case"typescript":case"typescriptreact":case"cpp":{let r=t.children.find(o=>o.type.match(/declarator/));return r?r.children.find(o=>o.type.match(/identifier/))?.text:t.children.find(o=>o.type.match(/identifier/))?.text}case"java":return t.children.find(n=>n.type==="identifier")?.text;case"ruby":return t.children.find(r=>r.type.match(/constant|identifier/))?.text;default:return t.children.find(r=>r.type.match(/identifier/))?.text}}function n4e(t,e){return t.type.match(/definition/)}function QU(t,e){switch(e){case"typescript":case"tsx":case"javascript":return t.type.match(/definition|declaration|declarator|export_statement/);case"go":return t.type.match(/definition|declaration|declarator|var_spec/);case"cpp":return t.type.match(/definition|declaration|class_specifier/);case"ruby":return t.type.match(/module|class|method|assignment/);default:return t.type.match(/definition|declaration|declarator/)}}async function i4e(t,e){if(!new Set(["javascript","typescript","java","cpp","csharp","go","ruby"]).has(t))return;let n=await Zi(t,e);try{let o=oie[t],s=$c(o,n.tree.rootNode).flatMap(c=>c.captures.filter(u=>u.name==="docComment")),a=o4e(s);if(a.length>1&&(a=a.filter(c=>c.includes(`
`)||!c.match(/(implementation code|code implementation|implementation details|\.\.\.)/i))),a.length===1)return a[0]}finally{n.dispose()}}function o4e(t){let e=[];for(let r=0;r<t.length;++r){let n=[t[r].node.text];for(;r+1<t.length&&t[r].node.endPosition.row+1===t[r+1].node.startPosition.row;)++r,n.push(t[r].node.text);e.push(n.join(`
`))}return e}async function s4e(t,e){let r=cie[t];if(r.length===0)return;let n=await Zi(t,e);try{let o=$c(r,n.tree.rootNode).flatMap(u=>u.captures).sort((u,l)=>Ji.compare(u.node,l.node)),s=[];for(let u of o)u.name.endsWith(".exclude_captures")&&s.push(Ji.ofSyntaxNode(u.node));let a=new Ql(0,e.length,"root",[]),c=[a];for(let u=0;u<o.length;++u){let d=o[u].node;if(s.some(m=>Ji.isEqual(m,d)))continue;let p;do p=c.pop();while(p&&!Ji.doesContain(p,d));if(new Set(["export_statement","ambient_declaration"]).has(p.kind))p.kind=d.type,c.push(p);else{let m=d.type;(t==="typescript"||t==="tsx"||t==="javascript")&&m==="method_definition"&&d.namedChildren.some(b=>b.type==="property_identifier"&&b.text==="constructor")&&(m="constructor");let h=d.startIndex,g=d.previousSibling;if(g!==null){let S=e.substring(g.endIndex,d.startIndex).indexOf(`
`);S===-1?h=g.endIndex:h=g.endIndex+S+1}let v=d.endIndex,y=d.nextSibling;if(t==="typescript"&&y!==null&&(y.type===";"||y.type===",")&&(y=y.nextSibling),y!==null){let S=e.substring(d.endIndex,y.startIndex).indexOf(`
`);S!==-1&&(v=d.endIndex+S+1)}let _=new Ql(h,v,m,[]);p.children.push(_),c.push(p,_)}}return a}catch(o){console.error(o instanceof Error?o:new Error(o))}finally{n.dispose()}}function a4e(t,e,r){let n;switch(t){case"python":n=d4e(e);break;case"ruby":n=l4e(e);break;default:{n=c4e(e,t);break}}return new CD(n,Xu.ofSyntaxNode(r))}function c4e(t,e){let r=new Map;return t.forEach(n=>{let s=n.captures.find(c=>c.name==="definition")?.node,a=s?.childForFieldName("body");if(s&&a){let c;switch(e){case"typescript":case"javascript":{let{definition:l,comments:d}=p4e(s);s=l,c=d;break}case"java":case"rust":c=f4e(s);break;default:{c=ME(s);break}}r.get(s.id)||r.set(s.id,{mainBlock:Xu.ofSyntaxNode(s),detailBlocks:{comments:c.map(l=>Xu.ofSyntaxNode(l)),body:Xu.ofSyntaxNode(a)}})}}),Array.from(r.values())}function u4e(t){if(!(t.length<2))for(let e=1;e<t.length;e++){let r=t[e];if(!r.type.includes("parameters"))return r}}function l4e(t){let e=new Map;return t.forEach(r=>{let o=r.captures.find(s=>s.name==="definition")?.node;if(o){let s=o.namedChildren,a=u4e(s);if(a){let c=s[s.length-1],u=o.text.substring(a.startIndex-o.startIndex,c.endIndex-o.startIndex),l=ME(o);e.get(o.id)||e.set(o.id,{mainBlock:Xu.ofSyntaxNode(o),detailBlocks:{comments:l.map(p=>Xu.ofSyntaxNode(p)),body:{range:{startPosition:{row:a.startPosition.row,column:a.startPosition.column},endPosition:{row:c.endPosition.row,column:c.endPosition.column}},startIndex:a.startIndex,text:u,endIndex:c.endIndex}}})}}}),Array.from(e.values())}function d4e(t){let e=new Map;return t.forEach(r=>{let o=r.captures.find(a=>a.name==="definition")?.node,s=o?.childForFieldName("body");if(o&&s){let a=h4e(s),c=m4e(o);e.set(o.id,{mainBlock:Xu.ofSyntaxNode(o),detailBlocks:{docstring:a?Xu.ofSyntaxNode(a):void 0,decorator:c?Xu.ofSyntaxNode(c):void 0,body:Xu.ofSyntaxNode(s)}});return}}),Array.from(e.values())}function ME(t,e=["comment"]){let r=[],n=t.previousNamedSibling;for(;n&&e.some(o=>o===n?.type);)r.push(n),n=n.previousNamedSibling;return r.reverse()}function p4e(t){let e=t.parent;return e?.type==="export_statement"?{definition:e,comments:ME(e)}:{definition:t,comments:ME(t)}}function f4e(t){return ME(t,["block_comment","line_comment"])}function m4e(t){let e=t.previousNamedSibling;return e?.type==="decorator"?e:void 0}function h4e(t){let e=t.firstChild;if(!e||e.type!=="expression_statement")return;let r=e.firstChild;return r?.type==="string"?r:void 0}var g4e=Sie.join(__dirname,"worker2.js"),Z_=class{constructor(e,r){this._parser=new JU(XU,g4e,e,r.getLogger("parser proxy"))}dispose(){this._parser.dispose()}getTreeSitterAST(e){let r=Bp(e.languageId);if(r)return this.getTreeSitterASTForWASMLanguage(r,e.getText())}getTreeSitterASTForWASMLanguage(e,r){let n=this._parser.proxy;return{getFunctionPositions:()=>n._getFunctionPositions(e,r),getFunctionBodies:()=>n._getFunctionBodies(e,r),getCoarseParentScope:o=>n._getCoarseParentScope(e,r,o),getFixSelectionOfInterest:(o,s)=>n._getFixSelectionOfInterest(e,r,o,s),getCallExpressions:o=>n._getCallExpressions(e,r,o),getFunctionDefinitions:()=>n._getFunctionDefinitions(e,r),getClassReferences:o=>n._getClassReferences(e,r,o),getClassDeclarations:()=>n._getClassDeclarations(e,r),getTypeDeclarations:()=>n._getTypeDeclarations(e,r),getTypeReferences:o=>n._getTypeReferences(e,r,o),getSymbols:o=>n._getSymbols(e,r,o),getDocumentableNodeIfOnIdentifier:o=>n._getDocumentableNodeIfOnIdentifier(e,r,o),getTestableNode:o=>n._getTestableNode(e,r,o),getNodeToExplain:o=>n._getNodeToExplain(e,r,o),getNodeToDocument:o=>n._getNodeToDocument(e,r,o),getFineScopes:o=>n._getFineScopes(e,r,o),getStructure:()=>n._getStructure(e,r)}}extractDoc(e,r){return this._parser.proxy._extractDoc(e,r)}getSemanticChunkTree(e,r){return this._parser.proxy._getSemanticChunkTree(e,r)}getStructure(e,r){return this._parser.proxy._getStructure(e,r)}};Z_=B([T(1,ce)],Z_);var JU=class{constructor(e,r,n,o){this._workerPath=r;this._useWorker=n;this._local=new Proxy(e,{get:(s,a,c)=>{let u=s[a];return typeof u!="function"?u:async(...l)=>{let d=await u.apply(s,xie(l));return xie(d)}}}),this._worker=new Lo(()=>new ih(this._workerPath,{name:"Parser worker"},o))}get proxy(){return this._useWorker?this._worker.value.proxy:this._local}dispose(){this._worker.hasValue&&this._worker.value.terminate()}};function xie(t){return typeof t>"u"?t:JSON.parse(JSON.stringify(t))}var ED=require("vscode");var RD=se("IRemoteRepositoriesService"),wD=class{async loadWorkspaceContents(e){return await(await this.getApi()).loadWorkspaceContents?.(e)??!1}getApi(){return this.getRemoteExtension().activate()}getRemoteExtension(){if(this._remoteHub!==void 0)return this._remoteHub;if(this._remoteHub=ED.extensions.getExtension("ms-vscode.remote-repositories")??ED.extensions.getExtension("GitHub.remoteHub")??ED.extensions.getExtension("GitHub.remoteHub-insiders"),this._remoteHub===void 0)throw new Error("No Remote repository extension found.");return this._remoteHub}};var os=se("IReviewService");var gn=W(require("vscode"));var ZU=require("vscode");var ex=class{constructor(e,r,n){this._configurationService=e;this._contextService=r;this._disposables=new Nt;this._commentController=gn.comments.createCommentController("github-copilot-review","GitHub Copilot Review");this._comments=[];this._logger=n.getLogger("ReviewService"),this._disposables.add(gn.workspace.onDidChangeConfiguration(o=>{o.affectsConfiguration("github.copilot.advanced")&&(gn.commands.executeCommand("setContext","github.copilot.advanced.review.contextmenu.enabled",this._configurationService.getConfig(ge.ReviewContextMenu)),gn.commands.executeCommand("setContext","github.copilot.advanced.review.scmviewlet.enabled",this._configurationService.getConfig(ge.ReviewSCMViewlet))),(o.affectsConfiguration("github.copilot.advanced")||o.affectsConfiguration("github.copilot.advanced.review.intent"))&&gn.commands.executeCommand("setContext","github.copilot.advanced.review.intent.enabled",this.isIntentEnabled())})),this.updateContextValues()}updateContextValues(){gn.commands.executeCommand("setContext","github.copilot.advanced.review.contextmenu.enabled",this._configurationService.getConfig(ge.ReviewContextMenu)),gn.commands.executeCommand("setContext","github.copilot.advanced.review.scmviewlet.enabled",this._configurationService.getConfig(ge.ReviewSCMViewlet)),gn.commands.executeCommand("setContext","github.copilot.advanced.review.intent.enabled",this.isIntentEnabled())}isIntentEnabled(){let e=this._configurationService.getConfig(ge.ReviewIntent);return e!==ge.ReviewIntent.defaultValue?e:gn.workspace.getConfiguration("github.copilot.advanced.review").get("intent",ge.ReviewIntent.defaultValue)}getDiagnosticCollection(){return this._diagnosticCollection||this._disposables.add(this._diagnosticCollection=gn.languages.createDiagnosticCollection("github.copilot.review"))}getReviewComments(){return this._comments.map(({comment:e})=>e)}addReviewComments(e){for(let r of e){let n="",o=this._commentController.createCommentThread(r.uri,r.range,[{body:typeof r.body=="string"?`${r.body}${n}`:new gn.MarkdownString(`${r.body.value}${n}`),mode:gn.CommentMode.Preview,author:{name:ZU.l10n.t("GitHub Copilot"),iconPath:lt.joinPath(this._contextService.extensionUri,"assets","Copilot-chat-avatar.png")}}]);o.canReply=!1,this._comments.find(s=>s.comment.uri.toString()===r.uri.toString())||(o.collapsibleState=gn.CommentThreadCollapsibleState.Expanded),this._comments.push({comment:r,thread:o}),this.updateThreadLabels(),this._comments.length===1&&(gn.window.activeTextEditor?.document.uri.toString()===r.uri.toString()?gn.commands.executeCommand("editor.action.nextCommentThreadAction",o):gn.window.showTextDocument(r.uri,{preview:!0,selection:new gn.Range(r.range.start,r.range.start)}).then(()=>gn.commands.executeCommand("editor.action.nextCommentThreadAction",o)))}}collapseReviewComment(e){let r=this._comments.find(s=>s.comment===e);if(!r)return;let n=r.thread;n.dispose();let o=this._commentController.createCommentThread(e.uri,e.range,n.comments);o.canReply=!1,o.label=n.label,r.thread=o}removeReviewComments(e){for(let r of e){let n=this._comments.findIndex(o=>o.comment===r);n!==-1&&(this._comments[n].thread.dispose(),this._comments.splice(n,1))}this.updateThreadLabels()}updateThreadLabels(){this._comments.forEach((e,r)=>{e.thread.label=ZU.l10n.t("Code Review Comment ({0} of {1})",r+1,this._comments.length)})}findReviewComment(e){return this._comments.find(n=>n.thread===e||n.thread.comments[0]===e)?.comment}findCommentThread(e){return this._comments.find(n=>n.comment===e)?.thread}dispose(){this._disposables.dispose()}};ex=B([T(0,be),T(1,zt),T(2,ce)],ex);var sh=se("IScopeSelector");var FE=require("vscode");var Iie=Object.create(null);function x(t,e){if(pE(e)){let r=Iie[e];if(r===void 0)throw new Error(`${t} references an unknown codicon: ${e}`);e=r}return Iie[t]=e,{id:t}}var Cie={add:x("add",6e4),plus:x("plus",6e4),gistNew:x("gist-new",6e4),repoCreate:x("repo-create",6e4),lightbulb:x("lightbulb",60001),lightBulb:x("light-bulb",60001),repo:x("repo",60002),repoDelete:x("repo-delete",60002),gistFork:x("gist-fork",60003),repoForked:x("repo-forked",60003),gitPullRequest:x("git-pull-request",60004),gitPullRequestAbandoned:x("git-pull-request-abandoned",60004),recordKeys:x("record-keys",60005),keyboard:x("keyboard",60005),tag:x("tag",60006),gitPullRequestLabel:x("git-pull-request-label",60006),tagAdd:x("tag-add",60006),tagRemove:x("tag-remove",60006),person:x("person",60007),personFollow:x("person-follow",60007),personOutline:x("person-outline",60007),personFilled:x("person-filled",60007),gitBranch:x("git-branch",60008),gitBranchCreate:x("git-branch-create",60008),gitBranchDelete:x("git-branch-delete",60008),sourceControl:x("source-control",60008),mirror:x("mirror",60009),mirrorPublic:x("mirror-public",60009),star:x("star",60010),starAdd:x("star-add",60010),starDelete:x("star-delete",60010),starEmpty:x("star-empty",60010),comment:x("comment",60011),commentAdd:x("comment-add",60011),alert:x("alert",60012),warning:x("warning",60012),search:x("search",60013),searchSave:x("search-save",60013),logOut:x("log-out",60014),signOut:x("sign-out",60014),logIn:x("log-in",60015),signIn:x("sign-in",60015),eye:x("eye",60016),eyeUnwatch:x("eye-unwatch",60016),eyeWatch:x("eye-watch",60016),circleFilled:x("circle-filled",60017),primitiveDot:x("primitive-dot",60017),closeDirty:x("close-dirty",60017),debugBreakpoint:x("debug-breakpoint",60017),debugBreakpointDisabled:x("debug-breakpoint-disabled",60017),debugHint:x("debug-hint",60017),terminalDecorationSuccess:x("terminal-decoration-success",60017),primitiveSquare:x("primitive-square",60018),edit:x("edit",60019),pencil:x("pencil",60019),info:x("info",60020),issueOpened:x("issue-opened",60020),gistPrivate:x("gist-private",60021),gitForkPrivate:x("git-fork-private",60021),lock:x("lock",60021),mirrorPrivate:x("mirror-private",60021),close:x("close",60022),removeClose:x("remove-close",60022),x:x("x",60022),repoSync:x("repo-sync",60023),sync:x("sync",60023),clone:x("clone",60024),desktopDownload:x("desktop-download",60024),beaker:x("beaker",60025),microscope:x("microscope",60025),vm:x("vm",60026),deviceDesktop:x("device-desktop",60026),file:x("file",60027),fileText:x("file-text",60027),more:x("more",60028),ellipsis:x("ellipsis",60028),kebabHorizontal:x("kebab-horizontal",60028),mailReply:x("mail-reply",60029),reply:x("reply",60029),organization:x("organization",60030),organizationFilled:x("organization-filled",60030),organizationOutline:x("organization-outline",60030),newFile:x("new-file",60031),fileAdd:x("file-add",60031),newFolder:x("new-folder",60032),fileDirectoryCreate:x("file-directory-create",60032),trash:x("trash",60033),trashcan:x("trashcan",60033),history:x("history",60034),clock:x("clock",60034),folder:x("folder",60035),fileDirectory:x("file-directory",60035),symbolFolder:x("symbol-folder",60035),logoGithub:x("logo-github",60036),markGithub:x("mark-github",60036),github:x("github",60036),terminal:x("terminal",60037),console:x("console",60037),repl:x("repl",60037),zap:x("zap",60038),symbolEvent:x("symbol-event",60038),error:x("error",60039),stop:x("stop",60039),variable:x("variable",60040),symbolVariable:x("symbol-variable",60040),array:x("array",60042),symbolArray:x("symbol-array",60042),symbolModule:x("symbol-module",60043),symbolPackage:x("symbol-package",60043),symbolNamespace:x("symbol-namespace",60043),symbolObject:x("symbol-object",60043),symbolMethod:x("symbol-method",60044),symbolFunction:x("symbol-function",60044),symbolConstructor:x("symbol-constructor",60044),symbolBoolean:x("symbol-boolean",60047),symbolNull:x("symbol-null",60047),symbolNumeric:x("symbol-numeric",60048),symbolNumber:x("symbol-number",60048),symbolStructure:x("symbol-structure",60049),symbolStruct:x("symbol-struct",60049),symbolParameter:x("symbol-parameter",60050),symbolTypeParameter:x("symbol-type-parameter",60050),symbolKey:x("symbol-key",60051),symbolText:x("symbol-text",60051),symbolReference:x("symbol-reference",60052),goToFile:x("go-to-file",60052),symbolEnum:x("symbol-enum",60053),symbolValue:x("symbol-value",60053),symbolRuler:x("symbol-ruler",60054),symbolUnit:x("symbol-unit",60054),activateBreakpoints:x("activate-breakpoints",60055),archive:x("archive",60056),arrowBoth:x("arrow-both",60057),arrowDown:x("arrow-down",60058),arrowLeft:x("arrow-left",60059),arrowRight:x("arrow-right",60060),arrowSmallDown:x("arrow-small-down",60061),arrowSmallLeft:x("arrow-small-left",60062),arrowSmallRight:x("arrow-small-right",60063),arrowSmallUp:x("arrow-small-up",60064),arrowUp:x("arrow-up",60065),bell:x("bell",60066),bold:x("bold",60067),book:x("book",60068),bookmark:x("bookmark",60069),debugBreakpointConditionalUnverified:x("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:x("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:x("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:x("debug-breakpoint-data-unverified",60072),debugBreakpointData:x("debug-breakpoint-data",60073),debugBreakpointDataDisabled:x("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:x("debug-breakpoint-log-unverified",60074),debugBreakpointLog:x("debug-breakpoint-log",60075),debugBreakpointLogDisabled:x("debug-breakpoint-log-disabled",60075),briefcase:x("briefcase",60076),broadcast:x("broadcast",60077),browser:x("browser",60078),bug:x("bug",60079),calendar:x("calendar",60080),caseSensitive:x("case-sensitive",60081),check:x("check",60082),checklist:x("checklist",60083),chevronDown:x("chevron-down",60084),chevronLeft:x("chevron-left",60085),chevronRight:x("chevron-right",60086),chevronUp:x("chevron-up",60087),chromeClose:x("chrome-close",60088),chromeMaximize:x("chrome-maximize",60089),chromeMinimize:x("chrome-minimize",60090),chromeRestore:x("chrome-restore",60091),circleOutline:x("circle-outline",60092),circle:x("circle",60092),debugBreakpointUnverified:x("debug-breakpoint-unverified",60092),terminalDecorationIncomplete:x("terminal-decoration-incomplete",60092),circleSlash:x("circle-slash",60093),circuitBoard:x("circuit-board",60094),clearAll:x("clear-all",60095),clippy:x("clippy",60096),closeAll:x("close-all",60097),cloudDownload:x("cloud-download",60098),cloudUpload:x("cloud-upload",60099),code:x("code",60100),collapseAll:x("collapse-all",60101),colorMode:x("color-mode",60102),commentDiscussion:x("comment-discussion",60103),creditCard:x("credit-card",60105),dash:x("dash",60108),dashboard:x("dashboard",60109),database:x("database",60110),debugContinue:x("debug-continue",60111),debugDisconnect:x("debug-disconnect",60112),debugPause:x("debug-pause",60113),debugRestart:x("debug-restart",60114),debugStart:x("debug-start",60115),debugStepInto:x("debug-step-into",60116),debugStepOut:x("debug-step-out",60117),debugStepOver:x("debug-step-over",60118),debugStop:x("debug-stop",60119),debug:x("debug",60120),deviceCameraVideo:x("device-camera-video",60121),deviceCamera:x("device-camera",60122),deviceMobile:x("device-mobile",60123),diffAdded:x("diff-added",60124),diffIgnored:x("diff-ignored",60125),diffModified:x("diff-modified",60126),diffRemoved:x("diff-removed",60127),diffRenamed:x("diff-renamed",60128),diff:x("diff",60129),diffSidebyside:x("diff-sidebyside",60129),discard:x("discard",60130),editorLayout:x("editor-layout",60131),emptyWindow:x("empty-window",60132),exclude:x("exclude",60133),extensions:x("extensions",60134),eyeClosed:x("eye-closed",60135),fileBinary:x("file-binary",60136),fileCode:x("file-code",60137),fileMedia:x("file-media",60138),filePdf:x("file-pdf",60139),fileSubmodule:x("file-submodule",60140),fileSymlinkDirectory:x("file-symlink-directory",60141),fileSymlinkFile:x("file-symlink-file",60142),fileZip:x("file-zip",60143),files:x("files",60144),filter:x("filter",60145),flame:x("flame",60146),foldDown:x("fold-down",60147),foldUp:x("fold-up",60148),fold:x("fold",60149),folderActive:x("folder-active",60150),folderOpened:x("folder-opened",60151),gear:x("gear",60152),gift:x("gift",60153),gistSecret:x("gist-secret",60154),gist:x("gist",60155),gitCommit:x("git-commit",60156),gitCompare:x("git-compare",60157),compareChanges:x("compare-changes",60157),gitMerge:x("git-merge",60158),githubAction:x("github-action",60159),githubAlt:x("github-alt",60160),globe:x("globe",60161),grabber:x("grabber",60162),graph:x("graph",60163),gripper:x("gripper",60164),heart:x("heart",60165),home:x("home",60166),horizontalRule:x("horizontal-rule",60167),hubot:x("hubot",60168),inbox:x("inbox",60169),issueReopened:x("issue-reopened",60171),issues:x("issues",60172),italic:x("italic",60173),jersey:x("jersey",60174),json:x("json",60175),kebabVertical:x("kebab-vertical",60176),key:x("key",60177),law:x("law",60178),lightbulbAutofix:x("lightbulb-autofix",60179),linkExternal:x("link-external",60180),link:x("link",60181),listOrdered:x("list-ordered",60182),listUnordered:x("list-unordered",60183),liveShare:x("live-share",60184),loading:x("loading",60185),location:x("location",60186),mailRead:x("mail-read",60187),mail:x("mail",60188),markdown:x("markdown",60189),megaphone:x("megaphone",60190),mention:x("mention",60191),milestone:x("milestone",60192),gitPullRequestMilestone:x("git-pull-request-milestone",60192),mortarBoard:x("mortar-board",60193),move:x("move",60194),multipleWindows:x("multiple-windows",60195),mute:x("mute",60196),noNewline:x("no-newline",60197),note:x("note",60198),octoface:x("octoface",60199),openPreview:x("open-preview",60200),package:x("package",60201),paintcan:x("paintcan",60202),pin:x("pin",60203),play:x("play",60204),run:x("run",60204),plug:x("plug",60205),preserveCase:x("preserve-case",60206),preview:x("preview",60207),project:x("project",60208),pulse:x("pulse",60209),question:x("question",60210),quote:x("quote",60211),radioTower:x("radio-tower",60212),reactions:x("reactions",60213),references:x("references",60214),refresh:x("refresh",60215),regex:x("regex",60216),remoteExplorer:x("remote-explorer",60217),remote:x("remote",60218),remove:x("remove",60219),replaceAll:x("replace-all",60220),replace:x("replace",60221),repoClone:x("repo-clone",60222),repoForcePush:x("repo-force-push",60223),repoPull:x("repo-pull",60224),repoPush:x("repo-push",60225),report:x("report",60226),requestChanges:x("request-changes",60227),rocket:x("rocket",60228),rootFolderOpened:x("root-folder-opened",60229),rootFolder:x("root-folder",60230),rss:x("rss",60231),ruby:x("ruby",60232),saveAll:x("save-all",60233),saveAs:x("save-as",60234),save:x("save",60235),screenFull:x("screen-full",60236),screenNormal:x("screen-normal",60237),searchStop:x("search-stop",60238),server:x("server",60240),settingsGear:x("settings-gear",60241),settings:x("settings",60242),shield:x("shield",60243),smiley:x("smiley",60244),sortPrecedence:x("sort-precedence",60245),splitHorizontal:x("split-horizontal",60246),splitVertical:x("split-vertical",60247),squirrel:x("squirrel",60248),starFull:x("star-full",60249),starHalf:x("star-half",60250),symbolClass:x("symbol-class",60251),symbolColor:x("symbol-color",60252),symbolConstant:x("symbol-constant",60253),symbolEnumMember:x("symbol-enum-member",60254),symbolField:x("symbol-field",60255),symbolFile:x("symbol-file",60256),symbolInterface:x("symbol-interface",60257),symbolKeyword:x("symbol-keyword",60258),symbolMisc:x("symbol-misc",60259),symbolOperator:x("symbol-operator",60260),symbolProperty:x("symbol-property",60261),wrench:x("wrench",60261),wrenchSubaction:x("wrench-subaction",60261),symbolSnippet:x("symbol-snippet",60262),tasklist:x("tasklist",60263),telescope:x("telescope",60264),textSize:x("text-size",60265),threeBars:x("three-bars",60266),thumbsdown:x("thumbsdown",60267),thumbsup:x("thumbsup",60268),tools:x("tools",60269),triangleDown:x("triangle-down",60270),triangleLeft:x("triangle-left",60271),triangleRight:x("triangle-right",60272),triangleUp:x("triangle-up",60273),twitter:x("twitter",60274),unfold:x("unfold",60275),unlock:x("unlock",60276),unmute:x("unmute",60277),unverified:x("unverified",60278),verified:x("verified",60279),versions:x("versions",60280),vmActive:x("vm-active",60281),vmOutline:x("vm-outline",60282),vmRunning:x("vm-running",60283),watch:x("watch",60284),whitespace:x("whitespace",60285),wholeWord:x("whole-word",60286),window:x("window",60287),wordWrap:x("word-wrap",60288),zoomIn:x("zoom-in",60289),zoomOut:x("zoom-out",60290),listFilter:x("list-filter",60291),listFlat:x("list-flat",60292),listSelection:x("list-selection",60293),selection:x("selection",60293),listTree:x("list-tree",60294),debugBreakpointFunctionUnverified:x("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:x("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:x("debug-breakpoint-function-disabled",60296),debugStackframeActive:x("debug-stackframe-active",60297),circleSmallFilled:x("circle-small-filled",60298),debugStackframeDot:x("debug-stackframe-dot",60298),terminalDecorationMark:x("terminal-decoration-mark",60298),debugStackframe:x("debug-stackframe",60299),debugStackframeFocused:x("debug-stackframe-focused",60299),debugBreakpointUnsupported:x("debug-breakpoint-unsupported",60300),symbolString:x("symbol-string",60301),debugReverseContinue:x("debug-reverse-continue",60302),debugStepBack:x("debug-step-back",60303),debugRestartFrame:x("debug-restart-frame",60304),debugAlt:x("debug-alt",60305),callIncoming:x("call-incoming",60306),callOutgoing:x("call-outgoing",60307),menu:x("menu",60308),expandAll:x("expand-all",60309),feedback:x("feedback",60310),gitPullRequestReviewer:x("git-pull-request-reviewer",60310),groupByRefType:x("group-by-ref-type",60311),ungroupByRefType:x("ungroup-by-ref-type",60312),account:x("account",60313),gitPullRequestAssignee:x("git-pull-request-assignee",60313),bellDot:x("bell-dot",60314),debugConsole:x("debug-console",60315),library:x("library",60316),output:x("output",60317),runAll:x("run-all",60318),syncIgnored:x("sync-ignored",60319),pinned:x("pinned",60320),githubInverted:x("github-inverted",60321),serverProcess:x("server-process",60322),serverEnvironment:x("server-environment",60323),pass:x("pass",60324),issueClosed:x("issue-closed",60324),stopCircle:x("stop-circle",60325),playCircle:x("play-circle",60326),record:x("record",60327),debugAltSmall:x("debug-alt-small",60328),vmConnect:x("vm-connect",60329),cloud:x("cloud",60330),merge:x("merge",60331),export:x("export",60332),graphLeft:x("graph-left",60333),magnet:x("magnet",60334),notebook:x("notebook",60335),redo:x("redo",60336),checkAll:x("check-all",60337),pinnedDirty:x("pinned-dirty",60338),passFilled:x("pass-filled",60339),circleLargeFilled:x("circle-large-filled",60340),circleLarge:x("circle-large",60341),circleLargeOutline:x("circle-large-outline",60341),combine:x("combine",60342),gather:x("gather",60342),table:x("table",60343),variableGroup:x("variable-group",60344),typeHierarchy:x("type-hierarchy",60345),typeHierarchySub:x("type-hierarchy-sub",60346),typeHierarchySuper:x("type-hierarchy-super",60347),gitPullRequestCreate:x("git-pull-request-create",60348),runAbove:x("run-above",60349),runBelow:x("run-below",60350),notebookTemplate:x("notebook-template",60351),debugRerun:x("debug-rerun",60352),workspaceTrusted:x("workspace-trusted",60353),workspaceUntrusted:x("workspace-untrusted",60354),workspaceUnknown:x("workspace-unknown",60355),terminalCmd:x("terminal-cmd",60356),terminalDebian:x("terminal-debian",60357),terminalLinux:x("terminal-linux",60358),terminalPowershell:x("terminal-powershell",60359),terminalTmux:x("terminal-tmux",60360),terminalUbuntu:x("terminal-ubuntu",60361),terminalBash:x("terminal-bash",60362),arrowSwap:x("arrow-swap",60363),copy:x("copy",60364),personAdd:x("person-add",60365),filterFilled:x("filter-filled",60366),wand:x("wand",60367),debugLineByLine:x("debug-line-by-line",60368),inspect:x("inspect",60369),layers:x("layers",60370),layersDot:x("layers-dot",60371),layersActive:x("layers-active",60372),compass:x("compass",60373),compassDot:x("compass-dot",60374),compassActive:x("compass-active",60375),azure:x("azure",60376),issueDraft:x("issue-draft",60377),gitPullRequestClosed:x("git-pull-request-closed",60378),gitPullRequestDraft:x("git-pull-request-draft",60379),debugAll:x("debug-all",60380),debugCoverage:x("debug-coverage",60381),runErrors:x("run-errors",60382),folderLibrary:x("folder-library",60383),debugContinueSmall:x("debug-continue-small",60384),beakerStop:x("beaker-stop",60385),graphLine:x("graph-line",60386),graphScatter:x("graph-scatter",60387),pieChart:x("pie-chart",60388),bracket:x("bracket",60175),bracketDot:x("bracket-dot",60389),bracketError:x("bracket-error",60390),lockSmall:x("lock-small",60391),azureDevops:x("azure-devops",60392),verifiedFilled:x("verified-filled",60393),newline:x("newline",60394),layout:x("layout",60395),layoutActivitybarLeft:x("layout-activitybar-left",60396),layoutActivitybarRight:x("layout-activitybar-right",60397),layoutPanelLeft:x("layout-panel-left",60398),layoutPanelCenter:x("layout-panel-center",60399),layoutPanelJustify:x("layout-panel-justify",60400),layoutPanelRight:x("layout-panel-right",60401),layoutPanel:x("layout-panel",60402),layoutSidebarLeft:x("layout-sidebar-left",60403),layoutSidebarRight:x("layout-sidebar-right",60404),layoutStatusbar:x("layout-statusbar",60405),layoutMenubar:x("layout-menubar",60406),layoutCentered:x("layout-centered",60407),target:x("target",60408),indent:x("indent",60409),recordSmall:x("record-small",60410),errorSmall:x("error-small",60411),terminalDecorationError:x("terminal-decoration-error",60411),arrowCircleDown:x("arrow-circle-down",60412),arrowCircleLeft:x("arrow-circle-left",60413),arrowCircleRight:x("arrow-circle-right",60414),arrowCircleUp:x("arrow-circle-up",60415),layoutSidebarRightOff:x("layout-sidebar-right-off",60416),layoutPanelOff:x("layout-panel-off",60417),layoutSidebarLeftOff:x("layout-sidebar-left-off",60418),blank:x("blank",60419),heartFilled:x("heart-filled",60420),map:x("map",60421),mapHorizontal:x("map-horizontal",60421),foldHorizontal:x("fold-horizontal",60421),mapFilled:x("map-filled",60422),mapHorizontalFilled:x("map-horizontal-filled",60422),foldHorizontalFilled:x("fold-horizontal-filled",60422),circleSmall:x("circle-small",60423),bellSlash:x("bell-slash",60424),bellSlashDot:x("bell-slash-dot",60425),commentUnresolved:x("comment-unresolved",60426),gitPullRequestGoToChanges:x("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:x("git-pull-request-new-changes",60428),searchFuzzy:x("search-fuzzy",60429),commentDraft:x("comment-draft",60430),send:x("send",60431),sparkle:x("sparkle",60432),insert:x("insert",60433),mic:x("mic",60434),thumbsdownFilled:x("thumbsdown-filled",60435),thumbsupFilled:x("thumbsup-filled",60436),coffee:x("coffee",60437),snake:x("snake",60438),game:x("game",60439),vr:x("vr",60440),chip:x("chip",60441),piano:x("piano",60442),music:x("music",60443),micFilled:x("mic-filled",60444),repoFetch:x("repo-fetch",60445),copilot:x("copilot",60446),lightbulbSparkle:x("lightbulb-sparkle",60447),robot:x("robot",60448),sparkleFilled:x("sparkle-filled",60449),diffSingle:x("diff-single",60450),diffMultiple:x("diff-multiple",60451),surroundWith:x("surround-with",60452),share:x("share",60453),gitStash:x("git-stash",60454),gitStashApply:x("git-stash-apply",60455),gitStashPop:x("git-stash-pop",60456),vscode:x("vscode",60457),vscodeInsiders:x("vscode-insiders",60458),codeOss:x("code-oss",60459),runCoverage:x("run-coverage",60460),runAllCoverage:x("run-all-coverage",60461),coverage:x("coverage",60462),githubProject:x("github-project",60463),mapVertical:x("map-vertical",60464),foldVertical:x("fold-vertical",60464),mapVerticalFilled:x("map-vertical-filled",60465),foldVerticalFilled:x("fold-vertical-filled",60465),goToSearch:x("go-to-search",60466),percentage:x("percentage",60467),sortPercentage:x("sort-percentage",60467),attach:x("attach",60468)};var v4e={dialogError:x("dialog-error","error"),dialogWarning:x("dialog-warning","warning"),dialogInfo:x("dialog-info","info"),dialogClose:x("dialog-close","close"),treeItemExpanded:x("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:x("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:x("tree-filter-on-type-off","list-selection"),treeFilterClear:x("tree-filter-clear","close"),treeItemLoading:x("tree-item-loading","loading"),menuSelection:x("menu-selection","check"),menuSubmenu:x("menu-submenu","chevron-right"),menuBarMore:x("menubar-more","more"),scrollbarButtonLeft:x("scrollbar-button-left","triangle-left"),scrollbarButtonRight:x("scrollbar-button-right","triangle-right"),scrollbarButtonUp:x("scrollbar-button-up","triangle-up"),scrollbarButtonDown:x("scrollbar-button-down","triangle-down"),toolBarMore:x("toolbar-more","more"),quickInputBack:x("quick-input-back","arrow-left"),dropDownButton:x("drop-down-button",60084),symbolCustomColor:x("symbol-customcolor",60252),exportIcon:x("export",60332),workspaceUnspecified:x("workspace-unspecified",60355),newLine:x("newline",60394),thumbsDownFilled:x("thumbsdown-filled",60435),thumbsUpFilled:x("thumbsup-filled",60436),gitFetch:x("git-fetch",60445),lightbulbSparkleAutofix:x("lightbulb-sparkle-autofix",60447),debugBreakpointPending:x("debug-breakpoint-pending",60377)},Jr={...Cie,...v4e};var tx=class{constructor(e){this.accessor=e}async findEnclosingBlocks(e,r){let n=this.accessor.get(_t).getTreeSitterAST(e);if(n===void 0)return;let o=Xi(r,e);return(await n.getFineScopes(o))?.map(a=>{let c=Ps(e,a);return{kind:"code",name:e.lineAt(c.start).text.trim(),range:c}})}findEnclosingSymbols(e,r){for(let n of e)if(n.range.contains(r)){let o=this.findEnclosingSymbols(n.children,r);return o?[n,...o]:[n]}}async selectEnclosingScope(e,r){let n=await this.accessor.get(Di).getDocumentSymbols(e.document.uri);if(!n||n.length>0&&!n[0].hasOwnProperty("children"))return;let o=e.selection;if(!o.isEmpty)return;let s=this.findEnclosingSymbols(n,e.selection.active);if(r?.includeBlocks&&s?.push(...await this.findEnclosingBlocks(e.document,e.selection)??[]),s||(s=n),s?.length===1){let a=s[0];e.selection=new FE.Selection(a.range.start,a.range.end)}else if(s&&s.length>1||!s&&n.length>1){let a=s.sort((u,l)=>l.range.start.line-u.range.start.line).map(u=>({label:`$(${u.kind==="code"?"code":Tie.toIcon(u.kind).id}) ${u.name}`,description:`:${u.range.start.line+1}-${u.range.end.line+1}`,symbol:u}));if(!await this.accessor.get(iD).showQuickPick(a,{placeHolder:r?.reason??FE.l10n.t("Select an enclosing range"),onDidSelectItem(u){let l=u.symbol;l&&(e.selection=new FE.Selection(l.range.start,l.range.end),e.revealRange(l.range))}}))throw e.selection=o,new ns}return e.selection}};tx=B([T(0,rt)],tx);var Tie;(r=>{let t=new Map;t.set(0,Jr.symbolFile),t.set(1,Jr.symbolModule),t.set(2,Jr.symbolNamespace),t.set(3,Jr.symbolPackage),t.set(4,Jr.symbolClass),t.set(5,Jr.symbolMethod),t.set(6,Jr.symbolProperty),t.set(7,Jr.symbolField),t.set(8,Jr.symbolConstructor),t.set(9,Jr.symbolEnum),t.set(10,Jr.symbolInterface),t.set(11,Jr.symbolFunction),t.set(12,Jr.symbolVariable),t.set(13,Jr.symbolConstant),t.set(14,Jr.symbolString),t.set(15,Jr.symbolNumber),t.set(16,Jr.symbolBoolean),t.set(17,Jr.symbolArray),t.set(18,Jr.symbolObject),t.set(19,Jr.symbolKey),t.set(20,Jr.symbolNull),t.set(21,Jr.symbolEnumMember),t.set(22,Jr.symbolStruct),t.set(23,Jr.symbolEvent),t.set(24,Jr.symbolOperator),t.set(25,Jr.symbolTypeParameter);function e(n){let o=t.get(n);return o||(console.info("No codicon found for SymbolKind "+n),o=Jr.symbolProperty),o}r.toIcon=e})(Tie||={});var Aa=se("ISearchService"),kD=class{async findFilesWithDefaultExcludes(e,r,n){return this._findFilesWithDefaultExcludesAndExcludes(e,void 0,r,n)}async _findFilesWithDefaultExcludesAndExcludes(e,r,n,o){let s={maxResults:n,exclude:r,useDefaultExcludes:!0,useDefaultSearchExcludes:!0},a=await this.findFiles(e,s,o);return n===1?a[0]:a}};async function Zl(t,e,r){let n=new ql;try{t.debug(`${e} started`);let o=await r();return t.debug(`${e} finished. Elapsed ${n.elapsed()}`),o}catch(o){throw t.debug(`${e} failed. Elapsed ${n.elapsed()}`),o}}function bi(t){return function(e,r,n){let o=n.value,s=0;return n.value=async function(...a){let c=s++,u=t(this);return Zl(u,`${r}#${c}`,()=>o.apply(this,a))},n}}function x0(t){return function(e,r,n){let o=n.value;return n.value=async function(...s){let a=new ql;try{let c=await o.apply(this,s);return t.call(this,a.elapsed(),"success"),c}catch(c){throw t.call(this,a.elapsed(),kp(c)?"cancelled":"failed"),c}},n}}var eB=W(require("vscode"));var rx=class extends kD{findTextInFiles(e,r,n,o){return Promise.resolve(eB.workspace.findTextInFiles(e,r,s=>n.report(s),o))}findFiles(e,r,n){return eB.workspace.findFiles2(e,r,n)}};var S0=class extends rx{constructor(r,n){super();this._ignoreService=r;this._logger=n.getLogger("SearchService")}async findFilesWithDefaultExcludes(r,n,o){let s=await this._ignoreService.asMinimatchPattern();return this._findFilesWithDefaultExcludesAndExcludes(r,s,n,o)}async findFiles(r,n,o){let s=await this._ignoreService.asMinimatchPattern();return n?.exclude||(n={...n,exclude:s}),await super.findFiles(r,n,o)}async findTextInFiles(r,n,o,s){return super.findTextInFiles(r,n,o,s)}};B([bi(r=>r._logger)],S0.prototype,"findFiles",1),S0=B([T(0,De),T(1,ce)],S0);var UE=se("ISimulationTestContext"),AD=class{constructor(){this.isInSimulationTests=!1}writeFile(e,r,n){throw new Error("Method not implemented.")}};var Tt=se("ITabsAndEditorsService");var ss=W(require("vscode"));var PD=class{constructor(){this._store=new Nt;this._tabGroupsUseInfo=new Map;this._tabClock=0;this.onDidChangeActiveTextEditor=ss.window.onDidChangeActiveTextEditor;this.onDidChangeTabs=ss.window.tabGroups.onDidChangeTabs;let e=()=>this._tabGroupsUseInfo.set(ss.window.tabGroups.activeTabGroup,this._tabClock++);e(),this._store.add(ss.window.tabGroups.onDidChangeTabGroups(r=>{r.closed.forEach(n=>this._tabGroupsUseInfo.delete(n)),e()}))}dispose(){this._store.dispose()}get activeTextEditor(){let e=ss.window.activeTextEditor;if(e&&e.document.uri.scheme!=="output")return e;let r=new Pn;ss.window.visibleTextEditors.forEach(o=>r.set(o.document.uri,o));let n=[...this._tabGroupsUseInfo];n.sort((o,s)=>s[1]-o[1]);for(let[o]of n)if(o.activeTab){let s=this._asTabInfo(o.activeTab);if(s.uri&&r.has(s.uri))return r.get(s.uri)}}get activeNotebookEditor(){return ss.window.activeNotebookEditor}get tabs(){return ss.window.tabGroups.all.flatMap(e=>e.tabs).map(this._asTabInfo,this)}_asTabInfo(e){let r;return e.input instanceof ss.TabInputText||e.input instanceof ss.TabInputNotebook?r=e.input.uri:(e.input instanceof ss.TabInputTextDiff||e.input instanceof ss.TabInputNotebookDiff)&&(r=e.input.modified),{tab:e,uri:r}}};var Lt=se("IExperimentationService"),DD=class{constructor(){this.initializePromise=Promise.resolve();this.initialFetch=Promise.resolve()}isFlightEnabled(e){return!1}isCachedFlightEnabled(e){return Promise.resolve(!1)}isFlightEnabledAsync(e){return Promise.resolve(!1)}getTreatmentVariable(e,r){}getTreatmentVariableAsync(e,r){return Promise.resolve(void 0)}};var ND=class{dispose(){}sendInternalMSFTTelemetryEvent(e,r,n){}sendMSFTTelemetryEvent(e,r,n){}sendMSFTTelemetryErrorEvent(e,r,n){}sendGHTelemetryEvent(e,r,n){}sendGHTelemetryErrorEvent(e,r,n){}sendGHTelemetryException(e,r){}sendTelemetryEvent(e,r,n,o){}sendTelemetryErrorEvent(e,r,n,o){}setSharedProperty(e,r){}postEvent(e,r){}sendRestrictedGHTelemetryEvent(e,r,n){}sendRestrictedGHTelemetryErrorEvent(e,r,n){}};var N0e=W(D0e()),z4=W(require("os")),Mh=class{constructor(e,r,n,o){this.namespace=n;this.client=rVe(e,r,o),L0e(e,r,this.client)}separateData(e){if(e.properties!==void 0||e.measurements!==void 0)return e.properties=e.properties||{},e.measurements=e.measurements||{},e;let r={},n={};for(let[o,s]of Object.entries(e))typeof s=="number"?n[o]=s:r[o]=s;return{properties:r,measurements:n}}sendEventData(e,r){let{properties:n,measurements:o}=this.separateData(r||{});this.client.trackEvent({name:this.qualifyEventName(e),properties:n,measurements:o})}sendErrorData(e,r){let{properties:n,measurements:o}=this.separateData(r||{});this.client.trackException({exception:e,properties:n,measurements:o})}flush(){return new Promise(e=>{this.client.flush({callback:()=>{e(void 0)}})})}qualifyEventName(e){return e.includes(this.namespace)?e:`${this.namespace}/${e}`}};function rVe(t,e,r){let n=new N0e.TelemetryClient(r);return n.config.enableAutoCollectRequests=!1,n.config.enableAutoCollectPerformance=!1,n.config.enableAutoCollectExceptions=!1,n.config.enableAutoCollectConsole=!1,n.config.enableAutoCollectDependencies=!1,n.config.noDiagnosticChannel=!0,L0e(t,e,n),n}function L0e(t,e,r){r.commonProperties=nVe(r.commonProperties,e),r.context.tags[r.context.keys.cloudRoleInstance]="REDACTED",r.config.endpointUrl=t.telemetryURL}function nVe(t,e){return t=t||{},t.common_os=z4.platform(),t.common_platformversion=z4.release(),t.common_vscodemachineid=e.machineId,t.common_vscodesessionid=e.sessionId,t.common_uikind="desktop",t.common_remotename="none",t.common_isnewappinstall="",t}var O0e="7d7048df-6dd0-4048-bb23-b716c1461f8f",M0e="3fdd7f28-937a-48c8-9a21-ba337db23bd1";var mR=W(Z0e());function CVe(t){return t?mR.TargetPopulation.Insiders:mR.TargetPopulation.Public}async function eye(t,e,r){let n=t.extension.id,o=t.extension.packageJSON.version,s=CVe(r);return(0,mR.getExperimentationService)(n,o,s,e,t.globalState)}var fy=require("vscode");function tye(t){return t.replace(/([\s|(]|file:\/\/)(\/[^\s]+)/g,"$1[redacted]").replace(/([\s|(]|file:\/\/)([a-zA-Z]:[(\\|/){1,2}][^\s]+)/gi,"$1[redacted]").replace(/([\s|(]|file:\/\/)(\\[^\s]+)/gi,"$1[redacted]")}var tO=class{constructor(e,r,n,o,s,a,c,u){this._configService=e;this._envService=r;this._telemetryConfig=n;this._restrictedTelemetryEnabled=!1;this._disposables=[];this._nonRestrictedTelemetryLogger=fy.env.createTelemetryLogger(new Mh(o,this._envService,s,a),{ignoreBuiltInCommonProperties:!0,ignoreUnhandledErrors:!0}),this._disposables.push(u.onCopilotToken(l=>{l.token.getTokenValue("rt")==="1"?(this._restrictedTelemetryEnabled=!0,this._restrictedTelemetryLogger=fy.env.createTelemetryLogger(new Mh(o,this._envService,s,c),{ignoreBuiltInCommonProperties:!0,ignoreUnhandledErrors:!0})):(this._restrictedTelemetryEnabled=!1,this._restrictedTelemetryLogger&&this._restrictedTelemetryLogger.dispose(),this._restrictedTelemetryLogger=void 0)})),this._disposables.push(o.onDidChangeDomains(()=>{this._nonRestrictedTelemetryLogger.dispose(),this._nonRestrictedTelemetryLogger=fy.env.createTelemetryLogger(new Mh(o,this._envService,s,a),{ignoreBuiltInCommonProperties:!0,ignoreUnhandledErrors:!0}),this._restrictedTelemetryLogger&&(this._restrictedTelemetryLogger.dispose(),this._restrictedTelemetryLogger=fy.env.createTelemetryLogger(new Mh(o,this._envService,s,c),{ignoreBuiltInCommonProperties:!0,ignoreUnhandledErrors:!0}))}))}sendTelemetryEvent(e,r,n){this._nonRestrictedTelemetryLogger.logUsage(e,this.markAsIssuedAndMakeReadyForSending(r,n))}sendTelemetryErrorEvent(e,r,n){this._nonRestrictedTelemetryLogger.logError(e,this.markAsIssuedAndMakeReadyForSending(r,n))}sendRestrictedTelemetryEvent(e,r,n){this._restrictedTelemetryEnabled&&this._restrictedTelemetryLogger&&this._restrictedTelemetryLogger?.logUsage(e,this.markAsIssuedAndMakeReadyForSending(r,n))}sendRestrictedTelemetryErrorEvent(e,r,n){this._restrictedTelemetryEnabled&&this._restrictedTelemetryLogger&&this._restrictedTelemetryLogger?.logError(e,this.markAsIssuedAndMakeReadyForSending(r,n))}sendExceptionTelemetry(e,r){let n=e instanceof Error?e:new Error("Non-error thrown: "+e),o=Vn.createAndMarkAsIssued({origin:tye(r),reason:this._restrictedTelemetryEnabled?"Exception logged to restricted telemetry":"Exception, not logged due to opt-out"});if(o.makeReadyForSending(this._configService,this._envService,this._telemetryConfig),this.sendTelemetryEvent("exception",o.properties,o.measurements),!this._restrictedTelemetryEnabled||!this._restrictedTelemetryLogger)return;let s=Vn.createAndMarkAsIssued({origin:r});s.makeReadyForSending(this._configService,this._envService,this._telemetryConfig),this._restrictedTelemetryLogger.logError(n,s)}markAsIssuedAndMakeReadyForSending(e,r){let n=Vn.createAndMarkAsIssued(rne(e),r);n.makeReadyForSending(this._configService,this._envService,this._telemetryConfig);let o={};for(let s in n.properties)o[s]=new fy.TelemetryTrustedValue(n.properties[s]);return{properties:o,measurements:n.measurements}}dispose(){this._nonRestrictedTelemetryLogger.dispose(),this._disposables.forEach(e=>e.dispose()),this._restrictedTelemetryLogger&&this._restrictedTelemetryLogger.dispose()}};var uY=W(HSe());var l6=class{constructor(e,r,n,o){this._isInternal=!1;o.onCopilotToken(async s=>{if(this._username=(await Fp(e,{silent:!0}))?.account?.label,this._tid=s.token.getTokenValue("tid"),this._sku=s.token.getTokenValue("sku"),this._isInternal=s.token.isInternal,!s.token.organizationList.length||!s.envelope.chat_enabled){this._internalTelemetryReporter=void 0;return}s.token.isInternal&&(this._internalTelemetryReporter=new uY.default(r))}),this._externalTelemetryReporter=new uY.default(n)}dispose(){this._externalTelemetryReporter.dispose(),this._internalTelemetryReporter?.dispose()}postEvent(e,r){let n={};for(let[o,s]of r)n[o]=s;this._isInternal&&this.sendInternalTelemetryEvent(e,n),this.sendTelemetryEvent(e,n)}sendInternalTelemetryEvent(e,r,n){this._internalTelemetryReporter&&(r={...r,"common.tid":this._tid,"common.userName":this._username??"undefined"},this._internalTelemetryReporter.sendRawTelemetryEvent(e,r,n))}sendTelemetryEvent(e,r,n){r={...r,"common.tid":this._tid??"","common.sku":this._sku??"undefined"},this._isInternal&&(n={...n,"common.internal":1}),this._externalTelemetryReporter.sendTelemetryEvent(e,r,n)}sendTelemetryErrorEvent(e,r,n){r={...r,"common.sku":this._sku??"undefined"},this._isInternal&&(n={...n,"common.internal":1}),this._externalTelemetryReporter.sendTelemetryErrorEvent(e,r,n)}};var QS=class{constructor(e,r,n,o,s,a,c,u,l,d){this._sharedProperties={};this._disposables=[];this._microsoftTelemetryService=new l6(a,r,n,c),this._ghTelemetryService=new tO(a,u,l,d,e,o,s,c),this._disposables.push(this._microsoftTelemetryService,this._ghTelemetryService),this._disposables.push(c.onCopilotToken(p=>{this.sendMSFTTelemetryEvent("token",void 0,{chatEnabled:p.envelope.chat_enabled?1:0,snippyEnabled:p.envelope.public_suggestions==="enabled"?1:0,telemetryEnabled:p.envelope.telemetry==="enabled"?1:0})}))}dispose(){this._disposables.forEach(e=>e.dispose())}sendMSFTTelemetryEvent(e,r,n){this.sendTelemetryEvent(e,{github:!1,microsoft:!0},r,n)}sendMSFTTelemetryErrorEvent(e,r,n){this.sendTelemetryErrorEvent(e,{github:!1,microsoft:!0},r,n)}sendGHTelemetryEvent(e,r,n){this.sendTelemetryEvent(e,{github:!0,microsoft:!1},r,n)}sendGHTelemetryErrorEvent(e,r,n){this.sendTelemetryErrorEvent(e,{github:!0,microsoft:!1},r,n)}sendGHTelemetryException(e,r){this._ghTelemetryService.sendExceptionTelemetry(e,r)}sendRestrictedGHTelemetryEvent(e,r,n){r={...r,...this._sharedProperties},this._ghTelemetryService.sendRestrictedTelemetryEvent(e,r,n)}sendRestrictedGHTelemetryErrorEvent(e,r,n){r={...r,...this._sharedProperties},this._ghTelemetryService.sendRestrictedTelemetryErrorEvent(e,r,n)}sendInternalMSFTTelemetryEvent(e,r,n){r={...r,...this._sharedProperties},this._microsoftTelemetryService.sendInternalTelemetryEvent(e,r,n)}sendTelemetryEvent(e,r,n,o){n={...n,...this._sharedProperties},r.github&&this._ghTelemetryService.sendTelemetryEvent(e,n,o),r.microsoft&&this._microsoftTelemetryService.sendTelemetryEvent(e,n,o)}sendTelemetryErrorEvent(e,r,n,o){n={...n,...this._sharedProperties},r.github&&this._ghTelemetryService.sendTelemetryErrorEvent(e,n,o),r.microsoft&&this._microsoftTelemetryService.sendTelemetryErrorEvent(e,n,o)}setSharedProperty(e,r){this._sharedProperties[e]=r}postEvent(e,r){for(let[n,o]of Object.entries(this._sharedProperties))r.set(n,o);this._microsoftTelemetryService.postEvent(e,r)}};QS=B([T(5,be),T(6,Vi),T(7,Pt),T(8,LP),T(9,Ln)],QS);var lo=se("ITerminalService");var zSe=require("path"),GSe=require("process"),$g=require("vscode"),d6=new Map,dY=new Map;function VSe(){let t=$g.window.activeTerminal;return t===void 0?"":d6.get(t)?.join(`
`)||""}function $Se(){let t=$g.window.activeTerminal;if(t!==void 0)return dY.get(t)?.at(-1)}function WSe(){try{return $g.window.activeTerminal?.selection??""}catch{return""}}var lY;function KSe(){let t=$g.window.activeTerminal;if(t&&"shellPath"in t.creationOptions){let e=t.creationOptions.shellPath;if(e){let r,n=(0,zSe.basename)(e);if(n==="bash.exe")r="Git Bash";else{let o=n.replace(/\..+/,"");switch(o){case"pwsh":case"powershell":r="powershell";break;case"":break;default:r=o}}if(r)return lY=r,r}}return lY||(GSe.platform==="win32"?"powershell":"bash")}function jSe(t,e){t.push(e),t.length>40&&t.shift()}function EKe(t){let e=/(:?\x1b\[|\x9B)[=?>!]?[\d;:]*["$#'* ]?[a-zA-Z@^`{}|~]/g;return t&&(t=t.replace(e,"")),t}function YSe(){return[$g.window.onDidWriteTerminalData(t=>{let e=d6.get(t.terminal);e||(e=[],d6.set(t.terminal,e)),jSe(e,EKe(t.data))}),$g.window.onDidExecuteTerminalCommand(t=>{let e=dY.get(t.terminal);e||(e=[],dY.set(t.terminal,e)),jSe(e,t)}),$g.window.onDidCloseTerminal(t=>{d6.delete(t)})]}var p6=class extends St{constructor(){super();for(let e of YSe())this._register(e)}get terminalBuffer(){return VSe()}get terminalLastCommand(){return $Se()}get terminalSelection(){return WSe()}get terminalShellType(){return KSe()}};var Rc=se("ITestProvider");var Vo=W(require("vscode"));function pY(t){if(!t()){debugger;t(),Rm(new Qr("Assertion Failed"))}}var yb=class{constructor(e,r,n){this.owner=e;this.debugNameSource=r;this.referenceFn=n}getDebugName(e){return wKe(e,this)}},QSe=new Map,fY=new WeakMap;function wKe(t,e){let r=fY.get(t);if(r)return r;let n=RKe(t,e);if(n){let o=QSe.get(n)??0;o++,QSe.set(n,o);let s=o===1?n:`${n}#${o}`;return fY.set(t,s),s}}function RKe(t,e){let r=fY.get(t);if(r)return r;let n=e.owner?AKe(e.owner)+".":"",o,s=e.debugNameSource;if(s!==void 0)if(typeof s=="function"){if(o=s(),o!==void 0)return n+o}else return n+s;let a=e.referenceFn;if(a!==void 0&&(o=f6(a),o!==void 0))return n+o;if(e.owner!==void 0){let c=kKe(e.owner,t);if(c!==void 0)return n+c}}function kKe(t,e){for(let r in t)if(t[r]===e)return r}var XSe=new Map,JSe=new WeakMap;function AKe(t){let e=JSe.get(t);if(e)return e;let r=PKe(t),n=XSe.get(r)??0;n++,XSe.set(r,n);let o=n===1?r:`${r}#${n}`;return JSe.set(t,o),o}function PKe(t){let e=t.constructor;return e?e.name:"Object"}function f6(t){let e=t.toString(),n=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(e);return(n?n[1]:void 0)?.trim()}var DKe;function Wg(){return DKe}function h6(t){return new m6(new yb(void 0,void 0,t),t,void 0,void 0)}var m6=class{constructor(e,r,n,o){this._debugNameData=e;this._runFn=r;this.createChangeSummary=n;this._handleChange=o;this.state=2;this.updateCount=0;this.disposed=!1;this.dependencies=new Set;this.dependenciesToBeRemoved=new Set;this.changeSummary=this.createChangeSummary?.(),Wg()?.handleAutorunCreated(this),this._runIfNeeded(),h_(this)}get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}dispose(){this.disposed=!0;for(let e of this.dependencies)e.removeObserver(this);this.dependencies.clear(),g_(this)}_runIfNeeded(){if(this.state===3)return;let e=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=e,this.state=3;let r=this.disposed;try{if(!r){Wg()?.handleAutorunTriggered(this);let n=this.changeSummary;this.changeSummary=this.createChangeSummary?.(),this._runFn(this,n)}}finally{r||Wg()?.handleAutorunFinished(this);for(let n of this.dependenciesToBeRemoved)n.removeObserver(this);this.dependenciesToBeRemoved.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(){this.state===3&&(this.state=1),this.updateCount++}endUpdate(){if(this.updateCount===1)do{if(this.state===1){this.state=3;for(let e of this.dependencies)if(e.reportChanges(),this.state===2)break}this._runIfNeeded()}while(this.state!==3);this.updateCount--,pY(()=>this.updateCount>=0)}handlePossibleChange(e){this.state===3&&this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)&&(this.state=1)}handleChange(e,r){this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)&&(!this._handleChange||this._handleChange({changedObservable:e,change:r,didChange:o=>o===e},this.changeSummary))&&(this.state=2)}readObservable(e){if(this.disposed)return e.get();e.addObserver(this);let r=e.get();return this.dependencies.add(e),this.dependenciesToBeRemoved.delete(e),r}};(e=>e.Observer=m6)(h6||={});var ZSe=(t,e)=>t===e;var NKe;var LKe;var OKe;var mY=class{get TChange(){return null}reportChanges(){this.get()}read(e){return e?e.readObservable(this):this.get()}map(e,r){let n=r===void 0?void 0:e,o=r===void 0?e:r;return OKe({owner:n,debugName:()=>{let s=f6(o);if(s!==void 0)return s;let c=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(o.toString());if(c)return`${this.debugName}.${c[2]}`;if(!n)return`${this.debugName} (mapped)`},debugReferenceFn:o},s=>o(this.read(s),s))}recomputeInitiallyAndOnChange(e,r){return e.add(NKe(this,r)),this}keepObserved(e){return e.add(LKe(this)),this}get debugValue(){return this.get()}},hY=class extends mY{constructor(){super(...arguments);this.observers=new Set}addObserver(r){let n=this.observers.size;this.observers.add(r),n===0&&this.onFirstObserverAdded()}removeObserver(r){this.observers.delete(r)&&this.observers.size===0&&this.onLastObserverRemoved()}onFirstObserverAdded(){}onLastObserverRemoved(){}};var gY=class{constructor(e,r){this._fn=e;this._getDebugName=r;this.updatingObservers=[];Wg()?.handleBeginTransaction(this)}getDebugName(){return this._getDebugName?this._getDebugName():f6(this._fn)}updateObserver(e,r){this.updatingObservers.push({observer:e,observable:r}),e.beginUpdate(r)}finish(){let e=this.updatingObservers;for(let r=0;r<e.length;r++){let{observer:n,observable:o}=e[r];n.endUpdate(o)}this.updatingObservers=null,Wg()?.handleEndTransaction()}};function eIe(t,e){let r;return typeof t=="string"?r=new yb(void 0,t,void 0):r=new yb(t,void 0,void 0),new vY(r,e,ZSe)}var vY=class extends hY{constructor(r,n,o){super();this._debugNameData=r;this._equalityComparator=o;this._value=n}get debugName(){return this._debugNameData.getDebugName(this)??"ObservableValue"}get(){return this._value}set(r,n,o){if(o===void 0&&this._equalityComparator(this._value,r))return;let s;n||(n=s=new gY(()=>{},()=>`Setting ${this.debugName}`));try{let a=this._value;this._setValue(r),Wg()?.handleObservableChanged(this,{oldValue:a,newValue:r,change:o,didChange:!0,hadValue:!0});for(let c of this.observers)n.updateObserver(c,this),c.handleChange(this,o)}finally{s&&s.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(r){this._value=r}};var g6=class extends St{constructor(){super();this.resultsDocs=new Pn;this.isEnabled=eIe("TestProvider.isEnabled",!1);this._register(h6(r=>{Vo.commands.executeCommand("setContext","github.copilot.chat.fixTestFailures.enabled",this.isEnabled.read(r))})),this._register(Vo.tests.onDidChangeTestResults(()=>this.setHasFailureContextKey())),this.setHasFailureContextKey()}setHasFailureContextKey(){Vo.commands.executeCommand("setContext","github.copilot.chat.fixTestFailures.hasFailure",!!ks.first(this.getAllFailures()))}get lastResultsFrom(){return Vo.tests.testResults[0]?.completedAt}async setEnablement(r){let n=await r.getTreatmentVariableAsync("vscode","copilotchat.fixTestFailures"),o=Vo.env.appName.includes("Insiders")||Vo.env.appName.includes("OSS"),s=n||o;this.isEnabled.set(s,void 0)}getAllFailures(){let r=Vo.tests.testResults[0];return r?this.dfsFailures(r.results):ks.empty()}getFailureAtPosition(r,n){let o=Vo.tests.testResults[0];if(this.resultsDocsAreForTestRun!==o&&this.makeResultsDocs(o),!o)return;let s=this.resultsDocs.get(r)||[],a=tre(s,c=>!c.range?.start.isAfter(n));if(a){for(let c of a.taskStates)if(c.state===Vo.TestResultState.Failed||c.state===Vo.TestResultState.Errored)return{snapshot:a,task:c}}}*dfsFailures(r){for(let n of r){yield*this.dfsFailures(n.children);for(let o of n.taskStates)(o.state===Vo.TestResultState.Failed||o.state===Vo.TestResultState.Errored)&&(yield{snapshot:n,task:o})}}makeResultsDocs(r){if(this.resultsDocs.clear(),this.resultsDocsAreForTestRun=r,!r)return;let n=[r.results];for(;n.length;)for(let s of n.pop()){if(n.push(s.children),!s.uri)continue;let a=this.resultsDocs.get(s.uri);a?a.push(s):this.resultsDocs.set(s.uri,[s])}let o=new Vo.Range(0,0,0,0);for(let s of this.resultsDocs.values())s.sort((a,c)=>(a.range||o).start.compareTo((c.range||o).start)||MKe(a.taskStates,c.taskStates))}},MKe=(t,e)=>{let r=0,n=0;for(let o of t)r=Math.max(r,o.state);for(let o of e)n=Math.max(n,o.state);return r-n};var Ze=se("IWorkspaceService"),v6=class{getWorkspaceFolder(e){return this.getWorkspaceFolders().find(r=>r.scheme===e.scheme&&r.authority===e.authority&&e.fsPath.startsWith(r.fsPath))}};function Kg(t,e){let r=t.getWorkspaceFolder(e);return r?hr.relative(r.path,e.path):e.path}var Yg=require("vscode");function tIe(t){return t.scheme==="vscode-vfs"&&t.authority.startsWith("github")}var XS=class extends v6{constructor(r){super();this._accessor=r;this.onDidOpenTextDocument=Yg.workspace.onDidOpenTextDocument;this.onDidChangeTextDocument=Yg.workspace.onDidChangeTextDocument;this.onDidCloseTextDocument=Yg.workspace.onDidCloseTextDocument;this._logger=this._accessor.get(ce).getLogger("ExtensionTextDocumentManager")}get textDocuments(){return Yg.workspace.textDocuments}async openTextDocument(r){return await Yg.workspace.openTextDocument(r)}get notebookDocuments(){return Yg.workspace.notebookDocuments}getWorkspaceFolders(){return Yg.workspace.workspaceFolders?.map(r=>r.uri)??[]}ensureWorkspaceIsFullyLoaded(){return this._fullyLoadedPromise??=(async()=>{let r=this._accessor.get(RD);for(let n of this.getWorkspaceFolders())if(tIe(n)){this._logger.debug(`Preloading virtual workspace contents for ${n}`);try{let o=await r.loadWorkspaceContents(n);this._logger.info(`loading virtual workspace contents resulted in ${o} for: ${n}`)}catch(o){this._logger.error(`Error loading virtual workspace contents for ${n}: ${o}`)}}})(),this._fullyLoadedPromise}};XS=B([T(0,rt)],XS);var JS=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,nIe=new Set,yY=typeof process=="object"&&process?process:{},iIe=(t,e,r,n)=>{typeof yY.emitWarning=="function"?yY.emitWarning(t,e,r,n):console.error(`[${r}] ${e}: ${t}`)},y6=globalThis.AbortController,rIe=globalThis.AbortSignal;if(typeof y6>"u"){rIe=class{onabort;_onabort=[];reason;aborted=!1;addEventListener(n,o){this._onabort.push(o)}},y6=class{constructor(){e()}signal=new rIe;abort(n){if(!this.signal.aborted){this.signal.reason=n,this.signal.aborted=!0;for(let o of this.signal._onabort)o(n);this.signal.onabort?.(n)}}};let t=yY.env?.LRU_CACHE_IGNORE_AC_WARNING!=="1",e=()=>{t&&(t=!1,iIe("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",e))}}var FKe=t=>!nIe.has(t),xqt=Symbol("type"),Qg=t=>t&&t===Math.floor(t)&&t>0&&isFinite(t),oIe=t=>Qg(t)?t<=Math.pow(2,8)?Uint8Array:t<=Math.pow(2,16)?Uint16Array:t<=Math.pow(2,32)?Uint32Array:t<=Number.MAX_SAFE_INTEGER?ZS:null:null,ZS=class extends Array{constructor(e){super(e),this.fill(0)}},bY=class t{heap;length;static#t=!1;static create(e){let r=oIe(e);if(!r)return[];t.#t=!0;let n=new t(e,r);return t.#t=!1,n}constructor(e,r){if(!t.#t)throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new r(e),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}},b6=class t{#t;#i;#d;#r;#c;ttl;ttlResolution;ttlAutopurge;updateAgeOnGet;updateAgeOnHas;allowStale;noDisposeOnSet;noUpdateTTL;maxEntrySize;sizeCalculation;noDeleteOnFetchRejection;noDeleteOnStaleGet;allowStaleOnFetchAbort;allowStaleOnFetchRejection;ignoreFetchAbort;#a;#m;#s;#n;#e;#p;#h;#l;#u;#v;#f;#_;#x;#y;#S;#E;#g;static unsafeExposeInternals(e){return{starts:e.#x,ttls:e.#y,sizes:e.#_,keyMap:e.#s,keyList:e.#n,valList:e.#e,next:e.#p,prev:e.#h,get head(){return e.#l},get tail(){return e.#u},free:e.#v,isBackgroundFetch:r=>e.#o(r),backgroundFetch:(r,n,o,s)=>e.#D(r,n,o,s),moveToTail:r=>e.#k(r),indexes:r=>e.#I(r),rindexes:r=>e.#C(r),isStale:r=>e.#b(r)}}get max(){return this.#t}get maxSize(){return this.#i}get calculatedSize(){return this.#m}get size(){return this.#a}get fetchMethod(){return this.#c}get dispose(){return this.#d}get disposeAfter(){return this.#r}constructor(e){let{max:r=0,ttl:n,ttlResolution:o=1,ttlAutopurge:s,updateAgeOnGet:a,updateAgeOnHas:c,allowStale:u,dispose:l,disposeAfter:d,noDisposeOnSet:p,noUpdateTTL:f,maxSize:m=0,maxEntrySize:h=0,sizeCalculation:g,fetchMethod:v,noDeleteOnFetchRejection:y,noDeleteOnStaleGet:_,allowStaleOnFetchRejection:b,allowStaleOnFetchAbort:S,ignoreFetchAbort:I}=e;if(r!==0&&!Qg(r))throw new TypeError("max option must be a nonnegative integer");let w=r?oIe(r):Array;if(!w)throw new Error("invalid max value: "+r);if(this.#t=r,this.#i=m,this.maxEntrySize=h||this.#i,this.sizeCalculation=g,this.sizeCalculation){if(!this.#i&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(v!==void 0&&typeof v!="function")throw new TypeError("fetchMethod must be a function if specified");if(this.#c=v,this.#E=!!v,this.#s=new Map,this.#n=new Array(r).fill(void 0),this.#e=new Array(r).fill(void 0),this.#p=new w(r),this.#h=new w(r),this.#l=0,this.#u=0,this.#v=bY.create(r),this.#a=0,this.#m=0,typeof l=="function"&&(this.#d=l),typeof d=="function"?(this.#r=d,this.#f=[]):(this.#r=void 0,this.#f=void 0),this.#S=!!this.#d,this.#g=!!this.#r,this.noDisposeOnSet=!!p,this.noUpdateTTL=!!f,this.noDeleteOnFetchRejection=!!y,this.allowStaleOnFetchRejection=!!b,this.allowStaleOnFetchAbort=!!S,this.ignoreFetchAbort=!!I,this.maxEntrySize!==0){if(this.#i!==0&&!Qg(this.#i))throw new TypeError("maxSize must be a positive integer if specified");if(!Qg(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.#U()}if(this.allowStale=!!u,this.noDeleteOnStaleGet=!!_,this.updateAgeOnGet=!!a,this.updateAgeOnHas=!!c,this.ttlResolution=Qg(o)||o===0?o:1,this.ttlAutopurge=!!s,this.ttl=n||0,this.ttl){if(!Qg(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.#N()}if(this.#t===0&&this.ttl===0&&this.#i===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.#t&&!this.#i){let O="LRU_CACHE_UNBOUNDED";FKe(O)&&(nIe.add(O),iIe("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",O,t))}}getRemainingTTL(e){return this.#s.has(e)?1/0:0}#N(){let e=new ZS(this.#t),r=new ZS(this.#t);this.#y=e,this.#x=r,this.#L=(s,a,c=JS.now())=>{if(r[s]=a!==0?c:0,e[s]=a,a!==0&&this.ttlAutopurge){let u=setTimeout(()=>{this.#b(s)&&this.delete(this.#n[s])},a+1);u.unref&&u.unref()}},this.#w=s=>{r[s]=e[s]!==0?JS.now():0},this.#T=(s,a)=>{if(e[a]){let c=e[a],u=r[a];if(!c||!u)return;s.ttl=c,s.start=u,s.now=n||o();let l=s.now-u;s.remainingTTL=c-l}};let n=0,o=()=>{let s=JS.now();if(this.ttlResolution>0){n=s;let a=setTimeout(()=>n=0,this.ttlResolution);a.unref&&a.unref()}return s};this.getRemainingTTL=s=>{let a=this.#s.get(s);if(a===void 0)return 0;let c=e[a],u=r[a];if(!c||!u)return 1/0;let l=(n||o())-u;return c-l},this.#b=s=>{let a=r[s],c=e[s];return!!c&&!!a&&(n||o())-a>c}}#w=()=>{};#T=()=>{};#L=()=>{};#b=()=>!1;#U(){let e=new ZS(this.#t);this.#m=0,this.#_=e,this.#R=r=>{this.#m-=e[r],e[r]=0},this.#O=(r,n,o,s)=>{if(this.#o(n))return 0;if(!Qg(o))if(s){if(typeof s!="function")throw new TypeError("sizeCalculation must be a function");if(o=s(n,r),!Qg(o))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return o},this.#A=(r,n,o)=>{if(e[r]=n,this.#i){let s=this.#i-e[r];for(;this.#m>s;)this.#P(!0)}this.#m+=e[r],o&&(o.entrySize=n,o.totalCalculatedSize=this.#m)}}#R=e=>{};#A=(e,r,n)=>{};#O=(e,r,n,o)=>{if(n||o)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0};*#I({allowStale:e=this.allowStale}={}){if(this.#a)for(let r=this.#u;!(!this.#M(r)||((e||!this.#b(r))&&(yield r),r===this.#l));)r=this.#h[r]}*#C({allowStale:e=this.allowStale}={}){if(this.#a)for(let r=this.#l;!(!this.#M(r)||((e||!this.#b(r))&&(yield r),r===this.#u));)r=this.#p[r]}#M(e){return e!==void 0&&this.#s.get(this.#n[e])===e}*entries(){for(let e of this.#I())this.#e[e]!==void 0&&this.#n[e]!==void 0&&!this.#o(this.#e[e])&&(yield[this.#n[e],this.#e[e]])}*rentries(){for(let e of this.#C())this.#e[e]!==void 0&&this.#n[e]!==void 0&&!this.#o(this.#e[e])&&(yield[this.#n[e],this.#e[e]])}*keys(){for(let e of this.#I()){let r=this.#n[e];r!==void 0&&!this.#o(this.#e[e])&&(yield r)}}*rkeys(){for(let e of this.#C()){let r=this.#n[e];r!==void 0&&!this.#o(this.#e[e])&&(yield r)}}*values(){for(let e of this.#I())this.#e[e]!==void 0&&!this.#o(this.#e[e])&&(yield this.#e[e])}*rvalues(){for(let e of this.#C())this.#e[e]!==void 0&&!this.#o(this.#e[e])&&(yield this.#e[e])}[Symbol.iterator](){return this.entries()}[Symbol.toStringTag]="LRUCache";find(e,r={}){for(let n of this.#I()){let o=this.#e[n],s=this.#o(o)?o.__staleWhileFetching:o;if(s!==void 0&&e(s,this.#n[n],this))return this.get(this.#n[n],r)}}forEach(e,r=this){for(let n of this.#I()){let o=this.#e[n],s=this.#o(o)?o.__staleWhileFetching:o;s!==void 0&&e.call(r,s,this.#n[n],this)}}rforEach(e,r=this){for(let n of this.#C()){let o=this.#e[n],s=this.#o(o)?o.__staleWhileFetching:o;s!==void 0&&e.call(r,s,this.#n[n],this)}}purgeStale(){let e=!1;for(let r of this.#C({allowStale:!0}))this.#b(r)&&(this.delete(this.#n[r]),e=!0);return e}info(e){let r=this.#s.get(e);if(r===void 0)return;let n=this.#e[r],o=this.#o(n)?n.__staleWhileFetching:n;if(o===void 0)return;let s={value:o};if(this.#y&&this.#x){let a=this.#y[r],c=this.#x[r];if(a&&c){let u=a-(JS.now()-c);s.ttl=u,s.start=Date.now()}}return this.#_&&(s.size=this.#_[r]),s}dump(){let e=[];for(let r of this.#I({allowStale:!0})){let n=this.#n[r],o=this.#e[r],s=this.#o(o)?o.__staleWhileFetching:o;if(s===void 0||n===void 0)continue;let a={value:s};if(this.#y&&this.#x){a.ttl=this.#y[r];let c=JS.now()-this.#x[r];a.start=Math.floor(Date.now()-c)}this.#_&&(a.size=this.#_[r]),e.unshift([n,a])}return e}load(e){this.clear();for(let[r,n]of e){if(n.start){let o=Date.now()-n.start;n.start=JS.now()-o}this.set(r,n.value,n)}}set(e,r,n={}){if(r===void 0)return this.delete(e),this;let{ttl:o=this.ttl,start:s,noDisposeOnSet:a=this.noDisposeOnSet,sizeCalculation:c=this.sizeCalculation,status:u}=n,{noUpdateTTL:l=this.noUpdateTTL}=n,d=this.#O(e,r,n.size||0,c);if(this.maxEntrySize&&d>this.maxEntrySize)return u&&(u.set="miss",u.maxEntrySizeExceeded=!0),this.delete(e),this;let p=this.#a===0?void 0:this.#s.get(e);if(p===void 0)p=this.#a===0?this.#u:this.#v.length!==0?this.#v.pop():this.#a===this.#t?this.#P(!1):this.#a,this.#n[p]=e,this.#e[p]=r,this.#s.set(e,p),this.#p[this.#u]=p,this.#h[p]=this.#u,this.#u=p,this.#a++,this.#A(p,d,u),u&&(u.set="add"),l=!1;else{this.#k(p);let f=this.#e[p];if(r!==f){if(this.#E&&this.#o(f)){f.__abortController.abort(new Error("replaced"));let{__staleWhileFetching:m}=f;m!==void 0&&!a&&(this.#S&&this.#d?.(m,e,"set"),this.#g&&this.#f?.push([m,e,"set"]))}else a||(this.#S&&this.#d?.(f,e,"set"),this.#g&&this.#f?.push([f,e,"set"]));if(this.#R(p),this.#A(p,d,u),this.#e[p]=r,u){u.set="replace";let m=f&&this.#o(f)?f.__staleWhileFetching:f;m!==void 0&&(u.oldValue=m)}}else u&&(u.set="update")}if(o!==0&&!this.#y&&this.#N(),this.#y&&(l||this.#L(p,o,s),u&&this.#T(u,p)),!a&&this.#g&&this.#f){let f=this.#f,m;for(;m=f?.shift();)this.#r?.(...m)}return this}pop(){try{for(;this.#a;){let e=this.#e[this.#l];if(this.#P(!0),this.#o(e)){if(e.__staleWhileFetching)return e.__staleWhileFetching}else if(e!==void 0)return e}}finally{if(this.#g&&this.#f){let e=this.#f,r;for(;r=e?.shift();)this.#r?.(...r)}}}#P(e){let r=this.#l,n=this.#n[r],o=this.#e[r];return this.#E&&this.#o(o)?o.__abortController.abort(new Error("evicted")):(this.#S||this.#g)&&(this.#S&&this.#d?.(o,n,"evict"),this.#g&&this.#f?.push([o,n,"evict"])),this.#R(r),e&&(this.#n[r]=void 0,this.#e[r]=void 0,this.#v.push(r)),this.#a===1?(this.#l=this.#u=0,this.#v.length=0):this.#l=this.#p[r],this.#s.delete(n),this.#a--,r}has(e,r={}){let{updateAgeOnHas:n=this.updateAgeOnHas,status:o}=r,s=this.#s.get(e);if(s!==void 0){let a=this.#e[s];if(this.#o(a)&&a.__staleWhileFetching===void 0)return!1;if(this.#b(s))o&&(o.has="stale",this.#T(o,s));else return n&&this.#w(s),o&&(o.has="hit",this.#T(o,s)),!0}else o&&(o.has="miss");return!1}peek(e,r={}){let{allowStale:n=this.allowStale}=r,o=this.#s.get(e);if(o===void 0||!n&&this.#b(o))return;let s=this.#e[o];return this.#o(s)?s.__staleWhileFetching:s}#D(e,r,n,o){let s=r===void 0?void 0:this.#e[r];if(this.#o(s))return s;let a=new y6,{signal:c}=n;c?.addEventListener("abort",()=>a.abort(c.reason),{signal:a.signal});let u={signal:a.signal,options:n,context:o},l=(g,v=!1)=>{let{aborted:y}=a.signal,_=n.ignoreFetchAbort&&g!==void 0;if(n.status&&(y&&!v?(n.status.fetchAborted=!0,n.status.fetchError=a.signal.reason,_&&(n.status.fetchAbortIgnored=!0)):n.status.fetchResolved=!0),y&&!_&&!v)return p(a.signal.reason);let b=m;return this.#e[r]===m&&(g===void 0?b.__staleWhileFetching?this.#e[r]=b.__staleWhileFetching:this.delete(e):(n.status&&(n.status.fetchUpdated=!0),this.set(e,g,u.options))),g},d=g=>(n.status&&(n.status.fetchRejected=!0,n.status.fetchError=g),p(g)),p=g=>{let{aborted:v}=a.signal,y=v&&n.allowStaleOnFetchAbort,_=y||n.allowStaleOnFetchRejection,b=_||n.noDeleteOnFetchRejection,S=m;if(this.#e[r]===m&&(!b||S.__staleWhileFetching===void 0?this.delete(e):y||(this.#e[r]=S.__staleWhileFetching)),_)return n.status&&S.__staleWhileFetching!==void 0&&(n.status.returnedStale=!0),S.__staleWhileFetching;if(S.__returned===S)throw g},f=(g,v)=>{let y=this.#c?.(e,s,u);y&&y instanceof Promise&&y.then(_=>g(_===void 0?void 0:_),v),a.signal.addEventListener("abort",()=>{(!n.ignoreFetchAbort||n.allowStaleOnFetchAbort)&&(g(void 0),n.allowStaleOnFetchAbort&&(g=_=>l(_,!0)))})};n.status&&(n.status.fetchDispatched=!0);let m=new Promise(f).then(l,d),h=Object.assign(m,{__abortController:a,__staleWhileFetching:s,__returned:void 0});return r===void 0?(this.set(e,h,{...u.options,status:void 0}),r=this.#s.get(e)):this.#e[r]=h,h}#o(e){if(!this.#E)return!1;let r=e;return!!r&&r instanceof Promise&&r.hasOwnProperty("__staleWhileFetching")&&r.__abortController instanceof y6}async fetch(e,r={}){let{allowStale:n=this.allowStale,updateAgeOnGet:o=this.updateAgeOnGet,noDeleteOnStaleGet:s=this.noDeleteOnStaleGet,ttl:a=this.ttl,noDisposeOnSet:c=this.noDisposeOnSet,size:u=0,sizeCalculation:l=this.sizeCalculation,noUpdateTTL:d=this.noUpdateTTL,noDeleteOnFetchRejection:p=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:f=this.allowStaleOnFetchRejection,ignoreFetchAbort:m=this.ignoreFetchAbort,allowStaleOnFetchAbort:h=this.allowStaleOnFetchAbort,context:g,forceRefresh:v=!1,status:y,signal:_}=r;if(!this.#E)return y&&(y.fetch="get"),this.get(e,{allowStale:n,updateAgeOnGet:o,noDeleteOnStaleGet:s,status:y});let b={allowStale:n,updateAgeOnGet:o,noDeleteOnStaleGet:s,ttl:a,noDisposeOnSet:c,size:u,sizeCalculation:l,noUpdateTTL:d,noDeleteOnFetchRejection:p,allowStaleOnFetchRejection:f,allowStaleOnFetchAbort:h,ignoreFetchAbort:m,status:y,signal:_},S=this.#s.get(e);if(S===void 0){y&&(y.fetch="miss");let I=this.#D(e,S,b,g);return I.__returned=I}else{let I=this.#e[S];if(this.#o(I)){let M=n&&I.__staleWhileFetching!==void 0;return y&&(y.fetch="inflight",M&&(y.returnedStale=!0)),M?I.__staleWhileFetching:I.__returned=I}let w=this.#b(S);if(!v&&!w)return y&&(y.fetch="hit"),this.#k(S),o&&this.#w(S),y&&this.#T(y,S),I;let O=this.#D(e,S,b,g),z=O.__staleWhileFetching!==void 0&&n;return y&&(y.fetch=w?"stale":"refresh",z&&w&&(y.returnedStale=!0)),z?O.__staleWhileFetching:O.__returned=O}}get(e,r={}){let{allowStale:n=this.allowStale,updateAgeOnGet:o=this.updateAgeOnGet,noDeleteOnStaleGet:s=this.noDeleteOnStaleGet,status:a}=r,c=this.#s.get(e);if(c!==void 0){let u=this.#e[c],l=this.#o(u);return a&&this.#T(a,c),this.#b(c)?(a&&(a.get="stale"),l?(a&&n&&u.__staleWhileFetching!==void 0&&(a.returnedStale=!0),n?u.__staleWhileFetching:void 0):(s||this.delete(e),a&&n&&(a.returnedStale=!0),n?u:void 0)):(a&&(a.get="hit"),l?u.__staleWhileFetching:(this.#k(c),o&&this.#w(c),u))}else a&&(a.get="miss")}#F(e,r){this.#h[r]=e,this.#p[e]=r}#k(e){e!==this.#u&&(e===this.#l?this.#l=this.#p[e]:this.#F(this.#h[e],this.#p[e]),this.#F(this.#u,e),this.#u=e)}delete(e){let r=!1;if(this.#a!==0){let n=this.#s.get(e);if(n!==void 0)if(r=!0,this.#a===1)this.clear();else{this.#R(n);let o=this.#e[n];if(this.#o(o)?o.__abortController.abort(new Error("deleted")):(this.#S||this.#g)&&(this.#S&&this.#d?.(o,e,"delete"),this.#g&&this.#f?.push([o,e,"delete"])),this.#s.delete(e),this.#n[n]=void 0,this.#e[n]=void 0,n===this.#u)this.#u=this.#h[n];else if(n===this.#l)this.#l=this.#p[n];else{let s=this.#h[n];this.#p[s]=this.#p[n];let a=this.#p[n];this.#h[a]=this.#h[n]}this.#a--,this.#v.push(n)}}if(this.#g&&this.#f?.length){let n=this.#f,o;for(;o=n?.shift();)this.#r?.(...o)}return r}clear(){for(let e of this.#C({allowStale:!0})){let r=this.#e[e];if(this.#o(r))r.__abortController.abort(new Error("deleted"));else{let n=this.#n[e];this.#S&&this.#d?.(r,n,"delete"),this.#g&&this.#f?.push([r,n,"delete"])}}if(this.#s.clear(),this.#e.fill(void 0),this.#n.fill(void 0),this.#y&&this.#x&&(this.#y.fill(0),this.#x.fill(0)),this.#_&&this.#_.fill(0),this.#l=0,this.#u=0,this.#v.length=0,this.#m=0,this.#a=0,this.#g&&this.#f){let e=this.#f,r;for(;r=e?.shift();)this.#r?.(...r)}}};var RY={};dn(RY,{arrayReplaceAt:()=>wY,assign:()=>rI,escapeHtml:()=>Qf,escapeRE:()=>_Ye,fromCodePoint:()=>Wk,has:()=>uYe,isMdAsciiPunct:()=>xb,isPunctChar:()=>_b,isSpace:()=>ur,isString:()=>A6,isValidEntityCode:()=>P6,isWhiteSpace:()=>bb,lib:()=>xYe,normalizeReference:()=>Sb,unescapeAll:()=>Zg,unescapeMd:()=>mYe});var C6={};dn(C6,{decode:()=>Vk,encode:()=>S6,format:()=>eI,parse:()=>$k});var sIe={};function UKe(t){let e=sIe[t];if(e)return e;e=sIe[t]=[];for(let r=0;r<128;r++){let n=String.fromCharCode(r);e.push(n)}for(let r=0;r<t.length;r++){let n=t.charCodeAt(r);e[n]="%"+("0"+n.toString(16).toUpperCase()).slice(-2)}return e}function _6(t,e){typeof e!="string"&&(e=_6.defaultChars);let r=UKe(e);return t.replace(/(%[a-f0-9]{2})+/gi,function(n){let o="";for(let s=0,a=n.length;s<a;s+=3){let c=parseInt(n.slice(s+1,s+3),16);if(c<128){o+=r[c];continue}if((c&224)===192&&s+3<a){let u=parseInt(n.slice(s+4,s+6),16);if((u&192)===128){let l=c<<6&1984|u&63;l<128?o+="\uFFFD\uFFFD":o+=String.fromCharCode(l),s+=3;continue}}if((c&240)===224&&s+6<a){let u=parseInt(n.slice(s+4,s+6),16),l=parseInt(n.slice(s+7,s+9),16);if((u&192)===128&&(l&192)===128){let d=c<<12&61440|u<<6&4032|l&63;d<2048||d>=55296&&d<=57343?o+="\uFFFD\uFFFD\uFFFD":o+=String.fromCharCode(d),s+=6;continue}}if((c&248)===240&&s+9<a){let u=parseInt(n.slice(s+4,s+6),16),l=parseInt(n.slice(s+7,s+9),16),d=parseInt(n.slice(s+10,s+12),16);if((u&192)===128&&(l&192)===128&&(d&192)===128){let p=c<<18&1835008|u<<12&258048|l<<6&4032|d&63;p<65536||p>1114111?o+="\uFFFD\uFFFD\uFFFD\uFFFD":(p-=65536,o+=String.fromCharCode(55296+(p>>10),56320+(p&1023))),s+=9;continue}}o+="\uFFFD"}return o})}_6.defaultChars=";/?:@&=+$,#";_6.componentChars="";var Vk=_6;var aIe={};function BKe(t){let e=aIe[t];if(e)return e;e=aIe[t]=[];for(let r=0;r<128;r++){let n=String.fromCharCode(r);/^[0-9a-z]$/i.test(n)?e.push(n):e.push("%"+("0"+r.toString(16).toUpperCase()).slice(-2))}for(let r=0;r<t.length;r++)e[t.charCodeAt(r)]=t[r];return e}function x6(t,e,r){typeof e!="string"&&(r=e,e=x6.defaultChars),typeof r>"u"&&(r=!0);let n=BKe(e),o="";for(let s=0,a=t.length;s<a;s++){let c=t.charCodeAt(s);if(r&&c===37&&s+2<a&&/^[0-9a-f]{2}$/i.test(t.slice(s+1,s+3))){o+=t.slice(s,s+3),s+=2;continue}if(c<128){o+=n[c];continue}if(c>=55296&&c<=57343){if(c>=55296&&c<=56319&&s+1<a){let u=t.charCodeAt(s+1);if(u>=56320&&u<=57343){o+=encodeURIComponent(t[s]+t[s+1]),s++;continue}}o+="%EF%BF%BD";continue}o+=encodeURIComponent(t[s])}return o}x6.defaultChars=";/?:@&=+$,-_.!~*'()#";x6.componentChars="-_.!~*'()";var S6=x6;function eI(t){let e="";return e+=t.protocol||"",e+=t.slashes?"//":"",e+=t.auth?t.auth+"@":"",t.hostname&&t.hostname.indexOf(":")!==-1?e+="["+t.hostname+"]":e+=t.hostname||"",e+=t.port?":"+t.port:"",e+=t.pathname||"",e+=t.search||"",e+=t.hash||"",e}function I6(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}var qKe=/^([a-z0-9.+-]+:)/i,HKe=/:[0-9]*$/,jKe=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,zKe=["<",">",'"',"`"," ","\r",`
`,"	"],GKe=["{","}","|","\\","^","`"].concat(zKe),VKe=["'"].concat(GKe),cIe=["%","/","?",";","#"].concat(VKe),uIe=["/","?","#"],$Ke=255,lIe=/^[+a-z0-9A-Z_-]{0,63}$/,WKe=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,dIe={javascript:!0,"javascript:":!0},pIe={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function KKe(t,e){if(t&&t instanceof I6)return t;let r=new I6;return r.parse(t,e),r}I6.prototype.parse=function(t,e){let r,n,o,s=t;if(s=s.trim(),!e&&t.split("#").length===1){let l=jKe.exec(s);if(l)return this.pathname=l[1],l[2]&&(this.search=l[2]),this}let a=qKe.exec(s);if(a&&(a=a[0],r=a.toLowerCase(),this.protocol=a,s=s.substr(a.length)),(e||a||s.match(/^\/\/[^@\/]+@[^@\/]+/))&&(o=s.substr(0,2)==="//",o&&!(a&&dIe[a])&&(s=s.substr(2),this.slashes=!0)),!dIe[a]&&(o||a&&!pIe[a])){let l=-1;for(let h=0;h<uIe.length;h++)n=s.indexOf(uIe[h]),n!==-1&&(l===-1||n<l)&&(l=n);let d,p;l===-1?p=s.lastIndexOf("@"):p=s.lastIndexOf("@",l),p!==-1&&(d=s.slice(0,p),s=s.slice(p+1),this.auth=d),l=-1;for(let h=0;h<cIe.length;h++)n=s.indexOf(cIe[h]),n!==-1&&(l===-1||n<l)&&(l=n);l===-1&&(l=s.length),s[l-1]===":"&&l--;let f=s.slice(0,l);s=s.slice(l),this.parseHost(f),this.hostname=this.hostname||"";let m=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!m){let h=this.hostname.split(/\./);for(let g=0,v=h.length;g<v;g++){let y=h[g];if(y&&!y.match(lIe)){let _="";for(let b=0,S=y.length;b<S;b++)y.charCodeAt(b)>127?_+="x":_+=y[b];if(!_.match(lIe)){let b=h.slice(0,g),S=h.slice(g+1),I=y.match(WKe);I&&(b.push(I[1]),S.unshift(I[2])),S.length&&(s=S.join(".")+s),this.hostname=b.join(".");break}}}}this.hostname.length>$Ke&&(this.hostname=""),m&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}let c=s.indexOf("#");c!==-1&&(this.hash=s.substr(c),s=s.slice(0,c));let u=s.indexOf("?");return u!==-1&&(this.search=s.substr(u),s=s.slice(0,u)),s&&(this.pathname=s),pIe[r]&&this.hostname&&!this.pathname&&(this.pathname=""),this};I6.prototype.parseHost=function(t){let e=HKe.exec(t);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)};var $k=KKe;var _Y={};dn(_Y,{Any:()=>T6,Cc:()=>E6,Cf:()=>fIe,P:()=>tI,Z:()=>w6});var T6=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/;var E6=/[\0-\x1F\x7F-\x9F]/;var fIe=/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u0890\u0891\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD80D[\uDC30-\uDC3F]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/;var tI=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/;var w6=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/;var mIe=new Uint16Array('\u1D41<\xD5\u0131\u028A\u049D\u057B\u05D0\u0675\u06DE\u07A2\u07D6\u080F\u0A4A\u0A91\u0DA1\u0E6D\u0F09\u0F26\u10CA\u1228\u12E1\u1415\u149D\u14C3\u14DF\u1525\0\0\0\0\0\0\u156B\u16CD\u198D\u1C12\u1DDD\u1F7E\u2060\u21B0\u228D\u23C0\u23FB\u2442\u2824\u2912\u2D08\u2E48\u2FCE\u3016\u32BA\u3639\u37AC\u38FE\u3A28\u3A71\u3AE0\u3B2E\u0800EMabcfglmnoprstu\\bfms\x7F\x84\x8B\x90\x95\x98\xA6\xB3\xB9\xC8\xCFlig\u803B\xC6\u40C6P\u803B&\u4026cute\u803B\xC1\u40C1reve;\u4102\u0100iyx}rc\u803B\xC2\u40C2;\u4410r;\uC000\u{1D504}rave\u803B\xC0\u40C0pha;\u4391acr;\u4100d;\u6A53\u0100gp\x9D\xA1on;\u4104f;\uC000\u{1D538}plyFunction;\u6061ing\u803B\xC5\u40C5\u0100cs\xBE\xC3r;\uC000\u{1D49C}ign;\u6254ilde\u803B\xC3\u40C3ml\u803B\xC4\u40C4\u0400aceforsu\xE5\xFB\xFE\u0117\u011C\u0122\u0127\u012A\u0100cr\xEA\xF2kslash;\u6216\u0176\xF6\xF8;\u6AE7ed;\u6306y;\u4411\u0180crt\u0105\u010B\u0114ause;\u6235noullis;\u612Ca;\u4392r;\uC000\u{1D505}pf;\uC000\u{1D539}eve;\u42D8c\xF2\u0113mpeq;\u624E\u0700HOacdefhilorsu\u014D\u0151\u0156\u0180\u019E\u01A2\u01B5\u01B7\u01BA\u01DC\u0215\u0273\u0278\u027Ecy;\u4427PY\u803B\xA9\u40A9\u0180cpy\u015D\u0162\u017Aute;\u4106\u0100;i\u0167\u0168\u62D2talDifferentialD;\u6145leys;\u612D\u0200aeio\u0189\u018E\u0194\u0198ron;\u410Cdil\u803B\xC7\u40C7rc;\u4108nint;\u6230ot;\u410A\u0100dn\u01A7\u01ADilla;\u40B8terDot;\u40B7\xF2\u017Fi;\u43A7rcle\u0200DMPT\u01C7\u01CB\u01D1\u01D6ot;\u6299inus;\u6296lus;\u6295imes;\u6297o\u0100cs\u01E2\u01F8kwiseContourIntegral;\u6232eCurly\u0100DQ\u0203\u020FoubleQuote;\u601Duote;\u6019\u0200lnpu\u021E\u0228\u0247\u0255on\u0100;e\u0225\u0226\u6237;\u6A74\u0180git\u022F\u0236\u023Aruent;\u6261nt;\u622FourIntegral;\u622E\u0100fr\u024C\u024E;\u6102oduct;\u6210nterClockwiseContourIntegral;\u6233oss;\u6A2Fcr;\uC000\u{1D49E}p\u0100;C\u0284\u0285\u62D3ap;\u624D\u0580DJSZacefios\u02A0\u02AC\u02B0\u02B4\u02B8\u02CB\u02D7\u02E1\u02E6\u0333\u048D\u0100;o\u0179\u02A5trahd;\u6911cy;\u4402cy;\u4405cy;\u440F\u0180grs\u02BF\u02C4\u02C7ger;\u6021r;\u61A1hv;\u6AE4\u0100ay\u02D0\u02D5ron;\u410E;\u4414l\u0100;t\u02DD\u02DE\u6207a;\u4394r;\uC000\u{1D507}\u0100af\u02EB\u0327\u0100cm\u02F0\u0322ritical\u0200ADGT\u0300\u0306\u0316\u031Ccute;\u40B4o\u0174\u030B\u030D;\u42D9bleAcute;\u42DDrave;\u4060ilde;\u42DCond;\u62C4ferentialD;\u6146\u0470\u033D\0\0\0\u0342\u0354\0\u0405f;\uC000\u{1D53B}\u0180;DE\u0348\u0349\u034D\u40A8ot;\u60DCqual;\u6250ble\u0300CDLRUV\u0363\u0372\u0382\u03CF\u03E2\u03F8ontourIntegra\xEC\u0239o\u0274\u0379\0\0\u037B\xBB\u0349nArrow;\u61D3\u0100eo\u0387\u03A4ft\u0180ART\u0390\u0396\u03A1rrow;\u61D0ightArrow;\u61D4e\xE5\u02CAng\u0100LR\u03AB\u03C4eft\u0100AR\u03B3\u03B9rrow;\u67F8ightArrow;\u67FAightArrow;\u67F9ight\u0100AT\u03D8\u03DErrow;\u61D2ee;\u62A8p\u0241\u03E9\0\0\u03EFrrow;\u61D1ownArrow;\u61D5erticalBar;\u6225n\u0300ABLRTa\u0412\u042A\u0430\u045E\u047F\u037Crrow\u0180;BU\u041D\u041E\u0422\u6193ar;\u6913pArrow;\u61F5reve;\u4311eft\u02D2\u043A\0\u0446\0\u0450ightVector;\u6950eeVector;\u695Eector\u0100;B\u0459\u045A\u61BDar;\u6956ight\u01D4\u0467\0\u0471eeVector;\u695Fector\u0100;B\u047A\u047B\u61C1ar;\u6957ee\u0100;A\u0486\u0487\u62A4rrow;\u61A7\u0100ct\u0492\u0497r;\uC000\u{1D49F}rok;\u4110\u0800NTacdfglmopqstux\u04BD\u04C0\u04C4\u04CB\u04DE\u04E2\u04E7\u04EE\u04F5\u0521\u052F\u0536\u0552\u055D\u0560\u0565G;\u414AH\u803B\xD0\u40D0cute\u803B\xC9\u40C9\u0180aiy\u04D2\u04D7\u04DCron;\u411Arc\u803B\xCA\u40CA;\u442Dot;\u4116r;\uC000\u{1D508}rave\u803B\xC8\u40C8ement;\u6208\u0100ap\u04FA\u04FEcr;\u4112ty\u0253\u0506\0\0\u0512mallSquare;\u65FBerySmallSquare;\u65AB\u0100gp\u0526\u052Aon;\u4118f;\uC000\u{1D53C}silon;\u4395u\u0100ai\u053C\u0549l\u0100;T\u0542\u0543\u6A75ilde;\u6242librium;\u61CC\u0100ci\u0557\u055Ar;\u6130m;\u6A73a;\u4397ml\u803B\xCB\u40CB\u0100ip\u056A\u056Fsts;\u6203onentialE;\u6147\u0280cfios\u0585\u0588\u058D\u05B2\u05CCy;\u4424r;\uC000\u{1D509}lled\u0253\u0597\0\0\u05A3mallSquare;\u65FCerySmallSquare;\u65AA\u0370\u05BA\0\u05BF\0\0\u05C4f;\uC000\u{1D53D}All;\u6200riertrf;\u6131c\xF2\u05CB\u0600JTabcdfgorst\u05E8\u05EC\u05EF\u05FA\u0600\u0612\u0616\u061B\u061D\u0623\u066C\u0672cy;\u4403\u803B>\u403Emma\u0100;d\u05F7\u05F8\u4393;\u43DCreve;\u411E\u0180eiy\u0607\u060C\u0610dil;\u4122rc;\u411C;\u4413ot;\u4120r;\uC000\u{1D50A};\u62D9pf;\uC000\u{1D53E}eater\u0300EFGLST\u0635\u0644\u064E\u0656\u065B\u0666qual\u0100;L\u063E\u063F\u6265ess;\u62DBullEqual;\u6267reater;\u6AA2ess;\u6277lantEqual;\u6A7Eilde;\u6273cr;\uC000\u{1D4A2};\u626B\u0400Aacfiosu\u0685\u068B\u0696\u069B\u069E\u06AA\u06BE\u06CARDcy;\u442A\u0100ct\u0690\u0694ek;\u42C7;\u405Eirc;\u4124r;\u610ClbertSpace;\u610B\u01F0\u06AF\0\u06B2f;\u610DizontalLine;\u6500\u0100ct\u06C3\u06C5\xF2\u06A9rok;\u4126mp\u0144\u06D0\u06D8ownHum\xF0\u012Fqual;\u624F\u0700EJOacdfgmnostu\u06FA\u06FE\u0703\u0707\u070E\u071A\u071E\u0721\u0728\u0744\u0778\u078B\u078F\u0795cy;\u4415lig;\u4132cy;\u4401cute\u803B\xCD\u40CD\u0100iy\u0713\u0718rc\u803B\xCE\u40CE;\u4418ot;\u4130r;\u6111rave\u803B\xCC\u40CC\u0180;ap\u0720\u072F\u073F\u0100cg\u0734\u0737r;\u412AinaryI;\u6148lie\xF3\u03DD\u01F4\u0749\0\u0762\u0100;e\u074D\u074E\u622C\u0100gr\u0753\u0758ral;\u622Bsection;\u62C2isible\u0100CT\u076C\u0772omma;\u6063imes;\u6062\u0180gpt\u077F\u0783\u0788on;\u412Ef;\uC000\u{1D540}a;\u4399cr;\u6110ilde;\u4128\u01EB\u079A\0\u079Ecy;\u4406l\u803B\xCF\u40CF\u0280cfosu\u07AC\u07B7\u07BC\u07C2\u07D0\u0100iy\u07B1\u07B5rc;\u4134;\u4419r;\uC000\u{1D50D}pf;\uC000\u{1D541}\u01E3\u07C7\0\u07CCr;\uC000\u{1D4A5}rcy;\u4408kcy;\u4404\u0380HJacfos\u07E4\u07E8\u07EC\u07F1\u07FD\u0802\u0808cy;\u4425cy;\u440Cppa;\u439A\u0100ey\u07F6\u07FBdil;\u4136;\u441Ar;\uC000\u{1D50E}pf;\uC000\u{1D542}cr;\uC000\u{1D4A6}\u0580JTaceflmost\u0825\u0829\u082C\u0850\u0863\u09B3\u09B8\u09C7\u09CD\u0A37\u0A47cy;\u4409\u803B<\u403C\u0280cmnpr\u0837\u083C\u0841\u0844\u084Dute;\u4139bda;\u439Bg;\u67EAlacetrf;\u6112r;\u619E\u0180aey\u0857\u085C\u0861ron;\u413Ddil;\u413B;\u441B\u0100fs\u0868\u0970t\u0500ACDFRTUVar\u087E\u08A9\u08B1\u08E0\u08E6\u08FC\u092F\u095B\u0390\u096A\u0100nr\u0883\u088FgleBracket;\u67E8row\u0180;BR\u0899\u089A\u089E\u6190ar;\u61E4ightArrow;\u61C6eiling;\u6308o\u01F5\u08B7\0\u08C3bleBracket;\u67E6n\u01D4\u08C8\0\u08D2eeVector;\u6961ector\u0100;B\u08DB\u08DC\u61C3ar;\u6959loor;\u630Aight\u0100AV\u08EF\u08F5rrow;\u6194ector;\u694E\u0100er\u0901\u0917e\u0180;AV\u0909\u090A\u0910\u62A3rrow;\u61A4ector;\u695Aiangle\u0180;BE\u0924\u0925\u0929\u62B2ar;\u69CFqual;\u62B4p\u0180DTV\u0937\u0942\u094CownVector;\u6951eeVector;\u6960ector\u0100;B\u0956\u0957\u61BFar;\u6958ector\u0100;B\u0965\u0966\u61BCar;\u6952ight\xE1\u039Cs\u0300EFGLST\u097E\u098B\u0995\u099D\u09A2\u09ADqualGreater;\u62DAullEqual;\u6266reater;\u6276ess;\u6AA1lantEqual;\u6A7Dilde;\u6272r;\uC000\u{1D50F}\u0100;e\u09BD\u09BE\u62D8ftarrow;\u61DAidot;\u413F\u0180npw\u09D4\u0A16\u0A1Bg\u0200LRlr\u09DE\u09F7\u0A02\u0A10eft\u0100AR\u09E6\u09ECrrow;\u67F5ightArrow;\u67F7ightArrow;\u67F6eft\u0100ar\u03B3\u0A0Aight\xE1\u03BFight\xE1\u03CAf;\uC000\u{1D543}er\u0100LR\u0A22\u0A2CeftArrow;\u6199ightArrow;\u6198\u0180cht\u0A3E\u0A40\u0A42\xF2\u084C;\u61B0rok;\u4141;\u626A\u0400acefiosu\u0A5A\u0A5D\u0A60\u0A77\u0A7C\u0A85\u0A8B\u0A8Ep;\u6905y;\u441C\u0100dl\u0A65\u0A6FiumSpace;\u605Flintrf;\u6133r;\uC000\u{1D510}nusPlus;\u6213pf;\uC000\u{1D544}c\xF2\u0A76;\u439C\u0480Jacefostu\u0AA3\u0AA7\u0AAD\u0AC0\u0B14\u0B19\u0D91\u0D97\u0D9Ecy;\u440Acute;\u4143\u0180aey\u0AB4\u0AB9\u0ABEron;\u4147dil;\u4145;\u441D\u0180gsw\u0AC7\u0AF0\u0B0Eative\u0180MTV\u0AD3\u0ADF\u0AE8ediumSpace;\u600Bhi\u0100cn\u0AE6\u0AD8\xEB\u0AD9eryThi\xEE\u0AD9ted\u0100GL\u0AF8\u0B06reaterGreate\xF2\u0673essLes\xF3\u0A48Line;\u400Ar;\uC000\u{1D511}\u0200Bnpt\u0B22\u0B28\u0B37\u0B3Areak;\u6060BreakingSpace;\u40A0f;\u6115\u0680;CDEGHLNPRSTV\u0B55\u0B56\u0B6A\u0B7C\u0BA1\u0BEB\u0C04\u0C5E\u0C84\u0CA6\u0CD8\u0D61\u0D85\u6AEC\u0100ou\u0B5B\u0B64ngruent;\u6262pCap;\u626DoubleVerticalBar;\u6226\u0180lqx\u0B83\u0B8A\u0B9Bement;\u6209ual\u0100;T\u0B92\u0B93\u6260ilde;\uC000\u2242\u0338ists;\u6204reater\u0380;EFGLST\u0BB6\u0BB7\u0BBD\u0BC9\u0BD3\u0BD8\u0BE5\u626Fqual;\u6271ullEqual;\uC000\u2267\u0338reater;\uC000\u226B\u0338ess;\u6279lantEqual;\uC000\u2A7E\u0338ilde;\u6275ump\u0144\u0BF2\u0BFDownHump;\uC000\u224E\u0338qual;\uC000\u224F\u0338e\u0100fs\u0C0A\u0C27tTriangle\u0180;BE\u0C1A\u0C1B\u0C21\u62EAar;\uC000\u29CF\u0338qual;\u62ECs\u0300;EGLST\u0C35\u0C36\u0C3C\u0C44\u0C4B\u0C58\u626Equal;\u6270reater;\u6278ess;\uC000\u226A\u0338lantEqual;\uC000\u2A7D\u0338ilde;\u6274ested\u0100GL\u0C68\u0C79reaterGreater;\uC000\u2AA2\u0338essLess;\uC000\u2AA1\u0338recedes\u0180;ES\u0C92\u0C93\u0C9B\u6280qual;\uC000\u2AAF\u0338lantEqual;\u62E0\u0100ei\u0CAB\u0CB9verseElement;\u620CghtTriangle\u0180;BE\u0CCB\u0CCC\u0CD2\u62EBar;\uC000\u29D0\u0338qual;\u62ED\u0100qu\u0CDD\u0D0CuareSu\u0100bp\u0CE8\u0CF9set\u0100;E\u0CF0\u0CF3\uC000\u228F\u0338qual;\u62E2erset\u0100;E\u0D03\u0D06\uC000\u2290\u0338qual;\u62E3\u0180bcp\u0D13\u0D24\u0D4Eset\u0100;E\u0D1B\u0D1E\uC000\u2282\u20D2qual;\u6288ceeds\u0200;EST\u0D32\u0D33\u0D3B\u0D46\u6281qual;\uC000\u2AB0\u0338lantEqual;\u62E1ilde;\uC000\u227F\u0338erset\u0100;E\u0D58\u0D5B\uC000\u2283\u20D2qual;\u6289ilde\u0200;EFT\u0D6E\u0D6F\u0D75\u0D7F\u6241qual;\u6244ullEqual;\u6247ilde;\u6249erticalBar;\u6224cr;\uC000\u{1D4A9}ilde\u803B\xD1\u40D1;\u439D\u0700Eacdfgmoprstuv\u0DBD\u0DC2\u0DC9\u0DD5\u0DDB\u0DE0\u0DE7\u0DFC\u0E02\u0E20\u0E22\u0E32\u0E3F\u0E44lig;\u4152cute\u803B\xD3\u40D3\u0100iy\u0DCE\u0DD3rc\u803B\xD4\u40D4;\u441Eblac;\u4150r;\uC000\u{1D512}rave\u803B\xD2\u40D2\u0180aei\u0DEE\u0DF2\u0DF6cr;\u414Cga;\u43A9cron;\u439Fpf;\uC000\u{1D546}enCurly\u0100DQ\u0E0E\u0E1AoubleQuote;\u601Cuote;\u6018;\u6A54\u0100cl\u0E27\u0E2Cr;\uC000\u{1D4AA}ash\u803B\xD8\u40D8i\u016C\u0E37\u0E3Cde\u803B\xD5\u40D5es;\u6A37ml\u803B\xD6\u40D6er\u0100BP\u0E4B\u0E60\u0100ar\u0E50\u0E53r;\u603Eac\u0100ek\u0E5A\u0E5C;\u63DEet;\u63B4arenthesis;\u63DC\u0480acfhilors\u0E7F\u0E87\u0E8A\u0E8F\u0E92\u0E94\u0E9D\u0EB0\u0EFCrtialD;\u6202y;\u441Fr;\uC000\u{1D513}i;\u43A6;\u43A0usMinus;\u40B1\u0100ip\u0EA2\u0EADncareplan\xE5\u069Df;\u6119\u0200;eio\u0EB9\u0EBA\u0EE0\u0EE4\u6ABBcedes\u0200;EST\u0EC8\u0EC9\u0ECF\u0EDA\u627Aqual;\u6AAFlantEqual;\u627Cilde;\u627Eme;\u6033\u0100dp\u0EE9\u0EEEuct;\u620Fortion\u0100;a\u0225\u0EF9l;\u621D\u0100ci\u0F01\u0F06r;\uC000\u{1D4AB};\u43A8\u0200Ufos\u0F11\u0F16\u0F1B\u0F1FOT\u803B"\u4022r;\uC000\u{1D514}pf;\u611Acr;\uC000\u{1D4AC}\u0600BEacefhiorsu\u0F3E\u0F43\u0F47\u0F60\u0F73\u0FA7\u0FAA\u0FAD\u1096\u10A9\u10B4\u10BEarr;\u6910G\u803B\xAE\u40AE\u0180cnr\u0F4E\u0F53\u0F56ute;\u4154g;\u67EBr\u0100;t\u0F5C\u0F5D\u61A0l;\u6916\u0180aey\u0F67\u0F6C\u0F71ron;\u4158dil;\u4156;\u4420\u0100;v\u0F78\u0F79\u611Cerse\u0100EU\u0F82\u0F99\u0100lq\u0F87\u0F8Eement;\u620Builibrium;\u61CBpEquilibrium;\u696Fr\xBB\u0F79o;\u43A1ght\u0400ACDFTUVa\u0FC1\u0FEB\u0FF3\u1022\u1028\u105B\u1087\u03D8\u0100nr\u0FC6\u0FD2gleBracket;\u67E9row\u0180;BL\u0FDC\u0FDD\u0FE1\u6192ar;\u61E5eftArrow;\u61C4eiling;\u6309o\u01F5\u0FF9\0\u1005bleBracket;\u67E7n\u01D4\u100A\0\u1014eeVector;\u695Dector\u0100;B\u101D\u101E\u61C2ar;\u6955loor;\u630B\u0100er\u102D\u1043e\u0180;AV\u1035\u1036\u103C\u62A2rrow;\u61A6ector;\u695Biangle\u0180;BE\u1050\u1051\u1055\u62B3ar;\u69D0qual;\u62B5p\u0180DTV\u1063\u106E\u1078ownVector;\u694FeeVector;\u695Cector\u0100;B\u1082\u1083\u61BEar;\u6954ector\u0100;B\u1091\u1092\u61C0ar;\u6953\u0100pu\u109B\u109Ef;\u611DndImplies;\u6970ightarrow;\u61DB\u0100ch\u10B9\u10BCr;\u611B;\u61B1leDelayed;\u69F4\u0680HOacfhimoqstu\u10E4\u10F1\u10F7\u10FD\u1119\u111E\u1151\u1156\u1161\u1167\u11B5\u11BB\u11BF\u0100Cc\u10E9\u10EEHcy;\u4429y;\u4428FTcy;\u442Ccute;\u415A\u0280;aeiy\u1108\u1109\u110E\u1113\u1117\u6ABCron;\u4160dil;\u415Erc;\u415C;\u4421r;\uC000\u{1D516}ort\u0200DLRU\u112A\u1134\u113E\u1149ownArrow\xBB\u041EeftArrow\xBB\u089AightArrow\xBB\u0FDDpArrow;\u6191gma;\u43A3allCircle;\u6218pf;\uC000\u{1D54A}\u0272\u116D\0\0\u1170t;\u621Aare\u0200;ISU\u117B\u117C\u1189\u11AF\u65A1ntersection;\u6293u\u0100bp\u118F\u119Eset\u0100;E\u1197\u1198\u628Fqual;\u6291erset\u0100;E\u11A8\u11A9\u6290qual;\u6292nion;\u6294cr;\uC000\u{1D4AE}ar;\u62C6\u0200bcmp\u11C8\u11DB\u1209\u120B\u0100;s\u11CD\u11CE\u62D0et\u0100;E\u11CD\u11D5qual;\u6286\u0100ch\u11E0\u1205eeds\u0200;EST\u11ED\u11EE\u11F4\u11FF\u627Bqual;\u6AB0lantEqual;\u627Dilde;\u627FTh\xE1\u0F8C;\u6211\u0180;es\u1212\u1213\u1223\u62D1rset\u0100;E\u121C\u121D\u6283qual;\u6287et\xBB\u1213\u0580HRSacfhiors\u123E\u1244\u1249\u1255\u125E\u1271\u1276\u129F\u12C2\u12C8\u12D1ORN\u803B\xDE\u40DEADE;\u6122\u0100Hc\u124E\u1252cy;\u440By;\u4426\u0100bu\u125A\u125C;\u4009;\u43A4\u0180aey\u1265\u126A\u126Fron;\u4164dil;\u4162;\u4422r;\uC000\u{1D517}\u0100ei\u127B\u1289\u01F2\u1280\0\u1287efore;\u6234a;\u4398\u0100cn\u128E\u1298kSpace;\uC000\u205F\u200ASpace;\u6009lde\u0200;EFT\u12AB\u12AC\u12B2\u12BC\u623Cqual;\u6243ullEqual;\u6245ilde;\u6248pf;\uC000\u{1D54B}ipleDot;\u60DB\u0100ct\u12D6\u12DBr;\uC000\u{1D4AF}rok;\u4166\u0AE1\u12F7\u130E\u131A\u1326\0\u132C\u1331\0\0\0\0\0\u1338\u133D\u1377\u1385\0\u13FF\u1404\u140A\u1410\u0100cr\u12FB\u1301ute\u803B\xDA\u40DAr\u0100;o\u1307\u1308\u619Fcir;\u6949r\u01E3\u1313\0\u1316y;\u440Eve;\u416C\u0100iy\u131E\u1323rc\u803B\xDB\u40DB;\u4423blac;\u4170r;\uC000\u{1D518}rave\u803B\xD9\u40D9acr;\u416A\u0100di\u1341\u1369er\u0100BP\u1348\u135D\u0100ar\u134D\u1350r;\u405Fac\u0100ek\u1357\u1359;\u63DFet;\u63B5arenthesis;\u63DDon\u0100;P\u1370\u1371\u62C3lus;\u628E\u0100gp\u137B\u137Fon;\u4172f;\uC000\u{1D54C}\u0400ADETadps\u1395\u13AE\u13B8\u13C4\u03E8\u13D2\u13D7\u13F3rrow\u0180;BD\u1150\u13A0\u13A4ar;\u6912ownArrow;\u61C5ownArrow;\u6195quilibrium;\u696Eee\u0100;A\u13CB\u13CC\u62A5rrow;\u61A5own\xE1\u03F3er\u0100LR\u13DE\u13E8eftArrow;\u6196ightArrow;\u6197i\u0100;l\u13F9\u13FA\u43D2on;\u43A5ing;\u416Ecr;\uC000\u{1D4B0}ilde;\u4168ml\u803B\xDC\u40DC\u0480Dbcdefosv\u1427\u142C\u1430\u1433\u143E\u1485\u148A\u1490\u1496ash;\u62ABar;\u6AEBy;\u4412ash\u0100;l\u143B\u143C\u62A9;\u6AE6\u0100er\u1443\u1445;\u62C1\u0180bty\u144C\u1450\u147Aar;\u6016\u0100;i\u144F\u1455cal\u0200BLST\u1461\u1465\u146A\u1474ar;\u6223ine;\u407Ceparator;\u6758ilde;\u6240ThinSpace;\u600Ar;\uC000\u{1D519}pf;\uC000\u{1D54D}cr;\uC000\u{1D4B1}dash;\u62AA\u0280cefos\u14A7\u14AC\u14B1\u14B6\u14BCirc;\u4174dge;\u62C0r;\uC000\u{1D51A}pf;\uC000\u{1D54E}cr;\uC000\u{1D4B2}\u0200fios\u14CB\u14D0\u14D2\u14D8r;\uC000\u{1D51B};\u439Epf;\uC000\u{1D54F}cr;\uC000\u{1D4B3}\u0480AIUacfosu\u14F1\u14F5\u14F9\u14FD\u1504\u150F\u1514\u151A\u1520cy;\u442Fcy;\u4407cy;\u442Ecute\u803B\xDD\u40DD\u0100iy\u1509\u150Drc;\u4176;\u442Br;\uC000\u{1D51C}pf;\uC000\u{1D550}cr;\uC000\u{1D4B4}ml;\u4178\u0400Hacdefos\u1535\u1539\u153F\u154B\u154F\u155D\u1560\u1564cy;\u4416cute;\u4179\u0100ay\u1544\u1549ron;\u417D;\u4417ot;\u417B\u01F2\u1554\0\u155BoWidt\xE8\u0AD9a;\u4396r;\u6128pf;\u6124cr;\uC000\u{1D4B5}\u0BE1\u1583\u158A\u1590\0\u15B0\u15B6\u15BF\0\0\0\0\u15C6\u15DB\u15EB\u165F\u166D\0\u1695\u169B\u16B2\u16B9\0\u16BEcute\u803B\xE1\u40E1reve;\u4103\u0300;Ediuy\u159C\u159D\u15A1\u15A3\u15A8\u15AD\u623E;\uC000\u223E\u0333;\u623Frc\u803B\xE2\u40E2te\u80BB\xB4\u0306;\u4430lig\u803B\xE6\u40E6\u0100;r\xB2\u15BA;\uC000\u{1D51E}rave\u803B\xE0\u40E0\u0100ep\u15CA\u15D6\u0100fp\u15CF\u15D4sym;\u6135\xE8\u15D3ha;\u43B1\u0100ap\u15DFc\u0100cl\u15E4\u15E7r;\u4101g;\u6A3F\u0264\u15F0\0\0\u160A\u0280;adsv\u15FA\u15FB\u15FF\u1601\u1607\u6227nd;\u6A55;\u6A5Clope;\u6A58;\u6A5A\u0380;elmrsz\u1618\u1619\u161B\u161E\u163F\u164F\u1659\u6220;\u69A4e\xBB\u1619sd\u0100;a\u1625\u1626\u6221\u0461\u1630\u1632\u1634\u1636\u1638\u163A\u163C\u163E;\u69A8;\u69A9;\u69AA;\u69AB;\u69AC;\u69AD;\u69AE;\u69AFt\u0100;v\u1645\u1646\u621Fb\u0100;d\u164C\u164D\u62BE;\u699D\u0100pt\u1654\u1657h;\u6222\xBB\xB9arr;\u637C\u0100gp\u1663\u1667on;\u4105f;\uC000\u{1D552}\u0380;Eaeiop\u12C1\u167B\u167D\u1682\u1684\u1687\u168A;\u6A70cir;\u6A6F;\u624Ad;\u624Bs;\u4027rox\u0100;e\u12C1\u1692\xF1\u1683ing\u803B\xE5\u40E5\u0180cty\u16A1\u16A6\u16A8r;\uC000\u{1D4B6};\u402Amp\u0100;e\u12C1\u16AF\xF1\u0288ilde\u803B\xE3\u40E3ml\u803B\xE4\u40E4\u0100ci\u16C2\u16C8onin\xF4\u0272nt;\u6A11\u0800Nabcdefiklnoprsu\u16ED\u16F1\u1730\u173C\u1743\u1748\u1778\u177D\u17E0\u17E6\u1839\u1850\u170D\u193D\u1948\u1970ot;\u6AED\u0100cr\u16F6\u171Ek\u0200ceps\u1700\u1705\u170D\u1713ong;\u624Cpsilon;\u43F6rime;\u6035im\u0100;e\u171A\u171B\u623Dq;\u62CD\u0176\u1722\u1726ee;\u62BDed\u0100;g\u172C\u172D\u6305e\xBB\u172Drk\u0100;t\u135C\u1737brk;\u63B6\u0100oy\u1701\u1741;\u4431quo;\u601E\u0280cmprt\u1753\u175B\u1761\u1764\u1768aus\u0100;e\u010A\u0109ptyv;\u69B0s\xE9\u170Cno\xF5\u0113\u0180ahw\u176F\u1771\u1773;\u43B2;\u6136een;\u626Cr;\uC000\u{1D51F}g\u0380costuvw\u178D\u179D\u17B3\u17C1\u17D5\u17DB\u17DE\u0180aiu\u1794\u1796\u179A\xF0\u0760rc;\u65EFp\xBB\u1371\u0180dpt\u17A4\u17A8\u17ADot;\u6A00lus;\u6A01imes;\u6A02\u0271\u17B9\0\0\u17BEcup;\u6A06ar;\u6605riangle\u0100du\u17CD\u17D2own;\u65BDp;\u65B3plus;\u6A04e\xE5\u1444\xE5\u14ADarow;\u690D\u0180ako\u17ED\u1826\u1835\u0100cn\u17F2\u1823k\u0180lst\u17FA\u05AB\u1802ozenge;\u69EBriangle\u0200;dlr\u1812\u1813\u1818\u181D\u65B4own;\u65BEeft;\u65C2ight;\u65B8k;\u6423\u01B1\u182B\0\u1833\u01B2\u182F\0\u1831;\u6592;\u65914;\u6593ck;\u6588\u0100eo\u183E\u184D\u0100;q\u1843\u1846\uC000=\u20E5uiv;\uC000\u2261\u20E5t;\u6310\u0200ptwx\u1859\u185E\u1867\u186Cf;\uC000\u{1D553}\u0100;t\u13CB\u1863om\xBB\u13CCtie;\u62C8\u0600DHUVbdhmptuv\u1885\u1896\u18AA\u18BB\u18D7\u18DB\u18EC\u18FF\u1905\u190A\u1910\u1921\u0200LRlr\u188E\u1890\u1892\u1894;\u6557;\u6554;\u6556;\u6553\u0280;DUdu\u18A1\u18A2\u18A4\u18A6\u18A8\u6550;\u6566;\u6569;\u6564;\u6567\u0200LRlr\u18B3\u18B5\u18B7\u18B9;\u655D;\u655A;\u655C;\u6559\u0380;HLRhlr\u18CA\u18CB\u18CD\u18CF\u18D1\u18D3\u18D5\u6551;\u656C;\u6563;\u6560;\u656B;\u6562;\u655Fox;\u69C9\u0200LRlr\u18E4\u18E6\u18E8\u18EA;\u6555;\u6552;\u6510;\u650C\u0280;DUdu\u06BD\u18F7\u18F9\u18FB\u18FD;\u6565;\u6568;\u652C;\u6534inus;\u629Flus;\u629Eimes;\u62A0\u0200LRlr\u1919\u191B\u191D\u191F;\u655B;\u6558;\u6518;\u6514\u0380;HLRhlr\u1930\u1931\u1933\u1935\u1937\u1939\u193B\u6502;\u656A;\u6561;\u655E;\u653C;\u6524;\u651C\u0100ev\u0123\u1942bar\u803B\xA6\u40A6\u0200ceio\u1951\u1956\u195A\u1960r;\uC000\u{1D4B7}mi;\u604Fm\u0100;e\u171A\u171Cl\u0180;bh\u1968\u1969\u196B\u405C;\u69C5sub;\u67C8\u016C\u1974\u197El\u0100;e\u1979\u197A\u6022t\xBB\u197Ap\u0180;Ee\u012F\u1985\u1987;\u6AAE\u0100;q\u06DC\u06DB\u0CE1\u19A7\0\u19E8\u1A11\u1A15\u1A32\0\u1A37\u1A50\0\0\u1AB4\0\0\u1AC1\0\0\u1B21\u1B2E\u1B4D\u1B52\0\u1BFD\0\u1C0C\u0180cpr\u19AD\u19B2\u19DDute;\u4107\u0300;abcds\u19BF\u19C0\u19C4\u19CA\u19D5\u19D9\u6229nd;\u6A44rcup;\u6A49\u0100au\u19CF\u19D2p;\u6A4Bp;\u6A47ot;\u6A40;\uC000\u2229\uFE00\u0100eo\u19E2\u19E5t;\u6041\xEE\u0693\u0200aeiu\u19F0\u19FB\u1A01\u1A05\u01F0\u19F5\0\u19F8s;\u6A4Don;\u410Ddil\u803B\xE7\u40E7rc;\u4109ps\u0100;s\u1A0C\u1A0D\u6A4Cm;\u6A50ot;\u410B\u0180dmn\u1A1B\u1A20\u1A26il\u80BB\xB8\u01ADptyv;\u69B2t\u8100\xA2;e\u1A2D\u1A2E\u40A2r\xE4\u01B2r;\uC000\u{1D520}\u0180cei\u1A3D\u1A40\u1A4Dy;\u4447ck\u0100;m\u1A47\u1A48\u6713ark\xBB\u1A48;\u43C7r\u0380;Ecefms\u1A5F\u1A60\u1A62\u1A6B\u1AA4\u1AAA\u1AAE\u65CB;\u69C3\u0180;el\u1A69\u1A6A\u1A6D\u42C6q;\u6257e\u0261\u1A74\0\0\u1A88rrow\u0100lr\u1A7C\u1A81eft;\u61BAight;\u61BB\u0280RSacd\u1A92\u1A94\u1A96\u1A9A\u1A9F\xBB\u0F47;\u64C8st;\u629Birc;\u629Aash;\u629Dnint;\u6A10id;\u6AEFcir;\u69C2ubs\u0100;u\u1ABB\u1ABC\u6663it\xBB\u1ABC\u02EC\u1AC7\u1AD4\u1AFA\0\u1B0Aon\u0100;e\u1ACD\u1ACE\u403A\u0100;q\xC7\xC6\u026D\u1AD9\0\0\u1AE2a\u0100;t\u1ADE\u1ADF\u402C;\u4040\u0180;fl\u1AE8\u1AE9\u1AEB\u6201\xEE\u1160e\u0100mx\u1AF1\u1AF6ent\xBB\u1AE9e\xF3\u024D\u01E7\u1AFE\0\u1B07\u0100;d\u12BB\u1B02ot;\u6A6Dn\xF4\u0246\u0180fry\u1B10\u1B14\u1B17;\uC000\u{1D554}o\xE4\u0254\u8100\xA9;s\u0155\u1B1Dr;\u6117\u0100ao\u1B25\u1B29rr;\u61B5ss;\u6717\u0100cu\u1B32\u1B37r;\uC000\u{1D4B8}\u0100bp\u1B3C\u1B44\u0100;e\u1B41\u1B42\u6ACF;\u6AD1\u0100;e\u1B49\u1B4A\u6AD0;\u6AD2dot;\u62EF\u0380delprvw\u1B60\u1B6C\u1B77\u1B82\u1BAC\u1BD4\u1BF9arr\u0100lr\u1B68\u1B6A;\u6938;\u6935\u0270\u1B72\0\0\u1B75r;\u62DEc;\u62DFarr\u0100;p\u1B7F\u1B80\u61B6;\u693D\u0300;bcdos\u1B8F\u1B90\u1B96\u1BA1\u1BA5\u1BA8\u622Arcap;\u6A48\u0100au\u1B9B\u1B9Ep;\u6A46p;\u6A4Aot;\u628Dr;\u6A45;\uC000\u222A\uFE00\u0200alrv\u1BB5\u1BBF\u1BDE\u1BE3rr\u0100;m\u1BBC\u1BBD\u61B7;\u693Cy\u0180evw\u1BC7\u1BD4\u1BD8q\u0270\u1BCE\0\0\u1BD2re\xE3\u1B73u\xE3\u1B75ee;\u62CEedge;\u62CFen\u803B\xA4\u40A4earrow\u0100lr\u1BEE\u1BF3eft\xBB\u1B80ight\xBB\u1BBDe\xE4\u1BDD\u0100ci\u1C01\u1C07onin\xF4\u01F7nt;\u6231lcty;\u632D\u0980AHabcdefhijlorstuwz\u1C38\u1C3B\u1C3F\u1C5D\u1C69\u1C75\u1C8A\u1C9E\u1CAC\u1CB7\u1CFB\u1CFF\u1D0D\u1D7B\u1D91\u1DAB\u1DBB\u1DC6\u1DCDr\xF2\u0381ar;\u6965\u0200glrs\u1C48\u1C4D\u1C52\u1C54ger;\u6020eth;\u6138\xF2\u1133h\u0100;v\u1C5A\u1C5B\u6010\xBB\u090A\u016B\u1C61\u1C67arow;\u690Fa\xE3\u0315\u0100ay\u1C6E\u1C73ron;\u410F;\u4434\u0180;ao\u0332\u1C7C\u1C84\u0100gr\u02BF\u1C81r;\u61CAtseq;\u6A77\u0180glm\u1C91\u1C94\u1C98\u803B\xB0\u40B0ta;\u43B4ptyv;\u69B1\u0100ir\u1CA3\u1CA8sht;\u697F;\uC000\u{1D521}ar\u0100lr\u1CB3\u1CB5\xBB\u08DC\xBB\u101E\u0280aegsv\u1CC2\u0378\u1CD6\u1CDC\u1CE0m\u0180;os\u0326\u1CCA\u1CD4nd\u0100;s\u0326\u1CD1uit;\u6666amma;\u43DDin;\u62F2\u0180;io\u1CE7\u1CE8\u1CF8\u40F7de\u8100\xF7;o\u1CE7\u1CF0ntimes;\u62C7n\xF8\u1CF7cy;\u4452c\u026F\u1D06\0\0\u1D0Arn;\u631Eop;\u630D\u0280lptuw\u1D18\u1D1D\u1D22\u1D49\u1D55lar;\u4024f;\uC000\u{1D555}\u0280;emps\u030B\u1D2D\u1D37\u1D3D\u1D42q\u0100;d\u0352\u1D33ot;\u6251inus;\u6238lus;\u6214quare;\u62A1blebarwedg\xE5\xFAn\u0180adh\u112E\u1D5D\u1D67ownarrow\xF3\u1C83arpoon\u0100lr\u1D72\u1D76ef\xF4\u1CB4igh\xF4\u1CB6\u0162\u1D7F\u1D85karo\xF7\u0F42\u026F\u1D8A\0\0\u1D8Ern;\u631Fop;\u630C\u0180cot\u1D98\u1DA3\u1DA6\u0100ry\u1D9D\u1DA1;\uC000\u{1D4B9};\u4455l;\u69F6rok;\u4111\u0100dr\u1DB0\u1DB4ot;\u62F1i\u0100;f\u1DBA\u1816\u65BF\u0100ah\u1DC0\u1DC3r\xF2\u0429a\xF2\u0FA6angle;\u69A6\u0100ci\u1DD2\u1DD5y;\u445Fgrarr;\u67FF\u0900Dacdefglmnopqrstux\u1E01\u1E09\u1E19\u1E38\u0578\u1E3C\u1E49\u1E61\u1E7E\u1EA5\u1EAF\u1EBD\u1EE1\u1F2A\u1F37\u1F44\u1F4E\u1F5A\u0100Do\u1E06\u1D34o\xF4\u1C89\u0100cs\u1E0E\u1E14ute\u803B\xE9\u40E9ter;\u6A6E\u0200aioy\u1E22\u1E27\u1E31\u1E36ron;\u411Br\u0100;c\u1E2D\u1E2E\u6256\u803B\xEA\u40EAlon;\u6255;\u444Dot;\u4117\u0100Dr\u1E41\u1E45ot;\u6252;\uC000\u{1D522}\u0180;rs\u1E50\u1E51\u1E57\u6A9Aave\u803B\xE8\u40E8\u0100;d\u1E5C\u1E5D\u6A96ot;\u6A98\u0200;ils\u1E6A\u1E6B\u1E72\u1E74\u6A99nters;\u63E7;\u6113\u0100;d\u1E79\u1E7A\u6A95ot;\u6A97\u0180aps\u1E85\u1E89\u1E97cr;\u4113ty\u0180;sv\u1E92\u1E93\u1E95\u6205et\xBB\u1E93p\u01001;\u1E9D\u1EA4\u0133\u1EA1\u1EA3;\u6004;\u6005\u6003\u0100gs\u1EAA\u1EAC;\u414Bp;\u6002\u0100gp\u1EB4\u1EB8on;\u4119f;\uC000\u{1D556}\u0180als\u1EC4\u1ECE\u1ED2r\u0100;s\u1ECA\u1ECB\u62D5l;\u69E3us;\u6A71i\u0180;lv\u1EDA\u1EDB\u1EDF\u43B5on\xBB\u1EDB;\u43F5\u0200csuv\u1EEA\u1EF3\u1F0B\u1F23\u0100io\u1EEF\u1E31rc\xBB\u1E2E\u0269\u1EF9\0\0\u1EFB\xED\u0548ant\u0100gl\u1F02\u1F06tr\xBB\u1E5Dess\xBB\u1E7A\u0180aei\u1F12\u1F16\u1F1Als;\u403Dst;\u625Fv\u0100;D\u0235\u1F20D;\u6A78parsl;\u69E5\u0100Da\u1F2F\u1F33ot;\u6253rr;\u6971\u0180cdi\u1F3E\u1F41\u1EF8r;\u612Fo\xF4\u0352\u0100ah\u1F49\u1F4B;\u43B7\u803B\xF0\u40F0\u0100mr\u1F53\u1F57l\u803B\xEB\u40EBo;\u60AC\u0180cip\u1F61\u1F64\u1F67l;\u4021s\xF4\u056E\u0100eo\u1F6C\u1F74ctatio\xEE\u0559nential\xE5\u0579\u09E1\u1F92\0\u1F9E\0\u1FA1\u1FA7\0\0\u1FC6\u1FCC\0\u1FD3\0\u1FE6\u1FEA\u2000\0\u2008\u205Allingdotse\xF1\u1E44y;\u4444male;\u6640\u0180ilr\u1FAD\u1FB3\u1FC1lig;\u8000\uFB03\u0269\u1FB9\0\0\u1FBDg;\u8000\uFB00ig;\u8000\uFB04;\uC000\u{1D523}lig;\u8000\uFB01lig;\uC000fj\u0180alt\u1FD9\u1FDC\u1FE1t;\u666Dig;\u8000\uFB02ns;\u65B1of;\u4192\u01F0\u1FEE\0\u1FF3f;\uC000\u{1D557}\u0100ak\u05BF\u1FF7\u0100;v\u1FFC\u1FFD\u62D4;\u6AD9artint;\u6A0D\u0100ao\u200C\u2055\u0100cs\u2011\u2052\u03B1\u201A\u2030\u2038\u2045\u2048\0\u2050\u03B2\u2022\u2025\u2027\u202A\u202C\0\u202E\u803B\xBD\u40BD;\u6153\u803B\xBC\u40BC;\u6155;\u6159;\u615B\u01B3\u2034\0\u2036;\u6154;\u6156\u02B4\u203E\u2041\0\0\u2043\u803B\xBE\u40BE;\u6157;\u615C5;\u6158\u01B6\u204C\0\u204E;\u615A;\u615D8;\u615El;\u6044wn;\u6322cr;\uC000\u{1D4BB}\u0880Eabcdefgijlnorstv\u2082\u2089\u209F\u20A5\u20B0\u20B4\u20F0\u20F5\u20FA\u20FF\u2103\u2112\u2138\u0317\u213E\u2152\u219E\u0100;l\u064D\u2087;\u6A8C\u0180cmp\u2090\u2095\u209Dute;\u41F5ma\u0100;d\u209C\u1CDA\u43B3;\u6A86reve;\u411F\u0100iy\u20AA\u20AErc;\u411D;\u4433ot;\u4121\u0200;lqs\u063E\u0642\u20BD\u20C9\u0180;qs\u063E\u064C\u20C4lan\xF4\u0665\u0200;cdl\u0665\u20D2\u20D5\u20E5c;\u6AA9ot\u0100;o\u20DC\u20DD\u6A80\u0100;l\u20E2\u20E3\u6A82;\u6A84\u0100;e\u20EA\u20ED\uC000\u22DB\uFE00s;\u6A94r;\uC000\u{1D524}\u0100;g\u0673\u061Bmel;\u6137cy;\u4453\u0200;Eaj\u065A\u210C\u210E\u2110;\u6A92;\u6AA5;\u6AA4\u0200Eaes\u211B\u211D\u2129\u2134;\u6269p\u0100;p\u2123\u2124\u6A8Arox\xBB\u2124\u0100;q\u212E\u212F\u6A88\u0100;q\u212E\u211Bim;\u62E7pf;\uC000\u{1D558}\u0100ci\u2143\u2146r;\u610Am\u0180;el\u066B\u214E\u2150;\u6A8E;\u6A90\u8300>;cdlqr\u05EE\u2160\u216A\u216E\u2173\u2179\u0100ci\u2165\u2167;\u6AA7r;\u6A7Aot;\u62D7Par;\u6995uest;\u6A7C\u0280adels\u2184\u216A\u2190\u0656\u219B\u01F0\u2189\0\u218Epro\xF8\u209Er;\u6978q\u0100lq\u063F\u2196les\xF3\u2088i\xED\u066B\u0100en\u21A3\u21ADrtneqq;\uC000\u2269\uFE00\xC5\u21AA\u0500Aabcefkosy\u21C4\u21C7\u21F1\u21F5\u21FA\u2218\u221D\u222F\u2268\u227Dr\xF2\u03A0\u0200ilmr\u21D0\u21D4\u21D7\u21DBrs\xF0\u1484f\xBB\u2024il\xF4\u06A9\u0100dr\u21E0\u21E4cy;\u444A\u0180;cw\u08F4\u21EB\u21EFir;\u6948;\u61ADar;\u610Firc;\u4125\u0180alr\u2201\u220E\u2213rts\u0100;u\u2209\u220A\u6665it\xBB\u220Alip;\u6026con;\u62B9r;\uC000\u{1D525}s\u0100ew\u2223\u2229arow;\u6925arow;\u6926\u0280amopr\u223A\u223E\u2243\u225E\u2263rr;\u61FFtht;\u623Bk\u0100lr\u2249\u2253eftarrow;\u61A9ightarrow;\u61AAf;\uC000\u{1D559}bar;\u6015\u0180clt\u226F\u2274\u2278r;\uC000\u{1D4BD}as\xE8\u21F4rok;\u4127\u0100bp\u2282\u2287ull;\u6043hen\xBB\u1C5B\u0AE1\u22A3\0\u22AA\0\u22B8\u22C5\u22CE\0\u22D5\u22F3\0\0\u22F8\u2322\u2367\u2362\u237F\0\u2386\u23AA\u23B4cute\u803B\xED\u40ED\u0180;iy\u0771\u22B0\u22B5rc\u803B\xEE\u40EE;\u4438\u0100cx\u22BC\u22BFy;\u4435cl\u803B\xA1\u40A1\u0100fr\u039F\u22C9;\uC000\u{1D526}rave\u803B\xEC\u40EC\u0200;ino\u073E\u22DD\u22E9\u22EE\u0100in\u22E2\u22E6nt;\u6A0Ct;\u622Dfin;\u69DCta;\u6129lig;\u4133\u0180aop\u22FE\u231A\u231D\u0180cgt\u2305\u2308\u2317r;\u412B\u0180elp\u071F\u230F\u2313in\xE5\u078Ear\xF4\u0720h;\u4131f;\u62B7ed;\u41B5\u0280;cfot\u04F4\u232C\u2331\u233D\u2341are;\u6105in\u0100;t\u2338\u2339\u621Eie;\u69DDdo\xF4\u2319\u0280;celp\u0757\u234C\u2350\u235B\u2361al;\u62BA\u0100gr\u2355\u2359er\xF3\u1563\xE3\u234Darhk;\u6A17rod;\u6A3C\u0200cgpt\u236F\u2372\u2376\u237By;\u4451on;\u412Ff;\uC000\u{1D55A}a;\u43B9uest\u803B\xBF\u40BF\u0100ci\u238A\u238Fr;\uC000\u{1D4BE}n\u0280;Edsv\u04F4\u239B\u239D\u23A1\u04F3;\u62F9ot;\u62F5\u0100;v\u23A6\u23A7\u62F4;\u62F3\u0100;i\u0777\u23AElde;\u4129\u01EB\u23B8\0\u23BCcy;\u4456l\u803B\xEF\u40EF\u0300cfmosu\u23CC\u23D7\u23DC\u23E1\u23E7\u23F5\u0100iy\u23D1\u23D5rc;\u4135;\u4439r;\uC000\u{1D527}ath;\u4237pf;\uC000\u{1D55B}\u01E3\u23EC\0\u23F1r;\uC000\u{1D4BF}rcy;\u4458kcy;\u4454\u0400acfghjos\u240B\u2416\u2422\u2427\u242D\u2431\u2435\u243Bppa\u0100;v\u2413\u2414\u43BA;\u43F0\u0100ey\u241B\u2420dil;\u4137;\u443Ar;\uC000\u{1D528}reen;\u4138cy;\u4445cy;\u445Cpf;\uC000\u{1D55C}cr;\uC000\u{1D4C0}\u0B80ABEHabcdefghjlmnoprstuv\u2470\u2481\u2486\u248D\u2491\u250E\u253D\u255A\u2580\u264E\u265E\u2665\u2679\u267D\u269A\u26B2\u26D8\u275D\u2768\u278B\u27C0\u2801\u2812\u0180art\u2477\u247A\u247Cr\xF2\u09C6\xF2\u0395ail;\u691Barr;\u690E\u0100;g\u0994\u248B;\u6A8Bar;\u6962\u0963\u24A5\0\u24AA\0\u24B1\0\0\0\0\0\u24B5\u24BA\0\u24C6\u24C8\u24CD\0\u24F9ute;\u413Amptyv;\u69B4ra\xEE\u084Cbda;\u43BBg\u0180;dl\u088E\u24C1\u24C3;\u6991\xE5\u088E;\u6A85uo\u803B\xAB\u40ABr\u0400;bfhlpst\u0899\u24DE\u24E6\u24E9\u24EB\u24EE\u24F1\u24F5\u0100;f\u089D\u24E3s;\u691Fs;\u691D\xEB\u2252p;\u61ABl;\u6939im;\u6973l;\u61A2\u0180;ae\u24FF\u2500\u2504\u6AABil;\u6919\u0100;s\u2509\u250A\u6AAD;\uC000\u2AAD\uFE00\u0180abr\u2515\u2519\u251Drr;\u690Crk;\u6772\u0100ak\u2522\u252Cc\u0100ek\u2528\u252A;\u407B;\u405B\u0100es\u2531\u2533;\u698Bl\u0100du\u2539\u253B;\u698F;\u698D\u0200aeuy\u2546\u254B\u2556\u2558ron;\u413E\u0100di\u2550\u2554il;\u413C\xEC\u08B0\xE2\u2529;\u443B\u0200cqrs\u2563\u2566\u256D\u257Da;\u6936uo\u0100;r\u0E19\u1746\u0100du\u2572\u2577har;\u6967shar;\u694Bh;\u61B2\u0280;fgqs\u258B\u258C\u0989\u25F3\u25FF\u6264t\u0280ahlrt\u2598\u25A4\u25B7\u25C2\u25E8rrow\u0100;t\u0899\u25A1a\xE9\u24F6arpoon\u0100du\u25AF\u25B4own\xBB\u045Ap\xBB\u0966eftarrows;\u61C7ight\u0180ahs\u25CD\u25D6\u25DErrow\u0100;s\u08F4\u08A7arpoon\xF3\u0F98quigarro\xF7\u21F0hreetimes;\u62CB\u0180;qs\u258B\u0993\u25FAlan\xF4\u09AC\u0280;cdgs\u09AC\u260A\u260D\u261D\u2628c;\u6AA8ot\u0100;o\u2614\u2615\u6A7F\u0100;r\u261A\u261B\u6A81;\u6A83\u0100;e\u2622\u2625\uC000\u22DA\uFE00s;\u6A93\u0280adegs\u2633\u2639\u263D\u2649\u264Bppro\xF8\u24C6ot;\u62D6q\u0100gq\u2643\u2645\xF4\u0989gt\xF2\u248C\xF4\u099Bi\xED\u09B2\u0180ilr\u2655\u08E1\u265Asht;\u697C;\uC000\u{1D529}\u0100;E\u099C\u2663;\u6A91\u0161\u2669\u2676r\u0100du\u25B2\u266E\u0100;l\u0965\u2673;\u696Alk;\u6584cy;\u4459\u0280;acht\u0A48\u2688\u268B\u2691\u2696r\xF2\u25C1orne\xF2\u1D08ard;\u696Bri;\u65FA\u0100io\u269F\u26A4dot;\u4140ust\u0100;a\u26AC\u26AD\u63B0che\xBB\u26AD\u0200Eaes\u26BB\u26BD\u26C9\u26D4;\u6268p\u0100;p\u26C3\u26C4\u6A89rox\xBB\u26C4\u0100;q\u26CE\u26CF\u6A87\u0100;q\u26CE\u26BBim;\u62E6\u0400abnoptwz\u26E9\u26F4\u26F7\u271A\u272F\u2741\u2747\u2750\u0100nr\u26EE\u26F1g;\u67ECr;\u61FDr\xEB\u08C1g\u0180lmr\u26FF\u270D\u2714eft\u0100ar\u09E6\u2707ight\xE1\u09F2apsto;\u67FCight\xE1\u09FDparrow\u0100lr\u2725\u2729ef\xF4\u24EDight;\u61AC\u0180afl\u2736\u2739\u273Dr;\u6985;\uC000\u{1D55D}us;\u6A2Dimes;\u6A34\u0161\u274B\u274Fst;\u6217\xE1\u134E\u0180;ef\u2757\u2758\u1800\u65CAnge\xBB\u2758ar\u0100;l\u2764\u2765\u4028t;\u6993\u0280achmt\u2773\u2776\u277C\u2785\u2787r\xF2\u08A8orne\xF2\u1D8Car\u0100;d\u0F98\u2783;\u696D;\u600Eri;\u62BF\u0300achiqt\u2798\u279D\u0A40\u27A2\u27AE\u27BBquo;\u6039r;\uC000\u{1D4C1}m\u0180;eg\u09B2\u27AA\u27AC;\u6A8D;\u6A8F\u0100bu\u252A\u27B3o\u0100;r\u0E1F\u27B9;\u601Arok;\u4142\u8400<;cdhilqr\u082B\u27D2\u2639\u27DC\u27E0\u27E5\u27EA\u27F0\u0100ci\u27D7\u27D9;\u6AA6r;\u6A79re\xE5\u25F2mes;\u62C9arr;\u6976uest;\u6A7B\u0100Pi\u27F5\u27F9ar;\u6996\u0180;ef\u2800\u092D\u181B\u65C3r\u0100du\u2807\u280Dshar;\u694Ahar;\u6966\u0100en\u2817\u2821rtneqq;\uC000\u2268\uFE00\xC5\u281E\u0700Dacdefhilnopsu\u2840\u2845\u2882\u288E\u2893\u28A0\u28A5\u28A8\u28DA\u28E2\u28E4\u0A83\u28F3\u2902Dot;\u623A\u0200clpr\u284E\u2852\u2863\u287Dr\u803B\xAF\u40AF\u0100et\u2857\u2859;\u6642\u0100;e\u285E\u285F\u6720se\xBB\u285F\u0100;s\u103B\u2868to\u0200;dlu\u103B\u2873\u2877\u287Bow\xEE\u048Cef\xF4\u090F\xF0\u13D1ker;\u65AE\u0100oy\u2887\u288Cmma;\u6A29;\u443Cash;\u6014asuredangle\xBB\u1626r;\uC000\u{1D52A}o;\u6127\u0180cdn\u28AF\u28B4\u28C9ro\u803B\xB5\u40B5\u0200;acd\u1464\u28BD\u28C0\u28C4s\xF4\u16A7ir;\u6AF0ot\u80BB\xB7\u01B5us\u0180;bd\u28D2\u1903\u28D3\u6212\u0100;u\u1D3C\u28D8;\u6A2A\u0163\u28DE\u28E1p;\u6ADB\xF2\u2212\xF0\u0A81\u0100dp\u28E9\u28EEels;\u62A7f;\uC000\u{1D55E}\u0100ct\u28F8\u28FDr;\uC000\u{1D4C2}pos\xBB\u159D\u0180;lm\u2909\u290A\u290D\u43BCtimap;\u62B8\u0C00GLRVabcdefghijlmoprstuvw\u2942\u2953\u297E\u2989\u2998\u29DA\u29E9\u2A15\u2A1A\u2A58\u2A5D\u2A83\u2A95\u2AA4\u2AA8\u2B04\u2B07\u2B44\u2B7F\u2BAE\u2C34\u2C67\u2C7C\u2CE9\u0100gt\u2947\u294B;\uC000\u22D9\u0338\u0100;v\u2950\u0BCF\uC000\u226B\u20D2\u0180elt\u295A\u2972\u2976ft\u0100ar\u2961\u2967rrow;\u61CDightarrow;\u61CE;\uC000\u22D8\u0338\u0100;v\u297B\u0C47\uC000\u226A\u20D2ightarrow;\u61CF\u0100Dd\u298E\u2993ash;\u62AFash;\u62AE\u0280bcnpt\u29A3\u29A7\u29AC\u29B1\u29CCla\xBB\u02DEute;\u4144g;\uC000\u2220\u20D2\u0280;Eiop\u0D84\u29BC\u29C0\u29C5\u29C8;\uC000\u2A70\u0338d;\uC000\u224B\u0338s;\u4149ro\xF8\u0D84ur\u0100;a\u29D3\u29D4\u666El\u0100;s\u29D3\u0B38\u01F3\u29DF\0\u29E3p\u80BB\xA0\u0B37mp\u0100;e\u0BF9\u0C00\u0280aeouy\u29F4\u29FE\u2A03\u2A10\u2A13\u01F0\u29F9\0\u29FB;\u6A43on;\u4148dil;\u4146ng\u0100;d\u0D7E\u2A0Aot;\uC000\u2A6D\u0338p;\u6A42;\u443Dash;\u6013\u0380;Aadqsx\u0B92\u2A29\u2A2D\u2A3B\u2A41\u2A45\u2A50rr;\u61D7r\u0100hr\u2A33\u2A36k;\u6924\u0100;o\u13F2\u13F0ot;\uC000\u2250\u0338ui\xF6\u0B63\u0100ei\u2A4A\u2A4Ear;\u6928\xED\u0B98ist\u0100;s\u0BA0\u0B9Fr;\uC000\u{1D52B}\u0200Eest\u0BC5\u2A66\u2A79\u2A7C\u0180;qs\u0BBC\u2A6D\u0BE1\u0180;qs\u0BBC\u0BC5\u2A74lan\xF4\u0BE2i\xED\u0BEA\u0100;r\u0BB6\u2A81\xBB\u0BB7\u0180Aap\u2A8A\u2A8D\u2A91r\xF2\u2971rr;\u61AEar;\u6AF2\u0180;sv\u0F8D\u2A9C\u0F8C\u0100;d\u2AA1\u2AA2\u62FC;\u62FAcy;\u445A\u0380AEadest\u2AB7\u2ABA\u2ABE\u2AC2\u2AC5\u2AF6\u2AF9r\xF2\u2966;\uC000\u2266\u0338rr;\u619Ar;\u6025\u0200;fqs\u0C3B\u2ACE\u2AE3\u2AEFt\u0100ar\u2AD4\u2AD9rro\xF7\u2AC1ightarro\xF7\u2A90\u0180;qs\u0C3B\u2ABA\u2AEAlan\xF4\u0C55\u0100;s\u0C55\u2AF4\xBB\u0C36i\xED\u0C5D\u0100;r\u0C35\u2AFEi\u0100;e\u0C1A\u0C25i\xE4\u0D90\u0100pt\u2B0C\u2B11f;\uC000\u{1D55F}\u8180\xAC;in\u2B19\u2B1A\u2B36\u40ACn\u0200;Edv\u0B89\u2B24\u2B28\u2B2E;\uC000\u22F9\u0338ot;\uC000\u22F5\u0338\u01E1\u0B89\u2B33\u2B35;\u62F7;\u62F6i\u0100;v\u0CB8\u2B3C\u01E1\u0CB8\u2B41\u2B43;\u62FE;\u62FD\u0180aor\u2B4B\u2B63\u2B69r\u0200;ast\u0B7B\u2B55\u2B5A\u2B5Flle\xEC\u0B7Bl;\uC000\u2AFD\u20E5;\uC000\u2202\u0338lint;\u6A14\u0180;ce\u0C92\u2B70\u2B73u\xE5\u0CA5\u0100;c\u0C98\u2B78\u0100;e\u0C92\u2B7D\xF1\u0C98\u0200Aait\u2B88\u2B8B\u2B9D\u2BA7r\xF2\u2988rr\u0180;cw\u2B94\u2B95\u2B99\u619B;\uC000\u2933\u0338;\uC000\u219D\u0338ghtarrow\xBB\u2B95ri\u0100;e\u0CCB\u0CD6\u0380chimpqu\u2BBD\u2BCD\u2BD9\u2B04\u0B78\u2BE4\u2BEF\u0200;cer\u0D32\u2BC6\u0D37\u2BC9u\xE5\u0D45;\uC000\u{1D4C3}ort\u026D\u2B05\0\0\u2BD6ar\xE1\u2B56m\u0100;e\u0D6E\u2BDF\u0100;q\u0D74\u0D73su\u0100bp\u2BEB\u2BED\xE5\u0CF8\xE5\u0D0B\u0180bcp\u2BF6\u2C11\u2C19\u0200;Ees\u2BFF\u2C00\u0D22\u2C04\u6284;\uC000\u2AC5\u0338et\u0100;e\u0D1B\u2C0Bq\u0100;q\u0D23\u2C00c\u0100;e\u0D32\u2C17\xF1\u0D38\u0200;Ees\u2C22\u2C23\u0D5F\u2C27\u6285;\uC000\u2AC6\u0338et\u0100;e\u0D58\u2C2Eq\u0100;q\u0D60\u2C23\u0200gilr\u2C3D\u2C3F\u2C45\u2C47\xEC\u0BD7lde\u803B\xF1\u40F1\xE7\u0C43iangle\u0100lr\u2C52\u2C5Ceft\u0100;e\u0C1A\u2C5A\xF1\u0C26ight\u0100;e\u0CCB\u2C65\xF1\u0CD7\u0100;m\u2C6C\u2C6D\u43BD\u0180;es\u2C74\u2C75\u2C79\u4023ro;\u6116p;\u6007\u0480DHadgilrs\u2C8F\u2C94\u2C99\u2C9E\u2CA3\u2CB0\u2CB6\u2CD3\u2CE3ash;\u62ADarr;\u6904p;\uC000\u224D\u20D2ash;\u62AC\u0100et\u2CA8\u2CAC;\uC000\u2265\u20D2;\uC000>\u20D2nfin;\u69DE\u0180Aet\u2CBD\u2CC1\u2CC5rr;\u6902;\uC000\u2264\u20D2\u0100;r\u2CCA\u2CCD\uC000<\u20D2ie;\uC000\u22B4\u20D2\u0100At\u2CD8\u2CDCrr;\u6903rie;\uC000\u22B5\u20D2im;\uC000\u223C\u20D2\u0180Aan\u2CF0\u2CF4\u2D02rr;\u61D6r\u0100hr\u2CFA\u2CFDk;\u6923\u0100;o\u13E7\u13E5ear;\u6927\u1253\u1A95\0\0\0\0\0\0\0\0\0\0\0\0\0\u2D2D\0\u2D38\u2D48\u2D60\u2D65\u2D72\u2D84\u1B07\0\0\u2D8D\u2DAB\0\u2DC8\u2DCE\0\u2DDC\u2E19\u2E2B\u2E3E\u2E43\u0100cs\u2D31\u1A97ute\u803B\xF3\u40F3\u0100iy\u2D3C\u2D45r\u0100;c\u1A9E\u2D42\u803B\xF4\u40F4;\u443E\u0280abios\u1AA0\u2D52\u2D57\u01C8\u2D5Alac;\u4151v;\u6A38old;\u69BClig;\u4153\u0100cr\u2D69\u2D6Dir;\u69BF;\uC000\u{1D52C}\u036F\u2D79\0\0\u2D7C\0\u2D82n;\u42DBave\u803B\xF2\u40F2;\u69C1\u0100bm\u2D88\u0DF4ar;\u69B5\u0200acit\u2D95\u2D98\u2DA5\u2DA8r\xF2\u1A80\u0100ir\u2D9D\u2DA0r;\u69BEoss;\u69BBn\xE5\u0E52;\u69C0\u0180aei\u2DB1\u2DB5\u2DB9cr;\u414Dga;\u43C9\u0180cdn\u2DC0\u2DC5\u01CDron;\u43BF;\u69B6pf;\uC000\u{1D560}\u0180ael\u2DD4\u2DD7\u01D2r;\u69B7rp;\u69B9\u0380;adiosv\u2DEA\u2DEB\u2DEE\u2E08\u2E0D\u2E10\u2E16\u6228r\xF2\u1A86\u0200;efm\u2DF7\u2DF8\u2E02\u2E05\u6A5Dr\u0100;o\u2DFE\u2DFF\u6134f\xBB\u2DFF\u803B\xAA\u40AA\u803B\xBA\u40BAgof;\u62B6r;\u6A56lope;\u6A57;\u6A5B\u0180clo\u2E1F\u2E21\u2E27\xF2\u2E01ash\u803B\xF8\u40F8l;\u6298i\u016C\u2E2F\u2E34de\u803B\xF5\u40F5es\u0100;a\u01DB\u2E3As;\u6A36ml\u803B\xF6\u40F6bar;\u633D\u0AE1\u2E5E\0\u2E7D\0\u2E80\u2E9D\0\u2EA2\u2EB9\0\0\u2ECB\u0E9C\0\u2F13\0\0\u2F2B\u2FBC\0\u2FC8r\u0200;ast\u0403\u2E67\u2E72\u0E85\u8100\xB6;l\u2E6D\u2E6E\u40B6le\xEC\u0403\u0269\u2E78\0\0\u2E7Bm;\u6AF3;\u6AFDy;\u443Fr\u0280cimpt\u2E8B\u2E8F\u2E93\u1865\u2E97nt;\u4025od;\u402Eil;\u6030enk;\u6031r;\uC000\u{1D52D}\u0180imo\u2EA8\u2EB0\u2EB4\u0100;v\u2EAD\u2EAE\u43C6;\u43D5ma\xF4\u0A76ne;\u660E\u0180;tv\u2EBF\u2EC0\u2EC8\u43C0chfork\xBB\u1FFD;\u43D6\u0100au\u2ECF\u2EDFn\u0100ck\u2ED5\u2EDDk\u0100;h\u21F4\u2EDB;\u610E\xF6\u21F4s\u0480;abcdemst\u2EF3\u2EF4\u1908\u2EF9\u2EFD\u2F04\u2F06\u2F0A\u2F0E\u402Bcir;\u6A23ir;\u6A22\u0100ou\u1D40\u2F02;\u6A25;\u6A72n\u80BB\xB1\u0E9Dim;\u6A26wo;\u6A27\u0180ipu\u2F19\u2F20\u2F25ntint;\u6A15f;\uC000\u{1D561}nd\u803B\xA3\u40A3\u0500;Eaceinosu\u0EC8\u2F3F\u2F41\u2F44\u2F47\u2F81\u2F89\u2F92\u2F7E\u2FB6;\u6AB3p;\u6AB7u\xE5\u0ED9\u0100;c\u0ECE\u2F4C\u0300;acens\u0EC8\u2F59\u2F5F\u2F66\u2F68\u2F7Eppro\xF8\u2F43urlye\xF1\u0ED9\xF1\u0ECE\u0180aes\u2F6F\u2F76\u2F7Approx;\u6AB9qq;\u6AB5im;\u62E8i\xED\u0EDFme\u0100;s\u2F88\u0EAE\u6032\u0180Eas\u2F78\u2F90\u2F7A\xF0\u2F75\u0180dfp\u0EEC\u2F99\u2FAF\u0180als\u2FA0\u2FA5\u2FAAlar;\u632Eine;\u6312urf;\u6313\u0100;t\u0EFB\u2FB4\xEF\u0EFBrel;\u62B0\u0100ci\u2FC0\u2FC5r;\uC000\u{1D4C5};\u43C8ncsp;\u6008\u0300fiopsu\u2FDA\u22E2\u2FDF\u2FE5\u2FEB\u2FF1r;\uC000\u{1D52E}pf;\uC000\u{1D562}rime;\u6057cr;\uC000\u{1D4C6}\u0180aeo\u2FF8\u3009\u3013t\u0100ei\u2FFE\u3005rnion\xF3\u06B0nt;\u6A16st\u0100;e\u3010\u3011\u403F\xF1\u1F19\xF4\u0F14\u0A80ABHabcdefhilmnoprstux\u3040\u3051\u3055\u3059\u30E0\u310E\u312B\u3147\u3162\u3172\u318E\u3206\u3215\u3224\u3229\u3258\u326E\u3272\u3290\u32B0\u32B7\u0180art\u3047\u304A\u304Cr\xF2\u10B3\xF2\u03DDail;\u691Car\xF2\u1C65ar;\u6964\u0380cdenqrt\u3068\u3075\u3078\u307F\u308F\u3094\u30CC\u0100eu\u306D\u3071;\uC000\u223D\u0331te;\u4155i\xE3\u116Emptyv;\u69B3g\u0200;del\u0FD1\u3089\u308B\u308D;\u6992;\u69A5\xE5\u0FD1uo\u803B\xBB\u40BBr\u0580;abcfhlpstw\u0FDC\u30AC\u30AF\u30B7\u30B9\u30BC\u30BE\u30C0\u30C3\u30C7\u30CAp;\u6975\u0100;f\u0FE0\u30B4s;\u6920;\u6933s;\u691E\xEB\u225D\xF0\u272El;\u6945im;\u6974l;\u61A3;\u619D\u0100ai\u30D1\u30D5il;\u691Ao\u0100;n\u30DB\u30DC\u6236al\xF3\u0F1E\u0180abr\u30E7\u30EA\u30EEr\xF2\u17E5rk;\u6773\u0100ak\u30F3\u30FDc\u0100ek\u30F9\u30FB;\u407D;\u405D\u0100es\u3102\u3104;\u698Cl\u0100du\u310A\u310C;\u698E;\u6990\u0200aeuy\u3117\u311C\u3127\u3129ron;\u4159\u0100di\u3121\u3125il;\u4157\xEC\u0FF2\xE2\u30FA;\u4440\u0200clqs\u3134\u3137\u313D\u3144a;\u6937dhar;\u6969uo\u0100;r\u020E\u020Dh;\u61B3\u0180acg\u314E\u315F\u0F44l\u0200;ips\u0F78\u3158\u315B\u109Cn\xE5\u10BBar\xF4\u0FA9t;\u65AD\u0180ilr\u3169\u1023\u316Esht;\u697D;\uC000\u{1D52F}\u0100ao\u3177\u3186r\u0100du\u317D\u317F\xBB\u047B\u0100;l\u1091\u3184;\u696C\u0100;v\u318B\u318C\u43C1;\u43F1\u0180gns\u3195\u31F9\u31FCht\u0300ahlrst\u31A4\u31B0\u31C2\u31D8\u31E4\u31EErrow\u0100;t\u0FDC\u31ADa\xE9\u30C8arpoon\u0100du\u31BB\u31BFow\xEE\u317Ep\xBB\u1092eft\u0100ah\u31CA\u31D0rrow\xF3\u0FEAarpoon\xF3\u0551ightarrows;\u61C9quigarro\xF7\u30CBhreetimes;\u62CCg;\u42DAingdotse\xF1\u1F32\u0180ahm\u320D\u3210\u3213r\xF2\u0FEAa\xF2\u0551;\u600Foust\u0100;a\u321E\u321F\u63B1che\xBB\u321Fmid;\u6AEE\u0200abpt\u3232\u323D\u3240\u3252\u0100nr\u3237\u323Ag;\u67EDr;\u61FEr\xEB\u1003\u0180afl\u3247\u324A\u324Er;\u6986;\uC000\u{1D563}us;\u6A2Eimes;\u6A35\u0100ap\u325D\u3267r\u0100;g\u3263\u3264\u4029t;\u6994olint;\u6A12ar\xF2\u31E3\u0200achq\u327B\u3280\u10BC\u3285quo;\u603Ar;\uC000\u{1D4C7}\u0100bu\u30FB\u328Ao\u0100;r\u0214\u0213\u0180hir\u3297\u329B\u32A0re\xE5\u31F8mes;\u62CAi\u0200;efl\u32AA\u1059\u1821\u32AB\u65B9tri;\u69CEluhar;\u6968;\u611E\u0D61\u32D5\u32DB\u32DF\u332C\u3338\u3371\0\u337A\u33A4\0\0\u33EC\u33F0\0\u3428\u3448\u345A\u34AD\u34B1\u34CA\u34F1\0\u3616\0\0\u3633cute;\u415Bqu\xEF\u27BA\u0500;Eaceinpsy\u11ED\u32F3\u32F5\u32FF\u3302\u330B\u330F\u331F\u3326\u3329;\u6AB4\u01F0\u32FA\0\u32FC;\u6AB8on;\u4161u\xE5\u11FE\u0100;d\u11F3\u3307il;\u415Frc;\u415D\u0180Eas\u3316\u3318\u331B;\u6AB6p;\u6ABAim;\u62E9olint;\u6A13i\xED\u1204;\u4441ot\u0180;be\u3334\u1D47\u3335\u62C5;\u6A66\u0380Aacmstx\u3346\u334A\u3357\u335B\u335E\u3363\u336Drr;\u61D8r\u0100hr\u3350\u3352\xEB\u2228\u0100;o\u0A36\u0A34t\u803B\xA7\u40A7i;\u403Bwar;\u6929m\u0100in\u3369\xF0nu\xF3\xF1t;\u6736r\u0100;o\u3376\u2055\uC000\u{1D530}\u0200acoy\u3382\u3386\u3391\u33A0rp;\u666F\u0100hy\u338B\u338Fcy;\u4449;\u4448rt\u026D\u3399\0\0\u339Ci\xE4\u1464ara\xEC\u2E6F\u803B\xAD\u40AD\u0100gm\u33A8\u33B4ma\u0180;fv\u33B1\u33B2\u33B2\u43C3;\u43C2\u0400;deglnpr\u12AB\u33C5\u33C9\u33CE\u33D6\u33DE\u33E1\u33E6ot;\u6A6A\u0100;q\u12B1\u12B0\u0100;E\u33D3\u33D4\u6A9E;\u6AA0\u0100;E\u33DB\u33DC\u6A9D;\u6A9Fe;\u6246lus;\u6A24arr;\u6972ar\xF2\u113D\u0200aeit\u33F8\u3408\u340F\u3417\u0100ls\u33FD\u3404lsetm\xE9\u336Ahp;\u6A33parsl;\u69E4\u0100dl\u1463\u3414e;\u6323\u0100;e\u341C\u341D\u6AAA\u0100;s\u3422\u3423\u6AAC;\uC000\u2AAC\uFE00\u0180flp\u342E\u3433\u3442tcy;\u444C\u0100;b\u3438\u3439\u402F\u0100;a\u343E\u343F\u69C4r;\u633Ff;\uC000\u{1D564}a\u0100dr\u344D\u0402es\u0100;u\u3454\u3455\u6660it\xBB\u3455\u0180csu\u3460\u3479\u349F\u0100au\u3465\u346Fp\u0100;s\u1188\u346B;\uC000\u2293\uFE00p\u0100;s\u11B4\u3475;\uC000\u2294\uFE00u\u0100bp\u347F\u348F\u0180;es\u1197\u119C\u3486et\u0100;e\u1197\u348D\xF1\u119D\u0180;es\u11A8\u11AD\u3496et\u0100;e\u11A8\u349D\xF1\u11AE\u0180;af\u117B\u34A6\u05B0r\u0165\u34AB\u05B1\xBB\u117Car\xF2\u1148\u0200cemt\u34B9\u34BE\u34C2\u34C5r;\uC000\u{1D4C8}tm\xEE\xF1i\xEC\u3415ar\xE6\u11BE\u0100ar\u34CE\u34D5r\u0100;f\u34D4\u17BF\u6606\u0100an\u34DA\u34EDight\u0100ep\u34E3\u34EApsilo\xEE\u1EE0h\xE9\u2EAFs\xBB\u2852\u0280bcmnp\u34FB\u355E\u1209\u358B\u358E\u0480;Edemnprs\u350E\u350F\u3511\u3515\u351E\u3523\u352C\u3531\u3536\u6282;\u6AC5ot;\u6ABD\u0100;d\u11DA\u351Aot;\u6AC3ult;\u6AC1\u0100Ee\u3528\u352A;\u6ACB;\u628Alus;\u6ABFarr;\u6979\u0180eiu\u353D\u3552\u3555t\u0180;en\u350E\u3545\u354Bq\u0100;q\u11DA\u350Feq\u0100;q\u352B\u3528m;\u6AC7\u0100bp\u355A\u355C;\u6AD5;\u6AD3c\u0300;acens\u11ED\u356C\u3572\u3579\u357B\u3326ppro\xF8\u32FAurlye\xF1\u11FE\xF1\u11F3\u0180aes\u3582\u3588\u331Bppro\xF8\u331Aq\xF1\u3317g;\u666A\u0680123;Edehlmnps\u35A9\u35AC\u35AF\u121C\u35B2\u35B4\u35C0\u35C9\u35D5\u35DA\u35DF\u35E8\u35ED\u803B\xB9\u40B9\u803B\xB2\u40B2\u803B\xB3\u40B3;\u6AC6\u0100os\u35B9\u35BCt;\u6ABEub;\u6AD8\u0100;d\u1222\u35C5ot;\u6AC4s\u0100ou\u35CF\u35D2l;\u67C9b;\u6AD7arr;\u697Bult;\u6AC2\u0100Ee\u35E4\u35E6;\u6ACC;\u628Blus;\u6AC0\u0180eiu\u35F4\u3609\u360Ct\u0180;en\u121C\u35FC\u3602q\u0100;q\u1222\u35B2eq\u0100;q\u35E7\u35E4m;\u6AC8\u0100bp\u3611\u3613;\u6AD4;\u6AD6\u0180Aan\u361C\u3620\u362Drr;\u61D9r\u0100hr\u3626\u3628\xEB\u222E\u0100;o\u0A2B\u0A29war;\u692Alig\u803B\xDF\u40DF\u0BE1\u3651\u365D\u3660\u12CE\u3673\u3679\0\u367E\u36C2\0\0\0\0\0\u36DB\u3703\0\u3709\u376C\0\0\0\u3787\u0272\u3656\0\0\u365Bget;\u6316;\u43C4r\xEB\u0E5F\u0180aey\u3666\u366B\u3670ron;\u4165dil;\u4163;\u4442lrec;\u6315r;\uC000\u{1D531}\u0200eiko\u3686\u369D\u36B5\u36BC\u01F2\u368B\0\u3691e\u01004f\u1284\u1281a\u0180;sv\u3698\u3699\u369B\u43B8ym;\u43D1\u0100cn\u36A2\u36B2k\u0100as\u36A8\u36AEppro\xF8\u12C1im\xBB\u12ACs\xF0\u129E\u0100as\u36BA\u36AE\xF0\u12C1rn\u803B\xFE\u40FE\u01EC\u031F\u36C6\u22E7es\u8180\xD7;bd\u36CF\u36D0\u36D8\u40D7\u0100;a\u190F\u36D5r;\u6A31;\u6A30\u0180eps\u36E1\u36E3\u3700\xE1\u2A4D\u0200;bcf\u0486\u36EC\u36F0\u36F4ot;\u6336ir;\u6AF1\u0100;o\u36F9\u36FC\uC000\u{1D565}rk;\u6ADA\xE1\u3362rime;\u6034\u0180aip\u370F\u3712\u3764d\xE5\u1248\u0380adempst\u3721\u374D\u3740\u3751\u3757\u375C\u375Fngle\u0280;dlqr\u3730\u3731\u3736\u3740\u3742\u65B5own\xBB\u1DBBeft\u0100;e\u2800\u373E\xF1\u092E;\u625Cight\u0100;e\u32AA\u374B\xF1\u105Aot;\u65ECinus;\u6A3Alus;\u6A39b;\u69CDime;\u6A3Bezium;\u63E2\u0180cht\u3772\u377D\u3781\u0100ry\u3777\u377B;\uC000\u{1D4C9};\u4446cy;\u445Brok;\u4167\u0100io\u378B\u378Ex\xF4\u1777head\u0100lr\u3797\u37A0eftarro\xF7\u084Fightarrow\xBB\u0F5D\u0900AHabcdfghlmoprstuw\u37D0\u37D3\u37D7\u37E4\u37F0\u37FC\u380E\u381C\u3823\u3834\u3851\u385D\u386B\u38A9\u38CC\u38D2\u38EA\u38F6r\xF2\u03EDar;\u6963\u0100cr\u37DC\u37E2ute\u803B\xFA\u40FA\xF2\u1150r\u01E3\u37EA\0\u37EDy;\u445Eve;\u416D\u0100iy\u37F5\u37FArc\u803B\xFB\u40FB;\u4443\u0180abh\u3803\u3806\u380Br\xF2\u13ADlac;\u4171a\xF2\u13C3\u0100ir\u3813\u3818sht;\u697E;\uC000\u{1D532}rave\u803B\xF9\u40F9\u0161\u3827\u3831r\u0100lr\u382C\u382E\xBB\u0957\xBB\u1083lk;\u6580\u0100ct\u3839\u384D\u026F\u383F\0\0\u384Arn\u0100;e\u3845\u3846\u631Cr\xBB\u3846op;\u630Fri;\u65F8\u0100al\u3856\u385Acr;\u416B\u80BB\xA8\u0349\u0100gp\u3862\u3866on;\u4173f;\uC000\u{1D566}\u0300adhlsu\u114B\u3878\u387D\u1372\u3891\u38A0own\xE1\u13B3arpoon\u0100lr\u3888\u388Cef\xF4\u382Digh\xF4\u382Fi\u0180;hl\u3899\u389A\u389C\u43C5\xBB\u13FAon\xBB\u389Aparrows;\u61C8\u0180cit\u38B0\u38C4\u38C8\u026F\u38B6\0\0\u38C1rn\u0100;e\u38BC\u38BD\u631Dr\xBB\u38BDop;\u630Eng;\u416Fri;\u65F9cr;\uC000\u{1D4CA}\u0180dir\u38D9\u38DD\u38E2ot;\u62F0lde;\u4169i\u0100;f\u3730\u38E8\xBB\u1813\u0100am\u38EF\u38F2r\xF2\u38A8l\u803B\xFC\u40FCangle;\u69A7\u0780ABDacdeflnoprsz\u391C\u391F\u3929\u392D\u39B5\u39B8\u39BD\u39DF\u39E4\u39E8\u39F3\u39F9\u39FD\u3A01\u3A20r\xF2\u03F7ar\u0100;v\u3926\u3927\u6AE8;\u6AE9as\xE8\u03E1\u0100nr\u3932\u3937grt;\u699C\u0380eknprst\u34E3\u3946\u394B\u3952\u395D\u3964\u3996app\xE1\u2415othin\xE7\u1E96\u0180hir\u34EB\u2EC8\u3959op\xF4\u2FB5\u0100;h\u13B7\u3962\xEF\u318D\u0100iu\u3969\u396Dgm\xE1\u33B3\u0100bp\u3972\u3984setneq\u0100;q\u397D\u3980\uC000\u228A\uFE00;\uC000\u2ACB\uFE00setneq\u0100;q\u398F\u3992\uC000\u228B\uFE00;\uC000\u2ACC\uFE00\u0100hr\u399B\u399Fet\xE1\u369Ciangle\u0100lr\u39AA\u39AFeft\xBB\u0925ight\xBB\u1051y;\u4432ash\xBB\u1036\u0180elr\u39C4\u39D2\u39D7\u0180;be\u2DEA\u39CB\u39CFar;\u62BBq;\u625Alip;\u62EE\u0100bt\u39DC\u1468a\xF2\u1469r;\uC000\u{1D533}tr\xE9\u39AEsu\u0100bp\u39EF\u39F1\xBB\u0D1C\xBB\u0D59pf;\uC000\u{1D567}ro\xF0\u0EFBtr\xE9\u39B4\u0100cu\u3A06\u3A0Br;\uC000\u{1D4CB}\u0100bp\u3A10\u3A18n\u0100Ee\u3980\u3A16\xBB\u397En\u0100Ee\u3992\u3A1E\xBB\u3990igzag;\u699A\u0380cefoprs\u3A36\u3A3B\u3A56\u3A5B\u3A54\u3A61\u3A6Airc;\u4175\u0100di\u3A40\u3A51\u0100bg\u3A45\u3A49ar;\u6A5Fe\u0100;q\u15FA\u3A4F;\u6259erp;\u6118r;\uC000\u{1D534}pf;\uC000\u{1D568}\u0100;e\u1479\u3A66at\xE8\u1479cr;\uC000\u{1D4CC}\u0AE3\u178E\u3A87\0\u3A8B\0\u3A90\u3A9B\0\0\u3A9D\u3AA8\u3AAB\u3AAF\0\0\u3AC3\u3ACE\0\u3AD8\u17DC\u17DFtr\xE9\u17D1r;\uC000\u{1D535}\u0100Aa\u3A94\u3A97r\xF2\u03C3r\xF2\u09F6;\u43BE\u0100Aa\u3AA1\u3AA4r\xF2\u03B8r\xF2\u09EBa\xF0\u2713is;\u62FB\u0180dpt\u17A4\u3AB5\u3ABE\u0100fl\u3ABA\u17A9;\uC000\u{1D569}im\xE5\u17B2\u0100Aa\u3AC7\u3ACAr\xF2\u03CEr\xF2\u0A01\u0100cq\u3AD2\u17B8r;\uC000\u{1D4CD}\u0100pt\u17D6\u3ADCr\xE9\u17D4\u0400acefiosu\u3AF0\u3AFD\u3B08\u3B0C\u3B11\u3B15\u3B1B\u3B21c\u0100uy\u3AF6\u3AFBte\u803B\xFD\u40FD;\u444F\u0100iy\u3B02\u3B06rc;\u4177;\u444Bn\u803B\xA5\u40A5r;\uC000\u{1D536}cy;\u4457pf;\uC000\u{1D56A}cr;\uC000\u{1D4CE}\u0100cm\u3B26\u3B29y;\u444El\u803B\xFF\u40FF\u0500acdefhiosw\u3B42\u3B48\u3B54\u3B58\u3B64\u3B69\u3B6D\u3B74\u3B7A\u3B80cute;\u417A\u0100ay\u3B4D\u3B52ron;\u417E;\u4437ot;\u417C\u0100et\u3B5D\u3B61tr\xE6\u155Fa;\u43B6r;\uC000\u{1D537}cy;\u4436grarr;\u61DDpf;\uC000\u{1D56B}cr;\uC000\u{1D4CF}\u0100jn\u3B85\u3B87;\u600Dj;\u600C'.split("").map(t=>t.charCodeAt(0)));var hIe=new Uint16Array("\u0200aglq	\x1B\u026D\0\0p;\u4026os;\u4027t;\u403Et;\u403Cuot;\u4022".split("").map(t=>t.charCodeAt(0)));var xY,YKe=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),SY=(xY=String.fromCodePoint)!==null&&xY!==void 0?xY:function(t){let e="";return t>65535&&(t-=65536,e+=String.fromCharCode(t>>>10&1023|55296),t=56320|t&1023),e+=String.fromCharCode(t),e};function IY(t){var e;return t>=55296&&t<=57343||t>1114111?65533:(e=YKe.get(t))!==null&&e!==void 0?e:t}var Wo;(function(t){t[t.NUM=35]="NUM",t[t.SEMI=59]="SEMI",t[t.EQUALS=61]="EQUALS",t[t.ZERO=48]="ZERO",t[t.NINE=57]="NINE",t[t.LOWER_A=97]="LOWER_A",t[t.LOWER_F=102]="LOWER_F",t[t.LOWER_X=120]="LOWER_X",t[t.LOWER_Z=122]="LOWER_Z",t[t.UPPER_A=65]="UPPER_A",t[t.UPPER_F=70]="UPPER_F",t[t.UPPER_Z=90]="UPPER_Z"})(Wo||(Wo={}));var QKe=32,Xg;(function(t){t[t.VALUE_LENGTH=49152]="VALUE_LENGTH",t[t.BRANCH_LENGTH=16256]="BRANCH_LENGTH",t[t.JUMP_TABLE=127]="JUMP_TABLE"})(Xg||(Xg={}));function CY(t){return t>=Wo.ZERO&&t<=Wo.NINE}function XKe(t){return t>=Wo.UPPER_A&&t<=Wo.UPPER_F||t>=Wo.LOWER_A&&t<=Wo.LOWER_F}function JKe(t){return t>=Wo.UPPER_A&&t<=Wo.UPPER_Z||t>=Wo.LOWER_A&&t<=Wo.LOWER_Z||CY(t)}function ZKe(t){return t===Wo.EQUALS||JKe(t)}var $o;(function(t){t[t.EntityStart=0]="EntityStart",t[t.NumericStart=1]="NumericStart",t[t.NumericDecimal=2]="NumericDecimal",t[t.NumericHex=3]="NumericHex",t[t.NamedEntity=4]="NamedEntity"})($o||($o={}));var Zd;(function(t){t[t.Legacy=0]="Legacy",t[t.Strict=1]="Strict",t[t.Attribute=2]="Attribute"})(Zd||(Zd={}));var R6=class{constructor(e,r,n){this.decodeTree=e,this.emitCodePoint=r,this.errors=n,this.state=$o.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=Zd.Strict}startEntity(e){this.decodeMode=e,this.state=$o.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(e,r){switch(this.state){case $o.EntityStart:return e.charCodeAt(r)===Wo.NUM?(this.state=$o.NumericStart,this.consumed+=1,this.stateNumericStart(e,r+1)):(this.state=$o.NamedEntity,this.stateNamedEntity(e,r));case $o.NumericStart:return this.stateNumericStart(e,r);case $o.NumericDecimal:return this.stateNumericDecimal(e,r);case $o.NumericHex:return this.stateNumericHex(e,r);case $o.NamedEntity:return this.stateNamedEntity(e,r)}}stateNumericStart(e,r){return r>=e.length?-1:(e.charCodeAt(r)|QKe)===Wo.LOWER_X?(this.state=$o.NumericHex,this.consumed+=1,this.stateNumericHex(e,r+1)):(this.state=$o.NumericDecimal,this.stateNumericDecimal(e,r))}addToNumericResult(e,r,n,o){if(r!==n){let s=n-r;this.result=this.result*Math.pow(o,s)+parseInt(e.substr(r,s),o),this.consumed+=s}}stateNumericHex(e,r){let n=r;for(;r<e.length;){let o=e.charCodeAt(r);if(CY(o)||XKe(o))r+=1;else return this.addToNumericResult(e,n,r,16),this.emitNumericEntity(o,3)}return this.addToNumericResult(e,n,r,16),-1}stateNumericDecimal(e,r){let n=r;for(;r<e.length;){let o=e.charCodeAt(r);if(CY(o))r+=1;else return this.addToNumericResult(e,n,r,10),this.emitNumericEntity(o,2)}return this.addToNumericResult(e,n,r,10),-1}emitNumericEntity(e,r){var n;if(this.consumed<=r)return(n=this.errors)===null||n===void 0||n.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(e===Wo.SEMI)this.consumed+=1;else if(this.decodeMode===Zd.Strict)return 0;return this.emitCodePoint(IY(this.result),this.consumed),this.errors&&(e!==Wo.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(e,r){let{decodeTree:n}=this,o=n[this.treeIndex],s=(o&Xg.VALUE_LENGTH)>>14;for(;r<e.length;r++,this.excess++){let a=e.charCodeAt(r);if(this.treeIndex=eYe(n,o,this.treeIndex+Math.max(1,s),a),this.treeIndex<0)return this.result===0||this.decodeMode===Zd.Attribute&&(s===0||ZKe(a))?0:this.emitNotTerminatedNamedEntity();if(o=n[this.treeIndex],s=(o&Xg.VALUE_LENGTH)>>14,s!==0){if(a===Wo.SEMI)return this.emitNamedEntityData(this.treeIndex,s,this.consumed+this.excess);this.decodeMode!==Zd.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var e;let{result:r,decodeTree:n}=this,o=(n[r]&Xg.VALUE_LENGTH)>>14;return this.emitNamedEntityData(r,o,this.consumed),(e=this.errors)===null||e===void 0||e.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(e,r,n){let{decodeTree:o}=this;return this.emitCodePoint(r===1?o[e]&~Xg.VALUE_LENGTH:o[e+1],n),r===3&&this.emitCodePoint(o[e+2],n),n}end(){var e;switch(this.state){case $o.NamedEntity:return this.result!==0&&(this.decodeMode!==Zd.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case $o.NumericDecimal:return this.emitNumericEntity(0,2);case $o.NumericHex:return this.emitNumericEntity(0,3);case $o.NumericStart:return(e=this.errors)===null||e===void 0||e.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case $o.EntityStart:return 0}}};function gIe(t){let e="",r=new R6(t,n=>e+=SY(n));return function(o,s){let a=0,c=0;for(;(c=o.indexOf("&",c))>=0;){e+=o.slice(a,c),r.startEntity(s);let l=r.write(o,c+1);if(l<0){a=c+r.end();break}a=c+l,c=l===0?a+1:a}let u=e+o.slice(a);return e="",u}}function eYe(t,e,r,n){let o=(e&Xg.BRANCH_LENGTH)>>7,s=e&Xg.JUMP_TABLE;if(o===0)return s!==0&&n===s?r:-1;if(s){let u=n-s;return u<0||u>=o?-1:t[r+u]-1}let a=r,c=a+o-1;for(;a<=c;){let u=a+c>>>1,l=t[u];if(l<n)a=u+1;else if(l>n)c=u-1;else return t[u+o]}return-1}var tYe=gIe(mIe),Kqt=gIe(hIe);function Jg(t,e=Zd.Legacy){return tYe(t,e)}function k6(t){for(let e=1;e<t.length;e++)t[e][0]+=t[e-1][0]+1;return t}var rYe=new Map(k6([[9,"&Tab;"],[0,"&NewLine;"],[22,"&excl;"],[0,"&quot;"],[0,"&num;"],[0,"&dollar;"],[0,"&percnt;"],[0,"&amp;"],[0,"&apos;"],[0,"&lpar;"],[0,"&rpar;"],[0,"&ast;"],[0,"&plus;"],[0,"&comma;"],[1,"&period;"],[0,"&sol;"],[10,"&colon;"],[0,"&semi;"],[0,{v:"&lt;",n:8402,o:"&nvlt;"}],[0,{v:"&equals;",n:8421,o:"&bne;"}],[0,{v:"&gt;",n:8402,o:"&nvgt;"}],[0,"&quest;"],[0,"&commat;"],[26,"&lbrack;"],[0,"&bsol;"],[0,"&rbrack;"],[0,"&Hat;"],[0,"&lowbar;"],[0,"&DiacriticalGrave;"],[5,{n:106,o:"&fjlig;"}],[20,"&lbrace;"],[0,"&verbar;"],[0,"&rbrace;"],[34,"&nbsp;"],[0,"&iexcl;"],[0,"&cent;"],[0,"&pound;"],[0,"&curren;"],[0,"&yen;"],[0,"&brvbar;"],[0,"&sect;"],[0,"&die;"],[0,"&copy;"],[0,"&ordf;"],[0,"&laquo;"],[0,"&not;"],[0,"&shy;"],[0,"&circledR;"],[0,"&macr;"],[0,"&deg;"],[0,"&PlusMinus;"],[0,"&sup2;"],[0,"&sup3;"],[0,"&acute;"],[0,"&micro;"],[0,"&para;"],[0,"&centerdot;"],[0,"&cedil;"],[0,"&sup1;"],[0,"&ordm;"],[0,"&raquo;"],[0,"&frac14;"],[0,"&frac12;"],[0,"&frac34;"],[0,"&iquest;"],[0,"&Agrave;"],[0,"&Aacute;"],[0,"&Acirc;"],[0,"&Atilde;"],[0,"&Auml;"],[0,"&angst;"],[0,"&AElig;"],[0,"&Ccedil;"],[0,"&Egrave;"],[0,"&Eacute;"],[0,"&Ecirc;"],[0,"&Euml;"],[0,"&Igrave;"],[0,"&Iacute;"],[0,"&Icirc;"],[0,"&Iuml;"],[0,"&ETH;"],[0,"&Ntilde;"],[0,"&Ograve;"],[0,"&Oacute;"],[0,"&Ocirc;"],[0,"&Otilde;"],[0,"&Ouml;"],[0,"&times;"],[0,"&Oslash;"],[0,"&Ugrave;"],[0,"&Uacute;"],[0,"&Ucirc;"],[0,"&Uuml;"],[0,"&Yacute;"],[0,"&THORN;"],[0,"&szlig;"],[0,"&agrave;"],[0,"&aacute;"],[0,"&acirc;"],[0,"&atilde;"],[0,"&auml;"],[0,"&aring;"],[0,"&aelig;"],[0,"&ccedil;"],[0,"&egrave;"],[0,"&eacute;"],[0,"&ecirc;"],[0,"&euml;"],[0,"&igrave;"],[0,"&iacute;"],[0,"&icirc;"],[0,"&iuml;"],[0,"&eth;"],[0,"&ntilde;"],[0,"&ograve;"],[0,"&oacute;"],[0,"&ocirc;"],[0,"&otilde;"],[0,"&ouml;"],[0,"&div;"],[0,"&oslash;"],[0,"&ugrave;"],[0,"&uacute;"],[0,"&ucirc;"],[0,"&uuml;"],[0,"&yacute;"],[0,"&thorn;"],[0,"&yuml;"],[0,"&Amacr;"],[0,"&amacr;"],[0,"&Abreve;"],[0,"&abreve;"],[0,"&Aogon;"],[0,"&aogon;"],[0,"&Cacute;"],[0,"&cacute;"],[0,"&Ccirc;"],[0,"&ccirc;"],[0,"&Cdot;"],[0,"&cdot;"],[0,"&Ccaron;"],[0,"&ccaron;"],[0,"&Dcaron;"],[0,"&dcaron;"],[0,"&Dstrok;"],[0,"&dstrok;"],[0,"&Emacr;"],[0,"&emacr;"],[2,"&Edot;"],[0,"&edot;"],[0,"&Eogon;"],[0,"&eogon;"],[0,"&Ecaron;"],[0,"&ecaron;"],[0,"&Gcirc;"],[0,"&gcirc;"],[0,"&Gbreve;"],[0,"&gbreve;"],[0,"&Gdot;"],[0,"&gdot;"],[0,"&Gcedil;"],[1,"&Hcirc;"],[0,"&hcirc;"],[0,"&Hstrok;"],[0,"&hstrok;"],[0,"&Itilde;"],[0,"&itilde;"],[0,"&Imacr;"],[0,"&imacr;"],[2,"&Iogon;"],[0,"&iogon;"],[0,"&Idot;"],[0,"&imath;"],[0,"&IJlig;"],[0,"&ijlig;"],[0,"&Jcirc;"],[0,"&jcirc;"],[0,"&Kcedil;"],[0,"&kcedil;"],[0,"&kgreen;"],[0,"&Lacute;"],[0,"&lacute;"],[0,"&Lcedil;"],[0,"&lcedil;"],[0,"&Lcaron;"],[0,"&lcaron;"],[0,"&Lmidot;"],[0,"&lmidot;"],[0,"&Lstrok;"],[0,"&lstrok;"],[0,"&Nacute;"],[0,"&nacute;"],[0,"&Ncedil;"],[0,"&ncedil;"],[0,"&Ncaron;"],[0,"&ncaron;"],[0,"&napos;"],[0,"&ENG;"],[0,"&eng;"],[0,"&Omacr;"],[0,"&omacr;"],[2,"&Odblac;"],[0,"&odblac;"],[0,"&OElig;"],[0,"&oelig;"],[0,"&Racute;"],[0,"&racute;"],[0,"&Rcedil;"],[0,"&rcedil;"],[0,"&Rcaron;"],[0,"&rcaron;"],[0,"&Sacute;"],[0,"&sacute;"],[0,"&Scirc;"],[0,"&scirc;"],[0,"&Scedil;"],[0,"&scedil;"],[0,"&Scaron;"],[0,"&scaron;"],[0,"&Tcedil;"],[0,"&tcedil;"],[0,"&Tcaron;"],[0,"&tcaron;"],[0,"&Tstrok;"],[0,"&tstrok;"],[0,"&Utilde;"],[0,"&utilde;"],[0,"&Umacr;"],[0,"&umacr;"],[0,"&Ubreve;"],[0,"&ubreve;"],[0,"&Uring;"],[0,"&uring;"],[0,"&Udblac;"],[0,"&udblac;"],[0,"&Uogon;"],[0,"&uogon;"],[0,"&Wcirc;"],[0,"&wcirc;"],[0,"&Ycirc;"],[0,"&ycirc;"],[0,"&Yuml;"],[0,"&Zacute;"],[0,"&zacute;"],[0,"&Zdot;"],[0,"&zdot;"],[0,"&Zcaron;"],[0,"&zcaron;"],[19,"&fnof;"],[34,"&imped;"],[63,"&gacute;"],[65,"&jmath;"],[142,"&circ;"],[0,"&caron;"],[16,"&breve;"],[0,"&DiacriticalDot;"],[0,"&ring;"],[0,"&ogon;"],[0,"&DiacriticalTilde;"],[0,"&dblac;"],[51,"&DownBreve;"],[127,"&Alpha;"],[0,"&Beta;"],[0,"&Gamma;"],[0,"&Delta;"],[0,"&Epsilon;"],[0,"&Zeta;"],[0,"&Eta;"],[0,"&Theta;"],[0,"&Iota;"],[0,"&Kappa;"],[0,"&Lambda;"],[0,"&Mu;"],[0,"&Nu;"],[0,"&Xi;"],[0,"&Omicron;"],[0,"&Pi;"],[0,"&Rho;"],[1,"&Sigma;"],[0,"&Tau;"],[0,"&Upsilon;"],[0,"&Phi;"],[0,"&Chi;"],[0,"&Psi;"],[0,"&ohm;"],[7,"&alpha;"],[0,"&beta;"],[0,"&gamma;"],[0,"&delta;"],[0,"&epsi;"],[0,"&zeta;"],[0,"&eta;"],[0,"&theta;"],[0,"&iota;"],[0,"&kappa;"],[0,"&lambda;"],[0,"&mu;"],[0,"&nu;"],[0,"&xi;"],[0,"&omicron;"],[0,"&pi;"],[0,"&rho;"],[0,"&sigmaf;"],[0,"&sigma;"],[0,"&tau;"],[0,"&upsi;"],[0,"&phi;"],[0,"&chi;"],[0,"&psi;"],[0,"&omega;"],[7,"&thetasym;"],[0,"&Upsi;"],[2,"&phiv;"],[0,"&piv;"],[5,"&Gammad;"],[0,"&digamma;"],[18,"&kappav;"],[0,"&rhov;"],[3,"&epsiv;"],[0,"&backepsilon;"],[10,"&IOcy;"],[0,"&DJcy;"],[0,"&GJcy;"],[0,"&Jukcy;"],[0,"&DScy;"],[0,"&Iukcy;"],[0,"&YIcy;"],[0,"&Jsercy;"],[0,"&LJcy;"],[0,"&NJcy;"],[0,"&TSHcy;"],[0,"&KJcy;"],[1,"&Ubrcy;"],[0,"&DZcy;"],[0,"&Acy;"],[0,"&Bcy;"],[0,"&Vcy;"],[0,"&Gcy;"],[0,"&Dcy;"],[0,"&IEcy;"],[0,"&ZHcy;"],[0,"&Zcy;"],[0,"&Icy;"],[0,"&Jcy;"],[0,"&Kcy;"],[0,"&Lcy;"],[0,"&Mcy;"],[0,"&Ncy;"],[0,"&Ocy;"],[0,"&Pcy;"],[0,"&Rcy;"],[0,"&Scy;"],[0,"&Tcy;"],[0,"&Ucy;"],[0,"&Fcy;"],[0,"&KHcy;"],[0,"&TScy;"],[0,"&CHcy;"],[0,"&SHcy;"],[0,"&SHCHcy;"],[0,"&HARDcy;"],[0,"&Ycy;"],[0,"&SOFTcy;"],[0,"&Ecy;"],[0,"&YUcy;"],[0,"&YAcy;"],[0,"&acy;"],[0,"&bcy;"],[0,"&vcy;"],[0,"&gcy;"],[0,"&dcy;"],[0,"&iecy;"],[0,"&zhcy;"],[0,"&zcy;"],[0,"&icy;"],[0,"&jcy;"],[0,"&kcy;"],[0,"&lcy;"],[0,"&mcy;"],[0,"&ncy;"],[0,"&ocy;"],[0,"&pcy;"],[0,"&rcy;"],[0,"&scy;"],[0,"&tcy;"],[0,"&ucy;"],[0,"&fcy;"],[0,"&khcy;"],[0,"&tscy;"],[0,"&chcy;"],[0,"&shcy;"],[0,"&shchcy;"],[0,"&hardcy;"],[0,"&ycy;"],[0,"&softcy;"],[0,"&ecy;"],[0,"&yucy;"],[0,"&yacy;"],[1,"&iocy;"],[0,"&djcy;"],[0,"&gjcy;"],[0,"&jukcy;"],[0,"&dscy;"],[0,"&iukcy;"],[0,"&yicy;"],[0,"&jsercy;"],[0,"&ljcy;"],[0,"&njcy;"],[0,"&tshcy;"],[0,"&kjcy;"],[1,"&ubrcy;"],[0,"&dzcy;"],[7074,"&ensp;"],[0,"&emsp;"],[0,"&emsp13;"],[0,"&emsp14;"],[1,"&numsp;"],[0,"&puncsp;"],[0,"&ThinSpace;"],[0,"&hairsp;"],[0,"&NegativeMediumSpace;"],[0,"&zwnj;"],[0,"&zwj;"],[0,"&lrm;"],[0,"&rlm;"],[0,"&dash;"],[2,"&ndash;"],[0,"&mdash;"],[0,"&horbar;"],[0,"&Verbar;"],[1,"&lsquo;"],[0,"&CloseCurlyQuote;"],[0,"&lsquor;"],[1,"&ldquo;"],[0,"&CloseCurlyDoubleQuote;"],[0,"&bdquo;"],[1,"&dagger;"],[0,"&Dagger;"],[0,"&bull;"],[2,"&nldr;"],[0,"&hellip;"],[9,"&permil;"],[0,"&pertenk;"],[0,"&prime;"],[0,"&Prime;"],[0,"&tprime;"],[0,"&backprime;"],[3,"&lsaquo;"],[0,"&rsaquo;"],[3,"&oline;"],[2,"&caret;"],[1,"&hybull;"],[0,"&frasl;"],[10,"&bsemi;"],[7,"&qprime;"],[7,{v:"&MediumSpace;",n:8202,o:"&ThickSpace;"}],[0,"&NoBreak;"],[0,"&af;"],[0,"&InvisibleTimes;"],[0,"&ic;"],[72,"&euro;"],[46,"&tdot;"],[0,"&DotDot;"],[37,"&complexes;"],[2,"&incare;"],[4,"&gscr;"],[0,"&hamilt;"],[0,"&Hfr;"],[0,"&Hopf;"],[0,"&planckh;"],[0,"&hbar;"],[0,"&imagline;"],[0,"&Ifr;"],[0,"&lagran;"],[0,"&ell;"],[1,"&naturals;"],[0,"&numero;"],[0,"&copysr;"],[0,"&weierp;"],[0,"&Popf;"],[0,"&Qopf;"],[0,"&realine;"],[0,"&real;"],[0,"&reals;"],[0,"&rx;"],[3,"&trade;"],[1,"&integers;"],[2,"&mho;"],[0,"&zeetrf;"],[0,"&iiota;"],[2,"&bernou;"],[0,"&Cayleys;"],[1,"&escr;"],[0,"&Escr;"],[0,"&Fouriertrf;"],[1,"&Mellintrf;"],[0,"&order;"],[0,"&alefsym;"],[0,"&beth;"],[0,"&gimel;"],[0,"&daleth;"],[12,"&CapitalDifferentialD;"],[0,"&dd;"],[0,"&ee;"],[0,"&ii;"],[10,"&frac13;"],[0,"&frac23;"],[0,"&frac15;"],[0,"&frac25;"],[0,"&frac35;"],[0,"&frac45;"],[0,"&frac16;"],[0,"&frac56;"],[0,"&frac18;"],[0,"&frac38;"],[0,"&frac58;"],[0,"&frac78;"],[49,"&larr;"],[0,"&ShortUpArrow;"],[0,"&rarr;"],[0,"&darr;"],[0,"&harr;"],[0,"&updownarrow;"],[0,"&nwarr;"],[0,"&nearr;"],[0,"&LowerRightArrow;"],[0,"&LowerLeftArrow;"],[0,"&nlarr;"],[0,"&nrarr;"],[1,{v:"&rarrw;",n:824,o:"&nrarrw;"}],[0,"&Larr;"],[0,"&Uarr;"],[0,"&Rarr;"],[0,"&Darr;"],[0,"&larrtl;"],[0,"&rarrtl;"],[0,"&LeftTeeArrow;"],[0,"&mapstoup;"],[0,"&map;"],[0,"&DownTeeArrow;"],[1,"&hookleftarrow;"],[0,"&hookrightarrow;"],[0,"&larrlp;"],[0,"&looparrowright;"],[0,"&harrw;"],[0,"&nharr;"],[1,"&lsh;"],[0,"&rsh;"],[0,"&ldsh;"],[0,"&rdsh;"],[1,"&crarr;"],[0,"&cularr;"],[0,"&curarr;"],[2,"&circlearrowleft;"],[0,"&circlearrowright;"],[0,"&leftharpoonup;"],[0,"&DownLeftVector;"],[0,"&RightUpVector;"],[0,"&LeftUpVector;"],[0,"&rharu;"],[0,"&DownRightVector;"],[0,"&dharr;"],[0,"&dharl;"],[0,"&RightArrowLeftArrow;"],[0,"&udarr;"],[0,"&LeftArrowRightArrow;"],[0,"&leftleftarrows;"],[0,"&upuparrows;"],[0,"&rightrightarrows;"],[0,"&ddarr;"],[0,"&leftrightharpoons;"],[0,"&Equilibrium;"],[0,"&nlArr;"],[0,"&nhArr;"],[0,"&nrArr;"],[0,"&DoubleLeftArrow;"],[0,"&DoubleUpArrow;"],[0,"&DoubleRightArrow;"],[0,"&dArr;"],[0,"&DoubleLeftRightArrow;"],[0,"&DoubleUpDownArrow;"],[0,"&nwArr;"],[0,"&neArr;"],[0,"&seArr;"],[0,"&swArr;"],[0,"&lAarr;"],[0,"&rAarr;"],[1,"&zigrarr;"],[6,"&larrb;"],[0,"&rarrb;"],[15,"&DownArrowUpArrow;"],[7,"&loarr;"],[0,"&roarr;"],[0,"&hoarr;"],[0,"&forall;"],[0,"&comp;"],[0,{v:"&part;",n:824,o:"&npart;"}],[0,"&exist;"],[0,"&nexist;"],[0,"&empty;"],[1,"&Del;"],[0,"&Element;"],[0,"&NotElement;"],[1,"&ni;"],[0,"&notni;"],[2,"&prod;"],[0,"&coprod;"],[0,"&sum;"],[0,"&minus;"],[0,"&MinusPlus;"],[0,"&dotplus;"],[1,"&Backslash;"],[0,"&lowast;"],[0,"&compfn;"],[1,"&radic;"],[2,"&prop;"],[0,"&infin;"],[0,"&angrt;"],[0,{v:"&ang;",n:8402,o:"&nang;"}],[0,"&angmsd;"],[0,"&angsph;"],[0,"&mid;"],[0,"&nmid;"],[0,"&DoubleVerticalBar;"],[0,"&NotDoubleVerticalBar;"],[0,"&and;"],[0,"&or;"],[0,{v:"&cap;",n:65024,o:"&caps;"}],[0,{v:"&cup;",n:65024,o:"&cups;"}],[0,"&int;"],[0,"&Int;"],[0,"&iiint;"],[0,"&conint;"],[0,"&Conint;"],[0,"&Cconint;"],[0,"&cwint;"],[0,"&ClockwiseContourIntegral;"],[0,"&awconint;"],[0,"&there4;"],[0,"&becaus;"],[0,"&ratio;"],[0,"&Colon;"],[0,"&dotminus;"],[1,"&mDDot;"],[0,"&homtht;"],[0,{v:"&sim;",n:8402,o:"&nvsim;"}],[0,{v:"&backsim;",n:817,o:"&race;"}],[0,{v:"&ac;",n:819,o:"&acE;"}],[0,"&acd;"],[0,"&VerticalTilde;"],[0,"&NotTilde;"],[0,{v:"&eqsim;",n:824,o:"&nesim;"}],[0,"&sime;"],[0,"&NotTildeEqual;"],[0,"&cong;"],[0,"&simne;"],[0,"&ncong;"],[0,"&ap;"],[0,"&nap;"],[0,"&ape;"],[0,{v:"&apid;",n:824,o:"&napid;"}],[0,"&backcong;"],[0,{v:"&asympeq;",n:8402,o:"&nvap;"}],[0,{v:"&bump;",n:824,o:"&nbump;"}],[0,{v:"&bumpe;",n:824,o:"&nbumpe;"}],[0,{v:"&doteq;",n:824,o:"&nedot;"}],[0,"&doteqdot;"],[0,"&efDot;"],[0,"&erDot;"],[0,"&Assign;"],[0,"&ecolon;"],[0,"&ecir;"],[0,"&circeq;"],[1,"&wedgeq;"],[0,"&veeeq;"],[1,"&triangleq;"],[2,"&equest;"],[0,"&ne;"],[0,{v:"&Congruent;",n:8421,o:"&bnequiv;"}],[0,"&nequiv;"],[1,{v:"&le;",n:8402,o:"&nvle;"}],[0,{v:"&ge;",n:8402,o:"&nvge;"}],[0,{v:"&lE;",n:824,o:"&nlE;"}],[0,{v:"&gE;",n:824,o:"&ngE;"}],[0,{v:"&lnE;",n:65024,o:"&lvertneqq;"}],[0,{v:"&gnE;",n:65024,o:"&gvertneqq;"}],[0,{v:"&ll;",n:new Map(k6([[824,"&nLtv;"],[7577,"&nLt;"]]))}],[0,{v:"&gg;",n:new Map(k6([[824,"&nGtv;"],[7577,"&nGt;"]]))}],[0,"&between;"],[0,"&NotCupCap;"],[0,"&nless;"],[0,"&ngt;"],[0,"&nle;"],[0,"&nge;"],[0,"&lesssim;"],[0,"&GreaterTilde;"],[0,"&nlsim;"],[0,"&ngsim;"],[0,"&LessGreater;"],[0,"&gl;"],[0,"&NotLessGreater;"],[0,"&NotGreaterLess;"],[0,"&pr;"],[0,"&sc;"],[0,"&prcue;"],[0,"&sccue;"],[0,"&PrecedesTilde;"],[0,{v:"&scsim;",n:824,o:"&NotSucceedsTilde;"}],[0,"&NotPrecedes;"],[0,"&NotSucceeds;"],[0,{v:"&sub;",n:8402,o:"&NotSubset;"}],[0,{v:"&sup;",n:8402,o:"&NotSuperset;"}],[0,"&nsub;"],[0,"&nsup;"],[0,"&sube;"],[0,"&supe;"],[0,"&NotSubsetEqual;"],[0,"&NotSupersetEqual;"],[0,{v:"&subne;",n:65024,o:"&varsubsetneq;"}],[0,{v:"&supne;",n:65024,o:"&varsupsetneq;"}],[1,"&cupdot;"],[0,"&UnionPlus;"],[0,{v:"&sqsub;",n:824,o:"&NotSquareSubset;"}],[0,{v:"&sqsup;",n:824,o:"&NotSquareSuperset;"}],[0,"&sqsube;"],[0,"&sqsupe;"],[0,{v:"&sqcap;",n:65024,o:"&sqcaps;"}],[0,{v:"&sqcup;",n:65024,o:"&sqcups;"}],[0,"&CirclePlus;"],[0,"&CircleMinus;"],[0,"&CircleTimes;"],[0,"&osol;"],[0,"&CircleDot;"],[0,"&circledcirc;"],[0,"&circledast;"],[1,"&circleddash;"],[0,"&boxplus;"],[0,"&boxminus;"],[0,"&boxtimes;"],[0,"&dotsquare;"],[0,"&RightTee;"],[0,"&dashv;"],[0,"&DownTee;"],[0,"&bot;"],[1,"&models;"],[0,"&DoubleRightTee;"],[0,"&Vdash;"],[0,"&Vvdash;"],[0,"&VDash;"],[0,"&nvdash;"],[0,"&nvDash;"],[0,"&nVdash;"],[0,"&nVDash;"],[0,"&prurel;"],[1,"&LeftTriangle;"],[0,"&RightTriangle;"],[0,{v:"&LeftTriangleEqual;",n:8402,o:"&nvltrie;"}],[0,{v:"&RightTriangleEqual;",n:8402,o:"&nvrtrie;"}],[0,"&origof;"],[0,"&imof;"],[0,"&multimap;"],[0,"&hercon;"],[0,"&intcal;"],[0,"&veebar;"],[1,"&barvee;"],[0,"&angrtvb;"],[0,"&lrtri;"],[0,"&bigwedge;"],[0,"&bigvee;"],[0,"&bigcap;"],[0,"&bigcup;"],[0,"&diam;"],[0,"&sdot;"],[0,"&sstarf;"],[0,"&divideontimes;"],[0,"&bowtie;"],[0,"&ltimes;"],[0,"&rtimes;"],[0,"&leftthreetimes;"],[0,"&rightthreetimes;"],[0,"&backsimeq;"],[0,"&curlyvee;"],[0,"&curlywedge;"],[0,"&Sub;"],[0,"&Sup;"],[0,"&Cap;"],[0,"&Cup;"],[0,"&fork;"],[0,"&epar;"],[0,"&lessdot;"],[0,"&gtdot;"],[0,{v:"&Ll;",n:824,o:"&nLl;"}],[0,{v:"&Gg;",n:824,o:"&nGg;"}],[0,{v:"&leg;",n:65024,o:"&lesg;"}],[0,{v:"&gel;",n:65024,o:"&gesl;"}],[2,"&cuepr;"],[0,"&cuesc;"],[0,"&NotPrecedesSlantEqual;"],[0,"&NotSucceedsSlantEqual;"],[0,"&NotSquareSubsetEqual;"],[0,"&NotSquareSupersetEqual;"],[2,"&lnsim;"],[0,"&gnsim;"],[0,"&precnsim;"],[0,"&scnsim;"],[0,"&nltri;"],[0,"&NotRightTriangle;"],[0,"&nltrie;"],[0,"&NotRightTriangleEqual;"],[0,"&vellip;"],[0,"&ctdot;"],[0,"&utdot;"],[0,"&dtdot;"],[0,"&disin;"],[0,"&isinsv;"],[0,"&isins;"],[0,{v:"&isindot;",n:824,o:"&notindot;"}],[0,"&notinvc;"],[0,"&notinvb;"],[1,{v:"&isinE;",n:824,o:"&notinE;"}],[0,"&nisd;"],[0,"&xnis;"],[0,"&nis;"],[0,"&notnivc;"],[0,"&notnivb;"],[6,"&barwed;"],[0,"&Barwed;"],[1,"&lceil;"],[0,"&rceil;"],[0,"&LeftFloor;"],[0,"&rfloor;"],[0,"&drcrop;"],[0,"&dlcrop;"],[0,"&urcrop;"],[0,"&ulcrop;"],[0,"&bnot;"],[1,"&profline;"],[0,"&profsurf;"],[1,"&telrec;"],[0,"&target;"],[5,"&ulcorn;"],[0,"&urcorn;"],[0,"&dlcorn;"],[0,"&drcorn;"],[2,"&frown;"],[0,"&smile;"],[9,"&cylcty;"],[0,"&profalar;"],[7,"&topbot;"],[6,"&ovbar;"],[1,"&solbar;"],[60,"&angzarr;"],[51,"&lmoustache;"],[0,"&rmoustache;"],[2,"&OverBracket;"],[0,"&bbrk;"],[0,"&bbrktbrk;"],[37,"&OverParenthesis;"],[0,"&UnderParenthesis;"],[0,"&OverBrace;"],[0,"&UnderBrace;"],[2,"&trpezium;"],[4,"&elinters;"],[59,"&blank;"],[164,"&circledS;"],[55,"&boxh;"],[1,"&boxv;"],[9,"&boxdr;"],[3,"&boxdl;"],[3,"&boxur;"],[3,"&boxul;"],[3,"&boxvr;"],[7,"&boxvl;"],[7,"&boxhd;"],[7,"&boxhu;"],[7,"&boxvh;"],[19,"&boxH;"],[0,"&boxV;"],[0,"&boxdR;"],[0,"&boxDr;"],[0,"&boxDR;"],[0,"&boxdL;"],[0,"&boxDl;"],[0,"&boxDL;"],[0,"&boxuR;"],[0,"&boxUr;"],[0,"&boxUR;"],[0,"&boxuL;"],[0,"&boxUl;"],[0,"&boxUL;"],[0,"&boxvR;"],[0,"&boxVr;"],[0,"&boxVR;"],[0,"&boxvL;"],[0,"&boxVl;"],[0,"&boxVL;"],[0,"&boxHd;"],[0,"&boxhD;"],[0,"&boxHD;"],[0,"&boxHu;"],[0,"&boxhU;"],[0,"&boxHU;"],[0,"&boxvH;"],[0,"&boxVh;"],[0,"&boxVH;"],[19,"&uhblk;"],[3,"&lhblk;"],[3,"&block;"],[8,"&blk14;"],[0,"&blk12;"],[0,"&blk34;"],[13,"&square;"],[8,"&blacksquare;"],[0,"&EmptyVerySmallSquare;"],[1,"&rect;"],[0,"&marker;"],[2,"&fltns;"],[1,"&bigtriangleup;"],[0,"&blacktriangle;"],[0,"&triangle;"],[2,"&blacktriangleright;"],[0,"&rtri;"],[3,"&bigtriangledown;"],[0,"&blacktriangledown;"],[0,"&dtri;"],[2,"&blacktriangleleft;"],[0,"&ltri;"],[6,"&loz;"],[0,"&cir;"],[32,"&tridot;"],[2,"&bigcirc;"],[8,"&ultri;"],[0,"&urtri;"],[0,"&lltri;"],[0,"&EmptySmallSquare;"],[0,"&FilledSmallSquare;"],[8,"&bigstar;"],[0,"&star;"],[7,"&phone;"],[49,"&female;"],[1,"&male;"],[29,"&spades;"],[2,"&clubs;"],[1,"&hearts;"],[0,"&diamondsuit;"],[3,"&sung;"],[2,"&flat;"],[0,"&natural;"],[0,"&sharp;"],[163,"&check;"],[3,"&cross;"],[8,"&malt;"],[21,"&sext;"],[33,"&VerticalSeparator;"],[25,"&lbbrk;"],[0,"&rbbrk;"],[84,"&bsolhsub;"],[0,"&suphsol;"],[28,"&LeftDoubleBracket;"],[0,"&RightDoubleBracket;"],[0,"&lang;"],[0,"&rang;"],[0,"&Lang;"],[0,"&Rang;"],[0,"&loang;"],[0,"&roang;"],[7,"&longleftarrow;"],[0,"&longrightarrow;"],[0,"&longleftrightarrow;"],[0,"&DoubleLongLeftArrow;"],[0,"&DoubleLongRightArrow;"],[0,"&DoubleLongLeftRightArrow;"],[1,"&longmapsto;"],[2,"&dzigrarr;"],[258,"&nvlArr;"],[0,"&nvrArr;"],[0,"&nvHarr;"],[0,"&Map;"],[6,"&lbarr;"],[0,"&bkarow;"],[0,"&lBarr;"],[0,"&dbkarow;"],[0,"&drbkarow;"],[0,"&DDotrahd;"],[0,"&UpArrowBar;"],[0,"&DownArrowBar;"],[2,"&Rarrtl;"],[2,"&latail;"],[0,"&ratail;"],[0,"&lAtail;"],[0,"&rAtail;"],[0,"&larrfs;"],[0,"&rarrfs;"],[0,"&larrbfs;"],[0,"&rarrbfs;"],[2,"&nwarhk;"],[0,"&nearhk;"],[0,"&hksearow;"],[0,"&hkswarow;"],[0,"&nwnear;"],[0,"&nesear;"],[0,"&seswar;"],[0,"&swnwar;"],[8,{v:"&rarrc;",n:824,o:"&nrarrc;"}],[1,"&cudarrr;"],[0,"&ldca;"],[0,"&rdca;"],[0,"&cudarrl;"],[0,"&larrpl;"],[2,"&curarrm;"],[0,"&cularrp;"],[7,"&rarrpl;"],[2,"&harrcir;"],[0,"&Uarrocir;"],[0,"&lurdshar;"],[0,"&ldrushar;"],[2,"&LeftRightVector;"],[0,"&RightUpDownVector;"],[0,"&DownLeftRightVector;"],[0,"&LeftUpDownVector;"],[0,"&LeftVectorBar;"],[0,"&RightVectorBar;"],[0,"&RightUpVectorBar;"],[0,"&RightDownVectorBar;"],[0,"&DownLeftVectorBar;"],[0,"&DownRightVectorBar;"],[0,"&LeftUpVectorBar;"],[0,"&LeftDownVectorBar;"],[0,"&LeftTeeVector;"],[0,"&RightTeeVector;"],[0,"&RightUpTeeVector;"],[0,"&RightDownTeeVector;"],[0,"&DownLeftTeeVector;"],[0,"&DownRightTeeVector;"],[0,"&LeftUpTeeVector;"],[0,"&LeftDownTeeVector;"],[0,"&lHar;"],[0,"&uHar;"],[0,"&rHar;"],[0,"&dHar;"],[0,"&luruhar;"],[0,"&ldrdhar;"],[0,"&ruluhar;"],[0,"&rdldhar;"],[0,"&lharul;"],[0,"&llhard;"],[0,"&rharul;"],[0,"&lrhard;"],[0,"&udhar;"],[0,"&duhar;"],[0,"&RoundImplies;"],[0,"&erarr;"],[0,"&simrarr;"],[0,"&larrsim;"],[0,"&rarrsim;"],[0,"&rarrap;"],[0,"&ltlarr;"],[1,"&gtrarr;"],[0,"&subrarr;"],[1,"&suplarr;"],[0,"&lfisht;"],[0,"&rfisht;"],[0,"&ufisht;"],[0,"&dfisht;"],[5,"&lopar;"],[0,"&ropar;"],[4,"&lbrke;"],[0,"&rbrke;"],[0,"&lbrkslu;"],[0,"&rbrksld;"],[0,"&lbrksld;"],[0,"&rbrkslu;"],[0,"&langd;"],[0,"&rangd;"],[0,"&lparlt;"],[0,"&rpargt;"],[0,"&gtlPar;"],[0,"&ltrPar;"],[3,"&vzigzag;"],[1,"&vangrt;"],[0,"&angrtvbd;"],[6,"&ange;"],[0,"&range;"],[0,"&dwangle;"],[0,"&uwangle;"],[0,"&angmsdaa;"],[0,"&angmsdab;"],[0,"&angmsdac;"],[0,"&angmsdad;"],[0,"&angmsdae;"],[0,"&angmsdaf;"],[0,"&angmsdag;"],[0,"&angmsdah;"],[0,"&bemptyv;"],[0,"&demptyv;"],[0,"&cemptyv;"],[0,"&raemptyv;"],[0,"&laemptyv;"],[0,"&ohbar;"],[0,"&omid;"],[0,"&opar;"],[1,"&operp;"],[1,"&olcross;"],[0,"&odsold;"],[1,"&olcir;"],[0,"&ofcir;"],[0,"&olt;"],[0,"&ogt;"],[0,"&cirscir;"],[0,"&cirE;"],[0,"&solb;"],[0,"&bsolb;"],[3,"&boxbox;"],[3,"&trisb;"],[0,"&rtriltri;"],[0,{v:"&LeftTriangleBar;",n:824,o:"&NotLeftTriangleBar;"}],[0,{v:"&RightTriangleBar;",n:824,o:"&NotRightTriangleBar;"}],[11,"&iinfin;"],[0,"&infintie;"],[0,"&nvinfin;"],[4,"&eparsl;"],[0,"&smeparsl;"],[0,"&eqvparsl;"],[5,"&blacklozenge;"],[8,"&RuleDelayed;"],[1,"&dsol;"],[9,"&bigodot;"],[0,"&bigoplus;"],[0,"&bigotimes;"],[1,"&biguplus;"],[1,"&bigsqcup;"],[5,"&iiiint;"],[0,"&fpartint;"],[2,"&cirfnint;"],[0,"&awint;"],[0,"&rppolint;"],[0,"&scpolint;"],[0,"&npolint;"],[0,"&pointint;"],[0,"&quatint;"],[0,"&intlarhk;"],[10,"&pluscir;"],[0,"&plusacir;"],[0,"&simplus;"],[0,"&plusdu;"],[0,"&plussim;"],[0,"&plustwo;"],[1,"&mcomma;"],[0,"&minusdu;"],[2,"&loplus;"],[0,"&roplus;"],[0,"&Cross;"],[0,"&timesd;"],[0,"&timesbar;"],[1,"&smashp;"],[0,"&lotimes;"],[0,"&rotimes;"],[0,"&otimesas;"],[0,"&Otimes;"],[0,"&odiv;"],[0,"&triplus;"],[0,"&triminus;"],[0,"&tritime;"],[0,"&intprod;"],[2,"&amalg;"],[0,"&capdot;"],[1,"&ncup;"],[0,"&ncap;"],[0,"&capand;"],[0,"&cupor;"],[0,"&cupcap;"],[0,"&capcup;"],[0,"&cupbrcap;"],[0,"&capbrcup;"],[0,"&cupcup;"],[0,"&capcap;"],[0,"&ccups;"],[0,"&ccaps;"],[2,"&ccupssm;"],[2,"&And;"],[0,"&Or;"],[0,"&andand;"],[0,"&oror;"],[0,"&orslope;"],[0,"&andslope;"],[1,"&andv;"],[0,"&orv;"],[0,"&andd;"],[0,"&ord;"],[1,"&wedbar;"],[6,"&sdote;"],[3,"&simdot;"],[2,{v:"&congdot;",n:824,o:"&ncongdot;"}],[0,"&easter;"],[0,"&apacir;"],[0,{v:"&apE;",n:824,o:"&napE;"}],[0,"&eplus;"],[0,"&pluse;"],[0,"&Esim;"],[0,"&Colone;"],[0,"&Equal;"],[1,"&ddotseq;"],[0,"&equivDD;"],[0,"&ltcir;"],[0,"&gtcir;"],[0,"&ltquest;"],[0,"&gtquest;"],[0,{v:"&leqslant;",n:824,o:"&nleqslant;"}],[0,{v:"&geqslant;",n:824,o:"&ngeqslant;"}],[0,"&lesdot;"],[0,"&gesdot;"],[0,"&lesdoto;"],[0,"&gesdoto;"],[0,"&lesdotor;"],[0,"&gesdotol;"],[0,"&lap;"],[0,"&gap;"],[0,"&lne;"],[0,"&gne;"],[0,"&lnap;"],[0,"&gnap;"],[0,"&lEg;"],[0,"&gEl;"],[0,"&lsime;"],[0,"&gsime;"],[0,"&lsimg;"],[0,"&gsiml;"],[0,"&lgE;"],[0,"&glE;"],[0,"&lesges;"],[0,"&gesles;"],[0,"&els;"],[0,"&egs;"],[0,"&elsdot;"],[0,"&egsdot;"],[0,"&el;"],[0,"&eg;"],[2,"&siml;"],[0,"&simg;"],[0,"&simlE;"],[0,"&simgE;"],[0,{v:"&LessLess;",n:824,o:"&NotNestedLessLess;"}],[0,{v:"&GreaterGreater;",n:824,o:"&NotNestedGreaterGreater;"}],[1,"&glj;"],[0,"&gla;"],[0,"&ltcc;"],[0,"&gtcc;"],[0,"&lescc;"],[0,"&gescc;"],[0,"&smt;"],[0,"&lat;"],[0,{v:"&smte;",n:65024,o:"&smtes;"}],[0,{v:"&late;",n:65024,o:"&lates;"}],[0,"&bumpE;"],[0,{v:"&PrecedesEqual;",n:824,o:"&NotPrecedesEqual;"}],[0,{v:"&sce;",n:824,o:"&NotSucceedsEqual;"}],[2,"&prE;"],[0,"&scE;"],[0,"&precneqq;"],[0,"&scnE;"],[0,"&prap;"],[0,"&scap;"],[0,"&precnapprox;"],[0,"&scnap;"],[0,"&Pr;"],[0,"&Sc;"],[0,"&subdot;"],[0,"&supdot;"],[0,"&subplus;"],[0,"&supplus;"],[0,"&submult;"],[0,"&supmult;"],[0,"&subedot;"],[0,"&supedot;"],[0,{v:"&subE;",n:824,o:"&nsubE;"}],[0,{v:"&supE;",n:824,o:"&nsupE;"}],[0,"&subsim;"],[0,"&supsim;"],[2,{v:"&subnE;",n:65024,o:"&varsubsetneqq;"}],[0,{v:"&supnE;",n:65024,o:"&varsupsetneqq;"}],[2,"&csub;"],[0,"&csup;"],[0,"&csube;"],[0,"&csupe;"],[0,"&subsup;"],[0,"&supsub;"],[0,"&subsub;"],[0,"&supsup;"],[0,"&suphsub;"],[0,"&supdsub;"],[0,"&forkv;"],[0,"&topfork;"],[0,"&mlcp;"],[8,"&Dashv;"],[1,"&Vdashl;"],[0,"&Barv;"],[0,"&vBar;"],[0,"&vBarv;"],[1,"&Vbar;"],[0,"&Not;"],[0,"&bNot;"],[0,"&rnmid;"],[0,"&cirmid;"],[0,"&midcir;"],[0,"&topcir;"],[0,"&nhpar;"],[0,"&parsim;"],[9,{v:"&parsl;",n:8421,o:"&nparsl;"}],[44343,{n:new Map(k6([[56476,"&Ascr;"],[1,"&Cscr;"],[0,"&Dscr;"],[2,"&Gscr;"],[2,"&Jscr;"],[0,"&Kscr;"],[2,"&Nscr;"],[0,"&Oscr;"],[0,"&Pscr;"],[0,"&Qscr;"],[1,"&Sscr;"],[0,"&Tscr;"],[0,"&Uscr;"],[0,"&Vscr;"],[0,"&Wscr;"],[0,"&Xscr;"],[0,"&Yscr;"],[0,"&Zscr;"],[0,"&ascr;"],[0,"&bscr;"],[0,"&cscr;"],[0,"&dscr;"],[1,"&fscr;"],[1,"&hscr;"],[0,"&iscr;"],[0,"&jscr;"],[0,"&kscr;"],[0,"&lscr;"],[0,"&mscr;"],[0,"&nscr;"],[1,"&pscr;"],[0,"&qscr;"],[0,"&rscr;"],[0,"&sscr;"],[0,"&tscr;"],[0,"&uscr;"],[0,"&vscr;"],[0,"&wscr;"],[0,"&xscr;"],[0,"&yscr;"],[0,"&zscr;"],[52,"&Afr;"],[0,"&Bfr;"],[1,"&Dfr;"],[0,"&Efr;"],[0,"&Ffr;"],[0,"&Gfr;"],[2,"&Jfr;"],[0,"&Kfr;"],[0,"&Lfr;"],[0,"&Mfr;"],[0,"&Nfr;"],[0,"&Ofr;"],[0,"&Pfr;"],[0,"&Qfr;"],[1,"&Sfr;"],[0,"&Tfr;"],[0,"&Ufr;"],[0,"&Vfr;"],[0,"&Wfr;"],[0,"&Xfr;"],[0,"&Yfr;"],[1,"&afr;"],[0,"&bfr;"],[0,"&cfr;"],[0,"&dfr;"],[0,"&efr;"],[0,"&ffr;"],[0,"&gfr;"],[0,"&hfr;"],[0,"&ifr;"],[0,"&jfr;"],[0,"&kfr;"],[0,"&lfr;"],[0,"&mfr;"],[0,"&nfr;"],[0,"&ofr;"],[0,"&pfr;"],[0,"&qfr;"],[0,"&rfr;"],[0,"&sfr;"],[0,"&tfr;"],[0,"&ufr;"],[0,"&vfr;"],[0,"&wfr;"],[0,"&xfr;"],[0,"&yfr;"],[0,"&zfr;"],[0,"&Aopf;"],[0,"&Bopf;"],[1,"&Dopf;"],[0,"&Eopf;"],[0,"&Fopf;"],[0,"&Gopf;"],[1,"&Iopf;"],[0,"&Jopf;"],[0,"&Kopf;"],[0,"&Lopf;"],[0,"&Mopf;"],[1,"&Oopf;"],[3,"&Sopf;"],[0,"&Topf;"],[0,"&Uopf;"],[0,"&Vopf;"],[0,"&Wopf;"],[0,"&Xopf;"],[0,"&Yopf;"],[1,"&aopf;"],[0,"&bopf;"],[0,"&copf;"],[0,"&dopf;"],[0,"&eopf;"],[0,"&fopf;"],[0,"&gopf;"],[0,"&hopf;"],[0,"&iopf;"],[0,"&jopf;"],[0,"&kopf;"],[0,"&lopf;"],[0,"&mopf;"],[0,"&nopf;"],[0,"&oopf;"],[0,"&popf;"],[0,"&qopf;"],[0,"&ropf;"],[0,"&sopf;"],[0,"&topf;"],[0,"&uopf;"],[0,"&vopf;"],[0,"&wopf;"],[0,"&xopf;"],[0,"&yopf;"],[0,"&zopf;"]]))}],[8906,"&fflig;"],[0,"&filig;"],[0,"&fllig;"],[0,"&ffilig;"],[0,"&ffllig;"]]));var nYe=new Map([[34,"&quot;"],[38,"&amp;"],[39,"&apos;"],[60,"&lt;"],[62,"&gt;"]]),iYe=String.prototype.codePointAt!=null?(t,e)=>t.codePointAt(e):(t,e)=>(t.charCodeAt(e)&64512)===55296?(t.charCodeAt(e)-55296)*1024+t.charCodeAt(e+1)-56320+65536:t.charCodeAt(e);function TY(t,e){return function(n){let o,s=0,a="";for(;o=t.exec(n);)s!==o.index&&(a+=n.substring(s,o.index)),a+=e.get(o[0].charCodeAt(0)),s=o.index+1;return a+n.substring(s)}}var vIe=TY(/[&<>'"]/g,nYe),yIe=TY(/["&\u00A0]/g,new Map([[34,"&quot;"],[38,"&amp;"],[160,"&nbsp;"]])),bIe=TY(/[&<>\u00A0]/g,new Map([[38,"&amp;"],[60,"&lt;"],[62,"&gt;"],[160,"&nbsp;"]]));var _Ie;(function(t){t[t.XML=0]="XML",t[t.HTML=1]="HTML"})(_Ie||(_Ie={}));var xIe;(function(t){t[t.UTF8=0]="UTF8",t[t.ASCII=1]="ASCII",t[t.Extensive=2]="Extensive",t[t.Attribute=3]="Attribute",t[t.Text=4]="Text"})(xIe||(xIe={}));function aYe(t){return Object.prototype.toString.call(t)}function A6(t){return aYe(t)==="[object String]"}var cYe=Object.prototype.hasOwnProperty;function uYe(t,e){return cYe.call(t,e)}function rI(t){return Array.prototype.slice.call(arguments,1).forEach(function(r){if(r){if(typeof r!="object")throw new TypeError(r+"must be object");Object.keys(r).forEach(function(n){t[n]=r[n]})}}),t}function wY(t,e,r){return[].concat(t.slice(0,e),r,t.slice(e+1))}function P6(t){return!(t>=55296&&t<=57343||t>=64976&&t<=65007||(t&65535)===65535||(t&65535)===65534||t>=0&&t<=8||t===11||t>=14&&t<=31||t>=127&&t<=159||t>1114111)}function Wk(t){if(t>65535){t-=65536;let e=55296+(t>>10),r=56320+(t&1023);return String.fromCharCode(e,r)}return String.fromCharCode(t)}var CIe=/\\([!"#$%&'()*+,\-./:;<=>?@[\\\]^_`{|}~])/g,lYe=/&([a-z#][a-z0-9]{1,31});/gi,dYe=new RegExp(CIe.source+"|"+lYe.source,"gi"),pYe=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))$/i;function fYe(t,e){if(e.charCodeAt(0)===35&&pYe.test(e)){let n=e[1].toLowerCase()==="x"?parseInt(e.slice(2),16):parseInt(e.slice(1),10);return P6(n)?Wk(n):t}let r=Jg(t);return r!==t?r:t}function mYe(t){return t.indexOf("\\")<0?t:t.replace(CIe,"$1")}function Zg(t){return t.indexOf("\\")<0&&t.indexOf("&")<0?t:t.replace(dYe,function(e,r,n){return r||fYe(e,n)})}var hYe=/[&<>"]/,gYe=/[&<>"]/g,vYe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function yYe(t){return vYe[t]}function Qf(t){return hYe.test(t)?t.replace(gYe,yYe):t}var bYe=/[.?*+^$[\]\\(){}|-]/g;function _Ye(t){return t.replace(bYe,"\\$&")}function ur(t){switch(t){case 9:case 32:return!0}return!1}function bb(t){if(t>=8192&&t<=8202)return!0;switch(t){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1}function _b(t){return tI.test(t)}function xb(t){switch(t){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}}function Sb(t){return t=t.trim().replace(/\s+/g," "),"\u1E9E".toLowerCase()==="\u1E7E"&&(t=t.replace(//g,"\xDF")),t.toLowerCase().toUpperCase()}var xYe={mdurl:C6,ucmicro:_Y};var DY={};dn(DY,{parseLinkDestination:()=>AY,parseLinkLabel:()=>kY,parseLinkTitle:()=>PY});function kY(t,e,r){let n,o,s,a,c=t.posMax,u=t.pos;for(t.pos=e+1,n=1;t.pos<c;){if(s=t.src.charCodeAt(t.pos),s===93&&(n--,n===0)){o=!0;break}if(a=t.pos,t.md.inline.skipToken(t),s===91){if(a===t.pos-1)n++;else if(r)return t.pos=u,-1}}let l=-1;return o&&(l=t.pos),t.pos=u,l}function AY(t,e,r){let n,o=e,s={ok:!1,pos:0,lines:0,str:""};if(t.charCodeAt(o)===60){for(o++;o<r;){if(n=t.charCodeAt(o),n===10||n===60)return s;if(n===62)return s.pos=o+1,s.str=Zg(t.slice(e+1,o)),s.ok=!0,s;if(n===92&&o+1<r){o+=2;continue}o++}return s}let a=0;for(;o<r&&(n=t.charCodeAt(o),!(n===32||n<32||n===127));){if(n===92&&o+1<r){if(t.charCodeAt(o+1)===32)break;o+=2;continue}if(n===40&&(a++,a>32))return s;if(n===41){if(a===0)break;a--}o++}return e===o||a!==0||(s.str=Zg(t.slice(e,o)),s.pos=o,s.ok=!0),s}function PY(t,e,r){let n,o,s=0,a=e,c={ok:!1,pos:0,lines:0,str:""};if(a>=r||(o=t.charCodeAt(a),o!==34&&o!==39&&o!==40))return c;for(a++,o===40&&(o=41);a<r;){if(n=t.charCodeAt(a),n===o)return c.pos=a+1,c.lines=s,c.str=Zg(t.slice(e+1,a)),c.ok=!0,c;if(n===40&&o===41)return c;n===10?s++:n===92&&a+1<r&&(a++,t.charCodeAt(a)===10&&s++),a++}return c}var ep={};ep.code_inline=function(t,e,r,n,o){let s=t[e];return"<code"+o.renderAttrs(s)+">"+Qf(s.content)+"</code>"};ep.code_block=function(t,e,r,n,o){let s=t[e];return"<pre"+o.renderAttrs(s)+"><code>"+Qf(t[e].content)+`</code></pre>
`};ep.fence=function(t,e,r,n,o){let s=t[e],a=s.info?Zg(s.info).trim():"",c="",u="";if(a){let d=a.split(/(\s+)/g);c=d[0],u=d.slice(2).join("")}let l;if(r.highlight?l=r.highlight(s.content,c,u)||Qf(s.content):l=Qf(s.content),l.indexOf("<pre")===0)return l+`
`;if(a){let d=s.attrIndex("class"),p=s.attrs?s.attrs.slice():[];d<0?p.push(["class",r.langPrefix+c]):(p[d]=p[d].slice(),p[d][1]+=" "+r.langPrefix+c);let f={attrs:p};return`<pre><code${o.renderAttrs(f)}>${l}</code></pre>
`}return`<pre><code${o.renderAttrs(s)}>${l}</code></pre>
`};ep.image=function(t,e,r,n,o){let s=t[e];return s.attrs[s.attrIndex("alt")][1]=o.renderInlineAsText(s.children,r,n),o.renderToken(t,e,r)};ep.hardbreak=function(t,e,r){return r.xhtmlOut?`<br />
`:`<br>
`};ep.softbreak=function(t,e,r){return r.breaks?r.xhtmlOut?`<br />
`:`<br>
`:`
`};ep.text=function(t,e){return Qf(t[e].content)};ep.html_block=function(t,e){return t[e].content};ep.html_inline=function(t,e){return t[e].content};function nI(){this.rules=rI({},ep)}nI.prototype.renderAttrs=function(e){let r,n,o;if(!e.attrs)return"";for(o="",r=0,n=e.attrs.length;r<n;r++)o+=" "+Qf(e.attrs[r][0])+'="'+Qf(e.attrs[r][1])+'"';return o};nI.prototype.renderToken=function(e,r,n){let o=e[r],s="";if(o.hidden)return"";o.block&&o.nesting!==-1&&r&&e[r-1].hidden&&(s+=`
`),s+=(o.nesting===-1?"</":"<")+o.tag,s+=this.renderAttrs(o),o.nesting===0&&n.xhtmlOut&&(s+=" /");let a=!1;if(o.block&&(a=!0,o.nesting===1&&r+1<e.length)){let c=e[r+1];(c.type==="inline"||c.hidden||c.nesting===-1&&c.tag===o.tag)&&(a=!1)}return s+=a?`>
`:">",s};nI.prototype.renderInline=function(t,e,r){let n="",o=this.rules;for(let s=0,a=t.length;s<a;s++){let c=t[s].type;typeof o[c]<"u"?n+=o[c](t,s,e,r,this):n+=this.renderToken(t,s,e)}return n};nI.prototype.renderInlineAsText=function(t,e,r){let n="";for(let o=0,s=t.length;o<s;o++)switch(t[o].type){case"text":n+=t[o].content;break;case"image":n+=this.renderInlineAsText(t[o].children,e,r);break;case"html_inline":case"html_block":n+=t[o].content;break;case"softbreak":case"hardbreak":n+=`
`;break;default:}return n};nI.prototype.render=function(t,e,r){let n="",o=this.rules;for(let s=0,a=t.length;s<a;s++){let c=t[s].type;c==="inline"?n+=this.renderInline(t[s].children,e,r):typeof o[c]<"u"?n+=o[c](t,s,e,r,this):n+=this.renderToken(t,s,e,r)}return n};var TIe=nI;function Cl(){this.__rules__=[],this.__cache__=null}Cl.prototype.__find__=function(t){for(let e=0;e<this.__rules__.length;e++)if(this.__rules__[e].name===t)return e;return-1};Cl.prototype.__compile__=function(){let t=this,e=[""];t.__rules__.forEach(function(r){r.enabled&&r.alt.forEach(function(n){e.indexOf(n)<0&&e.push(n)})}),t.__cache__={},e.forEach(function(r){t.__cache__[r]=[],t.__rules__.forEach(function(n){n.enabled&&(r&&n.alt.indexOf(r)<0||t.__cache__[r].push(n.fn))})})};Cl.prototype.at=function(t,e,r){let n=this.__find__(t),o=r||{};if(n===-1)throw new Error("Parser rule not found: "+t);this.__rules__[n].fn=e,this.__rules__[n].alt=o.alt||[],this.__cache__=null};Cl.prototype.before=function(t,e,r,n){let o=this.__find__(t),s=n||{};if(o===-1)throw new Error("Parser rule not found: "+t);this.__rules__.splice(o,0,{name:e,enabled:!0,fn:r,alt:s.alt||[]}),this.__cache__=null};Cl.prototype.after=function(t,e,r,n){let o=this.__find__(t),s=n||{};if(o===-1)throw new Error("Parser rule not found: "+t);this.__rules__.splice(o+1,0,{name:e,enabled:!0,fn:r,alt:s.alt||[]}),this.__cache__=null};Cl.prototype.push=function(t,e,r){let n=r||{};this.__rules__.push({name:t,enabled:!0,fn:e,alt:n.alt||[]}),this.__cache__=null};Cl.prototype.enable=function(t,e){Array.isArray(t)||(t=[t]);let r=[];return t.forEach(function(n){let o=this.__find__(n);if(o<0){if(e)return;throw new Error("Rules manager: invalid rule name "+n)}this.__rules__[o].enabled=!0,r.push(n)},this),this.__cache__=null,r};Cl.prototype.enableOnly=function(t,e){Array.isArray(t)||(t=[t]),this.__rules__.forEach(function(r){r.enabled=!1}),this.enable(t,e)};Cl.prototype.disable=function(t,e){Array.isArray(t)||(t=[t]);let r=[];return t.forEach(function(n){let o=this.__find__(n);if(o<0){if(e)return;throw new Error("Rules manager: invalid rule name "+n)}this.__rules__[o].enabled=!1,r.push(n)},this),this.__cache__=null,r};Cl.prototype.getRules=function(t){return this.__cache__===null&&this.__compile__(),this.__cache__[t]||[]};var Ib=Cl;function iI(t,e,r){this.type=t,this.tag=e,this.attrs=null,this.map=null,this.nesting=r,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}iI.prototype.attrIndex=function(e){if(!this.attrs)return-1;let r=this.attrs;for(let n=0,o=r.length;n<o;n++)if(r[n][0]===e)return n;return-1};iI.prototype.attrPush=function(e){this.attrs?this.attrs.push(e):this.attrs=[e]};iI.prototype.attrSet=function(e,r){let n=this.attrIndex(e),o=[e,r];n<0?this.attrPush(o):this.attrs[n]=o};iI.prototype.attrGet=function(e){let r=this.attrIndex(e),n=null;return r>=0&&(n=this.attrs[r][1]),n};iI.prototype.attrJoin=function(e,r){let n=this.attrIndex(e);n<0?this.attrPush([e,r]):this.attrs[n][1]=this.attrs[n][1]+" "+r};var Xf=iI;function EIe(t,e,r){this.src=t,this.env=r,this.tokens=[],this.inlineMode=!1,this.md=e}EIe.prototype.Token=Xf;var wIe=EIe;var SYe=/\r\n?|\n/g,IYe=/\0/g;function NY(t){let e;e=t.src.replace(SYe,`
`),e=e.replace(IYe,"\uFFFD"),t.src=e}function LY(t){let e;t.inlineMode?(e=new t.Token("inline","",0),e.content=t.src,e.map=[0,1],e.children=[],t.tokens.push(e)):t.md.block.parse(t.src,t.md,t.env,t.tokens)}function OY(t){let e=t.tokens;for(let r=0,n=e.length;r<n;r++){let o=e[r];o.type==="inline"&&t.md.inline.parse(o.content,t.md,t.env,o.children)}}function CYe(t){return/^<a[>\s]/i.test(t)}function TYe(t){return/^<\/a\s*>/i.test(t)}function MY(t){let e=t.tokens;if(t.md.options.linkify)for(let r=0,n=e.length;r<n;r++){if(e[r].type!=="inline"||!t.md.linkify.pretest(e[r].content))continue;let o=e[r].children,s=0;for(let a=o.length-1;a>=0;a--){let c=o[a];if(c.type==="link_close"){for(a--;o[a].level!==c.level&&o[a].type!=="link_open";)a--;continue}if(c.type==="html_inline"&&(CYe(c.content)&&s>0&&s--,TYe(c.content)&&s++),!(s>0)&&c.type==="text"&&t.md.linkify.test(c.content)){let u=c.content,l=t.md.linkify.match(u),d=[],p=c.level,f=0;l.length>0&&l[0].index===0&&a>0&&o[a-1].type==="text_special"&&(l=l.slice(1));for(let m=0;m<l.length;m++){let h=l[m].url,g=t.md.normalizeLink(h);if(!t.md.validateLink(g))continue;let v=l[m].text;l[m].schema?l[m].schema==="mailto:"&&!/^mailto:/i.test(v)?v=t.md.normalizeLinkText("mailto:"+v).replace(/^mailto:/,""):v=t.md.normalizeLinkText(v):v=t.md.normalizeLinkText("http://"+v).replace(/^http:\/\//,"");let y=l[m].index;if(y>f){let I=new t.Token("text","",0);I.content=u.slice(f,y),I.level=p,d.push(I)}let _=new t.Token("link_open","a",1);_.attrs=[["href",g]],_.level=p++,_.markup="linkify",_.info="auto",d.push(_);let b=new t.Token("text","",0);b.content=v,b.level=p,d.push(b);let S=new t.Token("link_close","a",-1);S.level=--p,S.markup="linkify",S.info="auto",d.push(S),f=l[m].lastIndex}if(f<u.length){let m=new t.Token("text","",0);m.content=u.slice(f),m.level=p,d.push(m)}e[r].children=o=wY(o,a,d)}}}}var RIe=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,EYe=/\((c|tm|r)\)/i,wYe=/\((c|tm|r)\)/ig,RYe={c:"\xA9",r:"\xAE",tm:"\u2122"};function kYe(t,e){return RYe[e.toLowerCase()]}function AYe(t){let e=0;for(let r=t.length-1;r>=0;r--){let n=t[r];n.type==="text"&&!e&&(n.content=n.content.replace(wYe,kYe)),n.type==="link_open"&&n.info==="auto"&&e--,n.type==="link_close"&&n.info==="auto"&&e++}}function PYe(t){let e=0;for(let r=t.length-1;r>=0;r--){let n=t[r];n.type==="text"&&!e&&RIe.test(n.content)&&(n.content=n.content.replace(/\+-/g,"\xB1").replace(/\.{2,}/g,"\u2026").replace(/([?!])/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---(?=[^-]|$)/mg,"$1\u2014").replace(/(^|\s)--(?=\s|$)/mg,"$1\u2013").replace(/(^|[^-\s])--(?=[^-\s]|$)/mg,"$1\u2013")),n.type==="link_open"&&n.info==="auto"&&e--,n.type==="link_close"&&n.info==="auto"&&e++}}function FY(t){let e;if(t.md.options.typographer)for(e=t.tokens.length-1;e>=0;e--)t.tokens[e].type==="inline"&&(EYe.test(t.tokens[e].content)&&AYe(t.tokens[e].children),RIe.test(t.tokens[e].content)&&PYe(t.tokens[e].children))}var DYe=/['"]/,kIe=/['"]/g,AIe="\u2019";function D6(t,e,r){return t.slice(0,e)+r+t.slice(e+1)}function NYe(t,e){let r,n=[];for(let o=0;o<t.length;o++){let s=t[o],a=t[o].level;for(r=n.length-1;r>=0&&!(n[r].level<=a);r--);if(n.length=r+1,s.type!=="text")continue;let c=s.content,u=0,l=c.length;e:for(;u<l;){kIe.lastIndex=u;let d=kIe.exec(c);if(!d)break;let p=!0,f=!0;u=d.index+1;let m=d[0]==="'",h=32;if(d.index-1>=0)h=c.charCodeAt(d.index-1);else for(r=o-1;r>=0&&!(t[r].type==="softbreak"||t[r].type==="hardbreak");r--)if(t[r].content){h=t[r].content.charCodeAt(t[r].content.length-1);break}let g=32;if(u<l)g=c.charCodeAt(u);else for(r=o+1;r<t.length&&!(t[r].type==="softbreak"||t[r].type==="hardbreak");r++)if(t[r].content){g=t[r].content.charCodeAt(0);break}let v=xb(h)||_b(String.fromCharCode(h)),y=xb(g)||_b(String.fromCharCode(g)),_=bb(h),b=bb(g);if(b?p=!1:y&&(_||v||(p=!1)),_?f=!1:v&&(b||y||(f=!1)),g===34&&d[0]==='"'&&h>=48&&h<=57&&(f=p=!1),p&&f&&(p=v,f=y),!p&&!f){m&&(s.content=D6(s.content,d.index,AIe));continue}if(f)for(r=n.length-1;r>=0;r--){let S=n[r];if(n[r].level<a)break;if(S.single===m&&n[r].level===a){S=n[r];let I,w;m?(I=e.md.options.quotes[2],w=e.md.options.quotes[3]):(I=e.md.options.quotes[0],w=e.md.options.quotes[1]),s.content=D6(s.content,d.index,w),t[S.token].content=D6(t[S.token].content,S.pos,I),u+=w.length-1,S.token===o&&(u+=I.length-1),c=s.content,l=c.length,n.length=r;continue e}}p?n.push({token:o,pos:d.index,single:m,level:a}):f&&m&&(s.content=D6(s.content,d.index,AIe))}}}function UY(t){if(t.md.options.typographer)for(let e=t.tokens.length-1;e>=0;e--)t.tokens[e].type!=="inline"||!DYe.test(t.tokens[e].content)||NYe(t.tokens[e].children,t)}function BY(t){let e,r,n=t.tokens,o=n.length;for(let s=0;s<o;s++){if(n[s].type!=="inline")continue;let a=n[s].children,c=a.length;for(e=0;e<c;e++)a[e].type==="text_special"&&(a[e].type="text");for(e=r=0;e<c;e++)a[e].type==="text"&&e+1<c&&a[e+1].type==="text"?a[e+1].content=a[e].content+a[e+1].content:(e!==r&&(a[r]=a[e]),r++);e!==r&&(a.length=r)}}var qY=[["normalize",NY],["block",LY],["inline",OY],["linkify",MY],["replacements",FY],["smartquotes",UY],["text_join",BY]];function HY(){this.ruler=new Ib;for(let t=0;t<qY.length;t++)this.ruler.push(qY[t][0],qY[t][1])}HY.prototype.process=function(t){let e=this.ruler.getRules("");for(let r=0,n=e.length;r<n;r++)e[r](t)};HY.prototype.State=wIe;var PIe=HY;function tp(t,e,r,n){this.src=t,this.md=e,this.env=r,this.tokens=n,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.listIndent=-1,this.parentType="root",this.level=0;let o=this.src;for(let s=0,a=0,c=0,u=0,l=o.length,d=!1;a<l;a++){let p=o.charCodeAt(a);if(!d)if(ur(p)){c++,p===9?u+=4-u%4:u++;continue}else d=!0;(p===10||a===l-1)&&(p!==10&&a++,this.bMarks.push(s),this.eMarks.push(a),this.tShift.push(c),this.sCount.push(u),this.bsCount.push(0),d=!1,c=0,u=0,s=a+1)}this.bMarks.push(o.length),this.eMarks.push(o.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}tp.prototype.push=function(t,e,r){let n=new Xf(t,e,r);return n.block=!0,r<0&&this.level--,n.level=this.level,r>0&&this.level++,this.tokens.push(n),n};tp.prototype.isEmpty=function(e){return this.bMarks[e]+this.tShift[e]>=this.eMarks[e]};tp.prototype.skipEmptyLines=function(e){for(let r=this.lineMax;e<r&&!(this.bMarks[e]+this.tShift[e]<this.eMarks[e]);e++);return e};tp.prototype.skipSpaces=function(e){for(let r=this.src.length;e<r;e++){let n=this.src.charCodeAt(e);if(!ur(n))break}return e};tp.prototype.skipSpacesBack=function(e,r){if(e<=r)return e;for(;e>r;)if(!ur(this.src.charCodeAt(--e)))return e+1;return e};tp.prototype.skipChars=function(e,r){for(let n=this.src.length;e<n&&this.src.charCodeAt(e)===r;e++);return e};tp.prototype.skipCharsBack=function(e,r,n){if(e<=n)return e;for(;e>n;)if(r!==this.src.charCodeAt(--e))return e+1;return e};tp.prototype.getLines=function(e,r,n,o){if(e>=r)return"";let s=new Array(r-e);for(let a=0,c=e;c<r;c++,a++){let u=0,l=this.bMarks[c],d=l,p;for(c+1<r||o?p=this.eMarks[c]+1:p=this.eMarks[c];d<p&&u<n;){let f=this.src.charCodeAt(d);if(ur(f))f===9?u+=4-(u+this.bsCount[c])%4:u++;else if(d-l<this.tShift[c])u++;else break;d++}u>n?s[a]=new Array(u-n+1).join(" ")+this.src.slice(d,p):s[a]=this.src.slice(d,p)}return s.join("")};tp.prototype.Token=Xf;var DIe=tp;function jY(t,e){let r=t.bMarks[e]+t.tShift[e],n=t.eMarks[e];return t.src.slice(r,n)}function NIe(t){let e=[],r=t.length,n=0,o=t.charCodeAt(n),s=!1,a=0,c="";for(;n<r;)o===124&&(s?(c+=t.substring(a,n-1),a=n):(e.push(c+t.substring(a,n)),c="",a=n+1)),s=o===92,n++,o=t.charCodeAt(n);return e.push(c+t.substring(a)),e}function zY(t,e,r,n){if(e+2>r)return!1;let o=e+1;if(t.sCount[o]<t.blkIndent||t.sCount[o]-t.blkIndent>=4)return!1;let s=t.bMarks[o]+t.tShift[o];if(s>=t.eMarks[o])return!1;let a=t.src.charCodeAt(s++);if(a!==124&&a!==45&&a!==58||s>=t.eMarks[o])return!1;let c=t.src.charCodeAt(s++);if(c!==124&&c!==45&&c!==58&&!ur(c)||a===45&&ur(c))return!1;for(;s<t.eMarks[o];){let b=t.src.charCodeAt(s);if(b!==124&&b!==45&&b!==58&&!ur(b))return!1;s++}let u=jY(t,e+1),l=u.split("|"),d=[];for(let b=0;b<l.length;b++){let S=l[b].trim();if(!S){if(b===0||b===l.length-1)continue;return!1}if(!/^:?-+:?$/.test(S))return!1;S.charCodeAt(S.length-1)===58?d.push(S.charCodeAt(0)===58?"center":"right"):S.charCodeAt(0)===58?d.push("left"):d.push("")}if(u=jY(t,e).trim(),u.indexOf("|")===-1||t.sCount[e]-t.blkIndent>=4)return!1;l=NIe(u),l.length&&l[0]===""&&l.shift(),l.length&&l[l.length-1]===""&&l.pop();let p=l.length;if(p===0||p!==d.length)return!1;if(n)return!0;let f=t.parentType;t.parentType="table";let m=t.md.block.ruler.getRules("blockquote"),h=t.push("table_open","table",1),g=[e,0];h.map=g;let v=t.push("thead_open","thead",1);v.map=[e,e+1];let y=t.push("tr_open","tr",1);y.map=[e,e+1];for(let b=0;b<l.length;b++){let S=t.push("th_open","th",1);d[b]&&(S.attrs=[["style","text-align:"+d[b]]]);let I=t.push("inline","",0);I.content=l[b].trim(),I.children=[],t.push("th_close","th",-1)}t.push("tr_close","tr",-1),t.push("thead_close","thead",-1);let _;for(o=e+2;o<r&&!(t.sCount[o]<t.blkIndent);o++){let b=!1;for(let I=0,w=m.length;I<w;I++)if(m[I](t,o,r,!0)){b=!0;break}if(b||(u=jY(t,o).trim(),!u)||t.sCount[o]-t.blkIndent>=4)break;if(l=NIe(u),l.length&&l[0]===""&&l.shift(),l.length&&l[l.length-1]===""&&l.pop(),o===e+2){let I=t.push("tbody_open","tbody",1);I.map=_=[e+2,0]}let S=t.push("tr_open","tr",1);S.map=[o,o+1];for(let I=0;I<p;I++){let w=t.push("td_open","td",1);d[I]&&(w.attrs=[["style","text-align:"+d[I]]]);let O=t.push("inline","",0);O.content=l[I]?l[I].trim():"",O.children=[],t.push("td_close","td",-1)}t.push("tr_close","tr",-1)}return _&&(t.push("tbody_close","tbody",-1),_[1]=o),t.push("table_close","table",-1),g[1]=o,t.parentType=f,t.line=o,!0}function GY(t,e,r){if(t.sCount[e]-t.blkIndent<4)return!1;let n=e+1,o=n;for(;n<r;){if(t.isEmpty(n)){n++;continue}if(t.sCount[n]-t.blkIndent>=4){n++,o=n;continue}break}t.line=o;let s=t.push("code_block","code",0);return s.content=t.getLines(e,o,4+t.blkIndent,!1)+`
`,s.map=[e,t.line],!0}function VY(t,e,r,n){let o=t.bMarks[e]+t.tShift[e],s=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4||o+3>s)return!1;let a=t.src.charCodeAt(o);if(a!==126&&a!==96)return!1;let c=o;o=t.skipChars(o,a);let u=o-c;if(u<3)return!1;let l=t.src.slice(c,o),d=t.src.slice(o,s);if(a===96&&d.indexOf(String.fromCharCode(a))>=0)return!1;if(n)return!0;let p=e,f=!1;for(;p++,!(p>=r||(o=c=t.bMarks[p]+t.tShift[p],s=t.eMarks[p],o<s&&t.sCount[p]<t.blkIndent));)if(t.src.charCodeAt(o)===a&&!(t.sCount[p]-t.blkIndent>=4)&&(o=t.skipChars(o,a),!(o-c<u)&&(o=t.skipSpaces(o),!(o<s)))){f=!0;break}u=t.sCount[e],t.line=p+(f?1:0);let m=t.push("fence","code",0);return m.info=d,m.content=t.getLines(e+1,p,u,!0),m.markup=l,m.map=[e,t.line],!0}function $Y(t,e,r,n){let o=t.bMarks[e]+t.tShift[e],s=t.eMarks[e],a=t.lineMax;if(t.sCount[e]-t.blkIndent>=4||t.src.charCodeAt(o)!==62)return!1;if(n)return!0;let c=[],u=[],l=[],d=[],p=t.md.block.ruler.getRules("blockquote"),f=t.parentType;t.parentType="blockquote";let m=!1,h;for(h=e;h<r;h++){let b=t.sCount[h]<t.blkIndent;if(o=t.bMarks[h]+t.tShift[h],s=t.eMarks[h],o>=s)break;if(t.src.charCodeAt(o++)===62&&!b){let I=t.sCount[h]+1,w,O;t.src.charCodeAt(o)===32?(o++,I++,O=!1,w=!0):t.src.charCodeAt(o)===9?(w=!0,(t.bsCount[h]+I)%4===3?(o++,I++,O=!1):O=!0):w=!1;let U=I;for(c.push(t.bMarks[h]),t.bMarks[h]=o;o<s;){let z=t.src.charCodeAt(o);if(ur(z))z===9?U+=4-(U+t.bsCount[h]+(O?1:0))%4:U++;else break;o++}m=o>=s,u.push(t.bsCount[h]),t.bsCount[h]=t.sCount[h]+1+(w?1:0),l.push(t.sCount[h]),t.sCount[h]=U-I,d.push(t.tShift[h]),t.tShift[h]=o-t.bMarks[h];continue}if(m)break;let S=!1;for(let I=0,w=p.length;I<w;I++)if(p[I](t,h,r,!0)){S=!0;break}if(S){t.lineMax=h,t.blkIndent!==0&&(c.push(t.bMarks[h]),u.push(t.bsCount[h]),d.push(t.tShift[h]),l.push(t.sCount[h]),t.sCount[h]-=t.blkIndent);break}c.push(t.bMarks[h]),u.push(t.bsCount[h]),d.push(t.tShift[h]),l.push(t.sCount[h]),t.sCount[h]=-1}let g=t.blkIndent;t.blkIndent=0;let v=t.push("blockquote_open","blockquote",1);v.markup=">";let y=[e,0];v.map=y,t.md.block.tokenize(t,e,h);let _=t.push("blockquote_close","blockquote",-1);_.markup=">",t.lineMax=a,t.parentType=f,y[1]=t.line;for(let b=0;b<d.length;b++)t.bMarks[b+e]=c[b],t.tShift[b+e]=d[b],t.sCount[b+e]=l[b],t.bsCount[b+e]=u[b];return t.blkIndent=g,!0}function WY(t,e,r,n){let o=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4)return!1;let s=t.bMarks[e]+t.tShift[e],a=t.src.charCodeAt(s++);if(a!==42&&a!==45&&a!==95)return!1;let c=1;for(;s<o;){let l=t.src.charCodeAt(s++);if(l!==a&&!ur(l))return!1;l===a&&c++}if(c<3)return!1;if(n)return!0;t.line=e+1;let u=t.push("hr","hr",0);return u.map=[e,t.line],u.markup=Array(c+1).join(String.fromCharCode(a)),!0}function LIe(t,e){let r=t.eMarks[e],n=t.bMarks[e]+t.tShift[e],o=t.src.charCodeAt(n++);if(o!==42&&o!==45&&o!==43)return-1;if(n<r){let s=t.src.charCodeAt(n);if(!ur(s))return-1}return n}function OIe(t,e){let r=t.bMarks[e]+t.tShift[e],n=t.eMarks[e],o=r;if(o+1>=n)return-1;let s=t.src.charCodeAt(o++);if(s<48||s>57)return-1;for(;;){if(o>=n)return-1;if(s=t.src.charCodeAt(o++),s>=48&&s<=57){if(o-r>=10)return-1;continue}if(s===41||s===46)break;return-1}return o<n&&(s=t.src.charCodeAt(o),!ur(s))?-1:o}function LYe(t,e){let r=t.level+2;for(let n=e+2,o=t.tokens.length-2;n<o;n++)t.tokens[n].level===r&&t.tokens[n].type==="paragraph_open"&&(t.tokens[n+2].hidden=!0,t.tokens[n].hidden=!0,n+=2)}function KY(t,e,r,n){let o,s,a,c,u=e,l=!0;if(t.sCount[u]-t.blkIndent>=4||t.listIndent>=0&&t.sCount[u]-t.listIndent>=4&&t.sCount[u]<t.blkIndent)return!1;let d=!1;n&&t.parentType==="paragraph"&&t.sCount[u]>=t.blkIndent&&(d=!0);let p,f,m;if((m=OIe(t,u))>=0){if(p=!0,a=t.bMarks[u]+t.tShift[u],f=Number(t.src.slice(a,m-1)),d&&f!==1)return!1}else if((m=LIe(t,u))>=0)p=!1;else return!1;if(d&&t.skipSpaces(m)>=t.eMarks[u])return!1;if(n)return!0;let h=t.src.charCodeAt(m-1),g=t.tokens.length;p?(c=t.push("ordered_list_open","ol",1),f!==1&&(c.attrs=[["start",f]])):c=t.push("bullet_list_open","ul",1);let v=[u,0];c.map=v,c.markup=String.fromCharCode(h);let y=!1,_=t.md.block.ruler.getRules("list"),b=t.parentType;for(t.parentType="list";u<r;){s=m,o=t.eMarks[u];let S=t.sCount[u]+m-(t.bMarks[u]+t.tShift[u]),I=S;for(;s<o;){let P=t.src.charCodeAt(s);if(P===9)I+=4-(I+t.bsCount[u])%4;else if(P===32)I++;else break;s++}let w=s,O;w>=o?O=1:O=I-S,O>4&&(O=1);let U=S+O;c=t.push("list_item_open","li",1),c.markup=String.fromCharCode(h);let z=[u,0];c.map=z,p&&(c.info=t.src.slice(a,m-1));let M=t.tight,re=t.tShift[u],ee=t.sCount[u],N=t.listIndent;if(t.listIndent=t.blkIndent,t.blkIndent=U,t.tight=!0,t.tShift[u]=w-t.bMarks[u],t.sCount[u]=I,w>=o&&t.isEmpty(u+1)?t.line=Math.min(t.line+2,r):t.md.block.tokenize(t,u,r,!0),(!t.tight||y)&&(l=!1),y=t.line-u>1&&t.isEmpty(t.line-1),t.blkIndent=t.listIndent,t.listIndent=N,t.tShift[u]=re,t.sCount[u]=ee,t.tight=M,c=t.push("list_item_close","li",-1),c.markup=String.fromCharCode(h),u=t.line,z[1]=u,u>=r||t.sCount[u]<t.blkIndent||t.sCount[u]-t.blkIndent>=4)break;let E=!1;for(let P=0,q=_.length;P<q;P++)if(_[P](t,u,r,!0)){E=!0;break}if(E)break;if(p){if(m=OIe(t,u),m<0)break;a=t.bMarks[u]+t.tShift[u]}else if(m=LIe(t,u),m<0)break;if(h!==t.src.charCodeAt(m-1))break}return p?c=t.push("ordered_list_close","ol",-1):c=t.push("bullet_list_close","ul",-1),c.markup=String.fromCharCode(h),v[1]=u,t.line=u,t.parentType=b,l&&LYe(t,g),!0}function YY(t,e,r,n){let o=0,s=t.bMarks[e]+t.tShift[e],a=t.eMarks[e],c=e+1;if(t.sCount[e]-t.blkIndent>=4||t.src.charCodeAt(s)!==91)return!1;for(;++s<a;)if(t.src.charCodeAt(s)===93&&t.src.charCodeAt(s-1)!==92){if(s+1===a||t.src.charCodeAt(s+1)!==58)return!1;break}let u=t.lineMax,l=t.md.block.ruler.getRules("reference"),d=t.parentType;for(t.parentType="reference";c<u&&!t.isEmpty(c);c++){if(t.sCount[c]-t.blkIndent>3||t.sCount[c]<0)continue;let I=!1;for(let w=0,O=l.length;w<O;w++)if(l[w](t,c,u,!0)){I=!0;break}if(I)break}let p=t.getLines(e,c,t.blkIndent,!1).trim();a=p.length;let f=-1;for(s=1;s<a;s++){let I=p.charCodeAt(s);if(I===91)return!1;if(I===93){f=s;break}else I===10?o++:I===92&&(s++,s<a&&p.charCodeAt(s)===10&&o++)}if(f<0||p.charCodeAt(f+1)!==58)return!1;for(s=f+2;s<a;s++){let I=p.charCodeAt(s);if(I===10)o++;else if(!ur(I))break}let m=t.md.helpers.parseLinkDestination(p,s,a);if(!m.ok)return!1;let h=t.md.normalizeLink(m.str);if(!t.md.validateLink(h))return!1;s=m.pos,o+=m.lines;let g=s,v=o,y=s;for(;s<a;s++){let I=p.charCodeAt(s);if(I===10)o++;else if(!ur(I))break}let _=t.md.helpers.parseLinkTitle(p,s,a),b;for(s<a&&y!==s&&_.ok?(b=_.str,s=_.pos,o+=_.lines):(b="",s=g,o=v);s<a;){let I=p.charCodeAt(s);if(!ur(I))break;s++}if(s<a&&p.charCodeAt(s)!==10&&b)for(b="",s=g,o=v;s<a;){let I=p.charCodeAt(s);if(!ur(I))break;s++}if(s<a&&p.charCodeAt(s)!==10)return!1;let S=Sb(p.slice(1,f));return S?(n||(typeof t.env.references>"u"&&(t.env.references={}),typeof t.env.references[S]>"u"&&(t.env.references[S]={title:b,href:h}),t.parentType=d,t.line=e+o+1),!0):!1}var MIe=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","section","source","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"];var OYe="[a-zA-Z_:][a-zA-Z0-9:._-]*",MYe="[^\"'=<>`\\x00-\\x20]+",FYe="'[^']*'",UYe='"[^"]*"',BYe="(?:"+MYe+"|"+FYe+"|"+UYe+")",qYe="(?:\\s+"+OYe+"(?:\\s*=\\s*"+BYe+")?)",FIe="<[A-Za-z][A-Za-z0-9\\-]*"+qYe+"*\\s*\\/?>",UIe="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",HYe="<!---->|<!--(?:-?[^>-])(?:-?[^-])*-->",jYe="<[?][\\s\\S]*?[?]>",zYe="<![A-Z]+\\s+[^>]*>",GYe="<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",BIe=new RegExp("^(?:"+FIe+"|"+UIe+"|"+HYe+"|"+jYe+"|"+zYe+"|"+GYe+")"),qIe=new RegExp("^(?:"+FIe+"|"+UIe+")");var oI=[[/^<(script|pre|style|textarea)(?=(\s|>|$))/i,/<\/(script|pre|style|textarea)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+MIe.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(qIe.source+"\\s*$"),/^$/,!1]];function QY(t,e,r,n){let o=t.bMarks[e]+t.tShift[e],s=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4||!t.md.options.html||t.src.charCodeAt(o)!==60)return!1;let a=t.src.slice(o,s),c=0;for(;c<oI.length&&!oI[c][0].test(a);c++);if(c===oI.length)return!1;if(n)return oI[c][2];let u=e+1;if(!oI[c][1].test(a)){for(;u<r&&!(t.sCount[u]<t.blkIndent);u++)if(o=t.bMarks[u]+t.tShift[u],s=t.eMarks[u],a=t.src.slice(o,s),oI[c][1].test(a)){a.length!==0&&u++;break}}t.line=u;let l=t.push("html_block","",0);return l.map=[e,u],l.content=t.getLines(e,u,t.blkIndent,!0),!0}function XY(t,e,r,n){let o=t.bMarks[e]+t.tShift[e],s=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4)return!1;let a=t.src.charCodeAt(o);if(a!==35||o>=s)return!1;let c=1;for(a=t.src.charCodeAt(++o);a===35&&o<s&&c<=6;)c++,a=t.src.charCodeAt(++o);if(c>6||o<s&&!ur(a))return!1;if(n)return!0;s=t.skipSpacesBack(s,o);let u=t.skipCharsBack(s,35,o);u>o&&ur(t.src.charCodeAt(u-1))&&(s=u),t.line=e+1;let l=t.push("heading_open","h"+String(c),1);l.markup="########".slice(0,c),l.map=[e,t.line];let d=t.push("inline","",0);d.content=t.src.slice(o,s).trim(),d.map=[e,t.line],d.children=[];let p=t.push("heading_close","h"+String(c),-1);return p.markup="########".slice(0,c),!0}function JY(t,e,r){let n=t.md.block.ruler.getRules("paragraph");if(t.sCount[e]-t.blkIndent>=4)return!1;let o=t.parentType;t.parentType="paragraph";let s=0,a,c=e+1;for(;c<r&&!t.isEmpty(c);c++){if(t.sCount[c]-t.blkIndent>3)continue;if(t.sCount[c]>=t.blkIndent){let m=t.bMarks[c]+t.tShift[c],h=t.eMarks[c];if(m<h&&(a=t.src.charCodeAt(m),(a===45||a===61)&&(m=t.skipChars(m,a),m=t.skipSpaces(m),m>=h))){s=a===61?1:2;break}}if(t.sCount[c]<0)continue;let f=!1;for(let m=0,h=n.length;m<h;m++)if(n[m](t,c,r,!0)){f=!0;break}if(f)break}if(!s)return!1;let u=t.getLines(e,c,t.blkIndent,!1).trim();t.line=c+1;let l=t.push("heading_open","h"+String(s),1);l.markup=String.fromCharCode(a),l.map=[e,t.line];let d=t.push("inline","",0);d.content=u,d.map=[e,t.line-1],d.children=[];let p=t.push("heading_close","h"+String(s),-1);return p.markup=String.fromCharCode(a),t.parentType=o,!0}function ZY(t,e,r){let n=t.md.block.ruler.getRules("paragraph"),o=t.parentType,s=e+1;for(t.parentType="paragraph";s<r&&!t.isEmpty(s);s++){if(t.sCount[s]-t.blkIndent>3||t.sCount[s]<0)continue;let l=!1;for(let d=0,p=n.length;d<p;d++)if(n[d](t,s,r,!0)){l=!0;break}if(l)break}let a=t.getLines(e,s,t.blkIndent,!1).trim();t.line=s;let c=t.push("paragraph_open","p",1);c.map=[e,t.line];let u=t.push("inline","",0);return u.content=a,u.map=[e,t.line],u.children=[],t.push("paragraph_close","p",-1),t.parentType=o,!0}var N6=[["table",zY,["paragraph","reference"]],["code",GY],["fence",VY,["paragraph","reference","blockquote","list"]],["blockquote",$Y,["paragraph","reference","blockquote","list"]],["hr",WY,["paragraph","reference","blockquote","list"]],["list",KY,["paragraph","reference","blockquote"]],["reference",YY],["html_block",QY,["paragraph","reference","blockquote"]],["heading",XY,["paragraph","reference","blockquote"]],["lheading",JY],["paragraph",ZY]];function L6(){this.ruler=new Ib;for(let t=0;t<N6.length;t++)this.ruler.push(N6[t][0],N6[t][1],{alt:(N6[t][2]||[]).slice()})}L6.prototype.tokenize=function(t,e,r){let n=this.ruler.getRules(""),o=n.length,s=t.md.options.maxNesting,a=e,c=!1;for(;a<r&&(t.line=a=t.skipEmptyLines(a),!(a>=r||t.sCount[a]<t.blkIndent));){if(t.level>=s){t.line=r;break}let u=t.line,l=!1;for(let d=0;d<o;d++)if(l=n[d](t,a,r,!1),l){if(u>=t.line)throw new Error("block rule didn't increment state.line");break}if(!l)throw new Error("none of the block rules matched");t.tight=!c,t.isEmpty(t.line-1)&&(c=!0),a=t.line,a<r&&t.isEmpty(a)&&(c=!0,a++,t.line=a)}};L6.prototype.parse=function(t,e,r,n){if(!t)return;let o=new this.State(t,e,r,n);this.tokenize(o,o.line,o.lineMax)};L6.prototype.State=DIe;var HIe=L6;function Kk(t,e,r,n){this.src=t,this.env=r,this.md=e,this.tokens=n,this.tokens_meta=Array(n.length),this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[],this._prev_delimiters=[],this.backticks={},this.backticksScanned=!1,this.linkLevel=0}Kk.prototype.pushPending=function(){let t=new Xf("text","",0);return t.content=this.pending,t.level=this.pendingLevel,this.tokens.push(t),this.pending="",t};Kk.prototype.push=function(t,e,r){this.pending&&this.pushPending();let n=new Xf(t,e,r),o=null;return r<0&&(this.level--,this.delimiters=this._prev_delimiters.pop()),n.level=this.level,r>0&&(this.level++,this._prev_delimiters.push(this.delimiters),this.delimiters=[],o={delimiters:this.delimiters}),this.pendingLevel=this.level,this.tokens.push(n),this.tokens_meta.push(o),n};Kk.prototype.scanDelims=function(t,e){let r,n,o=!0,s=!0,a=this.posMax,c=this.src.charCodeAt(t),u=t>0?this.src.charCodeAt(t-1):32,l=t;for(;l<a&&this.src.charCodeAt(l)===c;)l++;let d=l-t,p=l<a?this.src.charCodeAt(l):32,f=xb(u)||_b(String.fromCharCode(u)),m=xb(p)||_b(String.fromCharCode(p)),h=bb(u),g=bb(p);return g?o=!1:m&&(h||f||(o=!1)),h?s=!1:f&&(g||m||(s=!1)),e?(r=o,n=s):(r=o&&(!s||f),n=s&&(!o||m)),{can_open:r,can_close:n,length:d}};Kk.prototype.Token=Xf;var jIe=Kk;function VYe(t){switch(t){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}function eQ(t,e){let r=t.pos;for(;r<t.posMax&&!VYe(t.src.charCodeAt(r));)r++;return r===t.pos?!1:(e||(t.pending+=t.src.slice(t.pos,r)),t.pos=r,!0)}var $Ye=/(?:^|[^a-z0-9.+-])([a-z][a-z0-9.+-]*)$/i;function tQ(t,e){if(!t.md.options.linkify||t.linkLevel>0)return!1;let r=t.pos,n=t.posMax;if(r+3>n||t.src.charCodeAt(r)!==58||t.src.charCodeAt(r+1)!==47||t.src.charCodeAt(r+2)!==47)return!1;let o=t.pending.match($Ye);if(!o)return!1;let s=o[1],a=t.md.linkify.matchAtStart(t.src.slice(r-s.length));if(!a)return!1;let c=a.url;if(c.length<=s.length)return!1;c=c.replace(/\*+$/,"");let u=t.md.normalizeLink(c);if(!t.md.validateLink(u))return!1;if(!e){t.pending=t.pending.slice(0,-s.length);let l=t.push("link_open","a",1);l.attrs=[["href",u]],l.markup="linkify",l.info="auto";let d=t.push("text","",0);d.content=t.md.normalizeLinkText(c);let p=t.push("link_close","a",-1);p.markup="linkify",p.info="auto"}return t.pos+=c.length-s.length,!0}function rQ(t,e){let r=t.pos;if(t.src.charCodeAt(r)!==10)return!1;let n=t.pending.length-1,o=t.posMax;if(!e)if(n>=0&&t.pending.charCodeAt(n)===32)if(n>=1&&t.pending.charCodeAt(n-1)===32){let s=n-1;for(;s>=1&&t.pending.charCodeAt(s-1)===32;)s--;t.pending=t.pending.slice(0,s),t.push("hardbreak","br",0)}else t.pending=t.pending.slice(0,-1),t.push("softbreak","br",0);else t.push("softbreak","br",0);for(r++;r<o&&ur(t.src.charCodeAt(r));)r++;return t.pos=r,!0}var nQ=[];for(let t=0;t<256;t++)nQ.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(t){nQ[t.charCodeAt(0)]=1});function iQ(t,e){let r=t.pos,n=t.posMax;if(t.src.charCodeAt(r)!==92||(r++,r>=n))return!1;let o=t.src.charCodeAt(r);if(o===10){for(e||t.push("hardbreak","br",0),r++;r<n&&(o=t.src.charCodeAt(r),!!ur(o));)r++;return t.pos=r,!0}let s=t.src[r];if(o>=55296&&o<=56319&&r+1<n){let c=t.src.charCodeAt(r+1);c>=56320&&c<=57343&&(s+=t.src[r+1],r++)}let a="\\"+s;if(!e){let c=t.push("text_special","",0);o<256&&nQ[o]!==0?c.content=s:c.content=a,c.markup=a,c.info="escape"}return t.pos=r+1,!0}function oQ(t,e){let r=t.pos;if(t.src.charCodeAt(r)!==96)return!1;let o=r;r++;let s=t.posMax;for(;r<s&&t.src.charCodeAt(r)===96;)r++;let a=t.src.slice(o,r),c=a.length;if(t.backticksScanned&&(t.backticks[c]||0)<=o)return e||(t.pending+=a),t.pos+=c,!0;let u=r,l;for(;(l=t.src.indexOf("`",u))!==-1;){for(u=l+1;u<s&&t.src.charCodeAt(u)===96;)u++;let d=u-l;if(d===c){if(!e){let p=t.push("code_inline","code",0);p.markup=a,p.content=t.src.slice(r,l).replace(/\n/g," ").replace(/^ (.+) $/,"$1")}return t.pos=u,!0}t.backticks[d]=l}return t.backticksScanned=!0,e||(t.pending+=a),t.pos+=c,!0}function WYe(t,e){let r=t.pos,n=t.src.charCodeAt(r);if(e||n!==126)return!1;let o=t.scanDelims(t.pos,!0),s=o.length,a=String.fromCharCode(n);if(s<2)return!1;let c;s%2&&(c=t.push("text","",0),c.content=a,s--);for(let u=0;u<s;u+=2)c=t.push("text","",0),c.content=a+a,t.delimiters.push({marker:n,length:0,token:t.tokens.length-1,end:-1,open:o.can_open,close:o.can_close});return t.pos+=o.length,!0}function zIe(t,e){let r,n=[],o=e.length;for(let s=0;s<o;s++){let a=e[s];if(a.marker!==126||a.end===-1)continue;let c=e[a.end];r=t.tokens[a.token],r.type="s_open",r.tag="s",r.nesting=1,r.markup="~~",r.content="",r=t.tokens[c.token],r.type="s_close",r.tag="s",r.nesting=-1,r.markup="~~",r.content="",t.tokens[c.token-1].type==="text"&&t.tokens[c.token-1].content==="~"&&n.push(c.token-1)}for(;n.length;){let s=n.pop(),a=s+1;for(;a<t.tokens.length&&t.tokens[a].type==="s_close";)a++;a--,s!==a&&(r=t.tokens[a],t.tokens[a]=t.tokens[s],t.tokens[s]=r)}}function KYe(t){let e=t.tokens_meta,r=t.tokens_meta.length;zIe(t,t.delimiters);for(let n=0;n<r;n++)e[n]&&e[n].delimiters&&zIe(t,e[n].delimiters)}var sQ={tokenize:WYe,postProcess:KYe};function YYe(t,e){let r=t.pos,n=t.src.charCodeAt(r);if(e||n!==95&&n!==42)return!1;let o=t.scanDelims(t.pos,n===42);for(let s=0;s<o.length;s++){let a=t.push("text","",0);a.content=String.fromCharCode(n),t.delimiters.push({marker:n,length:o.length,token:t.tokens.length-1,end:-1,open:o.can_open,close:o.can_close})}return t.pos+=o.length,!0}function GIe(t,e){let r=e.length;for(let n=r-1;n>=0;n--){let o=e[n];if(o.marker!==95&&o.marker!==42||o.end===-1)continue;let s=e[o.end],a=n>0&&e[n-1].end===o.end+1&&e[n-1].marker===o.marker&&e[n-1].token===o.token-1&&e[o.end+1].token===s.token+1,c=String.fromCharCode(o.marker),u=t.tokens[o.token];u.type=a?"strong_open":"em_open",u.tag=a?"strong":"em",u.nesting=1,u.markup=a?c+c:c,u.content="";let l=t.tokens[s.token];l.type=a?"strong_close":"em_close",l.tag=a?"strong":"em",l.nesting=-1,l.markup=a?c+c:c,l.content="",a&&(t.tokens[e[n-1].token].content="",t.tokens[e[o.end+1].token].content="",n--)}}function QYe(t){let e=t.tokens_meta,r=t.tokens_meta.length;GIe(t,t.delimiters);for(let n=0;n<r;n++)e[n]&&e[n].delimiters&&GIe(t,e[n].delimiters)}var aQ={tokenize:YYe,postProcess:QYe};function cQ(t,e){let r,n,o,s,a="",c="",u=t.pos,l=!0;if(t.src.charCodeAt(t.pos)!==91)return!1;let d=t.pos,p=t.posMax,f=t.pos+1,m=t.md.helpers.parseLinkLabel(t,t.pos,!0);if(m<0)return!1;let h=m+1;if(h<p&&t.src.charCodeAt(h)===40){for(l=!1,h++;h<p&&(r=t.src.charCodeAt(h),!(!ur(r)&&r!==10));h++);if(h>=p)return!1;if(u=h,o=t.md.helpers.parseLinkDestination(t.src,h,t.posMax),o.ok){for(a=t.md.normalizeLink(o.str),t.md.validateLink(a)?h=o.pos:a="",u=h;h<p&&(r=t.src.charCodeAt(h),!(!ur(r)&&r!==10));h++);if(o=t.md.helpers.parseLinkTitle(t.src,h,t.posMax),h<p&&u!==h&&o.ok)for(c=o.str,h=o.pos;h<p&&(r=t.src.charCodeAt(h),!(!ur(r)&&r!==10));h++);}(h>=p||t.src.charCodeAt(h)!==41)&&(l=!0),h++}if(l){if(typeof t.env.references>"u")return!1;if(h<p&&t.src.charCodeAt(h)===91?(u=h+1,h=t.md.helpers.parseLinkLabel(t,h),h>=0?n=t.src.slice(u,h++):h=m+1):h=m+1,n||(n=t.src.slice(f,m)),s=t.env.references[Sb(n)],!s)return t.pos=d,!1;a=s.href,c=s.title}if(!e){t.pos=f,t.posMax=m;let g=t.push("link_open","a",1),v=[["href",a]];g.attrs=v,c&&v.push(["title",c]),t.linkLevel++,t.md.inline.tokenize(t),t.linkLevel--,t.push("link_close","a",-1)}return t.pos=h,t.posMax=p,!0}function uQ(t,e){let r,n,o,s,a,c,u,l,d="",p=t.pos,f=t.posMax;if(t.src.charCodeAt(t.pos)!==33||t.src.charCodeAt(t.pos+1)!==91)return!1;let m=t.pos+2,h=t.md.helpers.parseLinkLabel(t,t.pos+1,!1);if(h<0)return!1;if(s=h+1,s<f&&t.src.charCodeAt(s)===40){for(s++;s<f&&(r=t.src.charCodeAt(s),!(!ur(r)&&r!==10));s++);if(s>=f)return!1;for(l=s,c=t.md.helpers.parseLinkDestination(t.src,s,t.posMax),c.ok&&(d=t.md.normalizeLink(c.str),t.md.validateLink(d)?s=c.pos:d=""),l=s;s<f&&(r=t.src.charCodeAt(s),!(!ur(r)&&r!==10));s++);if(c=t.md.helpers.parseLinkTitle(t.src,s,t.posMax),s<f&&l!==s&&c.ok)for(u=c.str,s=c.pos;s<f&&(r=t.src.charCodeAt(s),!(!ur(r)&&r!==10));s++);else u="";if(s>=f||t.src.charCodeAt(s)!==41)return t.pos=p,!1;s++}else{if(typeof t.env.references>"u")return!1;if(s<f&&t.src.charCodeAt(s)===91?(l=s+1,s=t.md.helpers.parseLinkLabel(t,s),s>=0?o=t.src.slice(l,s++):s=h+1):s=h+1,o||(o=t.src.slice(m,h)),a=t.env.references[Sb(o)],!a)return t.pos=p,!1;d=a.href,u=a.title}if(!e){n=t.src.slice(m,h);let g=[];t.md.inline.parse(n,t.md,t.env,g);let v=t.push("image","img",0),y=[["src",d],["alt",""]];v.attrs=y,v.children=g,v.content=n,u&&y.push(["title",u])}return t.pos=s,t.posMax=f,!0}var XYe=/^([a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/,JYe=/^([a-zA-Z][a-zA-Z0-9+.-]{1,31}):([^<>\x00-\x20]*)$/;function lQ(t,e){let r=t.pos;if(t.src.charCodeAt(r)!==60)return!1;let n=t.pos,o=t.posMax;for(;;){if(++r>=o)return!1;let a=t.src.charCodeAt(r);if(a===60)return!1;if(a===62)break}let s=t.src.slice(n+1,r);if(JYe.test(s)){let a=t.md.normalizeLink(s);if(!t.md.validateLink(a))return!1;if(!e){let c=t.push("link_open","a",1);c.attrs=[["href",a]],c.markup="autolink",c.info="auto";let u=t.push("text","",0);u.content=t.md.normalizeLinkText(s);let l=t.push("link_close","a",-1);l.markup="autolink",l.info="auto"}return t.pos+=s.length+2,!0}if(XYe.test(s)){let a=t.md.normalizeLink("mailto:"+s);if(!t.md.validateLink(a))return!1;if(!e){let c=t.push("link_open","a",1);c.attrs=[["href",a]],c.markup="autolink",c.info="auto";let u=t.push("text","",0);u.content=t.md.normalizeLinkText(s);let l=t.push("link_close","a",-1);l.markup="autolink",l.info="auto"}return t.pos+=s.length+2,!0}return!1}function ZYe(t){return/^<a[>\s]/i.test(t)}function eQe(t){return/^<\/a\s*>/i.test(t)}function tQe(t){let e=t|32;return e>=97&&e<=122}function dQ(t,e){if(!t.md.options.html)return!1;let r=t.posMax,n=t.pos;if(t.src.charCodeAt(n)!==60||n+2>=r)return!1;let o=t.src.charCodeAt(n+1);if(o!==33&&o!==63&&o!==47&&!tQe(o))return!1;let s=t.src.slice(n).match(BIe);if(!s)return!1;if(!e){let a=t.push("html_inline","",0);a.content=s[0],ZYe(a.content)&&t.linkLevel++,eQe(a.content)&&t.linkLevel--}return t.pos+=s[0].length,!0}var rQe=/^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i,nQe=/^&([a-z][a-z0-9]{1,31});/i;function pQ(t,e){let r=t.pos,n=t.posMax;if(t.src.charCodeAt(r)!==38||r+1>=n)return!1;if(t.src.charCodeAt(r+1)===35){let s=t.src.slice(r).match(rQe);if(s){if(!e){let a=s[1][0].toLowerCase()==="x"?parseInt(s[1].slice(1),16):parseInt(s[1],10),c=t.push("text_special","",0);c.content=P6(a)?Wk(a):Wk(65533),c.markup=s[0],c.info="entity"}return t.pos+=s[0].length,!0}}else{let s=t.src.slice(r).match(nQe);if(s){let a=Jg(s[0]);if(a!==s[0]){if(!e){let c=t.push("text_special","",0);c.content=a,c.markup=s[0],c.info="entity"}return t.pos+=s[0].length,!0}}}return!1}function VIe(t){let e={},r=t.length;if(!r)return;let n=0,o=-2,s=[];for(let a=0;a<r;a++){let c=t[a];if(s.push(0),(t[n].marker!==c.marker||o!==c.token-1)&&(n=a),o=c.token,c.length=c.length||0,!c.close)continue;e.hasOwnProperty(c.marker)||(e[c.marker]=[-1,-1,-1,-1,-1,-1]);let u=e[c.marker][(c.open?3:0)+c.length%3],l=n-s[n]-1,d=l;for(;l>u;l-=s[l]+1){let p=t[l];if(p.marker===c.marker&&p.open&&p.end<0){let f=!1;if((p.close||c.open)&&(p.length+c.length)%3===0&&(p.length%3!==0||c.length%3!==0)&&(f=!0),!f){let m=l>0&&!t[l-1].open?s[l-1]+1:0;s[a]=a-l+m,s[l]=m,c.open=!1,p.end=a,p.close=!1,d=-1,o=-2;break}}}d!==-1&&(e[c.marker][(c.open?3:0)+(c.length||0)%3]=d)}}function fQ(t){let e=t.tokens_meta,r=t.tokens_meta.length;VIe(t.delimiters);for(let n=0;n<r;n++)e[n]&&e[n].delimiters&&VIe(e[n].delimiters)}function mQ(t){let e,r,n=0,o=t.tokens,s=t.tokens.length;for(e=r=0;e<s;e++)o[e].nesting<0&&n--,o[e].level=n,o[e].nesting>0&&n++,o[e].type==="text"&&e+1<s&&o[e+1].type==="text"?o[e+1].content=o[e].content+o[e+1].content:(e!==r&&(o[r]=o[e]),r++);e!==r&&(o.length=r)}var hQ=[["text",eQ],["linkify",tQ],["newline",rQ],["escape",iQ],["backticks",oQ],["strikethrough",sQ.tokenize],["emphasis",aQ.tokenize],["link",cQ],["image",uQ],["autolink",lQ],["html_inline",dQ],["entity",pQ]],gQ=[["balance_pairs",fQ],["strikethrough",sQ.postProcess],["emphasis",aQ.postProcess],["fragments_join",mQ]];function Yk(){this.ruler=new Ib;for(let t=0;t<hQ.length;t++)this.ruler.push(hQ[t][0],hQ[t][1]);this.ruler2=new Ib;for(let t=0;t<gQ.length;t++)this.ruler2.push(gQ[t][0],gQ[t][1])}Yk.prototype.skipToken=function(t){let e=t.pos,r=this.ruler.getRules(""),n=r.length,o=t.md.options.maxNesting,s=t.cache;if(typeof s[e]<"u"){t.pos=s[e];return}let a=!1;if(t.level<o){for(let c=0;c<n;c++)if(t.level++,a=r[c](t,!0),t.level--,a){if(e>=t.pos)throw new Error("inline rule didn't increment state.pos");break}}else t.pos=t.posMax;a||t.pos++,s[e]=t.pos};Yk.prototype.tokenize=function(t){let e=this.ruler.getRules(""),r=e.length,n=t.posMax,o=t.md.options.maxNesting;for(;t.pos<n;){let s=t.pos,a=!1;if(t.level<o){for(let c=0;c<r;c++)if(a=e[c](t,!1),a){if(s>=t.pos)throw new Error("inline rule didn't increment state.pos");break}}if(a){if(t.pos>=n)break;continue}t.pending+=t.src[t.pos++]}t.pending&&t.pushPending()};Yk.prototype.parse=function(t,e,r,n){let o=new this.State(t,e,r,n);this.tokenize(o);let s=this.ruler2.getRules(""),a=s.length;for(let c=0;c<a;c++)s[c](o)};Yk.prototype.State=jIe;var $Ie=Yk;function WIe(t){let e={};t=t||{},e.src_Any=T6.source,e.src_Cc=E6.source,e.src_Z=w6.source,e.src_P=tI.source,e.src_ZPCc=[e.src_Z,e.src_P,e.src_Cc].join("|"),e.src_ZCc=[e.src_Z,e.src_Cc].join("|");let r="[><\uFF5C]";return e.src_pseudo_letter="(?:(?!"+r+"|"+e.src_ZPCc+")"+e.src_Any+")",e.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",e.src_auth="(?:(?:(?!"+e.src_ZCc+"|[@/\\[\\]()]).)+@)?",e.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",e.src_host_terminator="(?=$|"+r+"|"+e.src_ZPCc+")(?!"+(t["---"]?"-(?!--)|":"-|")+"_|:\\d|\\.-|\\.(?!$|"+e.src_ZPCc+"))",e.src_path="(?:[/?#](?:(?!"+e.src_ZCc+"|"+r+`|[()[\\]{}.,"'?!\\-;]).|\\[(?:(?!`+e.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+e.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+e.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+e.src_ZCc+`|["]).)+\\"|\\'(?:(?!`+e.src_ZCc+"|[']).)+\\'|\\'(?="+e.src_pseudo_letter+"|[-])|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+e.src_ZCc+"|[.]|$)|"+(t["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+e.src_ZCc+"|$)|;(?!"+e.src_ZCc+"|$)|\\!+(?!"+e.src_ZCc+"|[!]|$)|\\?(?!"+e.src_ZCc+"|[?]|$))+|\\/)?",e.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',e.src_xn="xn--[a-z0-9\\-]{1,59}",e.src_domain_root="(?:"+e.src_xn+"|"+e.src_pseudo_letter+"{1,63})",e.src_domain="(?:"+e.src_xn+"|(?:"+e.src_pseudo_letter+")|(?:"+e.src_pseudo_letter+"(?:-|"+e.src_pseudo_letter+"){0,61}"+e.src_pseudo_letter+"))",e.src_host="(?:(?:(?:(?:"+e.src_domain+")\\.)*"+e.src_domain+"))",e.tpl_host_fuzzy="(?:"+e.src_ip4+"|(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%)))",e.tpl_host_no_ip_fuzzy="(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%))",e.src_host_strict=e.src_host+e.src_host_terminator,e.tpl_host_fuzzy_strict=e.tpl_host_fuzzy+e.src_host_terminator,e.src_host_port_strict=e.src_host+e.src_port+e.src_host_terminator,e.tpl_host_port_fuzzy_strict=e.tpl_host_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_port_no_ip_fuzzy_strict=e.tpl_host_no_ip_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+e.src_ZPCc+"|>|$))",e.tpl_email_fuzzy="(^|"+r+'|"|\\(|'+e.src_ZCc+")("+e.src_email_name+"@"+e.tpl_host_fuzzy_strict+")",e.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|\uFF5C]|"+e.src_ZPCc+"))((?![$+<=>^`|\uFF5C])"+e.tpl_host_port_fuzzy_strict+e.src_path+")",e.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|\uFF5C]|"+e.src_ZPCc+"))((?![$+<=>^`|\uFF5C])"+e.tpl_host_port_no_ip_fuzzy_strict+e.src_path+")",e}function vQ(t){return Array.prototype.slice.call(arguments,1).forEach(function(r){r&&Object.keys(r).forEach(function(n){t[n]=r[n]})}),t}function M6(t){return Object.prototype.toString.call(t)}function iQe(t){return M6(t)==="[object String]"}function oQe(t){return M6(t)==="[object Object]"}function sQe(t){return M6(t)==="[object RegExp]"}function KIe(t){return M6(t)==="[object Function]"}function aQe(t){return t.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}var QIe={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};function cQe(t){return Object.keys(t||{}).reduce(function(e,r){return e||QIe.hasOwnProperty(r)},!1)}var uQe={"http:":{validate:function(t,e,r){let n=t.slice(e);return r.re.http||(r.re.http=new RegExp("^\\/\\/"+r.re.src_auth+r.re.src_host_port_strict+r.re.src_path,"i")),r.re.http.test(n)?n.match(r.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(t,e,r){let n=t.slice(e);return r.re.no_http||(r.re.no_http=new RegExp("^"+r.re.src_auth+"(?:localhost|(?:(?:"+r.re.src_domain+")\\.)+"+r.re.src_domain_root+")"+r.re.src_port+r.re.src_host_terminator+r.re.src_path,"i")),r.re.no_http.test(n)?e>=3&&t[e-3]===":"||e>=3&&t[e-3]==="/"?0:n.match(r.re.no_http)[0].length:0}},"mailto:":{validate:function(t,e,r){let n=t.slice(e);return r.re.mailto||(r.re.mailto=new RegExp("^"+r.re.src_email_name+"@"+r.re.src_host_strict,"i")),r.re.mailto.test(n)?n.match(r.re.mailto)[0].length:0}}},lQe="a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]",dQe="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|\u0440\u0444".split("|");function pQe(t){t.__index__=-1,t.__text_cache__=""}function fQe(t){return function(e,r){let n=e.slice(r);return t.test(n)?n.match(t)[0].length:0}}function YIe(){return function(t,e){e.normalize(t)}}function O6(t){let e=t.re=WIe(t.__opts__),r=t.__tlds__.slice();t.onCompile(),t.__tlds_replaced__||r.push(lQe),r.push(e.src_xn),e.src_tlds=r.join("|");function n(c){return c.replace("%TLDS%",e.src_tlds)}e.email_fuzzy=RegExp(n(e.tpl_email_fuzzy),"i"),e.link_fuzzy=RegExp(n(e.tpl_link_fuzzy),"i"),e.link_no_ip_fuzzy=RegExp(n(e.tpl_link_no_ip_fuzzy),"i"),e.host_fuzzy_test=RegExp(n(e.tpl_host_fuzzy_test),"i");let o=[];t.__compiled__={};function s(c,u){throw new Error('(LinkifyIt) Invalid schema "'+c+'": '+u)}Object.keys(t.__schemas__).forEach(function(c){let u=t.__schemas__[c];if(u===null)return;let l={validate:null,link:null};if(t.__compiled__[c]=l,oQe(u)){sQe(u.validate)?l.validate=fQe(u.validate):KIe(u.validate)?l.validate=u.validate:s(c,u),KIe(u.normalize)?l.normalize=u.normalize:u.normalize?s(c,u):l.normalize=YIe();return}if(iQe(u)){o.push(c);return}s(c,u)}),o.forEach(function(c){t.__compiled__[t.__schemas__[c]]&&(t.__compiled__[c].validate=t.__compiled__[t.__schemas__[c]].validate,t.__compiled__[c].normalize=t.__compiled__[t.__schemas__[c]].normalize)}),t.__compiled__[""]={validate:null,normalize:YIe()};let a=Object.keys(t.__compiled__).filter(function(c){return c.length>0&&t.__compiled__[c]}).map(aQe).join("|");t.re.schema_test=RegExp("(^|(?!_)(?:[><\uFF5C]|"+e.src_ZPCc+"))("+a+")","i"),t.re.schema_search=RegExp("(^|(?!_)(?:[><\uFF5C]|"+e.src_ZPCc+"))("+a+")","ig"),t.re.schema_at_start=RegExp("^"+t.re.schema_search.source,"i"),t.re.pretest=RegExp("("+t.re.schema_test.source+")|("+t.re.host_fuzzy_test.source+")|@","i"),pQe(t)}function mQe(t,e){let r=t.__index__,n=t.__last_index__,o=t.__text_cache__.slice(r,n);this.schema=t.__schema__.toLowerCase(),this.index=r+e,this.lastIndex=n+e,this.raw=o,this.text=o,this.url=o}function yQ(t,e){let r=new mQe(t,e);return t.__compiled__[r.schema].normalize(r,t),r}function kc(t,e){if(!(this instanceof kc))return new kc(t,e);e||cQe(t)&&(e=t,t={}),this.__opts__=vQ({},QIe,e),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=vQ({},uQe,t),this.__compiled__={},this.__tlds__=dQe,this.__tlds_replaced__=!1,this.re={},O6(this)}kc.prototype.add=function(e,r){return this.__schemas__[e]=r,O6(this),this};kc.prototype.set=function(e){return this.__opts__=vQ(this.__opts__,e),this};kc.prototype.test=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return!1;let r,n,o,s,a,c,u,l,d;if(this.re.schema_test.test(e)){for(u=this.re.schema_search,u.lastIndex=0;(r=u.exec(e))!==null;)if(s=this.testSchemaAt(e,r[2],u.lastIndex),s){this.__schema__=r[2],this.__index__=r.index+r[1].length,this.__last_index__=r.index+r[0].length+s;break}}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(l=e.search(this.re.host_fuzzy_test),l>=0&&(this.__index__<0||l<this.__index__)&&(n=e.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))!==null&&(a=n.index+n[1].length,(this.__index__<0||a<this.__index__)&&(this.__schema__="",this.__index__=a,this.__last_index__=n.index+n[0].length))),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&(d=e.indexOf("@"),d>=0&&(o=e.match(this.re.email_fuzzy))!==null&&(a=o.index+o[1].length,c=o.index+o[0].length,(this.__index__<0||a<this.__index__||a===this.__index__&&c>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=a,this.__last_index__=c))),this.__index__>=0};kc.prototype.pretest=function(e){return this.re.pretest.test(e)};kc.prototype.testSchemaAt=function(e,r,n){return this.__compiled__[r.toLowerCase()]?this.__compiled__[r.toLowerCase()].validate(e,n,this):0};kc.prototype.match=function(e){let r=[],n=0;this.__index__>=0&&this.__text_cache__===e&&(r.push(yQ(this,n)),n=this.__last_index__);let o=n?e.slice(n):e;for(;this.test(o);)r.push(yQ(this,n)),o=o.slice(this.__last_index__),n+=this.__last_index__;return r.length?r:null};kc.prototype.matchAtStart=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return null;let r=this.re.schema_at_start.exec(e);if(!r)return null;let n=this.testSchemaAt(e,r[2],r[0].length);return n?(this.__schema__=r[2],this.__index__=r.index+r[1].length,this.__last_index__=r.index+r[0].length+n,yQ(this,0)):null};kc.prototype.tlds=function(e,r){return e=Array.isArray(e)?e:[e],r?(this.__tlds__=this.__tlds__.concat(e).sort().filter(function(n,o,s){return n!==s[o-1]}).reverse(),O6(this),this):(this.__tlds__=e.slice(),this.__tlds_replaced__=!0,O6(this),this)};kc.prototype.normalize=function(e){e.schema||(e.url="http://"+e.url),e.schema==="mailto:"&&!/^mailto:/i.test(e.url)&&(e.url="mailto:"+e.url)};kc.prototype.onCompile=function(){};var XIe=kc;var ZIe="-",hQe=/^xn--/,gQe=/[^\0-\x7F]/,vQe=/[\x2E\u3002\uFF0E\uFF61]/g,yQe={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},bQ=35,rp=Math.floor,_Q=String.fromCharCode;function ev(t){throw new RangeError(yQe[t])}function bQe(t,e){let r=[],n=t.length;for(;n--;)r[n]=e(t[n]);return r}function eCe(t,e){let r=t.split("@"),n="";r.length>1&&(n=r[0]+"@",t=r[1]),t=t.replace(vQe,".");let o=t.split("."),s=bQe(o,e).join(".");return n+s}function tCe(t){let e=[],r=0,n=t.length;for(;r<n;){let o=t.charCodeAt(r++);if(o>=55296&&o<=56319&&r<n){let s=t.charCodeAt(r++);(s&64512)==56320?e.push(((o&1023)<<10)+(s&1023)+65536):(e.push(o),r--)}else e.push(o)}return e}var _Qe=t=>String.fromCodePoint(...t),xQe=function(t){return t>=48&&t<58?26+(t-48):t>=65&&t<91?t-65:t>=97&&t<123?t-97:36},JIe=function(t,e){return t+22+75*(t<26)-((e!=0)<<5)},rCe=function(t,e,r){let n=0;for(t=r?rp(t/700):t>>1,t+=rp(t/e);t>bQ*26>>1;n+=36)t=rp(t/bQ);return rp(n+(bQ+1)*t/(t+38))},nCe=function(t){let e=[],r=t.length,n=0,o=128,s=72,a=t.lastIndexOf(ZIe);a<0&&(a=0);for(let c=0;c<a;++c)t.charCodeAt(c)>=128&&ev("not-basic"),e.push(t.charCodeAt(c));for(let c=a>0?a+1:0;c<r;){let u=n;for(let d=1,p=36;;p+=36){c>=r&&ev("invalid-input");let f=xQe(t.charCodeAt(c++));f>=36&&ev("invalid-input"),f>rp((2147483647-n)/d)&&ev("overflow"),n+=f*d;let m=p<=s?1:p>=s+26?26:p-s;if(f<m)break;let h=36-m;d>rp(2147483647/h)&&ev("overflow"),d*=h}let l=e.length+1;s=rCe(n-u,l,u==0),rp(n/l)>2147483647-o&&ev("overflow"),o+=rp(n/l),n%=l,e.splice(n++,0,o)}return String.fromCodePoint(...e)},iCe=function(t){let e=[];t=tCe(t);let r=t.length,n=128,o=0,s=72;for(let u of t)u<128&&e.push(_Q(u));let a=e.length,c=a;for(a&&e.push(ZIe);c<r;){let u=2147483647;for(let d of t)d>=n&&d<u&&(u=d);let l=c+1;u-n>rp((2147483647-o)/l)&&ev("overflow"),o+=(u-n)*l,n=u;for(let d of t)if(d<n&&++o>2147483647&&ev("overflow"),d===n){let p=o;for(let f=36;;f+=36){let m=f<=s?1:f>=s+26?26:f-s;if(p<m)break;let h=p-m,g=36-m;e.push(_Q(JIe(m+h%g,0))),p=rp(h/g)}e.push(_Q(JIe(p,0))),s=rCe(o,l,c===a),o=0,++c}++o,++n}return e.join("")},SQe=function(t){return eCe(t,function(e){return hQe.test(e)?nCe(e.slice(4).toLowerCase()):e})},IQe=function(t){return eCe(t,function(e){return gQe.test(e)?"xn--"+iCe(e):e})},CQe={version:"2.3.1",ucs2:{decode:tCe,encode:_Qe},decode:nCe,encode:iCe,toASCII:IQe,toUnicode:SQe};var xQ=CQe;var oCe={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"\u201C\u201D\u2018\u2019",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}};var sCe={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"\u201C\u201D\u2018\u2019",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","fragments_join"]}}};var aCe={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"\u201C\u201D\u2018\u2019",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","fragments_join"]}}};var TQe={default:oCe,zero:sCe,commonmark:aCe},EQe=/^(vbscript|javascript|file|data):/,wQe=/^data:image\/(gif|png|jpeg|webp);/;function RQe(t){let e=t.trim().toLowerCase();return EQe.test(e)?wQe.test(e):!0}var cCe=["http:","https:","mailto:"];function kQe(t){let e=$k(t,!0);if(e.hostname&&(!e.protocol||cCe.indexOf(e.protocol)>=0))try{e.hostname=xQ.toASCII(e.hostname)}catch{}return S6(eI(e))}function AQe(t){let e=$k(t,!0);if(e.hostname&&(!e.protocol||cCe.indexOf(e.protocol)>=0))try{e.hostname=xQ.toUnicode(e.hostname)}catch{}return Vk(eI(e),Vk.defaultChars+"%")}function wu(t,e){if(!(this instanceof wu))return new wu(t,e);e||A6(t)||(e=t||{},t="default"),this.inline=new $Ie,this.block=new HIe,this.core=new PIe,this.renderer=new TIe,this.linkify=new XIe,this.validateLink=RQe,this.normalizeLink=kQe,this.normalizeLinkText=AQe,this.utils=RY,this.helpers=rI({},DY),this.options={},this.configure(t),e&&this.set(e)}wu.prototype.set=function(t){return rI(this.options,t),this};wu.prototype.configure=function(t){let e=this;if(A6(t)){let r=t;if(t=TQe[r],!t)throw new Error('Wrong `markdown-it` preset "'+r+'", check name')}if(!t)throw new Error("Wrong `markdown-it` preset, can't be empty");return t.options&&e.set(t.options),t.components&&Object.keys(t.components).forEach(function(r){t.components[r].rules&&e[r].ruler.enableOnly(t.components[r].rules),t.components[r].rules2&&e[r].ruler2.enableOnly(t.components[r].rules2)}),this};wu.prototype.enable=function(t,e){let r=[];Array.isArray(t)||(t=[t]),["core","block","inline"].forEach(function(o){r=r.concat(this[o].ruler.enable(t,!0))},this),r=r.concat(this.inline.ruler2.enable(t,!0));let n=t.filter(function(o){return r.indexOf(o)<0});if(n.length&&!e)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+n);return this};wu.prototype.disable=function(t,e){let r=[];Array.isArray(t)||(t=[t]),["core","block","inline"].forEach(function(o){r=r.concat(this[o].ruler.disable(t,!0))},this),r=r.concat(this.inline.ruler2.disable(t,!0));let n=t.filter(function(o){return r.indexOf(o)<0});if(n.length&&!e)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+n);return this};wu.prototype.use=function(t){let e=[this].concat(Array.prototype.slice.call(arguments,1));return t.apply(t,e),this};wu.prototype.parse=function(t,e){if(typeof t!="string")throw new Error("Input data should be a String");let r=new this.core.State(t,this,e);return this.core.process(r),r.tokens};wu.prototype.render=function(t,e){return e=e||{},this.renderer.render(this.parse(t,e),this.options,e)};wu.prototype.parseInline=function(t,e){let r=new this.core.State(t,this,e);return r.inlineMode=!0,this.core.process(r),r.tokens};wu.prototype.renderInline=function(t,e){return e=e||{},this.renderer.render(this.parseInline(t,e),this.options,e)};var SQ=wu;function uCe(t){let e=t.matchAll(/^\s*(```+)/gm),r=Math.max(3,...Array.from(e,n=>n[1].length+1));return"`".repeat(r)}function ki(t,e,r=!0){let n=e.matchAll(/^\s*(```+)/gm),o=Math.max(3,...Array.from(n,a=>a[1].length+1)),s="`".repeat(o);return`${s}${F6(t)}
${r?e.trim():e}
${s}`}function F6(t){switch(t.trim().toLowerCase()){case"typescriptreact":return"tsx";case"javascriptreact":return"jsx";default:return t}}function U6(t){let e=uc(t).toLowerCase(),r=Object.keys(kE).find(n=>kE.get(n)?.extensions?.includes(e))||e.replace(/^\./,"");return F6(r)}function Ws(t){let e=[],n=new SQ().parse(t,{});for(let o of lCe(n))o.map&&o.type==="fence"&&e.push({startMarkup:o.markup,code:o.content.replace(/\n$/,""),language:o.info.trim(),startLine:o.map[0],endLine:o.map[1]});return e}function*lCe(t){for(let e of t)e.children&&(yield*lCe(e.children)),yield e}var mCe=W(fCe()),hCe=require("util");var sI=class{constructor(e,r){this.baseUri=e;this.pattern=r}get base(){throw new Error("Not implemented")}};var BQe=1e5,qQe=1*1024*1024,HQe=new Set(["jpg","jpeg","jpe","png","gif","bmp","tif","tiff","tga","ico","webp","svg","eps","heif","heic","pdf","raw","mp4","m4v","mkv","webm","mov","avi","wmv","flv","mp3","wav","m4a","flac","ogg","wma","weba","aac","7z","bz2","gz","gz","rar","tar","xz","zip","vsix","db","bin","dat","hex","map","wasm","pyc","pdb","sym","git"]),jQe=["node_modules","out","dist",".git",".yarn",".npm",".venv","foo.asar",".vscode-test"],zQe=[".DS_Store","Thumbs.db","package-lock.json","yarn.lock"],GQe=[nn.vscode,nn.vscodeUserData,"output",nn.inMemory,nn.internal,"git"];function Cb(t,e){if(GQe.includes(t.scheme)||e&&![nn.file,nn.untitled].includes(t.scheme)&&!e.getWorkspaceFolders().some(o=>t.scheme===o.scheme))return!1;let r=uc(t).replace(/\./,"").toLowerCase();return!(HQe.has(r)||zQe.includes(Uc(t).toLowerCase())||t.fsPath.toLowerCase().split(/[/\\]/g).some(o=>jQe.includes(o)))}async function VQe(t,e=BQe,r){let n=t.get(Ze),o=t.get(Aa),s=t.get(De);if(await s.init(),r?.isCancellationRequested)return[];let a=new Pn;for(let c of n.getWorkspaceFolders()??[]){if(a.size>=e)break;let u=await o.findFilesWithDefaultExcludes(new sI(c,"**/*"),e-a.size,r);if(r.isCancellationRequested)return[];for(let l of u){if(a.size>=e||r.isCancellationRequested)break;Cb(l,n)&&!await s.isCopilotIgnored(l)&&a.set(l)}}return a.keys()}var q6=class{constructor(e,r){this._uri=e;this._chunkingService=r;this._isDisposed=!1;this._disposedCts=new Xre}dispose(){this._isDisposed=!0,this._disposedCts.cancel(),this._disposedCts.dispose()}get uri(){return this._uri}async getBasicChunks(e){return this._basicChunks??=this.getText(this._disposedCts.token).then(r=>this._isDisposed?[]:this._chunkingService.chunkFileNaive(this._uri,r,this._disposedCts.token)),await Um(this._basicChunks,e)??[]}async getSemanticChunks(e){return this._chunkingService.canSemanticallyChunk(this.uri)?(this._semanticChunks??=this.getText(this._disposedCts.token).then(r=>this._isDisposed?[]:this._chunkingService.chunkFileSemantic(this._uri,r,this._disposedCts.token)),await Um(this._semanticChunks,e)??[]):this.getBasicChunks(e)}},EQ=class extends q6{constructor(r,n,o){super(r,n);this._fs=o}async getText(r){return this._text??=this._fs.readFile(this.uri).then(async n=>this._isDisposed||n.byteLength>=qQe||await(0,mCe.isBinaryFile)(Buffer.from(n))||this._isDisposed?"":new hCe.TextDecoder().decode(n),n=>""),await Um(this._text,r)??""}},H6=class extends q6{constructor(r,n){super(r.uri,n);this._textDocument=r}async getText(r){return this._textDocument.getText()}},Tl=se("workspaceChunkIndex"),aI=class extends St{constructor(r,n,o,s,a){super();this._accessor=r;this._chunkingService=n;this._fileSystem=o;this._telemetryService=s;this._workspaceService=a;this._textDocumentFiles=new Pn;this._fsFiles=new Pn;this._onDidCreateFile=this._register(new Ht);this.onDidCreateFile=this._onDidCreateFile.event;this._onDidChangeFile=this._register(new Ht);this.onDidChangeFile=this._onDidChangeFile.event;this._onDidDeleteFile=this._register(new Ht);this.onDidDeleteFile=this._onDidDeleteFile.event}get fileSystemFileCount(){return this._fsFiles.size}dispose(){super.dispose(),Am(this._fsFiles.values()),this._fsFiles.clear(),Am(this._textDocumentFiles.values()),this._textDocumentFiles.clear()}get(r){return this._textDocumentFiles.get(r)||this._fsFiles.get(r)}*values(){let r=new Pn;for(let[n,o]of this._textDocumentFiles.entries())yield o,r.set(n);for(let[n,o]of this._fsFiles.entries())r.has(n)||(r.set(n),yield o)}registerListeners(){let r=o=>{if(!Cb(o.uri,this._workspaceService))return;let s=this._textDocumentFiles.get(o.uri),a=this._fsFiles.get(o.uri);s?.dispose(),this._textDocumentFiles.set(o.uri,new H6(o,this._chunkingService)),!s&&!a?this._onDidCreateFile.fire(o.uri):this._onDidChangeFile.fire(o.uri)};this._register(this._workspaceService.onDidOpenTextDocument(r)),this._register(this._workspaceService.onDidChangeTextDocument(o=>r(o.document))),this._register(this._workspaceService.onDidCloseTextDocument(o=>{let s=this._textDocumentFiles.get(o.uri);if(!s)return;this._textDocumentFiles.delete(o.uri),s.dispose(),this._fsFiles.get(o.uri)?this._onDidChangeFile.fire(o.uri):this._onDidDeleteFile.fire(o.uri)}));let n=this._register(this._fileSystem.createFileSystemWatcher("**/*"));this._register(n.onDidChange(o=>{if(!Cb(o,this._workspaceService))return;let s=this._fsFiles.has(o);this.createOrUpdateFsEntry(o),s?this._onDidChangeFile.fire(o):this._onDidCreateFile.fire(o)})),this._register(n.onDidCreate(o=>{Cb(o,this._workspaceService)&&(this._fsFiles.has(o)||(this.createOrUpdateFsEntry(o),this._onDidCreateFile.fire(o)))})),this._register(n.onDidDelete(o=>{let s=this._fsFiles.get(o);s&&(s.dispose(),this._fsFiles.delete(o),this._onDidDeleteFile.fire(o))}))}initialize(){return this._initializedWorkspacePromise??=(async()=>{this.registerListeners(),await this._workspaceService.ensureWorkspaceIsFullyLoaded();for(let n of this._workspaceService.textDocuments)Cb(n.uri,this._workspaceService)&&this._textDocumentFiles.set(n.uri,new H6(n,this._chunkingService));let r=await VQe(this._accessor,void 0,Fr.None);for(let n of r)this.createOrUpdateFsEntry(n);this._telemetryService.sendMSFTTelemetryEvent("workspaceChunkIndex.initialize",{},{totalFileCount:ks.reduce(this.values(),n=>n+1,0)})})(),this._initializedWorkspacePromise}createOrUpdateFsEntry(r){let n=this._fsFiles.get(r);n&&n.dispose();let o=new EQ(r,this._chunkingService,this._fileSystem);this._fsFiles.set(r,o)}};aI=B([T(0,rt),T(1,Wu),T(2,on),T(3,me),T(4,Ze)],aI);var $Qe="1.0.9",Xk=class extends St{constructor(r,n,o,s){super();this.path=r;this.version=n;this.options=o;this.fileSystem=s;this.cache=new b6(this.options),this._delayer=typeof o.autoWriteDelay=="number"?this._register(new pP(o.autoWriteDelay)):void 0}async initialize(){if(!this.path)return;let r;try{r=await this.fileSystem.readFile(this.path)}catch{return}try{let n=new TextDecoder().decode(r),o=JSON.parse(n);o.version===this.version&&this.cache.load(o.data)}catch(n){console.error(`Failed to load LRU cache at ${this.path}`,n)}}async get(r){return this.cache.get(await this.toKey(r))}async set(r,n){this.cache.set(await this.toKey(r),n),this._delayer?.trigger(()=>this.save())}async save(){if(!this.path)return;let r=JSON.stringify({version:this.version,data:this.cache.dump()});await this.fileSystem.writeFile(this.path,new TextEncoder().encode(r))}async toKey(r){let o=new TextEncoder().encode(r),s=await crypto.subtle.digest("SHA-256",o);return Array.from(new Uint8Array(s)).map(u=>u.toString(16).padStart(2,"0")).join("")}};Xk=B([T(3,on)],Xk);var nv=se("IWorkspaceChunkEmbeddingsIndex"),Jf=class extends St{constructor(r){super();this._accessor=r;this.shouldSearchTimeout=!0;this._workspaceIndex=r.get(Tl),this._embeddingsComputer=r.get(Mo),this._embeddingsCache=new Lo(async()=>{let n=this._accessor.get(zt).storageUri,o=n?lt.joinPath(n,"workspaceEmbeddingsCache.json"):void 0,s=this._register(r.get(or).createInstance(Xk,o,$Qe,{max:2e3,autoWriteDelay:5e3}));return await s.initialize(),s}),this._logger=r.get(ce).getLogger("WorkspaceChunkEmbeddingsIndex")}static{this._MAX_EMBEDDINGS_COMPUTATION_TIME=1e4}static{this._MAX_CHUNK_LENGTH=2e3}get fileSystemFileCount(){return this._workspaceIndex.fileSystemFileCount}workspaceEmbeddingsInitialized(){return this._initializedWorkspacePromise??=this._workspaceIndex.initialize(),this._initializedWorkspacePromise}async triggerIndexing(r){let n=await this.getChunksToSearch(r);if(r.isCancellationRequested)return;let o=await this.getEmbeddings(n.map(s=>this.chunkToIndexString(s)),r);this._logger.debug(`Indexed ${o.length} chunks`)}async searchAllChunks(r,n,o){let s=await this.getChunksToSearch(o);return o.isCancellationRequested?[]:this.searchChunks(s,r,n,o)}async searchChunks(r,n,o,s){if(!r.length)return[];let a=[n,...r.map(p=>this.chunkToIndexString(p))],c=this.shouldSearchTimeout?await d0(this.getEmbeddings(a,s),Jf._MAX_EMBEDDINGS_COMPUTATION_TIME):await this.getEmbeddings(a,s);if(s.isCancellationRequested)return[];if(!c)throw new Error("Timeout computing embeddings");if(c.length<1)throw new Error("Invalid response");let[u,...l]=c,d=l.map((p,f)=>[r[f],p]);return Hne(u,d,o)}async getChunksToSearch(r){let n=(await Promise.all(Array.from(this._workspaceIndex.values(),o=>o.getSemanticChunks(r)))).flat();return r.isCancellationRequested?[]:n.filter(o=>o.text.length<Jf._MAX_CHUNK_LENGTH)}chunkToIndexString(r){let n=this._accessor.get(Ze),o=Kg(n,r.file);return WQe(r,o)}async getEmbeddings(r,n){let o=await this._embeddingsCache.value,s=new Array(r.length),a=[];for(let[u,l]of r.entries()){let d=await o.get(l);d?s[u]=d:a.push({index:u,value:l})}if(a.length===0)return s;let c=await this.computeEmbeddingsWithRetry(a.map(u=>u.value),n);for(let u=0;u<a.length;u++){let l=a[u],d=c[u];if(typeof d>"u")throw new Error("Error computing embedding");s[l.index]=d,await o.set(l.value,d)}return s}async computeEmbeddingsWithRetry(r,n){let s=0,a;for(;s<3;)try{if(this._embeddingEndpoint??=await this._accessor.get(Le).getEmbeddingsEndpoint("ada"),a=await this._embeddingsComputer.computeEmbeddings(this._embeddingEndpoint,r,{parallelism:2},n),!a)throw new Error("Failed to compute embeddings");return a}catch(c){if(s++,s===3)throw c;if(n.isCancellationRequested)throw new Error("Cancelled computing embeddings");this._logger.warn(`Error computing embeddings. Retrying in ${s} seconds. Error: ${c}`),await new Promise(u=>setTimeout(u,1e3*s))}throw new Error("Failed to compute embeddings")}};Jf=B([T(0,rt)],Jf);function WQe(t,e){return`File: \`${e}\`
${ki(U6(t.file),t.text)}`}var zQ=W(Tr());var cI=class extends Error{constructor(r,n){super(n);this.repo=r}},Jk=class extends cI{constructor(){super(...arguments);this.name="ERROR_TYPE_MISSING_INACCESSIBLE_REPO_ORG"}},wQ=class extends cI{constructor(){super(...arguments);this.name="ERROR_TYPE_DOCS_EMBEDDINGS_UNAVAILABLE"}},RQ=class extends cI{constructor(){super(...arguments);this.name="ERROR_TYPE_NOT_INDEXED"}},kQ=class extends Error{constructor(){super(...arguments);this.name="ERROR_TYPE_MAX_RETRIES_EXCEEDED"}},AQ=class extends Error{constructor(){super(...arguments);this.name="ERROR_TYPE_NO_ACCESS_TO_ENDPOINT"}};function gCe({error:t,message:e,repo:r}){switch(t){case"ERROR_TYPE_MISSING_INACCESSIBLE_REPO_ORG":return new Jk(r,e);case"ERROR_TYPE_DOCS_EMBEDDINGS_UNAVAILABLE":return new wQ(r,e);case"ERROR_TYPE_NOT_INDEXED":return new RQ(r,e);default:return new cI(r,e)}}function PQ({error:t,message:e}){switch(t){case"ERROR_TYPE_MAX_RETRIES_EXCEEDED":return new kQ(e);case"ERROR_TYPE_NO_ACCESS_TO_ENDPOINT":return new AQ(e);default:return new Error(e)}}var HQ=W(MCe());function $6(t,e){return typeof e=="string"?HQ.default.isMatch(t.fsPath,e,{dot:!0,windows:process.platform==="win32"}):HQ.default.isMatch(t.fsPath,e.pattern,{dot:!0,windows:process.platform==="win32"})}function FCe(t,e){return e.exclude?.some(r=>$6(t,r))?!1:e.include?e.include.some(r=>$6(t,r)):!0}var W6=se("codeSearchClient"),K6=se("docsSearchClient");async function Y6(t,e,r){let n=t.get(Tl),o=t.get(Wu),s=new Pn;for(let c of e){let u=s.get(c.file);u?u.push(c):s.set(c.file,[c])}let a=await Promise.all(Array.from(s,async([c,u])=>{let l=n.get(c);if(l&&o.canSemanticallyChunk(c)){let d=await l.getSemanticChunks(r);if(r.isCancellationRequested)return[];let p=new Set;for(let f of u){let m=!1;for(let h of d)h.range.intersectRanges(f.range)&&(p.add(h),m=!0);m||p.add(f)}return Array.from(p)}else return u}));return Array.from(new Set(a.flat()))}var Tb=class extends St{constructor(r){super();this.accessor=r;this.id="codesearch";this.timeout=5e3;this._codeSearchClient=r.get(W6),this._workspaceChunkIndex=r.get(Tl),this._embeddingsIndex=r.get(nv),this._telemetryService=r.get(me),this._logger=r.get(ce).getLogger("CodeSearchChunkSearch")}async searchFileChunks(r,n,o,s){if(s.isCancellationRequested)return[];if(await Zl(this._logger,"initialize",()=>this.initialized()),s.isCancellationRequested)return[];let a;try{if(a=await this.getSimilarFilesFromCodeSearch(r,s),s.isCancellationRequested)return[];this._telemetryService.sendMSFTTelemetryEvent("codeSearchChunkSearch.search.success",{},{chunkCount:a?.length??0})}catch(u){throw this._telemetryService.sendMSFTTelemetryEvent("codeSearchChunkSearch.search.error",{errorMessage:u instanceof Error?u.message:u.toString()}),u}if(!a||s.isCancellationRequested)return[];let c=await Zl(this._logger,"toSemanticChunks",()=>Y6(this.accessor,a,s));return s.isCancellationRequested?[]:o.include?c.filter(u=>FCe(u.file,o.include)):c}async isAvailable(){let r;return r=this.accessor.get(be).getConfig(ge.WorkspaceCodeSearchEnabled),r===void 0&&(r=await this.accessor.get(Lt).getTreatmentVariableAsync("vscode","copilotchat.useCodeSearch",!0)),r??!0}async getShouldUseRawChunks(){let r;return r=this.accessor.get(be).getConfig(ge.WorkspaceCodeSearchReturnRawChunks),r===void 0&&(r=await this.accessor.get(Lt).getTreatmentVariableAsync("vscode","copilotchat.codeSearchRawChunks",!0)),r??!1}initialized(){return this._embeddingsIndex.workspaceEmbeddingsInitialized()}async getSimilarFilesFromCodeSearch(r,n){let o=this.accessor.get(Ze).getWorkspaceFolders(),s=this.accessor.safeGet(Fo)?.repositories;if(!s){if(o.length)throw new Error("No repo contexts available for workspace folders");return}let a=[],c=new Map;for(let f=0;f<s.length;f++){let m=s[f];if(!m)continue;let h=$_(m)?.toLowerCase();h&&(a.push(h),c.set(h,o[f]))}if(!a.length)throw new Error("No repos to search through");let u=await this.getShouldUseRawChunks();if(n.isCancellationRequested)return[];let l;if(r.maySkipResolve?.())l=r.rawQuery;else{let f=await r.resolve(n);if(!f||n.isCancellationRequested)return[];l=f.rephrasedQuery}let d=await this._codeSearchClient.search(l,{repo:a},{rawChunks:u},n);return n.isCancellationRequested?void 0:(await this.processResults(c,[d])).flat().sort((f,m)=>m.score-f.score)}async processResults(r,n){let o=[];for(let s of n){if(s.errors.length){let a=!0;for(let c of r.keys()){let u=s.errors.filter(l=>l.repo===c);if(u){this._logger.debug(`[${c}] Errors when searching codesearch: ${u.map(HA)}`);continue}a=!1}if(a)throw s.errors.length===1?s.errors[0]:new AggregateError(s.errors)}for(let a of s.results){let c=a.repoOwner.toLowerCase()+"/"+a.repoName.toLowerCase(),u=r.get(c);if(!u){this._logger.error("Could not find workspace folder for repo",c);continue}let l=this._workspaceChunkIndex.get(lt.joinPath(u,a.path));l&&(await this.accessor.get(De).isCopilotIgnored(l.uri)||o.push({file:l.uri,score:a.score,text:a.contents,sources:[],range:new gt(a.range.start,0,a.range.end+1,0)}))}}return o}};B([bi(r=>r._logger)],Tb.prototype,"searchFileChunks",1),B([bi(r=>r._logger)],Tb.prototype,"getSimilarFilesFromCodeSearch",1);var X6=class X6 extends St{constructor(r,n=!1){super();this.id="ada";this.timeout=5e3;this._embeddingsIndex=r.get(nv),this._logger=r.get(ce).getLogger("EmbeddingsCacheChunkSearch"),n&&(this._embeddingsIndex.shouldSearchTimeout=!1)}static{this.FILE_CAP=200}async searchFileChunks(r,n,o,s){if(await this.initialized(),s.isCancellationRequested)return[];let a;if(r.maySkipResolve?.())a=r.rawQuery;else{let c=await r.resolve(s);if(!c||s.isCancellationRequested)return[];a=c.rephrasedQuery}return this._logger.debug("Fetching related workspace chunks in repository..."),await this._embeddingsIndex.searchAllChunks(a,n,s)}async isAvailable(){return this._isAvailable===void 0&&(this._isAvailable=this.doIsAvailable()),this._isAvailable}async doIsAvailable(){return await this.initialized(),this._embeddingsIndex.fileSystemFileCount<X6.FILE_CAP?(this.triggerIndexing(),!0):!1}initialized(){return this._embeddingsIndex.workspaceEmbeddingsInitialized()}triggerIndexing(){this._initializedWorkspacePromise||(this._logger.debug("Starting indexing"),this._initializedWorkspacePromise=this._embeddingsIndex.triggerIndexing(Fr.None).then(()=>{this._isAvailable=Promise.resolve(!0),this._logger.debug("Workspace Chunk Embeddings Index initialized.")}).catch(r=>{this._logger.warn(`Failed to index workspace: ${r}`),this._initializedWorkspacePromise=void 0}))}};B([bi(r=>r._logger)],X6.prototype,"searchFileChunks",1);var Q6=X6;var UCe=W(require("path"));function t2(t,e){if(!t)return t;if(Array.isArray(t))return t.map(r=>t2(r,e));if(typeof t=="object"){let r=e(t);if(r)return r;let n={};for(let o in t)n[o]=t2(t[o],e);return n}return t}var wXe=UCe.default.join(__dirname,"tfidfWorker.js"),lI=class extends St{constructor(r){super();this.id="tfidf";this.timeout=500;this._isDisposed=!1;this._tfIdfWorker=new Lo(()=>new ih(wXe,{name:"TfIdf Worker"})),this._logger=r.get(ce).getLogger("TfidfChunkSearch");let n=o=>{let s=this._workspaceIndex.get(o);s&&this.addOrUpdateTfidfEntries([s])};this._workspaceIndex=r.get(Tl),this._register(this._workspaceIndex.onDidCreateFile(n)),this._register(this._workspaceIndex.onDidChangeFile(n)),this._register(this._workspaceIndex.onDidDeleteFile(o=>{this._isDisposed||this._tfIdfWorker.value.proxy.delete(o)}))}dispose(){this._isDisposed=!0,super.dispose(),this._tfIdfWorker.rawValue?.terminate()}initialize(){return this._initializePromise??=this._initializeWorkspaceFiles(),this._initializePromise}async searchFileChunks(r,n,o,s){if(await Um(this.initialize(),s),s.isCancellationRequested||this._isDisposed)return[];let a=await r.resolve(s);if(!a||s.isCancellationRequested)return[];let c=a.keywords.flatMap(l=>[l.keyword,...l.variations]),u=await Zl(this._logger,"search",()=>this._tfIdfWorker.value.proxy.search([c.length?c.join(", "):a.rephrasedQuery],{maxResults:n,include:o.include,maxSpread:.75}));return kXe(u)}async isAvailable(){return await this.initialize(),!0}async _initializeWorkspaceFiles(){await Zl(this._logger,"initialize workspaceIndex",()=>this._workspaceIndex.initialize()),!this._isDisposed&&await Zl(this._logger,"initialize tfidf",()=>this.addOrUpdateTfidfEntries(this._workspaceIndex.values()))}async addOrUpdateTfidfEntries(r){if(this._isDisposed)return;let n=new E_(20),o;try{o=await Promise.all(Array.from(r,s=>n.queue(async()=>({uri:s.uri,content:await s.getText(Fr.None)}))))}finally{n.dispose()}this._isDisposed||this._tfIdfWorker.value.proxy.addOrUpdate(RXe(o))}};B([bi(r=>r._logger)],lI.prototype,"initialize",1),B([bi(r=>r._logger)],lI.prototype,"searchFileChunks",1);function RXe(t){return t2(t,e=>{if(lt.isUri(e))return{$mid:"uri",...e};if(e instanceof gt)return{startLineNumber:e.startLineNumber,startColumn:e.startColumn,endLineNumber:e.endLineNumber,endColumn:e.endColumn}})}function kXe(t){return t2(t,e=>{if(e.$mid==="range")return new gt(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn);if(e.$mid==="uri")return lt.revive(e)})}var r2=class extends St{constructor(r){super();this.accessor=r;this.id="tfidf";this.timeout=500;this._tfidf=this._register(new lI(r)),this._logger=r.get(ce).getLogger("TfIdfWithSemanticChunkSearch")}async searchFileChunks(r,n,o,s){this._logger.debug("Performing full workspace search for chunks...");let c=await this._tfidf.searchFileChunks(r,n*2,o,s);if(s.isCancellationRequested||!c.length)return[];let u=await Zl(this._logger,"toSemanticChunks",()=>Y6(this.accessor,c,s));return s.isCancellationRequested||!u.length?[]:u}isAvailable(){return this._tfidf.isAvailable()}};B([bi(r=>r._logger)],r2.prototype,"searchFileChunks",1);var iv=se("IWorkspaceChunkSearch"),tm=class{constructor(e,r){this._forcedChunkSearchStrategy=e;this._accessor=r;this._workspaceChunkEmbeddingsIndex=this._accessor.get(nv);this._logger=this._accessor.get(ce).getLogger("WorkspaceChunkSearch");this._simulationTestContext=this._accessor.get(UE),this._embeddingsCacheChunkSearch=new Q6(r,this._simulationTestContext.isInSimulationTests),this._codeSearchChunkSearch=new Tb(r),this._tfIdfWithSemanticChunkSearch=new r2(r)}dispose(){this._embeddingsCacheChunkSearch.dispose(),this._codeSearchChunkSearch.dispose(),this._tfIdfWithSemanticChunkSearch.dispose()}async triggerIndexing(){await Promise.allSettled([this._tfIdfWithSemanticChunkSearch.isAvailable(),this._embeddingsCacheChunkSearch.isAvailable()])}async searchFileChunks(e,r,n,o,s,a){let c=await this.getStrategies();if(s.isCancellationRequested)return[];let u=c.map(b=>nU(async S=>({chunks:await b.searchFileChunks(r,n,o,S),strategy:b.id})));s.onCancellationRequested(()=>u.forEach(b=>b.cancel()));for(let b of u)b.then(S=>{for(let I=0;I<u.length;I++)S.strategy==="ada"?u[I].cancel():d0(u[I].catch(()=>{}),c[I].timeout,()=>{u[I].cancel(),this._logger.warn(`WorkspaceChunkSearch strategy ${c[I].id} timed out`)})},()=>{});let l=await Um(Promise.allSettled(u),s);if(s.isCancellationRequested||!l)return[];let d=[],p;for(let b=0;b<l.length;b++){let S=l[b],I=c[b];if(S.status==="fulfilled"){(!p||S.value.strategy==="ada")&&(p=S.value.strategy),d.push(S.value);continue}if(this._logger.debug(`Strategy, ${I.id}, failed with the following error: ${HA(S.reason)}`),S.status==="rejected"&&S.reason instanceof Jk&&I instanceof Tb)try{if(await this._accessor.get(Nn).getPermissiveGitHubSession({silent:!0}))continue;if((await this._accessor.get(Nn).getPermissiveGitHubSession({forceNewSession:{detail:zQ.t("To show you more relevant Copilot Chat results, we need permission to read the contents of your repository on GitHub."),learnMore:lt.parse("https://aka.ms/copilotRepoScope")}}))?.accessToken){let O=await I.searchFileChunks(r,n,o,s);p=I.id,d.unshift({chunks:O,strategy:I.id})}}catch{}}this._logger.debug(`'${p}' was the top working workspace chunk search strategy`),this._accessor.get(me).sendMSFTTelemetryEvent("workspaceChunkSearchStrategy",{strategy:p??"none",allAttemptedStrategies:c.map(b=>b.id).join(","),allSuccessfulStrategies:l.filter(b=>b.status==="fulfilled").map(b=>b.value.strategy).join(",")});let m=this._accessor.get(De),h=await Promise.all(d.map(async b=>({...b,chunks:Kt(await Promise.all(b.chunks.map(async S=>await m.isCopilotIgnored(S.file)?null:S)))})));if(this._simulationTestContext.isInSimulationTests&&!h.some(b=>b.chunks.length>0))throw new Error("No chunks returned");function g(b){return b.map(S=>S.text).join(`

-----------------

`)}let v=async(b,S)=>{this._simulationTestContext.isInSimulationTests&&await this._accessor.get(UE).writeFile(b+".txt",g(S),b)},y=h.flatMap(b=>b.chunks);v("workspace-chunk-search-pre-rerank",y);let _=await this.rerankChunks(e,r,h.flat(),n,s,a);return v("workspace-chunk-search-post-rerank",_),_}async rerankChunks(e,r,n,o,s,a){let c=n.find(u=>u.strategy==="ada");return c?c.chunks.slice(0,o):(a?.(zQ.t("Filtering to most relevant information")),this._accessor.get(be).getConfig(ge.WorkspaceRerankStrategy)==="model"?this.sortChunksUsingModel(e,r,n.flatMap(u=>u.chunks),o,s):await this.getShouldUseAda()?s.isCancellationRequested?[]:this.rerankChunksUsingAda(r,n,o,s):n.flatMap(u=>u.chunks).slice(0,o))}async rerankChunksUsingAda(e,r,n,o){try{let s=await e.resolve(o);if(!s||o.isCancellationRequested)return[];let a=r.flatMap(d=>d.chunks.map(p=>({...p,strategy:d.strategy}))).map((d,p)=>({...d,index:p})),c=await this._workspaceChunkEmbeddingsIndex.searchChunks(a,s.rephrasedQuery,n,o),u=this._accessor.get(me),l=c.filter(d=>d.index<n).length;return u.sendMSFTTelemetryEvent("workspaceChunkSearch.adaRerank",{allStrategies:r.filter(d=>d.chunks.length).map(d=>d.strategy).join(","),topChunkInitialIndices:c.map(d=>d.index).join(","),topChunkStrategies:c.map(d=>d.strategy).join(",")},{originalChunkCount:a.length,maxResultCount:n,originalTopInTopAfterRerank:l/n}),c}catch(s){return this._logger.warn("Failed to search chunk embeddings index: ",s),r.flatMap(a=>a.chunks).slice(0,n)}}async sortChunksUsingModel(e,r,n,o,s){let a=await r.resolve(s);if(!a||s.isCancellationRequested)return[];let c=this._accessor.get(jt),u=[];for(let l=0;l<n.length;l+=o){let d=n.slice(l,l+o),p=[...u,...d];ire(p);let f=await c.fetchOne([{role:"system",content:`
The user will provide you with question and a numbered list of code snippets.
You are to sort the code snippets by most to least helpful in answering the question.
If a code snippet is not related to the question in possible any way, you may opt not to include it in the list.
Return an ordered list of snippet numbers.
Only return snippet numbers.
Do not explain.
				`.trim()},{role:"user",content:`
Question: ${a.rephrasedQuery}

${p.map((h,g)=>`# Snippet ${g}
 ${ki("",h.text)}`).join(`

`)}
					`.trim()}],async h=>{},s,2,e,{agent:Up},{temperature:.1,top_p:1,stop:["dontStopBelieving"]},{messageSource:"workspaceChunkRerank"});if(s.isCancellationRequested)return[];if(f.type!=="success"){console.warn("Model re-rank failed");continue}let m=new Set(Array.from(f.value.matchAll(/\d+/g),h=>parseInt(h[0])));u=Kt(Array.from(m).map(h=>p.at(h))).slice(0,o)}return u}async getStrategies(){let e=new Array;switch(this._forcedChunkSearchStrategy){case"codesearch":e.push(this._codeSearchChunkSearch);break;case"ada":e.push(this._embeddingsCacheChunkSearch);break;case"tfidf":e.push(this._tfIdfWithSemanticChunkSearch);break;default:await this._codeSearchChunkSearch.isAvailable()&&e.push(this._codeSearchChunkSearch),await this.getShouldUseAda()&&await this._embeddingsCacheChunkSearch.isAvailable()&&e.push(this._embeddingsCacheChunkSearch),e.push(this._tfIdfWithSemanticChunkSearch);break}return this._logger.debug(`Using ${e.map(r=>r.id).join(", ")} for chunk search`),e}async getShouldUseAda(){let e=this._accessor.get(be).getConfig(ge.WorkspaceUseAdaEnabled);return e!==void 0?e:await this._accessor.get(Lt).getTreatmentVariableAsync("vscode","copilotchat.workspaceUseAda",!0)??!0}};B([bi(e=>e._logger),x0(function(e,r){this._accessor.get(me).sendMSFTTelemetryEvent("workspaceChunkSearch.perf.triggerIndexing",{status:r},{execTime:e})})],tm.prototype,"triggerIndexing",1),B([bi(e=>e._logger),x0(function(e,r){this._accessor.get(me).sendMSFTTelemetryEvent("workspaceChunkSearch.perf.searchFileChunks",{status:r},{execTime:e})})],tm.prototype,"searchFileChunks",1),B([bi(e=>e._logger),x0(function(e,r){this._accessor.get(me).sendMSFTTelemetryEvent("workspaceChunkSearch.perf.adaRerank",{status:r},{execTime:e})})],tm.prototype,"rerankChunksUsingAda",1),tm=B([T(1,rt)],tm);var BCe=require("vscode");var n2=class{static{this.version=1}#t;constructor(e){this.#t=e}async selectScope(e,r){if(e??=BCe.window.activeTextEditor,!!e)return this.#t.get(sh).selectEnclosingScope(e,r)}};var GQ=class extends St{constructor(){super(...arguments);this._contextCtors=[];this._contextResolvers=new Map;this._initialized=!1}get contextResolvers(){return this._contextResolvers.values()}getContextResolver(r){return this._contextResolvers.get(r)}register(r){if(typeof r=="function"){this._handleCtor(r);return}else return this._contextResolvers.set(r.kind,r),$A(r)&&this._register(r),r}initialize(r){if(this._initialized)return St.None;for(this._initialized=!0,this._accessor=r;this._contextCtors.length;){let n=this._contextCtors.pop();this._handleCtor(n)}return this}_handleCtor(r){if(!this._accessor){this._contextCtors.push(r);return}try{let n=this._accessor.createInstance(r);this.register(n)}catch(n){console.error(n)}}},en=new GQ;var uX=W(ct());var tTe=W(ct()),Y=class extends tTe.PromptElement{constructor(e,r){super(e),this.accessor=r}};var p8="vscodeApi",rTe=class extends Y{static{this.variableInfo={name:p8,description:"Use VS Code API references to answer questions about VS Code extension development.",defaultEnablement:!0}}async prepare(e,r,n){let o=this.accessor.get(Mo),s=this.accessor.get(o2),a=await this.accessor.get(Le).getEmbeddingsEndpoint("ada");if(await s.updateIndex(),n.isCancellationRequested)return;let c=await o.computeEmbeddings(a,[this.props.query],{},n);if(!n.isCancellationRequested&&c&&c.length>0){let u=s.nClosestValues(c[0],5,.7);if(u.length)return{snippets:u}}}render(e,r){return vscpp(vscppf,null,e&&e.snippets.length>0&&vscpp(uX.UserMessage,{priority:900},"Below are some potentially relevant code samples related to VS Code extension development. You may use information from these samples to help you answer the question if you believe it is relevant."),e&&e.snippets.map(n=>vscpp(uX.UserMessage,{priority:900},n,vscpp("br",null))))}};var mI=class{constructor(e){let r=_0(e.get(Pt).getEditorInfo().version);this.embeddingsCache=new th(e,1,"api",r,"api")}async updateIndex(){this.apiChunks=await this.embeddingsCache.getCache()}nClosestValues(e,r,n=0){if(!this.apiChunks)return[];let o=this.apiChunks.map(s=>{if(!s.embedding)return{text:s.text,similarity:0};let a=eh(e,s.embedding);return{text:this.toContextString(s),similarity:a}});return o=o.filter(s=>s.similarity>n),o.sort((s,a)=>a.similarity-s.similarity),o.slice(0,r).map(s=>s.text)}toContextString(e){return e.type==="code"?`API Reference Code Snippet from vscode.d.ts:
${ki(e.lang,e.text)}`:e.type==="command"?`${e.text}`:e.type==="documentationCodeBlock"?`Example code from VS Code documentation:
${ki(e.lang,e.text)}`:""}};mI=B([T(0,rt)],mI);var o2=se("IApiEmbeddingsIndex"),lX=class{constructor(){this.kind="extension-api";this.variableInfo={name:p8,icon:"references",fullName:"VS Code API",description:"Use VS Code API references to answer questions about VS Code extension development.",defaultEnablement:!0};this.metaContextResolverInfo={description:"Use VS Code API references to answer questions about VS Code extension development."}}async resolveContext(e,r,n){if(!r.message)return;let o=r.message.replace(`#${p8}`,"").trim(),s=e.get(o2);if(await s.updateIndex(),n.isCancellationRequested)return;let a=e.get(Mo),u=await e.get(Le).getEmbeddingsEndpoint("ada"),l=await a.computeEmbeddings(u,[o],{},n);if(!n.isCancellationRequested&&l&&l.length>0){let d=s.nClosestValues(l[0],5,.7);if(d.length)return{kind:this.kind,userMessages:[`Below are some potentially relevant code samples related to VS Code extension development. You may use information from these samples to help you answer the question if you believe it is relevant.
`,...d]}}}},bWt=en.register(new lX);var oTe=W(Tr()),sTe=W(ct());var s2=W(Tr());var dX=W(ct()),Eo=W(ct());var rc=class{toString(){return Object.getPrototypeOf(this).constructor.name}},sp=class{constructor(e,r){this.request=e;this.sessionId=r;this.status="in-progress";this.contextParts=[];this.references=[]}addReferences(e){this.references=f8([...this.references,...e])}},Pc=class t{constructor(e=[]){this.turns=e}copy(){let e=JSON.parse(JSON.stringify(this.turns));return new t(e)}getLatestTurn(){return this.turns[this.turns.length-1]}addTurn(e){this.turns.forEach(r=>r.chatMessages=[]),this.turns.push(e)}removeTurn(e){let r=this.turns.findIndex(n=>n.requestId===e);if(r!==-1)return this.turns.splice(r,1)[0]}insertBeforeLatestTurn(e){this.turns.splice(this.turns.length-1,0,...e)}getState(){return{turns:this.turns}}};function f8(t){let e=new Pn,r=[],n=(s,a)=>{if(s.contains(a))return s;if(a.contains(s))return a;let[c,u]=s.start.line<a.start.line?[s,a]:[a,s];if(c.end.line>=u.start.line-1)return new ze(c.start,u.end)};return t.forEach(s=>{let a=s.anchor;if("variableName"in a)r.push(s);else if(!nTe(a))e.set(a,s);else{let c=e.get(a.uri);if(!c)e.set(a.uri,[s]);else if(!(c instanceof dX.PromptReference)){let u=[],l=a.range;c.forEach(p=>{if("variableName"in p.anchor||!nTe(p.anchor))return;let f=n(l,p.anchor.range);f?l=f:u.push(p.anchor)});let d={uri:a.uri,range:l};e.set(a.uri,[...u,d].sort((p,f)=>p.range.start.line-f.range.start.line||p.range.end.line-f.range.end.line).map(p=>new dX.PromptReference(p)))}}}),[...Array.from(e.keys()).sort((s,a)=>s.fsPath.localeCompare(a.fsPath)).map(s=>{let a=e.get(s);return a||[]}).flat(),...r]}function nTe(t){return"uri"in t&&"range"in t}function m8(t,e=!0){switch(t){case"snippy":return e?s2.t({message:"Sorry, the response matched public code so it was blocked. Please rephrase your prompt. [Learn more](https://aka.ms/copilot-chat-filtered-docs).",comment:["{Locked='](https://aka.ms/copilot-chat-filtered-docs)'}"]}):s2.t("Sorry, the response matched public code so it was blocked. Please rephrase your prompt.");default:return e?s2.t({message:"Sorry, the response was filtered by the Responsible AI Service. Please rephrase your prompt and try again. [Learn more](https://aka.ms/copilot-chat-filtered-docs).",comment:["{Locked='](https://aka.ms/copilot-chat-filtered-docs)'}"]}):s2.t("Sorry, the response was filtered by the Responsible AI Service. Please rephrase your prompt and try again.")}}var Yo=class{constructor(e,r,n){this.intent=e;this.location=r;this.endpoint=n}async buildPrompt(e,r,n,o,s){return await(await this.createRenderer(e,this.endpoint,r,n,o,s)).render(n,s)}},Xe=class extends sTe.PromptRenderer{constructor(r,n,o,s,a){super(r,n,o,s);this.accessor=a}createElement(r,...n){return this.accessor.get(or).createInstance(r.ctor,r.props,this.accessor,...n)}async render(r,n){let o=await super.render(r,n),s=o.messages[o.messages.length-1];if(s&&s.role!=="user"&&s.role!=="function")throw new Error(oTe.t("Sorry, this message is too long. Please try a shorter question."));return{...o,references:f8(o.references)}}async countTokens(r){return(await super.render(void 0,r)).tokenCount}};async function _s(t,e,r,n,o,s,a){let c=new Xe(e,r,n,o,t),{messages:u,tokenCount:l,references:d}=await c.render(s,a),p=c.getAllMeta(),f=c.getUsedContext();return{messages:u,tokenCount:l,metadatas:p,usedContext:f,references:f8(d)}}var cTe=W(ct());var aTe=require("util");var h8=se("IPromptWorkspaceLabels");var hI=class{constructor(e,r,n,o){this._experimentationService=e;this._configurationService=r;this._telemetryService=n;this._instantiationService=o;this.strategy=0;this.basicWorkspaceLabels=this._instantiationService.createInstance(gI),this.expandedWorkspaceLabels=this._instantiationService.createInstance(a2)}get workspaceLabels(){return this.strategy===0?this.basicWorkspaceLabels:this.expandedWorkspaceLabels}get labels(){return[...new Set(this.workspaceLabels.labels)].sort()}async collectContext(){let e=await this._configurationService.getExperimentBasedConfig(ge.ProjectLabelsExpanded,this._experimentationService);this.strategy=e?1:0,await this.workspaceLabels.collectContext();let r=[...new Set(this.labels)].sort();this._telemetryService.sendMSFTTelemetryEvent("projectLabels",{labels:r.join(",").replaceAll("@"," ")},{count:r.length})}};hI=B([T(0,Lt),T(1,be),T(2,me),T(3,or)],hI);var gI=class{constructor(e,r,n){this._workspaceService=e;this._fileSystemService=r;this._ignoreService=n;this.indicators=new Map;this.contentIndicators=new Map;this._labels=[];this.initIndicators()}get labels(){if(this._labels.includes("javascript")&&this._labels.includes("typescript")){let e=this._labels.indexOf("javascript");this._labels.splice(e,1)}return this._labels}async collectContext(){let e=this._workspaceService.getWorkspaceFolders();if(e)for(let r=0;r<e.length;r++)await this.addContextForFolders(e[r])}async addContextForFolders(e){for(let[r,n]of this.indicators.entries())await this.addLabelIfApplicable(e,r,n)}async addLabelIfApplicable(e,r,n){let o=pn.joinPath(e,r);if(!await this._ignoreService.isCopilotIgnored(o))try{await this._fileSystemService.stat(o),n.forEach(a=>this._labels.push(a));let s=this.contentIndicators.get(r);if(s){let a=await this._fileSystemService.readFile(o);try{s(new aTe.TextDecoder().decode(a)).forEach(u=>this._labels.push(u))}catch{}}}catch{}}initIndicators(){this.addIndicator("package.json","javascript","npm"),this.addIndicator("tsconfig.json","typescript"),this.addIndicator("pom.xml","java","maven"),this.addIndicator("build.gradle","java","gradle"),this.addIndicator("requirements.txt","python","pip"),this.addIndicator("Pipfile","python","pip"),this.addIndicator("Cargo.toml","rust","cargo"),this.addIndicator("go.mod","go","go.mod"),this.addIndicator("pubspec.yaml","dart","pub"),this.addIndicator("build.sbt","scala","sbt"),this.addIndicator("build.boot","clojure","boot"),this.addIndicator("project.clj","clojure","lein"),this.addIndicator("mix.exs","elixir","mix"),this.addIndicator("composer.json","php","composer"),this.addIndicator("Gemfile","ruby","bundler"),this.addIndicator("build.xml","java","ant"),this.addIndicator("build.gradle.kts","java","gradle"),this.addIndicator("yarn.lock","yarn"),this.addIndicator("CMakeLists.txt","c++","cmake"),this.addIndicator("vcpkg.json","c++"),this.addIndicator("Makefile","c++","makefile"),this.addContentIndicator("CMakeLists.txt",this.collectCMakeListsTxtIndicators),this.addContentIndicator("package.json",this.collectPackageJsonIndicators)}addIndicator(e,...r){this.indicators.set(e,r)}addContentIndicator(e,r){this.contentIndicators.set(e,r)}collectCMakeListsTxtIndicators(e){function r(a,c,u){try{let l=Array.from(a.matchAll(c));if(l&&l[0]&&l[0][1]){let d=parseInt(l[0][1]);if(u.includes(d))return d}}catch{}}let n=[],o=r(e,/set\s*\(\s*CMAKE_CXX_STANDARD\s*(\d+)/gmi,[98,11,14,17,20,23,26]);o&&n.push(`C++${o}`);let s=r(e,/set\s*\(\s*CMAKE_C_STANDARD\s*(\d+)/gmi,[90,99,11,17,23]);return s&&n.push(`C${s}`),n}collectPackageJsonIndicators(e){let r=[],n=JSON.parse(e),o=n.dependencies,s=n.devDependencies;o&&(o["@angular/core"]&&r.push("angular"),o.react&&r.push("react"),o.vue&&r.push("vue")),s&&s.typescript&&r.push("typescript");let a=n.engines;return a&&(a.node&&r.push("node"),a.vscode&&r.push("vscode extension")),r}};gI=B([T(0,Ze),T(1,on),T(2,De)],gI);var a2=class extends gI{constructor(r,n,o){super(r,n,o);this.popularPackages=["numpy","pandas","scipy","scikit-learn","matplotlib","tensorflow","keras","torch","seaborn","plotly","dash","jupyter","notebook","ipython","openai","pyspark","airflow","nltk","sympy","spacy","langchain","Flask","Django","fastapi","pydantic","requests","beautifulsoup4","gunicorn","uvicorn","httpx","Jinja2","aiohttp","pytest","tox","nox","selenium","playwright","coverage","hypothesis","Sphinx","celery","asyncio","boto3","google-cloud-storage","azure-storage-blob","docker","kubernetes","azure","google","ansible","cryptography","paramiko","PyJWT","xlrd","xlrd-2024","openpyxl","pywin32","pywin","psycopg2","mysqlclient","SQLite4","Werkzeug","pymongo","redis","PyMySQL","Pillow","SQLAlchemy","lxml","html5lib","Markdown","pytz","Click","attrs","PyYAML","configparser","loguru","structlog","pygame","discord"];this.addContentIndicator("package.json",this.collectPackageJsonIndicatorsExpanded),this.addContentIndicator("requirements.txt",this.collectPythonRequirementsIndicators),this.addContentIndicator("pyproject.toml",this.collectPythonTomlIndicators)}collectPackageJsonIndicatorsExpanded(r){let n=[],o=d=>{let[p,f]=d.split(".");return`${p.replace(/[^0-9]/g,"")}.${f.replace(/[^0-9]/g,"")}`},s=(d,p)=>{d&&p.forEach(({dependency:f,prefix:m})=>{if(d[f]){let h=o(d[f]);n.push(`${m||f}@${h}`)}})},a;try{a=JSON.parse(r)}catch{return n}let c=[a.dependencies,a.devDependencies,a.peerDependencies,a.optionalDependencies],u=[{dependency:"react"},{dependency:"vue"},{dependency:"@angular/core"},{dependency:"svelte"},{dependency:"solid-js"},{dependency:"alpinejs"},{dependency:"redux"},{dependency:"mobx"},{dependency:"vuex"},{dependency:"ngrx"},{dependency:"antd"},{dependency:"bootstrap"},{dependency:"bulma"},{dependency:"@mui/material"},{dependency:"semantic-ui-react"},{dependency:"next"},{dependency:"gatsby"},{dependency:"remix"},{dependency:"astro"},{dependency:"sveltekit"},{dependency:"nuxt"},{dependency:"jest"},{dependency:"mocha"},{dependency:"cypress"},{dependency:"@testing-library/react"},{dependency:"@playwright/test"},{dependency:"vitest"},{dependency:"@storybook/react"},{dependency:"tailwindcss"},{dependency:"sass"},{dependency:"styled-components"},{dependency:"css-modules"},{dependency:"postcss"},{dependency:"@emotion/react"},{dependency:"vite"},{dependency:"webpack"},{dependency:"parcel"},{dependency:"rollup"},{dependency:"snowpack"},{dependency:"esbuild"},{dependency:"@swc/core"},{dependency:"socket.io"},{dependency:"d3"},{dependency:"graphql"},{dependency:"lodash"},{dependency:"moment"},{dependency:"rxjs"},{dependency:"underscore"},{dependency:"gulp"},{dependency:"backbone"},{dependency:"ember-source"},{dependency:"handlebars"},{dependency:"jquery"},{dependency:"knockout"},{dependency:"aws-sdk"},{dependency:"cloudinary"},{dependency:"firebase"},{dependency:"@azure/storage-blob"},{dependency:"@google-cloud/storage"},{dependency:"@aws-lambda"},{dependency:"@azure/functions"},{dependency:"@google-cloud/functions"},{dependency:"firebase-functions"},{dependency:"@azure/cosmos"},{dependency:"@google-cloud/firestore"},{dependency:"mongoose"},{dependency:"dockerode"},{dependency:"kubernetes-client"},{dependency:"@elastic/elasticsearch"},{dependency:"@sentry/node"},{dependency:"log4js"},{dependency:"winston"},{dependency:"bcrypt"},{dependency:"helmet"},{dependency:"jsonwebtoken"},{dependency:"passport"},{dependency:"@azure/identity"},{dependency:"@azure/keyvault-certificates"},{dependency:"@azure/keyvault-keys"},{dependency:"@azure/keyvault-secrets"},{dependency:"@azure/service-bus"},{dependency:"@azure/event-hubs"},{dependency:"@azure/data-tables"},{dependency:"@azure/monitor-query"},{dependency:"@azure/app-configuration"},{dependency:"babel"},{dependency:"eslint"},{dependency:"parcel"},{dependency:"prettier"},{dependency:"rollup"},{dependency:"typescript"},{dependency:"webpack"},{dependency:"vite"}],l=[{dependency:"node"},{dependency:"vscode",prefix:"vscode extension"}];return c.forEach(d=>s(d,u)),s(a.engines,l),n}collectPythonRequirementsIndicators(r){let n=[];return r.split(`
`).forEach(s=>{let[a,c]=s.split("==");this.popularPackages.includes(a)&&n.push(`${a}-${c||"latest"}`)}),n}collectPythonTomlIndicators(r){let n=[],o=r.split(`
`),s=!1;return o.forEach(a=>{if(a=a.trim(),a==="[tool.poetry.dependencies]")s=!0;else if(a.startsWith("[")&&a.endsWith("]"))s=!1;else if(s&&a){let[c,u]=a.split("=").map(l=>l.trim().replace(/"|'/g,""));this.popularPackages.includes(c)&&n.push(`${c}-${u||"latest"}`)}}),n}};a2=B([T(0,Ze),T(1,on),T(2,De)],a2);var Qo=class extends Y{constructor(r,n,o){super(r,n);this.workspaceLabels=o}async prepare(){return await this.workspaceLabels.collectContext(),{labels:this.workspaceLabels.labels}}render(r,n){if(r.labels.length!==0)return vscpp(vscppf,null,vscpp(cTe.UserMessage,{priority:this.props.priority},"I am working on a project of the following nature:",vscpp("br",null),r.labels.reduce((o,s)=>`${o}
- ${s}`,"").trim()))}};Qo=B([T(2,h8)],Qo);var pX=class{constructor(){this.kind="project-labels"}async resolveContext(e,r){let{messages:n}=await _s(e,r.endpoint,Qo,{},e.get(ve).acquireTokenizer(r.endpoint.family));if(n.length>0)return{kind:this.kind,userMessages:n.map(o=>o.content)}}},dKt=en.register(new pX);var It=W(require("vscode"));var vI={workspace:{explain:"explain",review:"review",tests:"tests",fix:"fix",new:"new",newNotebook:"newNotebook",semanticSearch:"semanticSearch",fixTestFailure:"fixTestFailure"},vscode:{search:"search",runCommand:"runCommand"},terminal:{explain:"terminalExplain"}};function uTe(t){if(Object.keys(vI).includes(t))return{agent:t};for(let[e,r]of Object.entries(vI))if(Object.values(r).includes(t))return{agent:e,command:t}}var Rb="GitHub.copilot-chat";var ov=se("IConversationStore"),g8=class{constructor(){this.conversationMap=new Map}addConversation(e,r){this.conversationMap.set(e,r)}getConversation(e){return this.conversationMap.get(e)}};var eEe=W(Tr());var yI=se("IDiffService");var Xt=class t{constructor(e,r){this.start=e;this.endExclusive=r;if(e>r)throw new Qr(`Invalid range: ${this.toString()}`)}static addRange(e,r){let n=0;for(;n<r.length&&r[n].endExclusive<e.start;)n++;let o=n;for(;o<r.length&&r[o].start<=e.endExclusive;)o++;if(n===o)r.splice(n,0,e);else{let s=Math.min(e.start,r[n].start),a=Math.max(e.endExclusive,r[o-1].endExclusive);r.splice(n,o-n,new t(s,a))}}static tryCreate(e,r){if(!(e>r))return new t(e,r)}static ofLength(e){return new t(0,e)}static ofStartAndLength(e,r){return new t(e,e+r)}get isEmpty(){return this.start===this.endExclusive}delta(e){return new t(this.start+e,this.endExclusive+e)}deltaStart(e){return new t(this.start+e,this.endExclusive)}deltaEnd(e){return new t(this.start,this.endExclusive+e)}get length(){return this.endExclusive-this.start}toString(){return`[${this.start}, ${this.endExclusive})`}equals(e){return this.start===e.start&&this.endExclusive===e.endExclusive}containsRange(e){return this.start<=e.start&&e.endExclusive<=this.endExclusive}contains(e){return this.start<=e&&e<this.endExclusive}join(e){return new t(Math.min(this.start,e.start),Math.max(this.endExclusive,e.endExclusive))}intersect(e){let r=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);if(r<=n)return new t(r,n)}intersects(e){let r=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);return r<n}intersectsOrTouches(e){let r=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);return r<=n}isBefore(e){return this.endExclusive<=e.start}isAfter(e){return this.start>=e.endExclusive}slice(e){return e.slice(this.start,this.endExclusive)}substring(e){return e.substring(this.start,this.endExclusive)}clip(e){if(this.isEmpty)throw new Qr(`Invalid clipping range: ${this.toString()}`);return Math.max(this.start,Math.min(this.endExclusive-1,e))}clipCyclic(e){if(this.isEmpty)throw new Qr(`Invalid clipping range: ${this.toString()}`);return e<this.start?this.endExclusive-(this.start-e)%this.length:e>=this.endExclusive?this.start+(e-this.start)%this.length:e}map(e){let r=[];for(let n=this.start;n<this.endExclusive;n++)r.push(e(n));return r}forEach(e){for(let r=this.start;r<this.endExclusive;r++)e(r)}};var Ru=class{get lines(){return this._lineStartOffsets.length}constructor(e){this._lineStartOffsets=[0];let r=0;for(;;){let n=e.indexOf(`
`,r);if(n===-1)break;this._lineStartOffsets.push(n+1),r=n+1}}lineLength(e){return this._lineStartOffsets[e]-this._lineStartOffsets[e-1]-1}offsetToPosition(e){let r=1;for(;r<this._lineStartOffsets.length&&!(this._lineStartOffsets[r]>e);r++);let n=e-this._lineStartOffsets[r-1];return new qr(r,n+1)}startOffsetOfLineContaining(e){let r=1;for(;r<this._lineStartOffsets.length&&!(this._lineStartOffsets[r]>e);r++);return this._lineStartOffsets[r-1]}positionToOffset(e){return e.lineNumber>=this._lineStartOffsets.length?this._lineStartOffsets[this._lineStartOffsets.length-1]+e.column-1:this._lineStartOffsets[e.lineNumber-1]+e.column-1}};var Zn=class t{constructor(e){this.edits=e;let r=-1;for(let n of e){if(!(n.replaceRange.start>=r))throw new Error(`Edits must be disjoint and sorted. Found ${n} after ${r}`);r=n.replaceRange.endExclusive}}static{this.empty=new t([])}static fromJson(e){return new t(e.map(wo.fromJson))}static from(e){let r=e.map(o=>new wo(Xt.ofStartAndLength(o.rangeOffset,o.rangeLength),o.text));return r.reverse(),new t(r)}static single(e,r){return new t([new wo(e,r)])}static async fromDiff(e,r,n){let o=await n.computeDiff(e,r,{maxComputationTimeMs:5e3,computeMoves:!1,ignoreTrimWhitespace:!1}),s=new Ru(e),a=new Ru(r),c=[];for(let u of o.changes)for(let l of u.innerChanges??[]){let d=a.positionToOffset(l.modifiedRange.getStartPosition()),p=a.positionToOffset(l.modifiedRange.getEndPosition()),f=r.substring(d,p),m=s.positionToOffset(l.originalRange.getStartPosition()),h=s.positionToOffset(l.originalRange.getEndPosition()),g=new Xt(m,h);c.push(new wo(g,f))}return new t(c)}normalize(){let e=[],r;for(let n of this.edits)n.newText.length===0&&n.replaceRange.length===0||(r&&r.replaceRange.endExclusive===n.replaceRange.start?r=new wo(r.replaceRange.join(n.replaceRange),r.newText+n.newText):(r&&e.push(r),r=n));return r&&e.push(r),new t(e)}toString(){return`[${this.edits.map(r=>r.toString()).join(", ")}]`}apply(e){let r=[],n=0;for(let o of this.edits)r.push(e.substring(n,o.replaceRange.start)),r.push(o.newText),n=o.replaceRange.endExclusive;return r.push(e.substring(n)),r.join("")}compose(e){return HXe(this,e)}inverse(e){let r=[],n=0;for(let o of this.edits)r.push(new wo(Xt.ofStartAndLength(o.replaceRange.start+n,o.newText.length),e.substring(o.replaceRange.start,o.replaceRange.endExclusive))),n+=o.newText.length-o.replaceRange.length;return new t(r)}getNewTextRanges(){let e=[],r=0;for(let n of this.edits)e.push(Xt.ofStartAndLength(n.replaceRange.start+r,n.newText.length)),r+=n.newText.length-n.replaceRange.length;return e}get isEmpty(){return this.edits.length===0}tryRebase(e){let r=[],n=0,o=0,s=0;for(;o<this.edits.length||n<e.edits.length;){let a=e.edits[n],c=this.edits[o];if(c)a?c.replaceRange.intersects(a.replaceRange)?o++:c.replaceRange.start<a.replaceRange.start?(r.push(new wo(c.replaceRange.delta(s),c.newText)),o++):(n++,s+=a.newText.length-a.replaceRange.length):(r.push(new wo(c.replaceRange.delta(s),c.newText)),o++);else break}return new t(r)}removeCommonSuffixPrefix(e){let r=[];for(let n of this.edits){let o=n.removeCommonSuffixPrefix(e);o.isEmpty||r.push(o)}return new t(r)}applyToOffset(e){let r=0;for(let n of this.edits)if(n.replaceRange.start<=e){if(e<n.replaceRange.endExclusive)return n.replaceRange.start+r;r+=n.newText.length-n.replaceRange.length}else break;return e+r}applyToOffsetRange(e){return new Xt(this.applyToOffset(e.start),this.applyToOffset(e.endExclusive))}applyInverseToOffset(e){let r=0;for(let n of this.edits){let o=n.newText.length;if(n.replaceRange.start<=e-r){if(e-r<n.replaceRange.start+o)return n.replaceRange.start;r+=o-n.replaceRange.length}else break}return e-r}},wo=class t{constructor(e,r){this.replaceRange=e;this.newText=r}static fromJson(e){return new t(Xt.ofStartAndLength(e.pos,e.len),e.txt)}toString(){return`${this.replaceRange} -> "${this.newText}"`}removeCommonSuffixPrefix(e){let r=e.substring(this.replaceRange.start,this.replaceRange.endExclusive),n=aP(r,this.newText),o=Math.min(r.length-n,this.newText.length-n,Mre(r,this.newText)),s=new Xt(this.replaceRange.start+n,this.replaceRange.endExclusive-o),a=this.newText.substring(n,this.newText.length-o);return new t(s,a)}get isEmpty(){return this.newText.length===0&&this.replaceRange.length===0}};function HXe(t,e){if(t=t.normalize(),e=e.normalize(),t.isEmpty)return e;if(e.isEmpty)return t;let r=[...t.edits],n=[],o=0;for(let s of e.edits){for(;;){let l=r[0];if(!l||l.replaceRange.start+o+l.newText.length>=s.replaceRange.start)break;r.shift(),n.push(l),o+=l.newText.length-l.replaceRange.length}let a=o,c,u;for(;;){let l=r[0];if(!l||l.replaceRange.start+o>s.replaceRange.endExclusive)break;c||(c=l),u=l,r.shift(),o+=l.newText.length-l.replaceRange.length}if(!c)n.push(new wo(s.replaceRange.delta(-o),s.newText));else{let l="",d=s.replaceRange.start-(c.replaceRange.start+a);d>0&&(l=c.newText.slice(0,d));let p=u.replaceRange.endExclusive+o-s.replaceRange.endExclusive;if(p>0){let h=new wo(Xt.ofStartAndLength(u.replaceRange.endExclusive,0),u.newText.slice(-p));r.unshift(h),o-=h.newText.length-h.replaceRange.length}let f=l+s.newText,m=new Xt(Math.min(c.replaceRange.start,s.replaceRange.start-a),s.replaceRange.endExclusive-o);n.push(new wo(m,f))}}for(;;){let s=r.shift();if(!s)break;n.push(s)}return new Zn(n).normalize()}var bI=class extends St{constructor(r,n,o){super();this._initialText=r;this._document=n;this._serviceAccessor=o;this._additionalEdits=Zn.empty;this._documentText=this._document.getText();let s=o.get(Ze);this._register(s.onDidChangeTextDocument(a=>{if(a.document.uri.toString()!==this._document.uri.toString())return;let c=Zn.from(a.contentChanges);this._additionalEdits=this._additionalEdits.compose(c)}))}async compute(){let r=this._serviceAccessor.get(yI),n=await Zn.fromDiff(this._initialText,this._documentText,r);return{getEditsSinceInitial:()=>{if(this._store.isDisposed)throw new Qr("EditComputer has been disposed");return n.compose(this._additionalEdits)}}}};var sv=class{constructor(e,r){this.initialText=e;this._diffService=r;this._document=new fX(e)}addEdits(e){let r=jXe(e,this._document);this._document.apply(r)}getText(){return this._document.getValue()}async getEdits(){let e=this.getText();return await Zn.fromDiff(this.initialText,e,this._diffService)}};sv=B([T(1,yI)],sv);function jXe(t,e){return new Zn(t.map(r=>{let n=e.positionToOffset(r.range.start),o=e.positionToOffset(r.range.end);return new wo(new Xt(n,o),r.newText)}))}var fX=class{constructor(e=""){this._converter=void 0;this._value="";this._value=e}getValue(){return this._value}apply(e){this._value=e.apply(this._value),this._converter=void 0}positionToOffset(e){return this._converter||(this._converter=new Ru(this._value)),this._converter.positionToOffset(new qr(e.line+1,e.character+1))}};function c2(t,e){return{headerRequestId:t.headers.get("x-request-id")||"",completionId:e&&e.id?e.id:"",created:e&&e.created?e.created:0,serverExperiments:t.headers.get("X-Copilot-Experiment")||"",deploymentId:t.headers.get("azureml-model-deployment")||""}}function lTe(t){let e=t.headers.get("openai-processing-ms");return e?parseInt(e,10):0}function dTe(t){if(typeof t!="object"||t===null||!("details"in t))return!1;let{details:e}=t;return typeof e=="object"&&e!==null&&"type"in e&&"description"in e&&typeof e.type=="string"&&typeof e.description=="string"}function pTe(t){return typeof t=="object"&&!!t&&"title"in t&&"excerpt"in t&&"url"in t}var zXe="vscode-notebook-cell";function $t(t){return t.scheme===zXe||t.scheme==="untitled"&&t.fragment.startsWith("notebook-chat-input")}var nm=class t{constructor(e){this._push=e}static spy(e,r){return new t(n=>{r(n),e.push(n)})}markdown(e){this._push(new Pi(e))}anchor(e,r){this._push(new wP(e,r))}button(e){this._push(new h0(e))}filetree(e,r){this._push(new Gm(e,r))}progress(e,r){typeof r>"u"?this._push(new Wi(e)):this._push(new Jre(e,r))}reference(e,r){this._push(new k_(e,r))}push(e){this._push(e)}textEdit(e,r){this._push(new Mp(e,r))}markdownWithVulnerabilities(e,r){this._push(new kP(e,r))}detectedParticipant(e,r){this._push(new bE(e,r))}confirmation(e,r,n){this._push(new AP(e,r,n))}warning(e){this._push(new RP(e))}};var $Te=W(Tr());var _I=class{constructor(e,r,n,o){this.originalStart=e,this.originalLength=r,this.modifiedStart=n,this.modifiedLength=o}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}},u2=class{constructor(e){this.lines=e}getElements(){let e=[];for(let r=0,n=this.lines.length;r<n;r++)e[r]=this.lines[r].trim();return e}getCharCount(){let e=0;for(let r of this.lines)e+=r.length;return e}},av=class{static Assert(e,r){if(!e)throw new Error(r)}},cv=class{static Copy(e,r,n,o,s){for(let a=0;a<s;a++)n[o+a]=e[r+a]}static Copy2(e,r,n,o,s){for(let a=0;a<s;a++)n[o+a]=e[r+a]}};var v8=class{constructor(){this.m_changes=[],this.m_originalStart=1073741824,this.m_modifiedStart=1073741824,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new _I(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=1073741824,this.m_modifiedStart=1073741824}AddOriginalElement(e,r){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,r),this.m_originalCount++}AddModifiedElement(e,r){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,r),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}},y8=class t{constructor(e,r){let[n,o]=t._getElements(e),[s,a]=t._getElements(r);this._originalStringElements=n,this._originalElementsOrHash=o,this._modifiedStringElements=s,this._modifiedElementsOrHash=a,this.m_forwardHistory=[],this.m_reverseHistory=[]}static _getElements(e){let r=e.getElements(),n=new Int32Array(r.length);for(let o=0,s=r.length;o<s;o++)n[o]=this._stringHash(r[o],0);return[r,n]}static _numberHash(e,r){return(r<<5)-r+e|0}static _stringHash(e,r){r=this._numberHash(149417,r);for(let n=0,o=e.length;n<o;n++)r=this._numberHash(e.charCodeAt(n),r);return r}ElementsAreEqual(e,r){return this._originalElementsOrHash[e]!==this._modifiedElementsOrHash[r]?!1:this._originalStringElements[e]===this._modifiedStringElements[r]}ComputeDiff(){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1)}_ComputeDiff(e,r,n,o){return this.ComputeDiffRecursive(e,r,n,o)}ComputeDiffRecursive(e,r,n,o){for(;e<=r&&n<=o&&this.ElementsAreEqual(e,n);)e++,n++;for(;r>=e&&o>=n&&this.ElementsAreEqual(r,o);)r--,o--;if(e>r||n>o){let d;return n<=o?(av.Assert(e===r+1,"originalStart should only be one more than originalEnd"),d=[new _I(e,0,n,o-n+1)]):e<=r?(av.Assert(n===o+1,"modifiedStart should only be one more than modifiedEnd"),d=[new _I(e,r-e+1,n,0)]):(av.Assert(e===r+1,"originalStart should only be one more than originalEnd"),av.Assert(n===o+1,"modifiedStart should only be one more than modifiedEnd"),d=[]),d}let s=[0],a=[0],c=this.ComputeRecursionPoint(e,r,n,o,s,a),u=s[0],l=a[0];if(c!==null)return c;{let d=this.ComputeDiffRecursive(e,u,n,l),p=this.ComputeDiffRecursive(u+1,r,l+1,o);return this.ConcatenateChanges(d,p)}}WALKTRACE(e,r,n,o,s,a,c,u,l,d,p,f,m,h,g,v,y){let _=null,b=null,S=new v8,I=r,w=n,O=m[0]-v[0]-o,U=-1073741824,z=this.m_forwardHistory.length-1;do{let M=O+e;M===I||M<w&&l[M-1]<l[M+1]?(p=l[M+1],h=p-O-o,p<U&&S.MarkNextChange(),U=p,S.AddModifiedElement(p+1,h),O=M+1-e):(p=l[M-1]+1,h=p-O-o,p<U&&S.MarkNextChange(),U=p-1,S.AddOriginalElement(p,h+1),O=M-1-e),z>=0&&(l=this.m_forwardHistory[z],e=l[0],I=1,w=l.length-1)}while(--z>=-1);_=S.getReverseChanges(),S=new v8,I=a,w=c,O=m[0]-v[0]-u,U=1073741824,z=y?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{let M=O+s;M===I||M<w&&d[M-1]>=d[M+1]?(p=d[M+1]-1,h=p-O-u,p>U&&S.MarkNextChange(),U=p+1,S.AddOriginalElement(p+1,h+1),O=M+1-s):(p=d[M-1],h=p-O-u,p>U&&S.MarkNextChange(),U=p,S.AddModifiedElement(p+1,h+1),O=M-1-s),z>=0&&(d=this.m_reverseHistory[z],s=d[0],I=1,w=d.length-1)}while(--z>=-1);return b=S.getChanges(),this.ConcatenateChanges(_,b)}ComputeRecursionPoint(e,r,n,o,s,a){let c=0,u=0,l=0,d=0,p=0,f=0;e--,n--,s[0]=0,a[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[];let m=r-e+(o-n),h=m+1,g=new Int32Array(h),v=new Int32Array(h),y=o-n,_=r-e,b=e-n,S=r-o,w=(_-y)%2===0;g[y]=e,v[_]=r;for(let O=1;O<=m/2+1;O++){let U=0,z=0;l=this.ClipDiagonalBound(y-O,O,y,h),d=this.ClipDiagonalBound(y+O,O,y,h);for(let M=l;M<=d;M+=2){M===l||M<d&&g[M-1]<g[M+1]?c=g[M+1]:c=g[M-1]+1,u=c-(M-y)-b;let re=c;for(;c<r&&u<o&&this.ElementsAreEqual(c+1,u+1);)c++,u++;if(g[M]=c,c+u>U+z&&(U=c,z=u),!w&&Math.abs(M-_)<=O-1&&c>=v[M])return s[0]=c,a[0]=u,re<=v[M]&&1447>0&&O<=1448?this.WALKTRACE(y,l,d,b,_,p,f,S,g,v,c,r,s,u,o,a,w):null}p=this.ClipDiagonalBound(_-O,O,_,h),f=this.ClipDiagonalBound(_+O,O,_,h);for(let M=p;M<=f;M+=2){M===p||M<f&&v[M-1]>=v[M+1]?c=v[M+1]-1:c=v[M-1],u=c-(M-_)-S;let re=c;for(;c>e&&u>n&&this.ElementsAreEqual(c,u);)c--,u--;if(v[M]=c,w&&Math.abs(M-y)<=O&&c<=g[M])return s[0]=c,a[0]=u,re>=g[M]&&1447>0&&O<=1448?this.WALKTRACE(y,l,d,b,_,p,f,S,g,v,c,r,s,u,o,a,w):null}if(O<=1447){let M=new Int32Array(d-l+2);M[0]=y-l+1,cv.Copy2(g,l,M,1,d-l+1),this.m_forwardHistory.push(M),M=new Int32Array(f-p+2),M[0]=_-p+1,cv.Copy2(v,p,M,1,f-p+1),this.m_reverseHistory.push(M)}}return this.WALKTRACE(y,l,d,b,_,p,f,S,g,v,c,r,s,u,o,a,w)}ConcatenateChanges(e,r){let n=[];if(e.length===0||r.length===0)return r.length>0?r:e;if(this.ChangesOverlap(e[e.length-1],r[0],n)){let o=new Array(e.length+r.length-1);return cv.Copy(e,0,o,0,e.length-1),o[e.length-1]=n[0],cv.Copy(r,1,o,e.length,r.length-1),o}else{let o=new Array(e.length+r.length);return cv.Copy(e,0,o,0,e.length),cv.Copy(r,0,o,e.length,r.length),o}}ChangesOverlap(e,r,n){if(av.Assert(e.originalStart<=r.originalStart,"Left change is not less than or equal to right change"),av.Assert(e.modifiedStart<=r.modifiedStart,"Left change is not less than or equal to right change"),e.originalStart+e.originalLength>=r.originalStart||e.modifiedStart+e.modifiedLength>=r.modifiedStart){let o=e.originalStart,s=e.originalLength,a=e.modifiedStart,c=e.modifiedLength;return e.originalStart+e.originalLength>=r.originalStart&&(s=r.originalStart+r.originalLength-e.originalStart),e.modifiedStart+e.modifiedLength>=r.modifiedStart&&(c=r.modifiedStart+r.modifiedLength-e.modifiedStart),n[0]=new _I(o,s,a,c),!0}else return n[0]=null,!1}ClipDiagonalBound(e,r,n,o){if(e>=0&&e<o)return e;let s=n,a=o-n-1,c=r%2===0;if(e<0){let u=s%2===0;return c===u?0:1}else{let u=a%2===0;return c===u?o-1:o-2}}};function hTe(t,e){let r=t.getText().split(/\r|\n|\r\n/g),n=e||{tabSize:4},o={getLineCount:()=>r.length,getLineContent:s=>r[s-1],getOptions:()=>n};try{let s=VXe(o,t.languageId),[a]=gTe(t,s,void 0);return a.adjust(t,vTe(t.languageId)),a.toOverlayNode(t,!0)}catch{return new b8(1,t.lineCount,[]).toOverlayNode(t,!0)}}function gTe(t,e,r){if(typeof r<"u"&&r>=e.length)throw new Error(`Invalid region index ${r}`);let n=typeof r>"u"?1:e.getStartLineNumber(r),o=typeof r>"u"?t.lineCount:e.getEndLineNumber(r),s=[],a=null;for(r=typeof r>"u"?0:r+1;r<e.length;){let c=e.getStartLineNumber(r),u=e.getEndLineNumber(r);if(c>o||u>o)break;let l=a;if([a,r]=gTe(t,e,r),l&&a.startLineNumber<=l.endLineNumber)throw new Qr("Invalid Folding Ranges: overlapping children");if(a.startLineNumber<n)throw new Qr("Invalid Folding Ranges: child starts before parent");s.push(a)}return[new b8(n,o,s),r]}var b8=class{constructor(e,r,n){this.startLineNumber=e;this.endLineNumber=r;this.children=n;if(e>r)throw new Qr("Invalid Folding Ranges: startLineNumber > endLineNumber")}adjust(e,r){r?this._adjustOffside():this._adjustRegular(e,e.lineCount)}_adjustOffside(){this.startLineNumber++;for(let e of this.children)e._adjustOffside()}_adjustRegular(e,r){if(this.endLineNumber<r){let n=e.lineAt(this.endLineNumber).text.trim();/^[\}\]\)];?$/.test(n)&&this.endLineNumber++}for(let n=this.children.length-1;n>=0;n--){let o=this.children[n],s=n+1<this.children.length?this.children[n+1].startLineNumber-1:r;o._adjustRegular(e,s)}}toOverlayNode(e,r){let n=[],o=r&&this.startLineNumber===1?1:this.startLineNumber+1;for(let s of this.children){for(let a=o;a<s.startLineNumber;a++){let c=fTe(e,a);c&&n.push(c)}n.push(s.toOverlayNode(e,!1)),o=s.endLineNumber+1}for(let s=o;s<this.endLineNumber;s++){let a=fTe(e,s);a&&n.push(a)}return GXe(e,this.startLineNumber,this.endLineNumber,n)}};function fTe(t,e){let r=t.lineAt(e-1);if(r.isEmptyOrWhitespace)return null;let n=t.offsetAt(r.range.start),o=t.offsetAt(r.range.end);return new Ql(n,o,"LINE",[])}function GXe(t,e,r,n){let o=t.offsetAt(new Xr(e-1,0)),s=t.offsetAt(new Xr(r-1,t.lineAt(r-1).text.length));return new Ql(o,s,"FOLD",n)}function VXe(t,e){return $Xe(t,vTe(e))}function vTe(t){return["clojure","coffeescript","fsharp","latex","markdown","pug","python","sql","yaml"].includes(t)}function $Xe(t,e){let r=t.getOptions().tabSize,n=new mX,o=[],s=t.getLineCount()+1;o.push({indent:-1,endAbove:s,line:s});for(let a=t.getLineCount();a>0;a--){let c=t.getLineContent(a),u=KXe(c,r),l=o[o.length-1];if(u===-1){e&&(l.endAbove=a);continue}if(l.indent>u){do o.pop(),l=o[o.length-1];while(l.indent>u);let d=l.endAbove-1;d-a>=1&&n.insertFirst(a,d,u)}l.indent===u?l.endAbove=a:o.push({indent:u,endAbove:a,line:a})}return n.toIndentRanges()}var WXe=65535,kb=16777215,mTe=4278190080,mX=class{constructor(){this._startIndexes=[],this._endIndexes=[],this._indentOccurrences=[],this._length=0}insertFirst(e,r,n){if(e>kb||r>kb)return;let o=this._length;this._startIndexes[o]=e,this._endIndexes[o]=r,this._length++,n<1e3&&(this._indentOccurrences[n]=(this._indentOccurrences[n]||0)+1)}toIndentRanges(){let e=new Uint32Array(this._length),r=new Uint32Array(this._length);for(let n=this._length-1,o=0;n>=0;n--,o++)e[o]=this._startIndexes[n],r[o]=this._endIndexes[n];return new hX(e,r)}};function KXe(t,e){let r=0,n=0,o=t.length;for(;n<o;){let s=t.charCodeAt(n);if(s===32)r++;else if(s===9)r=r-r%e+e;else break;n++}return n===o?-1:r}var hX=class{constructor(e,r){this._startIndexes=e,this._endIndexes=r,this._parentsComputed=!1}ensureParentIndices(){if(!this._parentsComputed){this._parentsComputed=!0;let e=[],r=(n,o)=>{let s=e[e.length-1];return this.getStartLineNumber(s)<=n&&this.getEndLineNumber(s)>=o};for(let n=0,o=this._startIndexes.length;n<o;n++){let s=this._startIndexes[n],a=this._endIndexes[n];if(s>kb||a>kb)throw new Error("startLineNumber or endLineNumber must not exceed "+kb);for(;e.length>0&&!r(s,a);)e.pop();let c=e.length>0?e[e.length-1]:-1;e.push(n),this._startIndexes[n]=s+((c&255)<<24),this._endIndexes[n]=a+((c&65280)<<16)}}}get length(){return this._startIndexes.length}getStartLineNumber(e){return this._startIndexes[e]&kb}getEndLineNumber(e){return this._endIndexes[e]&kb}getParentIndex(e){this.ensureParentIndices();let r=((this._startIndexes[e]&mTe)>>>24)+((this._endIndexes[e]&mTe)>>>16);return r===WXe?-1:r}contains(e,r){return this.getStartLineNumber(e)<=r&&this.getEndLineNumber(e)>=r}findIndex(e){let r=0,n=this._startIndexes.length;if(n===0)return-1;for(;r<n;){let o=Math.floor((r+n)/2);e<this.getStartLineNumber(o)?n=o:r=o+1}return r-1}findRange(e){let r=this.findIndex(e);if(r>=0){if(this.getEndLineNumber(r)>=e)return r;for(r=this.getParentIndex(r);r!==-1;){if(this.contains(r,e))return r;r=this.getParentIndex(r)}}return-1}};async function yTe(t,e,r,n){let o=t.get(_t),s=o.getTreeSitterAST(e);if(!s)return[];let a=t.get(Di),c=Xi(r,e),u=await ha(t,e,n,()=>s.getCallExpressions(c),[]);async function l(h){let g=e.positionAt(h.startIndex);try{let v=await a.getImplementations(e.uri,g);return v.length?v:await a.getDefinitions(e.uri,g)}catch{return[]}}let d=await ha(t,e,n*3,()=>Promise.all(u.map(l)),[]),p=[];for(let h=0;h<d.length;h++){let g=u[h],v=d[h];for(let y of v){let{uri:_,range:b}=Hp(y)?{uri:y.targetUri,range:y.targetRange}:y,S=await t.get(Ze).openTextDocument(_),I=o.getTreeSitterAST(S);if(I){let O=(await I.getFunctionDefinitions()).find(U=>U.identifier===g.identifier);if(O){let U=Xi(b,S);p.push({uri:_,range:b,version:S.version,identifier:g.identifier,startIndex:U.startIndex,endIndex:U.endIndex,text:O.text})}}}}if(p.length!==0)return p;let f=await ha(t,e,n,()=>s.getFunctionDefinitions(),[]),m=[];for(let h of f)for(let g of u)h.identifier===g.identifier&&m.push(h);return m.sort((h,g)=>h.startIndex-g.startIndex)}async function bTe(t,e,r,n){let o=t.get(_t),s=o.getTreeSitterAST(e);if(!s)return[];let a=t.get(Di),c=Xi(r,e),u=await ha(t,e,n,()=>s.getClassReferences(c),[]),l=await ha(t,e,n*3,async()=>await Promise.all(u.map(async m=>{try{let h=e.positionAt(m.startIndex),g=await a.getImplementations(e.uri,h);return g.length?g:await a.getDefinitions(e.uri,h)}catch{return[]}})),[]),d=[];for(let m=0;m<l.length;m++){let h=u[m],g=l[m];for(let v of g){let{uri:y,range:_}=Hp(v)?{uri:v.targetUri,range:v.targetRange}:v,b=await t.get(Ze).openTextDocument(y),S=o.getTreeSitterAST(b);if(S){let I=(await S.getClassDeclarations()).find(w=>w.identifier===h.identifier);if(I){let w=Xi(_,b);d.push({uri:y,range:_,version:b.version,identifier:h.identifier,startIndex:w.startIndex,endIndex:w.endIndex,text:I.text})}}}}if(d.length!==0)return d;let p=await ha(t,e,n,()=>s.getClassDeclarations(),[]),f=[];for(let m of p)for(let h of u)m.identifier===h.identifier&&f.push(m);return f.sort((m,h)=>m.startIndex-h.startIndex)}async function _Te(t,e,r,n){let s=t.get(_t).getTreeSitterAST(e);if(!s)return[];let a=Xi(r,e),c=await ha(t,e,n,()=>s.getTypeReferences(a),[]),u=await ha(t,e,n,()=>s.getTypeDeclarations(),[]),l=[];for(let d of u)for(let p of c)d.identifier===p.identifier&&l.push(d);return l.sort((d,p)=>d.startIndex-p.startIndex)}function YXe(t,e){return e===0?t.then(r=>({type:"success",value:r})):new Promise((r,n)=>{let o=setTimeout(()=>r({type:"timeout"}),e);t.then(s=>{clearTimeout(o),r({type:"success",value:s})}).catch(s=>{clearTimeout(o),n(s)})})}async function xTe(t,e,r){let o=t.get(_t).getTreeSitterAST(e);if(!o)return[];let s=await ha(t,e,r,()=>o.getFunctionBodies(),[]);return s.sort((a,c)=>a.startIndex-c.startIndex),QXe(s)}function QXe(t){t.sort((r,n)=>r.startIndex-n.startIndex||n.endIndex-r.endIndex);let e=[];for(let r=0,n=t.length;r<n;){e.push(t[r]);let o=r+1;for(;o<t.length&&Ji.doesContain(t[r],t[o]);)++o;r=o}return e}async function ha(t,e,r,n,o){let s=t.get(ce).getLogger("asyncCompute");try{let a=await YXe(STe(e,n,o),r);return a.type==="success"?a.value:(s.info(`Computing async parser based result took longer than ${r}ms`),o)}catch(a){return a instanceof KP||(s.exception(a,"Failed to compute async parser based result"),t.get(me).sendGHTelemetryException(a,"Failed to compute async parser based result")),o}}async function STe(t,e,r,n=0){let o=t.version,s=await e();return t.version!==o?n<3?STe(t,e,r,n+1):r:s}var Ks=class t{static forDocument(e,r){return this.forUri(e,r.uri)}static forUri(e,r){return`${this.forLanguage(e)}: ${r.path}`}static forLanguage(e){return`${e.lineComment.start} FILEPATH`}static testLine(e,r){let n=t.forLanguage(e);return r.trimStart().startsWith(n)}};var xs=class{static begin(e,r){return typeof r>"u"?`${e.lineComment.start} BEGIN:`:`${e.lineComment.start} BEGIN: ${r}`}static end(e,r){return typeof r>"u"?`${e.lineComment.start} END:`:`${e.lineComment.start} END: ${r}`}};function _8(t){return/(^|\n)```[\s\S]+\n```/m.test(t)}function ITe(t){return t.split("```",1)[0].match(/^.+/)?.[0]??""}async function Ab(t,e,r){let o=await t.getTreeSitterAST(e)?.getStructure();return o||hTe(e,r)}var Ss=class extends rc{constructor(r,n){super();this.wholeRange=r;this.contextInfo=n}};(e=>{function t(r){return r instanceof e}e.is=t})(Ss||={});var gX=class{constructor(){this.spacesDiff=0;this.looksLikeAlignment=!1}};function XXe(t,e,r,n,o){o.spacesDiff=0,o.looksLikeAlignment=!1;let s;for(s=0;s<e&&s<n;s++){let f=t.charCodeAt(s),m=r.charCodeAt(s);if(f!==m)break}let a=0,c=0;for(let f=s;f<e;f++)t.charCodeAt(f)===32?a++:c++;let u=0,l=0;for(let f=s;f<n;f++)r.charCodeAt(f)===32?u++:l++;if(a>0&&c>0||u>0&&l>0)return;let d=Math.abs(c-l),p=Math.abs(a-u);if(d===0){o.spacesDiff=p,p>0&&0<=u-1&&u-1<t.length&&u<r.length&&r.charCodeAt(u)!==32&&t.charCodeAt(u-1)===32&&t.charCodeAt(t.length-1)===44&&(o.looksLikeAlignment=!0);return}if(p%d===0){o.spacesDiff=p/d;return}}function uv(t,e,r){let n=Math.min(t.length,1e4),o=0,s=0,a="",c=0,u=[2,4,6,8,3,5,7],l=8,d=[0,0,0,0,0,0,0,0,0],p=new gX;for(let h=0;h<n;h++){let g=t[h],v=g.length,y=!1,_=0,b=0,S=0;for(let w=0,O=v;w<O;w++){let U=g.charCodeAt(w);if(U===9)S++;else if(U===32)b++;else{y=!0,_=w;break}}if(!y||(S>0?o++:b>1&&s++,XXe(a,c,g,_,p),p.looksLikeAlignment&&!(r&&e===p.spacesDiff)))continue;let I=p.spacesDiff;I<=l&&d[I]++,a=g,c=_}let f=r;o!==s&&(f=o<s);let m=e;if(f){let h=f?0:.1*n;u.forEach(g=>{let v=d[g];v>h&&(h=v,m=g)}),m===4&&d[4]>0&&d[2]>0&&d[2]>=d[4]/2&&(m=2)}return{insertSpaces:f,tabSize:m}}function JXe(t,e){let r=0,n=0,o=t.length;for(;n<o;){let s=t.charCodeAt(n);if(s===32)r++;else if(s===9)r=r-r%e+e;else break;n++}return n===o?~r:r}function x8(t,e){let r=JXe(t,e);return r<0?Math.floor(~r/e):Math.floor(r/e)}function ZXe(t,e){return t+e-t%e}function eJe(t,e,r){let n=0;for(let s=0;s<t.length;s++)t.charAt(s)==="	"?n=ZXe(n,e):n++;let o="";if(!r){let s=Math.floor(n/e);n=n%e;for(let a=0;a<s;a++)o+="	"}for(let s=0;s<n;s++)o+=" ";return o}function vX(t,e,r){let n=Nre(t);return n===-1&&(n=t.length),eJe(t.substring(0,n),e,r)+t.substring(n)}var ku=class{constructor(e,r,n,o="",s=`
`){this.firstLineIndex=e;this.endLineIndex=r;this.lines=n;this.prefix=o;this.suffix=s}toTextEdit(){let e=this.lines.length>0?this.prefix+this.lines.join(`
`)+this.suffix:"";return On.replace(new ze(this.firstLineIndex,0,this.endLineIndex,0),e)}},SI;(r=>{function t(n){return n.length===0?[]:n.split(/\r\n|\r|\n/g)}r.fromString=t;function e(n){if(n.lineCount===0)return[];let o=[];for(let s=0;s<n.lineCount;s++)o.push(n.lineAt(s).text);return o}r.fromDocument=e})(SI||={});var Pb=class t{constructor(e,r){this.text=e;this.languageId=r}static fromDocumentContext(e){return new t(e.document.getText(),e.language.languageId)}};function lv(t,e,r,n,o,s){let a=SI.fromString(r);if(a.length===e.range.lines.length&&e.range.lines.every((p,f)=>p===a[f]))return[];let c=[],u=!1;for(let p of a){let f=S8(e,p);f===null?c.push(p):(f.type==="fakestart"||f.type==="fakend")&&(u=!0)}let l;if(n===4)l=new ku(e.range.lastLineIndex,e.range.lastLineIndex,a);else{let p=nJe(e,a,o),f=lJe(t,e,c,o);if(!p)l=f;else if(!f)l=p;else{let m=CTe(p);CTe(f)<m?l=f:l=p}l||(l=rJe(t,e,n,o,u,c))}s&&(l=tJe(s,l,o));let d=[l];return s&&(d=iJe(s,d)),d.map(p=>p.toTextEdit())}function tJe(t,e,r){let n=t.text.split(/\r\n|\r|\n/g),o=n.slice(0,e.firstLineIndex),s=n.slice(e.endLineIndex),a=e.lines.slice(0),[,c]=ETe(o,a);c>0&&a.splice(0,c),c>0&&(a=dv(a,{whichLine:"bottomMost",lines:o.slice(o.length-c)},r).slice(0));let[u]=ETe(a,s);return u>0&&a.splice(a.length-u,u),new ku(e.firstLineIndex,e.endLineIndex,a)}function rJe(t,e,r,n,o,s){let a=t.get(ce).getLogger("editGeneration");return o?(a.info("(case 6) Appending to selected code"),wTe(e.range,s,n)):r===3?(a.info("(case 7) Appending to selected code"),wTe(e.range,s,n)):r===1?(a.info("(case 8) Prepending to selected code"),mJe(e.range,dv(s,e.range.lines.filter(c=>c.trim()!=="").length>0?{whichLine:"topMost",lines:e.range.lines}:{whichLine:"bottomMost",lines:e.above.lines},n))):(a.info("(Default) Replacing selected code"),ap(e.range,s,n))}function CTe(t){let e=t.endLineIndex-t.firstLineIndex,r=t.lines.length;return e+r}function nJe(t,e,r){let n=null,o=[];for(let s of e){let a=S8(t,s);if(a===null){o.push(s);continue}if(n){if(a.type==="end"&&a.endMarker===n)return ap(n,o,r);if(a.type==="end"&&n===t.above&&a.endMarker===t.range){let c=t.range.clone();return c.mergeFromAbove(t.above.clone()),ap(c,o,r)}if(a.type==="end"&&n===t.above&&a.endMarker===t.below){let c=t.range.clone();return c.mergeFromAbove(t.above.clone()),c.mergeFromBelow(t.below.clone()),ap(c,o,r)}}else a.type==="start"&&(n=a.startMarker,o=[])}if(o.length>0&&n)return ap(n,o,r)}function iJe(t,e){let r=[],n=t.text.split(/\r\n|\r|\n/g),o=oJe(n,c=>xI(c,t.languageId)),s=[];for(let c of e){if(c.endLineIndex<=o+1)return e;let u=!1,l=[],d=c.lines;for(let p of d)xI(p,t.languageId)?(s.push(bX(p)),u=!0):u&&p.length===0||(l.push(p),u=!1);if(!u&&l.length>0){if(c.firstLineIndex<o+1)return e;r.push(new ku(c.firstLineIndex,c.endLineIndex,l))}}if(s.length===0)return e;let a=o+1;return r.unshift(new ku(a,a,s)),r}function oJe(t,e){for(let r=t.length-1;r>=0;r--)if(e(t[r]))return r;return-1}function bX(t){return t.replace(/^\s+/g,"")}function xI(t,e){switch(e){case"java":return!!t.match(/^\s*import\s/);case"typescript":case"javascript":return!!t.match(/^\s*import[\s{*]|^\s*[var|const|let].*=\s*require\(/);case"php":return!!t.match(/^\s*use/);case"rust":return!!t.match(/^\s*use\s+[\w:{}, ]+\s*(as\s+\w+)?;/);case"python":return!!t.match(/^\s*from\s+[\w.]+\s+import\s+[\w, *]+$/)||!!t.match(/^\s*import\s+[\w, ]+$/);default:return!1}}var sJe=/^(\t+)/,yX=new Map;function aJe(t){return yX.has(t)||yX.set(t,new RegExp(`^(( {${t}})+)`)),yX.get(t)}function _X(t,e,r){let n=e?aJe(r):sJe,o=t.match(n);return o?[o[0],o[0].length/(e?r:1)]:["",0]}function cJe(t){let{insertSpaces:e,tabSize:r}=uv(t,4,!1),n=Number.MAX_VALUE;for(let o of t){if(/^\s*$/.test(o))continue;let[,s]=_X(o,e,r);n=Math.min(n,s)}return{insertSpaces:e,tabSize:r,minIndentLevel:n}}function TTe(t,e){if(e===0)return"";if(t===" ")switch(e){case 2:return"  ";case 4:return"    ";case 8:return"        ";case 12:return"            "}if(t==="	")switch(e){case 1:return"	";case 2:return"		";case 3:return"			"}return new Array(e).fill(t).join("")}function uJe(t,e){let r=t.lines,n;if(t.whichLine==="topMost")n=r.find(o=>o!=="");else for(let o=r.length-1;o>=0;--o)if(r[o]!==""){n=r[o];break}return n===void 0?0:_X(n,e.insertSpaces,e.tabSize)[1]}function dv(t,e,r){if(r===void 0)return t;let n=uJe(e,r),o=cJe(t),s=r.insertSpaces?TTe(" ",r.tabSize):"	";return t.map(a=>{if(a==="")return"";{let[c,u]=_X(a,o.insertSpaces,o.tabSize),l=a.substring(c.length);return TTe(s,n+(u-o.minIndentLevel))+l}})}function S8(t,e){switch(e){case t.above.startMarker:return{type:"start",startMarker:t.above};case t.above.endMarker:return{type:"end",endMarker:t.above};case t.range.startMarker:return{type:"start",startMarker:t.range};case t.range.endMarker:return{type:"end",endMarker:t.range};case t.below.startMarker:return{type:"start",startMarker:t.below};case t.below.endMarker:return{type:"end",endMarker:t.below}}return e.trimStart().startsWith(xs.begin(t.language))?{type:"fakestart"}:e.trimStart().startsWith(xs.end(t.language))?{type:"fakend"}:null}function lJe(t,e,r,n){let o=(m,h,g)=>{let v=0;for(let S of m)for(let I=S.originalStart;I<S.originalStart+S.originalLength;I++){let w=h.lines[I];v+=w.length}let y=h.getCharCount(),_=g.getCharCount(),b=y-v;return{equalCharCount:b,originalCharCount:y,modifiedCharCount:_,originalCharRatio:y>0?b/y:0,modifiedCharRatio:_>0?b/_:0}},s=m=>{let h=new u2(m.lines),g=new u2(r),y=new y8(h,g).ComputeDiff();return o(y,h,g)},a=e.range.clone();a.mergeFromAbove(e.above.clone()),a.mergeFromBelow(e.below.clone());let c=s(a),u=s(e.range),l={diffToEntireScore:c,diffToRangeScore:u},d=t.get(ce).getLogger("editGeneration");if(d.info(`Diff metrics: ${JSON.stringify(l,null,"	")}`),c.originalCharCount>30&&c.originalCharRatio>.7)return d.info("(case 1) Replacing entire code"),ap(a,r,n);if(u.originalCharCount>20&&u.originalCharRatio>.7)return d.info("(case 2) Replacing selected code"),ap(e.range,r,n);let p=Math.min(c.originalCharRatio,c.modifiedCharRatio),f=Math.min(u.originalCharRatio,u.modifiedCharRatio);if(p>.2&&p>f)return d.info("(case 3) Replacing entire code"),ap(a,r,n);if(f>.2)return d.info("(case 4) Replacing selected code"),ap(e.range,r,n);if(!e.range.hasContent)return d.info("(case 5) Replacing empty selected code"),ap(e.range,r,n,{whichLine:"bottomMost",lines:e.above.lines})}function ap(t,e,r,n){let s=dv(e,n??{whichLine:"topMost",lines:t.lines},r).slice(0),a=t.lines.slice(0),c=t.firstLineIndex,u=t.lastLineIndex;if(a.length===1&&a[0]==="")return new ku(u,u,s);let l=dJe(a,s);if(c+=l,a.splice(0,l),s.splice(0,l),a.length===0)return new ku(u+1,u+1,s);let d=pJe(a,s);return u-=d,a.splice(a.length-d,d),s.splice(s.length-d,d),a.length===0?new ku(c,c,s):new ku(c,u+1,s)}function dJe(t,e){let r=Math.min(t.length,e.length);for(let n=0;n<r;n++)if(t[n]!==e[n])return n;return r}function pJe(t,e){let r=Math.min(t.length,e.length);for(let n=0;n<r;n++)if(t[t.length-1-n]!==e[e.length-1-n])return n;return r}function ETe(t,e){let r=t.filter(c=>!/^\s*$/.test(c)),n=e.filter(c=>!/^\s*$/.test(c)),o=fJe(r,n);if(o===0)return[0,0];let s=0;for(let c=0;c<o;c++)for(s++;/^\s*$/.test(t[t.length-s]);)s++;let a=0;for(let c=0;c<o;c++)for(a++;/^\s*$/.test(e[a]);)a++;return[s,a]}function fJe(t,e){for(let r=Math.min(t.length,e.length);r>0;r--){let n=t.length-r,o=!0;for(let s=0;s<r;s++)if(t[n+s]!==e[s]){o=!1;break}if(o)return r}return 0}function mJe(t,e){return new ku(t.firstLineIndex,t.firstLineIndex,e)}function wTe(t,e,r){let n=dv(e,{whichLine:"bottomMost",lines:t.lines},r),o=t.lastLineIndex+1;return new ku(o,o,n)}function Db(t,e){return{type:"inlineEdit",edits:t,newWholeRange:e}}function II(t,e,r){let n=hJe(t,e);if(!n)return null;let{code:o,contentBeforeCode:s,language:a}=n;if(Ks.testLine(r,o)){let c=o.indexOf(`
`);o=o.substring(c).trim()}return{code:o,contentBeforeCode:s,language:a}}function hJe(t,e){e=e.trim();let n=Ws(e).at(0);if(n){let u=oP(e);return{code:n.code,contentBeforeCode:u.slice(0,n.startLine).join(`
`).trimEnd(),language:n.language}}let o=e.split(/\r\n|\r|\n/g),s=!1,a=[],c=[];for(let u of o){let l=S8(t,u);if(s){if(l)return c.push(u),{code:c.join(`
`),contentBeforeCode:a.join(`
`),language:""};c.push(u)}else l?(s=!0,c.push(u)):a.push(u)}return null}var EI=class{constructor(e,r,n,o,s=!0,a=Nb.noop){this.myDocument=e;this.initialSelection=r;this.adjustedSelection=n;this.editStrategy=o;this.collectImports=s;this.lineFilter=a;this.replyIndentationTracker=null}async processStream(e){let r=Oo.filter(e,this.lineFilter);this.collectImports&&(r=SX(r,this.myDocument));let n=this.myDocument.firstSentLineIndex;for await(let o of this.findInitialAnchor(r))o instanceof T8?n=this.handleFirstReplyLine(o.anchor,o.line):n=this.handleSubsequentReplyLine(n,o.value);return this.myDocument.didReplaceEdits&&n<=this.adjustedSelection.end.line&&this.myDocument.deleteLines(n,this.adjustedSelection.end.line),new l2(this.myDocument.didEdits,this.myDocument.additionalImports)}handleFirstReplyLine(e,r){if(e){this.replyIndentationTracker=new wI(this.myDocument,e.lineIndex,r);let s=this.replyIndentationTracker.reindent(r,this.myDocument.indentStyle);return this.myDocument.getLine(e.lineIndex).sentInCodeBlock===2?this.myDocument.replaceLines(this.adjustedSelection.start.line,e.lineIndex,s):this.myDocument.replaceLine(e.lineIndex,s)}let n=this.adjustedSelection.start.line;this.replyIndentationTracker=new wI(this.myDocument,n,r);let o=this.replyIndentationTracker.reindent(r,this.myDocument.indentStyle);if(this.initialSelection.isEmpty){let s=this.myDocument.getLine(n).content;if(/^\s*$/.test(s)||o.adjustedContent.startsWith(s))return this.myDocument.replaceLine(n,o,!0)}return this.editStrategy===1?this.myDocument.insertLineBefore(n,o):this.editStrategy===3||this.editStrategy===4?this.myDocument.insertLineAfter(n,o):this.myDocument.replaceLine(n,o)}handleSubsequentReplyLine(e,r){let n=this.replyIndentationTracker.reindent(r,this.myDocument.indentStyle);if(n.trimmedContent!==""||this.myDocument.didReplaceEdits){let s=this.matchReplyLine(n,e);if(s)return this.myDocument.replaceLines(e,s.lineIndex,n)}if(e>=this.myDocument.getLineCount())return this.myDocument.appendLineAtEndOfDocument(n);let o=this.myDocument.getLine(e);return!o.isSent||o.content===""||n.trimmedContent===""?this.myDocument.insertLineBefore(e,n):o.indentLevel<n.adjustedIndentLevel?this.myDocument.insertLineBefore(e,n):o.indentLevel===n.adjustedIndentLevel&&!this.myDocument.didReplaceEdits?this.myDocument.insertLineBefore(e,n):this.myDocument.replaceLine(e,n)}matchReplyLine(e,r){let n=e.trimmedContent.length<=3;for(let o=r;o<this.myDocument.getLineCount();o++){let s=this.myDocument.getLine(o);if(s.isSent){if(s.normalizedContent===e.adjustedContent)return new w8(o);if(s.trimmedContent.length>0&&s.indentLevel<e.adjustedIndentLevel||n&&s.trimmedContent.length>0)return null}}return null}findInitialAnchor(e){return new Oo(async r=>{let n=[],o=0,s=!1;for await(let a of e)if(s)r.emitOne(a);else if(n.push(a),o+=a.value.trim().length,o>10){let c=this.searchForEqualSentLines(n);s=!0,r.emitOne(new T8(n[0].value,c)),r.emitMany(n.slice(1))}})}searchForEqualSentLines(e){let r=e.map(n=>n.value.trim());for(let n=this.myDocument.firstSentLineIndex,o=this.myDocument.getLineCount()-e.length;n<=o;n++){if(!this.myDocument.getLine(n).isSent)continue;let s=!0;for(let a=0;a<r.length;a++){let c=this.myDocument.getLine(n+a);if(!c.isSent||c.trimmedContent!==r[a]){s=!1;break}}if(s)return new w8(n)}return null}},I8=class{constructor(e,r,n=Nb.noop){this._myDocument=e;this._cursorPosition=r;this._lineFilter=n;this.replyIndentationTracker=null}async processStream(e){let r=Oo.filter(e,this._lineFilter);r=SX(r,this._myDocument);let n=0;for await(let o of r)this.replyIndentationTracker?n=this.handleSubsequentReplyLine(n,o.value):n=this.handleFirstReplyLine(o.value);return new l2(this._myDocument.didEdits,this._myDocument.additionalImports)}handleFirstReplyLine(e){let r=this._cursorPosition.line;this.replyIndentationTracker=new wI(this._myDocument,r,e);let n=this.replyIndentationTracker.reindent(e,this._myDocument.indentStyle),o=this._myDocument.getLine(r).content;return/^\s*$/.test(o)||n.adjustedContent.startsWith(o)?this._myDocument.replaceLine(r,n,!0):this._myDocument.insertLineAfter(r,n)}handleSubsequentReplyLine(e,r){let n=this.replyIndentationTracker.reindent(r,this._myDocument.indentStyle);return this._myDocument.insertLineBefore(e,n)}},C8=class{constructor(e,r,n=Nb.noop){this._myDocument=e;this._selection=r;this._lineFilter=n;this.replyIndentationTracker=null}async processStream(e){let r=Oo.filter(e,this._lineFilter);r=SX(r,this._myDocument);let n=0,o,s="";this._selection.end.line>this._selection.start.line&&this._selection.end.character===0?o=this._selection.end.line-this._selection.start.line:(o=this._selection.end.line-this._selection.start.line+1,s=this._myDocument.getLine(this._selection.end.line).content.substring(this._selection.end.character));for await(let a of r)if(this.replyIndentationTracker){let c=this.replyIndentationTracker.reindent(a.value,this._myDocument.indentStyle);o>0?(n=this._myDocument.replaceLine(n,c),o--):n=this._myDocument.insertLineAfter(n-1,c)}else{let c=this._selection.start.line;this.replyIndentationTracker=new wI(this._myDocument,c,a.value);let u=this.replyIndentationTracker.reindent(a.value,this._myDocument.indentStyle);n=this._myDocument.replaceLine(c,u),o--}return this._myDocument.didEdits&&o>0&&this._myDocument.deleteLines(n,n+o-1),this._myDocument.didEdits&&s.length>0&&this._myDocument.replaceLine(n-1,this._myDocument.getLine(n-1).content+s),new l2(this._myDocument.didEdits,this._myDocument.additionalImports)}},l2=class{constructor(e,r){this.didEdits=e;this.additionalImports=r}},wI=class{constructor(e,r,n){let o=0;for(let a=r;a>=0;a--){let c=e.getLine(a);if(c.content.length>0){o=c.indentLevel,a!==r&&c.content.endsWith("{")&&(o+=1);break}}this._replyIndentStyle=TI.guessIndentStyleFromLine(n);let s=x8(n,this._replyIndentStyle?.tabSize??4);this.indentDelta=s-o}reindent(e,r){if(e==="")return new E8("",0,"",0);this._replyIndentStyle||(this._replyIndentStyle=TI.guessIndentStyleFromLine(e));let n=0,o=0,s=c=>(n=c,o=Math.max(n-this.indentDelta,0),o),a=TI.reindentLine(e,this._replyIndentStyle??{insertSpaces:!0,tabSize:4},r,s);return new E8(e,n,a,o)}},T8=class{constructor(e,r){this.line=e;this.anchor=r}},RI=class{constructor(e,r){this.lineIndex=e;this.sentInCodeBlock=r}},kI=class{constructor(e,r){this.startLineIndex=e;this.endLineIndex=r}},AI=class{constructor(e,r,n,o,s,a,c){this.outputStream=e;this.uri=r;this.languageId=a;this._originalLines=[];this.lines=[];this._didEdits=!1;this._didReplaceEdits=!1;this._additionalImports=[];this.indentStyle=TI.getDocumentIndentStyle(n,c),this._originalLines=n.split(/\r\n|\r|\n/g);for(let u=0;u<this._originalLines.length;u++)this.lines[u]=new pv(this._originalLines[u],this.indentStyle);this.firstSentLineIndex=Number.MAX_SAFE_INTEGER;for(let u of o)this.lines[u.lineIndex].markSent(u.sentInCodeBlock),this.firstSentLineIndex=Math.min(this.firstSentLineIndex,u.lineIndex);this.firstSentLineIndex=Math.min(this.firstSentLineIndex,s.startLineIndex)}get didEdits(){return this._didEdits}get didReplaceEdits(){return this._didReplaceEdits}get additionalImports(){return this._additionalImports}getText(){return this.lines.map(e=>e.content).join(`
`)}getLineCount(){return this.lines.length}getLine(e){if(e<0||e>=this.lines.length)throw new Error("Invalid index");return this.lines[e]}addAdditionalImport(e){this._additionalImports.push(e)}replaceLine(e,r,n=!1){let o=typeof r=="string"?r:r.adjustedContent;return this.lines[e]=new pv(o,this.indentStyle),this.outputStream.textEdit(this.uri,[new On(new ze(e,0,e,1073741824),o)]),this._didEdits=!0,this._didReplaceEdits=this._didReplaceEdits||!n,e+1}replaceLines(e,r,n){if(e>r)throw new Error("Invalid range");return e===r?this.replaceLine(e,n):(this.lines.splice(e,r-e+1,new pv(n.adjustedContent,this.indentStyle)),this.outputStream.textEdit(this.uri,[new On(new ze(e,0,r,1073741824),n.adjustedContent)]),this._didEdits=!0,this._didReplaceEdits=!0,e+1)}appendLineAtEndOfDocument(e){return this.lines.push(new pv(e.adjustedContent,this.indentStyle)),this.outputStream.textEdit(this.uri,[new On(new ze(this.lines.length-1,1073741824,this.lines.length-1,1073741824),`
`+e.adjustedContent)]),this._didEdits=!0,this.lines.length}insertLineAfter(e,r){return this.lines.splice(e+1,0,new pv(r.adjustedContent,this.indentStyle)),this.outputStream.textEdit(this.uri,[new On(new ze(e,1073741824,e,1073741824),`
`+r.adjustedContent)]),this._didEdits=!0,e+2}insertLineBefore(e,r){return e===this.lines.length?this.insertLineAfter(e-1,r):(this.lines.splice(e,0,new pv(r.adjustedContent,this.indentStyle)),this.outputStream.textEdit(this.uri,[new On(new ze(e,0,e,0),r.adjustedContent+`
`)]),this._didEdits=!0,e+1)}deleteLines(e,r){return this.lines.splice(e,r-e+1),this.outputStream.textEdit(this.uri,[new On(new ze(e,0,r+1,0),"")]),this._didEdits=!0,this._didReplaceEdits=!0,e+1}},E8=class{constructor(e,r,n,o){this.originalContent=e;this.originalIndentLevel=r;this.adjustedContent=n;this.adjustedIndentLevel=o;this.trimmedContent=this.originalContent.trim()}},w8=class{constructor(e){this.lineIndex=e}};var pv=class{constructor(e,r){this.content=e;this._indentStyle=r;this._sentInCodeBlock=0;this._trimmedContent=null;this._normalizedContent=null;this._indentLevel=-1}get isSent(){return this._sentInCodeBlock!==0}get sentInCodeBlock(){return this._sentInCodeBlock}get trimmedContent(){return this._trimmedContent===null&&(this._trimmedContent=this.content.trim()),this._trimmedContent}get normalizedContent(){return this._normalizedContent===null&&(this._normalizedContent=vX(this.content,this._indentStyle.tabSize,this._indentStyle.insertSpaces)),this._normalizedContent}get indentLevel(){return this._indentLevel===-1&&(this._indentLevel=x8(this.content,this._indentStyle.tabSize)),this._indentLevel}markSent(e){this._sentInCodeBlock=e}},TI=class t{static getDocumentIndentStyle(e,r){return r||uv(SI.fromString(e),4,!1)}static guessIndentStyleFromLine(e){let r=t._getLeadingWhitespace(e);if(!(r===""||r===" "))return uv([e],4,!1)}static reindentLine(e,r,n,o=s=>s){let s=x8(e,r.tabSize),a=o(s);for(;s>0;)e=this._outdent(e,r),s--;for(;s<a;)e="	"+e,s++;return vX(e,n.tabSize,n.insertSpaces)}static _outdent(e,r){let n=0;for(;n<e.length;){let o=e.charCodeAt(n);if(o===9){n++;break}if(o!==32||n===r.tabSize)break;n++}return e.substring(n)}static _getLeadingWhitespace(e){for(let r=0;r<e.length;r++){let n=e.charCodeAt(r);if(n!==32&&n!==9)return e.substring(0,r)}return e}};function RTe(t){return new Oo(async e=>{let r;(c=>(c[c.BeforeCodeBlock=0]="BeforeCodeBlock",c[c.InCodeBlock=1]="InCodeBlock",c[c.AfterCodeBlock=2]="AfterCodeBlock"))(r||={});let n=0;for await(let o of t){if(n===0){if(/^```/.test(o)){n=1,e.emitOne({value:o,kind:2});continue}}else n===1&&/^```/.test(o)&&(n=2);e.emitOne({value:o,kind:n===1?1:2})}})}var Nb=class{static combine(...e){return r=>e.every(n=>n?n(r):!0)}static{this.noop=()=>!0}static createCodeBlockFilter(){let e;(a=>(a[a.BeforeCodeBlock=0]="BeforeCodeBlock",a[a.InCodeBlock=1]="InCodeBlock",a[a.AfterCodeBlock=2]="AfterCodeBlock"))(e||={});let r=0;return n=>r===0?(/^```/.test(n.value)&&(r=1),!1):r===1?/^```/.test(n.value)?(r=2,!1):!0:!1}static createCodeMarkerRemovingFilter(e){let r=xs.begin(e),n=xs.end(e),o=!0,s=!1;return a=>o&&Ks.testLine(e,a.value)?(o=!1,!1):!s&&/^\s*$/.test(a.value)||a.value.startsWith(r)||a.value.startsWith(n)?!1:(s=!0,!0)}},R8=class{constructor(e){this.value=e;this.__lineOfTextBrand=void 0}};var CI=class{constructor(e,r){this.value=e;this.kind=r}},Ro=class t{static createCodeBlockClassifier(){return t.createFencedBlockClassifier("```")}static createAlwaysInsideCodeBlockClassifier(){return e=>Oo.map(e,r=>new CI(r,1))}static createFencedBlockClassifier(e){return r=>new Oo(async n=>{let o=new xX(r[Symbol.asyncIterator]()),s=0;for(;!o.endOfStream;)if(await o.peek(e.length)!==e)for(;!o.endOfStream;){let c=o.readImmediateExcept(`
`);if(c.length>0&&n.emitOne(new CI(c,s)),await o.peek(1)===`
`){o.readImmediate(1),n.emitOne(new CI(`
`,s));break}}else{let c="";for(;!o.endOfStream;){let u=o.readImmediateExcept(`
`);if(c+=u,await o.peek(1)===`
`){o.readImmediate(1),c+=`
`,s=s===1?0:1,n.emitOne(new CI(c,2));break}}}})}},xX=class{constructor(e){this._source=e;this._buffer="";this._atEnd=!1}get endOfStream(){return this._buffer.length===0&&this._atEnd}async extendBuffer(){if(this._atEnd)return;let{value:e,done:r}=await this._source.next();r?this._atEnd=!0:this._buffer+=e}async waitForLength(e){for(;this._buffer.length<e&&!this._atEnd;)await this.extendBuffer()}async peek(e){return await this.waitForLength(e),this._buffer.substring(0,e)}async read(e){await this.waitForLength(e);let r=this._buffer.substring(0,e);return this._buffer=this._buffer.substring(e),r}readImmediateExcept(e){let r=this._buffer.indexOf(e);return this.readImmediate(r===-1?this._buffer.length:r)}readImmediate(e){let r=this._buffer.substring(0,e);return this._buffer=this._buffer.substring(e),r}},k8=class{},A8=class t{constructor(e){this._source=e;this._buffer=[];this._atEnd=!1}static{this.EOS=new k8}get endOfStream(){return this._buffer.length===0&&this._atEnd}async extendBuffer(){if(this._atEnd)return;let{value:e,done:r}=await this._source.next();r?this._atEnd=!0:this._buffer.push(e)}async peek(){return this._buffer.length===0&&!this._atEnd&&await this.extendBuffer(),this._buffer.length===0?t.EOS:this._buffer[0]}async read(){return this._buffer.length===0&&!this._atEnd&&await this.extendBuffer(),this._buffer.length===0?t.EOS:this._buffer.shift()}async readWhile(e,r){do{let n=await this.peek();if(n instanceof k8||!e(n))break;await this.read(),await r(n)}while(!0)}async consumeToEnd(){for(;!this.endOfStream;)await this.read()}};function kTe(t){return new Oo(async e=>{let r="";for await(let n of t){r+=n;do{let o=r.indexOf(`
`);if(o===-1)break;let s=r.substring(0,o);r=r.substring(o+1),e.emitOne(new R8(s))}while(!0)}r.length>0&&e.emitOne(new R8(r))})}function SX(t,e){let r=!1,n=!1;return t.filter(o=>xI(o.value,e.languageId)?(e.addAdditionalImport(bX(o.value)),r=!0,!1):o.value.trim().length===0&&r?n:(n=!0,!0))}var d2=class extends Error{constructor(e){super(typeof e=="string"?e:e.message),this.errorDetails=typeof e=="string"?{message:e}:e}},ei=class extends rc{constructor(r){super();this.factory=r}},PI=class extends rc{constructor(r){super();this.followUps=r}},DI=class t{constructor(e){this.replyInterpreter=e;this._lastText=void 0}static createFactory(e){return()=>new t(e)}async processResponse(e,r,n){for await(let o of e)if(this._lastText=o.text,_8(this._lastText))break;if(!this._lastText)throw new Error("No text");return await this.replyInterpreter(this._lastText,r)}},P8=class t{static createFactory(){return()=>new t}async processResponse(e,r,n){for await(let o of e)r.markdown(o.delta.text);return{type:"conversational"}}};function vJe(t,e){let r=new im(t),n=e.map(o=>{let s=r.toOffsetRange(o.range);return{startOffset:s.start,endOffset:s.endExclusive,text:o.newText}});IX(n,(o,s)=>o.startOffset-s.startOffset||o.endOffset-s.endOffset);for(let o=n.length-1;o>=0;o--){let s=n[o];t=t.substring(0,s.startOffset)+s.text+t.substring(s.endOffset)}return t}function IX(t,e){if(t.length<=1)return t;let r=t.length/2|0,n=t.slice(0,r),o=t.slice(r);IX(n,e),IX(o,e);let s=0,a=0,c=0;for(;s<n.length&&a<o.length;)e(n[s],o[a])<=0?t[c++]=n[s++]:t[c++]=o[a++];for(;s<n.length;)t[c++]=n[s++];for(;a<o.length;)t[c++]=o[a++];return t}var im=class{constructor(e){this.textLength=e.length,this.lineStartOffsetByLineIdx=[],this.lineStartOffsetByLineIdx.push(0),this.lineLengthsByLineIdx=[];let r=0;for(let n=0;n<e.length;n++)e.charAt(n)===`
`?(this.lineStartOffsetByLineIdx.push(n+1),this.lineLengthsByLineIdx.push(r),r=0):r++;this.lineLengthsByLineIdx.push(r)}getLineCount(){return this.lineStartOffsetByLineIdx.length}getLineOffset(e){return this.lineStartOffsetByLineIdx[e]}getLineLength(e){return this.lineLengthsByLineIdx[e]}getOffset(e){return e=this.validatePosition(e),this.lineStartOffsetByLineIdx[e.line]+e.character}getPosition(e){e<0&&(e=0),e>this.textLength&&(e=this.textLength);let r=Bl(this.lineStartOffsetByLineIdx,s=>s<=e),n=r,o=e-this.lineStartOffsetByLineIdx[r];return new Xr(n,o)}toRange(e){return new ze(this.getPosition(e.start),this.getPosition(e.endExclusive))}toOffsetRange(e){return new Xt(this.getOffset(e.start),this.getOffset(e.end))}toOffsetEdit(e){let r=e.map(n=>new On(this.validateRange(n.range),n.newText));return new Zn(r.map(n=>new wo(this.toOffsetRange(n.range),n.newText)))}toTextEdits(e){return e.edits.map(r=>new On(this.toRange(r.replaceRange),r.newText))}validatePosition(e){let{line:r,character:n}=e;return r<0?(r=0,n=0):r>=this.lineLengthsByLineIdx.length?(r=this.lineLengthsByLineIdx.length-1,n=this.lineLengthsByLineIdx[r]):n<0?n=0:n>this.lineLengthsByLineIdx[r]&&(n=this.lineLengthsByLineIdx[r]),new Xr(r,n)}validateRange(e){return new ze(this.validatePosition(e.start),this.validatePosition(e.end))}},D8=class{constructor(e,r,n,o,s){this._accessor=e;this._selectionContextMetadata=r;this._context=n;this._editStrategy=o;this._extractCodeBlock=s;this._lastText=void 0;this._initialDocText=this._context.document.getText();this._documentInfo=Pb.fromDocumentContext(this._context)}async processResponse(e,r,n){let o=this._selectionContextMetadata.contextInfo,s=o.range.firstLineIndex,a=o.range.firstLineIndex+o.range.lines.length-1,c;{let f=[],m=(g,v)=>{for(let y=0;y<g.lines.length;y++){let _=g.firstLineIndex+y;f.push(new RI(_,v))}};m(o.above,1),m(o.range,2),m(o.below,3);let h=new kI(s,a);c=new AI(r,this._context.document.uri,this._context.document.getText(),f,h,this._context.document.languageId,this._context.fileIndentInfo)}let u=new p2(r,0,1,this._extractCodeBlock?Ro.createCodeBlockClassifier():Ro.createAlwaysInsideCodeBlockClassifier(),new EI(c,this._context.selection,new jm(s,0,a,this._context.document.lineAt(a).text.length),this._editStrategy,!$t(this._context.document.uri),Nb.createCodeMarkerRemovingFilter(this._context.language)));for await(let f of e){this._lastText=f.text;let{shouldFinish:m}=u.update(f.text);if(m)break}if(!this._lastText)throw new Error("No text");let{didEdits:l}=await u.finish(),d=await this._interpretReply(this._lastText,r),p=d.type==="inlineEdit"&&l&&$t(this._context.document.uri);if(d.type==="inlineEdit"){let f=vJe(this._initialDocText,d.edits);return{type:"inlineEdit",edits:p?[]:[{range:new ze(new Xr(0,0),new Xr(Number.MAX_SAFE_INTEGER,0)),newText:f}],newWholeRange:d.newWholeRange}}return l&&r.textEdit(this._context.document.uri,[{range:new ze(new Xr(0,0),new Xr(Number.MAX_SAFE_INTEGER,0)),newText:this._initialDocText}]),d}_interpretReply(e,r){let{contextInfo:n,wholeRange:o}=this._selectionContextMetadata;if(this._extractCodeBlock){let s=II(n,e,this._context.language);if(!s)return r.markdown(e),{type:"conversational"};let{code:a}=s,c=lv(this._accessor,n,a,this._editStrategy,this._context.fileIndentInfo,this._documentInfo);return Db(c,o)}else{let s=lv(this._accessor,n,e,this._editStrategy,this._context.fileIndentInfo,this._documentInfo);return Db(s,o)}}};var p2=class{constructor(e,r,n,o,s){this._outputStream=e;this._leadingMarkdown=r;this._earlyStopping=n;this._responseStream=new l0;this._lastLength=0;this._leftFirstCodeBlock=!1;let a=o(this._responseStream.asyncIterable);this._streamingPromise=this._process(a,s)}async _process(e,r){let n=new l0,o=kTe(n.asyncIterable),s=r.processStream(o),a=e.filter(u=>u.kind!==2),c=new A8(a[Symbol.asyncIterator]());return await c.readWhile(u=>u.kind===0,u=>this._handleLeadingMarkdown(u)),await c.readWhile(u=>u.kind===1,u=>n.emitOne(u.value)),this._leftFirstCodeBlock=!0,await c.consumeToEnd(),n.resolve(),s}_handleLeadingMarkdown(e){this._leadingMarkdown===1&&this._outputStream.markdown(e.value)}update(e){if(this._earlyStopping===1&&this._leftFirstCodeBlock)return{shouldFinish:!0};let r=e.slice(this._lastLength);return this._lastLength=e.length,this._responseStream.emitOne(r),{shouldFinish:!1}}async finish(){return this._responseStream.resolve(),await this._streamingPromise}};var b2=W(ct());var ir=class extends Y{render(){return vscpp(vscppf,null,"Follow Microsoft content policies.",vscpp("br",null),"Avoid content that violates copyrights.",vscpp("br",null),`If you are asked to generate content that is harmful, hateful, racist, sexist, lewd, violent, or completely irrelevant to software engineering, only respond with "Sorry, I can't assist with that."`,vscpp("br",null),"Keep your answers short and impersonal.")}};var N8=W(ct());var NI=W(ct()),om=class extends Y{render(){return vscpp(vscppf,null,this.props.children)}};var qt=class extends Y{render(e,r){let n=[],o=this.props.history.filter(s=>s.status==="success"||s.status==="in-progress");for(let s of o)s.request.type==="user"&&n.push(vscpp(N8.UserMessage,null,s.request.message)),s.response?.type==="model"&&n.push(vscpp(N8.AssistantMessage,{name:s.response.name},s.response.message));return vscpp(NI.PrioritizedList,{priority:this.props.priority,descending:!1},n)}};var LI=W(ct());var Lb=class extends Y{constructor(e,r){super(e,r),this._contextService=r.get(zt),this._telemetryService=r.get(me),this._logService=r.get(ce),this._ignoreService=r.get(De)}_handleFoulPrompt(){let e=new Error("BAD PROMPT");if(this._logService.defaultLogger.error(e),this._contextService.extensionMode!==qc.Production)throw e;this._telemetryService.sendMSFTTelemetryErrorEvent("prompt.invalidreference",{stack:e.stack})}},Oe=class extends Lb{async prepare(e,r,n){return{isIgnored:this.props.uri?await this._ignoreService.isCopilotIgnored(this.props.uri):!1}}render(e){if(e.isIgnored)return this._handleFoulPrompt();let r=ki(this.props.languageId??"",this.props.code,this.props.shouldTrim??!0);return vscpp(LI.TextChunk,null,this.props.references&&vscpp("references",{value:this.props.references}),r)}},L8=class extends Lb{async prepare(e,r,n){return{isIgnored:this.props.uri?await this._ignoreService.isCopilotIgnored(this.props.uri):!1}}render(e){if(e.isIgnored)return this._handleFoulPrompt();let r=ki(this.props.languageId??"",this.props.code,this.props.shouldTrim??!0);return this.props.uri?vscpp(LI.TextChunk,null,vscpp("references",{value:[new LI.PromptReference(this.props.range?new yi(this.props.uri,this.props.range):this.props.uri)]}),r):vscpp(LI.TextChunk,null,r)}};var ga=class extends Lb{get insertLineBreakBefore(){return!1}async prepare(){return{isIgnored:await this._ignoreService.isCopilotIgnored(this.props.value)}}render(e){if(e.isIgnored)return this._handleFoulPrompt();let r;return this.props.mode===1?r=this.props.value.path:r=Uc(this.props.value),vscpp(vscppf,null,r)}};var UI=W(ct());function NTe(t,e,r){let n=e.getText(),o=f2.convertToLinkedTree(n,LTe(t,n)),s=e.offsetAt(r.start),a=e.offsetAt(r.end);return{adjusted:_Je(o,s,a),original:new Xt(s,a)}}function LTe(t,e){let r=yJe(t.startIndex,e),n=bJe(t.endIndex,e),o=t.children.map(s=>LTe(s,e));return r===t.startIndex&&n===t.endIndex&&D7(o,t.children)?t:new Ql(r,n,t.kind,o)}function yJe(t,e){for(;t<e.length;){let r=e.charCodeAt(t);if(r!==32&&r!==9&&r!==10&&r!==13)return t;t++}return t}function bJe(t,e){for(;t>0;){let r=e.charCodeAt(t-1);if(r!==32&&r!==9&&r!==10&&r!==13)return t;t--}return t}function _Je(t,e,r){return[e,r]=xJe(t,e,r),SJe(t,e,r)}function xJe(t,e,r){let n=t.text.substring(e,r);if(!/^\s*$/.test(n))return[e,r];let s=e,a=r,c=!0,u=!0;do{if(u&&a>=t.text.length&&(u=!1),u){let l=t.text.charCodeAt(a);if(l===13||l===10)u=!1;else{if(l!==32&&l!==9)return[a,a+1];a++}}if(c&&s===0&&(c=!1),c){let l=t.text.charCodeAt(s-1);if(l===13||l===10)c=!1;else{if(l!==32&&l!==9)return[s-1,s];s--}}}while(c||u);return[e,r]}function SJe(t,e,r){e>0&&e<r&&t.text.charCodeAt(e-1)!==10&&t.text.charCodeAt(e)===10&&e++,e=PTe(t,e),r=DTe(t,r);let n=t.findLeaf2(e),o=t.findLeaf2(r),s=!1,a=u=>{u<e&&(e=PTe(t,u),s=!0,n=t.findLeaf2(e))},c=u=>{u>r&&(r=DTe(t,u),s=!0,o=t.findLeaf2(r))};do{if(s=!1,n instanceof m2){let u=n.isFirstGapInParent?n.parent.lastGap:null,l=n.hasSelectedContent(e,r),d=u&&u.hasSelectedContent(e,r),p=l||d;p&&a(n.firstNonWhitespaceIndex),p&&u&&c(u.lastNonWhitespaceIndex+1)}if(o instanceof m2){let u=o.isLastGapInParent?o.parent.firstGap:null,l=o.hasSelectedContent(e,r),d=u&&u.hasSelectedContent(e,r),p=l||d;p&&o.lastNonWhitespaceIndex+1>r&&c(o.lastNonWhitespaceIndex+1),p&&u&&a(u.firstNonWhitespaceIndex)}n instanceof f2&&t.hasContentInRange(new Xt(e,r))&&n.startIndex<e&&a(n.startIndex),o instanceof f2&&t.hasContentInRange(new Xt(e,r))&&o.endIndex>r&&c(o.endIndex)}while(s);return new Xt(e,r)}function PTe(t,e){for(;e>0;){let r=t.text.charCodeAt(e-1);if(r!==32&&r!==9)break;e--}return e}function DTe(t,e){if((e>0?t.text.charCodeAt(e-1):0)===10)return e;for(;e<t.text.length;){let n=t.text.charCodeAt(e);if(n!==32&&n!==9)break;e++}return e}function OTe(t){return t.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")}var f2=class t{constructor(e,r,n,o,s,a,c){this._originalText=e;this.parent=r;this.startIndex=n;this.endIndex=o;this.kind=s;this.children=a;this.myIndex=c}static convertToLinkedTree(e,r){let n=new t(e,null,r.startIndex,r.endIndex,r.kind,[],0);return t._convertChildrenToLinkedTree(e,r,n),n}static _convertChildrenToLinkedTree(e,r,n){for(let o=0;o<r.children.length;o++){let s=r.children[o],a=new t(e,n,s.startIndex,s.endIndex,s.kind,[],o);n.children.push(a),t._convertChildrenToLinkedTree(e,s,a)}}get text(){return this._originalText.substring(this.startIndex,this.endIndex)}textAt(e){return e.substring(this._originalText)}hasContentInRange(e){let r=this.textAt(e);return!/^\s*$/s.test(r)}toString(){return`Node (${this.startIndex}-${this.endIndex}) ${OTe(this._originalText.substring(this.startIndex,this.endIndex))}`}gapBeforeChild(e){let r=e===0?this.startIndex:this.children[e-1].endIndex,n=e===this.children.length?this.endIndex:this.children[e].startIndex;return new m2(this._originalText,this,r,n,e)}childAt(e){return this.children[e]??null}get firstGap(){return this.children.length===0?null:this.gapBeforeChild(0)}get lastGap(){return this.children.length===0?null:this.gapBeforeChild(this.children.length)}findLeaf(e){if(this.children.length===0)return[this,0];let r=nre(this.children.length,n=>{let o=this.children[n];return e>=o.startIndex&&e<=o.endIndex?0:e<o.startIndex?1:-1});return r<0?[this,r]:this.children[r].findLeaf(e)}findLeaf2(e){let[r,n]=this.findLeaf(e);return n<0?r.gapBeforeChild(~n):r}get nextLeaf(){let e=this;do{let r=e.nextSibling;if(r)return r.leftMostLeafChild;e=e.parent}while(e);return null}get leftMostLeafChild(){let e=this;for(;e.children.length>0;)e=e.children[0];return e}get prevSibling(){let e=this.parent,r=this.myIndex-1;return e&&r>=0?e.children[r]:null}get nextSibling(){let e=this.parent,r=this.myIndex+1;return e&&r<e.children.length?e.children[r]:null}},m2=class{constructor(e,r,n,o,s){this._originalText=e;this.parent=r;this.startIndex=n;this.endIndex=o;this.gapIndex=s;if(this.startIndex>this.endIndex)throw new Qr("Invalid gap")}get range(){return new Xt(this.startIndex,this.endIndex)}get isFirstGapInParent(){return this.gapIndex===0}get isLastGapInParent(){return this.gapIndex===this.parent.children.length}toString(){return`NodeGap (${this.startIndex}-${this.endIndex}) ${OTe(this._originalText.substring(this.startIndex,this.endIndex))}`}get text(){return this._originalText.substring(this.startIndex,this.endIndex)}hasSelectedContent(e,r){let n=this.range.intersect(new Xt(e,r)),o=n?this._originalText.substring(n.start,n.endExclusive):"";return!/^\s*$/s.test(o)}get firstNonWhitespaceIndex(){let e=this.startIndex;for(;e<this.endIndex;){let r=this._originalText.charCodeAt(e);if(r!==9&&r!==32&&r!==10)return e;e++}return this.endIndex}get lastNonWhitespaceIndex(){let e=this.endIndex-1;for(;e>=this.startIndex;){let r=this._originalText.charCodeAt(e);if(r!==9&&r!==32&&r!==10)return e;e--}return this.startIndex-1}get nextLeaf(){let e=this.parent.childAt(this.gapIndex);return e?e.leftMostLeafChild:this.parent.nextLeaf}};function CX(t,e){let r=e(t);return{...r,range:[r.range.start,r.range.endExclusive],children:r.children?.map(n=>CX(n,e))}}function MTe(t,e){let r=p_(e,a=>a.endExclusive>=t.start),n=Bl(e,a=>a.start<=t.endExclusive)+1;if(r===n)return[t];let o=[],s=t.start;for(let a=r;a<n;a++){let c=e[a];c.start>s&&o.push(new Xt(s,c.start)),s=c.endExclusive}return s<t.endExclusive&&o.push(new Xt(s,t.endExclusive)),o}var sm=class{constructor(e,r,n){this.originalText=e;this.edits=r;this.languageId=n;this._positionOffsetTransformer=new Lo(()=>new im(this.text));this._originalPositionOffsetTransformer=new Lo(()=>new im(this.originalText));this._text=new Lo(()=>this.edits.apply(this.originalText))}get positionOffsetTransformer(){return this._positionOffsetTransformer.value}get originalPositionOffsetTransformer(){return this._originalPositionOffsetTransformer.value}get text(){return this._text.value}get lineCount(){return this.positionOffsetTransformer.getLineCount()}project(e){return this.edits.applyToOffset(e)}projectOffsetRange(e){return this.edits.applyToOffsetRange(e)}projectRange(e){let r=this.originalPositionOffsetTransformer.toOffsetRange(e),n=this.projectOffsetRange(r);return this.positionOffsetTransformer.toRange(n)}projectBack(e){return this.edits.applyInverseToOffset(e)}projectBackOffsetEdit(e){return e.tryRebase(this.edits.inverse(this.text))}projectBackTextEdit(e){let r=this.positionOffsetTransformer.toOffsetEdit(e),n=this.projectBackOffsetEdit(r);return this.originalPositionOffsetTransformer.toTextEdits(n)}};function FTe(t){return t*4}async function UTe(t,e,r,n,o,s){let a=await Ab(t,e,r),c=NTe(a,e,n),u=MI(FTe(o),e,n,a,s);return{document:u,adjustedSelection:u.projectOffsetRange(c.adjusted),selection:u.projectOffsetRange(c.original)}}async function M8(t,e,r,n,o,s){let a=await Ab(t,e,r);return MI(FTe(o),e,n,a,s)}function MI(t,e,r,n,o={}){let s=e.getText(),a=new Xt(e.offsetAt(r.start),e.offsetAt(r.end)),c=TX.fromNode(n,s),u=EX.fromNode(c,!!o.tryPreserveTypeChecking);u.visitAll(S=>S.node.range.intersectsOrTouches(a)?(S.node.children.length===0&&S.markAsSurviving(),!0):!1);let l=u.getTextFragment(),d=S=>S.range.endExclusive<a.start?a.start-S.range.endExclusive:S.range.start>a.endExclusive?3*(S.range.start-a.endExclusive):0,p=new uE(S=>S.children.length===0?S.range.intersectsOrTouches(a)?0:Number.MAX_SAFE_INTEGER:Math.min(...S.children.map(I=>p.get(I)))+1),f=new uE(S=>{let I=S.parent?f.get(S.parent):Number.MAX_SAFE_INTEGER,w=p.get(S);return Math.min(I,w)}),m=!!o.tryPreserveTypeChecking,h=S=>m&&S.node?.kind==="import_statement"?0:100*f.get(S)+S.depth+10*(d(S)/s.length),g=o.costFnOverride;if(g!==void 0){let S=h;h=I=>{if(!I.node)return 0;let w=S(I);return g(I.node,w)}}let y=u.getDescendantsAndSelf().map(S=>({node:S,cost:h(S.node)}));y.sort(zA(S=>S.cost,GA));for(let{node:S}of y){S.markAsSurviving();let I=u.getTextFragment();if(I.length>t)break;l=I}let _=new sm(s,l.toTextEditFromOriginal(s.length),e.languageId),b=_;return b.getVisualization=()=>({$fileExtension:"ast.w",source:{value:_.originalText,decorations:MTe(Xt.ofLength(_.originalText.length),_.edits.edits.map(S=>S.replaceRange)).map(S=>({range:[S.start,S.endExclusive],color:"lime"}))},root:CX(u,S=>({label:(S.node.node?.kind||"unknown")+` (${y.find(I=>I.node===S)?.cost})`,range:S.node.range,children:S.childNodes,isMarked:S._surviving}))}),_}var TX=class t{constructor(e,r,n,o,s,a){this.node=e;this.range=r;this.children=n;this.depth=o;this.parent=s;this.document=a}static fromNode(e,r,n=0,o=null){let s=new Xt(e.startIndex,e.endIndex),a=[],c=new t(e,s,a,n,o,r);if(e.children.length>0){let u=e.startIndex;for(let d of e.children){let p=new Xt(u,d.startIndex);p.isEmpty||a.push(new t(void 0,p,[],n,c,r)),a.push(t.fromNode(d,r,n+1,c)),u=d.endIndex}let l=new Xt(u,e.endIndex);l.isEmpty||a.push(new t(void 0,l,[],n,c,r))}return c}},EX=class t{constructor(e,r,n,o){this.node=e;this.parent=r;this.childNodes=n;this._tryPreserveTypeChecking=o;this._surviving=!1;this._textFragment=null}static fromNode(e,r){return t.fromNodeParent(e,null,r)}static fromNodeParent(e,r,n){let o=[],s=new t(e,r,o,n);for(let a of e.children){let c=t.fromNodeParent(a,s,n);o.push(c)}return s}visitAll(e){if(e(this))for(let r of this.childNodes)r.visitAll(e)}markAsSurviving(){this._surviving||(this._surviving=!0,this.parent&&this.parent.markAsSurviving(),this.invalidate())}invalidate(){this._textFragment&&(this._textFragment=null,this.parent&&this.parent.invalidate())}getTextFragment(){return this._textFragment||(this._textFragment=this._computeSummarization()),this._textFragment}_computeSummarization(){if(this.childNodes.length===0&&(this._surviving||!this.node.node))return new mv(this.node.range,this.node.document);if(!this._surviving)return new OI("");let e=[];for(let r of this.childNodes){let n=r.getTextFragment();if(n.length===0){e.length>0&&e[e.length-1].length===0||e.push(n);continue}IJe(e,n)}for(let r=0;r<=e.length-3;r++){let n=e[r],o=e[r+1],s=e[r+2];if(o.length===0&&n instanceof mv&&s instanceof mv){let a=n.trimEnd(),c=s.trimStart();a.endsWith("{")&&c.startsWith("}")&&(e[r]=a,e[r+1]=new OI(this._tryPreserveTypeChecking?"/* ... */":"\u2026"),e[r+2]=c)}}return O8.from(e)}getDescendantsAndSelf(){let e=[];return this._getDescendantsAndSelf(e),e}_getDescendantsAndSelf(e){e.push(this);for(let r of this.childNodes)r._getDescendantsAndSelf(e)}},h2=class{toTextEditFromOriginal(e){let r=[],n=0,o="";function s(c){(n!==c||o.length>0)&&(r.push(new wo(new Xt(n,c),o)),o="")}function a(c){if(c instanceof O8)for(let u of c.fragments)a(u);else c instanceof OI?o+=c.text:c instanceof mv&&(s(c.range.start),n=c.range.endExclusive)}return a(this),s(e),new Zn(r)}},OI=class extends h2{constructor(r){super();this.text=r}get length(){return this.text.length}},mv=class t extends h2{constructor(r,n){super();this.range=r;this.originalText=n}get length(){return this.range.length}get text(){return this.range.substring(this.originalText)}trimStart(){let r=this.text.trimStart();return r.length===this.length?this:new t(new Xt(this.range.endExclusive-r.length,this.range.endExclusive),this.originalText)}trimEnd(){let r=this.text.trimEnd();return r.length===this.length?this:new t(new Xt(this.range.start,this.range.start+r.length),this.originalText)}startsWith(r){return this.text.startsWith(r)}endsWith(r){return this.text.endsWith(r)}tryJoin(r){return this.range.endExclusive===r.range.start?new t(new Xt(this.range.start,r.range.endExclusive),this.originalText):null}},O8=class t extends h2{constructor(r){super();this.fragments=r;this.length=this.fragments.reduce((r,n)=>r+n.length,0)}static from(r){return r.length===0?new OI(""):r.length===1?r[0]:new t(r)}get text(){return this.fragments.map(r=>r.text).join("")}};function IJe(t,e){if(e.length===0)return;let r=t[t.length-1];if(r&&r instanceof mv&&e instanceof mv){let n=r.tryJoin(e);if(n){t[t.length-1]=n;return}}t.push(e)}var F8=class{constructor(e){this._derivedDocument=e;this._workingCopyOriginalDocument=new wX(this._derivedDocument.originalText)}get originalText(){return this._workingCopyOriginalDocument.text}get text(){return this._derivedDocument.text}get languageId(){return this._derivedDocument.languageId}get derivedDocumentTransformer(){return this._derivedDocument.positionOffsetTransformer}get originalDocumentTransformer(){return this._workingCopyOriginalDocument.transformer}get allReportedEdits(){return this._workingCopyOriginalDocument.appliedEdits}createDerivedDocumentChatResponseStream(e){return new nm(r=>{let n=this.applyAndTransformProgressItem(r);e.push(n)})}applyAndTransformProgressItem(e){if(!(e instanceof Mp))return e;let r=this._workingCopyOriginalDocument,n=this._derivedDocument,o=n.edits,a=BTe(n.positionOffsetTransformer,e.edits).tryRebase(o.inverse(r.text)),c=o.tryRebase(a),u=new Mp(e.uri,qTe(r.transformer,a));return this._workingCopyOriginalDocument.applyOffsetEdits(a),this._derivedDocument=new sm(this._workingCopyOriginalDocument.text,c,this._derivedDocument.languageId),u}rebaseEdits(e){let r=this._workingCopyOriginalDocument,n=this._derivedDocument,o=n.edits,a=BTe(n.positionOffsetTransformer,e).tryRebase(o.inverse(r.text));return qTe(r.transformer,a)}convertPostEditsOffsetToOriginalOffset(e){return this._derivedDocument.projectBack(e)}},wX=class{constructor(e){this._text=e;this._transformer=null;this._appliedEdits=new Zn([])}get text(){return this._text}get transformer(){return this._transformer||(this._transformer=new im(this._text)),this._transformer}get appliedEdits(){return this._appliedEdits}applyOffsetEdits(e){let{edits:r}=e,n=this._text;for(let o=r.length-1;o>=0;o--){let s=r[o];n=n.substring(0,s.replaceRange.start)+s.newText+n.substring(s.replaceRange.endExclusive)}this._text=n,this._transformer=null,this._appliedEdits=this._appliedEdits.compose(e)}},U8=class{constructor(e){this._text=e;this._transformer=null}get text(){return this._text}get transformer(){return this._transformer||(this._transformer=new im(this._text)),this._transformer}};function BTe(t,e){return t.toOffsetEdit(e)}function qTe(t,e){return t.toTextEdits(e)}var FI=class extends Y{constructor(r,n,o,s,a,c){super(r,n);this._ignoreService=o;this._parserService=s;this._experimentationService=a;this._configurationService=c}async prepare(r){let{documentContext:n}=this.props,o=await this._ignoreService.isCopilotIgnored(n.document.uri),s=n.document.validateRange(n.wholeRange),a=await Au(this._parserService,this._experimentationService,n.document,n.fileIndentInfo,n.language,s,r.endpoint.modelMaxPromptTokens/3),c=await this._configurationService.getExperimentBasedConfig(ge.ProjectLabelsInline,this._experimentationService);return{summarizedDocument:a,isIgnored:o,useProjectLabels:c}}render(r,n){if($t(this.props.documentContext.document.uri))throw Ar("InlineChatGenerateCodePrompt should not be used with a notebook!");if(this.props.documentContext.language.languageId==="markdown")throw Ar("InlineChatGenerateCodePrompt should not be used with a markdown document!");if(r.isIgnored)return vscpp("ignoredFiles",{value:[this.props.documentContext.document.uri]});let{uri:o,languageId:s}=r.summarizedDocument,a=r.summarizedDocument.splitAroundOriginalSelectionEnd(),{codeAbove:c,hasContent:u,codeBelow:l}=a,d=`${c}$PLACEHOLDER$${l}`,p=a.createReplyInterpreterFactory(1,1,n.endpoint.model==="gpt-4"?a.insertStreaming:a.insertOrReplaceStreaming,Ro.createCodeBlockClassifier(),f=>f.value.trim()!=="$PLACEHOLDER$");return vscpp(vscppf,null,vscpp("meta",{value:new ei(p)}),vscpp(UI.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"You are a world class expert in programming, and especially good at ",s,".",vscpp("br",null),"Source code is always contained in ``` blocks.",vscpp("br",null),"The user needs help to write some new code.",vscpp("br",null),u&&vscpp(vscppf,null,"The user includes existing code and marks with $PLACEHOLDER$ where the new code should go.",vscpp("br",null)),u&&vscpp(vscppf,null,'DO NOT include the text "$PLACEHOLDER$" in your reply.',vscpp("br",null)),u&&vscpp(vscppf,null,"DO NOT repeat any code from the user in your reply.",vscpp("br",null)),!u&&vscpp(vscppf,null,"Your must generate a code block surrounded with ``` that will be used in a new file",vscpp("br",null)),vscpp(ir,null)),r.useProjectLabels&&vscpp(Qo,{priority:600}),this.props.history&&vscpp(qt,{priority:700,history:this.props.history}),u&&vscpp(UI.UserMessage,{priority:800},"I have the following code in a file called `",vscpp(ga,{value:o,mode:1}),"`:",vscpp(Oe,{uri:o,languageId:s,code:d,shouldTrim:!1})),!u&&vscpp(UI.UserMessage,{priority:800},"I am in an empty file `",vscpp(ga,{value:o,mode:1}),"`."),vscpp(UI.UserMessage,{priority:900},this.props.query,vscpp("br",null),u&&vscpp(vscppf,null,"The code that would fit at $PLACEHOLDER$ with ``` is:")))}};FI=B([T(2,De),T(3,_t),T(4,Lt),T(5,be)],FI);async function Au(t,e,r,n,o,s,a){let c=await UTe(t,r,n,s,a);return new RX(c.selection,c.adjustedSelection,c.document,r,n,o)}var RX=class{constructor(e,r,n,o,s,a){this._selection=e;this._adjustedSelection=r;this._projectedDocument=n;this._document=o;this._formattingOptions=s;this.language=a}get uri(){return this._document.uri}get languageId(){return this._document.languageId}splitAroundAdjustedSelection(){return new B8(this._projectedDocument,this.uri,this._formattingOptions,this._adjustedSelection)}splitAroundOriginalSelectionEnd(){return new B8(this._projectedDocument,this.uri,this._formattingOptions,new Xt(this._selection.endExclusive,this._selection.endExclusive))}},B8=class{constructor(e,r,n,o){this._projectedDocument=e;this._uri=r;this._formattingOptions=n;this._selection=this._projectedDocument.positionOffsetTransformer.toRange(o),this.codeAbove=this._projectedDocument.text.substring(0,o.start),this.codeSelected=this._projectedDocument.text.substring(o.start,o.endExclusive),this.codeBelow=this._projectedDocument.text.substring(o.endExclusive)}get hasCodeWithoutSelection(){return this.codeAbove.trim().length>0||this.codeBelow.trim().length>0}get hasContent(){return this.codeAbove.trim().length>0||this.codeSelected.trim().length>0||this.codeBelow.trim().length>0}get replaceSelectionStreaming(){return(e,r)=>new C8(r,this._selection,e)}get insertStreaming(){return(e,r)=>new I8(r,this._selection.end,e)}get insertOrReplaceStreaming(){return(e,r)=>new EI(r,this._selection,this._selection,3,!0,e)}createReplyInterpreterFactory(e,r,n,o,s){return()=>new kX(this._uri,this._projectedDocument,this._formattingOptions,e,r,n,o,s)}},kX=class{constructor(e,r,n,o,s,a,c,u){this._uri=e;this._fileIndentInfo=n;this._leadingMarkdownStreaming=o;this._earlyStopping=s;this._streamingStrategyFactory=a;this._textPieceClassifier=c;this._lineFilter=u;this._lastText=void 0;this._initialDocumentSnapshot=new U8(r.originalText),this._workingCopySummarizedDoc=new F8(r)}async processResponse(e,r,n){let o=this._workingCopySummarizedDoc.createDerivedDocumentChatResponseStream(r),s=new AI(o,this._uri,this._workingCopySummarizedDoc.text,this._workingCopySummarizedDoc.text.split(`
`).map((l,d)=>new RI(d,4)),new kI(0,0),this._workingCopySummarizedDoc.languageId,this._fileIndentInfo),a=new p2(o,this._leadingMarkdownStreaming,this._earlyStopping,this._textPieceClassifier,this._streamingStrategyFactory(this._lineFilter,s));for await(let l of e){this._lastText=l.text;let{shouldFinish:d}=a.update(l.text);if(d)break}let{didEdits:c,additionalImports:u}=await a.finish();if(c){let l=this._generateAdditionalImportsEdits(u),d=this._workingCopySummarizedDoc.allReportedEdits.inverse(this._initialDocumentSnapshot.text),p=d.edits.reduce((h,g)=>h.join(g.replaceRange),d.edits[0].replaceRange),f=this._workingCopySummarizedDoc.originalDocumentTransformer.toRange(p),m={lastDocumentContent:this._workingCopySummarizedDoc.originalText,lastWholeRange:f};return{type:"inlineEdit",edits:l,newWholeRange:void 0,store:m}}if(u.length>0)return{type:"inlineEdit",edits:this._generateAdditionalImportsEdits(u),newWholeRange:void 0,store:void 0};if(!this._lastText)throw new Error("No text");return o.markdown(this._lastText),{type:"conversational"}}_generateAdditionalImportsEdits(e){if(e.length===0)return[];let r=this._workingCopySummarizedDoc.originalText.split(/\r\n|\r|\n/g),n=A7(r,s=>xI(s,this._workingCopySummarizedDoc.languageId));if(n===-1)return[new On(new ze(0,0,0,0),e.join(`
`)+`

`)];let o=r[n].length;return[new On(new ze(n,o,n,o),`
`+e.join(`
`))]}};var BI=class extends Y{constructor(r,n,o,s,a,c){super(r,n);this._ignoreService=o;this._parserService=s;this._experimentationService=a;this._configurationService=c}async prepare(r){let{documentContext:n}=this.props,o=await this._ignoreService.isCopilotIgnored(n.document.uri),s=n.document.validateRange(n.wholeRange),a=await Au(this._parserService,this._experimentationService,n.document,n.fileIndentInfo,n.language,s,r.endpoint.modelMaxPromptTokens/3),c=await this._configurationService.getExperimentBasedConfig(ge.ProjectLabelsInline,this._experimentationService);return{summarizedDocument:a,isIgnored:o,useProjectLabels:c}}render(r,n){if($t(this.props.documentContext.document.uri))throw Ar("InlineChatEditCodePrompt should not be used with a notebook!");if(this.props.documentContext.language.languageId==="markdown")throw Ar("InlineChatEditCodePrompt should not be used with a markdown document!");if(r.isIgnored)return vscpp("ignoredFiles",{value:[this.props.documentContext.document.uri]});let{uri:o,languageId:s}=r.summarizedDocument,a=r.summarizedDocument.splitAroundAdjustedSelection(),{codeAbove:c,codeSelected:u,codeBelow:l,hasCodeWithoutSelection:d}=a,p=`${c}$SELECTION_PLACEHOLDER$${l}`,f=a.createReplyInterpreterFactory(1,1,a.replaceSelectionStreaming,Ro.createCodeBlockClassifier(),m=>m.value.trim()!=="$SELECTION_PLACEHOLDER$");return vscpp(vscppf,null,vscpp("meta",{value:new ei(f)}),vscpp(b2.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"You are a world class expert in programming, and especially good at ",s,".",vscpp("br",null),"Source code is always contained in ``` blocks.",vscpp("br",null),"The user needs help to modify some code.",vscpp("br",null),d&&vscpp(vscppf,null,"The user includes existing code and marks with $SELECTION_PLACEHOLDER$ where the selected code should go.",vscpp("br",null)),vscpp(ir,null)),this.props.history&&vscpp(qt,{priority:700,history:this.props.history}),r.useProjectLabels&&vscpp(Qo,{priority:600}),vscpp(b2.UserMessage,{priority:800},"I have the following code in a file called `",vscpp(ga,{value:o,mode:1}),"`:",d&&vscpp(vscppf,null,vscpp(Oe,{uri:o,languageId:s,code:p,shouldTrim:!1}),vscpp("br",null)),d&&vscpp(vscppf,null,"The $SELECTION_PLACEHOLDER$ code is:",vscpp("br",null)),vscpp(Oe,{uri:o,languageId:s,code:u,shouldTrim:!1})),vscpp(b2.UserMessage,{priority:900},this.props.query,vscpp("br",null),d&&vscpp(vscppf,null,"The modified $SELECTION_PLACEHOLDER$ code with ``` is:")))}};BI=B([T(2,De),T(3,_t),T(4,Lt),T(5,be)],BI);var gv=W(ct());var hv=W(ct());var qI=class extends Y{constructor(r,n,o,s,a){super(r,n);this._ignoreService=o;this._parserService=s;this._experimentationService=a}async prepare(r){let{documentContext:n}=this.props,o=await this._ignoreService.isCopilotIgnored(n.document.uri),s=n.document.validateRange(n.wholeRange);return{summarizedDocument:await Au(this._parserService,this._experimentationService,n.document,n.fileIndentInfo,n.language,s,r.endpoint.modelMaxPromptTokens/3),isIgnored:o}}render(r,n){if($t(this.props.documentContext.document.uri))throw Ar("InlineChatGenerateMarkdownPrompt should not be used with a notebook!");if(this.props.documentContext.language.languageId!=="markdown")throw Ar("InlineChatGenerateMarkdownPrompt should only be used with markdown documents!");if(r.isIgnored)return vscpp("ignoredFiles",{value:[this.props.documentContext.document.uri]});let{uri:o}=r.summarizedDocument,s=r.summarizedDocument.splitAroundOriginalSelectionEnd(),{codeAbove:a,hasContent:c,codeBelow:u}=s,l=`${a}$PLACEHOLDER$${u}`,d=s.createReplyInterpreterFactory(1,0,s.insertStreaming,Ro.createFencedBlockClassifier(Ys.FenceSequence),p=>p.value.trim()!=="$PLACEHOLDER$");return vscpp(vscppf,null,vscpp("meta",{value:new ei(d)}),vscpp(hv.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"You are a world class markdown editor, very well versed in programming.",vscpp("br",null),"The user needs help to write some new markdown.",vscpp("br",null),"The markdown is always delimited by ",Ys.FenceSequence,".",vscpp("br",null),c&&vscpp(vscppf,null,"The user includes existing markdown and marks with $PLACEHOLDER$ where the new code should go.",vscpp("br",null)),c&&vscpp(vscppf,null,'DO NOT include the text "$PLACEHOLDER$" in your reply.',vscpp("br",null)),c&&vscpp(vscppf,null,"DO NOT repeat any markdown from the user in your reply.",vscpp("br",null)),!c&&vscpp(vscppf,null,"Your answer must begin and end with ",Ys.FenceSequence,vscpp("br",null)),vscpp(ir,null)),this.props.history&&vscpp(qt,{priority:700,history:this.props.history}),c&&vscpp(hv.UserMessage,{priority:800},"I have the following markdown in a file called `",vscpp(ga,{value:o,mode:1}),"`:",vscpp(Ys,{uri:o,code:l})),!c&&vscpp(hv.UserMessage,{priority:800},"I am in an empty file `",vscpp(ga,{value:o,mode:1}),"`."),vscpp(hv.UserMessage,{priority:900},this.props.query,vscpp("br",null),c&&vscpp(vscppf,null,"Remember to start and end your answer with ",Ys.FenceSequence,". The markdown that would fit at $PLACEHOLDER$ is:")))}};qI=B([T(2,De),T(3,_t),T(4,Lt)],qI);var Ys=class t extends Lb{static{this.FenceSequence="-+-+-+-+-+"}async prepare(e,r,n){return{isIgnored:this.props.uri?await this._ignoreService.isCopilotIgnored(this.props.uri):!1}}render(e){if(e.isIgnored)return this._handleFoulPrompt();let r=t.FenceSequence,n=`${r}
${this.props.code}
${r}`;return vscpp(hv.TextChunk,null,n)}};var HI=class extends Y{constructor(r,n,o,s,a){super(r,n);this._ignoreService=o;this._parserService=s;this._experimentationService=a}async prepare(r){let{documentContext:n}=this.props,o=await this._ignoreService.isCopilotIgnored(n.document.uri),s=n.document.validateRange(n.wholeRange);return{summarizedDocument:await Au(this._parserService,this._experimentationService,n.document,n.fileIndentInfo,n.language,s,r.endpoint.modelMaxPromptTokens/3),isIgnored:o}}render(r,n){if($t(this.props.documentContext.document.uri))throw Ar("InlineChatEditMarkdownPrompt should not be used with a notebook!");if(this.props.documentContext.language.languageId!=="markdown")throw Ar("InlineChatEditMarkdownPrompt should only be used with markdown documents!");if(r.isIgnored)return vscpp("ignoredFiles",{value:[this.props.documentContext.document.uri]});let{uri:o}=r.summarizedDocument,s=r.summarizedDocument.splitAroundAdjustedSelection(),{codeAbove:a,codeSelected:c,codeBelow:u,hasCodeWithoutSelection:l}=s,d=`${a}$SELECTION_PLACEHOLDER$${u}`,p=s.createReplyInterpreterFactory(1,0,s.replaceSelectionStreaming,Ro.createFencedBlockClassifier(Ys.FenceSequence),f=>f.value.trim()!=="$SELECTION_PLACEHOLDER$");return vscpp(vscppf,null,vscpp("meta",{value:new ei(p)}),vscpp(gv.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"You are a world class markdown editor, very well versed in programming.",vscpp("br",null),"The user needs help to modify some markdown content.",vscpp("br",null),"The markdown is always delimited by ",Ys.FenceSequence,".",vscpp("br",null),"Your answer must begin and end with ",Ys.FenceSequence,".",vscpp("br",null),vscpp(ir,null)),this.props.history&&vscpp(qt,{priority:700,history:this.props.history}),l&&vscpp(vscppf,null,vscpp(gv.UserMessage,{priority:750},"For context, I have the following markdown in a file called `",vscpp(ga,{value:o,mode:1}),"`:",vscpp(Ys,{uri:o,code:d}),vscpp("br",null)),vscpp(gv.UserMessage,{priority:800},"I need your help with the following content:",vscpp("br",null),vscpp(Ys,{uri:o,code:c})),vscpp(gv.UserMessage,{priority:900},this.props.query,vscpp("br",null),"The rewritten markdown content from my last message wrapped with ",Ys.FenceSequence," is:")),!l&&vscpp(vscppf,null,vscpp(gv.UserMessage,{priority:800},"I have the following markdown in a file called `",vscpp(ga,{value:o,mode:1}),"`:",vscpp(Ys,{uri:o,code:c})),vscpp(gv.UserMessage,{priority:900},this.props.query,vscpp("br",null),"The rewritten markdown content wrapped with ",Ys.FenceSequence," is:")))}};HI=B([T(2,De),T(3,_t),T(4,Lt)],HI);var wl=W(ct());function vv(t){return $t(t)?t.path.endsWith(".ipynb"):!1}function HTe(t,e){return t.notebookDocuments.find(n=>n.uri.fsPath===e.fsPath)?.notebookType}var AX={core:1e3,context:800,runtimeCore:600,history:500,other:100};var KI=W(ct());var Is=W(ct());var cp=class{constructor(e){this.charLimit=e;this._totalChars=0}get totalChars(){return this._totalChars}addLine(e){this._totalChars+=e.length+1}lineWouldFit(e){return this._totalChars+e.length+1<this.charLimit}},Qs=class t{constructor(e,r,n,o){this.tracker=e;this.document=r;this.language=n;this.kindOrUniqueStr=o;this.lines=[];this.firstLineIndex=this.document.lineCount;this.lastLineIndex=-1;this.isComplete=!1;this.nonTrimWhitespaceCharCount=0;this._startMarker=xs.begin(n,o),this._endMarker=xs.end(n,o),this.lines=[],this.firstLineIndex=r.lineCount,this.lastLineIndex=-1}get startMarker(){return this._startMarker}get endMarker(){return this._endMarker}get lineCount(){return this.lines.length}get isVerySmallOrEmpty(){return this.nonTrimWhitespaceCharCount<10}get hasContent(){return this.lines.length===0||this.nonTrimWhitespaceCharCount===0?!1:this.lines.length>0}clone(){let e=new t(this.tracker,this.document,this.language,this.kindOrUniqueStr);return e._startMarker=this.startMarker,e._endMarker=this.endMarker,e.lines.push(...this.lines),e.firstLineIndex=this.firstLineIndex,e.lastLineIndex=this.lastLineIndex,e.nonTrimWhitespaceCharCount=this.nonTrimWhitespaceCharCount,e}clear(){this.lines.length=0,this.firstLineIndex=this.document.lineCount,this.lastLineIndex=-1,this.nonTrimWhitespaceCharCount=0}generatePrompt(e){if(!this.hasContent)return[];let r=[];return r.push("```"+this.language.languageId),r.push(Ks.forDocument(this.language,this.document)),e&&r.push(`${this.startMarker}`),r.push(...this.lines),e&&r.push(`${this.endMarker}`),r.push("```"),r}prependLine(e){let n=this.document.lineAt(e).text;return this.tracker.lineWouldFit(n)?(this.firstLineIndex=Math.min(this.firstLineIndex,e),this.lastLineIndex=Math.max(this.lastLineIndex,e),this.lines.unshift(n),this.tracker.addLine(n),this.nonTrimWhitespaceCharCount+=n.trim().length,!0):!1}appendLine(e){let n=this.document.lineAt(e).text;return this.tracker.lineWouldFit(n)?(this.firstLineIndex=Math.min(this.firstLineIndex,e),this.lastLineIndex=Math.max(this.lastLineIndex,e),this.lines.push(n),this.tracker.addLine(n),this.nonTrimWhitespaceCharCount+=n.trim().length,!0):!1}trim(e){let r=e?Math.min(this.lastLineIndex,e.start.line):this.lastLineIndex;for(;this.firstLineIndex<r&&this.lines.length>0&&this.lines[0].trim().length===0;)this.firstLineIndex++,this.lines.shift();let n=e?Math.max(this.firstLineIndex,e.end.line):this.firstLineIndex;for(;n<this.lastLineIndex&&this.lines.length>0&&this.lines[this.lines.length-1].trim().length===0;)this.lastLineIndex--,this.lines.pop()}removeFirstNLines(e){if(e>=this.lineCount){let o=this.lines.slice(0),s=this.nonTrimWhitespaceCharCount;return this.clear(),{lines:o,nonTrimWhitespaceCharCount:s}}let r=this.lines.splice(0,e),n=0;for(let o of r)n+=o.trim().length;return this.firstLineIndex+=e,this.nonTrimWhitespaceCharCount-=n,{lines:r,nonTrimWhitespaceCharCount:n}}removeLastNLines(e){if(e>=this.lineCount){let o=this.lines.slice(0),s=this.nonTrimWhitespaceCharCount;return this.clear(),{lines:o,nonTrimWhitespaceCharCount:s}}let r=this.lines.splice(this.lines.length-e,e),n=0;for(let o of r)n+=o.trim().length;return this.lastLineIndex-=e,this.nonTrimWhitespaceCharCount-=n,{lines:r,nonTrimWhitespaceCharCount:n}}takeFromAbove(e,r){let{lines:n,nonTrimWhitespaceCharCount:o}=e.removeLastNLines(r);this.lines.unshift(...n),this.firstLineIndex-=n.length,this.nonTrimWhitespaceCharCount+=o}takeFromBelow(e,r){let{lines:n,nonTrimWhitespaceCharCount:o}=e.removeFirstNLines(r);this.lines.push(...n),this.lastLineIndex+=n.length,this.nonTrimWhitespaceCharCount+=o}mergeFromAbove(e){e.hasContent&&(this.lines.unshift(...e.lines),this.firstLineIndex=e.firstLineIndex,this.nonTrimWhitespaceCharCount+=e.nonTrimWhitespaceCharCount,e.clear())}mergeFromBelow(e){e.hasContent&&(this.lines.push(...e.lines),this.lastLineIndex=e.lastLineIndex,this.nonTrimWhitespaceCharCount+=e.nonTrimWhitespaceCharCount,e.clear())}toRange(){try{let e=this.lastLineIndex===-1?this.document.lineCount-1:this.lastLineIndex,r=new ze(this.firstLineIndex,0,e,this.document.lineAt(e).text.length);if(this.document.validateRange(r)===r)return r}catch{return}}toString(){return`{${this.firstLineIndex} -> ${this.lastLineIndex}}`}};function zTe(t,e,r,n,o,s){if(r.start.line!==r.end.line&&r.end.character===0){let p=t.lineAt(r.end.line-1);r=new ze(r.start,new Xr(r.end.line-1,p.text.length))}else if(e.end.character===0&&e.end.line!==e.start.line&&(r.start.line===e.start.line&&r.start.character===0&&r.end.line===e.end.line&&r.end.character===t.lineAt(r.end.line).text.length||r.isEqual(e))){let p=t.lineAt(r.end.line-1);r=new ze(r.start,new Xr(r.end.line-1,p.text.length))}let a=new Qs(s,t,o,"ed8c6549bwf9"),c=new Qs(s,t,o,"abpxx6d04wxr"),u=new Qs(s,t,o,"be15d9bcejpp"),l=()=>(c.trim(),a.trim(e),u.trim(),{language:o,above:c,range:a,below:u});for(let p=r.end.line;p>=r.start.line;p--)if(!a.prependLine(p))return l();let d={aboveLineIndex:r.start.line-1,belowLineIndex:r.end.line+1,minimumLineIndex:Math.max(0,n.start.line),maximumLineIndex:Math.min(t.lineCount-1,n.end.line)};return PX(d,c,u),l()}function PX(t,e,r){let n=t.aboveLineIndex,o=!0,s=t.belowLineIndex,a=!0;for(let c=0;c<100&&(o||a);c++)!o||a&&c%4===3?s<=t.maximumLineIndex&&r.appendLine(s)?s++:a=!1:n>=t.minimumLineIndex&&e.prependLine(n)?n--:o=!1;e.isComplete=n<t.minimumLineIndex,r.isComplete=s>t.maximumLineIndex}function GTe(t,e,r,n){let o=0,s="",a=r.endOffset,c="";for(let u of e)if(u.endIndex<r.startOffset)s+=t.substring(o,u.startIndex),s+=n,o=u.endIndex;else if(u.startIndex>r.endOffset)c+=t.substring(a,u.startIndex),c+=n,a=u.endIndex;else continue;return s+=t.substring(o,r.startOffset),c+=t.substring(a,t.length),{outlineAbove:s,outlineBelow:c}}function H8(t,e,r,n,o){let s={...n,outlineAbove:"",outlineBelow:"",aboveCells:[],belowCells:[]},a,c,u;if(r.document.uri.scheme==="vscode-notebook-cell"){a=e.notebookDocuments.find(S=>S.uri.fsPath===r.document.uri.fsPath&&S.getCells().find(I=>I.document===r.document));let b=a?.getCells().findIndex(S=>S.document===r.document);if(b===void 0||b===-1)return s;c=b-1,u=b+1}else{if(t.activeNotebookEditor?.notebook.uri.path!==r.document.uri.path)return s;let b=t.activeNotebookEditor;a=b?.notebook;let S=b.selection.start;c=S-1,u=S}if(!a)return s;let{language:l,above:d,range:p,below:f}=n,m=d.lines.length+p.lines.length+f.lines.length,h=[],g=[],v=()=>(h.forEach(b=>b.trim()),g.forEach(b=>b.trim()),{language:l,above:d,range:p,below:f,outlineAbove:"",outlineBelow:"",aboveCells:h,belowCells:g}),y=!0,_=!0;for(let b=m;b<100&&(y||_);b++)if(y)if(c>=0){let I=a.cellAt(c).document,w=new Qs(o,I,As(I),"CELL:"+I.uri.fragment);for(let O=0;O<I.lineCount;O++)w.appendLine(O);h.unshift(w),c--}else y=!1;else if(u<a.cellCount){let I=a.cellAt(u).document,w=new Qs(o,I,As(I),"CELL:"+I.uri.fragment);for(let O=0;O<I.lineCount;O++)w.appendLine(O);g.push(w),u++}else _=!1;return v()}var am=class extends Y{render(){return vscpp(vscppf,null,"```",this.props.language.languageId,vscpp("br",null),this.props.document&&vscpp(vscppf,null,Ks.forDocument(this.props.language,this.props.document),vscpp("br",null)),this.props.code&&vscpp(vscppf,null,this.props.code,vscpp("br",null)),"```")}};var va=class extends Y{render(){if(!this.props.codeRegion.hasContent)return;let e=[];return this.props.useMarkers&&e.push(this.props.codeRegion.startMarker),e.push(...this.props.codeRegion.lines),this.props.useMarkers&&e.push(this.props.codeRegion.endMarker),vscpp(am,{language:this.props.codeRegion.language,document:this.props.codeRegion.document,code:e.join(`
`)})}};var jI=class extends Y{constructor(r,n,o,s){super(r,n);this.tabsAndEditorsService=o;this.workspaceService=s}async prepare(){let{document:r,wholeRange:n}=this.props.documentContext;return{wholeRange:r.validateRange(n)}}render(r,n){if(!$t(this.props.documentContext.document.uri))throw Ar("InlineChatNotebookSelection should be used only with a notebook!");let{wholeRange:o}=r,s=j8(this.accessor,n.endpoint.modelMaxPromptTokens/3,this.props.documentContext,o,this.tabsAndEditorsService,this.workspaceService),a=this.props.documentContext.document,c=new Ss(o,s),u=[{uri:a.uri,version:a.version,ranges:Kt([s.range.toRange(),s.above.toRange(),s.below.toRange()])}];return vscpp(vscppf,null,vscpp("usedContext",{value:u}),vscpp("meta",{value:c}),vscpp(_2,{documentContext:this.props.documentContext,above:s.above,range:s.range,below:s.below,aboveCells:s.aboveCells,belowCells:s.belowCells}))}};jI=B([T(2,Tt),T(3,Ze)],jI);var _2=class extends Y{render(e,r){if(!$t(this.props.documentContext.document.uri))throw Ar("InlineChatNotebookSelectionRenderer should be used only with a notebook!");let n=vv(this.props.documentContext.document.uri),{below:o,above:s,range:a,aboveCells:c,belowCells:u}=this.props,l=c||[],d=u||[],p=this.props.documentContext.language,f=this.props.includeDelimeters??!1;return vscpp(vscppf,null,n?vscpp(vscppf,null,(l.length>0||d.length>0)&&vscpp(GI,{documentContext:this.props.documentContext,aboveCells:l,belowCells:d}),p.languageId==="markdown"?vscpp(OX,{cellIndex:l.length,selected:a,above:s,below:o,includeDelimeters:f}):vscpp(MX,{cellIndex:l.length,selected:a,above:s,below:o,includeDelimeters:f})):vscpp(vscppf,null,vscpp(yv,{documentContext:this.props.documentContext}),vscpp(zI,{documentContext:this.props.documentContext,aboveCells:l,belowCells:d}),p.languageId==="markdown"?vscpp(NX,{cellIndex:l.length,selected:a,above:s,below:o,includeDelimeters:f}):vscpp(LX,{cellIndex:l.length,selected:a,above:s,below:o,includeDelimeters:f})))}},VTe=[{viewType:"polyglot-notebook",exampleCells:[{lan:"markdown",source:"Samples"},{lan:"csharp",source:"using Microsoft.Data.Analysis;"},{lan:"csharp",source:`DateTimeDataFrameColumn dateTimes = new DateTimeDataFrameColumn("DateTimes");
 Int32DataFrameColumn ints = new Int32DataFrameColumn("Ints", 6);
 StringDataFrameColumn strings = new StringDataFrameColumn("Strings", 6);`},{lan:"csharp",source:'dateTimes.Append(DateTime.Parse("2019/01/01"));'}]},{viewType:"sql-notebook",exampleCells:[{lan:"sql",source:"SELECT * FROM users;"}]},{viewType:"node-notebook",exampleCells:[{lan:"javascript",source:'console.log("Hello World");'},{lan:"javascript",source:"const {display} = require('node-kernel');"},{lan:"markdown",source:"# Plain text output"},{lan:"javascript",source:"display.text('Hello World');"}]},{viewType:"sas-notebook",exampleCells:[{lan:"sas",source:"proc print data=sashelp.class; run;"},{lan:"sas",source:`data race;
pr = probnorm(-15/sqrt(325));
run;

proc print data=race;
var pr;
run;
`}]},{viewType:"http-notebook",exampleCells:[{lan:"http",source:"GET https://httpbin.org/get"},{lan:"http",source:"POST https://httpbin.org/post"}]},{viewType:"powerbi-notebook",exampleCells:[{lan:"markdown",source:"# Get Groups"},{lan:"powerbi-api",source:"GET /groups"},{lan:"powerbi-api",source:`%dax /groups/ccce57d1-10af-1234-1234-665f8bbd8458/datasets/51ba6d4b-1234-1234-8635-a7d743a5ea89
EVALUATE INFO.TABLES()
This`}]},{viewType:"wolfram-language-notebook",exampleCells:[{lan:"wolfram",source:"Plot[Sin[x], {x, 0, 2 Pi}]"}]},{viewType:"github-issues",exampleCells:[{lan:"github-issues",source:`$vscode=repo:microsoft/vscode
$milestone=milestone:"May 2020"`},{lan:"github-issues",source:"$vscode $milestone is:closed author:@me -assignee:@me label:bug -label:verified"},{lan:"github-issues",source:"$vscode assignee:@me is:open label:freeze-slow-crash-leak"}]},{viewType:"rest-book",exampleCells:[{lan:"rest-book",source:"GET google.com"},{lan:"rest-book",source:`GET https://www.google.com
    ?query="fun"
    &page=2
    User-Agent: rest-book
    Content-Type: application/json`}]}],DX=class extends Y{render(){let e=this.props.viewType,r=VTe.find(o=>o.viewType===this.props.viewType);if(!r)return vscpp(vscppf,null);let{exampleCells:n}=r;return vscpp(Is.UserMessage,null,"Below you will find a set of example cells for a ",e," notebook.",vscpp("br",null),n.map((o,s)=>vscpp(vscppf,null,"CELL INDEX: ",s,":",vscpp("br",null),"```",o.lan,vscpp("br",null),o.source,vscpp("br",null),vscpp("br",null),"```")))}},yv=class extends Y{constructor(r,n,o){super(r,n);this.workspaceService=o}render(r,n){if(!$t(this.props.documentContext.document.uri))throw Ar("InlineChatCustomNotebookInfoRenderer should be used only with a notebook!");let o=HTe(this.workspaceService,this.props.documentContext.document.uri),s=VTe.find(c=>c.viewType===o),a=s?o:"custom";return vscpp(vscppf,null,vscpp(Is.UserMessage,null,"I am working on a ",a," notebook in VS Code.",vscpp("br",null),a," notebooks in VS Code are documents that contain a mix of rich Markdown, executable code snippets, ",vscpp("br",null),"and accompanying rich output. These are all separated into distinct cells and can be interleaved in any order ",vscpp("br",null),"A ",a," notebook contains multiple cells.",vscpp("br",null)),s&&vscpp(DX,{viewType:s.viewType}))}};yv=B([T(2,Ze)],yv);var zI=class extends Y{render(e,r){if(!$t(this.props.documentContext.document.uri))throw Ar("InlineChatCustomNotebookCellsContextRenderer should be used only with a notebook!");let{aboveCells:n,belowCells:o,documentContext:s}=this.props,a=n||[],c=o||[],u=s.language;return vscpp(vscppf,null,(a.length>0||c.length>0)&&vscpp(Is.UserMessage,null,"The content of cells are listed below, each cell starts with CELL INDEX and a code block started with ```",u.languageId,vscpp("br",null),"Each cell is a block of code that can be executed independently.",vscpp("br",null),"Do not generate CELL INDEX in your answer, it is only used to help you understand the context.",vscpp("br",null),vscpp("br",null),"Below you will find a set of examples of what you should respond with. Please follow the exmaples on how to avoid repeating code.",vscpp("br",null),a.length>0&&vscpp(VI,{cells:a,title:`Here are the cells in this custom notebook:
`}),c.length>0&&vscpp(VI,{cells:c,cellIndexDelta:a.length+1,title:`Here are the cells below the current cell that I am editing in this custom notebook:
`})))}},NX=class extends Y{render(){let e=this.props.includeDelimeters??(this.props.above.hasContent||this.props.below.hasContent);return vscpp(vscppf,null,vscpp(Is.UserMessage,null,"Now I create a new cell in this custom Notebook document at index ",this.props.cellIndex,".",vscpp("br",null),"This is a markdown cell. Markdown cell is used to describe and document your workflow.",vscpp("br",null),this.props.selected.hasContent?vscpp(vscppf,null,"I have the following content in the selection:",vscpp(va,{codeRegion:this.props.selected,useMarkers:e})):vscpp(vscppf,null,"In this new cell, I am working with the following content:",vscpp(am,{language:this.props.selected.language,code:""}))),this.props.above.hasContent&&vscpp(Is.UserMessage,null,"In this new cell, I have the following markdown content above the selection:",vscpp(va,{codeRegion:this.props.above,useMarkers:this.props.includeDelimeters})),this.props.below.hasContent&&vscpp(Is.UserMessage,null,"In this new cell, I have the following markdown content below the selection:",vscpp(va,{codeRegion:this.props.below,useMarkers:this.props.includeDelimeters})))}},LX=class extends Y{render(){let e=this.props.includeDelimeters??(this.props.above.hasContent||this.props.below.hasContent);return vscpp(vscppf,null,vscpp(Is.UserMessage,null,"Now I create a new cell in this custom Notebook document at index ",this.props.cellIndex,".",vscpp("br",null),this.props.selected.hasContent?vscpp(vscppf,null,"I have the following code in the selection:",vscpp(va,{codeRegion:this.props.selected,useMarkers:e})):vscpp(vscppf,null,"In this new cell, I am working with the following code:",vscpp(am,{language:this.props.selected.language,code:""}))),this.props.above.hasContent&&vscpp(Is.UserMessage,null,"In this new cell, I have the following code above the selection:",vscpp(va,{codeRegion:this.props.above,useMarkers:this.props.includeDelimeters})),this.props.below.hasContent&&vscpp(Is.UserMessage,null,"In this new cell, I have the following code below the selection:",vscpp(va,{codeRegion:this.props.below,useMarkers:this.props.includeDelimeters})))}},GI=class extends Y{render(e,r){if(!$t(this.props.documentContext.document.uri))throw Ar("InlineChatNotebookSelectionRenderer should be used only with a notebook!");let{aboveCells:n,belowCells:o}=this.props,s=this.props.documentContext.language;return vscpp(vscppf,null,(n.length>0||o.length>0)&&vscpp(Is.UserMessage,null,"I am working on a Jupyter notebook.",vscpp("br",null),"This Jupyter Notebook already contains multiple cells.",vscpp("br",null),"The content of cells are listed below, each cell starts with CELL INDEX and a code block started with ```",s.languageId,vscpp("br",null),"Each cell is a block of code that can be executed independently.",vscpp("br",null),"Since it is Jupyter Notebook, if a module is already imported in a cell, it can be used in other cells as well.",vscpp("br",null),"For the same reason, if a variable is defined in a cell, it can be used in other cells as well.",vscpp("br",null),"We should not repeat the same import or variable definition in multiple cells, unless we want to overwrite the previous definition.",vscpp("br",null),"Do not generate CELL INDEX in your answer, it is only used to help you understand the context.",vscpp("br",null),vscpp("br",null),"Below you will find a set of examples of what you should respond with. Please follow the exmaples on how to avoid repeating code.",vscpp("br",null),"## Examples starts here",vscpp("br",null),"Here are the cells in this Jupyter Notebook:",vscpp("br",null),"`CELL INDEX: 0",vscpp("br",null),"```python",vscpp("br",null),"import pandas as pd",vscpp("br",null),vscpp("br",null),"# create a dataframe with sample data",vscpp("br",null),"df = pd.DataFrame({'Name': ['Alice', 'Bob', 'Charlie'], 'Age': [25, 30, 35], 'Gender': ['F', 'M', 'M']})",vscpp("br",null),"print(df)",vscpp("br",null),"```",vscpp("br",null),"---------------------------------",vscpp("br",null),"USER:",vscpp("br",null),"Now I create a new cell in this Jupyter Notebook document at index 1.",vscpp("br",null),"In this new cell, I am working with the following code:",vscpp("br",null),"```python",vscpp("br",null),"```",vscpp("br",null),"---------------------------------",vscpp("br",null),"USER:",vscpp("br",null),"plot the data frame",vscpp("br",null),vscpp("br",null),"---------------------------------",vscpp("br",null),"ChatGPT Answer",vscpp("br",null),"---------------------------------",vscpp("br",null),"To plot the dataframe, we can use the `plot()` method of pandas dataframe. Here's the code:",vscpp("br",null),vscpp("br",null),"```python",vscpp("br",null),"df.plot(x='Name', y='Age', kind='bar')",vscpp("br",null),"```",vscpp("br",null),"## Example ends here",vscpp("br",null),n.length>0&&vscpp(VI,{cells:n,title:`Here are the cells in this Jupyter Notebook:
`}),o.length>0&&vscpp(VI,{cells:o,cellIndexDelta:n.length+1,title:`Here are the cells below the current cell that I am editing in this Jupyter Notebook:
`})))}},OX=class extends Y{render(){let e=this.props.includeDelimeters??(this.props.above.hasContent||this.props.below.hasContent);return vscpp(vscppf,null,vscpp(Is.UserMessage,null,"Now I create a new cell in this Jupyter Notebook document at index ",this.props.cellIndex,".",vscpp("br",null),"This is a markdown cell. Markdown cell is used to describe and document your workflow.",vscpp("br",null),this.props.selected.hasContent?vscpp(vscppf,null,"I have the following content in the selection:",vscpp(va,{codeRegion:this.props.selected,useMarkers:e})):vscpp(vscppf,null,"In this new cell, I am working with the following content:",vscpp(am,{language:this.props.selected.language,code:""}))),this.props.above.hasContent&&vscpp(Is.UserMessage,null,"In this new cell, I have the following markdown content above the selection:",vscpp(va,{codeRegion:this.props.above,useMarkers:this.props.includeDelimeters})),this.props.below.hasContent&&vscpp(Is.UserMessage,null,"In this new cell, I have the following markdown content below the selection:",vscpp(va,{codeRegion:this.props.below,useMarkers:this.props.includeDelimeters})))}},MX=class extends Y{render(){let e=this.props.includeDelimeters??(this.props.above.hasContent||this.props.below.hasContent);return vscpp(vscppf,null,vscpp(Is.UserMessage,null,"Now I create a new cell in this Jupyter Notebook document at index ",this.props.cellIndex,".",vscpp("br",null),this.props.selected.hasContent?vscpp(vscppf,null,"I have the following code in the selection:",vscpp(va,{codeRegion:this.props.selected,useMarkers:e})):vscpp(vscppf,null,"In this new cell, I am working with the following code:",vscpp(am,{language:this.props.selected.language,code:""}))),this.props.above.hasContent&&vscpp(Is.UserMessage,null,"In this new cell, I have the following code above the selection:",vscpp(va,{codeRegion:this.props.above,useMarkers:this.props.includeDelimeters})),this.props.below.hasContent&&vscpp(Is.UserMessage,null,"In this new cell, I have the following code below the selection:",vscpp(va,{codeRegion:this.props.below,useMarkers:this.props.includeDelimeters})))}},VI=class extends Y{render(){return vscpp(vscppf,null,this.props.title,vscpp("br",null),this.props.cells.map((e,r)=>vscpp(FX,{index:r+(this.props.cellIndexDelta??0),cell:e})))}},FX=class extends Y{render(){return vscpp(vscppf,null,"CELL INDEX: ",this.props.index,vscpp("br",null),"```",this.props.cell.language.languageId,vscpp("br",null),this.props.cell.lines.join(`
`),vscpp("br",null),"```")}};function j8(t,e,r,n,o,s){let a=e*4,c=new cp(a),u=zTe(r.document,r.selection,n,new ze(0,0,r.document.lineCount,0),r.language,c);return H8(o,s,r,u,c)}var $I=class extends Y{constructor(r,n,o,s){super(r,n);this.tabsAndEditorsService=o;this.workspaceService=s}async prepare(){let{document:r,wholeRange:n}=this.props.documentContext;return{wholeRange:r.validateRange(n)}}render(r,n){if(!$t(this.props.documentContext.document.uri))throw Ar("InlineChatNotebookSelection should be used only with a notebook!");let{wholeRange:o}=r,s=j8(this.accessor,n.endpoint.modelMaxPromptTokens/3,this.props.documentContext,o,this.tabsAndEditorsService,this.workspaceService),a=this.props.documentContext.document,c=new Ss(o,s),u=[{uri:a.uri,version:a.version,ranges:Kt([s.range.toRange(),s.above.toRange(),s.below.toRange()])}],l=vv(this.props.documentContext.document.uri),{hasCodeWithoutSelection:d,codeWithoutSelection:p,codeSelected:f}=this.props,{aboveCells:m,belowCells:h}=s,g=m||[],v=h||[],y=this.props.documentContext.language,_=y.languageId==="markdown",b=d||f.length>0;return vscpp(vscppf,null,vscpp("usedContext",{value:u}),vscpp("meta",{value:c}),l?vscpp(vscppf,null,(g.length>0||v.length>0)&&vscpp(GI,{documentContext:this.props.documentContext,aboveCells:g,belowCells:v}),vscpp(KI.UserMessage,null,_?vscpp(vscppf,null,b&&vscpp(vscppf,null,"Now I edit a markdown cell in this Jupyter Notebook document at index ",g.length,".",vscpp("br",null)),!b&&vscpp(vscppf,null,"Now I create a new markdown cell in this Jupyter Notebook document at index ",g.length,".",vscpp("br",null)),"This is a markdown cell. Markdown cell is used to describe and document your workflow.",vscpp("br",null),d&&vscpp(vscppf,null,vscpp(Oe,{uri:a.uri,languageId:y.languageId,code:p,shouldTrim:!1}),vscpp("br",null)),d&&vscpp(vscppf,null,"The $SELECTION_PLACEHOLDER$ code is:",vscpp("br",null)),vscpp(Oe,{uri:a.uri,languageId:y.languageId,code:f,shouldTrim:!1})):vscpp(vscppf,null,b&&vscpp(vscppf,null,"Now I edit a cell in this Jupyter Notebook document at index ",g.length,".",vscpp("br",null)),!b&&vscpp(vscppf,null,"Now I create a new cell in this Jupyter Notebook document at index ",g.length,".",vscpp("br",null)),d&&vscpp(vscppf,null,vscpp(Oe,{uri:a.uri,languageId:y.languageId,code:p,shouldTrim:!1}),vscpp("br",null)),f.length>0&&vscpp(vscppf,null,"The $SELECTION_PLACEHOLDER$ code is:",vscpp("br",null)),vscpp(Oe,{uri:a.uri,languageId:y.languageId,code:f,shouldTrim:!1})))):vscpp(vscppf,null,vscpp(yv,{documentContext:this.props.documentContext}),vscpp(zI,{documentContext:this.props.documentContext,aboveCells:g,belowCells:v}),vscpp(KI.UserMessage,null,_?vscpp(vscppf,null,d&&vscpp(vscppf,null,"Now I edit a markdown cell in this custom Notebook document at index ",g.length,".",vscpp("br",null)),!d&&vscpp(vscppf,null,"Now I create a new markdown cell in this custom Notebook document at index ",g.length,".",vscpp("br",null)),"This is a markdown cell. Markdown cell is used to describe and document your workflow.",vscpp("br",null),d&&vscpp(vscppf,null,vscpp(Oe,{uri:a.uri,languageId:y.languageId,code:p,shouldTrim:!1}),vscpp("br",null)),d&&vscpp(vscppf,null,"The $SELECTION_PLACEHOLDER$ code is:",vscpp("br",null)),vscpp(Oe,{uri:a.uri,languageId:y.languageId,code:f,shouldTrim:!1})):vscpp(vscppf,null,d&&vscpp(vscppf,null,"Now I edit a cell in this custom Notebook document at index ",g.length,".",vscpp("br",null)),!d&&vscpp(vscppf,null,"Now I create a new cell in this custom Notebook document at index ",g.length,".",vscpp("br",null)),d&&vscpp(vscppf,null,vscpp(Oe,{uri:a.uri,languageId:y.languageId,code:p,shouldTrim:!1}),vscpp("br",null)),d&&vscpp(vscppf,null,"The $SELECTION_PLACEHOLDER$ code is:",vscpp("br",null)),vscpp(Oe,{uri:a.uri,languageId:y.languageId,code:f,shouldTrim:!1})))))}};$I=B([T(2,Tt),T(3,Ze)],$I);var WI=class extends Y{constructor(r,n,o,s,a,c,u){super(r,n);this.configurationService=o;this.notebookService=s;this.tabsAndEditorsService=a;this.experimentationService=c;this.workspaceService=u}async prepare(){let{document:r,wholeRange:n}=this.props.documentContext,o=await this.experimentationService.getTreatmentVariableAsync("vscode","copilotchat.notebookSummary",!1)||this.configurationService.getConfig(ge.NotebookSummaryExperimentEnabled),s;return o&&this.tabsAndEditorsService.activeNotebookEditor?.notebook&&this.tabsAndEditorsService.activeNotebookEditor?.notebook.uri.path===r.uri.path&&(s=this.notebookService.getCellExecutions(this.tabsAndEditorsService.activeNotebookEditor.notebook.uri)),{wholeRange:r.validateRange(n),executedCells:s}}render(r,n){if(!$t(this.props.documentContext.document.uri))throw Ar("InlineChatNotebookSelection should be used only with a notebook!");let{wholeRange:o}=r,s=j8(this.accessor,n.endpoint.modelMaxPromptTokens/3,this.props.documentContext,o,this.tabsAndEditorsService,this.workspaceService),a=this.props.documentContext.document,c=new Ss(o,s),u=[{uri:a.uri,version:a.version,ranges:Kt([s.range.toRange(),s.above.toRange(),s.below.toRange()])}],l=vv(this.props.documentContext.document.uri),{hasContent:d,code:p}=this.props,{aboveCells:f,belowCells:m}=s,h=f||[],g=m||[],v=this.props.documentContext.language,y=v.languageId==="markdown",_=r.executedCells||[];return vscpp(vscppf,null,vscpp("usedContext",{value:u}),vscpp("meta",{value:c}),l?vscpp(vscppf,null,_.length>0&&vscpp(UX,{documentContext:this.props.documentContext,executedCells:_}),_.length===0&&(h.length>0||g.length>0)&&vscpp(GI,{documentContext:this.props.documentContext,aboveCells:h,belowCells:g}),vscpp(KI.UserMessage,null,y?vscpp(vscppf,null,d&&vscpp(vscppf,null,"Now I edit a markdown cell in this Jupyter Notebook document at index ",h.length,".",vscpp("br",null)),!d&&vscpp(vscppf,null,"Now I create a new markdown cell in this Jupyter Notebook document at index ",h.length,".",vscpp("br",null)),"This is a markdown cell. Markdown cell is used to describe and document your workflow.",vscpp("br",null),d&&vscpp(vscppf,null,vscpp(Oe,{uri:a.uri,languageId:v.languageId,code:p,shouldTrim:!1}),vscpp("br",null))):vscpp(vscppf,null,d&&vscpp(vscppf,null,"Now I edit a cell in this Jupyter Notebook document at index ",h.length,".",vscpp("br",null)),!d&&vscpp(vscppf,null,"Now I create a new cell in this Jupyter Notebook document at index ",h.length,".",vscpp("br",null)),d&&vscpp(vscppf,null,vscpp(Oe,{uri:a.uri,languageId:v.languageId,code:p,shouldTrim:!1}),vscpp("br",null))))):vscpp(vscppf,null,vscpp(yv,{documentContext:this.props.documentContext}),vscpp(zI,{documentContext:this.props.documentContext,aboveCells:h,belowCells:g}),vscpp(KI.UserMessage,null,y?vscpp(vscppf,null,d&&vscpp(vscppf,null,"Now I edit a markdown cell in this custom Notebook document at index ",h.length,".",vscpp("br",null)),!d&&vscpp(vscppf,null,"Now I create a new markdown cell in this custom Notebook document at index ",h.length,".",vscpp("br",null)),"This is a markdown cell. Markdown cell is used to describe and document your workflow.",vscpp("br",null),d&&vscpp(vscppf,null,vscpp(Oe,{uri:a.uri,languageId:v.languageId,code:p,shouldTrim:!1}),vscpp("br",null))):vscpp(vscppf,null,d&&vscpp(vscppf,null,"Now I edit a cell in this custom Notebook document at index ",h.length,".",vscpp("br",null)),!d&&vscpp(vscppf,null,"Now I create a new cell in this custom Notebook document at index ",h.length,".",vscpp("br",null)),d&&vscpp(vscppf,null,vscpp(Oe,{uri:a.uri,languageId:v.languageId,code:p,shouldTrim:!1}),vscpp("br",null))))))}};WI=B([T(2,be),T(3,X_),T(4,Tt),T(5,Lt),T(6,Ze)],WI);var UX=class extends Y{render(e,r){if(!$t(this.props.documentContext.document.uri))throw Ar("InlineChatJupyterNotebookCellSummaryContextRenderer should be used only with a notebook!");let n=this.props.documentContext.language,o=this.props.executedCells||[];return vscpp(vscppf,null,vscpp(KI.UserMessage,null,"I am working on a Jupyter notebook.",vscpp("br",null),"Users have executed the following cells in this notebook",vscpp("br",null),"Each cell contains a code block started with ```",n.languageId,vscpp("br",null),"Since it is Jupyter Notebook, if a module is already imported in a cell, it can be used in other cells as well.",vscpp("br",null),"For the same reason, if a variable is defined in a cell, it can be used in other cells as well.",vscpp("br",null),"We should not repeat the same import or variable definition in multiple cells, unless we want to overwrite the previous definition.",vscpp("br",null),"Do not generate CELL INDEX in your answer, it is only used to help you understand the context.",vscpp("br",null),vscpp("br",null),"Below you will find a set of examples of what you should respond with. Please follow the exmaples on how to avoid repeating code.",vscpp("br",null),"## Examples starts here",vscpp("br",null),"Here are the executed cells in this Jupyter Notebook:",vscpp("br",null),"```python",vscpp("br",null),"import pandas as pd",vscpp("br",null),vscpp("br",null),"df = pd.DataFrame({'Name': ['Alice', 'Bob', 'Charlie'], 'Age': [25, 30, 35], 'Gender': ['F', 'M', 'M']})",vscpp("br",null),"print(df)",vscpp("br",null),"```",vscpp("br",null),"---------------------------------",vscpp("br",null),"USER:",vscpp("br",null),"Now I create a new cell in this Jupyter Notebook document at index 1.",vscpp("br",null),"USER:",vscpp("br",null),"plot the data frame",vscpp("br",null),vscpp("br",null),"---------------------------------",vscpp("br",null),"ChatGPT Answer",vscpp("br",null),"---------------------------------",vscpp("br",null),"To plot the dataframe, we can use the `plot()` method of pandas dataframe. Here's the code:",vscpp("br",null),vscpp("br",null),"```python",vscpp("br",null),"df.plot(x='Name', y='Age', kind='bar')",vscpp("br",null),"```",vscpp("br",null),"## Example ends here",vscpp("br",null),o.map(s=>vscpp(BX,{cell:s}))))}},BX=class extends Y{render(){return vscpp(vscppf,null,"```",this.props.cell.document.languageId,vscpp("br",null),this.props.cell.document.getText(),vscpp("br",null),"```")}};var YI=class extends Y{render(){let e=this.props.language;return vscpp(vscppf,null,"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"Follow the user's requirements carefully & to the letter.",vscpp("br",null),"The user has a ",e.languageId," file opened in a code editor.",vscpp("br",null),"The user includes some code snippets from the file.",vscpp("br",null),"Each code block starts with ``` and ",Ks.forLanguage(e),".",vscpp("br",null),"Answer with a single ",e.languageId," code block.",vscpp("br",null),"If you modify existing code, you will use the ",xs.begin(e)," and ",xs.end(e)," markers.")}};var QI=class extends Y{constructor(r,n,o,s,a,c){super(r,n);this.tabsAndEditorsService=o;this.notebookService=s;this.experimentationService=a;this.configurationService=c}async prepare(){if(this.tabsAndEditorsService.activeNotebookEditor?.notebook.uri.path!==this.props.documentContext.document.uri.path)return{variables:[],packages:[]};let n=this.tabsAndEditorsService.activeNotebookEditor?.notebook;if(!n)return{variables:[],packages:[]};let o=await this.experimentationService.getTreatmentVariableAsync("vscode","copilotchat.notebookPackages",!1)||this.configurationService.getConfig(ge.NotebookPackagesExperimentEnabled),s=this.notebookService.getVariables(n.uri),a=o?Promise.resolve([]):this.notebookService.getPipPackages(n.uri),[c,u]=await Promise.all([s,a]);return{variables:c,packages:u}}render(r){let{priorities:n}=this.props;return vscpp(vscppf,null,r.variables.length!==0&&vscpp(vscppf,null,vscpp(wl.UserMessage,{priority:n.runtimeCore},"The following variables are present in this Jupyter Notebook:",r.variables.map(o=>vscpp(vscppf,null,vscpp(wl.TextChunk,null,"Name: ",o.variable.name,vscpp("br",null),o.variable.type&&vscpp(vscppf,null,"Type: ",o.variable.type),vscpp("br",null),"Value: ",o.variable.value,vscpp("br",null),o.indexedChildrenCount>0&&vscpp(vscppf,null,"Length: ",o.indexedChildrenCount),vscpp("br",null),o.variable.summary&&vscpp(vscppf,null,"Summary: ",o.variable.summary)))))),r.packages.length!==0&&vscpp(vscppf,null,vscpp(wl.UserMessage,{priority:n.other},"The following pip packages are available in this Jupyter Notebook:",r.packages.map(o=>vscpp(vscppf,null,vscpp(wl.TextChunk,null,o.name,"==",o.version),vscpp("br",null))))))}};QI=B([T(2,Tt),T(3,X_),T(4,Lt),T(5,be)],QI);var XI=class extends Y{constructor(r,n,o,s,a,c){super(r,n);this.experimentationService=o;this.configurationService=s;this.ignoreService=a;this.parserService=c}async prepare(r){let o=await this.experimentationService.getTreatmentVariableAsync("vscode","copilotchat.notebookPriorities",!1)||this.configurationService.getConfig(ge.NotebookPrioritiesExperimentEnabled)?AX:{},s=this.configurationService.getConfig(ge.NotebookAdditionalCodeGenerationRuleEnabled),{documentContext:a}=this.props,c=await this.ignoreService.isCopilotIgnored(a.document.uri),u=a.document.validateRange(a.wholeRange);return{summarizedDocument:await Au(this.parserService,this.experimentationService,a.document,a.fileIndentInfo,a.language,u,r.endpoint.modelMaxPromptTokens/3),isIgnored:c,priorities:o,additionalCodeGenerationRule:s}}render(r,n){if(!$t(this.props.documentContext.document.uri))throw Ar("InlineChatNotebookBasePrompt should be used only with a notebook!");let{language:o}=this.props.documentContext,s=o.languageId!=="markdown",a=vv(this.props.documentContext.document.uri),c=r.summarizedDocument.splitAroundOriginalSelectionEnd(),{codeAbove:u,hasContent:l,codeBelow:d}=c,p=`${u}$PLACEHOLDER$${d}`,f=c.createReplyInterpreterFactory(0,s?1:0,n.endpoint.model==="gpt-4"?c.insertStreaming:c.insertOrReplaceStreaming,s?Ro.createCodeBlockClassifier():Ro.createAlwaysInsideCodeBlockClassifier(),g=>g.value.trim()!=="$PLACEHOLDER$"),m=r.priorities,h=r.additionalCodeGenerationRule??!1;return vscpp(vscppf,null,vscpp("meta",{value:new ei(f)}),vscpp(wl.SystemMessage,{priority:m.core},vscpp(YI,{language:o}),vscpp("br",null),a&&vscpp(vscppf,null,"When dealing with Jupyter Notebook, if a module is already imported in a cell, it can be used in other cells directly without importing it again. For the same reason, if a variable is defined in a cell, it can be used in other cells as well",vscpp("br",null),"When dealing with Jupyter Notebook, cells below the current cell can be executed before the current cell, you must use the variables defined in the cells below, unless you want to overwrite them.",vscpp("br",null),"When dealing with Jupyter Notebook, do not generate CELL INDEX in the code blocks in your answer, it is only used to help you understand the context.",vscpp("br",null),"If the Jupyter Notebook already contains variables, you should respect the name and value of the variables, and use them in your code when necessary.",vscpp("br",null)),l&&vscpp(vscppf,null,"The user includes existing code and marks with $PLACEHOLDER$ where the new code should go.",vscpp("br",null)),l&&vscpp(vscppf,null,'DO NOT include the text "$PLACEHOLDER$" in your reply.',vscpp("br",null)),l&&vscpp(vscppf,null,"DO NOT repeat any code from the user in your reply.",vscpp("br",null)),!l&&s&&vscpp(vscppf,null,"Your must generate a code block surrounded with ``` that will be used in a new file",vscpp("br",null)),!s&&vscpp(vscppf,null,"When generating content for markdown cell, provide the answer directly without any additional introductory text. Ensure that the response is structured in Markdown format to seamlessly integrate into the markdown file."),vscpp(ir,null)),this.props.history&&vscpp(qt,{priority:m.history??700,history:this.props.history}),vscpp(WI,{documentContext:this.props.documentContext,hasContent:l,code:p,priority:m.core}),vscpp(QI,{documentContext:this.props.documentContext,priorities:m,query:this.props.query}),vscpp(wl.UserMessage,{priority:m.core},h&&vscpp(vscppf,null,"Please generate code for: "),this.props.query,l&&s&&vscpp(vscppf,null,"The code that would fit at $PLACEHOLDER$ with ``` is:"),l&&!s&&vscpp(vscppf,null,"The code that would fit at $PLACEHOLDER$ without ``` is:")))}};XI=B([T(2,Lt),T(3,be),T(4,De),T(5,_t)],XI);var JI=class extends Y{constructor(r,n,o,s,a,c){super(r,n);this.experimentationService=o;this.configurationService=s;this.ignoreService=a;this.parserService=c}async prepare(r){let o=await this.experimentationService.getTreatmentVariableAsync("vscode","copilotchat.notebookPriorities",!1)||this.configurationService.getConfig(ge.NotebookPrioritiesExperimentEnabled)?AX:{},s=this.configurationService.getConfig(ge.NotebookAdditionalCodeGenerationRuleEnabled),{documentContext:a}=this.props,c=await this.ignoreService.isCopilotIgnored(a.document.uri),u=a.document.validateRange(a.wholeRange);return{summarizedDocument:await Au(this.parserService,this.experimentationService,a.document,a.fileIndentInfo,a.language,u,r.endpoint.modelMaxPromptTokens/3),isIgnored:c,priorities:o,additionalCodeGenerationRule:s}}render(r,n){if(!$t(this.props.documentContext.document.uri))throw Ar("InlineChatNotebookEditPrompt should be used only with a notebook!");if(r.isIgnored)return vscpp("ignoredFiles",{value:[this.props.documentContext.document.uri]});let o=vv(this.props.documentContext.document.uri),{language:s}=this.props.documentContext,a=s.languageId==="markdown",c=r.summarizedDocument.splitAroundAdjustedSelection(),{codeAbove:u,codeSelected:l,codeBelow:d,hasCodeWithoutSelection:p}=c,f=`${u}$SELECTION_PLACEHOLDER$${d}`,m=c.createReplyInterpreterFactory(0,1,c.replaceSelectionStreaming,Ro.createCodeBlockClassifier(),v=>v.value.trim()!=="$SELECTION_PLACEHOLDER$"),h=r.priorities,g=r.additionalCodeGenerationRule??!1;return vscpp(vscppf,null,vscpp("meta",{value:new ei(m)}),vscpp(wl.SystemMessage,{priority:h.core},vscpp(vscppf,null,"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"You are a world class expert in programming, and especially good at ",s.languageId,".",vscpp("br",null),"Source code is always contained in ``` blocks.",vscpp("br",null),"The user needs help to modify some code.",vscpp("br",null),p&&vscpp(vscppf,null,"The user includes existing code and marks with $SELECTION_PLACEHOLDER$ where the selected code should go.",vscpp("br",null))),o&&vscpp(vscppf,null,"When dealing with Jupyter Notebook, if a module is already imported in a cell, it can be used in other cells directly without importing it again. For the same reason, if a variable is defined in a cell, it can be used in other cells as well",vscpp("br",null),"When dealing with Jupyter Notebook, cells below the current cell can be executed before the current cell, you must use the variables defined in the cells below, unless you want to overwrite them.",vscpp("br",null),"When dealing with Jupyter Notebook, do not generate CELL INDEX in the code blocks in your answer, it is only used to help you understand the context.",vscpp("br",null),"If the Jupyter Notebook already contains variables, you should respect the name and value of the variables, and use them in your code when necessary.",vscpp("br",null)),a&&vscpp(vscppf,null,"When generating content for markdown cell, provide the answer directly without any additional introductory text. Ensure that the response is structured in Markdown format to seamlessly integrate into the markdown file."),p&&vscpp(vscppf,null,"The user includes existing code and marks with $SELECTION_PLACEHOLDER$ where the selected code should go.",vscpp("br",null)),vscpp(ir,null)),vscpp($I,{documentContext:this.props.documentContext,hasCodeWithoutSelection:p,codeWithoutSelection:f,codeSelected:l,priority:h.core}),this.props.history&&vscpp(qt,{priority:h.history??700,history:this.props.history}),vscpp(QI,{documentContext:this.props.documentContext,priority:h.core,priorities:h,query:this.props.query}),vscpp(wl.UserMessage,{priority:h.core},g&&vscpp(vscppf,null,"Please edit code for: "),this.props.query,vscpp("br",null),p&&a&&vscpp(vscppf,null,"The modified $SELECTION_PLACEHOLDER$ code without ``` is:"),p&&!a&&vscpp(vscppf,null,"The modified $SELECTION_PLACEHOLDER$ code with ``` is:")))}};JI=B([T(2,Lt),T(3,be),T(4,De),T(5,_t)],JI);var bv=class{constructor(e,r,n,o,s,a){this.accessor=e;this.intent=r;this.location=n;this.endpoint=o;this.documentContext=s;this.editStrategy=a;this.replyInterpreterFactory=null}async buildPrompt(e,r,n,o,s){let c=e.getLatestTurn().request.message,u=e.turns.length>1?e.turns.slice(0,-1):[],l;$t(this.documentContext.document.uri)?l=this.editStrategy===4?XI:JI:this.documentContext.document.languageId==="markdown"?l=this.editStrategy===4?qI:HI:l=this.editStrategy===4?FI:BI;let d=new Xe(this.endpoint,l,{documentContext:this.documentContext,query:c,history:u},this.accessor.get(ve).acquireTokenizer(this.endpoint.family),this.accessor),p=await d.render(n,s);return this.replyInterpreterFactory=d.getMeta(ei)?.factory??null,p}createReplyInterpreter(){if(!this.replyInterpreterFactory)throw new Error("Could not create reply interpreter without reply interpreter factory!");return this.replyInterpreterFactory()}};var _v=class t{constructor(){this.id=t.ID;this.description=$Te.t("Make changes to existing code");this.locations=[1];this.commandInfo={hiddenFromUser:!0}}static{this.ID="edit"}get intentDetectionInput(){let e="edit_text";return{functionName:e,sampleQuestion:"Change this method to use async/await",modelDescription:"Make changes to existing code",functionCallingBlurb:`If the user's message appears related to refactoring or changing existing code, such as the code in the active selection, you should use the '${e}' function.`}}async invoke(e,r){let n=await e.get(Le).getChatEndpoint("gpt-3.5-turbo"),{location:o,documentContext:s}=r;if(!s)throw new Error("Open a file to add code.");return new bv(e,this,o,n,s,2)}};var WTe=W(Tr());var xv=class t{constructor(){this.id=t.ID;this.description=WTe.t("Generate new code");this.locations=[1];this.commandInfo={hiddenFromUser:!0}}static{this.ID="generate"}get intentDetectionInput(){let e="generate_code_or_markdown";return{functionName:e,sampleQuestion:"Add a function that returns the sum of two numbers",modelDescription:"Generate new code",functionCallingBlurb:`If the user's message appears related to generating new code, you should use the '${e}' function.`}}async invoke(e,r){let n=await e.get(Le).getChatEndpoint("gpt-3.5-turbo"),{location:o,documentContext:s}=r;if(!s)throw new Error("Open a file to add code.");return new bv(e,this,o,n,s,4)}};var QTe=W(ct());var Hi=new class{constructor(){this._descriptors=[]}registerIntent(t){this._descriptors.push(t)}getIntents(){return this._descriptors}};var nc=se("IIntentService"),ZI=class{constructor(e){this._instantiationService=e;this._intents=null}_getOrCreateIntents(){return this._intents||(this._intents=Hi.getIntents().map(e=>this._instantiationService.createInstance(e))),this._intents}get unknowIntent(){let r=this._getOrCreateIntents().find(n=>n.id==="unknown");if(!r)throw new Error("Unknown intent not found");return r}getIntents(e){return this._getOrCreateIntents().filter(n=>n.locations.includes(e))}getIntent(e,r){return this.getIntents(r).find(n=>n.id===e)}getIntentByFunctionName(e,r){return this.getIntents(r).find(n=>n.intentDetectionInput.functionName===e)}};ZI=B([T(0,or)],ZI);var Sv=se("ICommandService"),eC=class{constructor(e,r){this.configurationService=e;this.intentService=r;this.commandPrefix="/";this.readConfig()}readConfig(){this._enabledCommands=this.configurationService.getConfigMixedWithDefaults(ge.ConversationSlashCommandEnablements)}isCommandEnabled(e,r){if(this._enabledCommands===void 0)return!1;if(this._enabledCommands[e]===void 0){if(this._enabledCommands["*"])return!0;let n=this.getCommand(e,r)?.intent?.commandInfo?.defaultEnablement;return typeof n=="boolean"?n:!0}return!!this._enabledCommands[e]}parse(e,r){if(e=e.trimStart(),e.startsWith(this.commandPrefix)){let n=/\/(?<intentId>\w+)(?::(?<intentArgument>\w*))?(?<restOfQuery>\s.*)?/s.exec(e)?.groups,o=n?.intentId??"",s=n?.intentArgument??"",a=(n?.restOfQuery??"").trim(),c=this.getCommand(o,r);if(this.readConfig(),c&&this.isCommandEnabled(o,r))return{command:c,intentArgument:s,restOfQuery:a}}return{restOfQuery:e}}getCommands(e){return this.intentService.getIntents(e).filter(r=>!r.commandInfo||!r.commandInfo.hiddenFromUser).map(r=>({commandId:r.id,intent:r,details:r.description,locations:r.locations}))}getCommand(e,r){return this.getCommands(r).find(n=>n.commandId===e)}};eC=B([T(0,be),T(1,nc)],eC);var up=class extends Y{constructor(e,r){super(e,r),this.commandService=r.get(Sv)}async prepare(){let e=Object.entries(vI).reduce((r,[n,o])=>{let s=this.commandService.getCommand(n,this.props.location)?.intent?.description;r+=`
* ${s}`;for(let a of Object.values(o)){let c=this.commandService.getCommand(a,this.props.location)?.intent?.description;r+=`
* ${c}`}return r},"");return{modelName:CJe(this.props.endpoint.model),commandDescriptions:e}}render(e){return vscpp(vscppf,null,"You can answer general programming questions and perform the following tasks: ",e.commandDescriptions,vscpp("br",null),"You use the ",e.modelName," version of OpenAI's GPT models.")}};function CJe(t){switch(t){case"gpt-4":return"GPT-4";case"code-llama":return"Code Llama";case"gpt-3.5-turbo":case"copilot-preview-gpt35-centralus":return"GPT 3.5 Turbo";case"copilot-preview-4o-0e26a807":return"GPT-4o";default:return"GPT-4 Turbo"}}var $r=class extends Y{render(){return vscpp(vscppf,null,'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"Follow the user's requirements carefully & to the letter.")}};var TJe=["auto","en","fr","it","de","es","ru","zh-CN","zh-TW","ja","ko","cs","pt-br","tr","pl"],lr=class extends Y{constructor(r,n,o,s){super(r,n);this.configurationService=o;this.envService=s}render(){let r=this.configurationService.getConfig(ge.LocaleOverride);if(!TJe.find(o=>r===o))return;let n=r!=="auto"?r:this.envService.language;if(n!=="en")return vscpp(vscppf,null,"Respond in the following locale: ",n)}};lr=B([T(2,be),T(3,Pt)],lr);var Ob=W(ct());var rC=W(ct());var tC=class extends Y{constructor(r,n,o,s,a){super(r,n);this.workspaceService=o;this.chunkingService=s;this.ignoreService=a}async prepare(r){let n="uri"in this.props.variableValue?this.props.variableValue.uri:this.props.variableValue;if(await this.ignoreService.isCopilotIgnored(n))return{ignoredFile:n};let o="range"in this.props.variableValue?this.props.variableValue.range:void 0,s=await this.workspaceService.openTextDocument(n),a=s.getText(o).replace(/\r/g,"");return{chunks:await this.chunkingService.chunkFileSemantic(s.uri,a,Fr.None),languageId:s.languageId,fullText:a,ignoredFile:void 0}}async truncateMarkdownContent(r,n,o,s){let a=await this.chunkingService.chunkFileSemantic(n.uri,r,Fr.None),c=`

<!-- Content truncated -->`,u=this.accessor.get(ve).acquireTokenizer(o.endpoint.family),l=u.tokenLength(c),d=Math.floor(o.tokenBudget/4)-l,p="",f=0,m=!1;for(let h of a){let g=u.tokenLength(h.text);if(g+f>d){m=!0;break}p+=`

`+h.text,f+=g}return m&&(p+=c),s=p,s}render(r,n){if(r.ignoredFile)return vscpp("ignoredFiles",{value:[r.ignoredFile]});if(!r.chunks.length)return;let o=uCe(r.fullText);return vscpp(rC.UserMessage,{priority:this.props.priority},"# ",this.props.variableName.toUpperCase()," CONTEXT",vscpp("br",null),o,r.languageId,vscpp("br",null),r.chunks.map(s=>vscpp(rC.TextChunk,null,vscpp("references",{value:[new rC.PromptReference({variableName:this.props.variableName,value:this.props.variableValue})]}),s.text)),vscpp("br",null),o)}};tC=B([T(2,Ze),T(3,Wu),T(4,De)],tC);var ti=class extends Y{async prepare(){let{query:e,chatVariables:r}=this.props,n=[];return r.forEach((o,s)=>{let a=o.value;if(a){let c=this.uniqueFileName(o.name,r.slice(s+1));n.push({variableName:c,variableValue:a}),o.range&&(e=e.slice(0,o.range[0])+`[#${c}](#${c}-context)`+e.slice(o.range[1]))}}),n.reverse(),{data:n,rewrittenMessage:e}}render(e,r){let n=[];for(let{variableName:o,variableValue:s}of e.data)s instanceof pn||s instanceof yi?n.push(vscpp(tC,{variableName:o,variableValue:s})):typeof s=="string"&&n.push(vscpp(Ob.UserMessage,{priority:this.props.priority&&this.props.priority-1},vscpp(Ob.TextChunk,null,vscpp("references",{value:[new Ob.PromptReference({variableName:o})]}),"# ",o.toUpperCase()," CONTEXT",vscpp("br",null),s)));return vscpp(vscppf,null,...n,vscpp(Ob.UserMessage,{priority:this.props.priority},e.rewrittenMessage))}uniqueFileName(e,r){let n=r.filter(o=>o.name===e).length;return n===0?e:`${e}-${n}`}};var z8=W(ct()),qX=W(require("path"));var KTe=W(ct()),YTe=W(require("path"));var nC=class extends Y{constructor(r,n,o,s){super(r,n);this._ignoreService=o;this._tabsAndEditorsService=s}async prepare(r){let n=this._tabsAndEditorsService.activeTextEditor;if(!n)return{isIgnored:!1};let o=n.visibleRanges[0],s=n.document;return{isIgnored:await this._ignoreService.isCopilotIgnored(s.uri),document:s,range:o}}render(r,n){let{document:o,range:s}=r;if(o&&s){let a=[{uri:o.uri,version:o.version,ranges:[s]}],c=[new Eo.PromptReference({uri:o.uri,range:s})];return r.isIgnored?vscpp("ignoredFiles",{value:[o.uri]}):vscpp(vscppf,null,vscpp("usedContext",{value:a}),vscpp("references",{value:c}),vscpp(KTe.UserMessage,{priority:this.props.priority},"Excerpt from active file ",YTe.basename(o.uri.path),", lines ",s.start.line+1," to ",s.end.line+1,":",vscpp("br",null),vscpp(Oe,{code:o.getText(s),languageId:o.languageId,uri:o.uri}),vscpp("br",null),vscpp("br",null),s.isSingleLine&&vscpp(vscppf,null,"The cursor is on line: ",s.start.line)))}else return}};nC=B([T(2,De),T(3,Tt)],nC);var Wr=class extends Y{constructor(r,n,o,s,a){super(r,n);this.ignoreService=o;this._tabsAndEditorsService=s;this._tokenizerProvider=a}static{this.variableInfo={name:"selection",fullName:"Selection",icon:"selection",description:"The current selection in the active editor",defaultEnablement:!0}}async prepare(r){if(!this.props.document)return{isIgnored:!1,exceedsTokenBudget:!1};let n=await this.ignoreService.isCopilotIgnored(this.props.document.uri),o=!1,s=Wr.getCurrentSelection(this._tabsAndEditorsService);return s&&this._tokenizerProvider.acquireTokenizer(r.endpoint.family).tokenLength(s?.selectedText)*1.1>r.tokenBudget&&(o=!0),{isIgnored:n,exceedsTokenBudget:o}}render(r,n){let o=Wr.getCurrentSelection(this._tabsAndEditorsService);if(!o)return vscpp(nC,null);let s=[{uri:o.activeDocument.uri,version:o.activeDocument.version,ranges:[o.range]}],a=[new Eo.PromptReference(new yi(o.activeDocument.uri,o.range))],c=[o.activeDocument.uri];return r.isIgnored?vscpp("ignoredFiles",{value:c}):r.exceedsTokenBudget?vscpp(vscppf,null,vscpp(z8.AssistantMessage,{priority:this.props.priority,name:"selection-too-large"},"Your active selection (",o.fileName&&vscpp(vscppf,null,o.selectedText.split(`
`).length," lines from ",qX.basename(o.fileName)),") exceeded my maximum context size and was dropped. Please reduce the selection to the most relevant part.")):vscpp(vscppf,null,vscpp("usedContext",{value:s}),vscpp(z8.UserMessage,{priority:this.props.priority},"Active selection:",vscpp("br",null),vscpp("br",null),vscpp("br",null),o.fileName&&vscpp(vscppf,null,"From the file: ",qX.basename(o.fileName),vscpp("br",null)),vscpp(Oe,{code:o.selectedText,languageId:o.languageId,uri:o.activeDocument.uri,references:a}),vscpp("br",null),vscpp("br",null)))}static getCurrentSelection(r,n=!1){let o=r.activeTextEditor,s=o?.document;if(s){let a=o.selection;if(a&&(!a.isEmpty||a.isEmpty&&n)){let c=s.languageId,u=s.getText(a);return{languageId:c,selectedText:u,activeDocument:s,range:a,fileName:s.fileName}}}}};Wr=B([T(2,De),T(3,Tt),T(4,ve)],Wr);var iC=class extends Y{constructor(r,n,o,s,a){super(r,n);this.envService=o;this.experimentationService=s;this._configurationService=a}async prepare(r,n,o){return{useProjectLabels:await this._configurationService.getExperimentBasedConfig(ge.ProjectLabelsChat,this.experimentationService)}}render(r,n){let o=this.envService.OS,s=this.props.chatVariables.find(a=>a.name===Wr.variableInfo.name);return vscpp(vscppf,null,vscpp(QTe.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),vscpp($r,null),vscpp(ir,null),vscpp("br",null),vscpp(up,{location:2,endpoint:this.props.endpoint}),vscpp("br",null),"First think step-by-step - describe your plan for what to build in pseudocode, written out in great detail.",vscpp("br",null),"Then output the code in a single code block.",vscpp("br",null),"Minimize any other prose.",vscpp("br",null),"Use Markdown formatting in your answers.",vscpp("br",null),"Make sure to include the programming language name at the start of the Markdown code blocks.",vscpp("br",null),"Avoid wrapping the whole response in triple backticks.",vscpp("br",null),"The user works in an IDE called Visual Studio Code which has a concept for editors with open files, integrated unit test support, an output pane that shows the output of running the code as well as an integrated terminal.",vscpp("br",null),"The user is working on a ",o," machine. Please respond with system specific commands if applicable.",vscpp("br",null),"The active document is the source code the user is looking at right now.",vscpp("br",null),"You can only give one reply for each conversation turn.",vscpp("br",null),vscpp(lr,null)),r.useProjectLabels&&vscpp(Qo,{priority:600}),this.props.history&&vscpp(qt,{priority:700,history:this.props.history}),!s&&vscpp(Wr,{document:this.props.documentContext?.document,range:this.props.documentContext?.selection,priority:800}),vscpp(ti,{priority:900,chatVariables:this.props.chatVariables,query:this.props.query}))}};iC=B([T(2,Pt),T(3,Lt),T(4,be)],iC);var oC=class extends Yo{constructor(r,n,o,s,a=iC,c){super(n,o,s);this.accessor=r;this.prompt=a;this.documentContext=c}createRenderer(r,n,o,s,a,c){let l=r.getLatestTurn().request.message,d=r.turns.length>1?r.turns.slice(0,-1):[];return new Xe(n,this.prompt,{documentContext:this.documentContext,endpoint:n,query:l,history:d,chatVariables:o},this.accessor.get(ve).acquireTokenizer(n.family),this.accessor)}};var Rl=class t{constructor(){this.id=t.ID;this.locations=[1,2];this.description="Intent of this command is unclear or is not related to information technologies";this.commandInfo={hiddenFromUser:!0};this.intentDetectionInput={sampleQuestion:"Add a dog to this comment."}}static{this.ID="unknown"}async invoke(e,r){let{location:n,documentContext:o}=r,s=await Mn(e.get(Le),n);if(n===1){if(!o)throw new Error("Open a file to add code.");return new bv(e,this,n,s,o,2)}return new oC(e,this,n,s,void 0,o)}};var Iv="_github.copilot.openRelativePath",sC="_github.copilot.openSymbolInFile",G8=[Iv,sC,"_github.copilot.openSymbolFromReferences"];function Cv(t,e){return`command:${t}?${encodeURIComponent(JSON.stringify(e))}`}function V8(t,e,r){return`[${t}](${e} "${EJe(r)}")`}function EJe(t){return t.replace(/"/g,'\\"')}var aC=class{constructor(e,r){this.fileSystem=e;this.workspaceService=r}async linkify(e,r,n){let o=this.workspaceService.getWorkspaceFolders(),s=async(a,c,u)=>{if(/^[\w\-_]+:/.test(u)||!o.length)return a;for(let p of o){let f=pn.joinPath(p,u);if(await this.exists(f))return $8(u,f)}let l=rP(u),d=r.map(p=>"variableName"in p.anchor?u0(p.anchor.value)?p.anchor.value:p.anchor.value?.uri:u0(p.anchor)?p.anchor:p.anchor.uri).filter(p=>!!p).find(p=>Uc(p)===l);return d?$8(u,d):c};return e=await lE(e,/\[(`?)([^`\s]+)\1\]\((\2)\)/g,(a,c,u,l)=>s(a,u,l)),n?.isCancellationRequested?{text:e}:(e=await lE(e,/(?<!\[)(`([^`\s]+)`)(?!\])/g,s),{text:e,trustedCommands:[Iv]})}async exists(e){try{return await this.fileSystem.stat(e),!0}catch{return!1}}};aC=B([T(0,on),T(1,Ze)],aC);function $8(t,e){return V8("`"+t+"`",Cv(Iv,[HX(e)]),e.fsPath)}function HX(t){return{scheme:t.scheme,authority:t.authority,path:t.path,query:t.query,fragment:t.fragment}}var kl;(s=>{let t;(l=>(l[l.Default=0]="Default",l[l.CodeBlock=1]="CodeBlock",l[l.Accumulating=2]="Accumulating"))(t=s.Type||={});let e;(l=>(l[l.Word=0]="Word",l[l.InlineCode=1]="InlineCode",l[l.PotentialLink=2]="PotentialLink"))(e=s.AccumulationType||={}),s.Default={type:0};class n{constructor(c,u){this.fence=c;this.indent=u;this.type=1}}s.CodeBlock=n;class o{constructor(c,u=0){this.pendingText=c;this.accumulationType=u;this.type=2}}s.Accumulating=o})(kl||={});var W8=class{constructor(e,r=[]){this.references=e;this.linkifiers=r;this._state=kl.Default;this._appliedText=""}async append(e,r){let n={text:"",trustedCommands:G8};for(let o of e.split(/(\s+)/))if(o.length)switch(this._state.type){case 0:{let s=o.match(/(^|\n)\s*(`{3,}|~{3,})/);if(s){let a=this._appliedText.match(/(\n|^)([ \t]*)$/);this._state=new kl.CodeBlock(s[2],a?.[2]??""),n=x2(n,this.doAppend(o))}else if(/\s/.test(o)){let a=await this.doLinkifyAndAppend(o,r);n=x2(n,a)}else if(/^\s*\[.+\]\(.+\)\s*/.test(o)){let a=await this.doLinkifyAndAppend(o,r);n=x2(n,a)}else/^[^\[]*`[^`]*$/.test(o)?this._state=new kl.Accumulating(o,1):/^\s*\[[^\]]+$/.test(o)?this._state=new kl.Accumulating(o,2):this._state=new kl.Accumulating(o);break}case 1:{if(new RegExp("(^|\\n)"+this._state.fence+"($|\\n)").test(o)){let s=this._appliedText.match(/(\n|^)([ \t]*)$/);s&&s[2].length<=this._state.indent.length&&(this._state=kl.Default)}n=x2(n,this.doAppend(o));break}case 2:{let s=async a=>{let c=a.pendingText+o;this._state=kl.Default;let u=await this.doLinkifyAndAppend(c,r);n=x2(n,u)};if(this._state.accumulationType===2){if(/]/.test(o)){this._state=new kl.Accumulating(this._state.pendingText+o,0);break}else if(/\n/.test(o)){await s(this._state);break}}else if(this._state.accumulationType===1&&/`/.test(o)){await s(this._state);break}else if(this._state.accumulationType===0&&/\s/.test(o)){await s(this._state);break}this._state=new kl.Accumulating(this._state.pendingText+o,this._state.accumulationType);break}}return n}async flush(e){if(this._state.type===2){let r=this._state.pendingText;return this._state=kl.Default,this.doLinkifyAndAppend(r,e)}}doAppend(e){return this._appliedText=this._appliedText+e,{text:e,trustedCommands:G8}}async doLinkifyAndAppend(e,r){this.doAppend(e);let n=new Set(G8);for(let o of this.linkifiers){let s=await o.linkify(e,this.references,r);if(r?.isCancellationRequested)return{text:e};if(s){e=s.text;for(let a of s.trustedCommands??[])n.add(a)}}return e=e.replace(/\[([^\[\]]+)]\(([^\s\)]+)\)/g,(o,s,a)=>/^\w+:/.test(a)?o:s),{text:e,trustedCommands:Array.from(n)}}};function x2(t,e){return{text:t.text+e.text,trustedCommands:Array.from(new Set([...t.trustedCommands??[],...e.trustedCommands??[]]))}}var cC=class{constructor(e,r){this.fileSystem=e;this.workspaceService=r}async linkify(e,r,n){let o=this.workspaceService.getWorkspaceFolders(),s=!1;if(e=await lE(e,/\[`([^`\[\]]+?)`]\((\S+?\.\w+)\)/g,async(a,c,u)=>{for(let l of o){let d=pn.joinPath(l,u);if(await this.exists(d))return s=!0,wJe(d,c)}return"`"+c+"`"}),!(!s||n.isCancellationRequested))return{text:e,trustedCommands:[sC]}}async exists(e){try{return await this.fileSystem.stat(e),!0}catch{return!1}}};cC=B([T(0,on),T(1,Ze)],cC);function wJe(t,e){return V8("`"+e+"`",Cv(sC,[HX(t),e]),t.fsPath)}var lC=se("ILinkifyService"),uC=class{constructor(e,r){this.globalLinkifiers=new Set;this.registerGlobalLinkifier({create:()=>new aC(e,r)}),this.registerGlobalLinkifier({create:()=>new cC(e,r)})}registerGlobalLinkifier(e){if(this.globalLinkifiers.has(e))throw new Error("Linkifier already registered");return this.globalLinkifiers.add(e),{dispose:()=>this.globalLinkifiers.delete(e)}}createLinkifier(e,r){return new W8(e,[...r,...this.globalLinkifiers].map(n=>n.create()))}};uC=B([T(0,on),T(1,Ze)],uC);var Mb=class{constructor(e,r,n,o,s){this.sequencer=Promise.resolve();this._linkifier=e.get(lC).createLinkifier(r,o),this._progress=n,this._token=s}markdown(e){return this.appendMarkdown(typeof e=="string"?new Bc(e):e),this}anchor(e,r){return this.enqueue(()=>this._progress.anchor(e,r)),this}button(e){return this.enqueue(()=>this._progress.button(e)),this}filetree(e,r){return this.enqueue(()=>this._progress.filetree(e,r)),this}progress(e){return this.enqueue(()=>this._progress.progress(e)),this}warning(e){return this.enqueue(()=>this._progress.warning(e)),this}reference(e){return this.enqueue(()=>this._progress.reference(e)),this}push(e){return e instanceof Pi?this.appendMarkdown(e.value):this.enqueue(()=>this._progress.push(e)),this}textEdit(e,r){return this.enqueue(()=>this._progress.textEdit(e,r)),this}markdownWithVulnerabilities(e,r){return this.enqueue(()=>this._progress.markdownWithVulnerabilities(e,r)),this}detectedParticipant(e,r){return this.enqueue(()=>this._progress.detectedParticipant(e,r)),this}confirmation(e,r,n){return this.enqueue(()=>this._progress.confirmation(e,r,n)),this}enqueue(e,r=!0){return r&&(this.sequencer=this.sequencer.then(()=>this.doFinalize())),this.sequencer=this.sequencer.then(e),this.sequencer}async appendMarkdown(e){this.enqueue(async()=>{await this.doApplyText(e.value)},!1)}async finalize(){await this.enqueue(()=>this.doFinalize(),!1)}async doFinalize(){let e=await this._linkifier.flush(this._token);this._token.isCancellationRequested||e&&this.outputMarkdown(e)}async doApplyText(e){if(!e)return;let r=await this._linkifier.append(e,this._token);this._token.isCancellationRequested||r&&this.outputMarkdown(r)}outputMarkdown(e){if(!e.text)return;let r=new Bc(e.text);r.isTrusted={enabledCommands:e.trustedCommands??[]},this._progress.markdown(r)}};var RJe=3,kJe=3,AJe=1;function dC(t,e){let r=0;for(let n of e)r+=PJe(t,n);return r+=RJe,r}function PJe(t,e){let r=kJe;for(let[n,o]of Object.entries(e))o&&(r+=t.tokenLength(o),n==="name"&&(r+=AJe));return r}var K8=class{constructor(e,r){this.originalText=e;this._combinedEditsSinceStart=Zn.empty;this._text=r.apply(this.originalText),this._textAfterTrackedEdits=this._text,this._originalEdits=r}handleEdits(e){let r=e.apply(this._text),n=this._combinedEditsSinceStart.compose(e);n=n.removeCommonSuffixPrefix(this._textAfterTrackedEdits),this._combinedEditsSinceStart=n,this._text=r}computeTrackedEditsSurvivalScore(){let e=0,r=0,n=0,o=0,s=this._originalEdits.getNewTextRanges(),a=DJe(s,this._combinedEditsSinceStart);for(let c=0;c<s.length;c++){let u=this._originalEdits.edits[c],l=this.originalText.substring(u.replaceRange.start,u.replaceRange.endExclusive),d=u.newText,p=a[c],f=this._text.substring(p.start,p.endExclusive),m=S2(f,d),h=S2(d,l),g=S2(f,l);if(h!==1){let _=1-Math.max(g-h,0)/(1-h);n+=u.replaceRange.length*_,o+=u.replaceRange.length}let v=u.newText.length*m,y=u.newText.length;e+=v,r+=y}return{fourGram:r===0?1:e/r,noRevert:o===0?1:n/o}}};function S2(t,e){if(t.length<4||e.length<4)return t===e?1:0;let n=new Map;for(let c=0;c<=t.length-4;c++){let u=t.substring(c,c+4),l=n.get(u)||0;n.set(u,l+1)}for(let c=0;c<=e.length-4;c++){let u=e.substring(c,c+4),l=n.get(u)||0;n.set(u,l-1)}let o=t.length-4+1+e.length-4+1,s=0;for(let c of n.values())s+=Math.abs(c);return(o-s)/o}function DJe(t,e){t=t.slice();let r=[],n=0;for(let o of e.edits){for(;;){let a=t[0];if(!a||a.endExclusive>=o.replaceRange.start)break;t.shift(),r.push(a.delta(n))}let s=[];for(;;){let a=t[0];if(!a||!a.intersectsOrTouches(o.replaceRange))break;t.shift(),s.push(a)}for(let a=s.length-1;a>=0;a--){let c=s[a],u=c.intersect(o.replaceRange).length;c=c.deltaEnd(-u+(a===0?o.newText.length:0));let l=c.start-o.replaceRange.start;l>0&&(c=c.delta(-l)),a!==0&&(c=c.delta(o.newText.length)),c=c.delta(-(o.newText.length-o.replaceRange.length)),t.unshift(c)}n+=o.newText.length-o.replaceRange.length}for(;;){let o=t[0];if(!o)break;t.shift(),r.push(o.delta(n))}return r}var Tv=class{constructor(e,r,n,o,s,a,c,u,l){this._document=e;this._originalDocumentText=r;this._edits=n;this._sharedProps=s;this._sharedMeasures=a;this._gitService=u;this._telemetryService=l;this._editSurvivalTracker=new K8(this._originalDocumentText,this._edits);this._store=new Nt;this._store.add(c.onDidChangeTextDocument(d=>{if(d.document!==this._document)return;let p=Zn.from(d.contentChanges);this._editSurvivalTracker.handleEdits(p)})),this._editSurvivalTracker.handleEdits(o),this._initialBranchName=this._getCurrentBranchName(),this._reportAfter(30*1e3),this._reportAfter(120*1e3),this._reportAfter(300*1e3),this._reportAfter(600*1e3,()=>{this._store.dispose()})}_getCurrentBranchName(){return this._gitService.getRepository(this._document.uri)?.headBranchName}_reportAfter(e,r){let n=new fP(()=>{this._report(e),n.dispose(),r&&r()},e);this._store.add(n)}_report(e){let r=this._editSurvivalTracker.computeTrackedEditsSurvivalScore(),o=this._getCurrentBranchName()!==this._initialBranchName;this._telemetryService.sendMSFTTelemetryEvent("inline.trackEditSurvival",this._sharedProps,{...this._sharedMeasures,survivalRateFourGram:r.fourGram,survivalRateNoRevert:r.noRevert,timeDelayMs:e,didBranchChange:o?1:0})}};Tv=B([T(6,Ze),T(7,Fo),T(8,me)],Tv);var pC=se("IFeedbackReporter");function fC(){let t=Br(),e=Vn.createAndMarkAsIssued({messageId:t});return new jX(e)}var jX=class t{constructor(e){this.raw=e}get properties(){return this.raw.properties}get measurements(){return this.raw.measurements}markAsDisplayed(){this.raw.markAsDisplayed()}extendedBy(e,r){let n=this.raw.extendedBy(e,r);return new t(n)}};function Y8(t,e,r,n,o,s,a){let c=t.turns[t.turns.length-1].contextParts.map(d=>d.kind).sort(),u={source:"user",turnIndex:(t.turns.length-1).toString(),conversationId:e,uiKind:r,inputSources:c.join(",")},l={promptTokenLen:o,messageCharLen:n.length};return s&&(u.suggestion=s),a=a.extendedBy(u,l),a}function Q8(t,e,r,n,o,s,a){o!==void 0&&(a=a.extendedBy({offTopic:o.toString()})),a=a.extendedBy({headerRequestId:r}),zX(t,s,e,n,{},{},a)}function X8(t,e,r,n,o,s,a,c){let u=GX(o);zX(t,a,n,o,{source:"model",turnIndex:e.turns.length.toString(),conversationId:r,headerRequestId:s,uiKind:n,codeBlockLanguages:JSON.stringify({...u})},{messageCharLen:o.length,numCodeBlocks:u.length},c)}function J8(t,e,r,n,o,s,a,c){zX(t,a,n,o,{source:"offTopic",turnIndex:e.turns.length.toString(),conversationId:r,userMessageId:s,uiKind:n},{messageCharLen:o.length},c)}function zX(t,e,r,n,o,s,a){let c={...n?{messageText:n}:{},...o};e&&(o.languageId=e.languageId,s.documentLength=e.getText().length);let u=a.extendedBy(o,s),l=a.extendedBy(c),d=NJe(r);return t.sendGHTelemetryEvent(`${d}.message`,u.raw.properties,u.raw.measurements),t.sendRestrictedGHTelemetryEvent(`${d}.messageText`,l.raw.properties,l.raw.measurements),u.raw}function Z8(t,e,r,n,o){return cm(t.get(me),o,{suggestion:e,messageId:r,suggestionId:n},{},"conversation.suggestionShown")}function cm(t,e,r,n,o,s){let a=s??Vn.createAndMarkAsIssued();e&&(r.languageId=e.languageId,n.documentLength=e.getText().length);let c=a.extendedBy(r,n);return t.sendGHTelemetryEvent(o,c.properties,c.measurements),c}function NJe(t){switch(t){case"conversationInline":return"inlineConversation";case"conversationPanel":default:return"conversation"}}function GX(t){let e=t.split(`
`),r=[],n=[];for(let o=0;o<e.length;o++){let s=e[o];s.startsWith("```")&&(n.length>0&&s==="```"?r.push(n.pop()):n.length===0&&n.push(s.substring(3)))}return r}var eM={top_p:1,temperature:.1};var Ev=W(ct());var mC=class t{constructor(e,r){this.accessor=e;this.location=r;this.logger=e.get(ce).getPromptResponseLogger("intent detection"),this.telemetryService=e.get(me),this.options=e.get($n),this.configurationService=this.accessor.get(be),this.testProvider=this.accessor.get(Rc),this.experimentationService=this.accessor.get(Lt),this.intentService=this.accessor.get(nc)}async detectIntent(e,r,n,o,s,a,c){let u=await this.accessor.get(Le).getChatEndpoint("gpt-3.5-turbo"),l=await this.accessor.get(be).getExperimentBasedConfig(ge.IntentDetectionWithFunctionCalling,this.experimentationService),d=new Xe(u,l?I2:lp,{preferredIntent:a,location:this.location,userQuestion:r,documentContext:e},this.accessor.get(ve).acquireTokenizer(u.family),this.accessor),{messages:p}=await d.render(void 0,o);this.logger.logPrompt(p);let f=[],m=async(_,b,S)=>{if(S.copilotFunctionCalls)for(let I of S.copilotFunctionCalls)f.push({name:I.name,arguments:JSON.parse(I.arguments)})},h=l?this.getFunctions().map(_=>({name:_.functionName??_.name,description:_.description})):void 0,g=await this.accessor.get(jt).fetchMany(p,m,o,this.location,u,{agent:n},{temperature:this.options.temperature,top_p:this.options.topP,stop:[";"],n:1,functions:h},{messageSource:"chat.intentprompt"}),v=this.handleResult(g,s,r,f.map(_=>_.name),a);this.sendTelemetry(a,v?.id,e?.language.languageId,c);let y=d.getMeta(C2);return this.sendInternalTelemetry(r,a,y?.filePath,y?.fileExcerpt,v?.id,e?.language.languageId,c),v}getFunctions(){return lp.getDetectableIntents(this.location,this.intentService,this.configurationService,this.testProvider).map(e=>({name:e.id,functionName:e.intentDetectionInput.functionName,description:e.intentDetectionInput.modelDescription||e.description}))}handleResult(e,r,n,o,s){if(this.logger.logResponse(e),e.type!=="success"){this.sendPromptIntentErrorTelemetry(r,e);return}let a=o?.length?o.map(d=>{let[p,f]=d.split(".");return(f??p).replaceAll("'","")}):e.value.map(d=>d.trimStart().split(`
`)[0].replace(/function id:|response:/i,"").trim());a=a.filter(d=>d!==Rl.ID),!a.length&&s&&(a=[s]);let c=a.map(d=>this.intentService.getIntent(d,this.location)??this.intentService.getIntentByFunctionName(d,this.location)).filter(d=>d!==void 0),u=t.pickMostFrequent(c);this.logger.info(`picked intent "${u?.id}" from ${JSON.stringify(e.value,null,"	")}`);let l=r.extendedBy({messageText:n,promptContext:a.join(),intent:u?.id||"unknown"});return this.telemetryService.sendRestrictedGHTelemetryEvent("conversation.promptIntent",l.raw.properties,l.raw.measurements),u}sendPromptIntentErrorTelemetry(e,r){let n=e.extendedBy({resultType:r.type,reason:r.reason});this.telemetryService.sendRestrictedGHTelemetryErrorEvent("conversation.promptIntentError",n.raw.properties,n.raw.measurements)}static pickMostFrequent(e){if(e.length===0)return;let r=new Map;for(let o of e){let s=r.get(o.id)??[0,o];s[0]+=1,r.set(o.id,s)}let[,n]=[...r.values()].reduce((o,s)=>o[0]>s[0]?o:s);return n}sendTelemetry(e,r,n,o){this.accessor.safeGet(me)?.sendMSFTTelemetryEvent("intentDetection",{chatLocation:mt.toString(this.location),preferredIntent:e??"<none>",detectedIntent:r??"<none>",languageId:n??"<none>",isRerunWithoutIntentDetection:String(o)??"<none>"})}sendInternalTelemetry(e,r,n,o,s,a,c){o=o&&o.length<5e3?o:void 0,this.accessor.safeGet(me)?.sendInternalMSFTTelemetryEvent("intentDetection",{chatLocation:mt.toString(this.location),request:e,preferredIntent:r??"<none>",filePath:n??"<none>",fileExerpt:o??"<none>",detectedIntent:s??"<none>",languageId:a??"<none>",isRerunWithoutIntentDetection:String(c)??"<none>"},{})}},C2=class extends Ev.PromptMetadata{constructor(r,n){super();this.fileExcerpt=r;this.filePath=n}},lp=class extends Y{constructor(r,n,o,s,a,c){super(r,n);this._ignoreService=o;this._configurationService=s;this._testProvider=a;this._intentService=c}static getDetectableIntents(r,n,o,s){let a=n.getIntents(r),c=[];for(let u=0;u<a.length;u++){let l=a[u];l.id==="review"&&!o.getConfig(ge.ReviewIntent)||l.id==="fixTestFailure"&&(!s.isEnabled.get()||ks.isEmpty(s.getAllFailures()))||l.commandInfo?.defaultEnablement!==!1&&c.push(l)}return c}async prepare(r,n,o){let{documentContext:s}=this.props,a=!1;return s!==void 0&&(a=await this._ignoreService.isCopilotIgnored(s.document.uri)),{isDocumentCopilotIgnored:a}}render(r){let{preferredIntent:n,location:o,userQuestion:s,documentContext:a}=this.props,c,u,l;try{if(a!==void 0&&!r.isDocumentCopilotIgnored){let{document:f,selection:m}=a;c=f.uri;let h=new ze(new Xr(Math.max(m.start.line-5,0),0),new Xr(Math.min(m.end.line+5,f.lineCount),f.lineAt(m.end.line).text.length));u=f.getText(h),l=u.trim().length>0?vscpp(Oe,{uri:c,languageId:f.languageId,code:u,shouldTrim:!1}):void 0}}catch{}let d=new C2(u,c?.path),p=lp.getDetectableIntents(o,this._intentService,this._configurationService,this._testProvider);return vscpp(vscppf,null,vscpp("meta",{value:d}),vscpp(Ev.SystemMessage,null,'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"Follow the user's requirements carefully & to the letter.",vscpp("br",null)),vscpp(Ev.UserMessage,null,"A software developer is using an AI chatbot in a code editor",c&&` in file ${c.path}`,".",vscpp("br",null),l===void 0?vscpp("br",null):vscpp(vscppf,null,"Current active file contains following excerpt:",vscpp("br",null),l,vscpp("br",null)),"The developer added the following request to the chat and your goal is to select a function to perform the request.",vscpp("br",null),n&&`The developer probably wants Function Id '${n}', pick different only if you're certain.`,vscpp("br",null),"Request: ",s,vscpp("br",null),vscpp("br",null),"Available functions:",vscpp("br",null),p.map(f=>vscpp(vscppf,null,"Function Id: ",f.id,vscpp("br",null),"Function Description: ",f.intentDetectionInput.modelDescription||f.description,vscpp("br",null),vscpp("br",null))),vscpp("br",null),"Here are some examples to make the instructions clearer:",vscpp("br",null),p.map(f=>vscpp(vscppf,null,"Request: ",f.intentDetectionInput.sampleQuestion,vscpp("br",null),"Response: ",f.id,vscpp("br",null),vscpp("br",null))),"Request: ",s,vscpp("br",null),"Response:"))}};lp=B([T(2,De),T(3,be),T(4,Rc),T(5,nc)],lp);var I2=class extends lp{constructor(e,r,n,o,s,a){super(e,r,n,o,s,a)}render(e){let{preferredIntent:r,location:n,userQuestion:o,documentContext:s}=this.props,a=r?this._intentService.getIntent(r,n)?.intentDetectionInput.functionName:void 0,c,u,l;try{if(s!==void 0&&!e.isDocumentCopilotIgnored){let{document:f,selection:m}=s;c=f.uri;let h=new ze(new Xr(Math.max(m.start.line-5,0),0),new Xr(Math.min(m.end.line+5,f.lineCount),f.lineAt(m.end.line).text.length));u=f.getText(h),l=u.trim().length>0?vscpp(Oe,{uri:c,languageId:f.languageId,code:u,shouldTrim:!1}):void 0}}catch{}let d=new C2(u,c?.path),p=lp.getDetectableIntents(n,this._intentService,this._configurationService,this._testProvider);return vscpp(vscppf,null,vscpp("meta",{value:d}),vscpp(Ev.SystemMessage,null,"You are an AI programming assistant in the Visual Studio Code editor.",vscpp("br",null),c&&vscpp(vscppf,null,"The user is currently looking at the file ",c.path,".",vscpp("br",null)),l&&vscpp(vscppf,null,"The current active file contains the following excerpt:",vscpp("br",null),l,vscpp("br",null)),"Your task is to choose the function from the following list that is most relevant to the user's message. This function will be executed to provide the user with a more specific and actionable response.",vscpp("br",null),vscpp("br",null),Kt(p.filter(f=>!!f.intentDetectionInput.functionCallingBlurb).map(f=>`Function name: ${f.intentDetectionInput.functionName??f.id}
${f.intentDetectionInput.functionCallingBlurb}
An example of a question that matches the '${f.intentDetectionInput.functionName??f.id}' function is: "${f.intentDetectionInput.sampleQuestion}".`)).join(`

`),vscpp("br",null),vscpp("br",null),n===2&&vscpp(vscppf,null,"If the user's question is not related to the functions described above, you should use the 'unknown' function.",vscpp("br",null)),a&&vscpp(vscppf,null,"The user probably wants the '",a,"' function, pick different only if you're certain.",vscpp("br",null)),"Your response should contain just the name of the function and no other text. You can only choose from the functions mentioned above."),vscpp(Ev.UserMessage,null,o))}};I2=B([T(2,De),T(3,be),T(4,Rc),T(5,nc)],I2);async function JTe(t,e,r,n,o,s){let a=t.get(Sv),c=t.get(nc),u,l="",d=!1,p=a.parse(e.prompt,1);if(p.command)u=p.command.intent,l=p.restOfQuery,d=!0;else{let h=e.enableCommandDetection,v=new mC(t,1).detectIntent(r,e.prompt,n?.agent,s,o,n?.preferredIntent,!h);h&&(u=await v,u?.id===_v.ID&&r.selection.isEmpty&&r.document.lineAt(r.selection.start.line).text.trim()===""&&(u=c.getIntent(xv.ID,1))),l=e.prompt}let f;if(u){let h=a.getCommand(u.id,1);h&&(h.intent?.asSlashCommand?f=await h.intent.asSlashCommand(t,r):f={name:h.commandId,description:h.details})}u??=c.unknowIntent;let m=await u.invoke(t,{request:e,location:1,documentContext:r,slashCommand:f});return{queryWithoutCommand:l,intentInvocation:m,slashCommand:f,fromQuery:d}}async function ZTe(t,e,r,n,o,s){let a=new Pc;if(r&&r.length>0){let l=`The current code is a result of a previous interaction with you. Here are my previous messages: 
- ${r.map(p=>p.prompt).join(`
- `)}`,d=new sp({message:l,type:"user"});a.addTurn(d)}let c=new sp({message:t.queryWithoutCommand,type:"user"});c.intentInvocation=t.intentInvocation,a.addTurn(c);let u={report(l){o.push(l)}};return await t.intentInvocation.buildPrompt(a,e.references,u,n,s)}var VX=class{constructor(e,r,n,o,s){this.wholeRange=e;this.document=r;this.formattingOptions=n;this.preferredIntent=o;this.agent=s;this._requests=[];this.aiEditCollector=void 0;this.store=void 0;this.sessionId=Br(),this.conversation=void 0}addRequest(e){this._requests.push(e)}getRequests(){return this._requests}};var dp=class{constructor(e,r,n,o,s,a,c,u,l,d,p,f){this.agent=e;this.rejectionMessage=r;this._telemetryService=o;this.tabAndEditorsService=s;this.languageDiagnosticsService=a;this.ignoreService=c;this.chatMLFetcher=u;this.tokenizerProvider=l;this.feedbackReporter=d;this.instantiationService=p;this.accessor=f;this.logger=n.getPromptResponseLogger("interactiveEditor"),this.logger.info(`CopilotInteractiveEditorSessionProvider created, with rejection message: ${this.rejectionMessage}`)}async prepareInteractiveEditorSession(e){if(await this.ignoreService.isCopilotIgnored(e.document.uri))throw new Error(eEe.t("Inline chat is disabled for this file due to content exclusion policies."));let n;if(this.tabAndEditorsService.activeTextEditor?.document.uri.toString()===e.document.uri.toString()){let s=this.tabAndEditorsService.activeTextEditor.options;n={insertSpaces:s.insertSpaces,tabSize:s.tabSize}}let o;return e.selection.isEmpty&&e.document.lineAt(e.selection.start.line).text.trim()===""?o=xv.ID:!e.selection.isEmpty&&e.selection.start.line!==e.selection.end.line&&(o=_v.ID),new VX(e.selection,e.document,n,o,this.agent)}async provideInteractiveEditorResponse(e,r,n,o){this.logger.info(`CopilotInteractiveEditorSessionProvider query: ${r.prompt}`),r.attempt===0&&e.addRequest(r);let s=e.aiEditCollector=this.instantiationService.createInstance(sv,e.document.getText()),a=n;n=new nm(u=>{"edits"in u&&s.addEdits(u.edits),a.push(u)});let c=await this.fetchResponse(e,r,n,o);if(c)return"edits"in c?.parsedReply&&s.addEdits(c.parsedReply.edits),LJe(e,c)}handleInteractiveEditorResponseFeedback(e,r,n){if(this.logger.debug("CopilotInteractiveEditorSessionProvider feedback received"),n===4&&e.conversation){this.feedbackReporter.reportInline(e.conversation,r.promptQuery,r.reply);return}let o={messageId:r.messageId},s,{selection:a,wholeRange:c,intent:u,query:l}=r.promptQuery,d=e.conversation?.getLatestTurn()?.requestId??"",p=e.sessionId,f=u?.id,m=e.document.languageId,h=r.reply.type,g=h==="inlineEdit"?r.reply.edits:null,v=f==="fix"?tEe(a,this.languageDiagnosticsService.getDiagnostics(e.document.uri)):void 0,y=$t(e.document.uri)?1:0,_={languageId:m,replyType:h,conversationId:p,requestId:d,command:f},b={selectionLineCount:a?Math.abs(a.end.line-a.start.line):-1,wholeRangeLineCount:c?Math.abs(c.end.line-c.start.line):-1,editCount:g?.length??-1,editLineCount:g?.reduce((I,w)=>I+w.newText.split(`
`).length,0)??-1,isNotebook:y,problemsCount:v?.fileDiagnosticsTelemetry.problemsCount??0,selectionProblemsCount:v?.selectionDiagnosticsTelemetry.problemsCount??0,diagnosticsCount:v?.fileDiagnosticsTelemetry.diagnosticsCount??0,selectionDiagnosticsCount:v?.selectionDiagnosticsTelemetry.diagnosticsCount??0},S=(I,w)=>{this._telemetryService.sendInternalMSFTTelemetryEvent(I,{language:m,intent:f,query:l,conversationId:p,requestId:d,replyType:h,problems:v?.fileDiagnosticsTelemetry.problems??"",selectionProblems:v?.selectionDiagnosticsTelemetry.problems??"",diagnosticCodes:v?.fileDiagnosticsTelemetry.diagnosticCodes??"",selectionDiagnosticCodes:v?.selectionDiagnosticsTelemetry.diagnosticCodes??""},{isNotebook:y,...w})};if(n===3&&e.aiEditCollector){let I=e.aiEditCollector,w=new bI(e.aiEditCollector.getText(),e.document,this.accessor);(async()=>{try{let[O,U]=await Promise.all([I.getEdits(),w.compute()]),z=U.getEditsSinceInitial();this.instantiationService.createInstance(Tv,e.document,I.initialText,O,z,_,b)}finally{w.dispose()}})()}if(e.aiEditCollector=void 0,n===1||n===0){let I=n===1?1:0;this._telemetryService.sendMSFTTelemetryEvent("inline.action.vote",_,{...b,vote:I}),S("interactiveSessionVote",{vote:I})}else if(n===2||n===3){let I=n===3?1:0;this._telemetryService.sendMSFTTelemetryEvent("inline.done",_,{...b,accepted:I}),S("interactiveSessionDone",{accepted:I})}switch(n){case 1:o.rating="positive",s="inlineConversation.messageRating";break;case 0:o.rating="negative",s="inlineConversation.messageRating";break;case 2:o.action="undo",s="inlineConversation.undo";break;case 3:o.action="accept",s="inlineConversation.accept";break;case 4:s="";break}s&&cm(this.accessor.get(me),e.document,o,{},s)}async fetchResponse(e,r,n,o){let s=new T2(Date.now(),e,e.conversation===void 0,r,this._telemetryService,this.languageDiagnosticsService,this.tokenizerProvider),a;e.getRequests().length>1&&r.attempt===0&&e.store&&e.document.getText()===e.store.lastDocumentContent&&(a=e.store.lastWholeRange,this.logger.debug("Ignoring passed in whole range and using the whole range from the previous turn"));let c=e.document.getText(),u={document:e.document,fileIndentInfo:e.formattingOptions,language:As(e.document),selection:r.selection,wholeRange:a??r.wholeRange};(e.getRequests().length>1||r.attempt>0)&&(e.preferredIntent=void 0);let l=await JTe(this.accessor,r,u,e,s.baseUserTelemetry,o),d=l.intentInvocation;l.slashCommand&&!l.fromQuery&&n.detectedParticipant("github.copilot.editor",l.slashCommand);let p={query:l.queryWithoutCommand,...u,intent:d.intent},{messages:f,references:m}=await ZTe(l,r,e.getRequests().slice(0,-1),s.baseUserTelemetry,n,o);for(let N of m)n.reference(N.anchor);if(o.isCancellationRequested)return;let h=e.conversation;h||(h=e.conversation=new Pc);let g=new sp({message:f.map(N=>N.content).join(`
`),type:"user"});g.requestDebugInformation={uri:e.document.uri,intentId:l.intentInvocation.intent.id,languageId:e.document.languageId,initialDocumentText:c,userPrompt:r.prompt,userSelection:r.selection},g.chatMessages=f,g.requestId=s.telemetryMessageId,h.addTurn(g),this.logger.logPrompt(f);let v,y,_=d.linkification?.disable?void 0:new Mb(this.accessor,m,n,d.linkification?.additionaLinkifiers??[],o),b=_??n,S=d.createReplyInterpreter();if(f.length===0){let N=await S.processResponse(Oo.EMPTY,b,o);return _&&await _.finalize(),{promptQuery:p,parsedReply:N,messageId:s.telemetryMessageId}}let I=s.makeRequest(h,l.queryWithoutCommand,d,f);b=nm.spy(b,N=>{N instanceof Pi&&I.markEmittedMarkdown(N.value)});let w=new U_,O=S.processResponse(w.stream,b,o),U=!1;O.finally(()=>{U=!0});let z=async(N,E,P)=>(I.markReceivedToken(),w.update(N,P),U?N.length:void 0);try{v=await this.chatMLFetcher.fetchOne(f,z,o,1,d.endpoint,{agent:wE},{temperature:dp.pickTemperature(r),top_p:eM.top_p},{messageId:I.telemetryMessageId,messageSource:d.intent.id!==Rl.ID?`inline.${d.intent.id}`:"inline.user"},{intent:!0})}catch(N){throw this.logger.exception(N,"Fetching failed: "),this._telemetryService.sendGHTelemetryException(N,"Fetching failed: "),g.status="error",g.response={message:N.message,type:"server"},new Error("Failed to make request")}if(this.logger.logResponse(v),v.type!=="success")return this._handleFetchError(g,v,I);if(y=v.value,y.length===0){this.logger.info("Response is empty."),I.sendTelemetry(v.requestId,"unknown","Empty response");return}w.resolve();let M=await O;_&&await _.finalize(),g.status="success";let re=y;g.response={message:re,type:"model"},g.responseDebugInformation={parsedReply:M},I.sendTelemetry(v.requestId,"success",re,M);let ee={...M};return ee.type==="inlineEdit"&&delete ee.store,this.logger.info(`Parsed response: ${JSON.stringify(M,null,"	")}`),{promptQuery:p,parsedReply:M,messageId:I.telemetryMessageId}}_handleFetchError(e,r,n){let{turnStatus:o,message:s,messageType:a,throwError:c}=this._interpretFetchError(r);if(e.status=o,e.response={message:s,type:a},n.sendTelemetry(r.requestId,r.type,s),c)throw new Error(c)}_interpretFetchError(e){switch(e.type){case"rateLimited":return{turnStatus:"error",message:`Response failed ${e.type}: ${e.reason}`,messageType:"server",throwError:"Oops, your request failed due to a rate limit. Please try again later."};case"badRequest":return{turnStatus:"error",message:`Response failed ${e.type}: ${e.reason}`,messageType:"server",throwError:"Failed to make request"};case"failed":return this.logger.error(`Response failed: ${e.reason}`),{turnStatus:"error",message:e.reason,messageType:"server",throwError:"Failed to make request"};case"canceled":return this.logger.debug(`Response canceled: ${e.reason}`),{turnStatus:"error",message:"Cancelled",messageType:"user"};case"unknown":{let r=`Response is empty: ${e.reason}`;return this.logger.info(r),{turnStatus:"error",message:r,messageType:"server"}}case"filtered":{let r=`Response got filtered: ${e.reason}`;return this.logger.info(r),{turnStatus:"filtered",message:r,messageType:"server",throwError:m8(e.category,!1)}}case"offTopic":return this.logger.info(`Response marked as offtopic: ${e.reason}`),{turnStatus:"off-topic",message:this.rejectionMessage,messageType:"offtopic-detection"};case"length":{let r=`Response was too long: ${e.reason}`;return this.logger.info(r),{turnStatus:"error",message:r,messageType:"server"}}default:return this.logger.error("Unexpected response type"),this.logger.info(JSON.stringify(e)),{turnStatus:"error",message:`Unexpected response type: ${JSON.stringify(e)}`,messageType:"server"}}}static pickTemperature(e){return"attempt"in e&&typeof e.attempt=="number"?Math.min(eM.temperature*(e.attempt+1),2):eM.temperature}};dp=B([T(2,ce),T(3,me),T(4,Tt),T(5,ho),T(6,De),T(7,jt),T(8,ve),T(9,pC),T(10,or),T(11,rt)],dp);var T2=class{constructor(e,r,n,o,s,a,c){this._startTime=e;this._session=r;this._firstTurn=n;this._request=o;this._telemetryService=s;this._languageDiagnosticsService=a;this._tokenizerProvider=c;this.baseUserTelemetry=fC()}get telemetryMessageId(){return this.baseUserTelemetry.properties.messageId}makeRequest(e,r,n,o){return new E2(this._session,this._firstTurn,this._request,this._startTime,this.baseUserTelemetry,e,r,n,o,this._telemetryService,this._languageDiagnosticsService,this._tokenizerProvider.acquireTokenizer(n.endpoint.family))}};T2=B([T(4,me),T(5,ho),T(6,ve)],T2);var E2=class{constructor(e,r,n,o,s,a,c,u,l,d,p,f){this._session=e;this._firstTurn=r;this._request=n;this._startTime=o;this._conversation=a;this._queryWithoutCommand=c;this._intentInvocation=u;this._messages=l;this._telemetryService=d;this._languageDiagnosticsService=p;this._tokenizer=f;this._requestStartTime=Date.now();this._firstTokenTime=0;this._markdownCharCount=0;this._userTelemetry=Y8(this._conversation,this._session.sessionId,"conversationInline",this._request.prompt,OJe(this._tokenizer,this._messages),this._intentInvocation.intent.id,s),this._diagnosticsTelemetryData=tEe(this._request.selection,this._languageDiagnosticsService.getDiagnostics(this._session.document.uri)),this._sendInternalRequestTelemetryEvent()}get telemetryMessageId(){return this._userTelemetry.properties.messageId}get _isNotebookDocument(){return $t(this._session.document.uri)?1:0}_sendInternalRequestTelemetryEvent(){this._telemetryService.sendInternalMSFTTelemetryEvent("interactiveSessionRequest",{conversationId:this._session.sessionId,requestId:this.telemetryMessageId,chatLocation:"inline",intent:this._intentInvocation.intent.id,language:this._session.document.languageId,prompt:this._messages.map(e=>`${e.role.toUpperCase()}:
${e.content}`).join(`
---
`),model:this._intentInvocation.endpoint.model},{isNotebook:this._isNotebookDocument})}markReceivedToken(){this._firstTokenTime===0&&(this._firstTokenTime=Date.now())}markEmittedMarkdown(e){this._markdownCharCount+=e.value.length}sendTelemetry(e,r,n,o){Q8(this._telemetryService,"conversationInline",e,this._request.prompt,r==="offTopic",this._session.document,this._userTelemetry),r==="offTopic"&&J8(this._telemetryService,this._conversation,this._session.sessionId,"conversationInline",this._request.prompt,this.telemetryMessageId,this._session.document,this._userTelemetry),r==="success"&&o&&X8(this._telemetryService,this._conversation,this._session.sessionId,"conversationInline",n,this.telemetryMessageId,this._session.document,this._userTelemetry.extendedBy({replyType:o.type})),this._sendTelemetryEvent(r,n,o),this._sendInternalTelemetryEvent(r,n)}_sendTelemetryEvent(e,r,n){this._telemetryService.sendMSFTTelemetryEvent("inline.request",{command:this._intentInvocation.intent.id??"",contextTypes:"none",promptTypes:this._messages.map(o=>`${o.role}${o.name?`-${o.name}`:""}:${o.content.length}`).join(","),conversationId:this._session.sessionId,requestId:this.telemetryMessageId,languageId:this._session.document.languageId,responseType:e,replyType:n?.type,model:this._intentInvocation.endpoint.model,diagnosticsProvider:this._diagnosticsTelemetryData.diagnosticsProvider,diagnosticCodes:this._diagnosticsTelemetryData.fileDiagnosticsTelemetry.diagnosticCodes,selectionDiagnosticCodes:this._diagnosticsTelemetryData.selectionDiagnosticsTelemetry.diagnosticCodes,outcomeAnnotations:n?.annotations?.map(o=>o.label).join(",")},{firstTurn:this._firstTurn?1:0,isNotebook:this._isNotebookDocument,withIntentDetection:this._request.enableCommandDetection===void 0?void 0:this._request.enableCommandDetection?1:0,messageTokenCount:this._tokenizer.tokenLength(this._queryWithoutCommand),promptTokenCount:dC(this._tokenizer,this._messages),responseTokenCount:e==="success"?this._tokenizer.tokenLength(r):-1,implicitCommand:this._request.prompt.trim().startsWith(`/${this._intentInvocation.intent.id}`)?0:1,attemptCount:this._request.attempt||0,selectionLineCount:this._request.selection?Math.abs(this._request.selection.end.line-this._request.selection.start.line)+1:-1,wholeRangeLineCount:this._request.wholeRange?Math.abs(this._request.wholeRange.end.line-this._request.wholeRange.start.line)+1:-1,editCount:n?.type==="inlineEdit"?n.edits.length:-1,editLineCount:n?.type==="inlineEdit"?n.edits.reduce((o,s)=>o+s.newText.split(`
`).length,0):-1,markdownCharCount:this._markdownCharCount,problemsCount:this._diagnosticsTelemetryData.fileDiagnosticsTelemetry.problemsCount,selectionProblemsCount:this._diagnosticsTelemetryData.selectionDiagnosticsTelemetry.problemsCount,diagnosticsCount:this._diagnosticsTelemetryData.fileDiagnosticsTelemetry.diagnosticsCount,selectionDiagnosticsCount:this._diagnosticsTelemetryData.selectionDiagnosticsTelemetry.diagnosticsCount,timeToRequest:this._requestStartTime-this._startTime,timeToFirstToken:this._firstTokenTime?this._firstTokenTime-this._startTime:-1,timeToComplete:Date.now()-this._startTime})}_sendInternalTelemetryEvent(e,r){this._telemetryService.sendInternalMSFTTelemetryEvent("interactiveSessionResponse",{conversationId:this._session.sessionId,requestId:this.telemetryMessageId,chatLocation:"inline",intent:this._intentInvocation.intent.id??"",problems:this._diagnosticsTelemetryData.fileDiagnosticsTelemetry.problems,selectionProblems:this._diagnosticsTelemetryData.selectionDiagnosticsTelemetry.problems,diagnosticCodes:this._diagnosticsTelemetryData.fileDiagnosticsTelemetry.diagnosticCodes,selectionDiagnosticCodes:this._diagnosticsTelemetryData.selectionDiagnosticsTelemetry.diagnosticCodes,diagnosticsProvider:this._diagnosticsTelemetryData.diagnosticsProvider,language:this._session.document.languageId,request:this._request.prompt,responseType:e,response:r},{isNotebook:this._isNotebookDocument})}};E2=B([T(9,me),T(10,ho)],E2);function LJe(t,e){let{promptQuery:r,parsedReply:n,messageId:o}=e;return n.type==="conversational"?{promptQuery:r,reply:n,messageId:o}:n.type==="workspaceEdit"?{edits:n.workspaceEdit,promptQuery:r,reply:n,messageId:o}:(t.store=n.store,{edits:n.edits,wholeRange:n.newWholeRange,reply:n,promptQuery:r,messageId:o})}function OJe(t,e){let r=0;for(let n of e)r+=t.tokenLength(n.content);return r}function tEe(t,e){let r=e.filter(l=>t.intersection(l.range)),n={problems:e.map(l=>l.message).join(", "),problemsCount:e.length,diagnosticCodes:"",diagnosticsCount:0},o={problems:r.map(l=>l.message).join(", "),problemsCount:r.length,diagnosticCodes:"",diagnosticsCount:0},s=new Map,a=new Map;e.forEach(l=>{let d=l.code,p=typeof d=="string"||typeof d=="number"?d.toString():d?d.value.toString():"",f=l.source?`${l.source}@${p}`:p;s.set(f,(s.get(f)||0)+1),t.intersection(l.range)&&a.set(f,(a.get(f)||0)+1)});let c=l=>{let d="";return l.forEach((p,f)=>{d+=`${f}:${p},`}),d};n.diagnosticCodes=c(s),n.diagnosticsCount=s.size,o.diagnosticCodes=c(a),o.diagnosticsCount=a.size;let u=e.length>0?e[0].source??"":"";return{fileDiagnosticsTelemetry:n,selectionDiagnosticsTelemetry:o,diagnosticsProvider:u}}var Dc=class{constructor(e,r,n,o){this.outputChannelProvider=e;this.configurationService=n;this.notebookLoggingService=o;this.requestCount=-1;this.logger=r.getPromptResponseLogger("chat")}logRequest(e){this.requestCount++,this.logInfo("REQUEST",`User:${this.headerSeparator()}${this.printMessageContent(e.message)}`)}logMessages(e){this.logInfo("PROMPT MESSAGES",e.map(r=>`${this.getDisplayName(r)}:${this.headerSeparator()}${this.printMessageContent(r.content)}`).join(`
`)),this.notebookLoggingService.logMessages(e)}logProgress(e,r){if(e instanceof Pi){let n=typeof e.value=="string"?e.value:e.value.value;n&&(r?this.logInfo("RESPONSE",`Assistant:	${n}`,!1):this.logInfo("",`${n.replaceAll(/\r?\n/g,`
`+this.bodySeparator())}`,!1))}this.notebookLoggingService.logProgress(e)}logResponse(e){this.logInfo("",""),e.errorDetails&&this.logInfo("ERROR DETAILS",JSON.stringify(e.errorDetails,void 0,4)),this.notebookLoggingService.logResult(e)}logFollowups(e){this.logInfo("FOLLOWUPS","Followups:	"+e.map((r,n)=>`${r.label??r.prompt}
${this.bodySeparator()}`).join(`
${this.bodySeparator()}`))}logThrownError(e){this.logInfo("THROWN ERROR",e.stack?e.stack:e.message)}logIntent(e,r){this.logInfo("INTENT",e!==void 0?`User intent determined to be '${e}' via the ${r?"user":"model"}`:"Intent could not be determined")}logInfo(e,r,n=!0){if(!this.configurationService.getConfig(ge.ConversationLoggingEnabled))return;let o=new Date().toISOString();e&&(r=`[${e} ${this.requestCount}]
${r}`,r=`${o} [info] ${r}`),Dc.outputChannel===void 0&&(Dc.outputChannel=this.outputChannelProvider()),n?(this.logger.info(r+`
`),Dc.outputChannel.appendLine(r+`
`)):(this.logger.info(r),Dc.outputChannel.append(r))}printMessageContent(e){return e.split(`
`).join(`
${this.bodySeparator()}`)}headerSeparator(){return"		"}bodySeparator(){return"			"}getDisplayName(e){let r=this.getDisplayRole(e.role),n=e.name;return n?`${r} (${n})`:r}getDisplayRole(e){switch(e){case"system":return"System";case"user":return"User";case"assistant":return"Assistant";case"function":return"Function"}}};Dc=B([T(1,ce),T(2,be),T(3,qm)],Dc);var Al=W(Tr());function rEe(t){let e=(o,s,a)=>{let c="",u=a?"\u2514\u2500\u2500 ":"\u251C\u2500\u2500 ";if(s===1?c=`${u}${o.name}
`:s>1&&(c=`|   ${"    ".repeat(s-2)}${u}${o.name}
`),o.children){let l=o.children.length-1;o.children.forEach((d,p)=>{c+=e(d,s+1,p===l)})}return c},r=`${t.baseUri.path.replace("/","")}
`,n=t.value.length-1;return t.value.forEach((o,s)=>{r+=e(o,1,s===n)}),`\`\`\`filetree
${r}\`\`\`
`}var nEe=W(ct());var tM=class extends Y{render(e,r){return vscpp(vscppf,null,vscpp(nEe.SystemMessage,{priority:1e3},"You are an AI pair programmer helping a developer to clarify their prompt for another AI code assistant, integrated into Visual Studio Code. You are not answering the developer's prompts, but collaborate with them to better understand their intent, context and goal. Stay focussed, succinct and to the point.",vscpp("br",null),vscpp("br",null),vscpp($r,null),vscpp(ir,null),vscpp("br",null),vscpp(up,{location:2,endpoint:this.props.endpoint}),vscpp("br",null),"## First, think step-by-step:",vscpp("br",null),"1. Analyze the prompt and the optionally provided active code selection for what the developer might be asking. Keep your capabilities in mind.",vscpp("br",null),"2. As first part of your response, rephrase the prompt back to the developer with any explicit and implicit assumptions, included and missing context, and your capabilities. Paragraph with with maximum 50 words.",vscpp("br",null),"3. Finally, last paragraph with maximum 50 words: Request specifics about the missing context of their prompt. Include constructive feedback for how to add context (add specifics, using the knowledge base excerpt below).",vscpp("br",null),vscpp("br",null),"## Knowledge base: How to add context",vscpp("br",null),"- Selecting code will explicitly include it as context.",vscpp("br",null),"- Use the attachement button in the chat input to add specific files.",vscpp("br",null),"- Start the prompt with `@workspace` to refer to the entire codebase.",vscpp("br",null),"- Use commands for specific tasks, like `/fix` for debugging and fixing code issues, `/explain` to explain code, and `/tests` for writing tests.",vscpp("br",null),"- Mention context variables to the prompt: `#terminalLastCommand` for terminal output.",vscpp("br",null),vscpp("br",null),"## Rules",vscpp("br",null),"- Minimize any other prose.",vscpp("br",null),vscpp("br",null),"Take a deep breath. Do each step one by one.",vscpp(lr,null)),vscpp(Wr,{document:this.props.documentContext?.document,range:this.props.documentContext?.selection,priority:800}),vscpp(ti,{priority:900,chatVariables:[],query:this.props.query}))}};var rM=class extends Yo{constructor(r,n,o,s,a){super(n,o,s);this.accessor=r;this.documentContext=a}async followUps(r){let n=[],o="is my context";if(r.chatMessages){let s=r.chatMessages.filter(a=>a.role==="user");s.length>0&&(o=s[s.length-1].content)}return n.push({prompt:`@workspace ${o}`,label:"Find related @workspace code"}),n.push({prompt:`#selected ${o}`,label:"Use my #selected code"}),Promise.resolve(n)}createRenderer(r,n,o,s,a,c){let l=r.getLatestTurn().request.message;return new Xe(n,tM,{documentContext:this.documentContext,endpoint:n,chatVariables:o,query:l},this.accessor.get(ve).acquireTokenizer(n.family),this.accessor)}};var nM=class t{constructor(){this.id=t.ID;this.locations=[2];this.description="Clarify unclear prompt for the user.";this.commandInfo={hiddenFromUser:!0};this.intentDetectionInput={sampleQuestion:"How can I ask this question better?"}}static{this.ID="clarify"}async invoke(e,r){let{location:n,documentContext:o}=r,s=await e.get(Le).getChatEndpoint("gpt-4");return new rM(e,this,n,s,o)}};var oM=W(ct());var iM=class extends Y{render(){return vscpp(vscppf,null,vscpp(oM.SystemMessage,{priority:1e3},vscpp("br",null),"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with \\"GitHub Copilot\\".',vscpp("br",null),"Follow the user's requirements carefully & to the letter.",vscpp("br",null),"Your expertise is strictly limited to software development topics.",vscpp("br",null),"Follow Microsoft content policies.",vscpp("br",null),"Avoid content that violates copyrights.",vscpp("br",null),"For questions not related to software development, simply give a reminder that you are an AI programming assistant.",vscpp("br",null),"Keep your answers short and impersonal.",vscpp("br",null),vscpp("br",null),vscpp("br",null),vscpp(up,{location:this.props.location,endpoint:this.props.endpoint}),vscpp("br",null),"First think step-by-step - describe your plan for what to build in pseudocode, written out in great detail.",vscpp("br",null),"Then output the code in a single code block.",vscpp("br",null),"Minimize any other prose.",vscpp("br",null),"Use Markdown formatting in your answers.",vscpp("br",null),"Make sure to include the programming language name at the start of the Markdown code blocks.",vscpp("br",null),"Avoid wrapping the whole response in triple backticks.",vscpp("br",null),"The user works in an IDE called Visual Studio Code which has a concept for editors with open files, integrated unit test support, an output pane that shows the output of running the code as well as an integrated terminal.",vscpp("br",null),"The active document is the source code the user is looking at right now.",vscpp("br",null),"You can only give one reply for each conversation turn."),vscpp(qt,{priority:800,history:this.props.history}),vscpp(oM.UserMessage,{priority:900},"Write a short one-sentence question that the user can ask that naturally follows from the previous few questions and answers. It should not ask a question which is already answered in the conversation. It should be a question that you are capable of answering. Reply with only the text of the question and nothing else.",vscpp("br",null),vscpp(lr,null)))}};var hC=class{constructor(e,r,n,o,s,a){this.options=e;this.endpointProvider=n;this.chatMLFetcher=o;this.tokenizerProvider=s;this.accessor=a;this.logger=r.getLogger("ConversationFollowUp")}async followUp(e,r,n,o){let s=o?{...o}:{};s.requestId=Br(),s.messageSource="chat.followup";let a=await this.endpointProvider.getChatEndpoint("gpt-3.5-turbo"),{messages:c}=await _s(this.accessor,a,iM,{history:e.copy().turns,endpoint:a,location:r},this.tokenizerProvider.acquireTokenizer(a.family)),u=await this.chatMLFetcher.fetchOne(c,void 0,n,r,a,void 0,{temperature:this.options.temperature,top_p:this.options.topP},s);if(u.type==="success"){let l=[];return u.value&&l.push(u.value.trim()),l}else return this.logger.error(`Failed to fetch followups because of response type (${u.type}) and reason (${u.reason})`,u),[]}};hC=B([T(0,$n),T(1,ce),T(2,Le),T(3,jt),T(4,ve),T(5,rt)],hC);var w2;(e=>{function t(r,n){let{options:o,document:s,selection:a,visibleRanges:c}=r,u={insertSpaces:o.insertSpaces,tabSize:o.tabSize},l=As(s);return n||(c.length===1?n=c[0]:c.length>1?n=c[0].union(c[c.length-1]):n=a),{document:s,fileIndentInfo:u,language:l,selection:a,wholeRange:n}}e.fromEditor=t})(w2||={});var R2=W(ct());var sM=class{constructor(e){this.accessor=e;this.logger=e.get(ce).getPromptResponseLogger("prompt review"),this.telemetryService=e.get(me),this.options=e.get($n)}async evaluate(e,r,n,o){let s=await this.accessor.get(Le).getChatEndpoint("gpt-3.5-turbo"),a=new Xe(s,$X,{userQuestion:r,documentContext:e},this.accessor.get(ve).acquireTokenizer(s.family),this.accessor),{messages:c}=await a.render(void 0,o);this.logger.logPrompt(c);let u=await this.accessor.get(jt).fetchMany(c,void 0,o,2,s,{agent:n},{temperature:this.options.temperature,top_p:this.options.topP,stop:["\n```"],n:2},{messageSource:"chat.promptEval.meta"}),l=this.handleResult(u,r);return this.telemetryService.sendMSFTTelemetryEvent("promptEval",{},{requestContext:l?.requestContext,requirementsClarification:l?.requirementsClarification,taskDecomposition:l?.taskDecomposition}),this.telemetryService.sendInternalMSFTTelemetryEvent("promptEval",{request:r,response:u.type==="success"?u.value.join(`
`):void 0},{requestContext:l?.requestContext,requirementsClarification:l?.requirementsClarification,taskDecomposition:l?.taskDecomposition}),l}handleResult(e,r){if(this.logger.logResponse(e),e.type!=="success")return;let n=e.value.map(s=>{let a={requestContext:/requestContext:\s*(\d+)\s*/,requirementsClarification:/requirementsClarification:\s*(\d+)\s*/,taskDecomposition:/taskDecomposition:\s*(\d+)\s*/},c={requestContext:void 0,requirementsClarification:void 0,taskDecomposition:void 0};for(let u in c){let l=a[u].exec(s);l&&l.length===2&&(c[u]=parseInt(l[1],10)||void 0)}return c}).filter(s=>s!==void 0),o={requestContext:void 0,requirementsClarification:void 0,taskDecomposition:void 0};for(let s in o){let a=n.map(c=>c[s]||void 0).filter(c=>c!==void 0);this.logger.info(`Evaluated ${s} as ${a}`),o[s]=a.reduce((c,u)=>c+u,0)/a.length}return o}},$X=class extends Y{render(){let{userQuestion:e,documentContext:r}=this.props;return vscpp(vscppf,null,vscpp(R2.SystemMessage,{priority:1e3},"You are a helpful developer support expert in reviewing the prompts that a developer is sending to an AI coding assistant. Your ratings will be used to follow up with the developer on clarifying their prompt. For context, the developer queries this AI coding assistant inside Visual Studio Code for general questions, coding, debugging, and other software development tasks. The AI coding assistant will not get any more details when it needs to generate a response to the prompt. The AI coding assistant has the same software development knowledge that you have access to, which might be affected by knowledge cutoffs and niche domains.",vscpp("br",null),vscpp("br",null),"Rate how important different follow-ups are to clarify the given prompt, enabling the AI pair programmer to give more precise and useful responses. Rate each 1 (LEAST important) to 5 (MOST important):",vscpp("br",null),vscpp("br",null),"- **Request Context**: If the prompt references code, symbols, data, files, terminal output, or other parts of the development environment that are not in the prompt, follow-up would ask to attach those references to the prompt. Less critical for general coding questions, but most critical when the prompt references context that is missing.",vscpp("br",null),"- **Requirements Clarification**: If the prompt is too vague or general, follow-up questions help narrow down the specific information, preferences, and constraints. Less critical for general coding questions, more critical when the prompt involves specific coding requirements.",vscpp("br",null),"- **Task Decomposition**: If the prompt involves a complex task, follow-up breaks it down into smaller, more manageable steps so the developer can provide feedback and work through them one by one. Doesn't apply to general questions but is most important for multi-step coding tasks.",vscpp("br",null),vscpp("br",null),"Summarize your rating with a markdown codeblock:",vscpp("br",null),vscpp(Oe,{uri:null,languageId:"markdown",code:`- requestContext: int
- requirementsClarification: int
- taskDecomposition: int`}),vscpp("br",null),vscpp("br",null),"You will be provided with the prompt and context, then asked to rate the follow-up."),vscpp(R2.UserMessage,{priority:900},"# Developer Prompt",vscpp("br",null),e),r&&vscpp(Wr,{document:r?.document,range:r?.selection}),vscpp(R2.UserMessage,{priority:1e3},"Rating:",vscpp("br",null),"```md",vscpp("br",null)))}};var gC=class{constructor(e,r){this.stopStartMappings=e;this.processNonReportedDelta=r;this.stagedDeltasToApply=[];this.currentStartStop=void 0;this._appliedText="";this.nonReportedDeltas=[]}async processResponse(e,r,n,o,s){return this.doProcessResponse(n,o,s)}async doProcessResponse(e,r,n){for await(let{delta:o}of e){if(n.isCancellationRequested)break;this.applyDelta(o,r)}return this._appliedText}applyDeltaToProgress(e,r){let n=e.codeVulnAnnotations?.map(o=>({title:o.details.type,description:o.details.description}));n?.length?r.markdownWithVulnerabilities(e.text??"",n):e.text&&r.markdown(e.text)}updateStagedDeltasUpToIndex(e,r){let n=[];for(let o=0;o<e+r;){let s=this.stagedDeltasToApply.shift();if(s){if(o+s.text.length<=e)n.push(s);else if(o<e||o<e+r){if(o<e){let c={...s};c.text=s.text.substring(0,e-o),n.push(c)}let a={...s};a.text=s.text.substring(e-o+r),a.text&&this.stagedDeltasToApply.unshift(a)}o+=s.text.length}else break}return n}checkForKeyWords(e,r,n){let o=this.stagedDeltasToApply.map(s=>s.text).join("")+r.text;for(let s of e){let a=o.indexOf(s);if(a===-1)continue;return this.stagedDeltasToApply.push(r),this.updateStagedDeltasUpToIndex(a,s.length).forEach(u=>n(u)),s}for(let s of e)for(let a=s.length-1;a>0;a--){let c=s.substring(0,a);if(o.endsWith(c)){this.stagedDeltasToApply=[...this.stagedDeltasToApply,r];return}}[...this.stagedDeltasToApply,r].forEach(s=>{n(s)}),this.stagedDeltasToApply=[]}postReportRecordProgress(e){this.nonReportedDeltas.push(e)}applyDelta(e,r){if(this._appliedText+=e.text,this.currentStartStop===void 0){let n=this.checkForKeyWords(this.stopStartMappings.map(o=>o.stop),e,o=>this.applyDeltaToProgress(o,r));n&&(this.currentStartStop=this.stopStartMappings.find(o=>o.stop===n));return}else{if(!this.currentStartStop.start)return;this.checkForKeyWords([this.currentStartStop.start],e,this.postReportRecordProgress.bind(this))&&(this.processNonReportedDelta&&this.processNonReportedDelta(this.nonReportedDeltas).forEach(s=>this.applyDeltaToProgress({text:s},r)),this.currentStartStop=void 0,this.stagedDeltasToApply.length>0&&this.applyDelta({text:""},r))}}};var vC={errorDetails:{message:Al.t("Cancelled")}},aM=class{constructor(e,r,n){this.options=r;this.conversationLogger=n;this.inputPlaceholder=Al.t("Ask Copilot or type / for commands");this._telemetryService=e.get(me),this._configurationService=e.get(be),this._experimentationService=e.get(Lt),this._commandService=e.get(Sv),this._notebookLoggingService=e.get(qm),this._intentService=e.get(nc),this.accessor=e,this.conversation=new Pc,this.intentDetector=new mC(e,2),this.promptEval=new sM(e),this.conversation=this.initializeConversation(),this._conversationStore=e.get(ov)}addHistory(e){let r;for(let n of e)if(n instanceof Zre)r=new sp({message:n.prompt,type:"user"});else{let o=n.response.map(a=>a instanceof Pi?a.value.value:a instanceof Gm?rEe(a):"content"in a?a.content:null).filter(a=>!!a).join("");if(r){let a=n.command||dne(n.participant),c=this._commandService.getCommand(a,2);r.response={message:o,type:"model",name:c?.commandId||Rl.ID},n.result.errorDetails?n.result.errorDetails?.responseIsFiltered?r.status="filtered":n.result.errorDetails.message==="Cancelled"?r.status="cancelled":r.status="error":r.status="success",this.conversation.addTurn(r),r=void 0}let s=n.result;typeof s.metadata?.sessionId=="string"&&(this._sessionId=s.metadata.sessionId)}this._sessionId||(this._sessionId=Br())}initializeConversation(){return new Pc}async provideResponseWithProgress(e,r,n,o){try{let s=this,a=!0,c=m=>{s.conversationLogger?.logProgress(m,a),a=!1},u=new class{detectedParticipant(m,h){c(new bE(m,h)),r.detectedParticipant(m,h)}markdown(m){c(new Pi(m)),r.markdown(m)}button(m){c(new h0(m)),r.button(m)}filetree(m,h){c(new Gm(m,h)),r.filetree(m,h)}anchor(m,h){c(new wP(m,h)),r.anchor(m,h)}progress(m){c(new Wi(m)),r.progress(m)}reference(m){c(new k_(m)),r.reference(m)}warning(m){c(new RP(m)),r.warning(m)}push(m){c(m),r.push(m)}markdownWithVulnerabilities(m,h){c(new kP(m,h)),r.markdownWithVulnerabilities(m,h)}textEdit(m,h){c(new Mp(m,h)),r.textEdit(m,h)}confirmation(m,h,g){c(new AP(m,h,g)),r.confirmation(m,h,g)}},l=this.newTurn(e),d=fC();d.markAsDisplayed(),l.userMessageId=d.properties.messageId;let p=await this._provideResponseWithProgress(l,e,u,n,d,o),f=await l.intentInvocation?.commands?.(l);return f&&f.forEach(m=>r.button(m)),this.conversationLogger?.logResponse(p),this._telemetryService.sendInternalMSFTTelemetryEvent("interactiveSessionResponse",{chatLocation:"panel",intent:l.intentInvocation?.intent.id??"",request:e.prompt,response:l.response?.message??"",sessionId:this._sessionId},{turnNumber:this.conversation.turns.length}),this._conversationStore.addConversation(l.requestId,this.conversation),{...p,metadata:{modelMessageId:l.modelMessageId??"",responseId:l.requestId,sessionId:this._sessionId,agentId:o.agentId,command:e.command}}}catch(s){throw this.conversationLogger?.logThrownError(s),s}}newTurn(e){let r={message:e.prompt,type:"user"},n=new sp(r,this._sessionId);return this.conversation.addTurn(n),n}async _provideResponseWithProgress(e,r,n,o,s,a){let c=()=>{if(o.isCancellationRequested)return e.status="cancelled",!0};if(c())return vC;try{let u=this.accessor.get(Tt).activeTextEditor,l=e.request.message;this.conversationLogger?.logRequest(e.request);let d={command:a.intentId?this._commandService.getCommand(a.intentId,2):void 0,restOfQuery:l};if(d.command?.intent&&!(d.command.intent.commandInfo?.allowsEmptyArgs??!0)&&!d.restOfQuery){let O=uTe(d.command.intent.id),U="";return O&&(U=`@${O.agent} `,O.command&&(U+=` /${O.command}`),U+=` ${d.command.details}`),e.response={message:Al.t(`Please specify a question when using this command.

Usage: {0}`,U),type:"meta"},e.status="error",{errorDetails:{message:e.response.message,responseIsFiltered:!1}}}let p=d?.command?.intent,f;p&&(e.request={message:d.restOfQuery||p.intentDetectionInput.sampleQuestion,type:"user"},this.conversationLogger?.logIntent(p.id,!0));let m=u?w2.fromEditor(u):void 0;if(!p&&!r.command&&!r.references.length&&this.conversation.turns.length===1&&await this._configurationService.getExperimentBasedConfig(ge.ConversationPromptEval,this._experimentationService)){let U=this.promptEval.evaluate(m,l,a.agentName,o),z={requestContext:await this._configurationService.getExperimentBasedConfig(ge.ConversationPromptEvalRequestContext,this._experimentationService)};if(z.requestContext!==void 0){let M=await U;if(c())return vC;M?.requestContext&&M.requestContext>=z.requestContext&&(p=this._intentService.getIntent(nM.ID,2))}}if(!p&&r.enableCommandDetection&&this.accessor.get(be).getConfig(ge.ConversationIntentDetection)){if(p=f=await this.intentDetector.detectIntent(void 0,l,a.agentName,o,s,void 0,void 0),this.conversationLogger?.logIntent(p?.id,!1),c())return vC;f&&n.push(new bE("github.copilot.default",{name:f.id,description:f.description}))}p??=this._intentService.unknowIntent;let h=await p.invoke(this.accessor,{location:2,documentContext:m,request:r});if(c())return vC;e.intentInvocation=h,r=await this.sanitizeVariables(r,e);let g=h.endpoint;if(this._notebookLoggingService.logRequest(r,g),(r.acceptedConfirmationData?.length||r.rejectedConfirmationData?.length)&&h.confirmationHandler)return await h.confirmationHandler(r.acceptedConfirmationData,r.rejectedConfirmationData,n),{};let v,y,_=!1,b;try{let O={report(z){n.push(z)}},U=r.references??r.variables;({messages:v,tokenCount:y,hasIgnoredFiles:_,references:b}=await h.buildPrompt(this.conversation,U,O,s,o));for(let z of b)n.reference(z.anchor);e.addReferences(b)}catch(O){if(kp(O))return vC;throw O}if(c())return vC;if(v.length===0)return{};let S=this.conversation.getLatestTurn()?.contextParts.map(O=>O.kind)??[];if(this._telemetryService.sendInternalMSFTTelemetryEvent("interactiveSessionMessage",{intent:p?.id??"none",detectedIntent:f?.id??"none",contextTypes:S.join(","),query:d.restOfQuery},{}),e.chatMessages=v,this.fixMessageNames(p,v),this.conversationLogger?.logMessages(v),s=Y8(this.conversation,this._sessionId,"conversationPanel",l,y,p?.id,s),o.isCancellationRequested)return e.status="cancelled",{errorDetails:{message:Al.t("Cancelled")}};let I=h?.responseProcessor??new gC([{stop:"[COMMANDS START]"}]),w=await this.fetchConversationResponse(e,g,l,v,a.agentName,o,n,I,h.linkification,s,{messageId:s.properties.messageId,messageSource:p?.id&&p.id!==Rl.ID?`chat.${p.id}`:"chat.user"});return _&&n.markdown(Al.t(pD)),w}catch(u){this.accessor.get(ce).defaultLogger.exception(u),this.accessor.get(me).sendGHTelemetryException(u,"Error"),this.conversationLogger?.logThrownError(u);let l=u.message;return e.status="error",e.response={message:l,type:"meta"},{errorDetails:{message:l}}}}async sanitizeVariables(e,r){let n=e.references.map(async s=>{let a=!1;return s.value instanceof pn&&(a=await this.accessor.get(De).isCopilotIgnored(s.value)),a&&s.range&&(r.request.message=r.request.message.slice(0,s.range[0])+r.request.message.slice(s.range[1])),a?null:s}),o=Kt(await Promise.all(n));return{...e,references:o}}fixMessageNames(e,r){let n=this._configurationService.getConfig(ge.UseMessageNames);r.forEach(o=>{n?o.role!=="system"&&o.name===e?.id&&(o.name=void 0):o.name=void 0})}async fetchConversationResponse(e,r,n,o,s,a,c,u,l,d,p){let f=fC();e.requestId=d.properties.messageId,e.modelMessageId=f.properties.messageId;let m=Date.now(),h=0,g=new U_,v=l?.disable?c:new Mb(this.accessor,e.references,c,l?.additionaLinkifiers??[],a),y=u.processResponse(e,o,g.stream,v,a),_=!1;y.finally(()=>{_=!0});let b=await this.accessor.get(jt).fetchOne(o,async(re,ee,N)=>(h===0&&(h=Date.now()),g.update(re,N),_?re.length:void 0),a,2,r,{agent:s},{temperature:this.options.temperature,top_p:this.options.topP},p,{intent:!0});g.resolve();let S=await y;v instanceof Mb&&await v.finalize();let I=S?GX(S):[],w=S?S.match(/\]\(command:_github\.copilot\.open/g):[],O=d.raw.displayedTime??m,U=["programming-related tasks","programming related questions","software development topics","related to programming","expertise is limited","sorry, i can't assist with that"],z=0;b.type==="success"&&!S.trim().includes(`
`)&&U.some(re=>S.toLowerCase().includes(re))&&(z=1);let M=this.accessor.get(ve).acquireTokenizer(r.family);switch(this._telemetryService.sendMSFTTelemetryEvent("panel.request",{command:e.intentInvocation?.intent.id??"none",contextTypes:e.contextParts.map(re=>re.kind).join(",")??"none",promptTypes:o.map(re=>`${re.role}${re.name?`-${re.name}`:""}:${re.content.length}`).join(","),conversationId:this._sessionId,requestId:e.requestId,responseId:b.requestId,responseType:b.type,codeBlocks:I.join(","),model:r.model},{turn:this.conversation.turns.length,textBlocks:I.length?-1:S.split(/\n{2,}/).length??0,links:w?.length??0,maybeOffTopic:z,messageTokenCount:M.tokenLength(e.request.message),promptTokenCount:dC(this.accessor.get(ve).acquireTokenizer(r.family),o),userPromptCount:o.filter(re=>re.role==="user").length,responseTokenCount:M.tokenLength(S)??0,timeToRequest:m-O,timeToFirstToken:h?h-O:-1,timeToComplete:Date.now()-O}),Q8(this.accessor.get(me),"conversationPanel",b.requestId,n,b.type==="offTopic",this.accessor.get(Tt).activeTextEditor?.document,d),b.type){case"success":return await this.processSuccessfulFetchResult(e,S,b.requestId,f);case"offTopic":return this.processOffTopicFetchResult(c,e,n,d);case"canceled":return e.status="cancelled",e.response={message:"Cancelled",type:"user"},{errorDetails:e.response};case"rateLimited":return e.status="error",{errorDetails:{message:Al.t("Sorry, your request was rate-limited. Please wait and try sending again later."),responseIsFiltered:!0}};case"badRequest":case"failed":return e.status="error",e.response={message:b.reason,type:"server"},{errorDetails:e.response};case"filtered":return e.status="filtered",{errorDetails:{message:m8(b.category),responseIsFiltered:!0}};case"agent_unauthorized":return e.status="error",{};case"agent_failed_dependency":return e.status="error",{errorDetails:{message:b.reason}};case"length":return e.status="error",{errorDetails:{message:Al.t("Sorry, the response hit the length limit. Please rephrase your prompt.")}};case"unknown":return e.status="error",{errorDetails:{message:Al.t("Sorry, no response was returned."),responseIsFiltered:!1}};case"extensionBlocked":return e.status="error",{errorDetails:{message:Al.t("Sorry, something went wrong."),responseIsFiltered:!1}}}}async processSuccessfulFetchResult(e,r,n,o){return r.length>0?(e.status="success",e.response={message:r,type:"model"},o.markAsDisplayed(),X8(this.accessor.get(me),this.conversation,this._sessionId,"conversationPanel",r,n,this.accessor.get(Tt).activeTextEditor?.document,o),{}):(e.status="error",e.response={message:Al.t("The model unexpectedly did not return a response, which may indicate a service issue. Please report a bug."),type:"meta"},{errorDetails:e.response})}processOffTopicFetchResult(e,r,n,o){let s=fC();return e.markdown(this.options.rejectionMessage),r.response={message:this.options.rejectionMessage,type:"offtopic-detection"},r.status="off-topic",s.markAsDisplayed(),J8(this.accessor.get(me),this.conversation,this._sessionId,"conversationPanel",n,o.properties.messageId,this.accessor.get(Tt).activeTextEditor?.document,s),{}}getLatestTurn(){return this.conversation.getLatestTurn()}removeRequest(e){let r=this.conversation.removeTurn(e);this._telemetryService.sendMSFTTelemetryEvent("panel.action.remove",{command:r?.intentInvocation?.intent.id,contextTypes:r?.contextParts.map(n=>n.kind).join(",")??"none",responseType:r?.response?.type,conversationId:this._sessionId,requestId:e})}};async function iEe(t,e,r,n){let o=e.getLatestTurn();if(!o)return[];let s={messageId:o.requestId},u=(o.status==="success"?await t.get(or).createInstance(hC).followUp(e,2,n,s):[]).map(f=>MJe(f,t,s));n.isCancellationRequested||r?.logFollowups(u);let l=o,d=[],p=l?.intentInvocation;return p?.followUps&&(d=await p.followUps(l)),d.concat(u)}function MJe(t,e,r){let n=r??{};return n.suggestionId=Br(),n.suggestionType="Follow-up from model",Z8(e,n.suggestionType,n.messageId,n.suggestionId,e.get(Tt).activeTextEditor?.document),{prompt:t,metadata:n}}var wv=W(require("vscode"));function oEe(t,e,r){let n=wv.window.activeTextEditor?.document,o=wv.window.activeTextEditor?.selection,s=e.result,a=t.get(me),c=s.metadata?.responseId&&t.get(ov).getConversation(s.metadata.responseId);switch(e.action.kind){case"copy":a.sendMSFTTelemetryEvent("panel.action.copy",{languageId:n?.languageId,requestId:s.metadata?.responseId,participant:r,command:s.metadata?.command},{codeBlockIndex:e.action.codeBlockIndex,copyType:e.action.copyKind,characterCount:e.action.copiedCharacters,lineCount:e.action.copiedText.split(`
`).length});break;case"insert":a.sendMSFTTelemetryEvent("panel.action.insert",{languageId:n?.languageId,requestId:s.metadata?.responseId,participant:r,command:s.metadata?.command},{codeBlockIndex:e.action.codeBlockIndex,characterCount:e.action.totalCharacters});break;case"runInTerminal":a.sendMSFTTelemetryEvent("panel.action.runinterminal",{languageId:n?.languageId,requestId:s.metadata?.responseId,blockLanguage:e.action.languageId,participant:r,command:s.metadata?.command},{codeBlockIndex:e.action.codeBlockIndex});break;case"followUp":a.sendMSFTTelemetryEvent("panel.action.followup",{languageId:n?.languageId,responseId:s.metadata?.responseId,participant:r,command:s.metadata?.command});break;case"bug":c&&t.get(pC)?.reportChat(c.getLatestTurn());break}if(e.action.kind==="copy"||e.action.kind==="insert"){let u={};u={totalCharacters:e.action.totalCharacters},e.action.kind==="copy"&&(u={...u,copiedCharacters:e.action.copiedCharacters}),n&&o&&(u={...u,cursorLocation:n.offsetAt(o.active)}),cm(t.get(me),wv.window.activeTextEditor?.document,{codeBlockIndex:e.action.codeBlockIndex.toString(),messageId:s.metadata?.modelMessageId??"",headerRequestId:s.metadata?.responseId??""},u,e.action.kind==="copy"?"conversation.acceptedCopy":"conversation.acceptedInsert")}}function cM(t,e,r){let n=wv.window.activeTextEditor?.document,o=e.result;t.sendMSFTTelemetryEvent("panel.action.vote",{languageId:n?.languageId,requestId:o.metadata?.responseId,participant:r,command:o.metadata?.command},{direction:e.kind===wv.ChatResultFeedbackKind.Helpful?1:2}),cm(t,n,{rating:e.kind===wv.ChatResultFeedbackKind.Helpful?"positive":"negative",messageId:o.metadata?.modelMessageId??"",headerRequestId:o.metadata?.responseId??""},{},"conversation.messageRating")}var ko=W(require("vscode"));function uM(){return"https://aka.ms/microsoft/vscode-copilot-release"}var yC=class{constructor(e,r){this.configurationService=e;this.accessor=r;this.hasShownWelcomeMessage=!1}async provideWelcomeMessage(e,r){let n=await Fp(this.configurationService,{silent:!0}),o=(await this.accessor.get(fn).getCopilotToken()).isInternal,s=n?.account?.label,a=uM(),c=this.configurationService.getConfig(ge.WelcomeMessage),u="workbench.action.openSettings",l=new ko.MarkdownString(ko.l10n.t("{0} has identified you as an internal user. Internal users have additional telemetry collected for product improvement purposes. If you work on a project that contains customer content, it is required you disable this telemetry as it does contain PII. [Disable Telemetry]({1}).",["Copilot",`command:${u}?%5B%22telemetry.telemetryLevel%22%5D`]));l.isTrusted={enabledCommands:[u]};let d=ko.l10n.t({message:"I'm powered by AI, so surprises and mistakes are possible. Make sure to verify any generated code or suggestions, and [share feedback]({0}) so that we can learn and improve. Check out the [{1} documentation]({2}) to learn more.",args:[a,"Copilot","https://code.visualstudio.com/docs/copilot/getting-started-chat"],comment:["{Locked=']({'}","the [text](url) is a markdown link syntax. Do not add any additional spaces between ] and ("]}),p=s?" **@"+s+"**":"";if(c==="never"||this.hasShownWelcomeMessage&&c==="first")return[ko.l10n.t("Hi{0}, how can I help you?",p)];this.hasShownWelcomeMessage=!0;let f="workbench.action.quickchat.launchInlineChat",m=ko.window.activeNotebookEditor||ko.window.activeTextEditor?ko.l10n.t("You can also [start an inline chat session]({0}).",`command:${f}`):"",h=new ko.MarkdownString(ko.l10n.t("Welcome,{0}, I'm your {1} and I'm here to help you get things done faster. {2}",p,"Copilot",m));h.isTrusted={enabledCommands:[f]};let g=[h,d];return o&&g.push(l),g}provideSampleQuestions(e,r){let n=ko.window.activeNotebookEditor||ko.window.activeTextEditor?FJe():sEe([["","help",ko.l10n.t("What can you do?")]]);return UJe([...n],this.accessor,"welcome"),n}};yC=B([T(0,be),T(1,rt)],yC);function FJe(){let t=F_("workspace");return sEe([[t,"fix",ko.l10n.t("the problems in my code")],[t,"tests",ko.l10n.t("add unit tests for my code")],[t,"explain",ko.l10n.t("how the selected code works")]])}function sEe(t){return t.map(([e,r,n])=>({prompt:"",participant:e,command:r,label:`/${r} ${n}`}))}function UJe(t,e,r){t.map(n=>{Z8(e,`@${n.participant} /${n.command} ${n.prompt}`,r,"",ko.window.activeTextEditor?.document)})}var bC=class{constructor(e){this.instantiationService=e}register(){let e=this.instantiationService.createInstance(Nc);return e.register(),e}};bC=B([T(0,or)],bC);var Nc=class{constructor(e,r,n,o,s,a,c,u,l,d){this.options=e;this.extensionContext=r;this.configurationService=n;this.octoKitService=o;this.copilotTokenManager=s;this.telemetryService=a;this.languageDiagnosticsService=c;this.accessor=u;this.logService=l;this.instantiationService=d;this._disposables=new Nt;this._inlineChatSessions=new km(10,1);this._logger=d.createInstance(Dc,()=>{let p=It.window.createOutputChannel("GitHub Copilot Chat Conversation","log");return r.subscriptions.push(p),p})}dispose(){this._disposables.dispose()}register(){this._disposables.add(this.registerDefaultAgent()),this._disposables.add(this.registerEditorDefaultAgent()),this._disposables.add(this.registerNotebookDefaultAgent()),this._disposables.add(this.registerWorkspaceAgent()),this._disposables.add(this.registerVSCodeAgent()),this._disposables.add(this.registerTerminalAgent()),this._disposables.add(this.registerTerminalPanelAgent())}createAgent(e,r,n){n=n||F_(e);let o=It.chat.createChatParticipant(n,this.getChatParticipantHandler(n,e,r));return o.onDidReceiveFeedback(s=>{if(Nc.isInlineChatResult(s.result))return this.handleInlineChatUserAction(s.result,void 0,s);cM(this.telemetryService,s,n)}),o.onDidPerformAction(s=>{if(Nc.isInlineChatResult(s.result))return this.handleInlineChatUserAction(s.result,s,void 0);oEe(this.accessor,s,n)}),o.supportIssueReporting=this.accessor.get(be).getConfig(ge.DebugReportFeedback),o.followupProvider={provideFollowups:async(s,a,c)=>{let u=s.metadata?.responseId&&this.accessor.get(ov).getConversation(s.metadata.responseId);return u?await iEe(this.accessor,u,this._logger,c):[]}},o}registerWorkspaceAgent(){let e=this.createAgent(Up,"workspace");return e.iconPath=new It.ThemeIcon("code"),e.isSecondary=!0,e}registerVSCodeAgent(){let e=this.createAgent(RE,"vscode"),r=It.env.appName.includes("Insiders")||It.env.appName.includes("OSS");return e.iconPath=lt.joinPath(this.extensionContext.extensionUri,"assets",r?"vscode-chat-avatar-insiders.svg":"vscode-chat-avatar-stable.svg"),e.supportsSlowReferences=!0,e}registerTerminalAgent(){let e=this.createAgent(g0,"terminal");return e.iconPath=new It.ThemeIcon("terminal"),e.supportsSlowReferences=!0,e.followupProvider=void 0,e}registerTerminalPanelAgent(){let e=this.createAgent(g0,"terminal","github.copilot.terminalPanel");return e.iconPath=new It.ThemeIcon("terminal"),e.supportsSlowReferences=!0,e}async initDefaultAgentRequestorProps(e){let r=async()=>{let n=await Fp(this.configurationService,{silent:!0}),{avatar_url:o}=await this.octoKitService.getCurrentAuthedUser();if(n){let s=n?.account?.label;return e.requester={name:s,icon:lt.parse(o??`https://avatars.githubusercontent.com/${s}`)},!0}return!1};if(!await r()){let n=this.copilotTokenManager.onDidGitHubTokenChanged(async()=>{await r()&&n.dispose()})}}registerDefaultAgent(){let e=this.createAgent(uU,"unknown");e.iconPath=new It.ThemeIcon("copilot"),e.supportsSlowReferences=!0,this.initDefaultAgentRequestorProps(e);try{e.helpTextPrefix=It.l10n.t("You can ask me general programming questions, or chat with the following participants which have specialized expertise and can perform actions:");let r=It.l10n.t({message:`To have a great conversation, ask me questions as if I was a real programmer:

* **Show me the code** you want to talk about by having the files open and selecting the most important lines.
* **Make refinements** by asking me follow-up questions, adding clarifications, providing errors, etc.
* **Review my suggested code** and tell me about issues or improvements, so I can iterate on it.

You can also ask me questions about your editor selection by [starting an inline chat session](command:inlineChat.start).

Learn more about [GitHub Copilot](https://docs.github.com/copilot/using-github-copilot/getting-started-with-github-copilot?tool=vscode&utm_source=editor&utm_medium=chat-panel&utm_campaign=2024q3-em-MSFT-getstarted) in [Visual Studio Code](https://code.visualstudio.com/docs/copilot/overview).`,comment:"{Locked='](command:inlineChat.start)'}"}),n=new It.MarkdownString(r);n.isTrusted={enabledCommands:["inlineChat.start"]},e.helpTextPostfix=n,e.helpTextVariablesPrefix=It.l10n.t("You can also help me understand your question by using the following variables to give me extra context:")}catch{}return e.welcomeMessageProvider=this.accessor.get(or).createInstance(yC),e}registerEditorDefaultAgent(){let e=this.createAgent(wE,"unknown");return e.iconPath=new It.ThemeIcon("copilot"),e.welcomeMessageProvider={provideWelcomeMessage:()=>[],provideSampleQuestions:(r,n)=>{if(It.window.activeTextEditor){let{document:o,selection:s}=It.window.activeTextEditor,a=NU(this.languageDiagnosticsService.getDiagnostics(o.uri),s);if(a)return[{prompt:`/fix ${a.message}`}]}}},e}registerNotebookDefaultAgent(){let e=this.createAgent("notebook","unknown");return e.iconPath=new It.ThemeIcon("copilot"),e.welcomeMessageProvider={provideWelcomeMessage:()=>[],provideSampleQuestions:(r,n)=>{if(It.window.activeTextEditor){let{document:o,selection:s}=It.window.activeTextEditor,a=NU(this.languageDiagnosticsService.getDiagnostics(o.uri),s);if(a)return[{prompt:`/fix ${a.message}`}]}}},e}getChatParticipantHandler(e,r,n){return async(o,s,a,c)=>{if(o.location===It.ChatLocation.Editor)return this.handleInlineChatRequest(e,o,s,a,c);if(o.location===It.ChatLocation.Notebook)return this.handleNotebookChatRequest(e,o,s,a,c);let u=new aM(this.accessor,this.options,this._logger);u.addHistory(s.history);let l=vI[n],d=o.command&&l?l[o.command]:n;return await u.provideResponseWithProgress(o,a,c,{agentName:r,agentId:e,intentId:d})}}static{this.metadataKey="inlineChatSession"}static isInlineChatResult(e){return!!this.retrieveSessionId(e)}static retrieveSessionId(e){return e?.metadata?.[Nc.metadataKey]}static asChatResultWithSessionId(e){return{metadata:{[Nc.metadataKey]:e}}}async handleInlineChatRequest(e,r,n,o,s){this._inlineChatProvider??=this.instantiationService.createInstance(dp,e,this.options.rejectionMessage);let a=r.references,c=WX(a,f=>f.name==="_inlineChatContext")?.value,u=WX(a,f=>f.name==="_inlineChatDocument")?.value,l,d,p;if(typeof c=="string"){let f=JSON.parse(c);d=new It.Selection(f.selection.selectionStartLineNumber-1,f.selection.selectionStartColumn-1,f.selection.positionLineNumber-1,f.selection.positionColumn-1),p=new It.Range(f.wholeRange.startLineNumber-1,f.wholeRange.startColumn-1,f.wholeRange.endLineNumber-1,f.wholeRange.endColumn-1),l=It.workspace.textDocuments.find(m=>m.uri.toString()===lt.revive(f.uri).toString())}if(u instanceof It.Uri){let f=u;l=It.workspace.textDocuments.find(m=>m.uri.toString()===f.toString())}return!l||!d||!p?(this.logService.defaultLogger.warn("Inline chat request is missing context information",l,d,p),{}):this.handleCommonInlineChatRequest(e,n,o,l,d,p,r,s)}async handleCommonInlineChatRequest(e,r,n,o,s,a,c,u){this._inlineChatProvider??=this.instantiationService.createInstance(dp,e,this.options.rejectionMessage);let l;for(let g=r.history.length-1;g>=0;g--){let v=r.history[g];if(v instanceof It.ChatResponseTurn){l=v.result;break}}let d=Nc.retrieveSessionId(l)??Br(),p=this._inlineChatSessions.get(d);p||(p={session:await this._inlineChatProvider.prepareInteractiveEditorSession({document:o,selection:s}),responses:[]},this._inlineChatSessions.set(d,p));let f={...c,selection:s,wholeRange:a},m=new nm(g=>{if(g instanceof It.ChatResponseTextEditPart){let v=It.workspace.textDocuments.find(y=>y.uri.toString()===g.uri.toString());if(v){let y=g.edits.filter(_=>v.getText(_.range)!==_.newText);g=new It.ChatResponseTextEditPart(g.uri,y)}}n.push(g)}),h=await this._inlineChatProvider.provideInteractiveEditorResponse(p.session,f,m,u);if(!h)return{};if(p.responses.push(h),h.edits){let{edits:g}=h;if(g instanceof It.WorkspaceEdit)for(let[v,y]of g.entries())n.textEdit(v,y);else n.textEdit(p.session.document.uri,g)}return Nc.asChatResultWithSessionId(d)}async handleInlineChatUserAction(e,r,n){let o=Nc.retrieveSessionId(e);if(!o)return;let s=this._inlineChatSessions.get(o);if(!s||s.responses.length===0)return;let a;r?.action.kind==="editor"?a=r.action.accepted?3:2:r?.action.kind==="bug"?a=4:n?.kind===It.ChatResultFeedbackKind.Helpful?a=1:n?.kind===It.ChatResultFeedbackKind.Unhelpful&&(a=0),a!==void 0&&this._inlineChatProvider?.handleInteractiveEditorResponseFeedback(s.session,s.responses.at(-1),a)}async handleNotebookChatRequest(e,r,n,o,s){this._inlineChatProvider??=this.instantiationService.createInstance(dp,e,this.options.rejectionMessage);let a=WX(r.references,d=>d.name==="_notebookChatInput")?.value,c=new It.Selection(0,0,0,0),u=new It.Range(0,0,0,0),l;if(a instanceof It.Uri){let d=a;l=It.workspace.textDocuments.find(p=>p.uri.toString()===d.toString())}return l?this.handleCommonInlineChatRequest(e,n,o,l,c,u,r,s):this.handleInlineChatRequest(e,r,n,o,s)}};Nc=B([T(0,$n),T(1,zt),T(2,be),T(3,dD),T(4,Nn),T(5,me),T(6,ho),T(7,rt),T(8,ce),T(9,or)],Nc);function WX(t,e){let r=t.findIndex(e);if(r!==-1)return t.splice(r,1)[0]}var Fe=W(require("vscode"));var Xo=require("vscode");var Pl=W(require("vscode")),_C=class{async stat(e){return Pl.workspace.fs.stat(e)}async readDirectory(e){return Pl.workspace.fs.readDirectory(e)}async createDirectory(e){return Pl.workspace.fs.createDirectory(e)}async readFile(e){return Pl.workspace.fs.readFile(e)}async writeFile(e,r){return Pl.workspace.fs.writeFile(e,r)}async delete(e,r){return Pl.workspace.fs.delete(e,r)}async rename(e,r,n){return Pl.workspace.fs.rename(e,r,n)}async copy(e,r,n){return Pl.workspace.fs.copy(e,r,n)}isWritableFileSystem(e){return!!Pl.workspace.fs.isWritableFileSystem(e)}createFileSystemWatcher(e){return Pl.workspace.createFileSystemWatcher(e)}};function aEe(t){if(typeof t!="string")throw new TypeError("Argument must be a string.");if(!t)return t;let e=t.startsWith("!"),r=e?t.slice(1):t,n=r,o=!1;switch(r[0]==="/"&&(o=!0,n=r.slice(1)),n[0]){case"*":r[1]!=="*"&&(n="**/"+n);break;default:if((!o&&!n.includes("/")||n.endsWith("/"))&&(n="**/"+n),n.endsWith("*")||n.endsWith("?"))break;/\.[a-z\d_-]+$/.test(n)||(n.endsWith("/")||(n+="/"),n+="**")}return e?"!"+n:n}var bEe=W(vEe()),ya=require("path");var dM=class{constructor(){this._ignoreMap=new Map;this._ignoreCache=new Map;this._searchRankCache=null}setIgnoreFile(e,r,n){let o="";e&&(o=(0,ya.relative)(e.fsPath,(0,ya.dirname)(r.fsPath)),o.startsWith("..")&&(o="")),this._ignoreMap.set(r.fsPath,{ignore:(0,bEe.default)().add(n),patterns:oP(n).filter(s=>s.trim()&&!s.startsWith("#")).map(aEe).map(s=>o?ya.posix.join(o,s):s)}),this._searchRankCache=null,this._ignoreCache.clear()}removeIgnoreFile(e){this._ignoreMap.delete(e.fsPath),this._searchRankCache=null,this._ignoreCache.clear()}removeWorkspace(e){let r=0;for(let n of this._ignoreMap.keys())yEe(e.fsPath,n)&&(this._ignoreMap.delete(n),r+=1);r>0&&(this._searchRankCache=null,this._ignoreCache.clear())}asMinimatchPatterns(){return[...this._ignoreMap.values()].flatMap(e=>e.patterns)}isIgnored(e){if(this._ignoreMap.size===0)return!1;let r=e.fsPath;if(this._ignoreCache.has(r))return this._ignoreCache.get(r);let n=0,o={ignored:!1,unignored:!1};try{let s=this._searchRank;for(let a of s){n+=1;let c=(0,ya.dirname)(a),u=(0,ya.relative)(c,r);if(!u.startsWith("..")&&c!==r&&yEe(c,r)){let l=this._ignoreMap.get(a);if(!l)throw new Error(`No ignore patterns found for ${a}`);if(o=l.ignore.test(u),o.ignored||o.unignored)break}}return this._ignoreCache.set(r,o.ignored),o.ignored}catch{return!1}}get _searchRank(){if(this._searchRankCache!==null)return this._searchRankCache;let e={},r=n=>n.split(ya.sep).length;return this._searchRankCache=[...this._ignoreMap.keys()].sort((n,o)=>(e[o]||=r(o))-(e[n]||=r(n)))}};function yEe(t,e){return t===e?!0:(t.charAt(t.length-1)!==ya.sep&&(t+=ya.sep),(0,ya.normalize)(e).startsWith((0,ya.normalize)(t)))}var qEe=W(DEe(),1);var A2=t=>{if(typeof t!="string")throw new TypeError("invalid pattern");if(t.length>65536)throw new TypeError("pattern is too long")};var uZe={"[:alnum:]":["\\p{L}\\p{Nl}\\p{Nd}",!0],"[:alpha:]":["\\p{L}\\p{Nl}",!0],"[:ascii:]":["\\x00-\\x7f",!1],"[:blank:]":["\\p{Zs}\\t",!0],"[:cntrl:]":["\\p{Cc}",!0],"[:digit:]":["\\p{Nd}",!0],"[:graph:]":["\\p{Z}\\p{C}",!0,!0],"[:lower:]":["\\p{Ll}",!0],"[:print:]":["\\p{C}",!0],"[:punct:]":["\\p{P}",!0],"[:space:]":["\\p{Z}\\t\\r\\n\\v\\f",!0],"[:upper:]":["\\p{Lu}",!0],"[:word:]":["\\p{L}\\p{Nl}\\p{Nd}\\p{Pc}",!0],"[:xdigit:]":["A-Fa-f0-9",!1]},P2=t=>t.replace(/[[\]\\-]/g,"\\$&"),lZe=t=>t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),NEe=t=>t.join(""),LEe=(t,e)=>{let r=e;if(t.charAt(r)!=="[")throw new Error("not in a brace expression");let n=[],o=[],s=r+1,a=!1,c=!1,u=!1,l=!1,d=r,p="";e:for(;s<t.length;){let g=t.charAt(s);if((g==="!"||g==="^")&&s===r+1){l=!0,s++;continue}if(g==="]"&&a&&!u){d=s+1;break}if(a=!0,g==="\\"&&!u){u=!0,s++;continue}if(g==="["&&!u){for(let[v,[y,_,b]]of Object.entries(uZe))if(t.startsWith(v,s)){if(p)return["$.",!1,t.length-r,!0];s+=v.length,b?o.push(y):n.push(y),c=c||_;continue e}}if(u=!1,p){g>p?n.push(P2(p)+"-"+P2(g)):g===p&&n.push(P2(g)),p="",s++;continue}if(t.startsWith("-]",s+1)){n.push(P2(g+"-")),s+=2;continue}if(t.startsWith("-",s+1)){p=g,s+=2;continue}n.push(P2(g)),s++}if(d<s)return["",!1,0,!1];if(!n.length&&!o.length)return["$.",!1,t.length-r,!0];if(o.length===0&&n.length===1&&/^\\?.$/.test(n[0])&&!l){let g=n[0].length===2?n[0].slice(-1):n[0];return[lZe(g),!1,d-r,!1]}let f="["+(l?"^":"")+NEe(n)+"]",m="["+(l?"":"^")+NEe(o)+"]";return[n.length&&o.length?"("+f+"|"+m+")":n.length?f:m,c,d-r,!0]};var Rv=(t,{windowsPathsNoEscape:e=!1}={})=>e?t.replace(/\[([^\/\\])\]/g,"$1"):t.replace(/((?!\\).|^)\[([^\/\\])\]/g,"$1$2").replace(/\\([^\/])/g,"$1");var dZe=new Set(["!","?","+","*","@"]),OEe=t=>dZe.has(t),pZe="(?!(?:^|/)\\.\\.?(?:$|/))",pM="(?!\\.)",fZe=new Set(["[","."]),mZe=new Set(["..","."]),hZe=new Set("().*{}+?[]^$\\!"),gZe=t=>t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),tJ="[^/]",MEe=tJ+"*?",FEe=tJ+"+?",xC=class t{type;#t;#i;#d=!1;#r=[];#c;#a;#m;#s=!1;#n;#e;#p=!1;constructor(e,r,n={}){this.type=e,e&&(this.#i=!0),this.#c=r,this.#t=this.#c?this.#c.#t:this,this.#n=this.#t===this?n:this.#t.#n,this.#m=this.#t===this?[]:this.#t.#m,e==="!"&&!this.#t.#s&&this.#m.push(this),this.#a=this.#c?this.#c.#r.length:0}get hasMagic(){if(this.#i!==void 0)return this.#i;for(let e of this.#r)if(typeof e!="string"&&(e.type||e.hasMagic))return this.#i=!0;return this.#i}toString(){return this.#e!==void 0?this.#e:this.type?this.#e=this.type+"("+this.#r.map(e=>String(e)).join("|")+")":this.#e=this.#r.map(e=>String(e)).join("")}#h(){if(this!==this.#t)throw new Error("should only call on root");if(this.#s)return this;this.toString(),this.#s=!0;let e;for(;e=this.#m.pop();){if(e.type!=="!")continue;let r=e,n=r.#c;for(;n;){for(let o=r.#a+1;!n.type&&o<n.#r.length;o++)for(let s of e.#r){if(typeof s=="string")throw new Error("string part in extglob AST??");s.copyIn(n.#r[o])}r=n,n=r.#c}}return this}push(...e){for(let r of e)if(r!==""){if(typeof r!="string"&&!(r instanceof t&&r.#c===this))throw new Error("invalid part: "+r);this.#r.push(r)}}toJSON(){let e=this.type===null?this.#r.slice().map(r=>typeof r=="string"?r:r.toJSON()):[this.type,...this.#r.map(r=>r.toJSON())];return this.isStart()&&!this.type&&e.unshift([]),this.isEnd()&&(this===this.#t||this.#t.#s&&this.#c?.type==="!")&&e.push({}),e}isStart(){if(this.#t===this)return!0;if(!this.#c?.isStart())return!1;if(this.#a===0)return!0;let e=this.#c;for(let r=0;r<this.#a;r++){let n=e.#r[r];if(!(n instanceof t&&n.type==="!"))return!1}return!0}isEnd(){if(this.#t===this||this.#c?.type==="!")return!0;if(!this.#c?.isEnd())return!1;if(!this.type)return this.#c?.isEnd();let e=this.#c?this.#c.#r.length:0;return this.#a===e-1}copyIn(e){typeof e=="string"?this.push(e):this.push(e.clone(this))}clone(e){let r=new t(this.type,e);for(let n of this.#r)r.copyIn(n);return r}static#l(e,r,n,o){let s=!1,a=!1,c=-1,u=!1;if(r.type===null){let m=n,h="";for(;m<e.length;){let g=e.charAt(m++);if(s||g==="\\"){s=!s,h+=g;continue}if(a){m===c+1?(g==="^"||g==="!")&&(u=!0):g==="]"&&!(m===c+2&&u)&&(a=!1),h+=g;continue}else if(g==="["){a=!0,c=m,u=!1,h+=g;continue}if(!o.noext&&OEe(g)&&e.charAt(m)==="("){r.push(h),h="";let v=new t(g,r);m=t.#l(e,v,m,o),r.push(v);continue}h+=g}return r.push(h),m}let l=n+1,d=new t(null,r),p=[],f="";for(;l<e.length;){let m=e.charAt(l++);if(s||m==="\\"){s=!s,f+=m;continue}if(a){l===c+1?(m==="^"||m==="!")&&(u=!0):m==="]"&&!(l===c+2&&u)&&(a=!1),f+=m;continue}else if(m==="["){a=!0,c=l,u=!1,f+=m;continue}if(OEe(m)&&e.charAt(l)==="("){d.push(f),f="";let h=new t(m,d);d.push(h),l=t.#l(e,h,l,o);continue}if(m==="|"){d.push(f),f="",p.push(d),d=new t(null,r);continue}if(m===")")return f===""&&r.#r.length===0&&(r.#p=!0),d.push(f),f="",r.push(...p,d),l;f+=m}return r.type=null,r.#i=void 0,r.#r=[e.substring(n-1)],l}static fromGlob(e,r={}){let n=new t(null,void 0,r);return t.#l(e,n,0,r),n}toMMPattern(){if(this!==this.#t)return this.#t.toMMPattern();let e=this.toString(),[r,n,o,s]=this.toRegExpSource();if(!(o||this.#i||this.#n.nocase&&!this.#n.nocaseMagicOnly&&e.toUpperCase()!==e.toLowerCase()))return n;let c=(this.#n.nocase?"i":"")+(s?"u":"");return Object.assign(new RegExp(`^${r}$`,c),{_src:r,_glob:e})}toRegExpSource(e){let r=e??!!this.#n.dot;if(this.#t===this&&this.#h(),!this.type){let u=this.isStart()&&this.isEnd(),l=this.#r.map(m=>{let[h,g,v,y]=typeof m=="string"?t.#v(m,this.#i,u):m.toRegExpSource(e);return this.#i=this.#i||v,this.#d=this.#d||y,h}).join(""),d="";if(this.isStart()&&typeof this.#r[0]=="string"&&!(this.#r.length===1&&mZe.has(this.#r[0]))){let h=fZe,g=r&&h.has(l.charAt(0))||l.startsWith("\\.")&&h.has(l.charAt(2))||l.startsWith("\\.\\.")&&h.has(l.charAt(4)),v=!r&&!e&&h.has(l.charAt(0));d=g?pZe:v?pM:""}let p="";return this.isEnd()&&this.#t.#s&&this.#c?.type==="!"&&(p="(?:$|\\/)"),[d+l+p,Rv(l),this.#i=!!this.#i,this.#d]}let n=this.type==="*"||this.type==="+",o=this.type==="!"?"(?:(?!(?:":"(?:",s=this.#u(r);if(this.isStart()&&this.isEnd()&&!s&&this.type!=="!"){let u=this.toString();return this.#r=[u],this.type=null,this.#i=void 0,[u,Rv(this.toString()),!1,!1]}let a=!n||e||r||!pM?"":this.#u(!0);a===s&&(a=""),a&&(s=`(?:${s})(?:${a})*?`);let c="";if(this.type==="!"&&this.#p)c=(this.isStart()&&!r?pM:"")+FEe;else{let u=this.type==="!"?"))"+(this.isStart()&&!r&&!e?pM:"")+MEe+")":this.type==="@"?")":this.type==="?"?")?":this.type==="+"&&a?")":this.type==="*"&&a?")?":`)${this.type}`;c=o+s+u}return[c,Rv(s),this.#i=!!this.#i,this.#d]}#u(e){return this.#r.map(r=>{if(typeof r=="string")throw new Error("string type in extglob ast??");let[n,o,s,a]=r.toRegExpSource(e);return this.#d=this.#d||a,n}).filter(r=>!(this.isStart()&&this.isEnd())||!!r).join("|")}static#v(e,r,n=!1){let o=!1,s="",a=!1;for(let c=0;c<e.length;c++){let u=e.charAt(c);if(o){o=!1,s+=(hZe.has(u)?"\\":"")+u;continue}if(u==="\\"){c===e.length-1?s+="\\\\":o=!0;continue}if(u==="["){let[l,d,p,f]=LEe(e,c);if(p){s+=l,a=a||d,c+=p-1,r=r||f;continue}}if(u==="*"){n&&e==="*"?s+=FEe:s+=MEe,r=!0;continue}if(u==="?"){s+=tJ,r=!0;continue}s+=gZe(u)}return[s,Rv(e),!!r,a]}};var rJ=(t,{windowsPathsNoEscape:e=!1}={})=>e?t.replace(/[?*()[\]]/g,"[$&]"):t.replace(/[?*()[\]\\]/g,"\\$&");var Cs=(t,e,r={})=>(A2(e),!r.nocomment&&e.charAt(0)==="#"?!1:new SC(e,r).match(t)),vZe=/^\*+([^+@!?\*\[\(]*)$/,yZe=t=>e=>!e.startsWith(".")&&e.endsWith(t),bZe=t=>e=>e.endsWith(t),_Ze=t=>(t=t.toLowerCase(),e=>!e.startsWith(".")&&e.toLowerCase().endsWith(t)),xZe=t=>(t=t.toLowerCase(),e=>e.toLowerCase().endsWith(t)),SZe=/^\*+\.\*+$/,IZe=t=>!t.startsWith(".")&&t.includes("."),CZe=t=>t!=="."&&t!==".."&&t.includes("."),TZe=/^\.\*+$/,EZe=t=>t!=="."&&t!==".."&&t.startsWith("."),wZe=/^\*+$/,RZe=t=>t.length!==0&&!t.startsWith("."),kZe=t=>t.length!==0&&t!=="."&&t!=="..",AZe=/^\?+([^+@!?\*\[\(]*)?$/,PZe=([t,e=""])=>{let r=HEe([t]);return e?(e=e.toLowerCase(),n=>r(n)&&n.toLowerCase().endsWith(e)):r},DZe=([t,e=""])=>{let r=jEe([t]);return e?(e=e.toLowerCase(),n=>r(n)&&n.toLowerCase().endsWith(e)):r},NZe=([t,e=""])=>{let r=jEe([t]);return e?n=>r(n)&&n.endsWith(e):r},LZe=([t,e=""])=>{let r=HEe([t]);return e?n=>r(n)&&n.endsWith(e):r},HEe=([t])=>{let e=t.length;return r=>r.length===e&&!r.startsWith(".")},jEe=([t])=>{let e=t.length;return r=>r.length===e&&r!=="."&&r!==".."},zEe=typeof process=="object"&&process?typeof process.env=="object"&&process.env&&process.env.__MINIMATCH_TESTING_PLATFORM__||process.platform:"posix",UEe={win32:{sep:"\\"},posix:{sep:"/"}},OZe=zEe==="win32"?UEe.win32.sep:UEe.posix.sep;Cs.sep=OZe;var Du=Symbol("globstar **");Cs.GLOBSTAR=Du;var MZe="[^/]",FZe=MZe+"*?",UZe="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",BZe="(?:(?!(?:\\/|^)\\.).)*?",qZe=(t,e={})=>r=>Cs(r,t,e);Cs.filter=qZe;var Pu=(t,e={})=>Object.assign({},t,e),HZe=t=>{if(!t||typeof t!="object"||!Object.keys(t).length)return Cs;let e=Cs;return Object.assign((n,o,s={})=>e(n,o,Pu(t,s)),{Minimatch:class extends e.Minimatch{constructor(o,s={}){super(o,Pu(t,s))}static defaults(o){return e.defaults(Pu(t,o)).Minimatch}},AST:class extends e.AST{constructor(o,s,a={}){super(o,s,Pu(t,a))}static fromGlob(o,s={}){return e.AST.fromGlob(o,Pu(t,s))}},unescape:(n,o={})=>e.unescape(n,Pu(t,o)),escape:(n,o={})=>e.escape(n,Pu(t,o)),filter:(n,o={})=>e.filter(n,Pu(t,o)),defaults:n=>e.defaults(Pu(t,n)),makeRe:(n,o={})=>e.makeRe(n,Pu(t,o)),braceExpand:(n,o={})=>e.braceExpand(n,Pu(t,o)),match:(n,o,s={})=>e.match(n,o,Pu(t,s)),sep:e.sep,GLOBSTAR:Du})};Cs.defaults=HZe;var GEe=(t,e={})=>(A2(t),e.nobrace||!/\{(?:(?!\{).)*\}/.test(t)?[t]:(0,qEe.default)(t));Cs.braceExpand=GEe;var jZe=(t,e={})=>new SC(t,e).makeRe();Cs.makeRe=jZe;var zZe=(t,e,r={})=>{let n=new SC(e,r);return t=t.filter(o=>n.match(o)),n.options.nonull&&!t.length&&t.push(e),t};Cs.match=zZe;var BEe=/[?*]|[+@!]\(.*?\)|\[|\]/,GZe=t=>t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),SC=class{options;set;pattern;windowsPathsNoEscape;nonegate;negate;comment;empty;preserveMultipleSlashes;partial;globSet;globParts;nocase;isWindows;platform;windowsNoMagicRoot;regexp;constructor(e,r={}){A2(e),r=r||{},this.options=r,this.pattern=e,this.platform=r.platform||zEe,this.isWindows=this.platform==="win32",this.windowsPathsNoEscape=!!r.windowsPathsNoEscape||r.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.preserveMultipleSlashes=!!r.preserveMultipleSlashes,this.regexp=null,this.negate=!1,this.nonegate=!!r.nonegate,this.comment=!1,this.empty=!1,this.partial=!!r.partial,this.nocase=!!this.options.nocase,this.windowsNoMagicRoot=r.windowsNoMagicRoot!==void 0?r.windowsNoMagicRoot:!!(this.isWindows&&this.nocase),this.globSet=[],this.globParts=[],this.set=[],this.make()}hasMagic(){if(this.options.magicalBraces&&this.set.length>1)return!0;for(let e of this.set)for(let r of e)if(typeof r!="string")return!0;return!1}debug(...e){}make(){let e=this.pattern,r=this.options;if(!r.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate(),this.globSet=[...new Set(this.braceExpand())],r.debug&&(this.debug=(...s)=>console.error(...s)),this.debug(this.pattern,this.globSet);let n=this.globSet.map(s=>this.slashSplit(s));this.globParts=this.preprocess(n),this.debug(this.pattern,this.globParts);let o=this.globParts.map((s,a,c)=>{if(this.isWindows&&this.windowsNoMagicRoot){let u=s[0]===""&&s[1]===""&&(s[2]==="?"||!BEe.test(s[2]))&&!BEe.test(s[3]),l=/^[a-z]:/i.test(s[0]);if(u)return[...s.slice(0,4),...s.slice(4).map(d=>this.parse(d))];if(l)return[s[0],...s.slice(1).map(d=>this.parse(d))]}return s.map(u=>this.parse(u))});if(this.debug(this.pattern,o),this.set=o.filter(s=>s.indexOf(!1)===-1),this.isWindows)for(let s=0;s<this.set.length;s++){let a=this.set[s];a[0]===""&&a[1]===""&&this.globParts[s][2]==="?"&&typeof a[3]=="string"&&/^[a-z]:$/i.test(a[3])&&(a[2]="?")}this.debug(this.pattern,this.set)}preprocess(e){if(this.options.noglobstar)for(let n=0;n<e.length;n++)for(let o=0;o<e[n].length;o++)e[n][o]==="**"&&(e[n][o]="*");let{optimizationLevel:r=1}=this.options;return r>=2?(e=this.firstPhasePreProcess(e),e=this.secondPhasePreProcess(e)):r>=1?e=this.levelOneOptimize(e):e=this.adjascentGlobstarOptimize(e),e}adjascentGlobstarOptimize(e){return e.map(r=>{let n=-1;for(;(n=r.indexOf("**",n+1))!==-1;){let o=n;for(;r[o+1]==="**";)o++;o!==n&&r.splice(n,o-n)}return r})}levelOneOptimize(e){return e.map(r=>(r=r.reduce((n,o)=>{let s=n[n.length-1];return o==="**"&&s==="**"?n:o===".."&&s&&s!==".."&&s!=="."&&s!=="**"?(n.pop(),n):(n.push(o),n)},[]),r.length===0?[""]:r))}levelTwoFileOptimize(e){Array.isArray(e)||(e=this.slashSplit(e));let r=!1;do{if(r=!1,!this.preserveMultipleSlashes){for(let o=1;o<e.length-1;o++){let s=e[o];o===1&&s===""&&e[0]===""||(s==="."||s==="")&&(r=!0,e.splice(o,1),o--)}e[0]==="."&&e.length===2&&(e[1]==="."||e[1]==="")&&(r=!0,e.pop())}let n=0;for(;(n=e.indexOf("..",n+1))!==-1;){let o=e[n-1];o&&o!=="."&&o!==".."&&o!=="**"&&(r=!0,e.splice(n-1,2),n-=2)}}while(r);return e.length===0?[""]:e}firstPhasePreProcess(e){let r=!1;do{r=!1;for(let n of e){let o=-1;for(;(o=n.indexOf("**",o+1))!==-1;){let a=o;for(;n[a+1]==="**";)a++;a>o&&n.splice(o+1,a-o);let c=n[o+1],u=n[o+2],l=n[o+3];if(c!==".."||!u||u==="."||u===".."||!l||l==="."||l==="..")continue;r=!0,n.splice(o,1);let d=n.slice(0);d[o]="**",e.push(d),o--}if(!this.preserveMultipleSlashes){for(let a=1;a<n.length-1;a++){let c=n[a];a===1&&c===""&&n[0]===""||(c==="."||c==="")&&(r=!0,n.splice(a,1),a--)}n[0]==="."&&n.length===2&&(n[1]==="."||n[1]==="")&&(r=!0,n.pop())}let s=0;for(;(s=n.indexOf("..",s+1))!==-1;){let a=n[s-1];if(a&&a!=="."&&a!==".."&&a!=="**"){r=!0;let u=s===1&&n[s+1]==="**"?["."]:[];n.splice(s-1,2,...u),n.length===0&&n.push(""),s-=2}}}}while(r);return e}secondPhasePreProcess(e){for(let r=0;r<e.length-1;r++)for(let n=r+1;n<e.length;n++){let o=this.partsMatch(e[r],e[n],!this.preserveMultipleSlashes);o&&(e[r]=o,e[n]=[])}return e.filter(r=>r.length)}partsMatch(e,r,n=!1){let o=0,s=0,a=[],c="";for(;o<e.length&&s<r.length;)if(e[o]===r[s])a.push(c==="b"?r[s]:e[o]),o++,s++;else if(n&&e[o]==="**"&&r[s]===e[o+1])a.push(e[o]),o++;else if(n&&r[s]==="**"&&e[o]===r[s+1])a.push(r[s]),s++;else if(e[o]==="*"&&r[s]&&(this.options.dot||!r[s].startsWith("."))&&r[s]!=="**"){if(c==="b")return!1;c="a",a.push(e[o]),o++,s++}else if(r[s]==="*"&&e[o]&&(this.options.dot||!e[o].startsWith("."))&&e[o]!=="**"){if(c==="a")return!1;c="b",a.push(r[s]),o++,s++}else return!1;return e.length===r.length&&a}parseNegate(){if(this.nonegate)return;let e=this.pattern,r=!1,n=0;for(let o=0;o<e.length&&e.charAt(o)==="!";o++)r=!r,n++;n&&(this.pattern=e.slice(n)),this.negate=r}matchOne(e,r,n=!1){let o=this.options;if(this.isWindows){let g=typeof e[0]=="string"&&/^[a-z]:$/i.test(e[0]),v=!g&&e[0]===""&&e[1]===""&&e[2]==="?"&&/^[a-z]:$/i.test(e[3]),y=typeof r[0]=="string"&&/^[a-z]:$/i.test(r[0]),_=!y&&r[0]===""&&r[1]===""&&r[2]==="?"&&typeof r[3]=="string"&&/^[a-z]:$/i.test(r[3]),b=v?3:g?0:void 0,S=_?3:y?0:void 0;if(typeof b=="number"&&typeof S=="number"){let[I,w]=[e[b],r[S]];I.toLowerCase()===w.toLowerCase()&&(r[S]=I,S>b?r=r.slice(S):b>S&&(e=e.slice(b)))}}let{optimizationLevel:s=1}=this.options;s>=2&&(e=this.levelTwoFileOptimize(e)),this.debug("matchOne",this,{file:e,pattern:r}),this.debug("matchOne",e.length,r.length);for(var a=0,c=0,u=e.length,l=r.length;a<u&&c<l;a++,c++){this.debug("matchOne loop");var d=r[c],p=e[a];if(this.debug(r,d,p),d===!1)return!1;if(d===Du){this.debug("GLOBSTAR",[r,d,p]);var f=a,m=c+1;if(m===l){for(this.debug("** at the end");a<u;a++)if(e[a]==="."||e[a]===".."||!o.dot&&e[a].charAt(0)===".")return!1;return!0}for(;f<u;){var h=e[f];if(this.debug(`
globstar while`,e,f,r,m,h),this.matchOne(e.slice(f),r.slice(m),n))return this.debug("globstar found match!",f,u,h),!0;if(h==="."||h===".."||!o.dot&&h.charAt(0)==="."){this.debug("dot detected!",e,f,r,m);break}this.debug("globstar swallow a segment, and continue"),f++}return!!(n&&(this.debug(`
>>> no match, partial?`,e,f,r,m),f===u))}let g;if(typeof d=="string"?(g=p===d,this.debug("string match",d,p,g)):(g=d.test(p),this.debug("pattern match",d,p,g)),!g)return!1}if(a===u&&c===l)return!0;if(a===u)return n;if(c===l)return a===u-1&&e[a]==="";throw new Error("wtf?")}braceExpand(){return GEe(this.pattern,this.options)}parse(e){A2(e);let r=this.options;if(e==="**")return Du;if(e==="")return"";let n,o=null;(n=e.match(wZe))?o=r.dot?kZe:RZe:(n=e.match(vZe))?o=(r.nocase?r.dot?xZe:_Ze:r.dot?bZe:yZe)(n[1]):(n=e.match(AZe))?o=(r.nocase?r.dot?DZe:PZe:r.dot?NZe:LZe)(n):(n=e.match(SZe))?o=r.dot?CZe:IZe:(n=e.match(TZe))&&(o=EZe);let s=xC.fromGlob(e,this.options).toMMPattern();return o?Object.assign(s,{test:o}):s}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;let e=this.set;if(!e.length)return this.regexp=!1,this.regexp;let r=this.options,n=r.noglobstar?FZe:r.dot?UZe:BZe,o=new Set(r.nocase?["i"]:[]),s=e.map(u=>{let l=u.map(d=>{if(d instanceof RegExp)for(let p of d.flags.split(""))o.add(p);return typeof d=="string"?GZe(d):d===Du?Du:d._src});return l.forEach((d,p)=>{let f=l[p+1],m=l[p-1];d!==Du||m===Du||(m===void 0?f!==void 0&&f!==Du?l[p+1]="(?:\\/|"+n+"\\/)?"+f:l[p]=n:f===void 0?l[p-1]=m+"(?:\\/|"+n+")?":f!==Du&&(l[p-1]=m+"(?:\\/|\\/"+n+"\\/)"+f,l[p+1]=Du))}),l.filter(d=>d!==Du).join("/")}).join("|"),[a,c]=e.length>1?["(?:",")"]:["",""];s="^"+a+s+c+"$",this.negate&&(s="^(?!"+s+").+$");try{this.regexp=new RegExp(s,[...o].join(""))}catch{this.regexp=!1}return this.regexp}slashSplit(e){return this.preserveMultipleSlashes?e.split("/"):this.isWindows&&/^\/\/[^\/]+/.test(e)?["",...e.split(/\/+/)]:e.split(/\/+/)}match(e,r=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&r)return!0;let n=this.options;this.isWindows&&(e=e.split("\\").join("/"));let o=this.slashSplit(e);this.debug(this.pattern,"split",o);let s=this.set;this.debug(this.pattern,"set",s);let a=o[o.length-1];if(!a)for(let c=o.length-2;!a&&c>=0;c--)a=o[c];for(let c=0;c<s.length;c++){let u=s[c],l=o;if(n.matchBase&&u.length===1&&(l=[a]),this.matchOne(l,u,r))return n.flipNegate?!0:!this.negate}return n.flipNegate?!1:this.negate}static defaults(e){return Cs.defaults(e).Minimatch}};Cs.AST=xC;Cs.Minimatch=SC;Cs.escape=rJ;Cs.unescape=Rv;var fM=class t{constructor(e,r,n,o,s){this._gitService=e;this._gitExtensionService=r;this._logService=n;this._fetcherService=o;this._copilotTokenManager=s;this._contentExclusionCache=new Map;this._contentExclusionFetchPromise=void 0;this._repositoryDiscoveryComplete=!1;this._disposables=[];let a=new mP;this._disposables.push(a),a.cancelAndSet(async()=>{await this.makeContentExclusionRequest()},30*60*1e3),this._gitService.repositories.map(c=>this.shouldFetchContentExclusionRules(c)),this.makeContentExclusionRequest(),this._disposables.push(this._gitService.onDidOpenRepository(async c=>{this.shouldFetchContentExclusionRules(c)&&await this.makeContentExclusionRequest()})),this._disposables.push(this._gitService.onDidCloseRepository(async c=>{let u=this.getRepositoryInfo(c);if(u)for(let l of u.fetchUrls)this._contentExclusionCache.delete(l)})),this._gitExtensionService.extensionAvaiable||(this._repositoryDiscoveryComplete=!0),this._gitService.isInitialized?this._repositoryDiscoveryComplete=!0:this._disposables.push(this._gitService.onDidFinishInitialization(()=>{this._repositoryDiscoveryComplete=!0}))}static{this.CONTENT_EXCLUSION_ENDPOINT="https://api.github.com/copilot_internal/content_exclusion"}async isIgnored(e){await this._contentExclusionFetchPromise,this.shouldFetchContentExclusionRules(e)&&await this.makeContentExclusionRequest();for(let{patterns:r}of this._contentExclusionCache.values())for(let n of r)if(Cs(e.path,n,{nocase:!0,matchBase:!0,nonegate:!0}))return this._logService.defaultLogger.info(`File ${e.path} is ignored by content exclusion rule ${n}`),!0;return this._repositoryDiscoveryComplete?!1:(this._logService.defaultLogger.info(`File ${e.path} is automatically ignored by content exclusion rules as repository discovery is not complete`),!0)}async asMinimatchPatterns(){return await this._contentExclusionFetchPromise,Array.from(this._contentExclusionCache.values()).flatMap(({patterns:r})=>r)}dispose(){this._disposables.forEach(e=>e.dispose()),this._disposables=[],this._contentExclusionCache.clear()}shouldFetchContentExclusionRules(e){let r=this.getRepositoryInfo(e);if(!r)return!1;let n=!1;for(let o of r?.fetchUrls??[])this._contentExclusionCache.has(o)||(n=!0,this._contentExclusionCache.set(o,{patterns:[],repoRoot:r.repoRoot}));return n}async makeContentExclusionRequest(){try{this._contentExclusionFetchPromise=this._contentExclusionRequest(),await this._contentExclusionFetchPromise}catch{this._contentExclusionFetchPromise=void 0}}async _contentExclusionRequest(){let e=this._fetcherService,r=(await this._copilotTokenManager.getAnyGitHubSession({silent:!0}))?.accessToken,n=Array.from(this._contentExclusionCache.keys());for(let o=0;o<n.length;o+=10){let s=n.slice(o,o+10),a=s.join(","),c=new URL(t.CONTENT_EXCLUSION_ENDPOINT);c.searchParams.set("repos",a);let u=await e.fetch(c.toString(),{headers:{Authorization:`token ${r}`}});if(!u.ok)continue;let l=await u.json();for(let d=0;d<l.length;d++){let p=l[d].rules.map(h=>h.paths).flat(),f=s[d],m=this._contentExclusionCache.get(f)?.repoRoot;m&&this._contentExclusionCache.set(f,{patterns:VZe(p,m),repoRoot:m})}this._contentExclusionFetchPromise=void 0}}getRepositoryInfo(e){let r=lt.isUri(e)?this._gitService.getRepository(e):e;if(!r||!r.remoteFetchUrls)return;let n=Kt(r.remoteFetchUrls.map(o=>{if(o)try{return Gne(o)}catch{return}}));return{repoRoot:r.rootUri,fetchUrls:n}}};function VZe(t,e){return t.map(r=>r.startsWith("/")?`${e.path}${r}`:r)}var mM=".copilotignore";var hM=class{constructor(e,r,n,o,s,a,c,u,l){this._gitService=e;this._gitExtensionService=r;this._logService=n;this._fetcherService=o;this._copilotTokenManager=s;this._copilotTokenNotifier=a;this._workspaceService=c;this.searchService=u;this.fs=l;this._copilotIgnoreFiles=new dM;this._copilotIgnoreEnabled=!1;this._onDidChangeCopilotIgnoreEnablement=new Ht;this._disposables=[];this.onDidChangeCopilotIgnoreEnablement=this._onDidChangeCopilotIgnoreEnablement.event;this._filesIgnoredThisSession={"Remote Content Exclusions":new Set,"Copilot Ignore File":new Set},this._disposables.push(this._onDidChangeCopilotIgnoreEnablement),this._disposables.push(this._copilotTokenNotifier.onCopilotToken(async d=>{let p=d.envelope.copilotignore_enabled??!1;this._copilotIgnoreEnabled!==p&&this._onDidChangeCopilotIgnoreEnablement.fire(p),this._copilotIgnoreEnabled=p,this._copilotIgnoreEnabled===!1&&this._remoteContentExclusions&&(this._remoteContentExclusions.dispose(),this._remoteContentExclusions=void 0),this._copilotIgnoreEnabled===!0&&!this._remoteContentExclusions&&(this._remoteContentExclusions=new fM(this._gitService,this._gitExtensionService,this._logService,this._fetcherService,this._copilotTokenManager))}))}dispose(){this._disposables.forEach(e=>e.dispose()),this._remoteContentExclusions&&(this._remoteContentExclusions.dispose(),this._remoteContentExclusions=void 0),this._disposables=[]}async isCopilotIgnored(e){let r=!1;if(this._copilotIgnoreEnabled){let n=this._copilotIgnoreFiles.isIgnored(e);r=n||await(this._remoteContentExclusions?.isIgnored(e)??!1),r&&(n?this._filesIgnoredThisSession["Copilot Ignore File"].add(e.toString()):this._filesIgnoredThisSession["Remote Content Exclusions"].add(e.toString()))}return r}async asMinimatchPattern(){let e=[];e.push(await this._remoteContentExclusions?.asMinimatchPatterns()??[]),e.push(this._copilotIgnoreFiles.asMinimatchPatterns());let r=e.flat();if(r.length!==0)return r.length===1?r[0]:`{${r.join(",")}}`}init(){return this._init??=(async()=>{for(let e of this._workspaceService.getWorkspaceFolders())await this.addWorkspace(e)})(),this._init}async sessionInfo(){let e=`# Content Exclusion Session Info

`;for(let n in this._filesIgnoredThisSession){let o=this._filesIgnoredThisSession[n];o.size>0&&(e+=`## Files ignored this session from ${n}:

${Array.from(o).join(`
`)}`,e+=`

`)}let r=await this.asMinimatchPattern();return r&&(e+=`## Exclude glob used during search:
`+r),e}trackIgnoreFile(e,r,n){r.path.endsWith(mM)&&this._copilotIgnoreFiles.setIgnoreFile(e,r,n)}removeIgnoreFile(e){e.path.endsWith(mM)&&this._copilotIgnoreFiles.removeIgnoreFile(e)}removeWorkspace(e){this._copilotIgnoreFiles.removeWorkspace(e)}isIgnoreFile(e){return!!e.path.endsWith(mM)}async addWorkspace(e){if(e.scheme!=="file")return;let r=await this.searchService.findFilesWithDefaultExcludes(new sI(e,`${mM}`),void 0,Fr.None);for(let n of r){let o=(await this.fs.readFile(n)).toString();this.trackIgnoreFile(e,n,o)}}};var gM=class{constructor(e){this.contentProvider=e}async provideTextDocumentContent(e,r){return this.contentProvider()}};var VEe="copilot-ignore",Fb=class extends hM{constructor(e,r,n,o,s,a,c){super(e,r,n,o,s,a,c,new rx,new _C),this.installListeners(),this._disposables.push(Xo.workspace.registerTextDocumentContentProvider(VEe,new gM(this.sessionInfo.bind(this))))}installListeners(){this._disposables.push(Xo.workspace.onDidChangeWorkspaceFolders(e=>{for(let r of e.removed)this.removeWorkspace(r.uri);for(let r of e.added)this.addWorkspace(r.uri)})),this._disposables.push(Xo.workspace.onDidSaveTextDocument(async e=>{if(this.isIgnoreFile(e.uri)){let r=(await Xo.workspace.fs.readFile(e.uri)).toString(),n=Xo.workspace.getWorkspaceFolder(e.uri);this.trackIgnoreFile(n?.uri,e.uri,r)}}),Xo.workspace.onDidDeleteFiles(e=>{for(let r of e.files)this.removeIgnoreFile(r)}),Xo.workspace.onDidRenameFiles(async e=>{for(let r of e.files)if(this.isIgnoreFile(r.newUri)){let n=(await Xo.workspace.fs.readFile(r.newUri)).toString();this.removeIgnoreFile(r.oldUri);let o=Xo.workspace.getWorkspaceFolder(r.newUri);this.trackIgnoreFile(o?.uri,r.newUri,n)}})),this._disposables.push(this.onDidChangeCopilotIgnoreEnablement(e=>{Xo.commands.executeCommand("setContext","github.copilot.copilotIgnoreEnabled",e)}))}async dispalyContentExclusionSessionInfo(){let e=lt.from({scheme:VEe,authority:Br(),path:"/Content Exclusion Session Info"}),r=await Xo.workspace.openTextDocument(e);await Xo.languages.setTextDocumentLanguage(r,"markdown"),await Xo.window.showTextDocument(r)}};Fb=B([T(0,Fo),T(1,ka),T(2,ce),T(3,Ur),T(4,Nn),T(5,Vi),T(6,Ze)],Fb);function $Ee(t){let e=t.get(De);return e instanceof Fb?Xo.commands.registerCommand("github.copilot.debug.contentExclusions",e.dispalyContentExclusionSessionInfo.bind(e)):{dispose:()=>{}}}var dwe=W(require("path")),Wt=W(require("vscode"));var WEe=W(require("path"));var IC=class{constructor(){this.kind="current-selection";this.variableInfo=Wr.variableInfo;this.metaContextResolverInfo={description:"Active selection."}}async resolveContext(e,r){let{messages:n,references:o,usedContext:s}=await _s(e,r.endpoint,Wr,{},e.get(ve).acquireTokenizer(r.endpoint.family));if(n.length>0&&o.length>0)return{kind:this.kind,userMessages:n.map(a=>a.content),usedContext:s,references:o}}static formatSelection(e){let r=e.fileName?`From the file: ${WEe.basename(e.fileName)}
`:"",{trimmedLines:n}=PE(e.selectedText.split(/\r?\n/g));return`

${r}${ki(e.languageId,Kt(n).join(`
`))}

`}},eur=en.register(new IC);var vM=W(Tr()),N2=W(ct());var KEe=W(ct());var kv=class extends Y{constructor(r,n,o){super(r,n);this._ignoreService=o}async prepare(r,n,o){if(await this._ignoreService.isCopilotIgnored(this.props.documentContext.document.uri))return{k:"ignored"};let s=this.props.nodeToDocument??await Av(this.accessor,this.props.documentContext),a=$Ze(this.props.endpointInfo,this.props.documentContext,s.range);return{k:"found",nodeToDocument:s,codeExcerptToDocument:a.range,metadata:new Ss(this.props.documentContext.wholeRange,a)}}render(r,n){if(r.k==="ignored")return vscpp("ignoredFiles",{value:[this.props.documentContext.document.uri]});let o=r.codeExcerptToDocument.generatePrompt(!1).join(`
`);return vscpp(KEe.UserMessage,null,vscpp("meta",{value:r.metadata}),"I have the following code in the selection:",o!==""?vscpp("br",null):"",r.codeExcerptToDocument.generatePrompt(!1).join(`
`))}};kv=B([T(2,De)],kv);async function Av(t,e){let r=t.get(_t),n=Xi(e.selection,e.document),o=r.getTreeSitterAST(e.document);if(o===void 0)return{range:e.wholeRange};let s=Date.now(),a=await o.getNodeToDocument(n),c=Date.now()-s,u=Xi(e.wholeRange,e.document);WZe(t,n,u,a,e.document.languageId,c);let l=Ps(e.document,a.nodeToDocument);return{identifier:a.nodeIdentifier,range:l}}function $Ze(t,e,r){let n=new cp(t.modelMaxPromptTokens*4/3),o=new Qs(n,e.document,e.language,"ed8c6549bwf9"),s=new Qs(new cp(0),e.document,e.language,"abpxx6d04wxr"),a=new Qs(new cp(0),e.document,e.language,"be15d9bcejpp");for(let c=r.start.line,u=r.end.line;c<=u&&!(c===u&&r.end.character===0||!o.appendLine(c));++c);return o.trim(e.selection),{language:e.language,above:s,range:o,below:a,outlineAbove:"",outlineBelow:""}}function WZe(t,e,r,n,o,s){t.get(me).sendMSFTTelemetryEvent("getNodeToDocument",{languageId:o,typeOfNodeToDocument:n.nodeToDocument.type,nodeToDocumentStart:n.nodeToDocument.startIndex.toString(),nodeToDocumentEnd:n.nodeToDocument.endIndex.toString(),selectionOffsetRangeStart:e.startIndex.toString(),selectionOffsetRangeEnd:e.endIndex.toString(),wholeRangeOffsetRangeStart:r.startIndex.toString(),wholeRangeOffsetRangeEnd:r.endIndex.toString()},{timeSpentMs:s})}var KZe=6e4,YZe=1500,Ub=class t{constructor(){this.id=t.ID;this.description=vM.t("Add documentation comment for this symbol");this.locations=[1];this.commandInfo={}}static{this.ID="doc"}get intentDetectionInput(){let e="generate_documentation_for_code";return{functionName:e,sampleQuestion:"Add jsdoc to this method",functionCallingBlurb:`If the active selection contains a symbol and the user's message is related to documenting code, adding docstrings, adding documentation, or adding comments, you should use the '${e}' function.`}}async asSlashCommand(e,r){if(r.document.lineCount>YZe||r.document.getText().length>KZe)return new D2("Add documentation comment for this symbol");let n=await Av(e,r),o=n.identifier?vM.t("Add documentation comment for '{0}'",n.identifier):vM.t("Add documentation comment for this symbol");return new D2(o,n)}async invoke(e,r){let n=r.documentContext;if(!n)throw new Error("Open a file to add documentation.");let o=r.slashCommand,s;o instanceof D2?s=o.nodeToDocument:e.get(ce).getLogger("InlineDocIntent#invoke").warn("Unexpected: SlashCommand given to intent invocation is not a DocSlashCommand");let a=await e.get(Le).getChatEndpoint("gpt-3.5-turbo");return new nJ(e,a,n,this,s)}},D2=class{constructor(e,r=void 0){this.description=e;this.nodeToDocument=r;this.name=Ub.ID}},nJ=class t{constructor(e,r,n,o,s=void 0){this.accessor=e;this.endpoint=r;this.context=n;this.intent=o;this.nodeToDocument=s;this.location=1;this.createReplyInterpreter=DI.createFactory(async(e,r)=>{if(!this.contextInfo||!this.wholeRange)throw new Error("doc intent NEEDS a selection context");let n=II(this.contextInfo,e,this.context.language);if(!n)return r.markdown(e),{type:"conversational"};let o=Bp(this.context.document.languageId),s=n.code;if(o){let c=Date.now(),u=await this.accessor.get(_t).extractDoc(o,s),l=Date.now()-c;t._sendExtractDocTelemetry(this.accessor.get(me),this.context.document.languageId,s.length,u,l),u&&(s=u)}let a=lv(this.accessor,this.contextInfo,s,1,this.context.fileIndentInfo);return Db(a,this.wholeRange)})}async buildPrompt(e,r,n,o,s){let a=this.nodeToDocument??await Av(this.accessor,this.context),c=new Xe(this.endpoint,iJ,{userQuery:e.getLatestTurn()?.request?.message??"",documentContext:this.context,nodeToDocument:a,endpointInfo:this.endpoint,history:e.turns.at(-2)?.request.message},this.accessor.get(ve).acquireTokenizer(this.endpoint.family),this.accessor),u=await c.render(n,s),l=c.getMeta(Ss);return uP(l!==void 0,"not undefined"),this.contextInfo=l.contextInfo,this.wholeRange=l.wholeRange,u}static _sendExtractDocTelemetry(e,r,n,o,s){e.sendMSFTTelemetryEvent("extractDoc",{languageId:r,couldExtractDoc:o===void 0?"false":"true"},{codeBlockLen:n,timeSpentMs:s})}},iJ=class extends Y{render(e,r){let n=F6(this.props.documentContext.language.languageId);return vscpp(vscppf,null,vscpp(N2.SystemMessage,null,"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"You must follow user's requirements carefully.",vscpp("br",null),"You must follow Microsoft content policies.",vscpp("br",null),"You must avoid content that violates copyrights.",vscpp("br",null),"For questions not related to software development, you should give a reminder that you are an AI programming assistant.",vscpp("br",null),"Each code block starts with ``` and ",this.props.documentContext.language.lineComment.start," FILEPATH.",vscpp("br",null),"When user asks you to document something, you must answer in the form of a ",n," markdown code block.",vscpp("br",null)),vscpp(kv,{documentContext:this.props.documentContext,nodeToDocument:this.props.nodeToDocument,endpointInfo:this.props.endpointInfo}),this.props.history&&this.props.history.length>0&&vscpp(N2.UserMessage,null,this.props.history),vscpp(N2.UserMessage,null,`${this.getQueryPrefix()} ${this.props.userQuery}`.trim()))}getQueryPrefix(){let e=this.props.nodeToDocument?.identifier,r=e!==void 0&&e!=="",n=r?e:"the selection",o;switch(this.props.documentContext.language.languageId){case"typescript":case"typescriptreact":o=r?"a TSDoc comment":"TSDoc comment";break;case"javascript":case"javascriptreact":o=r?"a JSDoc comment":"JSDoc comment";break;case"python":o="docstring";break;default:o="documentation comment"}return`Please add ${o} for ${n}.`}};var JEe=W(Tr());var XEe=W(ct());var fi=class extends Y{render(){return vscpp(vscppf,null,"Your expertise is strictly limited to software development topics.",vscpp("br",null),"Follow Microsoft content policies.",vscpp("br",null),"Avoid content that violates copyrights.",vscpp("br",null),"For questions not related to software development, simply give a reminder that you are an AI programming assistant.",vscpp("br",null),"Keep your answers short and impersonal.")}};var po=class extends Y{render(){return vscpp(vscppf,null,"Use Markdown formatting in your answers.",vscpp("br",null),"Make sure to include the programming language name at the start of the Markdown code blocks.",vscpp("br",null),"Avoid wrapping the whole response in triple backticks.",vscpp("br",null),"The user works in an IDE called Visual Studio Code which has a concept for editors with open files, integrated unit test support, an output pane that shows the output of running the code as well as an integrated terminal.",vscpp("br",null),"The active document is the source code the user is looking at right now.",vscpp("br",null),"You can only give one reply for each conversation turn.")}};var yM=W(Tr()),QEe=W(ct());var YEe=W(ct());var Nu=class extends Y{constructor(r,n,o,s,a,c){super(r,n);this.ignoreService=o;this.extensionContext=s;this.tabsAndEditorsService=a;this.servicesAccessor=c}static{this.DEFAULT_TIMEOUT_MS=200}async prepare(){let r={implementations:[],activeDocument:void 0,isIgnored:!1},{document:n,range:o}=this.props;if(!n){let u=this.tabsAndEditorsService.activeTextEditor;if(!u)return r;n??=u.document,o??=u.selection}if(!o||o.isEmpty)return r;if(await this.ignoreService.isCopilotIgnored(n.uri))return{...r,isIgnored:!0};let s=this.extensionContext.extensionMode===qc.Test?0:this.props.timeoutMs===void 0?Nu.DEFAULT_TIMEOUT_MS:this.props.timeoutMs,a=[{header:"Relevant function implementations",findImpls:yTe},{header:"Relevant class declarations",findImpls:bTe},{header:"Relevant type declarations",findImpls:_Te}],c=[];for(let{header:u,findImpls:l}of a){let d=await l(this.servicesAccessor,n,o,s);c.push([u,d])}return{implementations:c,activeDocument:n,isIgnored:!1}}render(r,n){if(!r.implementations.length||!r.activeDocument)return;let o=r.activeDocument.uri;if(r.isIgnored)return vscpp("ignoredFiles",{value:[o]});let s=[],a=[],c=[];for(let[u,l]of r.implementations){let{references:d,usedContext:p,text:f,uris:m}=oJ(r.activeDocument,l);if(f.length===0)continue;let h=vscpp(YEe.UserMessage,{priority:this.props.priority},u,":",vscpp("br",null),vscpp("br",null),f.map((g,v)=>vscpp(vscppf,null,vscpp(Oe,{code:g,languageId:r.activeDocument?.languageId,uri:m[v]}),vscpp("br",null))));s.push(h),a.push(...d),c.push(...p)}return vscpp(vscppf,null,vscpp("usedContext",{value:c}),vscpp("references",{value:a}),...s)}};Nu=B([T(2,De),T(3,zt),T(4,Tt),T(5,rt)],Nu);function oJ(t,e){let r=[],n=new Map,o=new Set,s=[],a=[];for(let c of e){let u=c.uri??t.uri,l=c.range??Ps(t,c),d=`${u.toString()}-${l.start.line}-${l.start.character}-${l.end.line}-${l.end.character}`;if(o.has(d))continue;o.add(d),r.push(new Eo.PromptReference(new yi(u,l))),s.push(c.text),a.push(u);let[p,f]=n.get(u)??[c.version??t.version,[]];f.push(l),n.set(u,[p,f])}return{references:r,usedContext:[...n.entries()].map(([c,[u,l]])=>({uri:c,version:u,ranges:l})),text:s,uris:a}}var Ts=class extends Y{constructor(r,n,o,s){super(r,n);this._languageFeaturesService=o;this._workspaceService=s}static getSymbolAtCursor(r,n){let{selection:o,document:s}=n;if(!o||!s){let u=r.get(Tt).activeTextEditor;if(!u)return;({selection:o,document:s}=u)}if(!o.isEmpty)return;let a=s.getWordRangeAtPosition(o.active)??o;return{selectedText:s.getText(a),document:s,range:a}}static async getDefinitionAtRange(r,n,o,s){if(await r.get(De).isCopilotIgnored(n.uri))return;let c=r.get(_t).getTreeSitterAST(n);if(c===void 0)return;let u=Xi(o,n),l;s&&(l=await c.getNodeToExplain(u)),l??=await c.getNodeToDocument(u);let{startIndex:d,endIndex:p}="nodeToDocument"in l?l.nodeToDocument:l.nodeToExplain,f=Ps(n,{startIndex:d,endIndex:p});return{identifier:l.nodeIdentifier,text:n.getText(f),range:f,uri:n.uri,startIndex:d,endIndex:p}}static async getSelectedScope(r,n){let o=r.get(De);if(!n.document||await o.isCopilotIgnored(n.document.uri))return;let s=Ts.getSymbolAtCursor(r,n),a,c=s?await Ts.getDefinitionAtRange(r,s.document,s.range,!1):void 0;if(r.get(be).getConfig(ge.ExplainScopeSelection)||s&&(c?.identifier!==s.selectedText||!s.selectedText)){let l=r.get(Tt).activeTextEditor;if(!l)return;let d=await r.get(sh).selectEnclosingScope(l,{reason:yM.t("Select an enclosing range to explain"),includeBlocks:!0});if(d){let p=l.document,f=p.getText(d);if(!f)return;a={codeAtCursor:f,document:p,range:d,definitions:[],references:[]}}}return{symbolAtCursorState:a,definition:c,symbolAtCursor:s}}async prepare(r,n,o){let s=await Ts.getSelectedScope(this.accessor,this.props).catch(()=>{});if(!s)return;let{symbolAtCursorState:a,definition:c,symbolAtCursor:u}=s;if(u){c?.identifier===u?.selectedText?a??={codeAtCursor:c.text,document:u.document,range:c.range,definitions:[],references:[]}:a??={codeAtCursor:u.document.lineAt(u.range.start).text,document:u.document,range:u.document.lineAt(u.range.start).range,definitions:[],references:[]},n.report(new Wi(yM.t("Searching for relevant definitions...")));try{for(let l of await this._languageFeaturesService.getDefinitions(u.document.uri,u.range.start)){let{uri:d,range:p}=Hp(l)?{uri:l.targetUri,range:l.targetRange}:l;if(p.isEqual(u.range))continue;let f=await this._workspaceService.openTextDocument(d),m=await Ts.getDefinitionAtRange(this.accessor,f,p,!0);m&&a.definitions.push(m)}}catch{}n.report(new Wi(yM.t("Searching for relevant references...")));try{let l=new Set;for(let d of await this._languageFeaturesService.getReferences(u.document.uri,u.range.start)){let{uri:p,range:f}=Hp(d)?{uri:d.targetUri,range:d.targetRange}:d;if(f.isEqual(u.range))continue;let m=`${p.toString()}-${f.start.line}-${f.start.character}-${f.end.line}-${f.end.character}`;if(l.has(m))continue;l.add(m);let h=await this._workspaceService.openTextDocument(p),g=await Ts.getDefinitionAtRange(this.accessor,h,f,!1);g&&a.references.push(g)}}catch{}return a}}render(r,n){if(!r)return;let o=[...r.definitions,...r.references];if(r.codeAtCursor){let{startIndex:c,endIndex:u}=Xi(r.range,r.document);o.push({version:r.document.version,uri:r.document.uri,range:r.range,text:r.codeAtCursor,startIndex:c,endIndex:u})}let{usedContext:s,references:a}=oJ(r.document,o);return vscpp(vscppf,null,vscpp("usedContext",{value:s}),vscpp("references",{value:a}),vscpp(QEe.UserMessage,null,"I have the following  code in the active editor:",vscpp("br",null),vscpp(Oe,{uri:r.document.uri,languageId:r.document.languageId,code:r.codeAtCursor}),vscpp("br",null),!!r.definitions.length&&vscpp(vscppf,null,"Here are some relevant definitions for the symbols in my code:",vscpp("br",null)),!!r.definitions.length&&vscpp(NI.PrioritizedList,{priority:this.props.priority,descending:!0},r.definitions.map(c=>vscpp(Oe,{uri:r.document.uri,languageId:r.document.languageId,code:c.text}))),!!r.references.length&&vscpp(vscppf,null,vscpp("br",null),"Here are some places where the the symbols in my code are referenced:",vscpp("br",null)),!!r.references.length&&vscpp(NI.PrioritizedList,{priority:this.props.priority-r.definitions.length,descending:!0},r.references.map(c=>vscpp(vscppf,null,!!c.uri&&vscpp(vscppf,null,"From the file ",rP(c.uri.toString()),":",vscpp("br",null)),vscpp(Oe,{uri:r.document.uri,languageId:r.document.languageId,code:c.text}),vscpp("br",null))))))}};Ts=B([T(2,Di),T(3,Ze)],Ts);var CC=class extends Y{constructor(r,n,o){super(r,n);this.languageService=o}async prepare(){let r=!1,{document:n,selection:o}=this.props;return n?.uri&&o&&(r=this.languageService.getDiagnostics(n.uri).filter(u=>!!u.range.intersection(o)).filter(u=>u.severity<=R_.Warning).length>0),{explainingDiagnostic:r}}render(r,n){let o=this.props.chatVariables.find(s=>s.name===Wr.variableInfo.name);return vscpp(vscppf,null,vscpp(XEe.SystemMessage,{priority:1e3},"You are a world-class coding tutor. Your code explanations perfectly balance high-level concepts and granular details. Your approach ensures that students not only understand how to write code, but also grasp the underlying principles that guide effective programming.",vscpp("br",null),vscpp($r,null),vscpp(fi,null),vscpp(po,null),vscpp(lr,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"Think step by step:",vscpp("br",null),"1. Examine the provided code selection and any other context like user question, related errors, project details, class definitions, etc.",vscpp("br",null),"2. If you are unsure about the code, concepts, or the user's question, ask clarifying questions.",vscpp("br",null),"3. If the user provided a specific question or error, answer it based on the selected code and additional provided context. Otherwise focus on explaining the selected code.",vscpp("br",null),"4. Provide suggestions if you see opportunities to improve code readability, performance, etc.",vscpp("br",null),vscpp("br",null),"Focus on being clear, helpful, and thorough without assuming extensive prior knowledge.",vscpp("br",null),"Use developer-friendly terms and analogies in your explanations.",vscpp("br",null),"Identify 'gotchas' or less obvious parts of the code that might trip up someone new.",vscpp("br",null),"Provide clear and relevant examples aligned with any provided context."),this.props.history&&vscpp(vscppf,null,vscpp(qt,{priority:600,history:this.props.history})),vscpp(Qo,{priority:700}),!o&&vscpp(Wr,{document:this.props.document,range:this.props.selection,priority:900}),vscpp(Nu,{document:this.props.document,range:this.props.selection,priority:800}),!r.explainingDiagnostic&&vscpp(Ts,{document:this.props.document,selection:this.props.selection,priority:800}),vscpp(ti,{priority:900,chatVariables:this.props.chatVariables,query:this.props.query}))}};CC=B([T(2,Di)],CC);var xM="Write an explanation for the active selection as paragraphs of text.",bM=class extends Yo{constructor(r,n,o,s){super(n,o,s);this.accessor=r}createRenderer(r,n,o,s,a,c){let l=r.getLatestTurn().request.message,d=r.turns.length>1?r.turns.slice(0,-1):[],p=this.accessor.get(Tt).activeTextEditor;return new Xe(n,CC,{query:l,history:d,chatVariables:o,document:p?.document,selection:p?.selection},this.accessor.get(ve).acquireTokenizer(n.family),this.accessor)}},sJ=class extends bM{constructor(){super(...arguments);this.createReplyInterpreter=P8.createFactory()}async buildPrompt(r,n,o,s,a){let c=r.getLatestTurn();return c?.request.message===""&&(c.request={message:xM,type:"user"}),super.buildPrompt(r,n,o,s,a)}},_M=class{constructor(){this.id="explain";this.locations=[2,1];this.description=JEe.t("Explain how the code in your active editor works")}static{this.ID="explain"}get intentDetectionInput(){let e="explain_code_or_error";return{functionName:e,sampleQuestion:"Write an explanation for the code above as paragraphs of text.",functionCallingBlurb:`If the user's message asks for an explanation of code blocks or an error message, you should use the '${e}' function.`}}async invoke(e,r){let n=r.location,o=e.get(Le),s=await Mn(o,n);return n===1?new sJ(e,this,n,s):new bM(e,this,n,s)}async asSlashCommand(e,r){return{name:this.id,description:this.description}}};var nwe=W(Tr());var TM=W(ct());var IM=W(Tr()),kC=W(ct());var SM=W(ct());var aJ=class extends Y{render(e,r){return vscpp(vscppf,null,this.props.history&&vscpp(qt,{priority:500,history:this.props.history}),vscpp(SM.SystemMessage,{priority:1e3},"You are a coding assistant who help the user answer questions about code in their workspace by providing a list of relevant keywords they can search for to answer the question.",vscpp("br",null),"The user will provide you with potentially relevant information from the workspace. This information may be incomplete.",vscpp("br",null),"Respond in Markdown. First under a `# Question` header, output a rephrased version of the user's question that resolves all pronouns and ambiguous words like 'this' to the specific nouns they stand for.",vscpp("br",null),"Then under a `# Keywords` header, output a short markdown list of up to 8 relevant keywords that the user can search for to answer the question. You may include variations after each keyword.",vscpp("br",null),"DO NOT ask the user for additional information or clarification.",vscpp("br",null),"DO NOT answer the user's question directly.",vscpp("br",null),vscpp("br",null),"# Additional Rules",vscpp("br",null),vscpp("br",null),"Think step by step:",vscpp("br",null),"1. Read the user's question to understand what they are asking about their workspace.",vscpp("br",null),"2. If the question contains pronouns such as 'it' or 'that', try to understand what the pronoun refers to by looking at the rest of the question and the conversation history.",vscpp("br",null),"3. If the question contains an ambiguous word such as 'this', try to understand what is refers to by looking at the rest of the question, the user's active selection, and the conversation history.",vscpp("br",null),"4. After a `# Question` header, output a precise version of question that resolves all pronouns and ambiguous words like 'this' to the specific nouns they stand for. Be sure to preserve the exact meaning of the question by only changing ambiguous pronouns and words like 'this'.",vscpp("br",null),"5. Then after a `# Keywords` header, output a short markdown list of up to 8 relevant keywords that user could try searching for to answer their question. These keywords could used as file name, symbol names, abbreviations, or comments in the relevant code. Put the keywords most relevant to the question first. Do not include overly generic keywords. Do not repeat keywords.",vscpp("br",null),"6. For each keyword in the markdown list of related keywords, if applicable add a comma separated list of variations after it. For example: for 'encode' possible variations include 'encoding', 'encoded', 'encoder', 'encoders'. Consider synonyms and plural forms. Do not repeat variations.",vscpp("br",null),vscpp("br",null),"Examples",vscpp("br",null),vscpp("br",null),"User: Where's the code for base64 encoding?",vscpp("br",null),vscpp("br",null),"Assistant:",vscpp("br",null),"# Question",vscpp("br",null),"Where's the code for base64 encoding?",vscpp("br",null),vscpp("br",null),"# Keywords",vscpp("br",null),"- base64 encoding, base64 encoder, base64 encode",vscpp("br",null),"- base64, base 64",vscpp("br",null),"- encode, encoded, encoder, encoders"),vscpp(Wr,{priority:600,document:this.props.document,range:this.props.selection}),this.props.fileTree&&vscpp(SM.UserMessage,{priority:700},this.props.fileTree),vscpp(ti,{priority:1e3,chatVariables:this.props.chatVariables,query:this.props.query}))}};async function ZEe(t,e,r,n,o,s){let a=e.turns.length>1?e.turns.slice(0,-1):[],c=t.get(Tt).activeTextEditor;return new Xe(r,aJ,{chatVariables:n,query:o,history:a,fileTree:s,document:c?.document,selection:c?.selection},t.get(ve).acquireTokenizer(r.family),t).render()}var QZe=/^[\*\-]\s*(.+)/m;function TC(t,e){let r=e.match(/#+\s*Question\n(?<question>.+?)#+\s*Keywords\n(?<keywords>.+)/si);if(!r?.groups)return{rephrasedQuestion:t.trim(),keywords:[]};let n=[];for(let o of r.groups.keywords.trim().split(`
`)){let s=o.match(QZe);if(s){let a=s[1].split(/,/g).map(c=>c.trim());a.length&&n.unshift({keyword:a[0],variations:a.slice(1)})}}return{rephrasedQuestion:r.groups.question.trim(),keywords:n}}function ewe(t){return t.reduce((r,n)=>r+n.value.length,0)+Math.max(0,t.length-1)}async function JZe(t,e=1/0,r){let n=twe(0,t,e),o=e-ewe(n);for(;;){let s=!1,a=[];for(let c of n)if(c.type==="text")a.push(c);else if(c.type==="dir"){a.push({type:"text",value:c.value});let u=await c.getChildren();if(r?.isCancellationRequested)return"";let l=twe(c.level+1,u,o-1);l.length&&(s=!0,o-=ewe(l)+1,a.push(...l))}if(n=a,!s)break}return n.map(s=>s.value).join(`
`)}function twe(t,e,r){let n="	".repeat(t),o=[],s=r;for(let a=0;a<e.length;++a){let c=e[a],u=n+c.name+(c.type===2?"/":"");if(u.length>s){let l=n+"...";for(;l.length>s&&o.length>0;)s+=o.pop().value.length+1;l.length<=s&&o.push({type:"text",value:l});break}c.type===2?o.push({type:"dir",level:t,value:u,getChildren:c.getChildren}):o.push({type:"text",value:u}),s-=u.length,a!==e.length-1&&(s-=1)}return o}async function cJ(t,e,r,n){let o=t.get(on),s=t.get(De);async function a(u){let l;try{l=await o.readDirectory(u)}catch(d){return console.error(d),[]}return n.isCancellationRequested?[]:(l.sort((d,p)=>d[0].localeCompare(p[0])),Promise.all(l.map(async d=>{let p=lt.joinPath(u,d[0]);return Cb(p)&&!await s.isCopilotIgnored(p)?d:null})).then(d=>d.filter(p=>p!==null).map(p=>p[1]===2?{type:2,name:p[0],getChildren:()=>a(lt.joinPath(u,p[0]))}:{type:1,name:p[0]})))}if(await s.init(),n.isCancellationRequested)return"";let c=await a(e);return n.isCancellationRequested?"":JZe(c,r,n)}async function O2(t,e=500,r){let n=t.get(Ze).getWorkspaceFolders().at(0);if(!n)return;let o=await cJ(t,n,e,r);return ZZe("I am working in a workspace that has the following structure:","",ki("",o))}var EC=class extends Y{constructor(r,n,o,s,a,c){super(r,n);this.ignoreService=s;this.languageFeaturesService=a;this.workspaceService=c;this.timeout=15e3;this.logger=o.getLogger("<WorkspaceSymbols>")}async prepare(r,n,o){let s=await y0(this.accessor,{valueFor4096:8,maxMultiplier:4});if(o.isCancellationRequested)return[];let a=await this.getSymbols(o);return!a.length||o.isCancellationRequested?[]:rwe(a.map(c=>`- ${c.name} \u2014 ${Kg(this.workspaceService,c.location.uri)}`)).slice(0,s)}render(r,n){if(r.length)return vscpp(kC.TextChunk,{priority:this.props.priority},"Here are some potentially relevant symbols from the current workspace:",vscpp("br",null),r.join(`
`))}async getSymbols(r){let n=await this.props.query.resolve(r);if(!n||r.isCancellationRequested)return[];let o=await Promise.all(n.keywords.flatMap(a=>[a.keyword,...a.variations]).map(a=>d0(this.languageFeaturesService.getWorkspaceSymbols(a),this.timeout)));if(r.isCancellationRequested)return[];let s=await Promise.all(o.flat().map(async a=>(a?await this.ignoreService.isCopilotIgnored(a.location.uri):!1)?null:a));return Kt(s).filter(Boolean)}};B([bi(r=>r.logger)],EC.prototype,"prepare",1),EC=B([T(2,ce),T(3,De),T(4,Di),T(5,Ze)],EC);var wC=class extends Y{constructor(r,n,o,s,a){super(r,n);this.searchService=s;this.workspaceService=a;this.timeout=15e3;this.logger=o.getLogger("<WorkspaceFiles>")}async prepare(r,n,o){let s=await y0(this.accessor,{valueFor4096:8,maxMultiplier:4});if(o.isCancellationRequested)return[];let a=await this.findFiles(s,o);return!a.length||o.isCancellationRequested?[]:rwe(a.map(c=>`- ${Kg(this.workspaceService,c)}`)).slice(0,s)}render(r,n){if(r.length)return vscpp(kC.TextChunk,{priority:this.props.priority},"Here are some potentially relevant file names from the workspace:",vscpp("br",null),r.join(`
`))}async findFiles(r,n){let o=await this.props.query.resolve(n);if(!o||n.isCancellationRequested)return[];let s=await d0(this.searchService.findFilesWithDefaultExcludes(`{${o.keywords.flatMap(a=>[a.keyword,...a.variations]).map(a=>`**/*${a}*`).join(",")}}`,r,n),this.timeout);return s?s.sort((a,c)=>a.toString().localeCompare(c.toString())):[]}};B([bi(r=>r.logger)],wC.prototype,"prepare",1),wC=B([T(2,ce),T(3,Aa),T(4,Ze)],wC);var lm=class extends Y{constructor(r,n,o,s,a,c){super(r,n);this.telemetryService=s;this.workspaceChunkSearch=a;this.workspaceService=c;this.logger=o.getLogger("<WorkspaceChunks>")}async prepare(r,n,o=Fr.None){let s=await y0(this.accessor,{valueFor4096:4,maxMultiplier:4});if(o.isCancellationRequested)return;let a=(await this.workspaceChunkSearch.searchFileChunks(r.endpoint,this.props.query,this.props.maxResults??s,{include:this.props.include},o,l=>n?.report(new Wi(l)))).slice(0,s);if(o.isCancellationRequested||!a.length)return;let c=new Pn;for(let l of a){let d=c.get(l.file)??[];l.isFullFile?d=[l]:d.some(p=>p.isFullFile||p.range.containsRange(l.range))||(d=[...d.filter(p=>!l.range.containsRange(p.range)),l]),c.set(l.file,d)}let u=Array.from(c.values()).flatMap(l=>l.sort((d,p)=>gt.compareRangesUsingStarts(d.range,p.range)).map(d=>new Eo.PromptReference(d.isFullFile?d.file:new yi(d.file,Zm(d.range)))));return{chunks:a,references:u}}render(r,n){if(r)return vscpp(vscppf,null,vscpp("references",{value:r.references}),r.chunks.map((o,s)=>{let a=typeof this.props.priority<"u"?this.props.priority+(1-(s+1)/r.chunks.length):void 0;return{chunk:o,priority:a}}).reverse().map(({chunk:o,priority:s})=>{let a=Kg(this.workspaceService,o.file);return vscpp(kC.TextChunk,{priority:s},"Here is a potentially relevant code excerpt ",o.isFullFile?`starting at line ${o.range.startLineNumber} `:"","in `",a,"`:",vscpp("br",null),ki(U6(o.file),o.text))}))}};B([bi(r=>r.logger),x0(function(r,n){this.telemetryService.sendMSFTTelemetryEvent("workspaceContext.perf.prepareWorkspaceChunks",{status:n},{execTime:r})})],lm.prototype,"prepare",1),lm=B([T(2,ce),T(3,me),T(4,iv),T(5,Ze)],lm);function rwe(t){return[...new Set(t)]}function ZZe(...t){return t.join(`
`)}var L2=class extends Y{constructor(r,n,o){super(r,n);this.workspaceService=o}async prepare(r,n,o){let s=this.workspaceService.getWorkspaceFolders().at(0);return s?cJ(this.accessor,s,500,o):void 0}render(r,n){if(r)return vscpp(vscppf,null,"I am working in a workspace that has the following structure:",vscpp("br",null),vscpp("br",null),ki("",r))}};L2=B([T(2,Ze)],L2);var Pv=class extends Y{constructor(r,n,o,s,a,c){super(r,n);this.chatFetcher=s;this.telemetryService=a;this.tokenizerProvider=c;this.logger=o.getLogger("workspaceResolver")}async prepare(r,n,o){n?.report(new Wi(IM.t("Deciding which workspace information to collect")));let s=this.props.query;if(!s)return;let a=(async()=>{this.logger.debug("Determining workspace structure...");let c=await O2(this.accessor,1e3,o);if(o.isCancellationRequested)return;this.logger.debug("Asking the model to update the user question and provide queries...");let{messages:u}=await ZEe(this.accessor,this.props.conversation,r.endpoint,this.props.chatVariables,s,c);if(o.isCancellationRequested)return;let l=this.tokenizerProvider.acquireTokenizer(r.endpoint.family).tokenLength(s),p=await this.chatFetcher.fetchOne(u,async h=>{},o,2,r.endpoint,{agent:Up},{temperature:0,top_p:1,stop:["dontStopBelieving"],max_tokens:l+200},{messageSource:"workspaceIntent"});if(o.isCancellationRequested)return;let f;if(p.type!=="success")if(this.telemetryService.sendMSFTTelemetryEvent("workspaceResolver.error",{type:p.type,reason:p.reason,requestId:p.requestId}),p.type==="length")f=p.truncatedValue;else throw new Error(IM.t("Encountered an error while deciding what workspace information to collect: ({0}) {1}",p.type,p.reason));else f=p.value;let m=TC(s,f);return this.telemetryService.sendMSFTTelemetryEvent("workspaceResolver.success",{type:p.type,requestId:p.requestId},{totalKeywordCount:m.keywords.flatMap(h=>[h.keyword,h.variations]).length}),this.logger.debug("Running all tools..."),n?.report(new Wi(IM.t("Collecting workspace information"))),{rephrasedQuery:m.rephrasedQuestion,keywords:m.keywords}})();return{rawQuery:s,resolve:()=>a,maySkipResolve:()=>!/\b(it|that|this)\b/i.test(s)}}render(r,n){if(!r)return;let o=this.props.include??{workspaceStructure:!0,workspaceSymbols:!0,workspaceFiles:!0,workspaceChunks:!0};return vscpp(vscppf,null,o.workspaceStructure&&vscpp(L2,{...this.props}),o.workspaceSymbols&&vscpp(EC,{priority:this.props.priority,query:r}),o.workspaceFiles&&vscpp(wC,{priority:this.props.priority,query:r}),o.workspaceChunks&&vscpp(lm,{priority:this.props.priority,query:r}))}};B([x0(function(r,n){this.telemetryService.sendMSFTTelemetryEvent("workspaceContext.perf.prepare",{status:n},{execTime:r})})],Pv.prototype,"prepare",1),Pv=B([T(2,ce),T(3,jt),T(4,me),T(5,ve)],Pv);var RC=class extends Y{render(e,r){return vscpp(kC.UserMessage,null,vscpp(Pv,{...this.props}))}};var CM=class extends Y{render(e,r){return vscpp(vscppf,null,vscpp(TM.SystemMessage,{priority:1e3},"You are a software engineer with expert knowledge of the codebase the user has open in their workspace.",vscpp("br",null),vscpp("br",null),vscpp($r,null),vscpp(ir,null),vscpp(po,null),vscpp(lr,null),"# Additional Rules",vscpp("br",null),"Think step by step:",vscpp("br",null),"1. Read the provided relevant workspace information (code excerpts, file names, and symbols) to understand the user's workspace.",vscpp("br",null),"2. Consider how to answer the user's prompt based on the provided information and your specialized coding knowledge. Always assume that the user is asking about the code in their workspace instead of asking a general programming question. Prefer using variables, functions, types, and classes from the workspace over those from the standard library.",vscpp("br",null),"3. Generate a response that clearly and accurately answers the user's question. In your response, add fully qualified links for referenced symbols (example: [`namespace.VariableName`](path/to/file.ts)) and links for files (example: [path/to/file](path/to/file.ts)) so that the user can open them. If you do not have enough information to answer the question, respond with \"I'm sorry, I can't answer that question with what I currently know about your workspace\".",vscpp("br",null),vscpp("br",null),"DO NOT mention that you cannot read files in the workspace.",vscpp("br",null),"DO NOT ask the user to provide additional information about files in the workspace.",vscpp("br",null),"Remember that you MUST add links for all referenced symbols from the workspace and fully qualify the symbol name in the link, for example: [`namespace.functionName`](path/to/util.ts).",vscpp("br",null),"Remember that you MUST add links for all workspace files, for example: [path/to/file.js](path/to/file.js)",vscpp("br",null),vscpp("br",null),"# Examples",vscpp("br",null),"Question:",vscpp("br",null),"What file implements base64 encoding?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"Base64 encoding is implemented in [src/base64.ts](src/base64.ts) as [`encode`](src/base64.ts) function.",vscpp("br",null),vscpp("br",null),vscpp("br",null),"Question:",vscpp("br",null),"How can I join strings with newlines?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"You can use the [`joinLines`](src/utils/string.ts) function from [src/utils/string.ts](src/utils/string.ts) to join multiple strings with newlines.",vscpp("br",null),vscpp("br",null),vscpp("br",null),"Question:",vscpp("br",null),"How do I build this project?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"To build this TypeScript project, run the `build` script in the [package.json](package.json) file:",vscpp("br",null),vscpp("br",null),"```sh",vscpp("br",null),"npm run build",vscpp("br",null),"```",vscpp("br",null),vscpp("br",null),vscpp("br",null),"Question:",vscpp("br",null),"How do I read a file?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"To read a file, you can use a [`FileReader`](src/fs/fileReader.ts) class from [src/fs/fileReader.ts](src/fs/fileReader.ts).",vscpp("br",null)),this.props.history&&vscpp(vscppf,null,vscpp(qt,{priority:400,history:this.props.history})),vscpp(Wr,{document:this.props.document,range:this.props.selection,priority:600}),vscpp(TM.UserMessage,null,vscpp(Pv,{priority:800,...this.props})),vscpp(ti,{priority:900,chatVariables:this.props.chatVariables,query:this.props.query}))}};var M2="workspace",uJ=class extends Yo{constructor(r,n,o,s){super(n,o,s);this.accessor=r}createRenderer(r,n,o,s,a,c){let l=r.getLatestTurn().request.message,d=r.turns.length>1?r.turns.slice(0,-1):[],p=this.accessor.get(Tt).activeTextEditor;return new Xe(n,CM,{chatVariables:o,conversation:r,query:l,history:d,document:p?.document,selection:p?.selection},this.accessor.get(ve).acquireTokenizer(n.family),this.accessor)}},EM=class t{constructor(){this.id=t.ID;this.description=nwe.t("Ask a question about the files in your current workspace");this.locations=[2];this.commandInfo={allowsEmptyArgs:!1,defaultEnablement:!0}}static{this.ID=M2}get intentDetectionInput(){let e="workspace_questions";return{functionName:e,sampleQuestion:"How do I build this project?",functionCallingBlurb:`If the user's message is about files in the current project, repository, or workspace, you should use the '${e}' function.`}}async invoke(e,r){let n=r.location,o="gpt-3.5-turbo";n===2&&(o="gpt-4");let s=await e.get(Le).getChatEndpoint(o);return new uJ(e,this,n,s)}};var swe=W(Tr());var owe=W(ct());var iwe=W(ct());var Kr=class extends Y{constructor(r,n,o,s){super(r,n);this.ignoreService=o;this.tokenizerProvider=s}async prepare(r){let n=this.tokenizerProvider.acquireTokenizer(r.endpoint.family),o=[];for(let l of this.props.input)await this.ignoreService.isCopilotIgnored(l.document.uri)||o.push(l);let s=o.map(l=>{let{document:d,change:p,selection:f}=l,m;if(p?.hunks.length){let h=p.hunks[0];m=[h.range.start.line>0?Kr.enumeratedLines(d,0,h.range.start.line):"",...p.hunks.map((g,v,y)=>{let _=v+1<y.length?y[v+1].range.start.line:d.lineCount;return[Kr.enumeratedChangeLines(g.text,g.range.start.line),`
`,g.range.end.line<_?Kr.enumeratedLines(d,g.range.end.line,_):""]}).flat()].join("")}else if(f){let h=f.end.line+(f.end.character>0?1:0);m=Kr.enumeratedSelectedLines(d,0,d.lineCount,f.start.line,h)}else m=Kr.enumeratedLines(d,0,d.lineCount);return{input:l,hunks:[{range:new ze(0,0,l.document.lineCount,0),text:m}],tokens:n.tokenLength(m)}}),a=s.reduce((l,{tokens:d})=>l+d,0),c=this.props.logService.getLogger("CurrentChange");if(c.info(`Full documents: ${a} tokens, ${r.tokenBudget} budget`),a<=r.tokenBudget)return{input:s.map(({input:l,hunks:d})=>({input:l,hunks:d}))};let u=s.slice().sort((l,d)=>d.tokens-l.tokens);for(let l of u){let{input:d,tokens:p}=l,{document:f,change:m,selection:h}=d;if(m?.hunks.length){let g=[],v=0;for(let y of m.hunks){let _=await Ts.getDefinitionAtRange(this.accessor,f,y.range,!1);if(_){let b=_.range.end.line+(_.range.end.character>0?1:0),S=y.range.end.line+(y.range.end.character>0?1:0),I=[y.range.start.line>_.range.start.line?Kr.enumeratedLines(f,_.range.start.line,y.range.start.line):"",Kr.enumeratedChangeLines(y.text,y.range.start.line),`
`,b>S?Kr.enumeratedLines(f,S,b):""].join("");g.push({range:new ze(Math.min(y.range.start.line,_.range.start.line),0,Math.max(b,S),0),text:I}),v+=n.tokenLength(I)}else{let b=Kr.enumeratedChangeLines(y.text,y.range.start.line),S=y.range.end.line+(y.range.end.character>0?1:0);g.push({range:new ze(y.range.start.line,0,S,0),text:b}),v+=n.tokenLength(b)}}l.hunks=g,l.tokens=v,a+=l.tokens-p}else if(h){let g=await Ts.getDefinitionAtRange(this.accessor,f,h,!1);if(g){let v=g.range.end.line+(g.range.end.character>0?1:0),y=h.end.line+(h.end.character>0?1:0),_=Kr.enumeratedSelectedLines(f,g.range.start.line,v,h.start.line,y),b=n.tokenLength(_);l.hunks=[{range:g.range,text:_}],l.tokens=b,a+=l.tokens-p}else{let v=h.end.line+(h.end.character>0?1:0),y=Kr.enumeratedSelectedLines(f,h.start.line,v,h.start.line,v);l.hunks=[{range:new ze(h.start.line,0,v,0),text:y}],l.tokens=n.tokenLength(y),a+=l.tokens-p}}else l.hunks=[],l.tokens=0,a+=l.tokens-p;if(c.info(`Reduced ${d.relativeDocumentPath} to defintions: ${a} tokens, ${r.tokenBudget} budget`),a<=r.tokenBudget)return{input:s.map(({input:g,hunks:v})=>({input:g,hunks:v}))}}return c.info(`Still too large: ${a} tokens, ${r.tokenBudget} budget`),{input:s.map(({input:l,hunks:d})=>({input:l,hunks:d}))}}render(r,n){let o=r.input.filter(a=>a.hunks.length>0);if(!o.length)return;let s=o.map(({input:a,hunks:c})=>({uri:a.document.uri,version:a.document.version,ranges:c.map(u=>u.range)}));return vscpp(vscppf,null,vscpp("usedContext",{value:s}),vscpp(iwe.UserMessage,{priority:this.props.priority},o.map(a=>vscpp(vscppf,null,a.input.change?vscpp(vscppf,null,"Change at cursor:",vscpp("br",null),vscpp("br",null),"Changes are indicated by lines starting with + and -. Each line is annotated with the line number in the file.",vscpp("br",null)):vscpp(vscppf,null,"Current selection with the selected lines labeled as such:",vscpp("br",null)),vscpp("br",null),"From the file: ",a.input.relativeDocumentPath,vscpp("br",null),a.hunks.map(c=>vscpp(L8,{uri:a.input.document.uri,range:c.range,code:c.text,languageId:`${a.input.document.languageId}/${a.input.relativeDocumentPath}: FROM_LINE: ${c.range.start.line+1} - TO_LINE: ${c.range.end.line}`})),vscpp("br",null),vscpp("br",null)))))}static async getCurrentChanges(r,n){let s=r.get(ka).getExtensionApi();return s?(await Promise.all(s.repositories.map(async c=>{let u=await(n==="index"?c.diffIndexWithHEAD():c.diffWithHEAD());return await Promise.all(u.map(async d=>{let p=await(n==="index"?c.diffIndexWithHEAD(d.uri.fsPath):c.diffWithHEAD(d.uri.fsPath));return{repository:c,uri:d.uri,hunks:Kr.parseDiff(p).map(f=>Kr.gitHunkToHunk(f))}}))}))).flat():[]}static async getCurrentChange(r,n,o){let a=r.get(ka).getExtensionApi();if(!a)return;let c=a.getRepository(n.uri);if(!c)return;let u=await c.diffWithHEAD(n.uri.fsPath);if(!u)return;let d=Kr.parseDiff(u).find(p=>p.additions.some(f=>{let m=f.start-1,h=m+f.length-1;return o.line>=m&&o.line<=h}));if(d)return{repository:c,uri:n.uri,hunks:[Kr.gitHunkToHunk(d)]}}static async getChanges(r,n,o,s){let c=r.get(ka).getExtensionApi();if(!c)return;let u=Kr.parseDiff(s),l=c.repositories.find(d=>d.rootUri.toString().toLowerCase()===n.toString().toLowerCase());if(l)return{repository:l,uri:o,hunks:u.map(d=>Kr.gitHunkToHunk(d))}}static gitHunkToHunk(r){return{range:new ze(r.startAddedLine-1,0,r.startAddedLine-1+r.addedLines,0),text:r.diffText}}static parseDiff(r){let n=r.split(`
@@`);return n.length&&n[n.length-1].endsWith(`
`)&&(n[n.length-1]=n[n.length-1].slice(0,-1)),n.map(s=>{let a=s.match(/-(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))?/);if(a){let c=parseInt(a[1]),u=a[2]?parseInt(a[2]):1,l=parseInt(a[3]),d=a[4]?parseInt(a[4]):1,p=[],f=s.split(`
`).slice(1),m=0,h;for(let g of f){let v=g.charAt(0);v==="+"?(h===void 0&&(h=l+m),m++):(h!==void 0&&(p.push({start:h,length:l+m-h}),h=void 0),v===" "&&m++)}return h!==void 0&&(p.push({start:h,length:l+m-h}),h=void 0),{startDeletedLine:c,deletedLines:u,startAddedLine:l,addedLines:d,additions:p,diffText:f.join(`
`)}}return null}).filter(Boolean)}static enumeratedLines(r,n,o){return r.getText(new ze(n,0,o,0)).split(`
`).map((c,u)=>`/* Line ${n+u+1} */${c}`).join(`
`)}static enumeratedSelectedLines(r,n,o,s,a){return r.getText(new ze(n,0,o,0)).split(`
`).map((l,d)=>{let p=n+d;return`/* ${s<=p&&p<a?"Selected ":""}Line ${p+1} */${l}`}).join(`
`)}static enumeratedChangeLines(r,n){let o=0;return r.split(`
`).filter(a=>a[0]!=="-").map((a,c)=>{let u=a.substring(0,1),l=u==="-";return l&&o++,`${u}/* ${l?"Removed Line":`Line ${n+c-o+1}`} */${a.substring(1)}`}).join(`
`)}};Kr=B([T(2,De),T(3,ve)],Kr);var AC=class extends Y{render(e,r){return vscpp(vscppf,null,vscpp(owe.SystemMessage,{priority:1001},"You are a world-class software engineer and the author and maintainer of the discussed code. Your feedback prefectly combines detailed feedback and explanation of context.",vscpp("br",null),vscpp($r,null),vscpp(ir,null),vscpp(po,null),vscpp(lr,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"Think step by step:",vscpp("br",null),"1. Examine the provided code and any other context like user question, related errors, project details, class definitions, etc.",vscpp("br",null),"2. Provide feedback on the current ",this.props.input[0]?.change?vscpp(vscppf,null,"change"):vscpp(vscppf,null,"selection")," on where it can be improved or introduces a problem.",vscpp("br",null),"2a. Avoid commenting on correct code.",vscpp("br",null),"2b. Avoid commenting on commented out code.",vscpp("br",null),"2c. Keep scoping rules in mind.",vscpp("br",null),"3. Reply with an enumerated list of feedback with source line number, filepath, kind (bug, performance, consistency, documentation, other), severity (low, medium, high), and feedback text.",vscpp("br",null),"3a. E.g.: 1. Line 357 in src/flow.js, bug, high severity: `i` is not incremented.",vscpp("br",null),"3b. E.g.: 2. Line 361 in src/arrays.js, documentation, low severity: Function `binarySearch` is not documented.",vscpp("br",null),"3c. E.g.: 3. Line 376 in src/binary-search.js, documentation, medium severity: Function `binarySearch` assumes that the input array `arr` is sorted. This assumption should be documented or checked.",vscpp("br",null),"3d. E.g.: 4. Line 410 in src/search.js, documentation, medium severity: Returning `-1` when the target is not found is a common convention, but it should be documented.",vscpp("br",null),"3e. E.g.: 5. Line 220 in src/account.py, bug, high severity: The deposit method is not thread-safe. You should use a lock to ensure that the balance update is an atomic operation.",vscpp("br",null),'4. When there is no feedback to provide, reply with "No feedback to provide."',vscpp("br",null),vscpp("br",null),"Focus on being clear, helpful, and thorough.",vscpp("br",null),"Use developer-friendly terms and analogies in your explanations.",vscpp("br",null),"Provide clear and relevant examples when helpful."),vscpp(Qo,{priority:700}),vscpp(Kr,{input:this.props.input,logService:this.props.logService,priority:1e3,flexGrow:1}),this.props.input.map(n=>vscpp(Nu,{document:n.document,range:n.selection,priority:800})),this.props.chatVariables&&this.props.query&&vscpp(ti,{priority:900,chatVariables:this.props.chatVariables,query:this.props.query}))}};var PC=class{constructor(e,r){this.accessor=e;this.telemetryService=e.get(me),this.options=e.get($n),this.tokenizerProvider=e.get(ve),this.endpointProvider=this.accessor.get(Le),this.fetcher=this.accessor.get(jt),this.logService=this.accessor.get(ce);let n=this.accessor.get(or);this.chatLogger=r&&n.createInstance(Dc,()=>r())}async generateComments(e,r,n){let o=Date.now(),s=this.accessor.get(ce).getLogger("FeedbackGenerator"),a=this.accessor.get(De),c=await Promise.all(e.map(_=>a.isCopilotIgnored(_.document.uri))),u=e.filter((_,b)=>!c[b]);if(u.length===0)return s.info("All input documents are ignored. Skipping feedback generation."),{type:"error",severity:"info",reason:swe.t("All input documents are ignored by configuration. Check your .copilotignore file.")};let l=await this.endpointProvider.getChatEndpoint("gpt-4"),p=await new Xe(l,AC,{input:u,logService:this.logService},this.tokenizerProvider.acquireTokenizer(l.family),this.accessor).render();this.chatLogger?.logMessages(p.messages);let f={messageId:Br(),inputType:u[0]?.selection?"selection":"change",inputRanges:u.map(_=>({uri:_.document.uri,ranges:_.selection?[_.selection]:_.change?.hunks.map(b=>b.range)||[]}))},m=[],h=n?async _=>{let b=F2(f,u,_,!0);b.length>m.length&&(n.report(b.slice(m.length)),m=b)}:void 0,g=Date.now(),v=await this.fetcher.fetchOne(p.messages,h,r,3,l,void 0,{temperature:this.options.temperature,top_p:this.options.topP},{messageId:f.messageId,messageSource:"command.generateFeedbackPrompt"});v.type==="success"?this.chatLogger?.logProgress(new Pi(v.value),!0):this.chatLogger?.logResponse({errorDetails:{message:v.reason}});let y=v.type==="success"?F2(f,u,v.value,!1):void 0;return this.telemetryService.sendMSFTTelemetryEvent("feedback.generateDiagnostics",{model:l.model,requestId:v.requestId,responseType:v.type,messageId:f.messageId},{numberOfDiagnostics:y?.length??-1,timeToRequest:g-o,timeToComplete:Date.now()-o}),n&&y&&y.length>m.length&&(n.report(y.slice(m.length)),m=y),r.isCancellationRequested?{type:"cancelled"}:v.type==="success"?{type:"success",comments:y||[]}:{type:"error",reason:v.reason}}},eet=new Set(["bug","performance","consistency","documentation","other"]),tet=new Set(["bug","performance","consistency"]);function F2(t,e,r,n=!1){let o=[],s=e[0].document;for(let a of lJ(r,n)){let{relativeDocumentPath:c,from:u,to:l,kind:d,severity:p,content:f}=a;if(!tet.has(d))continue;let m;if(c){let b=e.find(S=>S.relativeDocumentPath===c);s=b?.document||s,m=b?.selection}let h=s.lineAt(u>=0?u:0),g=s.lineAt((l<=s.lineCount?l:s.lineCount)-1),v=g.text.trimEnd().length,y=new ze(h.lineNumber,h.firstNonWhitespaceCharacterIndex,g.lineNumber,v);if(m&&!y.intersection(m))continue;let _={request:t,uri:s.uri,languageId:s.languageId,range:y,body:new Bc(f),kind:d,severity:p};o.push(_)}return o}function lJ(t,e=!1){let r=/(?<num>\d+)\. Line (?<from>\d+)(-(?<to>\d+))?([^:]*)( in `?(?<relativeDocumentPath>[^,:`]+))`?(, (?<kind>\w+))?(, (?<severity>\w+) severity)?: (?<content>.+?)((?=\n\d+\.|\n\n)|(?<earlyEnd>$))/gs;return Kt(Array.from(t.matchAll(r),n=>{let o=n.groups;if(e&&typeof o.earlyEnd=="string")return;let s=parseInt(o.from)-1,a=o.to?parseInt(o.to):s+1,c=o.relativeDocumentPath,u=o.kind||"other",l=o.severity||"unknown",d=o.content.trim();return{relativeDocumentPath:c,from:s,to:a,linkOffset:n.index+o.num.length+2,linkLength:5+o.from.length+(o.to?o.to.length+1:0),kind:u,severity:l,content:d}}))}function Bb(t,e,r,n,o){let s=n.getLogger("FeedbackGenerator");s.debug("user feedback received");let a=Array.isArray(t)?t:[t],c=a[0];if(!c){s.warn("No review comment found for user feedback");return}let u={messageId:c.request.messageId,userAction:r},l=eet.has(c.kind)?c.kind:"unknown",d={requestId:c.request.messageId,documentType:$t(c.uri)?"notebook":"text",languageId:c.languageId,inputType:c.request.inputType,commentType:l,userAction:r},p={inputDocumentCount:c.request.inputRanges.length,inputLineCount:c.request.inputRanges.reduce((f,m)=>f+m.ranges.reduce((h,g)=>h+(g.end.line-g.start.line),0),0),totalComments:e,comments:a.length,commentLength:a.reduce((f,m)=>f+(typeof m.body=="string"?m.body.length:m.body.value.length),0)};r==="helpful"||r==="unhelpful"?(o.sendMSFTTelemetryEvent("review.comment.vote",d,p),o.sendInternalMSFTTelemetryEvent("review.comment.vote",d),cm(o,void 0,u,{},"review.comment.vote")):(o.sendMSFTTelemetryEvent("review.comment.action",d,p),o.sendInternalMSFTTelemetryEvent("review.comment.action",d),cm(o,void 0,u,{},"review.comment.action"))}var U2=W(require("path")),Ao=W(require("vscode"));var Lc=W(require("vscode")),cwe=W(require("path"));var ret=10,net=5*60*1e3,iet=10*1e3,wM=[],awe;function dJ(){return awe||(awe=Lc.window.createOutputChannel("GitHub Copilot Chat Conversation","log"))}function uwe(t){let e=new Nt;if(!t.get(be).getConfig(ge.FeedbackOnChange))return e;let n=t.get(os).getDiagnosticCollection(),o=new PC(t,dJ);return e.add(Lc.workspace.onDidChangeTextDocument(async s=>{if(s.document.uri.scheme==="file"&&s.contentChanges.length&&s.document===Lc.window.activeTextEditor?.document){let a=t.get(ce).getLogger("FeedbackCollection");try{a.info("Document changed, delaying diagnostics request");let c=s.document.version;if(await new Promise(m=>setTimeout(m,iet)),c!==s.document.version){a.info("Skipping diagnostics request because the document has changed");return}let u=Date.now(),l=u-net;if(wM=wM.filter(m=>m>l),wM.length>=ret){a.info("Max requests reached, skipping diagnostics request");return}wM.push(u),a.info("Requesting diagnostics");let d=Lc.window.activeTextEditor?.selection,p=await Kr.getCurrentChange(t,s.document,d.start);if(!p)return a.info("No change found in the current document at the current position."),[];let f=await o.generateComments([{document:s.document,relativeDocumentPath:cwe.basename(s.document.uri.fsPath),change:p,selection:d}],new Lc.CancellationTokenSource().token);if(f.type==="success"){let m=f.comments.map(h=>new Lc.Diagnostic(h.range,typeof h.body=="string"?h.body:h.body.value,Lc.DiagnosticSeverity.Information));n.set(s.document.uri,m)}}catch(c){a.info("Error generating diagnostics",c?.stack||c?.message||String(c))}}})),e.add(Lc.workspace.onDidCloseTextDocument(s=>{n.set(s.uri,void 0)})),e}function oet(t,e){let r=new s0,n=t.onCancellationRequested(()=>{r.cancel(),s()}),o=e.onCancellationRequested(()=>{r.cancel(),s()});function s(){n.dispose(),o.dispose()}return r.token}async function DC(t,e,r){let n=Ao.window.activeTextEditor,o=n?.selection;if(e==="selection"){if(!n)return;if(!o||o.isEmpty){let a=await t.get(sh).selectEnclosingScope(n,{reason:Ao.l10n.t("Select an enclosing range to review"),includeBlocks:!0});if(!a)return;o=a}}let s=e==="selection"?Ao.l10n.t("Reviewing selected code in {0}...",U2.default.posix.basename(n.document.uri.path)):e==="index"?Ao.l10n.t("Reviewing staged changes..."):e==="workingTree"?Ao.l10n.t("Reviewing unstaged changes..."):Ao.l10n.t("Reviewing changes...");return Ao.window.withProgress({location:Ao.ProgressLocation.Notification,title:s,cancellable:!0},async(a,c)=>{let u=t.get(os),l=new PC(t,dJ);u.removeReviewComments(u.getReviewComments());let d=[];if(e==="index"||e==="workingTree"){let m=await Kr.getCurrentChanges(t,e);(await Promise.all(m.map(async g=>({document:await Ao.workspace.openTextDocument(g.uri),relativeDocumentPath:U2.default.relative(g.repository.rootUri.fsPath,g.uri.fsPath),change:g})))).map(g=>d.push(g))}else if(e==="selection")d.push({document:n.document,relativeDocumentPath:U2.default.basename(n.document.uri.fsPath),selection:n.selection});else for(let m of e.patches){let h=lt.parse(m.fileUri);d.push({document:await Ao.workspace.openTextDocument(h),relativeDocumentPath:U2.default.relative(e.repositoryRoot,h.fsPath),change:await Kr.getChanges(t,lt.file(e.repositoryRoot),h,m.patch)})}let p=r?oet(r,c):c,f=await l.generateComments(d,p,{report:m=>u.addReviewComments(m)});return f.type==="error"?await Ao.window.showInformationMessage(f.severity==="info"?Ao.l10n.t("No review comments generated."):Ao.l10n.t("Code review generation failed."),{modal:!0,detail:f.reason}):f.type==="success"&&f.comments.length===0&&await Ao.window.showInformationMessage(Ao.l10n.t("No review comments generated."),{modal:!0}),f})}var ln=W(require("vscode"));var Dv=class extends ln.CodeAction{constructor(){super(...arguments);this.isAI=!0}},qb=class t{constructor(e){this.accessor=e}static{this.providedCodeActionKinds=[ln.CodeActionKind.QuickFix]}static getSevereDiagnostics(e){let r=e.filter(n=>n.severity<=ln.DiagnosticSeverity.Warning);return r.length===0?[]:r}static getDiagnosticsAsText(e){return e.map(r=>r.message).join(", ")}async provideCodeActions(e,r,n){if(!ln.workspace.getConfiguration("github.copilot.editor").get("enableCodeActions")||await this.accessor.get(De).isCopilotIgnored(e.uri))return;let s=[],a=ln.window.activeTextEditor;if(!a)return s;if(this.accessor.get(be).getConfig(ge.ReviewContextMenu)&&!a.selection.isEmpty){let h=new Dv(ln.l10n.t("Review using Copilot"),ln.CodeActionKind.QuickFix);h.command={title:h.title,command:"github.copilot.interactiveEditor.review"},s.push(h)}let c=t.getSevereDiagnostics(n.diagnostics);if(c.length===0)return s;let u=c.map(h=>h.range).reduce((h,g)=>h.union(g)),l=new ln.Selection(u.start,u.end),d=t.getDiagnosticsAsText(c),p=new Dv(ln.l10n.t("Fix using Copilot"),ln.CodeActionKind.QuickFix);p.diagnostics=c,p.command={title:p.title,command:"vscode.editorChat.start",arguments:[{autoSend:!0,message:`/fix ${d}`,position:u.start,initialSelection:l,initialRange:u}]};let f=new Dv(ln.l10n.t("Explain using Copilot"),ln.CodeActionKind.QuickFix);f.diagnostics=c;let m=`/explain ${d}`;return this.accessor.get(be).getConfig(ge.ExplainIntentRefer)&&(m=`@${M2} ${m}`),f.command={title:f.title,command:"github.copilot.chat.explain",arguments:[m]},s.push(p,f),s}},B2=class{static{this.providedCodeActionKinds=[ln.CodeActionKind.RefactorRewrite]}constructor(e){this.logger=e.get(ce).getLogger("RefactorsProvider"),this.telemetryService=e.get(me),this.parserService=e.get(_t),this.ignoreService=e.get(De)}async provideCodeActions(e,r,n){if(!ln.workspace.getConfiguration("github.copilot.editor").get("enableCodeActions")||await this.ignoreService.isCopilotIgnored(e.uri))return;let s=this.provideGenerateUsingCopilotCodeAction(e,r),a=await this.provideDocumentUsingCopilotCodeAction(e,r),c=await this.provideTestUsingCopilotCodeAction(e,r);return Kt([a,s,c])}provideGenerateUsingCopilotCodeAction(e,r){let n;if(r.isEmpty){let s=e.lineAt(r.start.line).text;r.end.character===s.length&&/^\s*$/g.test(s)&&(n=ln.l10n.t("Generate using Copilot"))}else{let s=e.getText(r);/^\s*$/g.test(s)||(n=ln.l10n.t("Modify using Copilot"))}if(n===void 0)return;let o=new Dv(n,ln.CodeActionKind.RefactorRewrite);return o.command={title:o.title,command:"vscode.editorChat.start",arguments:[{position:r.start,initialSelection:new ln.Selection(r.start,r.end),initialRange:r}]},o}async provideDocumentUsingCopilotCodeAction(e,r){let n=e.offsetAt(r.start),o=e.offsetAt(r.end),s={startIndex:n,endIndex:o},a,c=this.parserService.getTreeSitterAST(e);if(c)try{a=await c.getDocumentableNodeIfOnIdentifier(s)}catch(p){this.logger.exception(p,"RefactorsProvider: getDocumentableNodeIfOnIdentifier failed"),this.telemetryService.sendGHTelemetryException(p,"RefactorsProvider: getDocumentableNodeIfOnIdentifier failed")}if(a===void 0)return;let u=ln.l10n.t("Document using Copilot: {0}",a.identifier),l=new Dv(u,ln.CodeActionKind.RefactorRewrite),d=a.nodeRange===void 0?void 0:new ze(e.positionAt(a.nodeRange.startIndex),e.positionAt(a.nodeRange.endIndex));return l.command={title:u,command:"vscode.editorChat.start",arguments:[{autoSend:!0,message:"/doc",initialRange:d}]},l}async provideTestUsingCopilotCodeAction(e,r){let n=e.offsetAt(r.start),o=e.offsetAt(r.end),s={startIndex:n,endIndex:o},a,c=this.parserService.getTreeSitterAST(e);if(c)try{a=await c.getTestableNode(s)}catch(p){this.logger.exception(p,"RefactorsProvider: getTestableNode failed"),this.telemetryService.sendGHTelemetryException(p,"RefactorsProvider: getTestableNode failed")}if(a===void 0)return;let u=ln.l10n.t("Test using Copilot: {0}",a.identifier),l=new Dv(u,ln.CodeActionKind.RefactorRewrite),d=a.nodeRange===void 0?void 0:new ze(e.positionAt(a.nodeRange.startIndex),e.positionAt(a.nodeRange.endIndex));return l.command={title:u,command:"vscode.editorChat.start",arguments:[{autoSend:!0,message:"/tests",initialRange:d}]},l}};var lwe=require("util"),Nv=W(require("vscode"));var set="application/vnd.code.notebook.error",RM=class{constructor(e){this.accessor=e}async provideCellStatusBarItems(e,r){if(Nv.workspace.getConfiguration("notebook").get("cellFailureDiagnostics"))return[];if(e.kind===Nv.NotebookCellKind.Markup){let a=Nv.workspace.getConfiguration("notebook.experimental").get("cellChat");if(!a)return[];let c=e.document.getText().trim();if(!a||c.length===0)return[];let u="Generate code from markdown content",l=c;return[{text:"$(sparkle)",alignment:Nv.NotebookCellStatusBarAlignment.Left,priority:Number.MAX_SAFE_INTEGER-1,tooltip:u,command:{title:u,command:"notebook.cell.chat.start",arguments:[{index:e.index+1,input:l,autoSend:!0}]}}]}let o=e.outputs.flatMap(a=>a.items).find(a=>a.mime===set);if(!o)return[];let s;try{let a=new lwe.TextDecoder;if(s=JSON.parse(a.decode(o.data)),!s.name&&!s.message)return[];let c="Fix using Copilot",u=[s.name,s.message].filter(Boolean).join(": ").replace(/\s*\(\S+,\s*line\s*\d+\)/,"");return[{text:"$(sparkle)",alignment:Nv.NotebookCellStatusBarAlignment.Left,priority:Number.MAX_SAFE_INTEGER-1,tooltip:c,command:{title:c,command:"vscode.editorChat.start",arguments:[{autoSend:!0,message:`/fix ${u}`}]}}]}catch(a){this.accessor.get(ce).defaultLogger.error(`Failed to parse error output ${a}`)}return[]}};function pwe(t){let e=new Nt,r=async(g,v)=>{let y=`@${M2} /explain `,_,b,S=!1;if(typeof g=="string"&&g)y=g;else{let I=t.get(Tt),w=Wr.getCurrentSelection(I,!0);if(w){let U=Wt.languages.getDiagnostics(w.activeDocument.uri),z=U.filter(re=>!!re.range.intersection(w.range));qb.getSevereDiagnostics(z).length&&(y+=qb.getDiagnosticsAsText(U),S=!0)}let O=Wr.getCurrentSelection(I);if(!S&&O&&(y+=xM,_=IC.formatSelection({languageId:O.languageId,selectedText:O.selectedText}),b=O.activeDocument.uri),!S&&w&&v)try{let U=await Ts.getSelectedScope(t,{document:w.activeDocument,selection:w.range});if(U&&U.symbolAtCursorState&&U.symbolAtCursorState.codeAtCursor){y+=xM;let z=U.symbolAtCursorState.document.languageId??"";_=IC.formatSelection({languageId:z,selectedText:U.symbolAtCursorState.codeAtCursor}),b=w.activeDocument.uri}}catch(U){if(U instanceof ns)return}}b&&_&&!await t.get(De).isCopilotIgnored(b)&&(y+=_),Wt.commands.executeCommand("workbench.action.chat.open",{query:y})},n=async g=>{let v=t.get(os),y=v.findReviewComment(g);if(!y)return;let _=v.getReviewComments().length,b=y.body instanceof Wt.MarkdownString?y.body.value:y.body;v.collapseReviewComment(y),await Wt.commands.executeCommand("vscode.editorChat.start",{initialRange:g.range,message:b,autoSend:!0}),Bb(y,_,"applySuggestion",t.get(ce),t.get(me))},o=async g=>{let v=t.get(os),y=v.findReviewComment(g);if(!y)return;let _=v.getReviewComments().length,b=y.body instanceof Wt.MarkdownString?y.body.value:y.body;await Wt.commands.executeCommand("workbench.action.chat.open",{query:"Explain your comment.",isPartialQuery:!0,previousRequests:[{request:"Review my code.",response:`In file \`${dwe.default.basename(y.uri.fsPath)}\` at line ${y.range.start.line+1}:

${b}`}]}),Bb(y,_,"continueInChat",t.get(ce),t.get(me))},s=async g=>{let v=t.get(os),y=v.findReviewComment(g);if(y){let _=v.getReviewComments().length;v.removeReviewComments([y]),Bb(y,_,"discardComment",t.get(ce),t.get(me))}},a=async()=>{let g=t.get(os),v=g.getReviewComments();v.length&&(g.removeReviewComments(v),Bb(v,v.length,"discardAllComments",t.get(ce),t.get(me)))},c=async g=>{let v=t.get(os),y=v.findReviewComment(g);if(y){let _=v.getReviewComments().length;Bb(y,_,"helpful",t.get(ce),t.get(me))}},u=async g=>{let v=t.get(os),y=v.findReviewComment(g);if(y){let _=v.getReviewComments().length;Bb(y,_,"unhelpful",t.get(ce),t.get(me))}},l=t.get(zt).extensionMode;typeof l=="number"&&l!==Wt.ExtensionMode.Test&&t.get(os).updateContextValues();let d=(g,v)=>{let y=t.get(os),_=y.findReviewComment(g);if(!_)return;let b=y.getReviewComments(),I=(b.indexOf(_)+v+b.length)%b.length,w=y.findCommentThread(b[I]);w&&w.reveal()},p=()=>Wt.commands.executeCommand("vscode.editorChat.start",{message:"/generate "}),f=()=>Wt.commands.executeCommand("vscode.editorChat.start",{message:`/${Ub.ID} `,autoSend:!0,initialRange:Wt.window.activeTextEditor?.selection}),m=()=>Wt.commands.executeCommand("vscode.editorChat.start",{message:"/tests ",autoSend:!0,initialRange:Wt.window.activeTextEditor?.selection}),h=()=>{let g=Wt.window.activeTextEditor;if(!g)return;let v=g.selection,y=Wt.languages.getDiagnostics(g.document.uri).filter(_=>!!v.intersection(_.range)).map(_=>_.message).join(", ");return Wt.commands.executeCommand("vscode.editorChat.start",{message:`/fix ${y}`,autoSend:!0,initialRange:Wt.window.activeTextEditor?.selection})};return e.add(Wt.commands.registerCommand("github.copilot.chat.explain",r)),e.add(Wt.commands.registerCommand("github.copilot.chat.explain.palette",()=>r(void 0,!0))),e.add(Wt.commands.registerCommand("github.copilot.interactiveEditor.review",()=>DC(t,"selection"))),e.add(Wt.commands.registerCommand("github.copilot.interactiveEditor.review.stagedChanges",()=>DC(t,"index"))),e.add(Wt.commands.registerCommand("github.copilot.interactiveEditor.review.changes",()=>DC(t,"workingTree"))),e.add(Wt.commands.registerCommand("github.copilot.interactiveEditor.review.apply",n)),e.add(Wt.commands.registerCommand("github.copilot.interactiveEditor.review.continueInChat",o)),e.add(Wt.commands.registerCommand("github.copilot.interactiveEditor.review.discard",s)),e.add(Wt.commands.registerCommand("github.copilot.interactiveEditor.review.discardAll",a)),e.add(Wt.commands.registerCommand("github.copilot.interactiveEditor.review.markHelpful",c)),e.add(Wt.commands.registerCommand("github.copilot.interactiveEditor.review.markUnhelpful",u)),e.add(Wt.commands.registerCommand("github.copilot.interactiveEditor.review.previous",g=>d(g,-1))),e.add(Wt.commands.registerCommand("github.copilot.interactiveEditor.review.next",g=>d(g,1))),e.add(Wt.commands.registerCommand("github.copilot.interactiveEditor.generate",p)),e.add(Wt.commands.registerCommand("github.copilot.interactiveEditor.generateDocs",f)),e.add(Wt.commands.registerCommand("github.copilot.interactiveEditor.generateTests",m)),e.add(Wt.commands.registerCommand("github.copilot.interactiveEditor.fix",h)),e.add(Wt.languages.registerCodeActionsProvider("*",new qb(t),{providedCodeActionKinds:qb.providedCodeActionKinds})),e.add(Wt.languages.registerCodeActionsProvider("*",new B2(t),{providedCodeActionKinds:B2.providedCodeActionKinds})),e.add(Wt.notebooks.registerNotebookCellStatusBarItemProvider("jupyter-notebook",new RM(t))),e}var fJ=W(Tr());var Lu=W(ct());var kM=class extends Y{async prepare(){return{}}render(e,r){return vscpp(vscppf,null,vscpp(vscppf,null,vscpp(Lu.SystemMessage,{priority:1e3},"You are an AI that creates a detailed content outline for a Jupyter notebook on a given topic.",vscpp("br",null),vscpp($r,null),vscpp(fi,null),vscpp(po,null),vscpp(lr,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"DO NOT include Introduction or Conclusion section in the outline!",vscpp("br",null),"Focus only on sections that will need code!",vscpp("br",null),["","Generate the outline as two parts:","- First part is markdown bullet list of section titles","- Second part is the JSON data that will validate against this JSON schema, wrap the response in code block. We assume that a code block begins with ```[optionally the language] and ends with ```","","The JSON schema is:","{",'  "$schema": "http://json-schema.org/draft-07/schema#",','  "type": "object",','  "properties": {','	"description": {','	  "type": "string"',"	},",'	"sections": {','	  "type": "array",','	  "items": {','		"type": "object",','		"properties": {','		  "title": {','			"type": "string"',"		  },",'		  "content": {','			"type": "string"',"		  }","		},",'		"required": ["title", "content"]',"	  }","	}","  },",'  "required": ["sections"]',"}"].join(`
`),["","Examples:","","Below you will find a set of examples of what you should respond with. Please follow these examples as closely as possible.","","## Valid notebook creation question","","user: Creating Random Arrays with Numpy","","assistant: Here's an outline for a Jupyter notebook that creates Random Arrays with Numpy:","","* **Import Required Libraries**","* **Create Random Arrays**","* **Seed the Random Number Generator**","* **Generate Random Integers**","","```json","{",'  "description": "A Jupyter notebook that creates Random Arrays with Numpy.",','  "sections": [',"    {",'      "title": "Import Required Libraries",','      "content": "Import the necessary libraries, including NumPy."',"    },","    {",'      "title": "Create Random Arrays",','      "content": "Use NumPy to create random arrays of various shapes and sizes, including 1D, 2D, and 3D arrays."',"    },","    {",'      "title": "Seed the Random Number Generator",','      "content": "Use the seed() function to seed the random number generator for reproducibility."',"    },","	{",'	  "title": "Generate Random Integers",','	  "content": "Use the randint() function to generate random integers within a specified range."',"	}","  ]","}","```"].join(`
`))),this.props.chatVariables&&Object.keys(this.props.chatVariables).length>0?vscpp(ti,{priority:900,chatVariables:this.props.chatVariables,query:`Create notebook: ${this.props.query}`}):vscpp(Lu.UserMessage,{priority:900},"Create notebook: ",this.props.query))}},AM=class extends Y{async prepare(){return{}}render(e,r){return vscpp(vscppf,null,vscpp(vscppf,null,this.props.history&&vscpp(pJ,{messages:this.props.history.chatMessages??[]}),vscpp(Lu.SystemMessage,{priority:1e3},"You are an AI that writes Python code for a single section of a Jupyter notebook.",vscpp("br",null),vscpp($r,null),vscpp(fi,null),vscpp(lr,null),"When dealing with Jupyter Notebook, if a module is already imported in a cell, it can be used in other cells directly without importing it again. For the same reason, if a variable is defined in a cell, it can be used in other cells as well",vscpp("br",null),"When dealing with Jupyter Notebook, cells below the current cell can be executed before the current cell, you must use the variables defined in the cells below, unless you want to overwrite them.",vscpp("br",null),"When dealing with Jupyter Notebook, do not generate CELL INDEX in the code blocks in your answer, it is only used to help you understand the context.",vscpp("br",null),"If the Jupyter Notebook already contains variables, you should respect the name and value of the variables, and use them in your code when necessary.",vscpp("br",null),"Your output should be valid Python code with inline comments.",vscpp("br",null),"You should return the code directly without any explantion.",vscpp("br",null),"You should not print message to explain the code or purpose of the code.",vscpp("br",null),"You should return the code directly, without wrapping it inside \\`\\`\\`.",vscpp("br",null),"Please make sure that the new code is syntactically valid Python code. It can be validated by running it in a Python interpreter.",vscpp("br",null),"For example, it should pass the validation through builtin module codeop \\`codeop.compile_command(statement)\\`.",vscpp("br",null)),vscpp(Lu.UserMessage,{priority:900},"Overall topic of the notebook: ",this.props.description,vscpp("br",null),"Title of the notebook section: ",this.props.section.title,vscpp("br",null),"Description of the notebok section: ",this.props.section.content,vscpp("br",null),"Given this information, write all the code for this section and this section only.",vscpp("br",null),"The request to generate the outline of the notebook is already completed.",vscpp("br",null),"Here is the request details for the outline generation:",vscpp("br",null),vscpp("br",null),"Code in the notebook so far:",vscpp("br",null),vscpp("br",null),this.props.existingCode,vscpp("br",null),vscpp("br",null),"Please make sure the new code you generate works fine with the code above.",vscpp("br",null))))}},pJ=class extends Y{render(e,r){let n=[];for(let o of this.props.messages)switch(o.role){case"user":n.push(vscpp(Lu.UserMessage,{priority:800},o.content));break;case"assistant":n.push(vscpp(Lu.AssistantMessage,{priority:800},o.content));break;case"system":n.push(vscpp(Lu.SystemMessage,{priority:100},o.content));break;default:break}return vscpp(vscppf,null,n)}},PM=class extends Y{async prepare(){return{}}render(e,r){return vscpp(vscppf,null,vscpp(vscppf,null,vscpp(Lu.SystemMessage,{priority:1e3},"You are an AI that improves Python code with respect to readability and performance for a single section of a Jupyter notebook.",vscpp("br",null),vscpp($r,null),vscpp(fi,null),vscpp(lr,null),"You MUST return Python code as your answer.",vscpp("br",null),"DO NOT explain in inline comments for your the improvements.",vscpp("br",null),"You should not print messages to explain the code or purpose of the code.",vscpp("br",null),"Make sure the new code you generate works fine with the code above.",vscpp("br",null),"Make sure if a module is already imported in the code above, it can be used in the new code directly without importing it again. For the same reason, if a variable is defined above, it can be used in new code as well. ",vscpp("br",null),"Make sure to return the code only - don't give an explanation of the improvements.",vscpp("br",null)),vscpp(Lu.UserMessage,{priority:900},"Overall topic of the notebook: ",this.props.description,vscpp("br",null),"Title of the notebook section: ",this.props.section.title,vscpp("br",null),"Description of the notebook section: ",this.props.section.content,vscpp("br",null),"Code in the notebook so far:",vscpp("br",null),vscpp("br",null),this.props.existingCode,vscpp("br",null),vscpp("br",null),"Given this information, suggest improvements for the following code:",vscpp("br",null),vscpp("br",null),this.props.code,vscpp("br",null),vscpp("br",null))))}};var DM=class{constructor(){this.stagedTextToApply="";this.reporting=!0;this._appliedText="";this._resolvedContentDeferredPromise=new Np;this._incodeblock=!1;this._presentCodeblockProgress=!1}async processResponse(e,r,n,o,s){for await(let{delta:a}of n){if(s.isCancellationRequested)return this._appliedText;this.applyDelta(a.text,e,o)}return this._appliedText}applyDeltaToTurn(e,r){r.response||(r.response={message:e,type:"model"}),this._appliedText+=e,r.response.message+=e}applyDeltaToProgress(e,r){r.markdown(e)}applyDelta(e,r,n){if(!this.reporting){this.applyDeltaToTurn(e,r);return}if(e=this.stagedTextToApply+e,this._incodeblock){let s=e.indexOf("```");if(s===-1){this.stagedTextToApply=e,this.applyDeltaToTurn("",r),this._presentCodeblockProgress||(this._presentCodeblockProgress=!0,n.progress(fJ.t("Thinking ...")));return}else{this._incodeblock=!1,e=e.substring(0,s)+"```";try{this.applyDeltaToTurn(e,r)}catch{}finally{this.reporting=!1,this.stagedTextToApply="",this._resolvedContentDeferredPromise.complete(new Pi(""))}return}}let o=e.indexOf("```");if(o!==-1){this._incodeblock=!0;let s=e.indexOf("```",o+3);if(s!==-1){this._incodeblock=!1,this.applyDeltaToProgress(e.substring(0,o),n),this.applyDeltaToProgress(e.substring(s+3),n),this.applyDeltaToTurn(e,r),this.reporting=!1,this.stagedTextToApply="";return}else{let a=e.substring(0,o);this.applyDeltaToProgress(a,n),this.applyDeltaToTurn(e,r),this.stagedTextToApply="",this._presentCodeblockProgress||(this._presentCodeblockProgress=!0,n.progress(fJ.t("Thinking ..."))),this._resolvedContentDeferredPromise.p.then(c=>n.push(c));return}}this.applyDeltaToProgress(e,n),this.applyDeltaToTurn(e,r),this.stagedTextToApply=""}};async function fwe(t,e,r,n,o,s,a,c){let u={messageSource:"slash.newNotebook"},{messages:l}=await _s(t,e,AM,{history:n,description:o,section:s,existingCode:a},t.get(ve).acquireTokenizer(e.family)),p=await t.get(jt).fetchOne(l,void 0,c,2,e,void 0,{temperature:r.temperature,top_p:r.topP},u);if(p.type!=="success")return;let f=Ws(p.value);return f.length>0?f[0].code:p.value}async function mwe(t,e,r,n,o,s,a,c){let u={messageSource:"slash.newNotebook"},{messages:l}=await _s(t,e,PM,{description:n,section:o,existingCode:s,code:a},t.get(ve).acquireTokenizer(e.family)),p=await t.get(jt).fetchOne(l,void 0,c,2,e,void 0,{temperature:r.temperature,top_p:r.topP},u);if(p.type==="success")return p.value}function NM(t,e=!1){let r=t.length,n=0,o="",s=0,a=16,c=0,u=0,l=0,d=0,p=0;function f(b,S){let I=0,w=0;for(;I<b||!S;){let O=t.charCodeAt(n);if(O>=48&&O<=57)w=w*16+O-48;else if(O>=65&&O<=70)w=w*16+O-65+10;else if(O>=97&&O<=102)w=w*16+O-97+10;else break;n++,I++}return I<b&&(w=-1),w}function m(b){n=b,o="",s=0,a=16,p=0}function h(){let b=n;if(t.charCodeAt(n)===48)n++;else for(n++;n<t.length&&NC(t.charCodeAt(n));)n++;if(n<t.length&&t.charCodeAt(n)===46)if(n++,n<t.length&&NC(t.charCodeAt(n)))for(n++;n<t.length&&NC(t.charCodeAt(n));)n++;else return p=3,t.substring(b,n);let S=n;if(n<t.length&&(t.charCodeAt(n)===69||t.charCodeAt(n)===101))if(n++,(n<t.length&&t.charCodeAt(n)===43||t.charCodeAt(n)===45)&&n++,n<t.length&&NC(t.charCodeAt(n))){for(n++;n<t.length&&NC(t.charCodeAt(n));)n++;S=n}else p=3;return t.substring(b,S)}function g(){let b="",S=n;for(;;){if(n>=r){b+=t.substring(S,n),p=2;break}let I=t.charCodeAt(n);if(I===34){b+=t.substring(S,n),n++;break}if(I===92){if(b+=t.substring(S,n),n++,n>=r){p=2;break}switch(t.charCodeAt(n++)){case 34:b+='"';break;case 92:b+="\\";break;case 47:b+="/";break;case 98:b+="\b";break;case 102:b+="\f";break;case 110:b+=`
`;break;case 114:b+="\r";break;case 116:b+="	";break;case 117:let O=f(4,!0);O>=0?b+=String.fromCharCode(O):p=4;break;default:p=5}S=n;continue}if(I>=0&&I<=31)if(q2(I)){b+=t.substring(S,n),p=2;break}else p=6;n++}return b}function v(){if(o="",p=0,s=n,u=c,d=l,n>=r)return s=r,a=17;let b=t.charCodeAt(n);if(mJ(b)){do n++,o+=String.fromCharCode(b),b=t.charCodeAt(n);while(mJ(b));return a=15}if(q2(b))return n++,o+=String.fromCharCode(b),b===13&&t.charCodeAt(n)===10&&(n++,o+=`
`),c++,l=n,a=14;switch(b){case 123:return n++,a=1;case 125:return n++,a=2;case 91:return n++,a=3;case 93:return n++,a=4;case 58:return n++,a=6;case 44:return n++,a=5;case 34:return n++,o=g(),a=10;case 47:let S=n-1;if(t.charCodeAt(n+1)===47){for(n+=2;n<r&&!q2(t.charCodeAt(n));)n++;return o=t.substring(S,n),a=12}if(t.charCodeAt(n+1)===42){n+=2;let I=r-1,w=!1;for(;n<I;){let O=t.charCodeAt(n);if(O===42&&t.charCodeAt(n+1)===47){n+=2,w=!0;break}n++,q2(O)&&(O===13&&t.charCodeAt(n)===10&&n++,c++,l=n)}return w||(n++,p=1),o=t.substring(S,n),a=13}return o+=String.fromCharCode(b),n++,a=16;case 45:if(o+=String.fromCharCode(b),n++,n===r||!NC(t.charCodeAt(n)))return a=16;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return o+=h(),a=11;default:for(;n<r&&y(b);)n++,b=t.charCodeAt(n);if(s!==n){switch(o=t.substring(s,n),o){case"true":return a=8;case"false":return a=9;case"null":return a=7}return a=16}return o+=String.fromCharCode(b),n++,a=16}}function y(b){if(mJ(b)||q2(b))return!1;switch(b){case 125:case 93:case 123:case 91:case 34:case 58:case 44:case 47:return!1}return!0}function _(){let b;do b=v();while(b>=12&&b<=15);return b}return{setPosition:m,getPosition:()=>n,scan:e?_:v,getToken:()=>a,getTokenValue:()=>o,getTokenOffset:()=>s,getTokenLength:()=>n-s,getTokenStartLine:()=>u,getTokenStartCharacter:()=>s-d,getTokenError:()=>p}}function mJ(t){return t===32||t===9}function q2(t){return t===10||t===13}function NC(t){return t>=48&&t<=57}var hwe;(function(t){t[t.lineFeed=10]="lineFeed",t[t.carriageReturn=13]="carriageReturn",t[t.space=32]="space",t[t._0=48]="_0",t[t._1=49]="_1",t[t._2=50]="_2",t[t._3=51]="_3",t[t._4=52]="_4",t[t._5=53]="_5",t[t._6=54]="_6",t[t._7=55]="_7",t[t._8=56]="_8",t[t._9=57]="_9",t[t.a=97]="a",t[t.b=98]="b",t[t.c=99]="c",t[t.d=100]="d",t[t.e=101]="e",t[t.f=102]="f",t[t.g=103]="g",t[t.h=104]="h",t[t.i=105]="i",t[t.j=106]="j",t[t.k=107]="k",t[t.l=108]="l",t[t.m=109]="m",t[t.n=110]="n",t[t.o=111]="o",t[t.p=112]="p",t[t.q=113]="q",t[t.r=114]="r",t[t.s=115]="s",t[t.t=116]="t",t[t.u=117]="u",t[t.v=118]="v",t[t.w=119]="w",t[t.x=120]="x",t[t.y=121]="y",t[t.z=122]="z",t[t.A=65]="A",t[t.B=66]="B",t[t.C=67]="C",t[t.D=68]="D",t[t.E=69]="E",t[t.F=70]="F",t[t.G=71]="G",t[t.H=72]="H",t[t.I=73]="I",t[t.J=74]="J",t[t.K=75]="K",t[t.L=76]="L",t[t.M=77]="M",t[t.N=78]="N",t[t.O=79]="O",t[t.P=80]="P",t[t.Q=81]="Q",t[t.R=82]="R",t[t.S=83]="S",t[t.T=84]="T",t[t.U=85]="U",t[t.V=86]="V",t[t.W=87]="W",t[t.X=88]="X",t[t.Y=89]="Y",t[t.Z=90]="Z",t[t.asterisk=42]="asterisk",t[t.backslash=92]="backslash",t[t.closeBrace=125]="closeBrace",t[t.closeBracket=93]="closeBracket",t[t.colon=58]="colon",t[t.comma=44]="comma",t[t.dot=46]="dot",t[t.doubleQuote=34]="doubleQuote",t[t.minus=45]="minus",t[t.openBrace=123]="openBrace",t[t.openBracket=91]="openBracket",t[t.plus=43]="plus",t[t.slash=47]="slash",t[t.formFeed=12]="formFeed",t[t.tab=9]="tab"})(hwe||(hwe={}));var LM;(function(t){t.DEFAULT={allowTrailingComma:!1}})(LM||(LM={}));function gwe(t,e=[],r=LM.DEFAULT){let n=null,o=[],s=[];function a(u){Array.isArray(o)?o.push(u):n!==null&&(o[n]=u)}return vwe(t,{onObjectBegin:()=>{let u={};a(u),s.push(o),o=u,n=null},onObjectProperty:u=>{n=u},onObjectEnd:()=>{o=s.pop()},onArrayBegin:()=>{let u=[];a(u),s.push(o),o=u,n=null},onArrayEnd:()=>{o=s.pop()},onLiteralValue:a,onError:(u,l,d)=>{e.push({error:u,offset:l,length:d})}},r),o[0]}function vwe(t,e,r=LM.DEFAULT){let n=NM(t,!1),o=[];function s(ee){return ee?()=>ee(n.getTokenOffset(),n.getTokenLength(),n.getTokenStartLine(),n.getTokenStartCharacter()):()=>!0}function a(ee){return ee?()=>ee(n.getTokenOffset(),n.getTokenLength(),n.getTokenStartLine(),n.getTokenStartCharacter(),()=>o.slice()):()=>!0}function c(ee){return ee?N=>ee(N,n.getTokenOffset(),n.getTokenLength(),n.getTokenStartLine(),n.getTokenStartCharacter()):()=>!0}function u(ee){return ee?N=>ee(N,n.getTokenOffset(),n.getTokenLength(),n.getTokenStartLine(),n.getTokenStartCharacter(),()=>o.slice()):()=>!0}let l=a(e.onObjectBegin),d=u(e.onObjectProperty),p=s(e.onObjectEnd),f=a(e.onArrayBegin),m=s(e.onArrayEnd),h=u(e.onLiteralValue),g=c(e.onSeparator),v=s(e.onComment),y=c(e.onError),_=r&&r.disallowComments,b=r&&r.allowTrailingComma;function S(){for(;;){let ee=n.scan();switch(n.getTokenError()){case 4:I(14);break;case 5:I(15);break;case 3:I(13);break;case 1:_||I(11);break;case 2:I(12);break;case 6:I(16);break}switch(ee){case 12:case 13:_?I(10):v();break;case 16:I(1);break;case 15:case 14:break;default:return ee}}}function I(ee,N=[],E=[]){if(y(ee),N.length+E.length>0){let P=n.getToken();for(;P!==17;){if(N.indexOf(P)!==-1){S();break}else if(E.indexOf(P)!==-1)break;P=S()}}}function w(ee){let N=n.getTokenValue();return ee?h(N):(d(N),o.push(N)),S(),!0}function O(){switch(n.getToken()){case 11:let ee=n.getTokenValue(),N=Number(ee);isNaN(N)&&(I(2),N=0),h(N);break;case 7:h(null);break;case 8:h(!0);break;case 9:h(!1);break;default:return!1}return S(),!0}function U(){return n.getToken()!==10?(I(3,[],[2,5]),!1):(w(!1),n.getToken()===6?(g(":"),S(),re()||I(4,[],[2,5])):I(5,[],[2,5]),o.pop(),!0)}function z(){l(),S();let ee=!1;for(;n.getToken()!==2&&n.getToken()!==17;){if(n.getToken()===5){if(ee||I(4,[],[]),g(","),S(),n.getToken()===2&&b)break}else ee&&I(6,[],[]);U()||I(4,[],[2,5]),ee=!0}return p(),n.getToken()!==2?I(7,[2],[]):S(),!0}function M(){f(),S();let ee=!0,N=!1;for(;n.getToken()!==4&&n.getToken()!==17;){if(n.getToken()===5){if(N||I(4,[],[]),g(","),S(),n.getToken()===4&&b)break}else N&&I(6,[],[]);ee?(o.push(0),ee=!1):o[o.length-1]++,re()||I(4,[],[4,5]),N=!0}return m(),ee||o.pop(),n.getToken()!==4?I(8,[4],[]):S(),!0}function re(){switch(n.getToken()){case 3:return M();case 1:return z();case 10:return w(!0);default:return O()}}return S(),n.getToken()===17?r.allowEmptyContent?!0:(I(4,[],[]),!1):re()?(n.getToken()!==17&&I(9,[],[]),!0):(I(4,[],[]),!1)}var ywe;(function(t){t[t.None=0]="None",t[t.UnexpectedEndOfComment=1]="UnexpectedEndOfComment",t[t.UnexpectedEndOfString=2]="UnexpectedEndOfString",t[t.UnexpectedEndOfNumber=3]="UnexpectedEndOfNumber",t[t.InvalidUnicode=4]="InvalidUnicode",t[t.InvalidEscapeCharacter=5]="InvalidEscapeCharacter",t[t.InvalidCharacter=6]="InvalidCharacter"})(ywe||(ywe={}));var bwe;(function(t){t[t.OpenBraceToken=1]="OpenBraceToken",t[t.CloseBraceToken=2]="CloseBraceToken",t[t.OpenBracketToken=3]="OpenBracketToken",t[t.CloseBracketToken=4]="CloseBracketToken",t[t.CommaToken=5]="CommaToken",t[t.ColonToken=6]="ColonToken",t[t.NullKeyword=7]="NullKeyword",t[t.TrueKeyword=8]="TrueKeyword",t[t.FalseKeyword=9]="FalseKeyword",t[t.StringLiteral=10]="StringLiteral",t[t.NumericLiteral=11]="NumericLiteral",t[t.LineCommentTrivia=12]="LineCommentTrivia",t[t.BlockCommentTrivia=13]="BlockCommentTrivia",t[t.LineBreakTrivia=14]="LineBreakTrivia",t[t.Trivia=15]="Trivia",t[t.Unknown=16]="Unknown",t[t.EOF=17]="EOF"})(bwe||(bwe={}));var LC=gwe;var _we;(function(t){t[t.InvalidSymbol=1]="InvalidSymbol",t[t.InvalidNumberFormat=2]="InvalidNumberFormat",t[t.PropertyNameExpected=3]="PropertyNameExpected",t[t.ValueExpected=4]="ValueExpected",t[t.ColonExpected=5]="ColonExpected",t[t.CommaExpected=6]="CommaExpected",t[t.CloseBraceExpected=7]="CloseBraceExpected",t[t.CloseBracketExpected=8]="CloseBracketExpected",t[t.EndOfFileExpected=9]="EndOfFileExpected",t[t.InvalidCommentToken=10]="InvalidCommentToken",t[t.UnexpectedEndOfComment=11]="UnexpectedEndOfComment",t[t.UnexpectedEndOfString=12]="UnexpectedEndOfString",t[t.UnexpectedEndOfNumber=13]="UnexpectedEndOfNumber",t[t.InvalidUnicode=14]="InvalidUnicode",t[t.InvalidEscapeCharacter=15]="InvalidEscapeCharacter",t[t.InvalidCharacter=16]="InvalidCharacter"})(_we||(_we={}));var j2=W(ct());var OM=W(Tr()),Ou=W(ct());async function H2(t,e,r,n){let o=null,s=!1;o=setTimeout(()=>{s||t.report(e)},n);try{let a=await r;return s=!0,a}finally{o&&clearTimeout(o)}}var OC=class extends Y{constructor(r,n,o,s,a,c,u,l,d,p){super(r,n);this.chatMLFetcher=o;this.logService=s;this.embeddingsComputer=a;this.endPointProvider=c;this.combinedEmbeddingIndex=u;this.docSearchClient=l;this.envService=d;this.tokenizerProvider=p}async prepare(r,n,o){n?.report(new Wi(OM.t("Refining question to improve search accuracy.")));let s=this.props.query,a=await this.endPointProvider.getChatEndpoint("gpt-3.5-turbo"),{messages:c}=await het(this.tokenizerProvider,this.accessor,this.props.history,a,this.props.query);if(o.isCancellationRequested)return{docSearchResults:[],settings:[],commands:[],query:s};let u=this.logService.getLogger("vscodePrompt");u.debug("Asking the model to update the user question.");let l=await this.chatMLFetcher.fetchOne(c,async g=>{},o,2,a,{agent:RE},{temperature:0,top_p:1,stop:["dontStopBelieving"]},{messageSource:"vscodeIntent"});if(o.isCancellationRequested)return{docSearchResults:[],settings:[],commands:[],query:s};l.type==="success"?s=get(this.props.query,l.value):u.error("Failed to refine the question",l);let d=n?await H2(n,new Wi(OM.t("Searching doc index....")),this.searchDocsSearchForContext(s,10,o,u),1e3):await this.searchDocsSearchForContext(s,10,o,u);if(o.isCancellationRequested)return{docSearchResults:[],settings:[],commands:[],query:s};let p=await this.endPointProvider.getEmbeddingsEndpoint("ada"),f=await this.embeddingsComputer.computeEmbeddings(p,[this.props.query],{},void 0);if(o.isCancellationRequested)return{docSearchResults:[],settings:[],commands:[],query:s};if(!f)return{docSearchResults:d,settings:[],commands:[],query:s};let{commands:m,settings:h}=n?await H2(n,new Wi(OM.t("Searching command and setting index....")),this.combinedEmbeddingIndex.nClosestValues(f[0],5),500):await this.combinedEmbeddingIndex.nClosestValues(f[0],5);return{docSearchResults:d,settings:h,commands:m,query:s}}async searchDocsSearchForContext(r,n,o,s){try{return await this.docSearchClient.search(r,{repo:"microsoft/vscode-docs"},{limit:n,similarity:.75},o)}catch(a){return s.error(`Failed to search docs search for query:
`,a),[]}}render(r){let n=this.envService.OS;return vscpp(vscppf,null,vscpp(Ou.SystemMessage,{priority:1e3},"You are a Visual Studio Code assistant. Your job is to assist users in using Visual Studio Code by providing knowledge to accomplish their task. This knowledge should focus on settings and commands, but also includes documentation. Please do not guess a response and instead just respond with a polite apology if you are unsure.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"Follow the user's requirements carefully & to the letter.",vscpp("br",null),"Your expertise is strictly limited to software development topics.",vscpp("br",null),"Follow Microsoft content policies.",vscpp("br",null),"Avoid content that violates copyrights.",vscpp("br",null),"For questions not related to software development, simply give a reminder that you are an AI programming assistant.",vscpp("br",null),"Keep your answers short and impersonal.",vscpp("br",null),"Use Markdown formatting in your answers.",vscpp("br",null),"Make sure to include the programming language name at the start of the Markdown code blocks.",vscpp("br",null),"Avoid wrapping the whole response in triple backticks.",vscpp("br",null),"The user works in an IDE called Visual Studio Code which has a concept for editors with open files, integrated unit test support, an output pane that shows the output of running the code as well as an integrated terminal.",vscpp("br",null),"The user is working on a ",n," machine. Please respond with system specific commands if applicable.",vscpp("br",null),"The active document is the source code the user is looking at right now.",vscpp("br",null),"You can only give one reply for each conversation turn.",vscpp("br",null),"If you are referencing multiple commands and settings, please respond step by step in a numbered list format.",vscpp("br",null),vscpp("br",null),"Additional Rules",vscpp("br",null),"You must respond with either a setting to set or a command to execute when applicable.",vscpp("br",null),"When referring to a command, you must use the command name in markdown bold syntax.",vscpp("br",null),"When referring to any commands, you must include the referenced commands in a properly formatted JSON markdown code block at the end of the sentence that references that command.",vscpp("br",null),"Similarly, all referenced settings must be properly formatted in a JSON markdown code block to allow copying them into the user's settings.json file.",vscpp("br",null),"If you are referencing multiple settings, combine all settings into the same JSON markdown code block at the beginning of your response, and then describe each setting in a numbered list after the JSON markdown code block, as shown in the template below:",vscpp("br",null),"## Multiple settings response template",vscpp("br",null),vscpp(Oe,{uri:null,code:`{
  "type": "setting",
  "settings": {
    "setting1": "settingValue1",
    "setting2": "settingValue2",
    "setting3": "settingValue3"
	...
	}
}`,languageId:"json"}),'1. `"setting1": settingValue1` - Description of setting1',vscpp("br",null),'2. `"setting2": settingValue2` - Description of setting2',vscpp("br",null),'3. `"setting3": settingValue3` - Description of setting3',vscpp("br",null),"4. ...",vscpp("br",null),vscpp("br",null),"If you are referencing multiple commands, do not combine all the commands into the same JSON markdown code block. Instead, describe each command and include the JSON markdown code block in a numbered list, as shown in the template below:",vscpp("br",null),"## Multiple commands response template",vscpp("br",null),"1. **Command1** - Description of Command1",vscpp("br",null),vscpp(Oe,{uri:null,code:`{
  "type": "command",
  "commands": {
    "command": "command1",
  }
}`,languageId:"json"}),"2. **Command2** - Description of Command2",vscpp("br",null),vscpp(Oe,{uri:null,code:`{
  "type": "command",
  "commands": {
    "command": "command2",
  }
}`,languageId:"json"}),"3. ...",vscpp("br",null),'If you are referencing multiple commands and setting, respond with numbered steps for the user to follow. First mention all the commands as per the "Multiple commands response template" and then all the settings as per the "Multiple settings response template" shown above.',vscpp("br",null),"## Multiple command and settings response template",vscpp("br",null),"1. **Command1** - Description of Command1",vscpp("br",null),vscpp(Oe,{uri:null,code:`{
  "type": "command",
  "commands": {
    "command": "command1",
  }
}`,languageId:"json"}),"2. **Command2** - Description of Command2",vscpp("br",null),vscpp(Oe,{uri:null,code:`{
  "type": "command",
  "commands": {
    "command": "command2",
  }
}`,languageId:"json"}),"3. A short summary of the combined settings.",vscpp(Oe,{uri:null,code:`{
  "type": "setting",
  "settings": {
    "setting1": "settingValue1",
    "setting2": "settingValue2",
    "setting3": "settingValue3"
  }
}`,languageId:"json"}),'1. `"setting1": settingValue1` - Description of setting1',vscpp("br",null),'2. `"setting2": settingValue2` - Description of setting2',vscpp("br",null),'3. `"setting3": settingValue3` - Description of setting3',vscpp("br",null),"4. ...",vscpp("br",null),vscpp("br",null),vscpp("br",null),"If a command or setting references another command or setting, you must respond with both the original and the referenced commands or settings.",vscpp("br",null),"The JSON markdown code block containing the command or setting should be included immediately after the sentence referencing it.",vscpp("br",null),"The JSON markdown schema for a command is as follows:",vscpp("br",null),vscpp(Oe,{uri:null,code:`{
					  "type": "command",
					  "commands": {
						"command": "commandName",
						"args": "commandArgs"
					  }
					}`,languageId:"json"}),"The JSON markdown schema for a setting is as follows:",vscpp("br",null),vscpp(Oe,{uri:null,code:`{
					  "type": "setting",
					  "settings": {
						"setting": "settingValue"
					  }
					}`,languageId:"json"}),vscpp("br",null),"Do not respond with a command or setting that is not in a properly formatted JSON markdown code block.",vscpp("br",null),"If a setting and command will accomplish the same thing, you must suggest the command instead.",vscpp("br",null),"Do not suggest opening the settings editor.",vscpp("br",null),"If answering with a keybinding, please still include the command bound to the keybinding.",vscpp("br",null),"If a keybinding contains a backtick you must escape it. For example the keybinding Ctrl + backtick would be written as ``ctrl + ` ``",vscpp("br",null),"Do not suggest opening the command palette to execute commands.",vscpp("br",null),"Do not suggest commands or settings identifiers that do not exist.",vscpp("br",null),"Do not suggest installing Visual Studio Code because the user has already installed it.",vscpp("br",null),"If you believe the context given to you is incorrect or not relevant you may ignore it.",vscpp("br",null),"Always respond with a numbered list of steps to be taken to achieve the desired outcome if multiple steps are necessary.",vscpp("br",null),'If an extension might help the user, you may suggest a search query for the extension marketplace. You must also include the command **Search marketplace** (`workbench.extensions.search`) with args set to the suggested query in the commands section at the end of your response. The query can also contain the tags "@popular", "@recommended", or "@featured" to filter the results.',vscpp("br",null),vscpp("br",null),"Examples:",vscpp("br",null),vscpp("br",null),"[EXAMPLES START]",vscpp("br",null),"Below you will find a set of examples of what you should respond with. Please follow these examples as closely as possible.",vscpp("br",null),vscpp("br",null),"## Single setting response",vscpp("br",null),"Question: How do I disable telemetry?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),vscpp(Oe,{uri:null,code:`{
  "type": "setting",
  "settings": {
    "telemetry.telemetryLevel": "off",
  }
}`,languageId:"json"}),"is a setting which can be used to disable telemetry.",vscpp("br",null),vscpp("br",null),"## Multiple settings response",vscpp("br",null),"Question: How can I change the font size in all areas of Visual Studio Code, including the editor, terminal?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),vscpp(Oe,{uri:null,code:`{
  "type": "setting",
  "settings": {
	"editor.fontSize": 18,
	"terminal.integrated.fontSize": 14,
	"window.zoomLevel": 1
  }
}`,languageId:"json"}),'1. `"editor.fontSize": 18` - This setting adjusts the font size within the editor. The default size is overridden by the value `18`, making the text larger and more readable according to user preference.',vscpp("br",null),'2. `"terminal.integrated.fontSize": 14` - Similarly, this setting changes the font size in the integrated terminal. By setting it to `14`, it increases the font size in the terminal independently from the editor.',vscpp("br",null),'3. `"window.zoomLevel": 1` - This setting controls the zoom level of the entire Visual Studio Code interface. A value of `1` means that the interface will be zoomed in to 120% of the original size, making everything appear bigger. A value of `0` would indicate no zoom (100% - default size), positive values zoom in, and negative values zoom out.',vscpp("br",null),vscpp("br",null),"## Multiple commands response",vscpp("br",null),"Question: What is the command to report an issue for other extensions in Visual Studio Code?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"Here are some possible commands:",vscpp("br",null),"1. **Report Issue** - This command can be used to report an issue for other extensions.",vscpp("br",null),vscpp(Oe,{uri:null,code:`{
  "type": "command",
  "commands": {
	"command": "workbench.extensions.reportExtensionIssue"
  }
}`,languageId:"json"}),"2. **Docker: Report Issue** - This command can be used to report an issue for the Docker extension.",vscpp("br",null),vscpp(Oe,{uri:null,code:`{
  "type": "command",
  "commands": {
	"command": "vscode-docker.help.reportIssue"
  }
}`,languageId:"json"}),"3. **Codespaces: Report Issue** - This command can be used to report an issue for the Codespaces extension.",vscpp("br",null),vscpp(Oe,{uri:null,code:`{
  "type": "command",
  "commands": {
	"command": "github.codespaces.reportIssue"
  }
}`,languageId:"json"}),vscpp("br",null),"## Single command response",vscpp("br",null),"Question: How do I close all editors?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"You can use the **Close All Editors** command to close all editors.",vscpp("br",null),vscpp("br",null),vscpp(Oe,{uri:null,code:`{
  "type": "command",
  "commands": {
	"command": "workbench.action.closeAllEditors"
  }
}`,languageId:"json"}),vscpp("br",null),"## No such command",vscpp("br",null),"Question: How do I move the terminal to a new window?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"There is no such command.",vscpp("br",null),vscpp("br",null),"## Invalid Question",vscpp("br",null),"Question: How do I bake a potato?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"Sorry this question isn't related to Visual Studio Code.",vscpp("br",null),vscpp("br",null),"## Marketplace search",vscpp("br",null),"Question: How do I add PHP support?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"You can use the **Search marketplace** command to search for extensions that add PHP support.",vscpp("br",null),vscpp("br",null),vscpp(Oe,{uri:null,code:`{
  "type": "command",
  "commands": {
	"command": "workbench.extensions.search",
	"args": "php"
	}
}`,languageId:"json"})),vscpp(qt,{priority:700,history:this.props.history}),vscpp(Ou.UserMessage,{priority:800},"The current question is related to Visual Studio Code. ",vscpp("br",null),"If a command or setting is not a valid answer, but it still relates to Visual Studio Code, please still respond.",vscpp("br",null),"Please do not guess a response and instead just respond with a polite apology if you are unsure.",vscpp("br",null),"If you believe the given context given to you is incorrect or not relevant you may ignore it.",vscpp("br",null),"The user cannot see the context you are given, so you must not mention it. If you want to refer to it, you must include it in your reply.",vscpp("br",null),'Below is a list of commands and settings we found which might be relevant to the question. For view related commands "Toggle" often means Show or Hide. A setting may reference another setting, that will appear as \\`#setting.id#\\`, you must return the referenced setting as well. You may use this context to help you formulate your response, but are not required to.',vscpp("br",null),r.commands.length>0&&vscpp(vscppf,null,"Here are some possible commands:",vscpp("br",null)),r.commands.length>0&&r.commands.map(o=>vscpp(Ou.TextChunk,null,"- ",o.label,' ("',o.key,'") (Keybinding: "',o.keybinding,'")')),r.settings.length>0&&vscpp(vscppf,null,"Here are some possible settings:",vscpp("br",null)),r.settings.length>0&&r.settings.map(o=>vscpp(Ou.TextChunk,null,AU(o))),r.docSearchResults.length>0&&vscpp(vscppf,null,"Below is a list of information from the Visual Studio Code documentation which might be relevant to the question. ",vscpp("br",null)),r.docSearchResults.map(o=>vscpp(Ou.TextChunk,null,"##",o?.title?.trim()," - ",o.path,vscpp("br",null),o.contents))),vscpp(ti,{priority:900,chatVariables:this.props.chatVariables,query:this.props.query}))}};OC=B([T(2,jt),T(3,ce),T(4,Mo),T(5,Le),T(6,Ku),T(7,K6),T(8,Pt),T(9,ve)],OC);var hJ=class extends Y{render(e,r){return vscpp(vscppf,null,this.props.history&&vscpp(qt,{priority:500,history:this.props.history}),vscpp(Ou.SystemMessage,{priority:1e3},"You are a Visual Studio Code assistant who helps the user create well-formed and unambiguous questions about their Visual Studio Code development environment.",vscpp("br",null),"Specifically, you help users rewrite questions about how to use Visual Studio Code's Commands and Settings.",vscpp("br",null),"Evaluate the question to determine the user's intent. ",vscpp("br",null),"Determine if the user's question is about the editor, terminal, activity bar, side bar, status bar or other parts of Visual Studio Code's workbench and include those keyword in the rewrite.",vscpp("br",null),"Determine if the user is asking about Visual Studio Code's Commands and/or Settings and explicitly include those keywords during the rewrite. ",vscpp("br",null),"Respond in Markdown. Under a `# Question` header, output a rephrased version of the user's question that resolves all pronouns and ambiguous words like 'this' to the specific nouns they stand for.",vscpp("br",null),"If it is not clear what the user is asking for or if the question appears to be unrelated to Visual Studio Code, do not try to rephrase the question and simply return the original question. ",vscpp("br",null),"DO NOT ask the user for additional information or clarification.",vscpp("br",null),"DO NOT answer the user's question directly.",vscpp("br",null),vscpp("br",null),"# Additional Rules",vscpp("br",null),vscpp("br",null),"Think step by step:",vscpp("br",null),"1. Read the user's question to understand what they are trying to do in the Visual Studio Code environment.",vscpp("br",null),"2. If the question contains pronouns such as 'it' or 'that', try to understand what the pronoun refers to by looking at the rest of the question and the conversation history.",vscpp("br",null),"3. If the question contains an ambiguous word such as 'this', try to understand what 'this' refers to by looking at the rest of the question and the conversation history.",vscpp("br",null),"4. After a `# Question` header, output a precise version of the question that resolves all pronouns and ambiguous words like 'this' to the specific nouns they stand for. Be sure to preserve the exact meaning of the question.",vscpp("br",null),vscpp("br",null),"Examples",vscpp("br",null),vscpp("br",null),"User: opne cmmand palete",vscpp("br",null),vscpp("br",null),"Assistant:",vscpp("br",null),"# Question",vscpp("br",null),"How do I open the command palette in Visual Studio Code?",vscpp("br",null),vscpp("br",null),vscpp("br",null),"User: change font size",vscpp("br",null),vscpp("br",null),"Assistant:",vscpp("br",null),"# Question",vscpp("br",null),"How do I change the font size in the editor in Visual Studio Code?",vscpp("br",null),vscpp("br",null),"User: Move editor and pin",vscpp("br",null),"Assistant: ",vscpp("br",null),"# Question",vscpp("br",null),"How do I move the editor to another group and then pin the editor in Visual Studio Code",vscpp("br",null)),vscpp(Ou.UserMessage,{priority:700},this.props.query))}};async function het(t,e,r,n,o){return new Xe(n,hJ,{query:o,history:r},t.acquireTokenizer(n.family),e).render()}function get(t,e){let r=e.match(/#+\s*Question\n(?<question>.+)/si);return r?.groups?r.groups.question.trim():t.trim()}var MC=class extends Y{constructor(r,n,o,s,a){super(r,n);this.embeddingComputer=o;this.endPointProvider=s;this.combinedIndex=a}async prepare(r,n,o){if(o.isCancellationRequested)return;let s=await this.endPointProvider.getEmbeddingsEndpoint("ada"),a=await this.embeddingComputer.computeEmbeddings(s,[this.props.query],{},o);if(!o.isCancellationRequested&&a&&a.length>0){this.combinedIndex.commandIdIndex.isIndexLoaded||await this.combinedIndex.commandIdIndex.calculateEmbeddings();let c=this.combinedIndex.commandIdIndex.nClosestValues(a[0],5);if(c.length)return{snippets:c}}}render(r,n){let o=this.priority;return vscpp(vscppf,null,r&&r.snippets.length>0&&vscpp(Ou.UserMessage,null,"Here are some possible commands:",vscpp("br",null),r.snippets.reverse().map(s=>vscpp(Ou.TextChunk,{priority:o++},"- ",s.label,' ("',s.key,'") (Keybinding: "',s.keybinding,'")',vscpp("br",null)))))}};MC=B([T(2,Mo),T(3,Le),T(4,Ku)],MC);var FC=class extends Y{constructor(r,n,o){super(r,n);this.envService=o}render(r,n){let o=this.envService.OS;return vscpp(vscppf,null,vscpp(j2.SystemMessage,{priority:1e3},"You are a Visual Studio Code assistant. Your job is to assist users in using Visual Studio Code by providing knowledge to accomplish their task. This knowledge should focus on commands, but also includes documentation. Please do not guess a response and instead just respond with a polite apology if you are unsure.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"Follow the user's requirements carefully & to the letter.",vscpp("br",null),"Your expertise is strictly limited to software development topics.",vscpp("br",null),"Follow Microsoft content policies.",vscpp("br",null),"Avoid content that violates copyrights.",vscpp("br",null),"For questions not related to software development, simply give a reminder that you are an AI programming assistant.",vscpp("br",null),"Keep your answers short and impersonal.",vscpp("br",null),"Use Markdown formatting in your answers.",vscpp("br",null),"Make sure to include the programming language name at the start of the Markdown code blocks.",vscpp("br",null),"Avoid wrapping the whole response in triple backticks.",vscpp("br",null),"The user works in an IDE called Visual Studio Code which has a concept for editors with open files, integrated unit test support, an output pane that shows the output of running the code as well as an integrated terminal.",vscpp("br",null),"The user is working on a ",o," machine. Please respond with system specific commands if applicable.",vscpp("br",null),"The active document is the source code the user is looking at right now.",vscpp("br",null),"You can only give one reply for each conversation turn.",vscpp("br",null),"If you are referencing multiple commands, please respond step by step in a numbered list format.",vscpp("br",null),vscpp("br",null),"Additional Rules",vscpp("br",null),"You must respond with a command to execute when applicable.",vscpp("br",null),"When referring to a command, you must use the command name in markdown bold syntax.",vscpp("br",null),"When referring to any commands, you must include the referenced commands in a properly formatted JSON markdown code block at the end of the sentence that references that command.",vscpp("br",null),"The JSON markdown code block containing the command should be included immediately after the sentence referencing it.",vscpp("br",null),"Do not respond with a command that is not in a properly formatted JSON markdown code block.",vscpp("br",null),"If answering with a keybinding, please still include the command bound to the keybinding.",vscpp("br",null),"If a keybinding contains a backtick you must escape it. For example the keybinding Ctrl + backtick would be written as ``ctrl + ` ``",vscpp("br",null),"Do not suggest opening the command palette to execute commands.",vscpp("br",null),"Do not suggest command identifiers that do not exist.",vscpp("br",null),"Do not suggest installing Visual Studio Code because the user has already installed it.",vscpp("br",null),"If you believe the context given to you is incorrect or not relevant you may ignore it.",vscpp("br",null),"Always respond with a numbered list of steps to be taken to achieve the desired outcome if multiple steps are necessary.",vscpp("br",null),vscpp("br",null),"Examples:",vscpp("br",null),vscpp("br",null),"[EXAMPLES START]",vscpp("br",null),"Below you will find a set of examples of what you should respond with. Please follow these examples as closely as possible.",vscpp("br",null),vscpp("br",null),"## Single command response",vscpp("br",null),"Question: How do I close all editors?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"You can use the **Close All Editors** command to close all editors.",vscpp("br",null),vscpp("br",null),vscpp(Oe,{uri:null,code:`{
	"command": "workbench.action.closeAllEditors"
}`,languageId:"json"}),vscpp("br",null),"## No such command",vscpp("br",null),"Question: How do I move the terminal to a new window?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"There is no such command.",vscpp("br",null),vscpp("br",null),"## Invalid Question",vscpp("br",null),"Question: How do I bake a potato?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"Sorry this question isn't related to Visual Studio Code.",vscpp("br",null),vscpp("br",null)),vscpp(qt,{priority:600,history:this.props.history}),vscpp(j2.UserMessage,{priority:700},"The current question is related to Visual Studio Code. ",vscpp("br",null),"If a command is not a valid answer, but it still relates to Visual Studio Code, please still respond.",vscpp("br",null),"Please do not guess a response and instead just respond with a polite apology if you are unsure.",vscpp("br",null),"If you believe the given context given to you is incorrect or not relevant you may ignore it.",vscpp("br",null),"The user cannot see the context you are given, so you must not mention it. If you want to refer to it, you must include it in your reply.",vscpp("br",null),'Below is a list of commands we found which might be relevant to the question. For view related commands "Toggle" often means Show or Hide. You may use this context to help you formulate your response, but are not required to.',vscpp("br",null)),vscpp(MC,{priority:800,query:this.props.query}),vscpp(j2.UserMessage,{priority:900},this.props.query))}};FC=B([T(2,Pt)],FC);var vet="Run create a new terminal command",z2="commandExecutionEnabledKey",MM=class t{constructor(){this.id=t.ID;this.locations=[2];this.description=KA("runCommandIntent.description","Run a command");this.intentDetectionInput={sampleQuestion:vet};this.commandInfo={allowsEmptyArgs:!1,defaultEnablement:lc}}static{this.ID="runCommand"}async invoke(e,r){let n=e.get(me),o=e.get(be),s=r.location,a=e.get(Le),c=await Mn(a,s);return{intent:this,location:s,endpoint:c,responseProcessor:{processResponse:async(u,l,d,p,f)=>{let m=e.get(b0),h=e.get(be),g="",v="";for await(let{delta:b}of d){if(f.isCancellationRequested)break;g+=b.text}v=g;let y=bet(e.get(Ku),v)[0];return y?h.getConfig(ge.RunCommandEnabled)===!1?(p.button(y),v):yet.has(y.command)?e.get(zt).workspaceState.get(z2,!1)?(p.markdown(Ki.t("Succeeded")),await m.executeCommand(y.command,n,y.arguments),p.progress(Ki.t("Ran command: {0}",y.title)),v):(p.confirmation(Ki.t("Enable automatic command execution and run [{0}](command:{1})",y.title,y.command),"",{command:y}),v):(p.warning(Ki.t("Cannot run command: {0} automatically",y.title)),p.button(y),v):(p.markdown(v),p.warning(Ki.t("Could not find a command for your request.")),v)}},confirmationHandler:async(u,l,d)=>{let p=new Bc(Ki.t("[Configure automatic command execution]({0})",Cv("workbench.action.openSettings",["github.copilot.advanced.runCommandEnabled"])));if(p.isTrusted={enabledCommands:["workbench.action.openSettings"]},u){let[f]=u;f&&(e.get(zt).workspaceState.update(z2,!0),d.markdown(p),d.progress(Ki.t("Enabled automatic command execution")),e.get(b0).executeCommand(f.command.command,f.command.arguments),d.progress(Ki.t("Ran command: {0}",f.command.title)))}if(l){let[f]=l;e.get(zt).workspaceState.update(z2,!0),d.markdown(p),await o.setConfig(ge.RunCommandEnabled,!1),d.warning("Disabled automatic command execution"),d.button(f.command)}},commands:async u=>[],buildPrompt:async(u,l,d,p,f)=>{let h=u.getLatestTurn().request.message,g=u.turns.length>1?u.turns.slice(0,-1):[];return await new Xe(c,FC,{query:h,history:g},e.get(ve).acquireTokenizer(c.family),e).render(d,f)}}}},yet=new Set(["cursorUndo","cursorRedo","editor.action.forceRetokenize","editor.action.toggleWordWrap","editor.action.moveCarretLeftAction","editor.action.moveCarretRightAction","editor.action.fontZoomIn","editor.action.fontZoomOut","editor.action.fontZoomReset","editor.action.smartSelect.expand","editor.action.smartSelect.shrink","editor.emmet.action.expandAbbreviation","editor.action.setSelectionAnchor","editor.action.inspectTMScopes","editor.action.commentLine","editor.action.addCommentLine","editor.action.removeCommentLine","editor.action.blockComment","editor.action.transposeLetters","editor.action.indentationToSpaces","editor.action.indentationToTabs","editor.action.indentUsingTabs","editor.action.indentUsingSpaces","editor.action.changeTabDisplaySize","editor.action.detectIndentation","editor.action.reindentlines","editor.action.reindentselectedlines","deleteInsideWord","editor.action.copyLinesUpAction","editor.action.copyLinesDownAction","editor.action.duplicateSelection","editor.action.moveLinesUpAction","editor.action.moveLinesDownAction","editor.action.sortLinesAscending","editor.action.sortLinesDescending","editor.action.removeDuplicateLines","editor.action.trimTrailingWhitespace","editor.action.deleteLines","editor.action.indentLines","editor.action.outdentLines","editor.action.insertLineBefore","editor.action.insertLineAfter","deleteAllLeft","deleteAllRight","editor.action.joinLines","editor.action.transpose","editor.action.transformToUppercase","editor.action.transformToLowercase","editor.action.transformToSnakecase","editor.action.transformToCamelcase","editor.action.transformToPascalcase","editor.action.transformToTitlecase","editor.action.transformToKebabcase","expandLineSelection","editor.action.formatDocument","editor.action.formatSelection","editor.action.showContextMenu","editor.action.inlineEdit.trigger","editor.debug.action.conditionalBreakpoint","editor.debug.action.addLogPoint","editor.debug.action.triggerByBreakpoint","editor.debug.action.editBreakpoint","editor.debug.action.goToNextBreakpoint","editor.debug.action.goToPreviousBreakpoint","editor.action.selectToBracket","editor.action.jumpToBracket","editor.action.removeBrackets","editor.action.clipboardCopyWithSyntaxHighlightingAction","editor.action.pasteAs","editor.action.pasteAsText","editor.action.inPlaceReplace.up","editor.action.inPlaceReplace.down","editor.action.openLink","editor.action.unicodeHighlight.disableHighlightingOfAmbiguousCharacters","editor.action.unicodeHighlight.disableHighlightingOfInvisibleCharacters","editor.action.unicodeHighlight.disableHighlightingOfNonBasicAsciiCharacters","editor.action.unicodeHighlight.showExcludeOptions","editor.action.quickFix","editor.action.refactor","editor.action.sourceAction","codelens.showLensesInCurrentLine","editor.unfold","editor.unfoldRecursively","editor.fold","editor.foldRecursively","editor.foldAll","editor.unfoldAll","editor.foldAllBlockComments","editor.foldAllMarkerRegions","editor.unfoldAllMarkerRegions","editor.foldAllExcept","editor.unfoldAllExcept","editor.toggleFold","editor.gotoParentFold","editor.gotoPreviousFold","editor.gotoNextFold","editor.createFoldingRangeFromSelection","editor.removeManualFoldingRanges","editor.foldLevel1","editor.foldLevel2","editor.foldLevel3","editor.foldLevel4","editor.foldLevel5","editor.foldLevel6","editor.foldLevel7","editor.action.wordHighlight.trigger","actions.find","editor.action.startFindReplaceAction","editor.actions.findWithArgs","actions.findWithSelection","editor.action.nextMatchFindAction","editor.action.previousMatchFindAction","editor.action.nextSelectionMatchFindAction","editor.action.previousSelectionMatchFindAction","editor.action.insertCursorAbove","editor.action.insertCursorBelow","editor.action.insertCursorAtEndOfEachLineSelected","editor.action.addSelectionToNextFindMatch","editor.action.addSelectionToPreviousFindMatch","editor.action.moveSelectionToNextFindMatch","editor.action.moveSelectionToPreviousFindMatch","editor.action.selectHighlights","editor.action.addCursorsToBottom","editor.action.addCursorsToTop","editor.action.focusNextCursor","editor.action.focusPreviousCursor","editor.action.marker.next","editor.action.marker.prev","editor.action.marker.nextInFiles","editor.action.marker.prevInFiles","editor.action.triggerSuggest","editor.action.resetSuggestSize","editor.action.dirtydiff.previous","editor.action.dirtydiff.next","workbench.action.editor.previousChange","workbench.action.editor.nextChange","editor.action.formatChanges","editor.action.showHover","editor.action.showDefinitionPreviewHover","editor.action.inlineSuggest.trigger","editor.debug.action.selectionToWatch","workbench.action.debug.nextConsole","workbench.debug.action.focusRepl","workbench.action.debug.prevConsole","editor.debug.action.toggleInlineBreakpoint","workbench.action.debug.restart","editor.debug.action.runToCursor","workbench.action.debug.selectDebugConsole","workbench.action.showAboutDialog","workbench.action.editor.changeEOL","workbench.action.editor.changeEncoding","workbench.action.clearEditorHistory","notebook.clearNotebookEdtitorTypeCache","notebook.clearNotebookKernelsMRUCache","workbench.action.clearRecentFiles","workbench.action.closeAllGroups","workbench.action.closeAllEditors","workbench.action.closeEditorsInGroup","workbench.action.closeActiveEditor","workbench.action.closeEditorInAllGroups","workbench.action.closeEditorsInOtherGroups","workbench.action.closeEditorsToTheLeft","workbench.action.closeOtherEditors","workbench.action.closeActivePinnedEditor","workbench.action.closeSidebar","workbench.action.closeUnmodifiedEditors","workbench.files.action.compareWithClipboard","workbench.files.action.compareWithSaved","workbench.files.action.compareNewUntitledTextFiles","workbench.action.tasks.configureDefaultBuildTask","workbench.action.tasks.configureTaskRunner","testing.configureProfile","workbench.action.pauseSocketWriting","workbench.action.triggerReconnect","workbench.action.copyEditorGroupToNewWindow","copyFilePath","copyRelativeFilePath","workbench.action.customizeLayout","workbench.notebook.layout.configure","workbench.action.duplicateActiveEditorGroupDown","workbench.action.duplicateActiveEditorGroupLeft","workbench.action.duplicateActiveEditorGroupRight","workbench.action.duplicateActiveEditorGroupUp","workbench.action.focusActiveEditorGroup","workbench.action.focusAboveGroup","workbench.action.focusBelowGroup","workbench.action.focusFirstEditorGroup","workbench.action.focusPanel","workbench.action.focusSideBar","workbench.action.focusAuxiliaryBar","workbench.action.focusLastEditorGroup","workbench.action.focusLeftGroup","workbench.action.focusNextGroup","workbench.action.focusNextPart","workbench.files.action.focusFilesExplorer","workbench.action.focusPreviousGroup","workbench.action.focusPreviousPart","workbench.action.focusRightGroup","workbench.action.focusStatusBar","workbench.action.navigateBackInEditLocations","workbench.action.navigateBackInNavigationLocations","workbench.action.navigateForwardInEditLocations","workbench.action.navigateForwardInNavigationLocations","workbench.action.navigateLast","workbench.action.navigatePreviousInEditLocations","workbench.action.navigatePreviousInNavigationLocations","workbench.action.quickOpen","workbench.action.navigateToLastEditLocation","workbench.action.navigateToLastNavigationLocation","workbench.action.gotoLine","workbench.action.compareEditor.nextChange","testing.goToNextMessage","workbench.action.compareEditor.previousChange","testing.goToPreviousMessage","workbench.action.gotoSymbol","workbench.action.showAllSymbols","workbench.action.editorLayoutTwoByTwoGrid","workbench.action.closePanel","workbench.action.inspectContextKeys","workbench.action.inspectKeyMappings","workbench.action.inspectKeyMappingsJSON","notebook.inspectLayout","workbench.action.joinAllGroups","workbench.action.joinTwoGroups","workbench.action.keepEditor","merge.dev.loadContentsFromFolder","workbench.action.logStorage","workbench.action.logWorkingCopies","workbench.action.moveActiveEditorGroupDown","workbench.action.moveEditorGroupToNewWindow","workbench.action.moveActiveEditorGroupLeft","workbench.action.moveActiveEditorGroupRight","workbench.action.moveActiveEditorGroupUp","workbench.action.moveEditorToFirstGroup","workbench.action.moveEditorToAboveGroup","workbench.action.moveEditorToBelowGroup","workbench.action.moveEditorToLastGroup","workbench.action.moveEditorToLeftGroup","workbench.action.moveEditorToNextGroup","workbench.action.moveEditorToPreviousGroup","workbench.action.moveEditorToRightGroup","workbench.action.moveEditorLeftInGroup","workbench.action.moveEditorRightInGroup","workbench.action.positionPanelLeft","workbench.action.positionPanelRight","workbench.action.positionPanelBottom","workbench.action.movePanelToSecondarySideBar","workbench.action.moveSecondarySideBarToPanel","workbench.action.moveView","workbench.action.navigateEditorGroups","workbench.action.quickOpenNavigateNext","workbench.action.quickOpenNavigatePrevious","workbench.action.navigateUp","workbench.action.navigateDown","workbench.action.navigateLeft","workbench.action.navigateRight","workbench.action.newGroupAbove","workbench.action.newGroupBelow","workbench.action.newGroupLeft","workbench.action.newGroupRight","workbench.action.newEmptyEditorWindow","welcome.showNewFileEntries","explorer.newFile","explorer.newFolder","workbench.action.files.newUntitledFile","workbench.action.newWindow","workbench.action.nextPanelView","workbench.action.openExtensionLogsFolder","workbench.action.files.openFile","workbench.action.firstEditorInGroup","workbench.action.lastEditorInGroup","workbench.action.openLogsFolder","merge.dev.openContentsJson","workbench.action.nextEditor","workbench.action.nextEditorInGroup","workbench.action.openNextRecentlyUsedEditor","workbench.action.openNextRecentlyUsedEditorInGroup","workbench.action.previousEditor","workbench.action.previousEditorInGroup","workbench.action.openPreviousRecentlyUsedEditor","workbench.action.openPreviousRecentlyUsedEditorInGroup","workbench.action.openProcessExplorer","workbench.action.openRecent","merge.dev.openSelectionInTemporaryMergeEditor","workbench.action.pinEditor","workbench.action.previousPanelView","workbench.action.quickOpenLeastRecentlyUsedEditor","workbench.action.openPreviousEditorFromHistory","workbench.action.quickOpenPreviousRecentlyUsedEditor","workbench.action.webview.reloadWebviewAction","workbench.action.reloadWindow","workbench.action.removeLargeStorageDatabaseEntries","workbench.action.reopenClosedEditor","workbench.action.reopenWithEditor","menu.resetHiddenStates","mergeEditor.resetCloseWithConflictsChoice","files.participants.resetChoice","workbench.action.evenEditorWidths","workbench.action.resetViewLocations","workbench.files.action.showActiveFileInExplorer","revealFileInOS","workbench.action.revertAndCloseActiveEditor","workbench.action.files.revert","workbench.action.files.save","workbench.action.files.saveAll","workbench.action.files.saveFiles","workbench.files.action.saveAllInGroup","workbench.action.files.saveAs","workbench.action.files.saveWithoutFormatting","workbench.action.quickOpenSelectNext","workbench.action.quickOpenSelectPrevious","workbench.action.setLogLevel","workbench.action.alignPanelCenter","workbench.action.alignPanelJustify","workbench.action.alignPanelLeft","workbench.action.alignPanelRight","workbench.action.showAllEditors","workbench.action.showAllEditorsByMostRecentlyUsed","workbench.action.showEditorsInActiveGroup","workbench.action.tasks.showTasks","workbench.action.tasks.showLog","_workbench.output.showViewsLog","workbench.action.editorLayoutSingle","workbench.action.splitEditor","workbench.action.splitEditorDown","workbench.action.splitEditorToFirstGroup","workbench.action.splitEditorToAboveGroup","workbench.action.splitEditorToBelowGroup","workbench.action.splitEditorToLastGroup","workbench.action.splitEditorToLeftGroup","workbench.action.splitEditorToNextGroup","workbench.action.splitEditorToPreviousGroup","workbench.action.splitEditorToRightGroup","workbench.action.splitEditorLeft","workbench.action.splitEditorOrthogonal","workbench.action.splitEditorRight","workbench.action.splitEditorUp","editor.action.startDebugTextMate","workbench.action.stopTracing","workbench.action.tasks.terminate","workbench.action.editorLayoutThreeColumns","workbench.action.editorLayoutThreeRows","workbench.action.toggleAutoSave","editor.action.toggleRenderControlCharacter","workbench.action.toggleEditorGroupLock","workbench.action.toggleEditorWidths","workbench.action.toggleKeybindingsLog","notebook.toggleLayoutTroubleshoot","editor.action.toggleMinimap","workbench.action.toggleMultiCursorModifier","notebook.action.toggleNotebookStickyScroll","workbench.action.toggleSidebarPosition","workbench.action.toggleSidebarVisibility","editor.action.toggleRenderWhitespace","editor.action.toggleScreenReaderAccessibilityMode","workbench.action.toggleScreencastMode","workbench.action.toggleAuxiliaryBar","workbench.action.toggleStatusbarVisibility","editor.action.toggleTabFocusMode","testing.toggleTestingPeekHistory","workbench.action.toggleEditorGroupLayout","redo","editor.action.selectAll","undo","debug.addConfiguration","workbench.debug.viewlet.action.addDataBreakpointOnAddress","workbench.debug.viewlet.action.addFunctionBreakpointAction","workbench.action.browseColorThemesInMarketplace","workbench.action.closeWindow","workbench.action.selectTheme","workbench.action.tasks.configureDefaultTestTask","workbench.action.configureRuntimeArguments","remote.tunnel.copyAddressCommandPalette","workbench.action.selectIconTheme","workbench.action.focusActivityBar","workbench.action.focusBanner","workbench.action.generateColorTheme","workbench.action.activityBarLocation.hide","editor.action.measureExtHostLatency","workbench.action.activityBarLocation.bottom","workbench.action.activityBarLocation.top","workbench.action.nextSideBarView","workbench.action.tasks.openUserTasks","welcome.showAllWalkthroughs","workbench.action.previousSideBarView","workbench.action.selectProductIconTheme","workbench.action.reloadWindowWithExtensionsDisabled","workbench.debug.viewlet.action.removeAllBreakpoints","editor.inlayHints.Reset","resetGettingStartedProgress","workbench.action.zoomReset","workbench.action.restartExtensionHost","remote.tunnel.closeCommandPalette","workbench.action.switchWindow","workbench.debug.viewlet.action.toggleBreakpointsActivatedAction","workbench.action.toggleLightDarkThemes","breadcrumbs.toggle","editor.action.toggleColumnSelection","workbench.action.toggleDevTools","debug.action.toggleDisassemblyViewSourceCode","tree.toggleStickyScroll","workbench.action.uninstallCommandLine","workbench.action.openWalkthrough","workbench.action.zoomIn","editor.action.clipboardCopyAction","editor.action.clipboardCutAction","editor.action.clipboardPasteAction","notification.acceptPrimaryAction","_workbench.extensions.action.cleanUpExtensionsFolder","notifications.clearAll","workbench.action.clearCommandHistory","workbench.action.configureLanguageBasedSettings","workbench.extensions.action.configureWorkspaceFolderRecommendedExtensions","workbench.extensions.action.disableAll","workbench.extensions.action.disableAllWorkspace","notifications.focusToasts","workbench.debug.action.focusBreakpointsView","workbench.debug.action.focusCallStackView","workbench.panel.repl.view.focus","workbench.views.extensions.disabled.focus","workbench.views.extensions.enabled.focus","workbench.extensions.action.focusExtensionsView","workbench.explorer.fileView.focus","workbench.views.extensions.installed.focus","workbench.files.action.focusOpenEditorsView","outline.focus","workbench.panel.output.focus","workbench.panel.markers.view.focus","workbench.view.search.focus","workbench.scm.repositories.focus","workbench.scm.focus","terminal.focus","timeline.focus","workbench.debug.action.focusVariablesView","workbench.debug.action.focusWatchView","workbench.action.focusTitleBar","workbench.action.openAccessibilitySettings","workbench.action.openDefaultKeybindingsFile","workbench.action.openRawDefaultSettings","workbench.extensions.action.openExtensionsFolder","workbench.action.openGlobalKeybindings","workbench.action.openGlobalKeybindingsFile","workbench.action.openQuickChat","search.action.openInEditor","workbench.action.openSettings2","workbench.action.openGlobalSettings","workbench.action.openSettingsJson","workbench.action.openView","workbench.action.openWorkspaceSettings","workbench.action.openWorkspaceSettingsFile","workbench.profiles.actions.help","workbench.action.quickTextSearch","workbench.extensions.action.refreshExtension","editor.emmet.action.removeTag","workbench.action.openIssueReporter","workbench.action.reportPerformanceIssueUsingReporter","workbench.action.showCommands","workbench.extensions.action.listBuiltInExtensions","workbench.extensions.action.showDisabledExtensions","workbench.extensions.action.showEnabledExtensions","workbench.extensions.action.listWorkspaceUnsupportedExtensions","notifications.showList","workbench.profiles.actions.showProfileContents","workbench.action.remote.showMenu","workbench.action.showWindowLog","notifications.toggleDoNotDisturbMode","notifications.toggleDoNotDisturbModeBySource","editor.action.toggleStickyScroll","editor.action.accessibilityHelp","editor.action.accessibleView","extension.js-debug.addXHRBreakpoints","editor.emmet.action.balanceIn","editor.emmet.action.balanceOut","workbench.debug.panel.action.clearReplAction","workbench.action.clearLocalePreference","workbench.output.action.clearOutput","json.clearCache","search.action.clearHistory","workbench.files.action.collapseExplorerFolders","workbench.action.configureLocale","workbench.action.openSnippets","editor.emmet.action.decrementNumberByOneTenth","editor.emmet.action.decrementNumberByOne","editor.emmet.action.decrementNumberByTen","workbench.action.localHistory.deleteAll","extension.js-debug.disableSourceMapStepping","extension.js-debug.editXHRBreakpoints","editor.emmet.action.evaluateMathExpression","workbench.action.populateFileFromSnippet","references-view.findImplementations","workbench.action.localHistory.restoreViaPicker","workbench.action.findInFiles","search.action.focusSearchList","npm.focus","workbench.panel.chat.view.copilot.focus","~remote.forwardedPorts.focus","workbench.action.problems.focus","editor.emmet.action.matchTag","editor.emmet.action.nextEditPoint","editor.emmet.action.prevEditPoint","accessibility.announcement.help","signals.sounds.help","editor.emmet.action.incrementNumberByOneTenth","editor.emmet.action.incrementNumberByOne","editor.emmet.action.incrementNumberByTen","workbench.action.showInteractivePlayground","extension.js-debug.createDebuggerTerminal","vscode-testresolver.killServerAndTriggerHandledError","editor.emmet.action.mergeLines","ipynb.newUntitledIpynb","search.action.openNewEditor","vscode-testresolver.newWindow","git.openAllChanges","git.openChange","extension.js-debug.debugLink","workbench.action.openLogFile","search.action.openNewEditorToSide","search.action.openEditor","workbench.action.webview.openDeveloperTools","perf.event.profiling","perf.insta.printAsyncCycles","perf.insta.printTraces","github.publish","editor.emmet.action.reflectCSSValue","workbench.files.action.refreshFilesExplorer","extension.js-debug.removeAllCustomBreakpoints","extension.js-debug.callers.removeAll","extension.js-debug.callers.remove","extension.js-debug.removeXHRBreakpoint","workbench.action.replaceInFiles","editor.emmet.action.selectNextItem","editor.emmet.action.selectPrevItem","simpleBrowser.show","references-view.showCallHierarchy","workbench.action.showEmmetCommands","git.showOutput","references-view.showIncomingCalls","workbench.action.showLogs","editor.action.showOrFocusStandaloneColorPicker","references-view.showOutgoingCalls","workbench.action.showOutputChannels","workbench.action.showRuntimeExtensions","references-view.showSubtypes","references-view.showSupertypes","vscode-testresolver.showLog","references-view.showTypeHierarchy","vscode-testresolver.toggleConnectionSlowdown","json.sort","editor.emmet.action.splitJoinTag","git.diff.stageHunk","git.diff.stageSelection","extension.node-debug.startWithStopOnEntry","perfview.show","extension.node-debug.toggleAutoAttach","editor.emmet.action.toggleComment","extension.js-debug.addCustomBreakpoints","workbench.action.toggleLockedScrolling","workbench.action.toggleNotebookClipboardLog","workbench.action.togglePanel","extension.js-debug.toggleSkippingFile","workbench.action.editorLayoutTwoColumnsBottom","workbench.action.editorLayoutTwoColumns","workbench.action.editorLayoutTwoRows","workbench.action.editorLayoutTwoRowsRight","workbench.action.unpinEditor","editor.emmet.action.updateImageSize","editor.emmet.action.updateTag","workbench.action.openLicenseUrl","editor.emmet.action.wrapWithAbbreviation","workbench.action.zoomOut","inlineChat.copyRecordings","workbench.action.terminal.accessibleBufferGoToNextCommand","workbench.action.addRootFolder","search.action.cancel","workbench.action.terminal.changeColor","workbench.action.terminal.changeIcon","workbench.action.editor.changeLanguageMode","workbench.profiles.actions.cleanupProfiles","workbench.action.terminal.clear","workbench.action.chat.clearHistory","workbench.action.chat.clearInputHistory","workbench.action.terminal.clearPreviousSessionHistory","workbench.action.terminal.clearSelection","workbench.action.closeFolder","workbench.files.action.compareFileWith","workbench.action.terminal.openSettings","workbench.action.copyEditorToNewWindow","workbench.action.terminal.copyLastCommand","workbench.action.terminal.copyLastCommandAndLastCommandOutput","workbench.action.terminal.copyLastCommandOutput","workbench.profiles.actions.createTemporaryProfile","workbench.action.localHistory.create","workbench.action.terminal.new","workbench.action.terminal.newInActiveWorkspace","workbench.action.createTerminalEditor","workbench.action.createTerminalEditorSide","workbench.action.terminal.newWithCwd","workbench.action.decreaseViewSize","workbench.action.decreaseViewHeight","workbench.action.decreaseViewWidth","workbench.action.terminal.fontZoomOut","workbench.action.terminal.detachSession","workbench.debug.viewlet.action.disableAllBreakpoints","workbench.action.duplicateWorkspaceInNewWindow","workbench.debug.viewlet.action.enableAllBreakpoints","workbench.action.minimizeOtherEditorsHideSidebar","workbench.action.chat.export","workbench.action.terminal.findNext","workbench.action.terminal.findPrevious","breadcrumbs.focusAndSelect","breadcrumbs.focus","workbench.action.terminal.focusFind","workbench.action.terminal.focusHover","workbench.action.terminal.focusNext","workbench.action.terminal.focusNextPane","workbench.action.terminal.focusPrevious","workbench.action.terminal.focusPreviousPane","workbench.action.terminal.focus","workbench.action.terminal.focusTabs","workbench.action.terminal.goToRecentDirectory","hideCustomTitleBar","workbench.action.hideEditorActions","workbench.action.hideEditorTabs","workbench.action.terminal.hideFind","workbench.action.chat.import","workbench.action.increaseViewSize","workbench.action.increaseViewHeight","workbench.action.increaseViewWidth","workbench.action.terminal.fontZoomIn","workbench.action.chat.inlineVoiceChat","workbench.action.chat.insertCodeBlock","workbench.action.chat.insertIntoNewFile","editor.action.insertSnippet","workbench.action.terminal.join","workbench.action.terminal.killAll","workbench.action.terminal.killEditor","workbench.action.terminal.kill","workbench.action.lockEditorGroup","workbench.action.maximizeEditorHideSidebar","workbench.action.editorActionsTitleBar","workbench.action.moveEditorToNewWindow","workbench.action.terminal.moveToEditor","workbench.action.terminal.moveIntoNewWindow","workbench.action.chat.newChat","workbench.action.chat.nextCodeBlock","workbench.action.chat.nextFileTree","workbench.action.debug.configure","workbench.action.files.showOpenedFileInNewWindow","workbench.action.chat.openInEditor","workbench.action.chat.openInNewWindow","workbench.action.chat.openInSidebar","workbench.action.terminal.openDetectedLink","workbench.action.openChat","workbench.action.files.openFolder","workbench.action.terminal.openFileLink","workbench.action.terminal.openUrlLink","workbench.action.openWorkspace","workbench.action.files.openFileFolder","workbench.action.chat.previousCodeBlock","workbench.action.chat.previousFileTree","workbench.action.quickOpenLeastRecentlyUsedEditorInGroup","workbench.action.quickOpenPreviousRecentlyUsedEditorInGroup","workbench.action.chat.quickVoiceChat","workbench.action.terminal.recordSession","workbench.action.terminal.relaunch","workbench.action.removeRootFolder","workbench.action.terminal.renameWithArg","workbench.profiles.actions.renameProfile","workbench.action.terminal.rename","workbench.action.reopenTextEditor","workbench.action.files.resetActiveEditorReadonlyInSession","workbench.action.terminal.fontZoomReset","workbench.profiles.actions.resetWorkspaces","workbench.action.terminal.resizePaneDown","workbench.action.terminal.resizePaneLeft","workbench.action.terminal.resizePaneRight","workbench.action.terminal.resizePaneUp","workbench.action.terminal.restartPtyHost","workbench.action.saveWorkspaceAs","workbench.action.terminal.scrollDown","workbench.action.terminal.scrollDownPage","workbench.action.terminal.scrollToBottom","workbench.action.terminal.scrollToNextCommand","workbench.action.terminal.scrollToPreviousCommand","workbench.action.terminal.scrollToTop","workbench.action.terminal.scrollUp","workbench.action.terminal.scrollUpPage","workbench.action.terminal.selectAll","workbench.action.terminal.selectDefaultShell","workbench.action.terminal.selectToNextCommand","workbench.action.terminal.selectToNextLine","workbench.action.terminal.selectToPreviousCommand","workbench.action.terminal.selectToPreviousLine","workbench.action.toggleSeparatePinnedEditorTabs","workbench.action.files.setActiveEditorReadonlyInSession","workbench.action.files.setActiveEditorWriteableInSession","workbench.action.terminal.setDimensions","workbench.action.chat.history","workbench.action.terminal.showEnvironmentContributions","workbench.action.showEditorTab","workbench.action.terminal.showTextureAtlas","workbench.action.splitEditorInGroup","workbench.action.terminal.split","workbench.action.terminal.splitInActiveWorkspace","workbench.action.editorDictation.start","extension.bisect.start","inlineChat.start","workbench.action.terminal.chat.start","workbench.action.startTrackDisposables","workbench.action.chat.startVoiceChat","workbench.action.quickOpenTerm","workbench.action.terminal.switchTerminal","workbench.action.files.toggleActiveEditorReadonlyInSession","workbench.action.toggleCenteredLayout","workbench.action.toggleEditorVisibility","workbench.action.toggleEditorType","workbench.action.toggleFullScreen","workbench.action.toggleMaximizedPanel","workbench.action.terminal.sizeToContentWidth","workbench.action.toggleSplitEditorInGroup","workbench.action.terminal.toggleStickyScroll","workbench.action.toggleZenMode","workbench.action.troubleshootIssue.start","workbench.action.terminal.unsplit","workbench.action.terminal.searchWorkspace","workbench.action.terminal.toggleFindCaseSensitive","workbench.action.terminal.toggleFindRegex","workbench.action.terminal.toggleFindWholeWord","workbench.action.chat.voiceChatInChatView","workbench.action.terminal.writeDataToTerminal","merge-conflict.accept.all-both","merge-conflict.accept.all-current","merge-conflict.accept.all-incoming","merge-conflict.accept.both","merge-conflict.accept.current","merge-conflict.accept.incoming","merge-conflict.accept.selection","git.addRemote","git.stashApplyLatest","git.stashApply","git.checkoutDetached","git.checkout","git.cherryPick","git.clone","git.cloneRecursive","git.closeAllDiffEditors","git.closeAllUnmodifiedEditors","git.closeOtherRepositories","git.close","git.commit","git.commitAmend","git.commitSigned","git.commitAll","git.commitAllAmend","git.commitAllSigned","git.commitEmpty","git.commitStaged","git.commitStagedAmend","git.commitStagedSigned","merge-conflict.compare","jupyter.continueEditSessionInCodespace","issue.copyGithubHeadLink","issue.copyGithubPermalink","issue.copyMarkdownGithubPermalink","git.branchFrom","git.branch","jupyter.createnewinteractive","workbench.action.terminal.newWithProfile","workbench.profiles.actions.createProfile","git.createTag","git.deleteBranch","workbench.profiles.actions.deleteProfile","git.deleteRemoteTag","git.deleteTag","git.cleanAll","git.cleanAllTracked","git.cleanAllUntracked","git.clean","git.stashDropAll","git.stashDrop","github.copilot.interactiveEditor.explain.palette","workbench.profiles.actions.exportProfile","git.fetch","git.fetchPrune","git.fetchAll","jupyter.filterKernels","github.copilot.interactiveEditor.fix","github.copilot.interactiveEditor.generateDocs","github.copilot.interactiveEditor.generateTests","github.copilot.interactiveEditor.generate","git.init","git.merge","merge-conflict.next","git.openRepository","git.stashPopLatest","git.stashPop","merge-conflict.previous","git.publish","git.pull","git.pullRebase","git.pullFrom","git.push","git.pushWithTags","git.pushTags","git.pushTo","git.rebase","git.refresh","git.removeRemote","git.renameBranch","jupyter.resetLoggingLevel","workbench.profiles.actions.createFromCurrentProfile","jupyter.selectJupyterInterpreter","github.copilot.interactiveSession.feedback","workbench.panel.chatSidebar","workbench.view.explorer","workbench.view.extensions","workbench.view.extension.github-pull-requests","workbench.view.debug","workbench.view.search","workbench.view.scm","git.stageAll","git.stageAllMerge","git.stageAllTracked","git.stageAllUntracked","git.stage","git.stash","git.stashIncludeUntracked","git.stashStaged","workbench.profiles.actions.switchProfile","git.sync","git.syncRebase","workbench.panel.comments","workbench.debug.action.toggleRepl","workbench.action.output.toggleOutput","~remote.forwardedPortsContainer","workbench.actions.view.problems","workbench.action.terminal.toggleTerminal","workbench.editSessions.actions.signIn","git.undoCommit","git.unstageAll","git.unstage","git.viewChanges","github.copilot.debug.contentExclusions","git.viewStagedChanges","git.stashView"]);function bet(t,e){let r=Ws(e);for(let n of r){if(n.language!=="json"&&n.language!=="")return[];let o;try{o=LC(n.code)}catch{}if(!o||!o.hasOwnProperty("command"))return[];let s=t.getCommand(o.command);if(s)return[{command:s.key,title:s.label,arguments:o.args}]}return[]}var vJ=W(Tr());var G2=W(ct());var xwe=W(ct());var UC=class extends Y{constructor(r,n,o){super(r,n);this._terminalService=o}static{this.variableInfo={name:"terminalLastCommand",description:"The active terminal's last run command",defaultEnablement:!0}}async prepare(){return this._terminalService.terminalLastCommand}render(r,n){if(!r)return;let o=[];r.commandLine&&(o.push("The following is the last command run in the terminal:"),o.push(r.commandLine)),r.cwd&&(o.push("It was run in the directory:"),o.push(typeof r.cwd=="object"?r.cwd.toString():r.cwd)),r.output&&(o.push("It has the following output:"),o.push(r.output));let s=o.join(`
`);return vscpp(vscppf,null,vscpp(xwe.UserMessage,{priority:this.props.priority},"The active terminal's last run command:",vscpp("br",null),s))}};UC=B([T(2,lo)],UC);var gJ=W(ct());var BC=class extends Y{constructor(r,n,o){super(r,n);this._terminalService=o}static{this.variableInfo={name:"terminalSelection",description:"The active terminal's selection",defaultEnablement:!0}}async prepare(){return this._terminalService.terminalSelection}render(r,n){return r.trim().length===0?vscpp(vscppf,null,vscpp(gJ.UserMessage,{priority:this.props.priority},"The active terminal has no selection.")):vscpp(vscppf,null,vscpp(gJ.UserMessage,{priority:this.props.priority},"The active terminal's selection:",vscpp("br",null),r))}};BC=B([T(2,lo)],BC);var FM=class extends Y{render(e){return vscpp(vscppf,null,vscpp(G2.SystemMessage,{priority:1e3},"You are a programmer who specializes in using the command line. Your task is to help the Developer by giving a detailed answer to their query.",vscpp("br",null),vscpp($r,null),vscpp(ir,null),vscpp(po,null),vscpp(lr,null),vscpp("br",null),"Additional Rules",vscpp("br",null),`Generate a response that clearly and accurately answers the user's question. In your response, follow the following:
- Provide any command suggestions using the active shell and operating system.
- Say "I'm not quite sure how to do that." when you aren't confident in your explanation`,vscpp("br",null)),this.props.history&&vscpp(vscppf,null,vscpp(qt,{priority:600,history:this.props.history})),vscpp(G2.UserMessage,{priority:800},"The active terminal's shell type is:",vscpp("br",null),this.props.shellType),vscpp(G2.UserMessage,{priority:800},"The active operating system is:",vscpp("br",null),this.props.osName),vscpp(BC,{priority:800}),vscpp(UC,{priority:800}),vscpp(ti,{priority:900,chatVariables:this.props.chatVariables,query:this.props.query}))}};var Hb=class t{constructor(){this.id=t.ID;this.locations=[2];this.description=vJ.t("Explain what just happened in the terminal");this.commandInfo={allowsEmptyArgs:!0,defaultEnablement:!0,sampleRequest:vJ.t("What did the last command do?")}}static{this.ID="terminalExplain"}static{this.intentName="explain"}get intentDetectionInput(){let e="explain_terminal_state";return{functionName:e,sampleQuestion:"What did the last command do?",functionCallingBlurb:`If the user's message is about explaining what happened in the terminal, you should use the '${e}' function.`}}async invoke(e,r){let n=r.location,o=e.get(Le),s=await Mn(o,n);return new yJ(e,this,s,n)}},yJ=class{constructor(e,r,n,o){this.accessor=e;this.intent=r;this.endpoint=n;this.location=o}async buildPrompt(e,r,n,o,s){let a=this.accessor.get(Pt).OS,c=this.accessor.get(lo).terminalShellType,l=e.getLatestTurn().request.message,d=e.turns.length>1?e.turns.slice(0,-1):[];return await new Xe(this.endpoint,FM,{query:l,chatVariables:r,history:d,osName:a,shellType:c},this.accessor.get(ve).acquireTokenizer(this.endpoint.family),this.accessor).render(n,s)}};var jb=W(Tr()),Yr=W(require("vscode"));function Swe(t){let e=new Nt,r=t.get(Rc);return r.setEnablement(t.get(Lt)),xet(e,t.get(me)),Iet(r,e),_et(e),e}function _et(t){async function e(r){let n=ks.first(r.entries());if(!n)return;await Yr.workspace.applyEdit(r,{isRefactoring:!0});let o=await Yr.workspace.openTextDocument(n[0]);await Yr.window.showTextDocument(o,{preview:!0,selection:n[1][0].range})}t.add(Yr.commands.registerCommand("github.copilot.tests.fixTestFailure.applyAndRerun",async(r,n,o)=>{await e(n),await w_(1e3),Yr.commands.executeCommand("testing.reRunFailTests");let s=await new Promise(d=>{let p=Yr.tests.onDidChangeTestResults(()=>{Yr.tests.testResults.length&&(d(Yr.tests.testResults[0]),p.dispose())})}),a=Cet(r,s.results);if(a===void 0||!a.taskStates.some(d=>d.state===Yr.TestResultState.Failed||d.state===Yr.TestResultState.Errored))return;let c=jb.t("Undo"),u=jb.t("Try Fixing Again"),l=await Yr.window.showInformationMessage(jb.t("Looks like the test still failed. What would you like to do?"),jb.t("Keep Changes"),c,u);if(l===u){let d=jA(a.taskStates,p=>p.messages.find(f=>!!f.location));d?Yr.commands.executeCommand("github.copilot.tests.fixTestFailure",{message:d,test:a,source:"retry"}):Yr.commands.executeCommand("vscode.editorChat.start",{message:"/fixTestFailure",autoSend:!0})}else l===c&&await e(o)}))}function xet(t,e){t.add(Yr.commands.registerCommand("github.copilot.tests.fixTestFailure",async r=>{if(!r.test.uri)return;e.sendMSFTTelemetryEvent("intent.fixTestFailure.actioned",{source:r.source??"testResultsPanel"});let n=await Yr.workspace.openTextDocument(r.test.uri);await Yr.window.showTextDocument(n,{preserveFocus:!1,preview:!0,selection:r.test.range?new Yr.Range(r.test.range.start,r.test.range.start):void 0}),await Yr.commands.executeCommand("vscode.editorChat.start",{message:"/fixTestFailure",autoSend:!0})}))}function Iet(t,e){e.add(Yr.languages.registerCodeActionsProvider("*",{provideCodeActions(r,n,o,s){if(!Yr.workspace.getConfiguration("github.copilot.editor").get("enableCodeActions")||!t.isEnabled.get())return;let c=t.getFailureAtPosition(r.uri,n.start);if(!c)return;let u=new Yr.CodeAction(jb.t("Fix test failure"),Yr.CodeActionKind.QuickFix);return u.isAI=!0,u.command={title:jb.t("Fix test failure"),command:"github.copilot.tests.fixTestFailure",arguments:[{message:c.task.messages[0],test:c.snapshot,source:"sparkles"}]},[u]}}))}function Cet(t,e){let r=[];for(let n=t;n;n=n.parent)r.push(n.id);for(let n=r.length-1;n>=0;n--){let o=r[n],s=e.find(a=>a.id===o);if(!s)return;if(n===0)return s;e=s.children}}var mi=W(require("vscode"));function UM(t,e){if(!e.length)return;let r;for(let n of t)if(n.children){let o=n.name===e[0]?{symbol:n,matchCount:1}:void 0;if(o){let c=UM(n.children,e.slice(1));c&&(o={symbol:c.symbol,matchCount:o.matchCount+c.matchCount})}let s=UM(n.children,e),a;o&&s?a=o.matchCount>=s.matchCount?o:s:a=o??s,a&&(!r||a.matchCount>r?.matchCount)&&(r=a)}else n.name===e[0]&&(r??={symbol:n,matchCount:1});return r}function Iwe(t,e){return(UM(t,[e])??UM(t,Tet(e)))?.symbol}function Tet(t){return Array.from(t.matchAll(/[#\w$][\w\d$]*/g),e=>e[0])}var BM="_github.copilot.openSymbolFromReferences";function Cwe(t){return WA(mi.commands.registerCommand(Iv,async e=>{t.sendMSFTTelemetryEvent("panel.action.filelink");let r=mi.workspace.workspaceFolders?.[0].uri;if(!r)return;let n=typeof e=="string"?mi.Uri.joinPath(r,e):mi.Uri.from(e);if(await o(n))await mi.commands.executeCommand("revealInExplorer",n);else return mi.commands.executeCommand("vscode.open",n);async function o(s){if(s.path.endsWith("/"))return!0;try{return(await mi.workspace.fs.stat(s)).type===mi.FileType.Directory}catch{return!1}}}),mi.commands.registerCommand(sC,async(e,r)=>{let n=await mi.commands.executeCommand("vscode.executeDocumentSymbolProvider",e);if(n){let o=Iwe(n,r);if(t.sendMSFTTelemetryEvent("panel.action.symbollink",{},{hadMatch:o?1:0}),o){let s=o instanceof mi.SymbolInformation?o.location.range:o.selectionRange;return mi.commands.executeCommand("vscode.open",e,{selection:new mi.Range(s.start,s.start)})}}return mi.commands.executeCommand("vscode.open",e)}),mi.commands.registerCommand(BM,(e,r)=>(t.sendMSFTTelemetryEvent("panel.action.openSymbolFromReferencesLink"),mi.commands.executeCommand("vscode.open",e,{selection:new mi.Range(r,r)}))))}var dm=W(require("vscode"));var Twe=/(?<!\[)`([^`]+)`(?!\])/g,qC=class{constructor(e){this.parserService=e;this.symbolCache=new Map}async linkify(e,r,n){if(!r.length)return;let o=new Map;for(let[u,l]of e.matchAll(Twe)){if(o.has(l))continue;let d=this.symbolCache.get(l);if(d)o.set(l,d);else{let p=this.tryResolve(r,l,n);this.symbolCache.set(l,p),o.set(l,p)}}let s=new Map(await Promise.all(Array.from(o.entries(),async([u,l])=>[u,await l]))),a=!1,c=e.replace(Twe,(u,l)=>{let d=s.get(l);if(d){a=!0;let p=(dm.workspace.workspaceFolders?.length?$re(dm.workspace.workspaceFolders[0].uri,d.uri):void 0)??d.uri.fsPath;return this.createOpenSymbolCommand(d,u,p)}return u});if(a)return{text:c,trustedCommands:[BM]}}async tryResolve(e,r,n){let o=await this.findWordInReferences(e,r,n);if(!n?.isCancellationRequested){if(!o.length){let s=r.split(/([#\w$][\w\d$]*)/g).map(c=>c.trim()).filter(c=>c.length),a;for(let c of s){if(!/[#\w$][\w\d$]*/.test(c))break;a=c}if(a&&a!==r&&(o=await this.findWordInReferences(e,a,n),n?.isCancellationRequested))return}for(let s of o){let a=await this.executeDefinitionProvider(s.uri,s.range.start);if(a)return a;if(n?.isCancellationRequested)return}}}async executeDefinitionProvider(e,r){let n=(await dm.commands.executeCommand("vscode.executeDefinitionProvider",e,r)).at(0);return n&&wet(n)}async findWordInReferences(e,r,n){return Kt(await Promise.all(e.map(o=>{if(u0(o.anchor))return this.findWordInDoc(r,o.anchor,new dm.Range(0,0,Number.MAX_SAFE_INTEGER,0),n);if("range"in o.anchor)return this.findWordInDoc(r,o.anchor.uri,o.anchor.range,n);if("value"in o.anchor&&lt.isUri(o.anchor.value))return this.findWordInDoc(r,o.anchor.value,new dm.Range(0,0,Number.MAX_SAFE_INTEGER,0),n)})))}async findWordInDoc(e,r,n,o){let s=await dm.workspace.openTextDocument(r);if(o?.isCancellationRequested)return;let a=await this.getSymbolsInRange(s,n);if(o?.isCancellationRequested)return;for(let l of a)if(l.identifier===e){let d=s.positionAt(l.startIndex);return new yi(r,d)}let c=s.getText(n),u=s.offsetAt(n.start);for(let l of c.matchAll(new RegExp(Eet(e),"g")))if(l.index){let d=s.positionAt(u+l.index),p=s.getText(s.getWordRangeAtPosition(d));if(e===p)return new yi(r,d)}}async getSymbolsInRange(e,r){let n=this.parserService.getTreeSitterAST(e);return n?n.getSymbols({startIndex:e.offsetAt(r.start),endIndex:e.offsetAt(r.end)}):[]}createOpenSymbolCommand(e,r,n){let o=Cv(BM,[e.uri,e.range.start]);return`[${r}](${o} "${n.replaceAll(/"/g,'\\"')}")`}};qC=B([T(0,_t)],qC);function Eet(t){return t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}function wet(t){return"uri"in t?t:new yi(t.targetUri,t.targetRange)}var qM=W(ct());var Lv=class extends Y{constructor(r,n,o,s,a,c,u){super(r,n);this._languageFeaturesService=s;this._workspaceService=a;this._vscodeExtensionCtxService=c;this._ignoreService=u;this._logger=o.getLogger("DefinitionAtPosition")}static{this.DEFAULT_TIMEOUT_MS=200}async prepare(){if(await this._ignoreService.isCopilotIgnored(this.props.document.uri))return{k:"ignored"};let r=this._vscodeExtensionCtxService.extensionMode===qc.Test?0:this.props.timeoutMs===void 0?Lv.DEFAULT_TIMEOUT_MS:this.props.timeoutMs,n=await this.findDefinition(r);return this._logger.debug(`Found ${n.length} implementation(s)/definition(s)`),n.length>0&&this._logger.debug("Implementation(s)/definition(s) found:",JSON.stringify(n,null,"	")),{k:"found",definitions:n}}render(r,n){if(r.k==="ignored")return vscpp("ignoredFiles",{value:[this.props.document.uri]});let{document:o,position:s}=this.props,{definitions:a}=r;if(a.length===0){let c=o.lineAt(s.line);a.push({languageId:o.languageId,uri:o.uri,code:c.text,excerptRange:c.range})}return vscpp(vscppf,null,"Relevant definition",a.length>1?"s":"",": ",vscpp("br",null),vscpp("br",null),a.map(c=>{let d=`${`${As(c.languageId).lineComment.start} FILEPATH: ${c.uri.path}`}
${c.code}`;return vscpp(Oe,{uri:c.uri,languageId:c.languageId,code:d})}))}async findDefinition(r){let{document:n,position:o}=this.props,s=async u=>{try{let l=await this._languageFeaturesService.getImplementations(n.uri,u);if(this._logger.debug(`Found ${l.length} implementations`,JSON.stringify(l,null,"	")),l.length>0)return l}catch{}try{let l=await this._languageFeaturesService.getDefinitions(n.uri,u);if(this._logger.debug(`Found ${l.length} definitions`,JSON.stringify(l,null,"	")),l.length>0)return l}catch{}return this._logger.debug("No definitions or implementations found"),[]},a=await ha(this.accessor,n,r*3,()=>s(o),[]),c=Kt(await Promise.all(a.map(async u=>{let l=Hp(u)?u.targetUri:n.uri;return await this._ignoreService.isCopilotIgnored(l)?void 0:u})));return Promise.all(c.map(async u=>{let{uri:l,range:d}=Hp(u)?{uri:u.targetUri,range:u.targetRange}:u,p=await this._workspaceService.openTextDocument(l),f=Bp(p.languageId),m,h;if(f===void 0){let g=p.lineAt(d.start.line);m=g.text,h=g.range}else h=(await Av(this.accessor,{document:p,language:As(n.languageId),wholeRange:d,selection:new jm(d.start,d.end),fileIndentInfo:void 0})).range,m=p.getText(h);return{languageId:p.languageId,uri:p.uri,code:m,excerptRange:h}}))}};Lv=B([T(2,ce),T(3,Di),T(4,Ze),T(5,zt),T(6,De)],Lv);var HC=class extends Y{constructor(r,n,o,s,a){super(r,n);this.ignoreService=s;this.endpointProvider=a;let{document:c,range:u}=this.props;this._defAtPos=o.createInstance(new Ue(Lv,[{document:c,position:u.start},n]))}async prepare(r,n,o){let{document:s,range:a}=this.props,c=await this._defAtPos.prepare();if(!(c.k==="found"&&c.definitions.some(d=>d.excerptRange.contains(this.props.range)))){let d=await this.endpointProvider.getChatEndpoint("gpt-3.5-turbo"),p={document:s,fileIndentInfo:void 0,language:As(s.languageId),wholeRange:a,selection:new jm(a.start,a.end)};this._defAroundCursor=new kv({documentContext:p,endpointInfo:d},this.accessor,this.ignoreService)}return{defAtPositionState:c,defAroundCursorState:this._defAroundCursor?await this._defAroundCursor.prepare(r):void 0}}render(r,n){let{document:o,range:s}=this.props,a=o.getText(s),c=Ret(a),u=c?` keeping prefix '${c}'`:"",l=this._defAtPos.render(r.defAtPositionState,n),d=r.defAroundCursorState!==void 0&&this._defAroundCursor?.render(r.defAroundCursorState,n);return vscpp(vscppf,null,vscpp(qM.SystemMessage,null,"You are a distinguished software engineer.",vscpp("br",null),vscpp(ir,null),vscpp("br",null),'You must reply with a JSON array of strings of at least four new names, e.g., `["newName1", "newName2", "newName3"]`.',vscpp("br",null),"You must respect existing naming conventions",u,"."),d,vscpp(qM.UserMessage,null,l!==void 0&&vscpp(vscppf,null,l,vscpp("br",null)),"Think of the purpose of `",a,"` in the given code. Think of several names that reflect what `",a,"` is and what it does",u,". Follow existing naming conventions. Reply with a a JSON array of strings of at least four new names for `",a,"`."))}};HC=B([T(2,or),T(3,De),T(4,Le)],HC);function Ret(t){return t.match(/^([\\.\\$\\_]+)/)?.[0]}var pp=class{constructor(e){this._accessor=e;this.supportsAutomaticTriggerKind=Promise.resolve(this.isEnabled(_E.Automatic)),this._promptLogger=this._accessor.get(ce).getPromptResponseLogger("RenameSuggestionsProvider")}isEnabled(e){return e===_E.Invoke?!0:this._accessor.get(be).getConfig(ge.AutomaticRenameSuggestions)}async provideNewSymbolNames(e,r,n,o){let s="",a=new ql;if(!this.isEnabled(n))throw new Error("CopilotFeatureUnavailableOrDisabled");if(await this._accessor.get(De).isCopilotIgnored(e.uri))throw new Error("CopilotIgnoredDocument");let c=e.languageId,u,l;if(o.isCancellationRequested)s="afterEnablementCheck";else{let d=await this._accessor.get(Le).getChatEndpoint("gpt-3.5-turbo");if(u=await this._accessor.get(Lt).getTreatmentVariableAsync("vscode","copilotchat.renameSuggestionsDelayBeforeFetch",!0),o.isCancellationRequested)s="afterRunParametersFetch";else{let p=new ql(!1);p.reset();let f=await this._computePrompt(e,r,d,o),m=p.elapsed();if(o.isCancellationRequested)s="afterPromptCompute";else{l=a.elapsed();let h;if(n===_E.Automatic&&(h=u?Math.max(0,u-l):void 0,h!==void 0&&h>0&&await new Promise(g=>setTimeout(g,h))),o.isCancellationRequested)s="afterDelay";else{this._promptLogger.logPrompt(f.messages);let g=this._accessor.get(jt);p.reset();let v=await g.fetchOne(f.messages,void 0,o,3,d,{agent:"symbol-names"},void 0,{messageSource:"symbolNamesProvider"}),y=p.elapsed();switch(o.isCancellationRequested&&(s="afterFetchStarted"),this._promptLogger.logResponse(v),v.type){case"success":{let _=v.value,{replyFormat:b,symbolNames:S,redundantCharCount:I}=pp.processReply(_);return b==="unknown"&&this._sendInternalTelemetry({languageId:c,reply:_}),this._sendPublicTelemetry({triggerKind:n,languageId:c,cancellationReason:s,fetchResultType:v.type,promptConstructionTime:m,promptTokenCount:f.tokenCount,expectedDelayBeforeFetch:u,actualDelayBeforeFetch:h,timeElapsedBeforeDelay:l,successResponseCharCount:_.length,responseUnusedCharCount:I,fetchTime:y,replyFormat:b,symbolNamesCount:S.length}),S.map(w=>new ene(w,[tne.AIGenerated]))}default:return this._sendPublicTelemetry({triggerKind:n,languageId:c,cancellationReason:s,fetchResultType:v.type,promptConstructionTime:m,promptTokenCount:f.tokenCount,expectedDelayBeforeFetch:u,actualDelayBeforeFetch:h,timeElapsedBeforeDelay:l,fetchTime:y}),null}}}}}return this._sendPublicTelemetry({triggerKind:n,languageId:c,cancellationReason:s,expectedDelayBeforeFetch:u,timeElapsedBeforeDelay:l}),null}_computePrompt(e,r,n,o){return new Xe(n,HC,{document:e,range:r},this._accessor.get(ve).acquireTokenizer(n.family),this._accessor).render(void 0,o)}static processReply(e){let r=pp._parseReplyAsJSONStringArray(e);if(r!==void 0)return r;let n=pp._parseReplyAsList(e);return n!==void 0?n:{replyFormat:"unknown",symbolNames:[],redundantCharCount:e.length}}static _parseReplyAsJSONStringArray(e){let r=/\[.*?\]/gs,n=[...e.matchAll(r)];for(let o=0;o<n.length;o++){let s=n[o];try{let a=JSON.parse(s[0]);if(Array.isArray(a)){let c=a.filter(u=>typeof u=="string");if(c.length>0){let u=o===0?"jsonStringArray":"multiJsonStringArray",l=e.length-s[0].length;return{replyFormat:u,redundantCharCount:l,symbolNames:c.map(d=>d.trim())}}}}catch{}}}static _parseReplyAsList(e){let r=/(?:\d+[\.|\)]|[\*\-])\s*(.*)/g,n=e.matchAll(r),o=[];for(let a of n){let c=a[1].trim(),u=["'",'"',"`"];u.includes(c[0])&&(c=c.slice(1)),u.includes(c[c.length-1])&&(c=c.slice(0,-1)),c&&o.push(c)}return o.length===0?void 0:{replyFormat:"list",redundantCharCount:e.length-o.reduce((a,c)=>a+c.length,0),symbolNames:o}}_sendPublicTelemetry({triggerKind:e,languageId:r,cancellationReason:n,fetchResultType:o,timeElapsedBeforeDelay:s,promptConstructionTime:a,promptTokenCount:c,expectedDelayBeforeFetch:u,actualDelayBeforeFetch:l,successResponseCharCount:d,responseUnusedCharCount:p,fetchTime:f,replyFormat:m,symbolNamesCount:h}){this._accessor.safeGet(me)?.sendMSFTTelemetryEvent("provideRenameSuggestions",{languageId:r,cancellationReason:n,fetchResultType:o,replyFormat:m,triggerKind:e===_E.Automatic?"automatic":"manual"},{promptConstructionTime:a,promptTokenCount:c,expectedDelayBeforeFetch:u,actualDelayBeforeFetch:l,timeElapsedBeforeFetch:s,fetchTime:f,successResponseCharCount:d,responseUnusedCharCount:p,symbolNamesCount:h})}_sendInternalTelemetry({languageId:e,reply:r}){this._accessor.safeGet(me)?.sendInternalMSFTTelemetryEvent("provideRenameSuggestionsIncorrectFormatResponse",{languageId:e,reply:r})}static _determinePrefix(e){return e.match(/^([\\.\\$\\_]+)/)?.[0]}};pp=B([T(0,rt)],pp);var Ewe=W(require("vscode"));function wwe(t){let e=t.get(zt).extensionMode;return typeof e=="number"&&e!==Ewe.ExtensionMode.Test&&t.get(b0).updateContextValues(),Ta(()=>{})}var Awe=W(Tr());var Rwe=W(Tr()),kwe=W(require("fs"));var V2=W(ct());var jC=class extends Y{render(e,r){return vscpp(vscppf,null,this.props.history&&vscpp(qt,{priority:600,history:this.props.history}),vscpp(V2.SystemMessage,{priority:1e3},"You are a coding assistant who helps the user find relevant code in their workspace by providing a list of relevant keywords they can search for.",vscpp("br",null),"The user will provide you with potentially relevant information from the workspace. This information may be incomplete.",vscpp("br",null),"Respond in Markdown. First under a `# Question` header, output a rephrased version of the user's question that resolves all pronouns and ambiguous words like 'this' to the specific nouns they stand for.",vscpp("br",null),"Then under a `# Keywords` header, output a short markdown list of up to 8 relevant keywords that the user can search for to answer the question. You may include variations after each keyword.",vscpp("br",null),"DO NOT ask the user for additional information or clarification.",vscpp("br",null),"DO NOT answer the user's question directly.",vscpp("br",null),vscpp("br",null),"# Additional Rules",vscpp("br",null),vscpp("br",null),"Think step by step:",vscpp("br",null),"1. Read the user's question to understand what they are asking about their workspace.",vscpp("br",null),"2. If the question contains pronouns such as 'it' or 'that', try to understand what the pronoun refers to by looking at the rest of the question and the conversation history.",vscpp("br",null),"3. If the question contains an ambiguous word such as 'this', try to understand what is refers to by looking at the rest of the question, the user's active selection, and the conversation history.",vscpp("br",null),"4. After a `# Question` header, output a precise version of question that resolves all pronouns and ambiguous words like 'this' to the specific nouns they stand for. Be sure to preserve the exact meaning of the question by only changing ambiguous pronouns and words like 'this'.",vscpp("br",null),"5. Then after a `# Keywords` header, output a short markdown list of up to 8 relevant keywords that user could try searching for to answer their question. These keywords could used as file name, symbol names, abbreviations, or comments in the relevant code. Put the keywords most relevant to the question first. Do not include overly generic keywords. Do not repeat keywords.",vscpp("br",null),"6. For each keyword in the markdown list of related keywords, if applicable add a comma separated list of variations after it. For example: for 'encode' possible variations include 'encoding', 'encoded', 'encoder', 'encoders'. Consider synonyms and plural forms. Do not repeat variations.",vscpp("br",null),vscpp("br",null),"Examples",vscpp("br",null),vscpp("br",null),"User: base64 encoding",vscpp("br",null),vscpp("br",null),"Assistant:",vscpp("br",null),"# Question",vscpp("br",null),"Where's the code for base64 encoding?",vscpp("br",null),vscpp("br",null),"# Keywords",vscpp("br",null),"- base64 encoding, base64 encoder, base64 encode",vscpp("br",null),"- base64, base 64",vscpp("br",null),"- encode, encoded, encoder, encoders"),this.props.fileTree&&vscpp(V2.UserMessage,{priority:700},this.props.fileTree),vscpp(V2.UserMessage,{priority:1e3},this.props.query))}};var HM=se("IWorkspaceSemanticChunkService"),zC=class{constructor(e){this._accessor=e;this._workspaceChunkSearch=this._accessor.get(iv),this._chatFetcher=this._accessor.get(jt)}async searchFileChunks(e,r,n,o){let{messages:s}=await this.buildMetaPrompt(r,e,o);if(o.isCancellationRequested)return[];let a=await this._chatFetcher.fetchOne(s,async u=>{},o,2,r,{agent:Up},{temperature:.1,top_p:1,stop:["dontStopBelieving"]},{messageSource:"semanticSearchIntent"});if(a.type!=="success")throw new Error(Rwe.t("Encountered an error while deciding what workspace information to collect: ({0}) {1}",a.type,a.reason));if(o.isCancellationRequested)return[];let c=TC(e,a.value);return bJ(this._workspaceChunkSearch,r,e,c,n,o,!1)}dispose(){}async buildMetaPrompt(e,r,n){let o=await O2(this._accessor,1e3,n);return new Xe(e,jC,{query:r,fileTree:o},this._accessor.get(ve).acquireTokenizer(e.family),this._accessor).render()}};zC=B([T(0,rt)],zC);async function bJ(t,e,r,n,o,s,a){let c={rawQuery:r,resolve:async()=>({rephrasedQuery:n.rephrasedQuestion,keywords:n.keywords})},u=(await t.searchFileChunks(e,c,o,{},s)).slice(0,o);return s.isCancellationRequested||!u.length?[]:await ket(u,a)}async function ket(t,e){let r=[],n=new Pn;for(let[o,s]of t.entries()){let a=n.get(s.file),c=a?a.rank:o,u=a?[...a.ranges,s.range]:[s.range];n.set(s.file,{ranges:u,rank:c})}for(let[o,s]of n.entries()){let a=s.ranges.filter((f,m)=>{for(let[h,g]of s.ranges.entries())if(m!==h&&f.containsRange(g))if(f.equalsRange(g)){if(m<h)return!1}else return!1;return!0}),c=[],u;a.sort((f,m)=>f.startLineNumber-m.startLineNumber);for(let f of a)u&&u.endLineNumber>=f.startLineNumber-1?u=new gt(u.startLineNumber,u.startColumn,f.endLineNumber,f.endColumn):(u&&c.push(u),u=f);u&&c.push(u);let d=(await kwe.promises.readFile(o.fsPath,"utf8")).split(`
`),p=[];for(let f of c){let m=f.startLineNumber,h=f.endLineNumber,g=d.slice(m,h);if(!Pet(g,5))continue;let{trimmedLines:v}=PE(Aet(g,1e3,15)),y;e?(v.length<g.length&&v.push("..."),y=ki(uc(o).replace(/\./g,""),v.join(`
`).replace(/^\n*|\n*$/g,""),!1)):y=v.join(`
`),p.push({range:f,code:y})}p.length>0&&r.push({result:{file:o,locations:p},rank:s.rank})}return r.sort((o,s)=>o.rank-s.rank).map(o=>o.result)}function Aet(t,e,r){let n=[],o=0;for(;o<t.length&&n.join(`
`).length<e&&n.length<r;)n.push(t[o]),o++;return n}function Pet(t,e){let r=0;for(let n of t)if(r+=n.trim().length,r>=e)return!0;return!1}var GC=class{constructor(e,r){this._endpointProvider=e;this._workspaceSemanticChunkService=r}provideAITextSearchResults(e,r,n,o){return(async()=>(this._endpoint=this._endpoint??await this._endpointProvider.getChatEndpoint("gpt-4"),(await this._workspaceSemanticChunkService.searchFileChunks(e,this._endpoint,10,o)).forEach(c=>{c.locations.forEach(u=>{n.report({uri:c.file,ranges:Zm(u.range),preview:{text:u.code,matches:new ze(new Xr(0,u.range.startColumn),new Xr(u.range.endLineNumber-u.range.startLineNumber,u.range.endColumn))}})})}),{limitHit:!1,message:{text:Awe.t("Results are from Copilot"),trusted:!0,type:1}}))()}};GC=B([T(0,Le),T(1,HM)],GC);var QM=W(require("vscode"));var Ov=W(ct());var zb="---",wn;(o=>(o.FILEPATH=zb+"FILEPATH",o.ORIGINAL=zb+"ORIGINAL",o.PATCHED=zb+"PATCHED",o.COMPLETE=zb+"COMPLETE"))(wn||={});var VC=class extends Y{render(){return vscpp(vscppf,null,"When proposing a code change, provide one or more modifications in the following format:",vscpp("br",null),"Each modification consist of three sections headed by `",wn.FILEPATH,"`, `",wn.ORIGINAL,"` and `",wn.PATCHED,"`.",vscpp("br",null),"After ",wn.FILEPATH," add the path to the file that needs to be changed.",vscpp("br",null),"After ",wn.ORIGINAL," add a code block containing a section of the program that requires replacement.",vscpp("br",null),"The original section consists of one or more consecutive lines including comments and empty lines exactly as they appear in the original source code.",vscpp("br",null),"Be careful that the section exactly matches the code in the original program so it can be found by a find tool. Do not abreviate any line or summarize the code with `...` ",vscpp("br",null),"After ",wn.PATCHED," add a code block with the updated version of the original code, maintaining the same indentation and code style as in the original code.",vscpp("br",null),"After all modifications, add ",wn.COMPLETE,".",vscpp("br",null))}},jM=class extends Y{render(){return vscpp(vscppf,null,"```csharp",vscpp("br",null),"// This is my class",vscpp("br",null),"class C { }",vscpp("br",null),vscpp("br",null),"new C().Field = 9;",vscpp("br",null),"```")}},zM=class extends Y{render(){return vscpp(vscppf,null,"The problem is that the class 'C' does not have a field or property named 'Field'. To fix this, you need to add a 'Field' property to the 'C' class.",vscpp("br",null),vscpp("br",null),pm("someFolder/myFile.cs"),vscpp("br",null),wn.ORIGINAL,vscpp("br",null),"```",vscpp("br",null),"// This is my class",vscpp("br",null),"class C { }",vscpp("br",null),"```",vscpp("br",null),wn.PATCHED,vscpp("br",null),"```",vscpp("br",null),"// This is my class",vscpp("br",null),"class C {",vscpp("br",null),"public int Field { get; set; }",vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),pm("someFolder/myFile.cs"),vscpp("br",null),wn.ORIGINAL,vscpp("br",null),"```",vscpp("br",null),"new C().Field = 9;",vscpp("br",null),wn.PATCHED,vscpp("br",null),"```",vscpp("br",null),"// set the field to 9",vscpp("br",null),"new C().Field = 9;",vscpp("br",null),"```",vscpp("br",null),wn.COMPLETE,vscpp("br",null))}};function pm(t){return`${wn.FILEPATH} ${C_(t)}`}function Owe(t){return`${zb}${t}`}function GM(t){return!t.match(/\S/)}function Net(t,e,r,n){let o=0;for(;o<e.length&&GM(e[o]);)o++;if(o===e.length){let d=uv(t,4,!1),p=t.length>0?VM(t[0],d.tabSize).level:0,f=Pwe(r,p,d);return On.insert(new Xr(n,0),f)}let s=e[o],a=_J(s),c,u=0,l=o;e:for(;u<t.length;){for(;u<t.length&&!Dwe(t[u],s,a);)u++;if(u===t.length)return c??{message:"Snippet first line not found",label:"invalid patch",severity:"error"};let d=u,p=-1;for(;u<t.length&&l<e.length;){let f=t[u];if(_J(f)===f.length){u++;continue}let h=e[l],g=_J(h);if(g===h.length){l++;continue}if(Dwe(f,h,g))p=u,u++,l++;else{u=d+1,l=o,h.indexOf("...")!==-1?c={message:"Snippet contains ellipses",label:"patch lazy",severity:"error"}:Let(f)?c={message:"Snippet not matching a comment",label:"patch no comment",severity:"error"}:c={message:`Snippet line ${l} does not match line ${u}`,label:"invalid patch",severity:"error"};continue e}}for(;l<e.length&&GM(e[l]);)l++;if(l===e.length&&d!==-1&&p!==-1){let f=uv(t,4,!1),m=VM(t[d],f.tabSize).level,h=Pwe(r,m,f);return On.replace(new ze(d,0,p,t[p].length),h)}}return c??{message:"Not all lines of snippet found",label:"invalid patch",severity:"error"}}function Mwe(t){return t===32||t===9}function Let(t){return t.match(/^\s*(\/\/|\/\*|#)/)!==null}function Pwe(t,e,r){let n,o=0;for(n=0;n<t.length&&GM(t[n]);n++);if(n===t.length)return"";for(o=t.length;o>n&&GM(t[o-1]);o--);let s=VM(t[n],r.tabSize).level,a=[];for(let c=n;c<o;c++){let u=t[c],{level:l,length:d}=VM(u,r.tabSize),p=Math.max(0,e+l-s),f=r.insertSpaces?" ".repeat(r.tabSize*p):"	".repeat(p);a.push(f+u.substring(d))}return a.join(`
`)}function _J(t){let e=0;for(;e<t.length&&Mwe(t.charCodeAt(e));)e++;return e}function VM(t,e){let r=0,n=0,o=0,s=0,a=t.length;for(;o<a;){let c=t.charCodeAt(o);if(c===32)r++,r===e&&(n++,r=0,s=o+1);else if(c===9)n++,r=0,s=o+1;else break;o++}return{level:n,length:s}}function Dwe(t,e,r){let n=t.length-1,o=e.length-1;for(;n>=0&&o>=r&&t.charCodeAt(n)===e.charCodeAt(o);)n--,o--;if(o>=r)return!1;for(;n>=0&&Mwe(t.charCodeAt(n));)n--;return n<0}function $M(){return{getFirstSentence(t){let e=[];for(let r of Lwe(t)){if(r.length===0||r.startsWith(zb))break;e.push(r)}return e.join(`
`)},process(t,e,r,n=0){let o,s,a=[],c=[],u=[],l=[],d=[],p=[],f=new Set;e:for(let m of Met(Lwe(t)))switch(m.marker){case void 0:break;case wn.FILEPATH:s=m.content.join(`
`).trim();break;case wn.ORIGINAL:o=m.content;break;case wn.PATCHED:{m.content&&o&&s&&(u.push({fileName:s,find:o,replace:m.content}),f.add(s));break}case wn.COMPLETE:break e;default:c.push(m);break}if(u.length===0)return a.push({message:"No patch sections found",label:"no patch",severity:"error"}),{edits:l,otherSections:c,invalidPatches:d,otherPatches:p,annotations:a};if(r){let m=C_(r.fsPath);f.has(m)||a.push({message:`No patch for input document: ${m}, patches for ${[...f.keys()].join(", ")}`,label:"other file",severity:"warning"}),f.size>1&&a.push({message:`Multiple files modified: ${[...f.keys()].join(", ")}`,label:"multi file",severity:"warning"});let h=[];for(let g of u)g.fileName!==m?p.push(g):h.push(g);u=h}if(u.length!==0){let m=SI.fromString(e);for(let h of u){let g=Net(m,Nwe(h.find),Nwe(h.replace),n);g instanceof On?Oet(l,g)||(a.push({message:"Overlapping edits",label:"overlapping edit",severity:"error"}),d.push(h)):(a.push(g),d.push(h))}}return{edits:l,otherSections:c,invalidPatches:d,otherPatches:p,annotations:a}}}}function Oet(t,e){for(let r=0;r<t.length;r++){let n=t[r];if(e.range.end.isBeforeOrEqual(n.range.start))return t.splice(r,0,e),!0;if(e.range.start.isBefore(n.range.end))return!1}return t.push(e),!0}function Nwe(t){let e=[],r=!1;for(let n of t)if(n.startsWith("```")){if(r)return e;r=!0}else r&&e.push(n);return t}function*Met(t){let e,r=[];for(let n of t){let o;if(n.startsWith(zb)){n.startsWith(wn.FILEPATH)?o=wn.FILEPATH:n.startsWith(wn.ORIGINAL)?o=wn.ORIGINAL:n.startsWith(wn.PATCHED)?o=wn.PATCHED:n.startsWith(wn.COMPLETE)?o=wn.COMPLETE:o=n,yield{marker:e,content:r},r=[n.substring(o.length)],e=o;continue}r.push(n)}e&&(yield{marker:e,content:r})}function*Lwe(t){let e=0,r=t.indexOf(`
`);for(;r!==-1;)yield t.substring(e,r),e=r+1,r=t.indexOf(`
`,e);e<t.length&&(yield t.substring(e))}var WM=class extends Ov.PromptMetadata{constructor(r,n,o){super();this.projectedDocument=r;this.documentUri=n;this.adjustedSelection=o}},KM=class extends Y{async prepare(e){let{document:r,wholeRange:n,fileIndentInfo:o}=this.props.documentContext,s=await this.accessor.get(De).isCopilotIgnored(r.uri),a=e.endpoint.modelMaxPromptTokens/3*4,c;if(!s&&r.getText().length>a){let u=await Ab(this.accessor.get(_t),r,o);c=MI(a,r,n,u,{tryPreserveTypeChecking:!1})}else c=new sm(r.getText(),Zn.empty,r.languageId);return{projectedDocument:c,isIgnored:s}}render(e,r){let{language:n,document:o,selection:s}=this.props.documentContext,a=e.projectedDocument,c=a.projectRange(s),u=o.getText(s).trim(),l=[{uri:o.uri,version:o.version,ranges:[]}];return vscpp(vscppf,null,vscpp("usedContext",{value:l}),vscpp("meta",{value:new WM(e.projectedDocument,o.uri,c)}),vscpp(Ov.SystemMessage,{priority:1e3},"You are an AI programming assistant that is specialized in applying code changes to an existing document.",vscpp("br",null),"I have a code block that represents a suggestion for a code change and I have a ",n.languageId," file opened in a code editor.",vscpp("br",null),"I expect you to come up with code changes that apply the code block to the editor at a given selection. ",vscpp("br",null),"I want the changes to be applied in a way that is safe and does not break the existing code, is correctly indented and matching the code style.",vscpp("br",null),"For the response, always follow these instructions:",vscpp("br",null),"1. Analyse the code block, the content of the editor and the current selection to decide if the code block should replace existing code or is to be inserted.",vscpp("br",null),"2. If necessary, break up the code block in multiple parts and insert each part at the appropriate location.",vscpp("br",null),"3. If necessary, make changes to other parts in the editor so that the final result is valid, propertly formatted and indented.",vscpp("br",null),"4. Finally, provide the code modifications",vscpp("br",null),vscpp(VC,null),vscpp("br",null),vscpp(ir,null),vscpp(lr,null)),vscpp(Ov.UserMessage,{priority:700},vscpp(om,null,a.text.length>0?vscpp(vscppf,null,"I have the following code open in the editor, starting from line 1 to line ",a.lineCount,".",vscpp("br",null),pm(o.fileName),vscpp("br",null),vscpp(Oe,{uri:o.uri,languageId:n.languageId,code:a.text,shouldTrim:!1}),vscpp("br",null)):vscpp(vscppf,null,"I am in an empty file:",pm(o.fileName),vscpp("br",null))),vscpp(om,null,s.isEmpty?vscpp(vscppf,null,"I have the selection at line ",c.start.line+1,", column ",c.start.character+1,vscpp("br",null)):vscpp(vscppf,null,"I have currently selected from line ",c.start.line+1,", column ",c.start.character+1," to line ",c.end.line+1," column ",c.end.character+1,".",vscpp("br",null),u.length>0?vscpp(vscppf,null,"The content of the selection is",vscpp(Oe,{uri:o.uri,languageId:n.languageId,code:u,shouldTrim:!1}),vscpp("br",null)):vscpp(vscppf,null,"The selection consists of whitespaces only."))),vscpp(vscppf,null,"This is the code block that represents a suggestion for a code change:",vscpp("br",null),vscpp(Oe,{uri:o.uri,languageId:n.languageId,code:this.props.codeBlock,shouldTrim:!1}),vscpp("br",null)),vscpp(Ov.TextChunk,null,"Please find out how the code block can be applied to the editor. Provide the code changes in the format as described above.",vscpp("br",null))))}};function Fwe(t,e){let r=e.getMeta(WM);if(!r)throw new Error("CodeMapperPrompt: Metadata not found");let o=$M().process(t,r.projectedDocument.text,r.documentUri,r.adjustedSelection.start.line);return{edits:r.projectedDocument.projectBackTextEdit(o.edits),annotations:o.annotations}}var $C=class{constructor(e=!1,r,n,o,s,a,c,u,l,d,p){this.doReportTelemetry=e;this.endpointProvider=r;this.tokenizerProvider=n;this.chatMLFetcher=o;this.conversationOptions=s;this.configurationService=a;this.experimentationService=c;this.logService=u;this.telemetryService=l;this.instantiationService=d;this.accessor=p;this.logger=u.getPromptResponseLogger("ai code mapper")}async mapCode(e,r,n,o){let s=await this.configurationService.getExperimentBasedConfig(ge.CodeMapperChatEndpoint,this.experimentationService)??"gpt-3.5-turbo",a=await this.endpointProvider.getChatEndpoint(s),c=new Xe(a,KM,{documentContext:r,codeBlock:e},this.tokenizerProvider.acquireTokenizer(a.family),this.accessor),u=Date.now(),l=await c.render(void 0,o),d=await this.chatMLFetcher.fetchOne(l.messages,void 0,o,3,a,void 0,{temperature:this.conversationOptions.temperature,top_p:this.conversationOptions.topP},{messageSource:"command.aiCodemapper"});this.logger.logResponse(d);let p;return d.type==="success"?p=Fwe(d.value,c):p={edits:[],annotations:[],errorMessage:d.reason},this.doReportTelemetry&&this.reportTelemetry(a,d,Date.now()-u,p,r),p}reportTelemetry(e,r,n,o,s){if(this.telemetryService.sendMSFTTelemetryEvent("codemapper.request",{model:e.model,requestId:r.requestId,responseType:r.type,outcomeAnnotations:o.annotations?.map(a=>a.label).join(",")},{timeToComplete:n,editCount:o.edits.length}),o.edits.length){let a=this.instantiationService.createInstance(sv,s.document.getText());a.addEdits(o.edits);let c=new bI(a.getText(),s.document,this.accessor);(async()=>{try{let[u,l]=await Promise.all([a.getEdits(),c.compute()]),d=l.getEditsSinceInitial(),p={requestId:r.requestId,command:"codemapper"};this.instantiationService.createInstance(Tv,s.document,a.initialText,u,d,p,void 0)}finally{c.dispose()}})()}}};$C=B([T(1,Le),T(2,ve),T(3,jt),T(4,$n),T(5,be),T(6,Lt),T(7,ce),T(8,me),T(9,or),T(10,rt)],$C);var Dl=W(require("vscode"));var YM=class{provideMappedEdits(e,r,n,o){if(n.documents.length===0)return null;let s=n.documents[0],a=e.uri.toString(),c=s.find(_=>_.uri.toString()===a);if(!c)return null;let u=c.ranges;if(u.length!==1||r.length!==1)return null;let l=u[0],d=r[0];if(!e.getText(new Dl.Range(new Dl.Position(l.start.line,0),new Dl.Position(l.start.line,l.start.character))).match(/^\s*$/))return null;let f=Dl.window.activeTextEditor,m;if(f&&f.options&&e.languageId===f.document.languageId){let _=f.options,b=typeof _.tabSize=="number"?_.tabSize:4,S=typeof _.insertSpaces=="boolean"?_.insertSpaces:!0;m={tabSize:b,insertSpaces:S}}let h=new Dl.Range(new Dl.Position(l.start.line,0),l.end),g=e.getText(h),v=dv(d.split(`
`),{whichLine:"topMost",lines:g.split(`
`)},m).join(`
`),y=new Dl.WorkspaceEdit;return y.replace(e.uri,h,v),y}};var WC=class{constructor(e){this.instantiationService=e;this.codeMapper=this.instantiationService.createInstance($C,!0)}async provideMappedEdits(e,r,n,o){let s=QM.window.visibleTextEditors.find(a=>T_(a.document.uri,e.uri));if(s){let a=[];for(let l of n.documents)for(let d of l)T_(d.uri,e.uri)&&a.push(...d.ranges);let c=w2.fromEditor(s),u=await this.codeMapper.mapCode(r[0],c,a,o);if(u.edits.length){let l=new QM.WorkspaceEdit;return l.set(e.uri,u.edits),l}}return new YM().provideMappedEdits(e,r,n,o)}};WC=B([T(0,or)],WC);var KC=W(require("vscode"));var JM=W(ct());var xJ=class extends Y{render(){let e=this.props.issues?.map(r=>vscpp(vscppf,null,"------- Issue ",r.reference,":",vscpp("br",null),r.content,vscpp("br",null)));return e&&e.length>0?vscpp(vscppf,null,"You are an AI assistant for a software developer who is about to make a pull request to a GitHub repository to fix the following issues: ",vscpp("br",null),e):vscpp(vscppf,null,"You are an AI assistant for a software developer who is about to make a pull request to a GitHub repository.")}},SJ=class extends Y{render(){return vscpp(vscppf,null,"Here are two good examples:",vscpp("br",null)," ",this.props.issues&&this.props.issues.length>0?vscpp(vscppf,null,"Example One:",vscpp("br",null),"+++Batch mark/unmark files as viewed",vscpp("br",null),"+++Previously, when marking/unmarking a folder as viewed, a request was sent for every single file. This PR ensures that only one request is sent when marking/unmarking a folder as viewed.",vscpp("br",null),"Fixes #4520+++",vscpp("br",null),"Example two:",vscpp("br",null),"+++Fallback to hybrid after 20 process ports",vscpp("br",null),"+++Additionally the \\`remote.autoForwardPortsSource\\` setting has been updated to remove the \\`markdownDescription\\` reference to a reload being required for changes to take effect.",vscpp("br",null),"Fixes microsoft/vscode-internalbacklog#4533+++",vscpp("br",null)):vscpp(vscppf,null,"Example One:",vscpp("br",null),"+++Batch mark/unmark files as viewed",vscpp("br",null),"+++Previously, when marking/unmarking a folder as viewed, a request was sent for every single file. This PR ensures that only one request is sent when marking/unmarking a folder as viewed.+++",vscpp("br",null),"Example two:",vscpp("br",null),"+++Fallback to hybrid after 20 process ports",vscpp("br",null),"+++Additionally the \\`remote.autoForwardPortsSource\\` setting has been updated to remove the \\`markdownDescription\\` reference to a reload being required for changes to take effect.+++",vscpp("br",null)),";")}},IJ=class extends Y{render(){return vscpp(vscppf,null,vscpp(xJ,{issues:this.props.issues}),"Pull requests have a short and concise title that describes the changes in the code and a slightly longer description.",vscpp("br",null),"The description can be more detailed but should still be concise. Do not list commits, files or patches. Do not make up an issue reference if the pull request isn't fixing an issue.",vscpp("br",null),"The title and description of a pull request should be markdown and start with +++ and end with +++.",vscpp("br",null),vscpp(SJ,{issues:this.props.issues}))}},CJ=class extends Y{render(){let e=this.props.commitMessages.map(n=>vscpp(vscppf,null,"* ",n,vscpp("br",null))),r=this.props.patches.map(n=>vscpp(vscppf,null,"```diff",vscpp("br",null),n,vscpp("br",null),"```",vscpp("br",null)));return vscpp(vscppf,null,"These are the commits that will be included in the pull request you are about to make:",vscpp("br",null),e,vscpp("br",null),"Below is a list of git patches that contain the file changes for all the files that will be included in the pull request:",vscpp("br",null),r,vscpp("br",null),"Based on the git patches and on the git commit messages above, the title and description of the pull request should be:",vscpp("br",null))}},XM=class extends Y{render(){return vscpp(vscppf,null,vscpp(JM.SystemMessage,null,vscpp(IJ,{issues:this.props.issues}),vscpp(fi,null)),vscpp(JM.UserMessage,null,vscpp(CJ,{commitMessages:this.props.commitMessages,patches:this.props.patches})))}};var ZM=class t{constructor(e){this.accessor=e;this.disposables=new Nt;this.lastContext={commitMessages:[],patches:[]};this.internalLogger=e.get(ce).getPromptResponseLogger("GitHub pull request title and description generator"),this.logger=e.get(ce).getLogger("githubTitleAndDescriptionProvider"),this.logger.info("Initializing GitHub PR title and description provider provider."),this.options=e.get($n)}dispose(){this.disposables.dispose()}isRegenerate(e,r){if(e.length!==this.lastContext.commitMessages.length||r.length!==this.lastContext.patches.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==this.lastContext.commitMessages[n])return!1;for(let n=0;n<r.length;n++)if(r[n]!==this.lastContext.patches[n])return!1;return!0}async excludePatches(e){let r=this.accessor.get(De),n=[];for(let o of e)o.fileUri&&await r.isCopilotIgnored(lt.parse(o.fileUri))||o.previousFileUri&&o.previousFileUri!==o.fileUri&&await r.isCopilotIgnored(lt.parse(o.previousFileUri))||n.push(o.patch);return n}async provideTitleAndDescription(e,r){let n=e.commitMessages,o=cP(e.patches)?e.patches.map(p=>({patch:p})):e.patches,s=await this.excludePatches(o),a=e.issues,c=await this.accessor.get(Le).getChatEndpoint("gpt-3.5-turbo"),u=Math.floor(c.modelMaxPromptTokens*4/3),l=await this.createPRTitleAndDescriptionPrompt(n,s,a,u);this.internalLogger.logPrompt(l.messages);let d=await this.accessor.get(jt).fetchOne(l.messages,void 0,r,3,c,void 0,{temperature:this.isRegenerate(n,s)?this.options.temperature+.1:this.options.temperature,top_p:this.options.topP},{messageSource:"extension.providePullRequestTitleAndDescription"});if(this.internalLogger.logResponse(d),this.lastContext={commitMessages:n,patches:s},d.type==="success")return t.parseFetchResult(d.value)}static parseFetchResult(e,r=!0){e=e.trim();let n=e,o=n.indexOf("+++");if(o===-1)return;let s=n.lastIndexOf("+++");n=n.substring(o+3,s>o+3?s:void 0).trim().replace(/\+\+\+?(\n)\+\+\+/,"+++");let a=n.split("+++").filter(d=>d.trim().length>0),c;if(a.length===1)c=a[0].split(`
`);else if(a.length>1){let d=a.slice(1).map(p=>p.split(`
`)).flat().filter(p=>p.trim().length>0);c=[a[0],...d]}else return;let u,l;if(c.length===1){if(u=c[0].trim(),r&&e.includes(`
`)&&e.split("+++").length===3)return this.parseFetchResult(e+"+++",!1)}else if(c.length>1){u=c[0].trim(),l="";let d=c.slice(1);for(let p of d)p.includes("commit message")||(l+=`${p.trim()}

`)}if(u)return u=u.replace(/Title\:\s/,"").trim(),u=u.replace(/^\"(?<title>.+)\"$/,(d,p)=>p),l&&(l=l.replace(/Description\:\s/,"").trim()),{title:u,description:l}}async createPRTitleAndDescriptionPrompt(e,r,n,o){let s=o-Math.floor(o*.2),a=r.join(`

`).length;if(a>s)for(r.sort((l,d)=>l.length-d.length);a>s&&r.length>0;){let l=r.pop();a-=l.length}let c=await this.accessor.get(Le).getChatEndpoint("gpt-3.5-turbo");return new Xe(c,XM,{commitMessages:e,issues:n,patches:r},this.accessor.get(ve).acquireTokenizer(c.family),this.accessor).render(void 0,void 0)}};var eF=class{constructor(e){this.accessor=e}async provideReviewerComments(e,r){let n=await DC(this.accessor,e,r),o=[];if(n?.type==="success")for(let a of n.comments)o.push(a.uri);let s=n?.type==="success";return{files:o,succeeded:s}}};var tF=class{constructor(e){this.accessor=e;this.disposables=new Nt;this.logger=e.get(ce).getLogger("githubTitleAndDescriptionProvider"),this.initializeGitHubPRExtensionApi()}dispose(){this.disposables.dispose()}getExtension(){return KC.extensions.getExtension("github.vscode-pull-request-github")}initializeGitHubPRExtensionApi(){let e=this.getExtension(),r=async()=>{if(e){let n=await e.activate();this.logger.info("Successfully activated the GitHub.vscode-pull-request-github extension."),this.gitHubExtensionApi=n,this.registerTitleAndDescriptionProvider(),this.registerReviewerCommentsProvider()}};if(e)r();else{this.logger.info("GitHub.vscode-pull-request-github extension is not yet activated.");let n=KC.extensions.onDidChange(()=>{e=this.getExtension(),e&&(r(),n.dispose())});this.disposables.add(n)}}async registerTitleAndDescriptionProvider(){if(this.gitHubExtensionApi)try{this.titleAndDescriptionProvider||(this.titleAndDescriptionProvider=this.disposables.add(new ZM(this.accessor))),this.disposables.add(this.gitHubExtensionApi.registerTitleAndDescriptionProvider(KC.l10n.t("Generate with Copilot"),this.titleAndDescriptionProvider)),this.logger.info("Successfully registered GitHub PR title and description provider.")}catch{}}async registerReviewerCommentsProvider(){if(!this.gitHubExtensionApi)return;let e=this.accessor.get(be);if(!(!e.getConfig(ge.ReviewContextMenu)&&!e.getConfig(ge.ReviewSCMViewlet)))try{this.reviewerCommentsProvider||(this.reviewerCommentsProvider=new eF(this.accessor)),this.disposables.add(this.gitHubExtensionApi.registerReviewerCommentsProvider(KC.l10n.t("Copilot"),this.reviewerCommentsProvider)),this.logger.info("Successfully registered GitHub PR reviewer comments provider.")}catch{}}};var rRe=W(require("path")),nRe=require("util"),At=require("vscode");var Fet=["dockerfile","license","makefile","readme","procfile","gemfile","rakefile","jenkinsfile","vagrantfile"];function Uwe(t){return/\.[^/.]+$/.test(t)&&Fet.indexOf(t.toLowerCase())===-1}var Vb=W(Tr()),Xwe=W(require("path"));var obr=new Uint32Array(10);var sbr=new Uint8Array([114,82,115,101,69,102,97,113,81,116,84,100,119,87,99,122,120,118,103]),abr=new Uint16Array([107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]),cbr=new Uint16Array([114,82,29810,115,30579,26483,101,102,29286,24934,29030,29798,30822,30310,26470,97,113,29809,116,84,100,119,99,122,120,118,103]),ubr=new Uint16Array([114,82,29810,115,30579,26483,101,69,102,29286,24934,29030,29798,30822,30310,26470,97,113,81,29809,116,84,100,119,87,99,122,120,118,103,107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]);function qwe(...t){return function(e,r){for(let n=0,o=t.length;n<o;n++){let s=t[n](e,r);if(s)return s}return null}}var vbr=jwe.bind(void 0,!1),Hwe=jwe.bind(void 0,!0);function jwe(t,e,r){if(!r||r.length<e.length)return null;let n;return t?n=dE(r,e):n=r.indexOf(e)===0,n?e.length>0?[{start:0,end:e.length}]:[]:null}function Uet(t,e){let r=e.toLowerCase().indexOf(t.toLowerCase());return r===-1?null:[{start:r,end:r+t.length}]}function Bet(t,e){return TJ(t.toLowerCase(),e.toLowerCase(),0,0)}function TJ(t,e,r,n){if(r===t.length)return[];if(n===e.length)return null;if(t[r]===e[n]){let o=null;return(o=TJ(t,e,r+1,n+1))?Gwe({start:n,end:n+1},o):null}return TJ(t,e,r,n+1)}function wJ(t){return 97<=t&&t<=122}function nF(t){return 65<=t&&t<=90}function RJ(t){return 48<=t&&t<=57}function qet(t){return t===32||t===9||t===10||t===13}var Het=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(t=>Het.add(t.charCodeAt(0)));function zwe(t){return wJ(t)||nF(t)||RJ(t)}function Gwe(t,e){return e.length===0?e=[t]:t.end===e[0].start?e[0].start=t.start:e.unshift(t),e}function Vwe(t,e){for(let r=e;r<t.length;r++){let n=t.charCodeAt(r);if(nF(n)||RJ(n)||r>0&&!zwe(t.charCodeAt(r-1)))return r}return t.length}function EJ(t,e,r,n){if(r===t.length)return[];if(n===e.length)return null;if(t[r]!==e[n].toLowerCase())return null;{let o=null,s=n+1;for(o=EJ(t,e,r+1,n+1);!o&&(s=Vwe(e,s))<e.length;)o=EJ(t,e,r+1,s),s++;return o===null?null:Gwe({start:n,end:n+1},o)}}function jet(t){let e=0,r=0,n=0,o=0,s=0;for(let d=0;d<t.length;d++)s=t.charCodeAt(d),nF(s)&&e++,wJ(s)&&r++,zwe(s)&&n++,RJ(s)&&o++;let a=e/t.length,c=r/t.length,u=n/t.length,l=o/t.length;return{upperPercent:a,lowerPercent:c,alphaPercent:u,numericPercent:l}}function zet(t){let{upperPercent:e,lowerPercent:r}=t;return r===0&&e>.6}function Get(t){let{upperPercent:e,lowerPercent:r,alphaPercent:n,numericPercent:o}=t;return r>.2&&e<.8&&n>.6&&o<.2}function Vet(t){let e=0,r=0,n=0,o=0;for(let s=0;s<t.length;s++)n=t.charCodeAt(s),nF(n)&&e++,wJ(n)&&r++,qet(n)&&o++;return(e===0||r===0)&&o===0?t.length<=30:e<=5}function $we(t,e){if(!e||(e=e.trim(),e.length===0)||!Vet(t))return null;e.length>60&&(e=e.substring(0,60));let r=jet(e);if(!Get(r)){if(!zet(r))return null;e=e.toLowerCase()}let n=null,o=0;for(t=t.toLowerCase();o<e.length&&(n=EJ(t,e,0,o))===null;)o=Vwe(e,o+1);return n}var ybr=qwe(Hwe,$we,Uet),bbr=qwe(Hwe,$we,Bet),_br=new km(1e4);var rF=128;function kJ(){let t=[],e=[];for(let r=0;r<=rF;r++)e[r]=0;for(let r=0;r<=rF;r++)t.push(e.slice(0));return t}function Wwe(t){let e=[];for(let r=0;r<=t;r++)e[r]=0;return e}var xbr=Wwe(2*rF),Sbr=Wwe(2*rF),Ibr=kJ(),Cbr=kJ(),Tbr=kJ();var $et;(r=>{r.Default=[-100,0];function e(n){return!n||n.length===2&&n[0]===-100&&n[1]===0}r.isDefault=e})($et||={});var Bwe=class{constructor(e,r){this.firstMatchCanBeWeak=e;this.boostFullMatch=r}static{this.default={boostFullMatch:!0,firstMatchCanBeWeak:!1}}};var Kwe;(e=>{function t(r){return r&&typeof r=="object"&&typeof r.id=="string"}e.isThemeColor=t})(Kwe||={});var $2;(g=>{g.iconNameSegment="[A-Za-z0-9]+",g.iconNameExpression="[A-Za-z0-9-]+",g.iconModifierExpression="~[A-Za-z]+",g.iconNameCharacter="[A-Za-z0-9~-]";let o=new RegExp(`^(${g.iconNameExpression})(${g.iconModifierExpression})?$`);function s(v){let y=o.exec(v.id);if(!y)return s(Jr.error);let[,_,b]=y,S=["codicon","codicon-"+_];return b&&S.push("codicon-modifier-"+b.substring(1)),S}g.asClassNameArray=s;function a(v){return s(v).join(" ")}g.asClassName=a;function c(v){return"."+s(v).join(".")}g.asCSSSelector=c;function u(v){return v&&typeof v=="object"&&typeof v.id=="string"&&(typeof v.color>"u"||Kwe.isThemeColor(v.color))}g.isThemeIcon=u;let l=new RegExp(`^\\$\\((${g.iconNameExpression}(?:${g.iconModifierExpression})?)\\)$`);function d(v){let y=l.exec(v);if(!y)return;let[,_]=y;return{id:_}}g.fromString=d;function p(v){return{id:v}}g.fromId=p;function f(v,y){let _=v.id,b=_.lastIndexOf("~");return b!==-1&&(_=_.substring(0,b)),y&&(_=`${_}~${y}`),{id:_}}g.modify=f;function m(v){let y=v.id.lastIndexOf("~");if(y!==-1)return v.id.substring(y+1)}g.getModifier=m;function h(v,y){return v.id===y.id&&v.color?.id===y.color?.id}g.isEqual=h})($2||={});var AJ=new RegExp(`\\$\\(${$2.iconNameExpression}(?:${$2.iconModifierExpression})?\\)`,"g"),Wet=new RegExp(`(\\\\)?${AJ.source}`,"g");function Ywe(t){return t.replace(Wet,(e,r)=>r?e:`\\${e}`)}var Obr=new RegExp(`\\\\${AJ.source}`,"g");var Mbr=new RegExp(`(\\s)?(\\\\)?${AJ.source}(\\s)?`,"g");var Fbr=new RegExp(`\\$\\(${$2.iconNameCharacter}+\\)`,"g");var Mv=class{constructor(e="",r=!1){if(this.value=e,typeof this.value!="string")throw Ar("value");typeof r=="boolean"?(this.isTrusted=r,this.supportThemeIcons=!1,this.supportHtml=!1):(this.isTrusted=r.isTrusted??void 0,this.supportThemeIcons=r.supportThemeIcons??!1,this.supportHtml=r.supportHtml??!1)}appendText(e,r=0){return this.value+=Ket(this.supportThemeIcons?Ywe(e):e).replace(/([ \t]+)/g,(n,o)=>"&nbsp;".repeat(o.length)).replace(/\>/gm,"\\>").replace(/\n/g,r===1?`\\
`:`

`),this}appendMarkdown(e){return this.value+=e,this}appendCodeblock(e,r){return this.value+=`
${Yet(r,e)}
`,this}appendLink(e,r,n){return this.value+="[",this.value+=this._escape(r,"]"),this.value+="](",this.value+=this._escape(String(e),")"),n&&(this.value+=` "${this._escape(this._escape(n,'"'),")")}"`),this.value+=")",this}_escape(e,r){let n=new RegExp(c0(r),"g");return e.replace(n,(o,s)=>e.charAt(s-1)!=="\\"?`\\${o}`:o)}};function Ket(t){return t.replace(/[\\`*_{}[\]()#+\-!~]/g,"\\$&")}function Yet(t,e){let r=t.match(/^`+/gm)?.reduce((o,s)=>o.length>s.length?o:s).length??0,n=r>=3?r+1:3;return[`${"`".repeat(n)}${e}`,t,`${"`".repeat(n)}`].join(`
`)}var PJ=W(Tr()),iF=W(ct()),Qwe=W(require("path"));var YC=class extends Y{constructor(r,n,o,s,a,c){super(r,n);this.embeddingsComputer=o;this.endPointProvider=s;this.projectTemplatesIndex=a;this.repositoryService=c}async prepare(r,n,o){if(!this.props.useTemplates)return{};if(!n)throw new Error("Progress is required");let s=await this.endPointProvider.getEmbeddingsEndpoint("ada"),a=await this.embeddingsComputer.computeEmbeddings(s,[this.props.query],{},void 0);if(!a)return{};n.report(new Wi(PJ.t("Searching project template index...")));let c=await this.projectTemplatesIndex.nClosestValues(a[0],1,.8);if(c.length===0)return{};{let u=c[0]?.split(":"),l=u[0].trim(),d=u[1].trim(),p=u[2].trim()===""?".":u[2].trim();if(!l||!d||!p)return{};let f=await H2(n,new Wi(PJ.t("Fetching project contents...")),this.repositoryService.getRepositoryItems(l,d,p),500);if(f.length===0)return{};let m;return p==="."?m=`httpx://github.com/${l}/${d}`:m=Qwe.default.dirname(f[0].html_url),this._metadata=new Gb(l,d,p,f),{url:m}}}render(r){return vscpp(vscppf,null,this.props.history&&vscpp(vscppf,null,vscpp(qt,{priority:600,history:this.props.history.filter(n=>n.response?.name===DJ&&n.request.type==="user")})),vscpp(iF.SystemMessage,{priority:1e3},"You are a VS Code assistant. Your job is to suggest a filetree directory structure for a project that a user wants to create.",vscpp("br",null),"If the user has already identified a project, they will provide a URL for the project and your job is to simply confirm the users's choice if the URL is relevant.",vscpp("br",null),"If the URL is not relevant, you should ignore the URL and simply suggest a filetree directory structure for a project that the user wants to create. Do not attempt to clarify the URL to the user.",vscpp("br",null),"Please do not guess a response and instead just respond with a polite apology if you are unsure.",vscpp("br",null),vscpp($r,null),vscpp(fi,null),vscpp(po,null),vscpp(lr,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"## Response template when user has not provided a project url ##",vscpp("br",null),"Sure, here's a proposed directory structure for a [project type] app:",vscpp("br",null),"\\`\\`\\`filetree",vscpp("br",null),"[project-name]",vscpp("br",null),"\u251C\u2500\u2500 src",vscpp("br",null),"\u2502   \u251C\u2500\u2500 app.ts",vscpp("br",null),"\u2502   \u2514\u2500\u2500 types",vscpp("br",null),"\u2502       \u2514\u2500\u2500 index.ts",vscpp("br",null),"\u251C\u2500\u2500 package.json",vscpp("br",null),"\u251C\u2500\u2500 tsconfig.json",vscpp("br",null),"\u2514\u2500\u2500 README.md",vscpp("br",null),"\\`\\`\\`",vscpp("br",null),"## Response template when user has provided a project url but it is irrelevant. Notice how the response ignores the provided URL entirely and does not attempt to clarify this to the user. ##",vscpp("br",null),"Sure, here's a proposed directory structure for a [project type] app:",vscpp("br",null),"\\`\\`\\`filetree",vscpp("br",null),"[project-name]",vscpp("br",null),"\u251C\u2500\u2500 src",vscpp("br",null),"\u2502   \u251C\u2500\u2500 app.ts",vscpp("br",null),"\u2502   \u2514\u2500\u2500 types",vscpp("br",null),"\u2502       \u2514\u2500\u2500 index.ts",vscpp("br",null),"\u251C\u2500\u2500 package.json",vscpp("br",null),"\u251C\u2500\u2500 tsconfig.json",vscpp("br",null),"\u2514\u2500\u2500 README.md",vscpp("br",null),"\\`\\`\\`",vscpp("br",null),["","Examples for response templates above. Please follow these examples as closely as possible.","","## Valid setup question without a project url ##","","User: Create a TypeScript express app","Assistant:","","Sure, here's a proposed directory structure for a TypeScript Express app:","","```filetree","my-express-app","\u251C\u2500\u2500 src","\u2502   \u251C\u2500\u2500 app.ts","\u2502   \u251C\u2500\u2500 controllers","\u2502   \u2502   \u2514\u2500\u2500 index.ts","\u2502   \u251C\u2500\u2500 routes","\u2502   \u2502   \u2514\u2500\u2500 index.ts","\u2502   \u2514\u2500\u2500 types","\u2502       \u2514\u2500\u2500 index.ts","\u251C\u2500\u2500 package.json","\u251C\u2500\u2500 tsconfig.json","\u2514\u2500\u2500 README.md","```","","## Valid setup question with an irrelevant url ##","","User: Create a TypeScript express app","URL: https://github.com/microsoft/vscode-extension-samples/tree/main/getting-started-sample","Assistant:","","Sure, here's a proposed directory structure for a TypeScript Express app:","","```filetree","my-express-app","\u251C\u2500\u2500 src","\u2502   \u251C\u2500\u2500 app.ts","\u2502   \u251C\u2500\u2500 controllers","\u2502   \u2502   \u2514\u2500\u2500 index.ts","\u2502   \u251C\u2500\u2500 routes","\u2502   \u2502   \u2514\u2500\u2500 index.ts","\u2502   \u2514\u2500\u2500 types","\u2502       \u2514\u2500\u2500 index.ts","\u251C\u2500\u2500 package.json","\u251C\u2500\u2500 tsconfig.json","\u2514\u2500\u2500 README.md","```","","## Invalid setup question","","User: Create a horse project","Assistant: Sorry, I don't know how to set up a horse project."].join(`
`),"## Response template when the user has provided a project url that is relevant ##",vscpp("br",null),"# USING_URL ",vscpp("br",null),"Sure, here's a GitHub sample project to help you get started on [project type]: [Project Type Sample](url)",vscpp("br",null),["","Examples for response template with a relevant url described above. Please follow this example as closely as possible.","","## Valid setup question with a relevant project url. Notice how you should not propose a file directory structure in this case. ##","","User: Create a vscode extension sample for contributing getting started walkthrough.","URL: https://github.com/microsoft/vscode-extension-samples/tree/main/getting-started-sample","Assistant:","","# USING_URL","Sure, here's a GitHub sample project to help you get started on creating a VSCode extension with a walkthrough contribution: [Walkthrough Sample](https://github.com/microsoft/vscode-extension-samples/tree/main/getting-started-sample)",""].join(`
`),vscpp("br",null),"## Additional Rules ##",vscpp("br",null),"You should generate a markdown file tree structure for the sample project and include it in your response if you are proposing a sample.",vscpp("br",null),"You should only list common files for the user's desired project type if you are proposing a sample.",vscpp("br",null),"You should always include a README.md file which describes the project if you are proposing a sample.",vscpp("br",null),"Do not include folders and files generated after compiling, building or running the project such as node_modules, dist, build, out.",vscpp("br",null),"Do not include image files such as png, jpg, ico, etc.",vscpp("br",null),"Do not include any descriptions or explanations in your response other than what is shown in the response templates.",vscpp("br",null),"If the user asks for a file content to be modified, respond with the same file tree structure and ask them to open the file to view the modifications.",vscpp("br",null),"Do not attempt to modify the file content your self and simply respond with the same file tree structure.",vscpp("br",null)),vscpp(iF.UserMessage,{priority:900},this.props.query,r.url&&vscpp(vscppf,null,"Below is the URL you should consider for your response.",vscpp("br",null),"URL: ",r.url,vscpp("br",null))),this._metadata&&vscpp(vscppf,null,vscpp("meta",{value:this._metadata})))}};YC=B([T(2,Mo),T(3,Le),T(4,cD),T(5,zc)],YC);var Gb=class extends rc{constructor(r,n,o,s){super();this.org=r;this.repo=n;this.path=o;this.githubRepoItems=s}};(e=>{function t(r){return r instanceof e}e.is=t})(Gb||={});var fp=W(ct());var oF=class extends Y{render(){return vscpp(vscppf,null,this.props.history&&vscpp(aF,{messages:this.props.history}),vscpp(fp.SystemMessage,{priority:1e3},"You are a VS Code assistant. Your job is to generate the contents of a file in a project when given the user description, specification and tree structure of the project that a user wants to create. ",vscpp("br",null),vscpp($r,null),vscpp(fi,null),vscpp(lr,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"Think step by step and give me contents for just the file requested by the user. The code should not contain bugs.",vscpp("br",null),"If the user has asked for modifications to an existing file, please use the File path and File contents provided below if applicable.",vscpp("br",null),"If the file is supposed to be empty, please respond with a code comment saying that this file is intentionally left blank.",vscpp("br",null),"Do not include comments in json files.",vscpp("br",null),"Do not use code blocks or backticks.",vscpp("br",null),"Do not include product names such as Visual Studio in the comments.",vscpp("br",null)),this.props.relavantFiles&&this.props.relavantFiles.size>0&&vscpp(vscppf,null,vscpp(fp.UserMessage,{priority:500},"Below, you will find a list of file paths and their contents previously used",vscpp("br",null),Array.from(this.props.relavantFiles).map(([e,r])=>`File path: ${e}
File contents: ${r}
`).join(`
`))),vscpp(fp.UserMessage,{priority:900},"Generate the contents of the file: ",this.props.filePath," ",vscpp("br",null),"This is the project tree structure:",vscpp("br",null),"\\`\\`\\`filetree' ",vscpp("br",null),this.props.fileTreeStr,vscpp("br",null),"\\`\\`\\`",vscpp("br",null),"The project should adhere to the following specification:",vscpp("br",null),this.props.projectSpecification,vscpp("br",null)))}},sF=class extends Y{render(){return vscpp(vscppf,null,this.props.history&&vscpp(aF,{messages:this.props.history}),vscpp(fp.SystemMessage,{priority:1e3},"You are a VS Code assistant. Your job is to generate the project specification when given the user description and file tree structure of the project that a user wants to create. ",vscpp("br",null),vscpp($r,null),vscpp(fi,null),vscpp(lr,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"Think step by step and respond with a text description that lists and summarizes each file inside this project.",vscpp("br",null),"List the classes, types, interfaces, functions, and constants it exports and imports if it is a code file.",vscpp("br",null),"Consider filenames and file extensions when determining the programming languages used in the project. List any special configurations or settings required for configuration files such as package.json or tsconfig.json to help compile the project successfully",vscpp("br",null),"You should be as specific as possible when listing the public properties and methods for each exported class.",vscpp("br",null),"Do not use code blocks or backticks. Do not include any text before or after the file contents.",vscpp("br",null),"Do not include comments in json files.",vscpp("br",null),"Do not use code blocks or backticks.",vscpp("br",null),"Do not include product names such as Visual Studio in the comments.",vscpp("br",null),"Below you will find a set of examples of what you should respond with. Please follow these examples as closely as possible.",vscpp("br",null),vscpp("br",null),"## Valid question",vscpp("br",null),"User: I want to set up the following project: Create a TypeScript Express app",vscpp("br",null),"This is the project tree structure:",vscpp("br",null),"\\`\\`\\`markdown ",vscpp("br",null),"my-express-app",vscpp("br",null),"\u251C\u2500\u2500 src",vscpp("br",null),"\u2502   \u251C\u2500\u2500 app.ts",vscpp("br",null),"\u2502   \u251C\u2500\u2500 controllers",vscpp("br",null),"\u2502   \u2502   \u2514\u2500\u2500 index.ts",vscpp("br",null),"\u2502   \u251C\u2500\u2500 routes",vscpp("br",null),"\u2502   \u2502   \u2514\u2500\u2500 index.ts",vscpp("br",null),"\u2502   \u2514\u2500\u2500 types",vscpp("br",null),"\u2502       \u2514\u2500\u2500 index.ts",vscpp("br",null),"\u251C\u2500\u2500 package.json",vscpp("br",null),"\u251C\u2500\u2500 tsconfig.json",vscpp("br",null),"\u2514\u2500\u2500 README.md",vscpp("br",null),"\\`\\`\\`",vscpp("br",null),"## Valid response",vscpp("br",null),"Assistant: The project has the following files:",vscpp("br",null),"\\`src/app.ts\\`: This file is the entry point of the application. It creates an instance of the express app and sets up middleware and routes.",vscpp("br",null),"\\`src/controllers/index.ts\\`: This file exports a class \\`IndexController\\` which has a method \\`getIndex\\` that handles the root route of the application.",vscpp("br",null),"\\`src/routes/index.ts\\`: This file exports a function \\`setRoutes\\` which sets up the routes for the application. It uses the \\`IndexController\\` to handle the root route.",vscpp("br",null),"\\`src/types/index.ts\\`: This file exports interfaces \\`Request\\` and \\`Response\\` which extend the interfaces from the \\`express\\` library.",vscpp("br",null),"\\`tsconfig.json\\`: This file is the configuration file for TypeScript. It specifies the compiler options and the files to include in the compilation.",vscpp("br",null),"\\`package.json\\`: This file is the configuration file for npm. It lists the dependencies and scripts for the project.",vscpp("br",null),"\\`README.md\\`: This file contains the documentation for the project.",vscpp("br",null)),vscpp(fp.UserMessage,{priority:900},"I want to set up the following project: ",this.props.query,vscpp("br",null),"This is the project tree structure:",vscpp("br",null),"\\`\\`\\`markdown' ",vscpp("br",null),this.props.fileTreeStr,vscpp("br",null),"\\`\\`\\`",vscpp("br",null)))}},aF=class extends Y{render(e,r){let n=[];for(let o of this.props.messages)switch(o.role){case"user":n.push(vscpp(fp.UserMessage,{priority:600},o.content));break;case"assistant":n.push(vscpp(fp.AssistantMessage,{priority:800},o.content));break;default:break}return vscpp(vscppf,null,n)}};var cF=class{constructor(e,r){this.accessor=e;this.promptType=r;this.logger=e.get(ce).getPromptResponseLogger(this.constructor.name),this.options=e.get($n)}async generate(e,r){let n=await this.accessor.get(Le).getChatEndpoint("gpt-3.5-turbo"),s=await new Xe(n,this.promptType,e,this.accessor.get(ve).acquireTokenizer(n.family),this.accessor).render(),a=await this.accessor.get(jt).fetchOne(s.messages,void 0,r,3,n,void 0,{temperature:this.options.temperature,top_p:this.options.topP},{messageSource:typeof this.promptType});return this.logger.logResponse(a),a.type==="success"?e.filePath?this.parseContents(e.filePath,a.value):a.value:""}},uF=class extends cF{constructor(e){super(e,sF)}parseContents(e,r){throw new Error("Method not implemented.")}},lF=class extends cF{constructor(e){super(e,oF)}parseContents(e,r){function n(o,s){try{let a=s.exec(o.trim());if(a&&a.length>2)return a[2]}catch(a){console.error(a)}return o}if(e.endsWith(".md")){let o=n(r,/^```([a-zA-Z]+)?\s*([\s\S]+?)\s*```$/),[s,...a]=o.split("#");return s.length?["",...a].join("#"):o}else return n(r,/```([^\n]+)?\s*\n([\s\S]+?)\s*```/g)}};var mp=se("INewWorkspacePreviewContentManager"),QC=class{constructor(e){this.responseScopedData=new Map;this.prevFileContents=new Map;this.copilotContentManager=new NJ(e),this.githubContentManager=new LJ(e)}set(e,r,n,o){this.responseScopedData.set(e,n),FJ(n.baseUri)?this.githubContentManager.set(e,r,n,o):this.copilotContentManager.set(e,r,n,o)}get(e){this.prevResponseId!==e.authority&&(this.prevFileContents.clear(),this.prevResponseId=e.authority);let r;return FJ(e)?r=this.githubContentManager.get(e.authority,e.path):r=this.copilotContentManager.get(e.authority,e.path),r?.content?.then(n=>{if(this.prevFileContents.has(e.path))return;let s=new TextDecoder().decode(n);this.prevFileContents.set(e.path,s)}),r}getFileTree(e){return this.responseScopedData.get(e)}getFileContentsFromPrevHistory(){return this.prevFileContents}};QC=B([T(0,rt)],QC);var NJ=class{constructor(e){this.accessor=e;this.promises=[];this.responseScopedData=new Map;this.generatePlanPrompt=new uF(this.accessor);this.generateFilePrompt=new lF(this.accessor)}set(e,r,n,o){let{userPrompt:s,projectStructure:a,chatMessages:c}=o,u={query:s,fileTreeStr:a,history:c},l=this.generatePlanPrompt.generate(u,Fr.None);this.promises.push(l);let d=this._getResponseScopedData(e),p={userPrompt:s,projectSpecification:l,projectStructure:a,fileTree:n,chatMessages:c};d.set(r,p)}get(e,r){let{projectName:n,path:o}=this._getProjectMetadata(r),a=this._getResponseScopedData(e).get(n);if(!a)return;let c=a.fileTree.value,u=Jwe(c,o);if(u&&!u?.content){let l=u;l.content=this._getFileContent(a.userPrompt,a.projectStructure,a.projectSpecification,r,a.chatMessages).catch(()=>l.content=void 0)}return u}_prefetch(e,r,n,o,s){let a=Date.now();return o.children?{...o,type:2,children:o.children.map(c=>this._prefetch(e,r,n,c,s)),ctime:a}:{...o,type:1,content:void 0,ctime:a}}async _getFileContent(e,r,n,o,s){let a=this.accessor.get(mp).getFileContentsFromPrevHistory(),c={query:e,fileTreeStr:r,filePath:o,projectSpecification:await n,history:s,relavantFiles:a.has(o)?new Map([[o,a.get(o)]]):void 0};return this.generateFilePrompt.generate(c,Fr.None).then(u=>Buffer.from(u))}_getResponseScopedData(e){let r=this.responseScopedData.get(e);return r||(r=new Map,this.responseScopedData.set(e,r)),r}_getProjectMetadata(e){let[,r,...n]=e.split("/");return{projectName:r,path:n}}},LJ=class{constructor(e){this.responseScopedData=new Map;this.repositoryService=e.get(zc)}set(e,r,n,o){let s=o,a=this._getResponseScopedData(e),c={...s,fileTree:n};a.set(r,c)}get(e,r){let{projectName:n,path:o}=this._getProjectMetadata(r),a=this._getResponseScopedData(e).get(n);if(!a)return;let c=a.fileTree.value,u=Jwe(c,o);if(u&&!u?.content&&!u?.children){let l=u,d=a.path==="."?Xwe.relative(a.repo,r):r.slice(1);l.content=this.repositoryService.getRepositoryItemContent(a.org,a.repo,d).catch(()=>l.content=void 0)}return u}_getProjectMetadata(e){let[,r,...n]=e.split("/");return{projectName:r,path:n}}_getResponseScopedData(e){let r=this.responseScopedData.get(e);return r||(r=new Map,this.responseScopedData.set(e,r)),r}};function Jwe(t,e){let r;for(let n of e)r?r.children&&(r=r.children.find(o=>o.name===n)??r):r=t.find(o=>o.name===n);return r}var DJ="new",dF=class{constructor(){this.id="new";this.locations=[2];this.description=Vb.t("Scaffold code for a new workspace");this.commandInfo={allowsEmptyArgs:!1,defaultEnablement:!0}}static{this.ID="new"}get intentDetectionInput(){let e="create_new_workspace";return{functionName:e,sampleQuestion:"Create a RESTful API server using typescript",modelDescription:"Scaffolds a new project from scratch based on requirements from the user.",functionCallingBlurb:`If the user's message is related to generating folders, projects, workspaces, or VS Code extensions, you should use the '${e}' function.`}}async invoke(e,r){let n=r.location,o=e.get(Le),s=await Mn(o,n);return new OJ(e,this,s,n)}};function Zwe(t){return{command:"github.copilot.createProject",arguments:[t],title:Vb.t("Create Workspace")}}var OJ=class{constructor(e,r,n,o){this.accessor=e;this.intent=r;this.endpoint=n;this.location=o;this.linkification={disable:!0}}get responseProcessor(){return new MJ(this.accessor,this.githubContentMetadata)}async getShouldUseProjectTemplate(e){let r=e.get(be).getConfig(ge.UseProjectTemplates);return r!==void 0?r:await e.get(Lt).getTreatmentVariableAsync("vscode","copilotchat.useProjectTemplates",!0)?!(await e.get(Nn).getCopilotToken()).isPublicSuggestionsEnabled():!1}async buildPrompt(e,r,n,o,s){let a=e.getLatestTurn(),c=a.request.message,u=e.turns.length>1?e.turns.slice(0,-1):[],l=u[u.length-1]?.request?.message!==a.request.message&&await this.getShouldUseProjectTemplate(this.accessor),d=new Xe(this.endpoint,YC,{useTemplates:l,query:c,history:u},this.accessor.get(ve).acquireTokenizer(this.endpoint.family),this.accessor),p=await d.render(n,s),f=d.getMeta(Gb);return f&&(this.githubContentMetadata=f),p}async commands(e){let r=this.accessor.get(ce).getPromptResponseLogger("new");if(!e.response?.message||!e.requestId)return[];let n=this.accessor.get(mp).getFileTree(e.requestId);return n?FJ(n.baseUri)?[]:[Zwe(n)]:(r.info("[workspaceIntent] Failed to fetch project items."),[])}};function Qet(t){let e=(t.match(/   /g)||[]).length;return e+=(t.match(/\|   /g)||[]).length,e+=(t.match(/    /g)||[]).length,e+=(t.match(/ /g)||[]).length,e+=(t.match(/ /g)||[]).length,e}var Xet=["node_modules","out","bin","debug","obj","lib",".dll",".pdb",".lib",".jpg",".png",".ico",".gif",".svg",".jpeg",".tiff",".bmp",".webp",".jpeg",".gitignore","LICENSE.txt","yarn.lock","package-lock.json"];function eRe(t){let e=[];for(let r of t)Jet(r)||(r.children&&(r.children=eRe(r.children)),e.push(r));return e}function Jet(t){return!!Xet.includes(t.name)}function Zet(t,e){let r=e.trim().split(`
`),n=[],o,s={name:"",children:[]};n[0]=s;for(let c of r){let u=Qet(c),l=c.lastIndexOf("\u2500\u2500 "),d=l>=0?c.substring(l+3):c,p={name:d};if(u===0){o=tRe(t,d),s.name=d;continue}else{for(;u>0&&n[u-1]===void 0;)u--;n[u-1].children===void 0?n[u-1].children=[p]:n[u-1].children?.push(p),n[u]=p}}if(o===void 0)throw new Error("Base URI is undefined");let a=eRe(s.children);return a=a.sort((c,u)=>c.children&&!u.children?-1:1),{chatResponseTree:new Gm(a,o),projectName:s.name}}function ett(t,e,r){let n;r?n=t.map(l=>[e.path,l.path].join("/")):n=t.map(l=>l.path);let o=n[0].split("/")[0],s={name:o,children:[]},a={rootName:s};for(let l of n){let d=l.split("/"),p=o,f=s;for(let m=1;m<d.length;m++){let h=d[m];if(p+=`/${h}`,!a[p]){let g={name:h};f.children===void 0&&(f.children=[]),f.children.push(g),a[p]=g}f=a[p]}}let c;r?c=s.children?.[0].children??[]:c=s.children??[];let u=c?.sort((l,d)=>l.children&&!d.children?-1:1)??[];return new Gm(u,e)}var UJ="vscode-copilot-workspace",BJ="vscode-copilot-github-workspace";function tRe(t,e,r=!1){return pn.from({scheme:r?BJ:UJ,authority:t??"",path:e?`/${e}`:void 0})}var MJ=class{constructor(e,r){this.accessor=e;this.githubContentMetadata=r;this._appliedText="";this._p=Promise.resolve("")}async processResponse(e,r,n,o,s){let a=!1,c="",u=/```filetree\n/,l=r.filter(p=>p.role!=="system"),d=!1;for await(let{delta:p}of n){if(s.isCancellationRequested)break;let f=p.text;this._p=this._p.then(async()=>{let m=e.requestId??"";if(e.response||(e.response={message:this._appliedText,type:"model"}),!f)return this._appliedText;if(e.response.message+=f,this._appliedText+=f,this._appliedText.startsWith("#"))/(?:.*\n){1,}/.test(this._appliedText)&&o.markdown(f);else{let h=e.request.message,g=this._appliedText.match(/```filetree\n([\s\S]+?)\n```/);if(g&&(a||!d)){a=!1;let[v,y]=this._appliedText.split(g[0]);d||o.markdown(v),c=g[1];let{chatResponseTree:_,projectName:b}=Zet(m,c);o.progress(Vb.t("Generating workspace preview...")),o.push(_),o.markdown(y),this.accessor.get(mp).set(m,b,_,{userPrompt:h,projectStructure:c,chatMessages:l})}else if(this._appliedText.match(u)&&!a&&!g){a=!0;let[v,y]=this._appliedText.split(u);c+=y,o.progress(Vb.t("Generating workspace preview..."))}else a?c+=f:!a&&!this._appliedText.match(/```/)&&(d=!0,o.markdown(f))}return this._appliedText})}if(await this._p,e.requestId&&this.githubContentMetadata&&this.githubContentMetadata.org&&this.githubContentMetadata.repo&&this.githubContentMetadata.path&&this.githubContentMetadata.githubRepoItems&&!this.accessor.get(mp).getFileTree(e.requestId)){o.reference(pn.parse(this.githubContentMetadata.githubRepoItems[0].html_url)),o.progress(Vb.t("Generating workspace preview..."));let p=this.githubContentMetadata.path===".",f=p?this.githubContentMetadata.repo:this.githubContentMetadata.path.split("/")[0],m=ett(this.githubContentMetadata.githubRepoItems,tRe(e.requestId,f,!0),p);o.push(m),o.button(Zwe(m)),this.accessor.get(mp).set(e.requestId,f,m,this.githubContentMetadata);let h=encodeURIComponent(`["@workspace /${DJ} ${e.request.message}"]`),g=new Mv(Vb.t("Hint: You can [regenerate this project without using this sample](command:workbench.action.chat.open?{0}) or use this [setting](command:workbench.action.openSettings?%5B%22github.copilot.chat.useProjectTemplates%22%5D) to configure the behavior.",h));g.isTrusted={enabledCommands:["workbench.action.openSettings","workbench.action.chat.open"]},o.markdown(g)}return this._appliedText}};function FJ(t){return t.scheme==="vscode-copilot-github-workspace"}var Xs=require("vscode"),W2=class{constructor(e){this.contentManager=e;this._onDidChangeFile=new Xs.EventEmitter;this.onDidChangeFile=this._onDidChangeFile.event}async stat(e){let r=this.contentManager.get(e);if(!r)throw Xs.FileSystemError.FileNotFound(e);let n=await r.content?.then(o=>o?.length)??0;return{ctime:r.ctime??0,mtime:r.ctime??0,size:n,type:r.children?Xs.FileType.Directory:Xs.FileType.File}}readDirectory(e){let r=this.contentManager.get(e);if(!r)throw Xs.FileSystemError.FileNotFound(e);return r.children?.map(n=>[n.name,n.children?Xs.FileType.Directory:Xs.FileType.File])??[]}async readFile(e){let r=this.contentManager.get(e);if(!r)throw Xs.FileSystemError.FileNotFound(e);let n;try{n=await r.content}catch{}return n??new Uint8Array}watch(e,r){return{dispose(){}}}createDirectory(e){throw Xs.FileSystemError.NoPermissions(e)}writeFile(e,r,n){throw Xs.FileSystemError.NoPermissions(e)}delete(e,r){throw Xs.FileSystemError.NoPermissions(e)}rename(e,r,n){throw Xs.FileSystemError.NoPermissions(r)}copy(e,r,n){throw Xs.FileSystemError.NoPermissions(r)}};function iRe(t,e){return At.Disposable.from(At.workspace.registerFileSystemProvider(UJ,new W2(t.get(mp)),{isReadonly:new At.MarkdownString(At.l10n.t(`This file preview was generated by Copilot and may contain surprises or mistakes.

Ask followup questions to refine it, then press Create Workspace.`))}),At.workspace.registerFileSystemProvider(BJ,new W2(t.get(mp)),{isReadonly:!0}),At.commands.registerCommand("github.copilot.createProject",async r=>{let n=(await At.window.showOpenDialog({canSelectFolders:!0,canSelectFiles:!1,canSelectMany:!1,openLabel:"Select as Parent Folder"}))?.[0];if(!n)return;let o=r.baseUri.path,s=await ttt(n,o),a=[];At.window.tabGroups.all.forEach(u=>{u.tabs.forEach(l=>{l.input instanceof At.TabInputText&&l.input.uri.scheme==="vscode-copilot-workspace"&&a.push(l)})}),At.window.tabGroups.close(a,!0);let c=At.Uri.joinPath(n,s);try{await At.window.withProgress({location:At.ProgressLocation.Notification,cancellable:!0},async(u,l)=>{await At.workspace.fs.createDirectory(c);async function d(p,f,m){let h=At.Uri.joinPath(c,p,f.name);if(f.children?.length||!Uwe(f.name)){u.report({message:At.l10n.t("Creating folder {0}...",h.fsPath)}),await At.workspace.fs.createDirectory(h);for(let g of f.children??[])await d(rRe.posix.join(p,f.name),g,m)}else{u.report({message:At.l10n.t("Creating file {0}...",h.fsPath)});let g=await At.workspace.fs.readFile(At.Uri.joinPath(m,p,f.name));await At.workspace.fs.writeFile(h,Buffer.from(g))}}for(let p of r.value)await d("",p,r.baseUri);At.interactive.transferActiveChat(c),t.get(ce).getLogger("newIntent").info("Opening folder: "+c.fsPath),await ntt(c),await At.commands.executeCommand("vscode.openFolder",c)})}catch(u){let l=`Failed to create workspace: ${s}`;t.get(ce).getLogger("newIntent").error(`${l}
${u.message}`),At.window.showErrorMessage(l),await At.workspace.fs.delete(c,{recursive:!0})}}))}async function ttt(t,e){let r=0,n=!0,o=e;for(;n;)try{await At.workspace.fs.stat(At.Uri.joinPath(t,o)),o=e+"-"+ ++r}catch{n=!1}return o}async function rtt(t){try{return await At.workspace.fs.stat(t),!0}catch{return!1}}async function ntt(t){let e=itt();if(e)if(await rtt(e)){let r=await At.workspace.fs.readFile(e).then(o=>new nRe.TextDecoder().decode(o)),n=JSON.parse(r);n.push(t.toString()),await At.workspace.fs.writeFile(e,Buffer.from(JSON.stringify(n,null,2)))}else await At.workspace.fs.writeFile(e,Buffer.from(JSON.stringify([t.toString()],null,2)))}function itt(){let t=At.env.appName.indexOf("Insider")>0||At.env.appName.indexOf("Code - OSS Dev")>=0?"Code - Insiders":"Code",e=At.Uri.file(process.env.HOME||(process.env.USERPROFILE?process.env.USERPROFILE:""));switch(process.platform){case"darwin":return At.Uri.joinPath(e,"Library","Application Support",t,"User","workspaceStorage","aiGeneratedWorkspaces.json");case"linux":return At.Uri.joinPath(e,".config",t,"User","workspaceStorage","aiGeneratedWorkspaces.json");case"win32":return process.env.APPDATA?At.Uri.joinPath(At.Uri.file(process.env.APPDATA),t,"User","workspaceStorage","aiGeneratedWorkspaces.json"):void 0;default:return}}async function oRe(t,e){let r=t.get(Tt),n=t.get(ho),o=t.get(Di),s=t.get(Ze),a=t.get(lo),c=t.get(z_),u=t.get(Fo),l=s.getWorkspaceFolders().map(y=>y.fsPath+"/"),d=s.notebookDocuments.map(y=>y.uri.fsPath),f=(await Promise.all(e.map(y=>o.getWorkspaceSymbols(y)))).flat().map(y=>({name:y.name,kind:y.kind,containerName:y.containerName,filePath:y.location.uri.fsPath,start:y.location.range.start,end:y.location.range.end})),m=r.activeTextEditor?n.getDiagnostics(r.activeTextEditor.document.uri).map(y=>({start:y.range.start,end:y.range.end,message:y.message,severity:y.severity,relatedInformation:y.relatedInformation?.map(ott)})):[],h=r.activeTextEditor?{selections:r.activeTextEditor?.selections.map(y=>({anchor:y.anchor,active:y.active,isReversed:y.isReversed}))??[],documentFilePath:r.activeTextEditor?.document.uri.fsPath??"",visibleRanges:r.activeTextEditor?.visibleRanges.map(y=>({start:y.start,end:y.end}))??[],languageId:r.activeTextEditor?.document.languageId??"javascript"}:void 0,g=a.terminalLastCommand?{commandLine:a.terminalLastCommand.commandLine,cwd:typeof a.terminalLastCommand.cwd=="object"?a.terminalLastCommand.cwd.toString():a.terminalLastCommand.cwd,exitCode:a.terminalLastCommand.exitCode,output:a.terminalLastCommand.output}:void 0;return{workspaceFoldersFilePaths:l,symbols:f,activeFileDiagnostics:m,activeTextEditor:h,debugConsoleOutput:c.consoleOutput,terminalBuffer:a.terminalBuffer,terminalLastCommand:g,terminalSelection:a.terminalSelection,terminalShellType:a.terminalShellType,repoContexts:u.repositories,notebookDocumentFilePaths:d,activeNotebookEditor:void 0}}function ott(t){return{filePath:t.location.uri.fsPath,start:t.location.range.start,end:t.location.range.end,message:t.message}}var qJ=se("IConversationFeature"),XC=class{constructor(e,r,n,o,s,a,c,u,l,d,p,f,m){this.accessor=e;this.instantionService=r;this.configurationService=o;this.conversationOptions=s;this.chatAgentService=a;this.telemetryService=c;this.copilotTokenNotifier=l;this.embeddingIndex=d;this.devContainerConfigurationService=p;this.gitCommitMessageService=f;this.linkifyService=m;this._disposables=new Nt;this._activatedDisposables=new Nt;this.logger=n.getLogger("chat"),this._enabled=!1,this._activated=!1,this.registerCopilotTokenListener(),this._disposables.add(u.onDidAuthenticationChange(async()=>{let h=u.copilotToken;this.logger.debug("onDidChangeSessionsHandler",h),h?this.activated=!0:this.activated=!1}))}get enabled(){return this._enabled}set enabled(e){e&&!this.activated&&(this.activated=!0),this._enabled=e,Fe.commands.executeCommand("setContext","github.copilot.interactiveSession.disabled",!e)}get activated(){return this._activated}set activated(e){if(this._activated!==e)if(this._activated=e,!e)this._activatedDisposables.clear();else{let r=this.conversationOptions;this._activatedDisposables.add(this.registerProviders()),this._activatedDisposables.add(this.registerCommands(r)),this._activatedDisposables.add(this.registerRelatedInformationProviders()),this._activatedDisposables.add(this.registerParticipants(r))}}dispose(){this._activated=!1,this._activatedDisposables.dispose(),this._disposables?.dispose()}[Symbol.dispose](){this.dispose()}registerParticipants(e){return this.chatAgentService.register(e)}registerProviders(){let e=new Nt;try{"registerMappedEditsProvider"in Fe.chat&&e.add(Fe.chat.registerMappedEditsProvider("*",this.instantionService.createInstance(WC))),"registerNewSymbolNamesProvider"in Fe.languages&&e.add(Fe.languages.registerNewSymbolNamesProvider({language:"*"},this.instantionService.createInstance(pp))),e.add(Fe.workspace.registerAITextSearchProvider("file",this.instantionService.createInstance(GC)))}catch(r){this.logger.error("Registration of interactive providers failed:",r.toString())}return e}registerCommands(e){let r=new Nt;return[Fe.commands.registerCommand("github.copilot.interactiveSession.feedback",async()=>Fe.env.openExternal(Fe.Uri.parse(uM()))),Fe.commands.registerCommand("github.copilot.debug.workbenchState",async()=>{let n=await Fe.window.showInputBox({prompt:"Enter a comma-separated list of symbol queries. Can be left blank if not using WorkspaceSymbols"}),o=await Fe.window.showInputBox({prompt:"Enter a file name - .state.json will be appended as the extension",value:"workspaceState"});if(!o)return;let s=await oRe(this.accessor,n?.split(",")??[]),a=Fe.workspace.workspaceFolders?.[0].uri;if(!a)return;let c=Fe.Uri.joinPath(a,`${o}.state.json`),u=JSON.stringify(s,null,2);u=u.replace(new RegExp(`${a.fsPath}/`,"g"),"./"),Fe.workspace.fs.writeFile(c,Buffer.from(u))}),Fe.commands.registerCommand("github.copilot.terminal.explainTerminalSelection",async()=>this.triggerTerminalChat({query:`/${Hb.intentName} #terminalSelection`})),Fe.commands.registerCommand("github.copilot.terminal.explainTerminalSelectionContextMenu",()=>Fe.commands.executeCommand("github.copilot.terminal.explainTerminalSelection")),Fe.commands.registerCommand("github.copilot.terminal.explainTerminalLastCommand",async()=>this.triggerTerminalChat({query:`/${Hb.intentName} #terminalLastCommand`})),Fe.commands.registerCommand("github.copilot.terminal.generateCommitMessage",async()=>{let n=Fe.workspace.workspaceFolders;if(!n?.length)return;let o=n.length===1?n[0].uri:await Fe.window.showWorkspaceFolderPick().then(c=>c?.uri);if(!o)return;let s=this.gitCommitMessageService.getRepository(o);if(!s)return;let a=await this.gitCommitMessageService.generateCommitMessage(s,Fr.None);if(a){let u=`git commit -m "${a.replace(/"/g,'\\"').replace(/\\/g,"\\\\").replace(/\$/g,"\\$")}"`;Fe.window.activeTerminal?.sendText(u,!1)}}),Fe.commands.registerCommand("github.copilot.git.generateCommitMessage",async(n,o,s)=>{let a=this.gitCommitMessageService.getRepository(n);if(!a)return;let c=await this.gitCommitMessageService.generateCommitMessage(a,s);c&&(a.inputBox.value=c)}),Fe.commands.registerCommand("github.copilot.devcontainer.generateDevContainerConfig",async(n,o=new Fe.CancellationTokenSource().token)=>this.devContainerConfigurationService.generateConfiguration(n,o)),Fe.commands.registerCommand("github.copilot.resetAutomaticCommandExecutionPrompt",async()=>{this.accessor.get(zt).workspaceState.update(z2,!1)}),uwe(this.accessor),Cwe(this.telemetryService),this.linkifyService.registerGlobalLinkifier({create:()=>this.instantionService.createInstance(qC)}),pwe(this.accessor),wwe(this.accessor),this.registerTerminalQuickFixProviders(),stt(this.accessor,e),iRe(this.accessor,e),utt(this.accessor),$Ee(this.accessor),Swe(this.accessor),att(),ctt()].forEach(n=>r.add(n)),r}async triggerTerminalChat(e){let r=this.configurationService.getConfig(ge.TerminalChatLocation),n;switch(r){case"quickChat":n="workbench.action.quickchat.toggle",e.query=`@${g0} `+e.query;break;case"terminal":n="workbench.action.terminal.chat.start";break;case"chatView":default:n="workbench.action.chat.open",e.query=`@${g0} `+e.query;break}await Fe.commands.executeCommand(n,e)}registerRelatedInformationProviders(){let e=new Nt;return[Fe.ai.registerRelatedInformationProvider(Fe.RelatedInformationType.CommandInformation,this.embeddingIndex.commandIdIndex),Fe.ai.registerRelatedInformationProvider(Fe.RelatedInformationType.SettingInformation,this.embeddingIndex.settingsIndex)].forEach(r=>e.add(r)),e}registerCopilotTokenListener(){this._disposables.add(this.copilotTokenNotifier.onCopilotToken(e=>{this.logger.info(`copilot token chat_enabled: ${e.envelope.chat_enabled}`),this.enabled=e.envelope.chat_enabled??!1}))}registerTerminalQuickFixProviders(){let e=new Nt;return e.add(Fe.window.registerTerminalQuickFixProvider("copilot-chat.fixWithCopilot",{provideTerminalQuickFixes:(r,n)=>this.enabled?[{command:"github.copilot.terminal.explainTerminalLastCommand",title:Fe.l10n.t("Explain using Copilot")}]:[]})),e.add(Fe.window.registerTerminalQuickFixProvider("copilot-chat.generateCommitMessage",{provideTerminalQuickFixes:(r,n)=>this.enabled?[{command:"github.copilot.terminal.generateCommitMessage",title:Fe.l10n.t("Generate Commit Message")}]:[]})),e}};XC=B([T(0,rt),T(1,or),T(2,ce),T(3,be),T(4,$n),T(5,BP),T(6,me),T(7,fn),T(8,Vi),T(9,Ku),T(10,nD),T(11,lD),T(12,lC)],XC);function stt(t,e){let r=t.get(be);return Fe.commands.registerCommand("github.copilot.newNotebook",async n=>{let o=r.getConfig(ge.NotebookIterativeImproving);await Fe.window.withProgress({location:Fe.ProgressLocation.Notification},async s=>{let a=new Fe.NotebookData([]);a.metadata={custom:{cells:[],metadata:{orig_nbformat:4},nbformat:4,nbformat_minor:2}};let c=await Fe.workspace.openNotebookDocument("jupyter-notebook",a),u=await Fe.window.showNotebookDocument(c);s.report({message:Fe.l10n.t("Generating notebook...")});let l=n.outline.description,d=n.outline.sections,p=await t.get(Le).getChatEndpoint("gpt-4");for(let f of d){let m=u.notebook.getCells().filter(I=>I.kind===Fe.NotebookCellKind.Code).map(I=>I.document.getText()).join(`
`),h=new Fe.CancellationTokenSource;s.report({message:Fe.l10n.t('Generating section "{0}"...',f.title)});let g=await fwe(t,p,e,n.turn,l,f,m,h.token);if(!g)return;g=g.trim();let v=/```([a-zA-Z]+)?\s*([\s\S]+?)\s*```$/.exec(g);if(v&&v.length>2&&(g=v[2]),o){s.report({message:Fe.l10n.t('Improving code for section "{0}"...',f.title)});let I=await mwe(t,p,e,l,f,m,g,h.token);if(!I)return;g=I}let y=new Fe.NotebookCellData(Fe.NotebookCellKind.Markup,`# ${f.title}
${f.content}`,"markdown"),_=new Fe.NotebookCellData(Fe.NotebookCellKind.Code,g,"python"),b=Fe.NotebookEdit.insertCells(c.cellCount,[y,_]),S=new Fe.WorkspaceEdit;S.set(c.uri,[b]),await Fe.workspace.applyEdit(S),u.revealRange(new Fe.NotebookRange(c.cellCount-1,c.cellCount),Fe.NotebookEditorRevealType.Default),u.selection=new Fe.NotebookRange(c.cellCount-1,c.cellCount)}s.report({increment:100})})})}function att(){return Fe.commands.registerCommand("github.copilot.executeSearch",async t=>{let e=t.filesToExclude.length>0||t.filesToInclude.length>0;Fe.commands.executeCommand("workbench.view.search.focus").then(()=>Fe.commands.executeCommand("workbench.action.search.toggleQueryDetails",{show:e})),Fe.commands.executeCommand("workbench.action.findInFiles",t)})}function ctt(){return Fe.commands.registerCommand("github.copilot.ghpr.applySuggestion",async(t,e)=>{let r=s=>!!(s&&"body"in s&&(s.body instanceof Fe.MarkdownString||typeof s.body=="string")),n=s=>"range"in s&&s.range instanceof Fe.Range;if(!r(t)||!n(e))return;let o=t.body instanceof Fe.MarkdownString?t.body.value:t.body;await Fe.commands.executeCommand("vscode.editorChat.start",{initialRange:e.range,message:o,autoSend:!0})})}function utt(t){return new tF(t)}var pF=require("path"),fF=W(require("vscode"));var HJ="---------------------------------",JC=class{constructor(e){this.accessor=e}async _canReport(){return!(!this.accessor.get(be).getConfig(ge.DebugReportFeedback)||!(await this.accessor.get(Nn).getCopilotToken())?.isInternal)}async reportInline(e,r,n){if(!await this._canReport())return;let o=e.getLatestTurn();if(!o)return;let s=r.intent?this._embedCodeblock("INTENT",r.intent.id):"",a=this._embedCodeblock("CONTEXT",JSON.stringify({document:r.document.uri.toString(),fileIndentInfo:r.fileIndentInfo,language:r.language,wholeRange:r.wholeRange,selection:r.selection},null,"	")),c="",u=o.chatMessages;if(u&&u.length>0){let m=u.map(h=>this._embedCodeblock(h.role.toUpperCase(),h.content)).join(`
`);c=`	${HJ}
${this._headerSeparator()}PROMPT MESSAGES:
${m}`}else c=this._embedCodeblock(o.request.type.toUpperCase(),o.request.message);let l=this._embedCodeblock("ASSISTANT",o.response?.message||""),d=this._embedCodeblock("Parsed response",JSON.stringify(n,null,"	")),f=`
<details><summary>Prompt Details</summary>
<p>

${`${s}
${a}
${c}
${l}
${d}
`}

</p>
</details>
`;if(o.requestDebugInformation){let m=(0,pF.basename)(o.requestDebugInformation.uri.path),h=o.requestDebugInformation.userSelection,g=`
<details><summary>STest</summary>
<p>

STest code:
\`\`\`ts
stest({ description: 'Issue', language: ${JSON.stringify(o.requestDebugInformation.languageId)}, model }, (accessor) => {
	return simulateInlineChat(accessor, {
		files: [fromFixture(${JSON.stringify(m)})],
		queries: [
			{
				file: ${JSON.stringify(m)},
				selection: [${h.start.line}, ${h.start.character}, ${h.end.line}, ${h.end.character}],
				query: ${JSON.stringify(o.requestDebugInformation.userPrompt)},
				diagnostics: 'tsc',
				expectedIntent: ${JSON.stringify(o.requestDebugInformation.intentId)},
				validate: async (outcome, workspace) => assertNoDiagnostics(accessor, outcome, workspace, 'tsc')
			}
		]
	});
});
\`\`\`

${m} content:
\`\`\`${(0,pF.extname)(o.requestDebugInformation.uri.path).substring(1)}
${o.requestDebugInformation.initialDocumentText}
\`\`\`

</p>
</details>
		`;f=f+`
${g}`}await this._reportIssue("Feedback for inline chat",f)}async reportChat(e){if(!await this._canReport())return;let r="",n=e.chatMessages;if(n&&n.length>0){let u=n.map(l=>this._embedCodeblock(l.role.toUpperCase(),l.content)).join(`
`);r=`	${HJ}
${this._headerSeparator()}PROMPT MESSAGES:
${u}`}else r=this._embedCodeblock(e.request.type.toUpperCase(),e.request.message);let o=e.intentInvocation?.intent?this._embedCodeblock("INTENT",`[${e.intentInvocation.intent.id}] ${e.intentInvocation.intent.description}`):"",s=this._embedCodeblock("ASSISTANT",e.response?.message||""),c=`
<details><summary>Prompt Details</summary>
<p>

${`${o}
${r}
${s}
`}

</p>
</details>`;await this._reportIssue("Feedback for sidebar chat",c)}_embedCodeblock(e,r){let n=this._bodySeparator()+r.split(`
`).join(`
${this._bodySeparator()}`);return`	${HJ}
${this._headerSeparator()}${e}:
${n}`}_headerSeparator(){return"	"}_bodySeparator(){return"		"}async _reportIssue(e,r){await fF.commands.executeCommand("workbench.action.openIssueReporter",{extensionId:Rb,issueTitle:e,data:r,issueBody:"",uri:fF.Uri.parse("https://github.com/microsoft/vscode-copilot")})}};JC=B([T(0,rt)],JC);var Po=W(require("vscode"));var Fv=W(ct()),$b=W(require("vscode"));var K2=class extends Y{render(){let e=[],r=[];for(let n of this.props.messages)n.role===$b.LanguageModelChatMessageRole.System?e.push(n.content):n.role===$b.LanguageModelChatMessageRole.Assistant?r.push(vscpp(Fv.AssistantMessage,null,n.content)):n.role===$b.LanguageModelChatMessageRole.User&&($b.LanguageModelChatMessageFunctionResultPart&&n.content2 instanceof $b.LanguageModelChatMessageFunctionResultPart&&r.push(vscpp(Fv.FunctionMessage,{name:n.content2.name},n.content2.content)),n.content&&r.push(vscpp(Fv.UserMessage,{name:n.name},n.content)));return vscpp(vscppf,null,vscpp(Fv.SystemMessage,null,this.props.noSafety?e:vscpp(vscppf,null,vscpp(ir,null),vscpp(po,null),vscpp("br",null),e.join(`
`))),r)}};async function sRe(t){let e=t.get(or),r=t.get(ve),n=t.get(fn),o=t.get(Le),s=t.get(ce).getLogger("registerChatResponseProvider"),{extensionMode:a,subscriptions:c}=t.get(zt);try{await t.get(fn).getCopilotToken()}catch(g){t.get(ce).defaultLogger.error(g),s.warn("Chat response providers are not available without auth token");return}let u=new Nt;if(c.push(u),a===qc.Test){s.warn("Chat response providers are not available in test mode");return}let l=n.anyGitHubSession;if(!l){s.error("Auth token not present when we expected it to be");return}let d=new Map,p=async()=>{let g=new Map,v=await o.getAllChatEndpoints(),y=new Set;s.debug("UPDATING language models");for(let _ of v){if(u.isDisposed)break;if(y.has(_.family))continue;y.add(_.family);let b=d.get(_.model);if(b){g.set(_.model,b);continue}let S=await new Xe(_,K2,{noSafety:!1,messages:[]},r.acquireTokenizer(_.family),t).countTokens(),I={vendor:"copilot",name:_.name,family:_.family,version:_.version,maxInputTokens:4096-S-Ene,maxOutputTokens:4096/2,auth:{label:l.account.label}},w=e.createInstance(Y2,_,I),O=Po.chat.registerChatResponseProvider(_.model,w,I);g.set(_.model,{endpoint:_,dispo:O}),s.debug("ADDED language model",_.model)}for(let[_,b]of d)g.has(_)||(b.dispo.dispose(),s.debug("REMOVED language model",_));d=g,u.isDisposed||(f=setTimeout(p,1e3*60*15))},f;await p(),u.add(Ta(()=>{clearInterval(f);for(let g of d.values())g.dispo.dispose()}));let m=t.get(Mo),h=await t.get(Le).getEmbeddingsEndpoint("ada");u.add(Po.lm.registerEmbeddingsProvider(`copilot.${h.model}`,new class{async provideEmbeddings(g,v){let y=await m.computeEmbeddings(h,g,{parallelism:2},v);if(!y)throw new Error("Failed to compute embeddings");return y.map(_=>({values:_.slice(0)}))}})),s.debug("Registered language models and embeddings")}var Y2=class extends St{constructor(r,n,o,s,a,c,u,l){super();this._endpoint=r;this._metadata=n;this._accessor=o;this._expService=s;this._telemetryService=a;this._chatMLFetcher=c;this._tokenizerProvider=u;this._blockedExtensionService=l;this._onDidReceiveLanguageModelResponse2=this._register(new Ht);this.onDidReceiveLanguageModelResponse2=this._onDidReceiveLanguageModelResponse2.event;this._register(this._chatMLFetcher.onDidMakeChatMLRequest(({model:d,source:p,tokenCount:f})=>{d===this._endpoint.model&&this._onDidReceiveLanguageModelResponse2.fire({extensionId:p?.extensionId??Rb,participant:p?.agent,tokenCount:f})}))}async _provideLanguageModelResponse(r,n,o,s,a){let c=Po.extensions.getExtension(o,!0);if(!c||typeof c.packageJSON.version!="string")throw new Error("Invalid extension information");let u=c.packageJSON.version,l=Po.l10n.t("The extension has been temporarily blocked due to making too many requests. Please try again later.");if(this._blockedExtensionService.isExtensionBlocked(o))throw Po.LanguageModelError.Blocked(l);let d=await this._expService.getTreatmentVariableAsync("vscode","copilotchat.languageModelControlList"),p=aRe.extractCustomTokenLimit(d??"",o)??this._metadata.maxInputTokens,{messages:f,tokenCount:m}=await new Xe(this._endpoint,K2,{noSafety:!1,messages:r},this._tokenizerProvider.acquireTokenizer(this._endpoint.family),this._accessor).render();if(this._telemetryService.sendMSFTTelemetryEvent("languagemodelrequest",{extensionId:o,extensionVersion:u,model:this._endpoint.model},{tokenCount:m,tokenLimit:p}),m>p)throw new Error("Message exceeds token limit.");if(n.tools&&n.tools.length>128)throw new Error("Cannot have more than 128 tools per request.");let h=new Proxy(this._endpoint,{get:function(_,b,S){return b==="getExtraHeaders"?function(){return{..._.getExtraHeaders?.()??{},"x-onbehalf-extension-id":`${o}/${u}`}}:Reflect.get(_,b,S)}}),g=jJ.options[this._endpoint.model].convert(n.modelOptions??{}),v={messageSource:`api.${o}`};g.functions=n.tools?.map(_=>({name:_.name,description:_.description,parameters:_.parametersSchema}));let y=await this._chatMLFetcher.fetchMany(f,s,a,3,h,{extensionId:o},g,v,{intent:!0});if(y.type!=="success")throw y.type==="extensionBlocked"?(this._blockedExtensionService.reportBlockedExtension(o,y.retryAfter),Po.LanguageModelError.Blocked(l)):new Error(y.reason);this._telemetryService.sendInternalMSFTTelemetryEvent("languagemodelrequest",{extensionId:o,extensionVersion:u,requestid:y.requestId,query:f[f.length-1].content,model:this._endpoint.model},{tokenCount:m,tokenLimit:p})}async provideLanguageModelResponse2(r,n,o,s,a){let c=async(u,l,d)=>{if(d.text&&s.report({index:l,part:new Po.LanguageModelChatResponseTextPart(d.text)}),d.copilotFunctionCalls)for(let p of d.copilotFunctionCalls)s.report({index:l,part:new Po.LanguageModelChatResponseFunctionUsePart(p.name,p.arguments)})};return this._provideLanguageModelResponse(r,n,o,c,a)}async provideLanguageModelResponse(r,n,o,s,a){let c=async(u,l,d)=>{s.report({index:l,part:d.text})};return this._provideLanguageModelResponse(r,{modelOptions:n},o,c,a)}async provideTokenCount(r){if(typeof r=="string")return this._tokenizerProvider.acquireTokenizer(this._endpoint.family).tokenLength(r);{let s={role:new Map([[Po.LanguageModelChatMessageRole.Assistant,"assistant"],[Po.LanguageModelChatMessageRole.User,"user"],[Po.LanguageModelChatMessageRole.System,"system"]]).get(r.role)??"user",content:r.content};return this._tokenizerProvider.acquireTokenizer(this._endpoint.family).countMessageTokens(s)}}};Y2=B([T(2,rt),T(3,Lt),T(4,me),T(5,jt),T(6,ve),T(7,UP)],Y2);var aRe;(e=>{function t(r,n){let o=r.indexOf(n);if(o<0)return;let s=o+n.length,a=r.indexOf(",",s);a<0&&(a=r.length);let c=Number(r.substring(s,a));if(!isNaN(c))return c*1e3}e.extractCustomTokenLimit=t})(aRe||={});function ltt(...t){return e=>t.some(r=>r(e))}var jJ=class t{constructor(e){this._description=e}static{this._defaultDesc={stop:ltt(cP,pE),temperature:S_,max_tokens:S_,frequency_penalty:S_,presence_penalty:S_}}static{this.options={"gpt-3.5-turbo":new t({...this._defaultDesc}),"gpt-4":new t({...this._defaultDesc}),"copilot-preview-gpt35-centralus":new t({...this._defaultDesc}),"code-llama":new t({}),"gpt-4-0125-preview":new t({...this._defaultDesc}),"copilot-preview-4o-0e26a807":new t({...this._defaultDesc})}}convert(e){let r={};for(let n in this._description){let o=this._description[n],s=e[n];s!=null&&o(s)&&(r[n]=s)}return r}};var PRe=W(Tr());var mF=class{constructor(e,r,n,o,s,a,c){this.accessor=e;this.intent=r;this.location=n;this.endpoint=o;this.prompt=s;this.documentContext=a;this.features=c;this.replyInterpreterFactory=null;this.followUps=void 0}async buildPrompt(e,r,n,o,s){let c=e.getLatestTurn().request.message,u=e.turns.length>1?e.turns.slice(0,-1):[],l=new Xe(this.endpoint,this.prompt,{documentContext:this.documentContext,query:c,history:u,features:this.features},this.accessor.get(ve).acquireTokenizer(this.endpoint.family),this.accessor),d=await l.render();return this.replyInterpreterFactory=l.getMeta(ei)?.factory??null,this.followUps=l.getMeta(PI)?.followUps,d}createReplyInterpreter(){if(!this.replyInterpreterFactory)throw new Error("No reply interpreter factory available.");return this.replyInterpreterFactory()}};var fm=W(ct());function cRe(t,e,r,n){let o=t.modelMaxPromptTokens*4/3,s=new cp(o),a=e.document,c=e.language,u=new Qs(s,a,c,"ed8c6549bwf9"),l=new Qs(s,a,c,"abpxx6d04wxr"),d=new Qs(s,a,c,"be15d9bcejpp"),p=()=>(l.trim(),u.trim(),d.trim(),{contextInfo:{language:c,above:l,range:u,below:d,outlineAbove:"",outlineBelow:""},tracker:s});if(!dtt(u,r,n))return p();let m={aboveLineIndex:n.start.line-1,belowLineIndex:n.end.line+1,minimumLineIndex:0,maximumLineIndex:a.lineCount-1};return PX(m,l,d),p()}function dtt(t,e,r){let n=Math.floor((e.start.line+e.end.line)/2),o=Math.max(n-r.start.line,r.end.line-n);t.appendLine(n);for(let s=1;s<=o;s++){let a=n-s,c=n+s;if(a>=r.start.line&&!t.prependLine(a)||c<=r.end.line&&!t.appendLine(c))return!1}return!0}function Uv(t,e,r,n){let o=t.getDiagnostics(e).filter(s=>!!s.range.intersection(r));if(n){let s=o.filter(a=>n.includes(a.message));if(s.length>0)return s}return o}async function uRe(t,e,r){let n=YP(e),o=Math.max(r,e.end.line-e.start.line+r),s=await t.getFixSelectionOfInterest(n,o);return QP(s)}var Bv=class extends Y{constructor(r,n,o,s,a,c,u,l,d){super(r,n);this.ignoreService=o;this.extensionContext=s;this.languageFeaturesService=a;this.workspaceService=c;this.logService=u;this.parserService=l;this.servicesAccessor=d;this._logger=this.logService.getLogger("ReferencesAtPosition")}static{this.DEFAULT_TIMEOUT_MS=200}async prepare(){if(await this.ignoreService.isCopilotIgnored(this.props.document.uri))return{k:"ignored"};let r=this.extensionContext.extensionMode===qc.Test?0:this.props.timeoutMs===void 0?Bv.DEFAULT_TIMEOUT_MS:this.props.timeoutMs,[n,o]=await this.findReferences(r);return this._logger.debug(`Found ${n.length} implementation(s)/definition(s), ${o.length} usages`),n.length>0&&this._logger.debug("Implementation(s)/definition(s) found:",JSON.stringify(n,null,"	")),o.length>0&&this._logger.debug("Usages found:",JSON.stringify(o,null,"	")),{k:"found",definitions:n,usages:o}}render(r,n){if(r.k==="ignored")return vscpp("ignoredFiles",{value:[this.props.document.uri]});let{document:o,position:s}=this.props,{definitions:a,usages:c}=r;if(a.length===0){let u=o.lineAt(s.line);a.push({languageId:o.languageId,uri:o.uri,code:u.text,excerptRange:u.range})}return vscpp(vscppf,null,"Relevant definition",a.length>1?"s":"",": ",vscpp("br",null),vscpp("br",null),a.map(u=>{let p=`${`${As(u.languageId).lineComment.start} FILEPATH: ${u.uri.path}`}
${u.code}`;return vscpp(Oe,{uri:u.uri,languageId:u.languageId,code:p})}),vscpp("br",null),"Other uses: ",vscpp("br",null),vscpp(Oe,{uri:null,code:c.map(u=>u.code).join(`
`)}))}async findReferences(r){let{document:n,position:o}=this.props,s=async()=>{try{let l=await this.languageFeaturesService.getReferences(n.uri,o);return this._logger.debug(`Found ${l.length} references`,JSON.stringify(l,null,"	")),l}catch{return[]}},a=await ha(this.servicesAccessor,n,r*3,s,[]),c=[],u=[];for(let l of a){if(await this.ignoreService.isCopilotIgnored(l.uri))continue;let d=await this.workspaceService.openTextDocument(l.uri),p=this.parserService.getTreeSitterAST(d);if(!p)continue;let f=Xi(l.range,d),m=await p.getCallExpressions(f),h=await p.getFunctionDefinitions();if(m.length>0)u.push({languageId:d.languageId,uri:d.uri,code:m[0].text,excerptRange:Ps(d,m[0])});else if(h.some(g=>Ji.doIntersect(g,f))){let v=(await Av(this.servicesAccessor,{document:d,language:As(n.languageId),wholeRange:l.range,selection:new jm(l.range.start,l.range.end),fileIndentInfo:void 0})).range;c.push({languageId:d.languageId,uri:d.uri,code:d.getText(v),excerptRange:v})}}return[c,u]}};Bv=B([T(2,De),T(3,zt),T(4,Di),T(5,Ze),T(6,ce),T(7,_t),T(8,rt)],Bv);function lRe(t,e){let r=typeof e.code=="object"?e.code.value:e.code,n=mtt(t,e.source,r);return{fixes:n,messageReplacement(){for(let o of n)if(typeof o=="object"&&o.replaceMessage!==void 0)return o.replaceMessage},additionalContext(){let o=[];for(let s of n)typeof s=="object"&&s.additionalContext!==void 0&&o.push(s.additionalContext);return o}}}var ptt=["typescript"],ftt=["eslint","ts"];function mtt(t,e,r){if(!ptt.includes(t)||!ftt.includes(e))return[];let n=`${t}:${e}`;if(!zJ[n]||!r||!zJ[n][r])return[];let o=zJ[n][r];return Array.isArray(o)?o:[o]}var zJ={"typescript:ts":{2345:{title:"Use this declaration and other usages as examples.",message:"",additionalContext:0}},"typescript:eslint":{"class-methods-use-this":["Make the method static.","Move the method outside of the class.","Rewrite the method to use properties of the class."],"consistent-this":["Use the alias for this required by eslint consistent-this rule.","Use this directly instead of an alias."],"constructor-super":{title:"Add missing super call and pass through new arguments.",message:"The code is missing a super call in the constructor. Copy base class parameters to this constructor and pass them to super.",replaceMessage:"Missing super call in constructor"},"func-names":["Give the function expression the same name as the variable it is assigned to.","Convert the function to an arrow function."],"func-style":[{title:"Convert the function declaration to an expression.",message:"The function expression should be assigned to a variable with the name of the original function declaration."}],"max-lines-per-function":["Split into multiple functions."],"max-nested-callbacks":["Rewrite to avoid at least one callback."],"max-params":[{title:"Rewrite the signature to use an object parameter.",message:"Preserve all the parameters of the original signature."}],"max-statements":["Split into multiple functions."],"no-case-declarations":["Surround the case block with braces.","Move the declaration outside the case block."],"no-dupe-else-if":["Fix the duplicate condition to be different from the first.","Remove the duplicate condition"],"no-duplicate-case":[{title:"Change the duplicate condition to be different.",message:"Do not delete the duplicate case, just fix it.",replaceMessage:"Duplicated condition."},"Remove the duplicate condition"],"no-duplicate-imports":"Merge the duplicated import lines.","no-fallthrough":[{title:"Rewrite to avoid fallthrough.",message:"Use the return value of the following cases and copy it to the preceding fallthrough case.",replaceMessage:"Fallthrough case in switch statement."},"Add a // fallthrough comment.","Add a break statement."],"no-inner-declarations":["Move the inner declaration to the top of its containing function.","Move the inner declaration to the bottom of its containing function.","Change the inner function declaration to an expression."],"no-multi-assign":"Assign each variable in separate statements.","no-negated-condition":"Invert the branches of the conditional.","no-new":["Convert the class to functions.","Assign the resulting object to a variable."],"no-sequences":[{title:"Wrap the whole comma sequence in parentheses.",message:"",replaceMessage:"Unnecessary comma sequence"},{title:"Rewrite, preserving the original behavior.",message:"The last element of the comma sequence is the one returned."},{title:"Delete the non-final elements of the sequence.",message:"They are unused unless it is for side effects."}],"no-sparse-arrays":["Remove duplicated commas.","Add default values for the missing elements."],"require-await":["Removed the unused async keyword.",{title:"Rewrite the function to use await.",message:"The code should change to call asynchronous functions where appropriate."}],"sort-keys":{title:"Sort the properties of the entire object literal.",message:"",replaceMessage:"Unsorted keys in object literal."}}};var htt=200,dRe=300,hp=class extends Y{async prepare(e,r,n){return{isIgnored:await this.accessor.get(De).isCopilotIgnored(this.props.documentContext.document.uri)}}render(e,r){let{diagnostics:n,documentContext:o}=this.props;return e.isIgnored?vscpp("ignoredFiles",{value:[o.document.uri]}):n.length>0&&vscpp(vscppf,null,n.map((s,a)=>{let c=lRe(o.language.languageId,s);return vscpp(vscppf,null,vscpp(GJ,{diagnostic:s,cookbook:c,maxLength:htt,documentContext:o}),vscpp(VJ,{diagnostic:s,cookbook:c,document:o.document}),vscpp($J,{cookbook:c}))}))}},GJ=class extends Y{render(e,r){let n=this.props.diagnostic,o=this.props.documentContext.document,s=n.range,a=o.getText(new ze(s.start.line,0,s.end.line+1,0)).trimEnd(),c=a.length>0&&a.length<this.props.maxLength?a:"";return c?vscpp(vscppf,null,"This code",vscpp("br",null),vscpp(Oe,{code:c,uri:o.uri,shouldTrim:!1}),vscpp("br",null),vscpp(vscppf,null,"has the problem reported:",vscpp("br",null),n.message," ",vscpp("br",null))):vscpp(vscppf,null)}},VJ=class extends Y{constructor(e,r){super(e,r),this.workspaceService=r.get(Ze),this.parserService=r.get(_t),this.ignoreService=r.get(De)}async prepare(){return this.getRelatedInfos()}render(e,r){return!e.infos.length&&!e.definitionRanges.length?vscpp("ignoredFiles",{value:e.ignoredFiles}):vscpp(vscppf,null,"This diagnostic has some related code:",vscpp("br",null),e.infos.map(n=>vscpp(Oe,{code:n.content,uri:n.uri})),e.definitionRanges.map(n=>vscpp(Bv,{document:this.props.document,position:n.start})),vscpp("ignoredFiles",{value:e.ignoredFiles}),";")}async getRelatedInfos(){let e=[],r=[],n=[],o=this.props.diagnostic;if(o.relatedInformation)for(let a of o.relatedInformation)try{let c=a.location;if(await this.ignoreService.isCopilotIgnored(c.uri)){n.push(c.uri);continue}let u=await this.workspaceService.openTextDocument(c.uri),l=c.range,d=this.parserService.getTreeSitterAST(u),p;if(d){let f=YP(l),m=await d.getCoarseParentScope(f);p=u.getText(QP(m))}(!p||p.length>dRe)&&(p=u.getText(l)),p.length<=dRe&&e.push({content:p,uri:c.uri})}catch{}let s=this.props.cookbook.additionalContext();for(let a of s)switch(a){case 0:{let c=this.parserService.getTreeSitterAST(this.props.document);if(c){let u=Xi(this.props.diagnostic.range,this.props.document),l=await ha(this.accessor,this.props.document,500,()=>c.getCallExpressions(u),[]);for(let d of l){let p=Ps(this.props.document,d);r.push(p)}}break}case 1:{r.push(this.props.diagnostic.range);break}}return{infos:e,definitionRanges:r,ignoredFiles:n}}},$J=class extends Y{render(e,r){let n=this.props.cookbook.fixes;if(n.length){let o=n[0];return vscpp(vscppf,null,"Suggested fix:",vscpp("br",null),typeof o=="string"?o:o.title+o.message)}return null}};var hF=class extends Y{render(e,r){let{useWorkspaceChunksFromSelection:n,useWorkspaceChunksFromDiagnostics:o}=this.props;if(!n&&!o)return null;let s=r.tokenBudget;return n&&o&&(s=s/2),vscpp(vscppf,null,n&&vscpp(lm,{...this.getChunkSearchPropsForSelection(s)}),o&&vscpp(lm,{...this.getChunkSearchPropsForDiagnostics(s)}))}getChunkSearchPropsForSelection(e){let{document:r,wholeRange:n}=this.props.documentContext,o=r.validateRange(n);this.props.diagnostics.forEach(c=>{o=o.union(c.range)});let s=r.getText(o),a=[`Please find code that is similar to the following code block:
`,"```",s,"```"].join(`
`);return{query:{rawQuery:a,resolve:async()=>({rephrasedQuery:a,keywords:pRe(s)})},include:{exclude:[r.uri.fsPath]},maxResults:3}}getChunkSearchPropsForDiagnostics(e){let r=this.props.documentContext.document,n=this.props.diagnostics.map(s=>s.message).join(" "),o=`Please find code that can help me fix the following problems: ${n}`;return{query:{rawQuery:o,resolve:async()=>({rephrasedQuery:o,keywords:pRe(n)})},include:{exclude:[r.uri.fsPath]},maxResults:3}}};function pRe(t){let e=new Set;for(let r of t.matchAll(/(-?\d*\.\d\w*)|([^\`\~\!\@\#\%\^\&\*\(\)\-\=\+\[\{\]\}\\\|\;\:\'\"\,\.\<\>\/\?\s]+)/g))e.add(r[0]);return Array.from(e.values(),r=>({keyword:r,variations:[]}))}var gF=class extends Y{async prepare(e){let{document:r,wholeRange:n,fileIndentInfo:o}=this.props.documentContext,s=await this.accessor.get(De).isCopilotIgnored(r.uri),a=e.endpoint.modelMaxPromptTokens/3*4,c;if(!s&&r.getText().length>a){let u=await Ab(this.accessor.get(_t),r,o);c=MI(a,r,n,u,{tryPreserveTypeChecking:!0})}else c=new sm(r.getText(),Zn.empty,r.languageId);return{projectedDocument:c,isIgnored:s}}render(e,r){let{document:n,language:o,selection:s}=this.props.documentContext;if($t(n.uri))throw Ar("InlineFix3PlusPrompt should not be used with a notebook!");if(e.isIgnored)return vscpp("ignoredFiles",{value:[n.uri]});let{useWorkspaceChunksFromDiagnostics:a,useWorkspaceChunksFromSelection:c}=this.props.features,u=e.projectedDocument,l=u.projectRange(s),d=n.getText(new ze(s.start.line,0,s.end.line+1,0)).trimEnd(),p=[{uri:n.uri,version:n.version,ranges:[]}],f=Uv(this.accessor.get(ho),n.uri,s,this.props.query);return vscpp(vscppf,null,vscpp("usedContext",{value:p}),vscpp("meta",{value:new ei(()=>new WJ(u,n.uri,l))}),vscpp(fm.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"The user has a ",o.languageId," file opened in a code editor.",vscpp("br",null),"The user expects you to propose a fix for one or more problems in that file.",vscpp("br",null),"For the response always follow these instructions:",vscpp("br",null),"Describe in a single sentence how you would solve the problem. After that sentence, add an empty line. Then provide code changes or a terminal command to run.",vscpp("br",null),"When proposing to fix the problem by running a terminal command, write `",gtt,"` and provide a code block that starts with ```bash and contains the terminal script inside.",vscpp("br",null),vscpp(VC,null),vscpp(ir,null)),this.props.history&&vscpp(qt,{priority:700,history:this.props.history}),vscpp(fm.UserMessage,{priority:100},"I have the following code open in the editor.",vscpp("br",null),pm("someFolder/myFile.cs"),vscpp("br",null),vscpp(jM,null)),vscpp(fm.AssistantMessage,{priority:100},vscpp(zM,null)),vscpp(fm.UserMessage,{priority:700},vscpp(om,null,u.text.length>0?vscpp(vscppf,null,"I have the following code open in the editor, starting from line 1 to line ",u.lineCount,".",vscpp("br",null),pm(n.fileName),vscpp("br",null),vscpp(Oe,{uri:n.uri,languageId:o.languageId,code:u.text,shouldTrim:!1}),vscpp("br",null)):vscpp(vscppf,null,"I am in an empty file:",pm(n.fileName),vscpp("br",null))),vscpp(om,null,s.isEmpty?vscpp(vscppf,null,"I have the selection at line ",l.start.line+1,", column ",l.start.character+1,vscpp("br",null)):vscpp(vscppf,null,"I have currently selected from line ",l.start.line+1,", column ",l.start.character+1," to line ",l.end.line+1," column ",l.end.character+1,".",vscpp("br",null))),vscpp(om,null,d.length&&!f.some(m=>m.range.contains(s))&&vscpp(vscppf,null,"The content of the lines at the selection is",vscpp(Oe,{uri:n.uri,languageId:o.languageId,code:d,shouldTrim:!1}),vscpp("br",null))),vscpp(hp,{documentContext:this.props.documentContext,diagnostics:f}),vscpp(hF,{diagnostics:f,documentContext:this.props.documentContext,useWorkspaceChunksFromDiagnostics:a,useWorkspaceChunksFromSelection:c}),vscpp(fm.TextChunk,null,"Please find a fix for my code so that the result is without any errors.",vscpp("br",null),this.props.query,vscpp("br",null))))}},gtt=Owe("TERMINAL"),WJ=class{constructor(e,r,n){this.projectedDocument=e;this.documentUri=r;this.adjustedSelection=n;this._lastText=void 0;this._lastLength=0;this._replyProcessor=$M()}async processResponse(e,r,n){for await(let a of e)if(this._lastText=a.text,this._firstSentence===void 0){let c=this._replyProcessor.getFirstSentence(a.text);r.markdown(c.substring(this._lastLength)),this._lastLength=c.length,c.length<a.text.length&&(this._firstSentence=c,r.markdown(`

`),r.progress("Generating edits..."))}if(!this._lastText)throw new Error("No text");let o=this._replyProcessor.process(this._lastText,this.projectedDocument.text,this.documentUri,this.adjustedSelection.start.line);if(o.otherSections.length)for(let a of o.otherSections)r.markdown(a.content.join(`

`));if(o.otherPatches.length)for(let a of o.otherPatches)r.markdown(a.replace.join(`

`));o.invalidPatches.length&&r.warning("The edit generation was not successful. Please try again.");let s=o.edits;return s.length&&(s=this.projectedDocument.projectBackTextEdit(s),o.edits.length!==s.length&&o.annotations.push({message:"Some edits were not applied because they were out of bounds.",label:"summarize conflict",severity:"error"})),s.length?{type:"inlineEdit",edits:s,newWholeRange:void 0,annotations:o.annotations}:{type:"conversational",annotations:o.annotations}}};var yF=W(ct());function fRe(t,e){let r=t;for(let n of e){let o=n.range.start,s=n.range.end,a=r.start,c=r.end,u=n.newText.split(`
`).length,l=u-(s.line-o.line)-1,d=a.line,p=a.line;s.isBefore(a)?(d=a.line+l,p=c.line+l):o.isBefore(a)&&s.isAfterOrEqual(a)&&s.isBeforeOrEqual(c)?(d=o.line,p=c.line+l):o.isAfterOrEqual(a)&&o.isBeforeOrEqual(c)&&s.isAfter(c)?(d=a.line,p=s.line+l):o.isAfter(c)?(d=a.line,p=c.line):r.contains(n.range)?(d=a.line,p=c.line+l):n.range.contains(r)&&(d=o.line,p=o.line+u-1),r=new ze(d,0,p,0)}return r}var vtt=15,vF=class extends Y{async prepare(){let{document:e,selection:r}=this.props.documentContext,n=Uv(this.accessor.get(ho),e.uri,r,this.props.query),o=n.length>0?$ne(n):r,s=this.accessor.get(_t).getTreeSitterAST(e),a=s?await uRe(s,o,vtt):o;return{range:o,rangeOfInterest:a,diagnostics:n}}render({range:e,rangeOfInterest:r,diagnostics:n},o){let s=this.props.documentContext;if(!$t(this.props.documentContext.document.uri))throw Ar("InlineFix4Prompt should not be used with a non-notebook!");let a=cRe(o.endpoint,s,e,r),c=H8(this.accessor.get(Tt),this.accessor.get(Ze),s,a.contextInfo,a.tracker),u=s.document,l=[{uri:u.uri,version:u.version,ranges:Kt([c.range.toRange(),c.above.toRange(),c.below.toRange()])}],d=new KJ(this.accessor,e,c,s);return vscpp(vscppf,null,vscpp("usedContext",{value:l}),vscpp("meta",{value:new ei(()=>d)}),vscpp("meta",{value:new PI(()=>d.generateFollowUps())}),vscpp(yF.SystemMessage,null,vscpp(YI,{language:s.language}),vscpp("br",null),"When dealing with Jupyter Notebook, if a module is already imported in a cell, it can be used in other cells directly without importing it again. For the same reason, if a variable is defined in a cell, it can be used in other cells as well",vscpp("br",null),"When dealing with Jupyter Notebook, cells below the current cell can be executed before the current cell, you must use the variables defined in the cells below, unless you want to overwrite them.",vscpp("br",null),"When dealing with Jupyter Notebook, do not generate CELL INDEX in the code blocks in your answer, it is only used to help you understand the context.",vscpp("br",null),"If you suggest to run a terminal command, use a code block that starts with ```bash.",vscpp("br",null),'When fixing "ModuleNotFoundError" or "Import could not be resolved" errors, always use magic command "%pip install" to add the missing packages. The imports MUST be inserted at the top of the code block and it should not replace existing code.',vscpp("br",null),"You should not import the same module twice.",vscpp("br",null),vscpp(fi,null)),this.props.history&&vscpp(qt,{priority:700,history:this.props.history}),vscpp(_2,{documentContext:s,above:c.above,range:c.range,below:c.below,aboveCells:c.aboveCells,belowCells:c.belowCells,includeDelimeters:!0}),vscpp(yF.UserMessage,null,vscpp(hp,{documentContext:s,diagnostics:n}),"Describe in a single sentence how you would solve the problem. After that sentence, add an empty line. Then add a code block with the fix.",vscpp("br",null),this.props.query,vscpp("br",null)))}},KJ=class{constructor(e,r,n,o){this.accessor=e;this.wholeRange=r;this.contextInfo=n;this.documentContext=o;this._lastText=void 0;this._lastLength=0}async processResponse(e,r,n){for await(let s of e){if(this._lastText=s.text,this._firstSentence===void 0){let a=ITe(s.text);a.length<s.text.length&&(this._firstSentence=a),r.markdown(a.substring(this._lastLength)),this._lastLength=a.length}if(_8(s.text))break}if(!this._lastText)throw new Error("No text");let o=II(this.contextInfo,this._lastText,this.documentContext.language);return!o||o.language==="bash"||o.language==="ps1"?(r.markdown(this._lastText.substring(this._lastLength)),{type:"conversational"}):(this._edits=this.generateEdits(o.code),this._versionBeforeUpdate=this.documentContext.document.version,Db(this._edits,this.wholeRange))}generateEdits(e){let r=e.split(`
`),n=[],o=[];for(let c of r)c.match(/^[%\!]pip/)?n.push(c):o.push(c);if(!n.length)return lv(this.accessor,this.contextInfo,e,2,this.documentContext.fileIndentInfo,Pb.fromDocumentContext(this.documentContext));let s=[],a=dv(n,{whichLine:"topMost",lines:this.contextInfo.range.lines},this.documentContext.fileIndentInfo).join(`
`)+`
`;return s.push(new On(new ze(this.wholeRange.start,this.wholeRange.start),a)),o.length&&s.push(...lv(this.accessor,this.contextInfo,o.join(`
`),2,this.documentContext.fileIndentInfo,Pb.fromDocumentContext(this.documentContext))),s}async generateFollowUps(){return typeof this._edits>"u"||typeof this._versionBeforeUpdate>"u"?[]:this._generateFollowUps(this._edits,this.wholeRange,this._versionBeforeUpdate,Fr.None)}async _generateFollowUps(e,r,n,o){let a=await this.accessor.get(ho).waitForNewDiagnostics(this.documentContext.document.uri,o);if(!o.isCancellationRequested&&a.length&&this.documentContext.document.version!==n){let c=fRe(r,e),u=a.filter(l=>Wne(l)&&l.range.intersection(c));if(u.length)return u.length===1?[{label:Ki.t("An error remains after applying the change, click here to iterate."),prompt:`/fix ${u[0].message}`}]:[{label:Ki.t("{0} errors remain after applying the change, click here to iterate.",u.length),prompt:"/fix Fix the remaining errors"}]}return[]}};var _F=W(ct());var bF=class extends Y{render(e,r){let n=this.props.documentContext,o=({document:s,selection:a})=>Uv(this.accessor.get(ho),s.uri,a,this.props.query);return vscpp(vscppf,null,vscpp(_F.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"Follow the user's requirements carefully & to the letter.",vscpp("br",null),vscpp(fi,null),vscpp("br",null),vscpp("br",null),vscpp(up,{location:2,endpoint:this.props.endpoint}),vscpp("br",null),"First think step-by-step - describe your plan for what to build in pseudocode, written out in great detail.",vscpp("br",null),"Then output the code in a single code block.",vscpp("br",null),"Minimize any other prose.",vscpp("br",null),"Use Markdown formatting in your answers.",vscpp("br",null),"Make sure to include the programming language name at the start of the Markdown code blocks.",vscpp("br",null),"Avoid wrapping the whole response in triple backticks.",vscpp("br",null),"The user works in an IDE called Visual Studio Code which has a concept for editors with open files, integrated unit test support, an output pane that shows the output of running the code as well as an integrated terminal.",vscpp("br",null),"The active document is the source code the user is looking at right now.",vscpp("br",null),"You can only give one reply for each conversation turn.",vscpp("br",null),vscpp("br",null),"Additional Rules",vscpp("br",null),"You specialize in being a highly skilled code generator. Your task is to help the Developer fix an issue.",vscpp("br",null),"If context is provided, try to match the style of the provided code as best as possible.",vscpp("br",null),"Generated code is readable and properly indented.",vscpp("br",null),"Markdown blocks are used to denote code.",vscpp("br",null),"Preserve user's code comment blocks, do not exclude them when refactoring code.",vscpp("br",null),"Pay especially close attention to the selection or exception context.",vscpp("br",null),"Given a description of what to do you can refactor, fix or enhance the existing code.",vscpp(lr,null)),this.props.history&&vscpp(qt,{priority:700,history:this.props.history}),vscpp(Wr,{priority:800,document:this.props.documentContext?.document,range:this.props.documentContext?.selection}),n&&vscpp(_F.UserMessage,{priority:800},vscpp(hp,{documentContext:n,diagnostics:o(n)})),vscpp(ti,{priority:900,chatVariables:this.props.chatVariables,query:this.props.query}))}};var qv=W(Tr());var RF=W(Tr());var ERe=W(ct());var SF=W(ct());var xF=class extends Y{render(){let{chunk:e,failure:r,priority:n}=this.props,o=r.task.messages.filter(a=>a.location?.uri.toString()===e.file.toString()&&Zm(e.range).contains(a.location.range.start)),s=new yi(e.file,new ze(e.range.startLineNumber-1,0,e.range.endLineNumber,0));return vscpp(SF.UserMessage,{priority:n},o.length?vscpp(vscppf,null,'This is the source code of the test that failed. The error message is shown after the text "FAILURE_MESSAGE" on the line where it occurred:'):vscpp(vscppf,null,"The test failed with the message: ",r.task.messages.map(a=>typeof a.message=="object"?a.message.value:a.message).join(`
`),". The source code of the test is:"),vscpp("br",null),vscpp(Oe,{references:[new SF.PromptReference(s)],languageId:e.file.toString(),uri:e.file,code:e.text.split(`
`).map((a,c)=>{let u=o.find(l=>l.location?.range.start.line===c+e.range.startLineNumber-1);return u?`${a} FAILURE_MESSAGE: ${u.message.toString().replaceAll(`
`," ")}`:a}).join(`
`)}),vscpp("br",null))}};var ZC=W(ct());var ytt=/^[\*\-]\s*[`"']?([^<([`"'\s]+).*? +in +(.+)/gm,mRe=": ",yRe=(t,e)=>[...t.matchAll(ytt)].flatMap(([,r,n])=>r.split(",").map(o=>({keyword:o,fileUri:n,interest:"IMPLEMENTATION"}))).map(({keyword:r,fileUri:n,interest:o})=>{let s=IF(e,r,n)||IF(e,r);if(s||/^.+?(\b[^\b]+)/.exec(r)&&(IF(e,r[1],n)||IF(e,r[1])),!s)return;let{index:a,chunk:c}=s;if(c.sources.length){let d=c.sources.find(m=>m.start<=a&&m.end>a)||{start:0,end:0,range:c.range},p=c.text.lastIndexOf(`
`,a),f=x_(c.text.slice(d.start,a),`
`);return{keyword:r,interest:o,location:{uri:c.file,position:new Xr(d.range.startLineNumber+f-1,f===0?d.range.startColumn+a-d.start:a-(p+1))}}}let u=c.text.lastIndexOf(`
`,a)+1,l=c.text.indexOf(mRe,u);return{keyword:r,interest:o,location:{uri:c.file,position:new Xr(Number(c.text.slice(u,l))-1,a-(l+mRe.length))}}}).filter(I_);function IF(t,e,r){let n=r?t.filter(s=>s.file.toString().toLowerCase()===r.toLowerCase()):t,o=new RegExp(`^(?!~:).*\\b(${c0(e)})\\b`,"m");for(let s=n.length-1;s>=0;s--){let a=n[s],c=o.exec(a.text);if(c)return{chunk:a,index:c.index+c[0].length-c[1].length}}}var bRe=async(t,e,r,n)=>{let o=await r.readFile(t.uri),s=new TextDecoder().decode(o);return btt(t,e,s,n)},btt=async(t,e,r,n)=>{let o=new Ru(r),s=new gt(t.range.start.line+1,1,t.range.end.line+1,1);return s.endLineNumber-s.startLineNumber<=1&&(s=await xtt(t,e,r,o,n)||s.setEndPosition(s.startLineNumber+50,1)),_tt(s,r,t.uri,o)},_tt=(t,e,r,n)=>{let o=n.positionToOffset(t.getStartPosition()),s=n.positionToOffset(t.getEndPosition());return{text:e.substring(o,s),range:t,file:r,sources:[{start:0,end:s-o,range:t}]}},xtt=async(t,e,r,n,o)=>{let s=Bp(Ym(t.uri).languageId);if(!s)return;let c=await o.getTreeSitterASTForWASMLanguage(s,r).getFunctionDefinitions(),u=c.find(f=>f.identifier===e);if(u)return YJ(n,u);let l=n.positionToOffset(new qr(t.range.start.line+1,1));c.sort((f,m)=>f.startIndex-m.startIndex);let d,p;for(let f of c){if(f.startIndex>l){p=f;break}f.startIndex<=l&&f.endIndex>=l&&(d=f)}return p&&(!d||p.startIndex>=d.startIndex&&p.endIndex<=d.endIndex)?YJ(n,p):d&&YJ(n,d)},YJ=(t,e)=>{let r=t.offsetToPosition(e.startIndex),n=t.offsetToPosition(e.endIndex);return new gt(r.lineNumber-1,1,n.lineNumber+1,1)},_Re=async(t,e,r,n)=>{let o=Bp(Ym(n).languageId);if(!o)return a=>"";let s=await t.getSemanticChunkTree(o,e);return a=>{let c=r.positionToOffset(a.getStartPosition()),u=r.positionToOffset(a.getEndPosition()),l=Itt(s.roots,m=>m.info.mainBlock.startIndex<=c&&m.info.mainBlock.endIndex>=c),d="",p=(m,h)=>c<=m&&h<=u?!1:(d&&!d.endsWith(`
`)&&(d+=`
`),d+=e.slice(m,h),!0),f=m=>{if(m.info.detailBlocks.comments instanceof Array)for(let y of m.info.detailBlocks.comments)p(y.startIndex,y.endIndex);let h=/\s*\{\s/.exec(e.slice(m.info.detailBlocks.body.startIndex,m.info.detailBlocks.body.endIndex))?.[0].length||0,g=r.startOffsetOfLineContaining(m.info.mainBlock.startIndex),v=m.info.detailBlocks.body.startIndex+h;p(g,v)&&(d+=" ... "),m.children.forEach(f)};return l.forEach(f),d}},Stt=/@@ -\d+,\d+ \+(\d+),(\d+) @@/g,xRe=async(t,{source:e,convert:r},n,o)=>{let s=[];for(let a of o.matchAll(Stt)){let[,c,u]=a.map(Number),l=new qr(c,1),d=new qr(c+u,1);s.push({uri:n,start:l,end:d,convert:r,source:e,interest:"CHANGED",tokensWithoutExpansion:t.tokenLength(e.slice(r.positionToOffset(new qr(c,1)),r.positionToOffset(new qr(c+u,1))))})}return s},Itt=(t,e)=>{let r=n=>{let o=n.children.map(r).filter(I_);return o.length||e(n)?{children:o,info:n.info}:void 0};return t.map(r).filter(I_)},QJ=3,CF=2,Ctt=/^\s*/,TF=/\S/,SRe=(t,e)=>{let r=new Ru(t),n=e.map(l=>{let d=r.positionToOffset(new qr(l.range.start.line+1,l.range.start.character+1)),p=r.positionToOffset(new qr(l.range.end.line+1,l.range.end.character+1));return{start:d,end:p,text:l.newText}});n.sort((l,d)=>l.start-d.start||l.end-d.end);let o=0,s=0;function a(l){let d=l.indexOf(`
`);if(d===-1){s+=l.length;return}for(;d!==-1;)o++,s=l.length-d-1,d=l.indexOf(`
`,d+1)}let c=0,u=[];for(let{start:l,end:d,text:p}of n){a(t.slice(c,l));let f=new Xr(o,s);a(p);let m=new Xr(o,s);c=d;let h=t.slice(l,d);u.push({range:new ze(f,m),newText:h})}return u},XJ=t=>Ctt.exec(t)[0],IRe=(t,e,r)=>{let n=r.split(`
`),o=t.split(`
`),s=o.map(h=>h.trim()),a=XJ(o[0]),c=hRe(a,o[o.length-1])&&o.slice(1,-1).every(h=>vRe(h)||gRe(a,h));if(c){let h=Math.ceil(s.length/2);for(let g=0;g<=h;g++){let v=e.start.line-g,y=XJ(n[v]);e:for(let _=0;_<=h;_++){let b=e.end.line+_;if(!(b-v<2)&&hRe(y,n[b])){for(let S=v+1;S<b;S++)if(!vRe(n[S])&&!gRe(y,n[S]))continue e;return new ze(v,0,b,Number.MAX_SAFE_INTEGER)}}}}let u=e.start.line,l=s[0];if(l.length>=QJ)for(let h=0;h<=CF*2;h++){let g=h%2===0?1:-1,v=e.start.line+g*Math.floor(h/2);if(n[v].trim()===l){u=v;break}}let d=e.end.line,p=XJ(n[u]);if(c)for(let h=0;h<=CF*2;h++){let g=h%2===0?1:-1,v=d+g*Math.floor(h/2);if(n[v].startsWith(p)&&TF.test(n[v][p.length]))return new ze(u,0,v,Number.MAX_SAFE_INTEGER)}let f=0,m=0;for(;f<s.length-1&&m<(f+1)*QJ;)m+=s[s.length-1-f].length,f++;if(m>f*QJ)e:for(let h=e.end.line-CF;h<=e.end.line+CF;h++){for(let g=0;g<f;g++)if(n[h+g].trim()!==s[s.length-1-g])continue e;d=h;break}return new ze(u,0,d,Number.MAX_SAFE_INTEGER)};function hRe(t,e){return e.length>t.length&&e.startsWith(t)&&e[t.length].match(TF)}function gRe(t,e){return e.length>t.length&&e.startsWith(t)&&!TF.test(e[t.length])}function vRe(t){return!TF.test(t)}function Ttt(t,e,r){let n=NE(t,(l,d)=>l.start.lineNumber-d.start.lineNumber).start,o=NE(t,(l,d)=>d.end.lineNumber-l.end.lineNumber).end,s=e?new qr(Math.max(1,n.lineNumber-Math.ceil(e*2/3)),1):n,a=e-(n.lineNumber-s.lineNumber),c=a>0?new qr(o.lineNumber+a,1):o,u=r(new gt(s.lineNumber,1,c.lineNumber,1));return{start:s,end:c,context:u?u.split(`
`).map((l,d)=>`~: ${l}`).join(`
`)+`
`:"",snippet:t[0].source.slice(t[0].convert.positionToOffset(s),t[0].convert.positionToOffset(c)).split(`
`).map((l,d)=>`${s.lineNumber+d}: ${l}`).join(`
`),original:t}}function Ett(t){return CRe(t)+"```"+t.original[0].uri.toString()+`
`+t.context+t.snippet+"\n```\n"}function wtt({start:t,end:e,snippet:r,context:n,original:o}){let s=new gt(t.lineNumber,t.column,e.lineNumber,e.column);return{file:o[0].uri,text:n+r,range:s,sources:[]}}function CRe(t){let e=t.original.flatMap(r=>r.keywords||[]);return e.length?`Definition of \`${e.join("` and `")}\`:
`:`Here's code I've been working on that might be related to the failure:
`}function Rtt(t){return t.start.lineNumber>1||t.end.lineNumber<t.original[0].convert.lines}var EF=class extends Y{async prepare(e){let{chunks:r,parser:n,tokenizer:o}=this.props,s=0,a,c=new Pn;for(let u of r)c.has(u.uri)||c.set(u.uri,await _Re(n,u.source,u.convert,u.uri));for(;;){let u=(a?a.chunks.map(p=>p.original):r.map(p=>[p])).map(p=>Ttt(p,s,c.get(p[0].uri))),l=u.map(Ett).join(""),d=o.tokenLength(l);if(a&&(d*1.1>e.tokenBudget||!u.some(Rtt)))return Promise.resolve({chunks:u});for(let p=0;p<u.length;p++){let f=u[p],m=f.original[0].uri.toString(),h={startLineNumber:f.start.lineNumber,startColumn:1,endLineNumber:f.end.lineNumber,endColumn:1};for(let g=p+1;g<u.length;g++){let v=u[g];if(v.original[0].uri.toString()!==m)continue;let y={startLineNumber:v.start.lineNumber,startColumn:1,endLineNumber:v.end.lineNumber,endColumn:1};gt.areIntersectingOrTouching(h,y)&&(f.original.push(...v.original),u.splice(g,1),g--)}}s++,a={tokens:d,chunks:u}}}render({chunks:e}){return vscpp(vscppf,null,vscpp("meta",{value:new Q2(e.map(wtt))}),e.map((r,n)=>vscpp(ZC.UserMessage,{priority:100-(e.length-n)},CRe(r),vscpp(Oe,{languageId:r.original[0].uri.toString(),uri:r.original[0].uri,code:r.context+r.snippet,references:[new ZC.PromptReference(new yi(r.original[0].uri,new ze(r.start.lineNumber-1,0,r.end.lineNumber-1,0)))]}),vscpp("br",null))))}},Q2=class extends ZC.PromptMetadata{constructor(r){super();this.chunks=r}};var wF=class extends Y{render(){let{chunk:e,testFailure:r,references:n,turnsLeft:o,parser:s,tokenizer:a}=this.props,c=n.length>0;return vscpp(vscppf,null,vscpp(ERe.SystemMessage,{priority:1e3},"You are an assistant who specializes in diagnosing and fixing failing tests. The user will provide you with the source code of the test that failed, and the location where the failure happened. They will also provide you with relevant related code. This information may be incomplete.",vscpp("br",null),vscpp("br",null),"# Additional Rules",vscpp("br",null),vscpp("br",null),`- Read the test's source code and the line containing "FAILURE_MESSAGE". The text after "FAILURE_MESSAGE" is the error returned from running tests.`,vscpp("br",null),"- Assume that the test code and test fixtures are correct. It's more likely the problem is code called by the test.",vscpp("br",null),c&&vscpp(vscppf,null,"- The provided code is incomplete. DO NOT assume that something isn't implemented if it doesn't appear here.",vscpp("br",null)),o===0?vscpp(vscppf,null,'- If you believe you have found a bug in one of the code snippets the user provided, respond with "SOLUTION" followed by the file URI, "RANGE" followed by the line range, and then the corrected code for that line range and a brief explanation of the change.',vscpp("br",null)):vscpp(vscppf,null,c?vscpp(vscppf,null,'- If you have found a bug the code provided, respond with "SOLUTION" followed by the file URI, "RANGE" followed by the line range, and then the corrected code for that line range and a brief explanation of the change. Do this only if you have found the underlying bug!',vscpp("br",null),"- Otherwise, print a list of up to five keywords, classes, or function calls from one of the files that you need more information about to diagnose the failure. Make sure the most relevant keywords are written first. ",o===0&&"You won't get another chance to ask for more info.",vscpp("br",null),TRe):vscpp(vscppf,null,"- Don't try to fix the failure yet. Instead, print a list of keywords, classes, or function calls that you need more information about to diagnose the failure!",vscpp("br",null),TRe,vscpp("br",null)),"- NEVER ask the user for additional information or clarification, or give them suggestions to review code themselves. Instead, print keywords that should be investigated.",vscpp("br",null)),vscpp("br",null),o>0&&vscpp(vscppf,null,"# Example",vscpp("br",null),ktt,vscpp("br",null),vscpp("br",null)),c&&vscpp(vscppf,null,"# Example",vscpp("br",null),Att,vscpp("br",null))),vscpp(xF,{chunk:e,failure:r,priority:800}),vscpp(EF,{flexGrow:1,priority:700,chunks:n,parser:s,tokenizer:a}))}},ktt=vscpp(vscppf,null,"User:",vscpp("br",null),`\`\`\`file:///project/my.test.ts
test('reverseString test', () => {'{'}
	const value = 'hello';
	const value2 = doReverseString(value);
	assert.deepStrictEquals(value2, 'olleh'); FAILURE_MESSAGE: Expected undefinedolleh to equal olleh
{'}'});
\`\`\`

Implementation of \`doReverseString\` in file:///project/my.test.ts:

\`\`\`file:///project/strings.ts
20: function doReverseString(str: string): number {
21:	return stringUtils.reverseString(str);
22: }
\`\`\`
`,vscpp("br",null),"Response:",vscpp("br",null),vscpp("br",null),"I need more information about:",vscpp("br",null),"- stringUtils.reverseString",vscpp("br",null)),Att=vscpp(vscppf,null,"User:",vscpp("br",null),`\`\`\`file:///project/my.test.ts
test('reverseString test', () => {'{'}
	const value = 'hello';
	const value2 = doReverseString(value);
	assert.deepStrictEquals(value2, 'olleh'); FAILURE_MESSAGE: Expected undefinedolleh to equal olleh
{'}'});
\`\`\`

Implementation of \`doReverseString\`:

\`\`\`file:///project/my.test.ts
20: function doReverseString(str: string): number {
21:	return stringUtils.reverseString(str);
22: }

Implementation of \`stringUtils.reverseString\`:

\`\`\`file:///project/strings.ts
32: function reverseString(str) {
33:	let out = '';
34:	for (let i = str.length; i >= 0; i--) {
35:		out += str[i];
36:	}
37:	return out;
38: }
\`\`\`
`,vscpp("br",null),"Response:",vscpp("br",null),vscpp("br",null),"SOLUTION: file:///project/stringUtils.ts",vscpp("br",null),"RANGE: 32-38",vscpp("br",null),`\`\`\`typescript
function reverseString(str) {
	let out = '';
	for (let i = str.length - 1; i >= 0; i--) {
		out += str[i];
	}
	return out;
}
\`\`\`
`,vscpp("br",null),"`reverseString` had an off-by-one error which started past the end of the string. I fixed your code by making `i` begin at `str.length - 1` instead of `str.length`.",vscpp("br",null)),TRe=vscpp(vscppf,null,'- Write your response in a list in the form "- [keyword] in [file where keyword is used]". Do not include any extra text. Keywords should be EXACT substrings from the code the user provides, do not modify them.',vscpp("br",null));var Ptt=1e3,wRe="SOLUTION:",Dtt=/RANGE:.*?([0-9]+).*?([0-9]+)/i;async function Ntt(t,e,r){let n=t.indexOf(wRe);if(n===-1)return;n!==0&&(t=t.slice(n)+`
`+t.slice(0,n)),t=t.trim();let o=t.split(`
`),s;try{s=lt.parse(o[0].slice(wRe.length).trim())}catch{}let a,c=Dtt.exec(o[1]);c&&(a={start:+c[1],end:+c[2]});let u=Ws(t);if(!u.length)return;let[l]=u,d=o.slice(l.startLine).join(`
`),p;if(s&&a){let f="";for(let _ of e)if(_.file.toString().toLowerCase()===s.toString().toLowerCase()){let b=new RegExp(`^${a.start}: (\\s*)`,"m").exec(_.text);if(b){f=b[1];break}}let m=l.code;l.code.startsWith(f)||(m=l.code.split(`
`).map(_=>f+_).join(`
`));let h=new ze(a.start-1,0,a.end-1,Number.MAX_SAFE_INTEGER),g=(await r(s)).source,v=IRe(m,h,g),y=[new On(v,m)];p={apply:y,undo:SRe(g,y)}}return{text:d,uri:s,code:l.code,explaination:o.slice(l.endLine).join(`
`).trim(),edits:p}}var Ltt=new Set(["rust"]),JJ=class{constructor(e,r){this.testLocation=r;this.fileCache=new Pn;this.globallySeen=new Set;this._promise=new Np;this.turnsUsed=0;this.tokensUsed=0;this.endpoint=e.endpoint,this.progress=e.progress,this.token=e.token,this.accessor=e.accessor,this.turnsBudget=e.turnsBudget,this.timeBudget=e.timeBudget,this.tokenBudget=e.tokenBudget,this.deadline=Date.now()+this.timeBudget;let n=e.accessor.get(ce);this.logger=n.getPromptResponseLogger("FailingTest"),this.genericLogger=n.getLogger("FailingTest"),this.gitRepo=e.accessor.safeGet(ka)?.getExtensionApi()?.getRepository(this.testLocation.uri)||void 0}get promise(){return this._promise.p}get hasFoundSolution(){return this._promise.isResolved}get possibleExplanation(){return this._possibleExplanation}foundSolution(e){this._promise.complete(e)}gotPossibleExplanation(e,r){(!this._possibleExplanation||e.length>this._possibleExplanation.text.length)&&(this._possibleExplanation={text:e,references:r})}takeTurn(){return this.turnsUsed++,Date.now()+Ptt>=this.deadline?0:Math.max(0,this.turnsBudget-this.turnsUsed)}throwIfCancelled(){if(this.token.isCancellationRequested||this.hasFoundSolution)throw new ns}async getSymbols(e){let r=this.accessor.get(De),n=this.accessor.get(ve).acquireTokenizer(this.endpoint.family),o=new Map,s=await this.getDefinitionLocations(e);this.throwIfCancelled();let a=new Set(s.flatMap(({links:u})=>u.map(l=>l.link.uri.fsPath))),c=new Set;if(this.gitRepo)try{c=await this.gitRepo.checkIgnore([...a])}catch{}for(let{keyword:u,links:l}of s)for(let{interest:d,link:p}of l){if(c.has(p.uri.fsPath)||await r.isCopilotIgnored(p.uri)||p.uri.toString()===this.testLocation.uri.toString()&&!Ltt.has(Ym(p.uri).languageId))continue;p.range.isEmpty&&(p.range=new ze(p.range.start,p.range.end.with(p.range.start.line+5)));let f=new qr(p.range.start.line+1,1),m=p.range.isEmpty?new qr(f.lineNumber+10,1):new qr(p.range.end.line+1,p.range.end.character+1),h=[d,p.uri.toString(),p.range.start.line].join("\0");if(this.globallySeen.has(h))continue;let g=o.get(h);if(g){g.keywords.push(u);continue}try{let v=await this.readFile(p.uri);o.set(h,{keywords:[u],interest:d,uri:p.uri,start:f,end:m,tokensWithoutExpansion:n.tokenLength(v.source.slice(v.convert.positionToOffset(f),v.convert.positionToOffset(m))),...v}),this.progress.report(new k_(p))}catch{}}for(let u of o.keys())this.globallySeen.add(u);return[...o.values()]}async readFile(e){let r=this.fileCache.get(e);return r||(r=this.accessor.get(on).readFile(e).then(n=>new TextDecoder().decode(n)).then(n=>({source:n,convert:new Ru(n)})),this.fileCache.set(e,r)),r}async getDefinitionLocations(e){let r=this.accessor.get(Di);return Promise.all(e.map(async({keyword:n,interest:o,location:s})=>{let a=s.position.translate(0,n.length-1),c=s.uri,u=()=>r.getDefinitions(c,a).then(f=>f.length?f:r.getImplementations(c,a)).then(f=>f.length?{interest:"DEFINITION",link:f[0]}:void 0),l=()=>r.getImplementations(c,a).then(f=>f.length?f:r.getDefinitions(c,a)).then(f=>f.length?{interest:"IMPLEMENTATION",link:f[0]}:void 0),d=[];(o==="DEFINITION"||o==="BOTH")&&d.push(u()),(o==="IMPLEMENTATION"||o==="BOTH")&&d.push(l());let p=(await Promise.all(d)).filter(I_);return{keyword:n,links:p.map(f=>"targetUri"in f.link?{interest:f.interest,link:new yi(f.link.targetUri,f.link.targetRange)}:f)}}))}};var kF=class t{constructor(e,r,n){this.context=e;this.testFailure=r;this.testLocation=n}static create(e,r,n){let o=jA(r.task.messages,s=>s.location);return(!o||n.uri.toString()!==o.uri.toString())&&(o=n),new t(new JJ(e,n),r,n)}async tryGetInitialGitContext(){let e=this.context.accessor.get(ve).acquireTokenizer(this.context.endpoint.family),r=this.context.gitRepo;if(!r)return[];let n=[],o=await r.diffWithHEAD();return await Promise.all(o.map(async s=>{if(s.status===2||s.status===6)return;let[a,c]=await Promise.all([r.diffWithHEAD(s.uri.fsPath),this.context.readFile(s.uri)]);n.push(...await xRe(e,c,s.uri,a))})),n}async climb(){let e=await bRe(this.testLocation,this.testFailure.snapshot.label,this.context.accessor.get(on),this.context.accessor.get(_t));if(!e)throw new Error("Could not find semantic information for the test location");let r=[];try{r=await this.tryGetInitialGitContext()}catch(s){this.context.genericLogger.warn("Could not get git context for test failure",s)}let n=await Promise.race([this.context.promise,this.climbInner(this.context,e,{symbols:[],activity:r,name:`"${this.testFailure.snapshot.label}"`,prefixTokens:0,tokens:0}).then(()=>({type:2,possibleSolution:this.context.possibleExplanation}),s=>{if(kp(s))return{type:1,possibleSolution:this.context.possibleExplanation};throw s})]);return this.context.accessor.get(me).sendMSFTTelemetryEvent("intent.fixTestFailure.outcome",{outcome:n.type===0?"solution":n.type===1?"cancelled":"nosolution",languageId:Ym(this.testLocation.uri).languageId},{requestsMade:this.context.turnsUsed,tokenCount:this.context.tokensUsed}),n}async climbInner(e,r,n,o=!1){let{endpoint:s,progress:a,token:c,accessor:u}=this.context,l=u.get(me),d=u.get(jt),p=n.name,f=e.takeTurn();o&&(f=0);let m=u.get(ve).acquireTokenizer(s.family),h=new Xe(s,wF,{testFailure:this.testFailure,chunk:r,tokenizer:m,parser:u.get(_t),references:[...n.activity,...n.symbols],turnsLeft:o?0:f},m,u),g=await h.render();n.prefixTokens=g.tokenCount,n.tokens=n.prefixTokens+g.tokenCount,e.tokensUsed+=n.tokens,e.throwIfCancelled(),a.report(new Wi(RF.t("Investigating the code around {0}",p))),e.logger.logPrompt(g.messages);let v=await d.fetchOne(g.messages,async S=>{},c,2,s,void 0,{temperature:.1,top_p:1,stop:["dontStopBelieving"]},{messageSource:"failingTestMeta"});if(e.throwIfCancelled(),e.logger.logResponse(v),v.type!=="success")throw l.sendMSFTTelemetryEvent("failingTestResolver.error",{type:v.type,reason:v.reason,requestId:v.requestId}),new Error(RF.t("Encountered an error while deciding what test information to collect: ({0}) {1}",v.type,v.reason));let y=[r,...h.getMeta(Q2).chunks],_=await Ntt(v.value,y,S=>this.context.readFile(S));if(_){e.foundSolution({type:0,references:g.references,solution:_});return}let b=yRe(v.value,y);if(f>0){let S=await e.getSymbols(b);await this.chunkAndSendFollowups(e,r,S,n)}b.length||e.gotPossibleExplanation(v.value,g.references)}async chunkAndSendFollowups(e,r,n,o){let s=[],a=e.accessor.get(ve).acquireTokenizer(e.endpoint.family);for(let c of n){let u=s[s.length-1],l=c.tokensWithoutExpansion+a.tokenLength("```${tokenizer.tokenLength(symbol.chunk.file.toString())}");!u||l+u.tokens>e.tokenBudget?s.push({activity:o.activity,symbols:[...o.symbols,c],tokens:o.tokens+l,name:o.name,prefixTokens:o.prefixTokens}):(u.symbols.push(c),u.tokens+=l)}for(let c of s){let u=c.symbols.slice(o.symbols.length).flatMap(l=>l.keywords||[]);c.name=u.length>1?RF.t('"{0}" + {1} more symbols...',u[0],u.length-1):`"${u[0]}"`,await this.climbInner(e,r,c)}if(s.length===0)return this.climbInner(e,r,o,!0)}};var eT=class{constructor(){this.id="fixTestFailure";this.locations=[1,2];this.description=qv.t("Propose a fix for the a test failure");this.commandInfo={defaultEnablement:!0,allowsEmptyArgs:!0}}static{this.ID="fixTestFailure"}get intentDetectionInput(){let e="fix_test_failure";return{functionName:e,sampleQuestion:"This test failed, suggest how to fix it.",functionCallingBlurb:`If the user's message is related to generating code to fix test failures, you should use the '${e}' function.`}}async asSlashCommand(e){let r=e.get(Rc);if(r.isEnabled.get()&&ks.first(r.getAllFailures()))return{name:this.id,description:this.description}}async invoke(e,r){let n=e.get(Rc),o;(v=>(v[v.Any=0]="Any",v[v.SameDocument=1]="SameDocument",v[v.InViewRange=2]="InViewRange",v[v.InSelection=3]="InSelection"))(o||={});let s,a=0,c=r.documentContext?.document.uri.toString();for(let f of n.getAllFailures())if(!s||!s.snapshot.uri||!s.snapshot.range)s=f;else if(f.snapshot.range&&f.snapshot.uri?.toString()===c&&(a<1&&(s=f,a=1),f.snapshot.range.intersection(r.documentContext.wholeRange)&&(s=f,a=2),f.snapshot.range.intersection(r.documentContext.selection))){s=f,a=3;break}if(!s)throw new d2(qv.t("No test failures found."));let{range:u,uri:l}=s.snapshot;if(!l||!u)throw new d2(qv.t("Tests have no associated editor location."));let d=r.location,p=await e.get(Le).getChatEndpoint("gpt-4");return new ZJ(e,this,p,d,s,{uri:l,range:u})}},ZJ=class{constructor(e,r,n,o,s,a){this.accessor=e;this.intent=r;this.endpoint=n;this.location=o;this.testFailure=s;this.testLocation=a;this.createReplyInterpreter=()=>{let{outcome:e,test:r}=this.lastSolutionForInterpreter;return new tZ(r,e)}}async buildPrompt(e,r,n,o,s){let c=e.getLatestTurn().request.message,u=new Xe(this.endpoint,eZ,{testFailure:this.testFailure,chatVariables:r,query:c,endpoint:this.endpoint,progress:n,chatLocation:this.location,location:this.testLocation,history:e.turns},this.accessor.get(ve).acquireTokenizer(this.endpoint.family),this.accessor),l=await u.render(n,s),d=u.getMeta(AF)?.value;d&&(this.lastSolutionForInterpreter={outcome:d,test:this.testFailure.snapshot});let p=u.getMeta(PF)?.value;return{...l,references:p||l.references}}},eZ=class extends Y{async prepare(e,r,n=Fr.None){let{progress:o}=this.props,a=await kF.create({accessor:this.accessor,endpoint:this.props.endpoint,progress:o,token:n,tokenBudget:e.tokenBudget,timeBudget:1/0,turnsBudget:6},this.props.testFailure,this.props.location).climb();if(this.props.chatLocation===1)return{outcome:a};if(a.type===0)if(a.solution.edits){o.report(new Pi(new Mv(a.solution.explaination))),o.report(new Mp(a.solution.uri,a.solution.edits.apply));let c=new zm;c.set(a.solution.uri,a.solution.edits.apply);let u=new zm;u.set(a.solution.uri,a.solution.edits.undo),o.report(new h0(ARe(this.props.testFailure.snapshot,c,u)))}else o.report(new Pi(new Mv(a.solution.text)));else a.possibleSolution?o.report(new Pi(new Mv(a.possibleSolution.text))):a.type===1?(o.report(new Pi(RRe())),o.report(new h0({command:"workbench.action.openSettings",title:qv.t("Go to Settings"),arguments:[{query:"github.copilot.config.testFixLimits"}]}))):o.report(new Pi(kRe()));return{outcome:a}}render(e,r){return vscpp(vscppf,null,vscpp("meta",{value:new AF(e.outcome)}),vscpp("meta",{value:new PF(e.outcome.type===0?e.outcome.references:e.outcome.possibleSolution?.references||[])}))}},RRe=()=>qv.t("Unfortunately I was unable to find a solution to this test failure in the time alloted. My time limit can be configured in your settings."),kRe=()=>qv.t("Unfortunately I was unable to find a solution to this test failure. Please try providing more context."),AF=class extends rc{constructor(r){super();this.value=r}},PF=class extends rc{constructor(r){super();this.value=r}},tZ=class{constructor(e,r){this.test=e;this.solution=r}async processResponse(e,r,n){let o=this.solution||{type:1};if(o.type!==0){if(o.possibleSolution)return r.markdown(o.possibleSolution.text),{type:"conversational"};if(o.type===1)return r.markdown(RRe()),{type:"conversational"};if(o.type===2)return r.markdown(kRe()),{type:"conversational"}}let s=o.solution;if(!s.uri||!s.edits)return r.markdown(s.text),{type:"conversational"};let a=new zm;a.set(s.uri,s.edits.apply);let c=new zm;return c.set(s.uri,s.edits.undo),r.markdown(s.explaination),r.button(ARe(this.test,a,c)),{type:"workspaceEdit",workspaceEdit:a}}};function ARe(t,e,r){return{title:qv.t("Apply and Rerun"),command:"github.copilot.tests.fixTestFailure.applyAndRerun",arguments:[t,e,r]}}var tT=class{constructor(e){this._intentService=e;this.id="fix";this.locations=[1,2];this.description=PRe.t("Propose a fix for the problems in the selected code");this.commandInfo=void 0}static{this.ID="fix"}get intentDetectionInput(){let e="fix_code_or_markdown";return{functionName:e,sampleQuestion:"There is a problem in this code. Rewrite the code to show it with the bug fixed.",functionCallingBlurb:`If the user's message appears related to fixing problems in the selected code, you should use the '${e}' function.`}}async invoke(e,r){if(this.shouldDelegateToTestFixer(e,r))return this._intentService.getIntent(eT.ID,r.location).invoke(e,r);let{location:n,documentContext:o,request:s}=r;if(!o)throw new Error("Open a file to fix an issue");let a=e.get(be),c=e.get(Lt),u=e.get(Le),l=await SU(n);if(n===2){let v=await u.getChatEndpoint(l);return new oC(e,this,n,v,bF,r.documentContext)}let d=s.attempt,p=await a.getExperimentBasedConfig(ge.FixInlineChatEndpoint,c);p||(p=l,d>0&&p==="gpt-3.5-turbo"&&(p="gpt-4"));let f=await u.getChatEndpoint(p),m;$t(o.document.uri)&&o.document.languageId==="python"?m=vF:m=gF;let h=d>1,g={useWorkspaceChunksFromSelection:h||await a.getExperimentBasedConfig(ge.FixUseWorkspaceChunksFromSelection,c),useWorkspaceChunksFromDiagnostics:!h&&await a.getExperimentBasedConfig(ge.FixUseWorkspaceChunksFromDiagnostics,c)};return new mF(e,this,n,f,m,o,g)}shouldDelegateToTestFixer(e,r){let n=e.safeGet(Rc);return!n?.isEnabled||r.documentContext?.selection.isEmpty===!1?!1:!!(r.location===1&&r.documentContext&&n.getFailureAtPosition(r.documentContext.document.uri,r.documentContext.selection.end)||n.lastResultsFrom&&Date.now()-n.lastResultsFrom<1e4&&!ks.isEmpty(n.getAllFailures()))}};tT=B([T(0,nc)],tT);var DF=W(Tr());var NF=class{constructor(){this.id="newNotebook";this.description=DF.t("Create a new Jupyter Notebook");this.locations=[2];this.commandInfo={allowsEmptyArgs:!1,yieldsTo:[{command:"fix"},{command:"explain"},{command:"workspace"},{command:"tests"}],defaultEnablement:!0,sampleRequest:DF.t("How do I create a notebook to load data from a csv file?")}}static{this.ID="newNotebook"}get intentDetectionInput(){let e="create_new_jupyter_notebook";return{functionName:e,modelDescription:"Creates a new Jupyter Notebook for tasks such as data analysis, scientific computing, and machine learning.",sampleQuestion:"How do I create a notebook to load data from a csv file?",functionCallingBlurb:`If the user's message is related to creating a new Jupyter notebook for data analysis, scientific computing, and machine learning, you should use the '${e}' function.`}}async invoke(e,r){let n=r.location,o=e.get(Le),s=await Mn(o,n);return new rZ(e,this,s,n)}},rZ=class{constructor(e,r,n,o){this.accessor=e;this.intent=r;this.endpoint=n;this.location=o;this.responseProcessor=new DM;this.linkification={disable:!0}}async buildPrompt(e,r,n,o,s){let c=e.getLatestTurn().request.message,u=e.turns.length>1?e.turns.slice(0,-1):[];return await new Xe(this.endpoint,kM,{query:c,history:u,chatVariables:r},this.accessor.get(ve).acquireTokenizer(this.endpoint.family),this.accessor).render(n,s)}async commands(e){let r=(e.response?.message??"").replace(/\n/g,""),o=/```(?:json)?(.+)/g.exec(r);if(o)try{let s=o[1],a=s.indexOf("```"),c=a===-1?s:s.substring(0,a),u=JSON.parse(c);return Promise.resolve([{command:"github.copilot.newNotebook",arguments:[{turn:e,outline:u}],title:DF.t("Create Notebook")}])}catch{}return[]}};var X2=W(Tr()),J2=W(require("path"));var DRe="Review the currently selected code.",Ott=X2.t("local changes"),LF=class extends Yo{constructor(r,n,o,s,a){super(n,o,s);this.accessor=r;this.documentContext=a;this.linkification={additionaLinkifiers:[{create:()=>new iZ(this.documentContext.document.uri)}]}}async createRenderer(r,n,o,s,a,c){let l=r.getLatestTurn().request.message,d=r.turns.length>1?r.turns.slice(0,-1):[],p=[];if(l===Ott){let f=this.accessor.get(Ze),m=await Kr.getCurrentChanges(this.accessor,"workingTree");(await Promise.all(m.map(async g=>({document:await f.openTextDocument(g.uri),relativeDocumentPath:J2.default.relative(g.repository.rootUri.fsPath,g.uri.fsPath),change:g})))).map(g=>p.push(g))}else{let f=this.accessor.get(Tt).activeTextEditor;f&&p.push({document:f.document,relativeDocumentPath:J2.default.basename(f.document.uri.fsPath),selection:f.selection})}return new Xe(n,AC,{query:l,history:d,chatVariables:o,input:p,logService:this.accessor.get(ce)},this.accessor.get(ve).acquireTokenizer(n.family),this.accessor)}},nZ=class extends LF{async buildPrompt(e,r,n,o,s){let a=e.getLatestTurn();return a?.request.message===""&&(a.request={message:DRe,type:"user"}),super.buildPrompt(e,r,n,o,s)}createReplyInterpreter(){return new oZ(this.accessor,this.documentContext)}},OF=class{constructor(){this.id="review";this.locations=[2,1];this.description=X2.t("Review the selected code in your active editor");this.intentDetectionInput={sampleQuestion:DRe}}static{this.ID="review"}async invoke(e,r){let n=r.documentContext,o=r.location,s=await e.get(Le).getChatEndpoint("gpt-4");return o===1?new nZ(e,this,o,s,n):new LF(e,this,o,s,n)}},iZ=class{constructor(e){this.file=e}async linkify(e,r,n){let o=lJ(e);if(!o.length)return;let s=0,a=[];for(let c of o)a.push(e.substring(s,c.linkOffset)),a.push($8(e.substring(c.linkOffset,c.linkOffset+c.linkLength),this.file.with({fragment:String(c.from+1)}))),s=c.linkOffset+c.linkLength;return a.push(e.substring(s)),{text:a.join(""),trustedCommands:[Iv]}}},oZ=class{constructor(e,r){this.accessor=e;this.documentContext=r;this.updating=!1;this.text="";this.comments=[];this.reviewService=this.accessor.get(os)}async processResponse(e,r,n){let o={messageId:Br(),inputType:"selection",inputRanges:[{uri:this.documentContext.document.uri,ranges:[this.documentContext.selection]}]};for await(let a of e){if(this.text=a.text,!this.updating){this.updating=!0;let u=new Bc(X2.t({message:`Reviewing your code...
`,comment:"{Locked='](command:workbench.panel.markers.view.focus)'}"}));u.isTrusted={enabledCommands:["workbench.panel.markers.view.focus"]},r.markdown(u)}let c=F2(o,[{document:this.documentContext.document,relativeDocumentPath:J2.default.basename(this.documentContext.document.uri.fsPath),selection:this.documentContext.selection}],this.text,!0);c.length>this.comments.length&&(this.reviewService.addReviewComments(c.slice(this.comments.length)),this.comments=c)}let s=F2(o,[{document:this.documentContext.document,relativeDocumentPath:J2.default.basename(this.documentContext.document.uri.fsPath),selection:this.documentContext.selection}],this.text,!1);return s.length>this.comments.length&&(this.reviewService.addReviewComments(s.slice(this.comments.length)),this.comments=s),r.markdown(X2.t("Reviewed your code and generated {0} suggestions.",s.length)),{type:"conversational"}}};var aZ=W(Tr());var FF=W(ct());var MF=class extends Y{render(e,r){return vscpp(vscppf,null,vscpp(FF.SystemMessage,{priority:1e3},"You are a VS Code search expert who helps to write search queries for text in a workspace. Users want to search across a whole workspace. Your response will contain parameters to use in the search that targets what the user wants.",vscpp("br",null),vscpp($r,null),vscpp(fi,null),vscpp(po,null),vscpp(lr,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"The user's question is ALWAYS related to search or replace. When the user's question does not seem to be related to searching or replacing, you MUST assume that they're searching for or replacing what they are describing.",vscpp("br",null),`For example, if the user says "emojis", try appending "I'm looking for _____" to the beginning (e.g. I'm looking for emojis) to make more sense of it.`,vscpp("br",null),vscpp("br",null),"For all valid questions, you MUST respond with a JSON object with search parameters to use.",vscpp("br",null),'- Your answer MUST wrap the JSON object in "[ARGS START]" and "[ARGS END]". "[ARGS START]" must be on a new line.',vscpp("br",null),'- Your answer MUST have an explanation in full, human-readable sentences. This goes before the "[ARGS START]" line.',vscpp("br",null),vscpp("br",null),'If you put a regex in the "query" parameter, make sure to set "isRegex" to true.',vscpp("br",null),'If you put a regex in the "query" parameter, do not start and/or end with forward slashes to denote a regex literal.',vscpp("br",null),"You MUST NOT give an answer with an empty-string query parameter.",vscpp("br",null),vscpp("br",null),'The "replace" string will be used to replace the query-matched search results.',vscpp("br",null),vscpp("br",null),'If you want to target certain files, set "filesToInclude" to a glob pattern. DO NOT assume the "filesToInclude" and "filesToExclude" without being very sure that the user wants to target these files!',vscpp("br",null),vscpp("br",null),'If the query is case sensitive, set "isCaseSensitive" to true.',vscpp("br",null),vscpp("br",null),"By default, all string fields are the empty string, and all boolean fields are false. Only list the fields you want to change.",vscpp("br",null),vscpp("br",null),"You should write the JSON object of the search parameters in the following format:",vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": ...,',vscpp("br",null),'	"replace": ...,',vscpp("br",null),'	"filesToInclude": ...,',vscpp("br",null),'	"filesToExclude": ...,',vscpp("br",null),'	"isRegex": ...,',vscpp("br",null),'	"isCaseSensitive": ...,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"Examples:",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"Search for 'foo' in all files under my 'src' directory.",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"Populate the query field with 'foo' and specify the files to include as 'src/'.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "foo",',vscpp("br",null),'	"filesToInclude": "src" ,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"Find all CamelCase words in all files under the 'src/extensions' directory.",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"Perform a regex search for camelCase variables by checking for any word that has a lowercase letter followed by an uppercase letter, followed by any number of lowercase letters. You can use `\\b[a-z]+[A-Z][a-z]+\\b` to acheive this.",vscpp("br",null),"This must be case-sensitive since the capitalization of the letters in our regex matters.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "\\\\b[a-z]+[A-Z][a-z]+\\\\b",',vscpp("br",null),'	"filesToInclude": "src/extensions" ,',vscpp("br",null),'	"isRegex": true,',vscpp("br",null),'	"isCaseSensitive": true,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"Find all hex color codes in css files",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"Perform a search for 6-digit or 3-digit hex color codes using the regex `#([a-fA-F0-9]{6}|[a-fA-F0-9]{3})\\b`.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "#([a-fA-F0-9]{6}|[a-fA-F0-9]{3})\\\\b",',vscpp("br",null),'	"filesToInclude": "*.css" ,',vscpp("br",null),'	"isRegex": true,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"Find all HTTPS links in markdown.",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"Search all URLs that have the HTTPS protocol in a markdown file. Make sure to include all valid URL characters in their respective places. This regex should achieve this: `https?:\\/\\/(www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,6}\\b([-a-zA-Z0-9@:%_\\+.~#()?&//=]*)`.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "https?:\\\\/\\\\/(www\\\\.)?[-a-zA-Z0-9@:%._\\\\+~#=]{2,256}\\\\.[a-z]{2,6}\\\\b([-a-zA-Z0-9@:%_\\\\+.~#()?&//=]*)",',vscpp("br",null),'	"filesToInclude": "*.md" ,',vscpp("br",null),'	"isRegex": true,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"Replace all YYYY-MM-DD dates with MM/DD/YYYY dates. Don't do this in typescript files.",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"You will need to use the regex `(\\d{4})-(\\d{2})-(\\d{2})` to match the YYYY-MM-DD date format. Then, you will need to use the replace string `$2/$3/$1` to replace the date with the MM/DD/YYYY format.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "(\\\\d{4})-(\\\\d{2})-(\\\\d{2})",',vscpp("br",null),'	"replace: "$2/$3/$1",',vscpp("br",null),'	"filesToExclude": "*.ts",',vscpp("br",null),'	"isRegex": true,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"Replace all camel case variable names with snake case variable names.",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"To replace all camel case variables with snake case, we will need to:",vscpp("br",null),"1. Find all sequences of lowercase letters succeeded by uppercase letters. Use `([a-z]+)([A-Z])` to capture these sequences.",vscpp("br",null),"2. Separate them with an underscore character. `$1_$2` does this.",vscpp("br",null),"3. Convert both characters to lowercase. Adjust the previous replace text to be `\\l$1_\\l$2`.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "([a-z]+)([A-Z])",',vscpp("br",null),'	"replace: "\\\\l$1_\\\\l$2",',vscpp("br",null),'	"isRegex": true,',vscpp("br",null),'	"isCaseSensitive": true,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"alphanumeric",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"To find all alphanumeric characters, you can use the regex `[a-zA-Z0-9]`.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "[a-zA-Z0-9]",',vscpp("br",null),'	"isRegex": true,',vscpp("br",null),'	"isCaseSensitive": true,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"link",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"To find all web links, use the regex `https?:\\/\\/\\S+`.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "https?:\\\\/\\\\/\\\\S+",',vscpp("br",null),'	"isRegex": true,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),'Search for actionbar files outside of my "extensions" directoy',vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"To do this, use the query `actionbar` in all files except the ones in `extensions`.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "actionbar",',vscpp("br",null),'	"filesToExclude": "extensions",',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"typescript for loop",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),'To look for "for" loops in most languages, use the query `for\\s*\\(`.',vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "for\\s*\\(",',vscpp("br",null),'	"isRegex: true,',vscpp("br",null),'	"filesToInclude: "*.ts"',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null)),this.props.history&&vscpp(vscppf,null,vscpp(qt,{priority:600,history:this.props.history})),vscpp(Qo,{priority:700}),vscpp(Wr,{priority:800,document:this.props.document,range:this.props.selection}),vscpp(FF.UserMessage,{priority:900},this.props.query))}};function Mtt(t){if(!t)return[];let e=[],r={query:t.query??"",replace:t.replace??"",filesToInclude:t.filesToInclude??"",filesToExclude:t.filesToExclude??"",isRegex:t.isRegex??!1,isCaseSensitive:t.isRegex??!1};return e.push({command:"github.copilot.executeSearch",arguments:[r],title:aZ.t("Search")}),e}function NRe(t){let e=Ws(t).at(0),r;if(e){let n;try{n=LC(e.code)}catch{}n&&(r=n)}return r}function Ftt(t){if(!t)return[];let e=[`| Parameter  | Value |
`,`| ------ | ----- |
`];for(let[r,n]of Object.entries(t)){if(n==="")continue;let o=n;(typeof n=="string"||n instanceof String)&&(o=n.replace(/\|/g,"\\|")),e.push(`| ${r} | \`${o}\` |
`)}return e.push(`
`),e}var Utt="Search for 'foo' in all files under my 'src' directory",sZ=class extends Yo{constructor(r,n,o,s){super(n,o,s);this.accessor=r;this.responseProcessor=new gC([{start:"[ARGS END]",stop:"[ARGS START]"}],a=>Ftt(NRe(a.join(""))))}createRenderer(r,n,o,s,a,c){let l=r.getLatestTurn().request.message,d=r.turns.length>1?r.turns.slice(0,-1):[];return new Xe(n,MF,{query:l,history:d},this.accessor.get(ve).acquireTokenizer(n.family),this.accessor)}async commands(r){let n=NRe(r.response?.message??"");return Mtt(n)}},UF=class{constructor(){this.id="search";this.locations=[2];this.description=aZ.t("Generate query parameters for workspace search");this.commandInfo={allowsEmptyArgs:!1,defaultEnablement:lc}}static{this.ID="search"}get intentDetectionInput(){let e="vscode_search";return{functionName:e,sampleQuestion:Utt,functionCallingBlurb:`If the user's message is related to generating search query parameters for running a file search, you should use the '${e}' function.`}}async invoke(e,r){let n=r.location,o=e.get(Le),s=await Mn(o,n);return new sZ(e,this,n,s)}};var Z2=W(Tr());var cZ=class extends Yo{constructor(r,n,o,s){super(n,o,s);this.accessor=r;this.responseProcessor=new uZ(this.accessor,this.endpoint)}async createRenderer(r,n,o,s,a,c){let l=r.getLatestTurn().request.message,d=r.turns.length>1?r.turns.slice(0,-1):[],p=await O2(this.accessor,1e3,c);return new Xe(n,jC,{query:l,history:d,fileTree:p},this.accessor.get(ve).acquireTokenizer(n.family),this.accessor)}},BF=class t{constructor(){this.id=t.ID;this.locations=[2];this.description=Z2.t("Find relevant code to your query");this.commandInfo={allowsEmptyArgs:!1,defaultEnablement:!1};this.intentDetectionInput={sampleQuestion:"Where is the toolbar code?"}}static{this.ID="semanticSearch"}async invoke(e,r){let n=r.location,o=e.get(Le),s=await Mn(o,n);return new cZ(e,this,n,s)}},uZ=class{constructor(e,r){this.accessor=e;this.endpoint=r}async processResponse(e,r,n,o,s){let a=r[r.length-1].content,c=0,u="";for await(let{delta:d}of n)c+=d.text.length,u+=d.text;o.progress(Z2.t("Looking for relevant code"));let l=TC(a,u);return Btt(this.accessor,this.endpoint,a,l,s).then(d=>qtt(this.accessor,d,o))}};async function Btt(t,e,r,n,o){let s=t.get(iv),a=await y0(t,{valueFor4096:8,maxMultiplier:4});return bJ(s,e,r,n,a,o,!0)}function qtt(t,e,r){if(e.length===0){let s=Z2.t(`No relevant code found. Please be more specific.
`);return r.markdown(s),s}r.markdown(Z2.t(`Here is some relevant code:

`));let n=t.get(Ze),o="";for(let s of e)o+=Htt(s,r,n);return o}function Htt(t,e,r){let n=[],s=`## ${Kg(r,t.file)}

`;return e.markdown(s),n.push(s),t.locations.forEach(a=>{let c={uri:t.file,range:Zm(a.range)},u=a.range.startLineNumber,l=a.range.endLineNumber,d=u+1===l?`Line ${u+1}`:`Lines ${u+1}-${l}`;e.markdown("- "),e.anchor(c,d),e.markdown(`

`),n.push(d+`

`),e.markdown(a.code+`
`),n.push(a.code+`
`)}),n.join("")}var ORe=W(Tr());var rT=W(ct());var qF=class extends Y{render(e){return vscpp(vscppf,null,vscpp(rT.SystemMessage,{priority:1e3},"You are a programmer who specializes in using the command line. Your task is to help the Developer craft a command to run on the command line.",vscpp("br",null),vscpp($r,null),vscpp(ir,null),vscpp(po,null),vscpp(lr,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"Think step by step:",`
1. Read the provided relevant workspace information (file names, project files in the project root) to understand the user's workspace.`,`
2. Generate a response that clearly and accurately answers the user's question. In your response, follow the following:
    - Prefer single line commands.
    - Omit an explanation unless the suggestion is complex, if an explanation is included then be concise.
    - Provide the command suggestions using the active shell and operating system.
    - When there is text that needs to be replaced in the suggestion, prefix the text with '{', suffix the text with '}' and use underscores instead of whitespace. Only do this when the replacement text is NOT provided.
    - Say "I'm not quite sure how to do that." when you aren't confident in your explanation`,LRe(this.props.shellType)?"\n    - Prefer idiomatic PowerShell over aliases for other shells or system utilities. For example use `Stop-Process` or `Get-NetTCPConnection` instead of `kill` or `lsof` respectively.\n	- Only use unix utilities when there is no PowerShell equivalent.\n    - Prefer cross-platform PowerShell scripting that works on any operating system.":`
    - Only use a tool like python or perl when it is not possible with the shell.`,`
3. At the end of the response, list all text that needs to be replaced with associated descriptions in the form of a markdown list
`.trim(),vscpp("br",null)),vscpp(rT.SystemMessage,{priority:700},"Examples:",vscpp("br",null),jtt(this.props.shellType)),this.props.history&&vscpp(vscppf,null,vscpp(qt,{priority:600,history:this.props.history})),vscpp(rT.UserMessage,{priority:800},"The active terminal's shell type is:",vscpp("br",null),this.props.shellType),vscpp(rT.UserMessage,{priority:800},"The active operating system is:",vscpp("br",null),this.props.osName),vscpp(ti,{priority:900,chatVariables:this.props.chatVariables,query:this.props.query}))}};function jtt(t){let e=['User: How do I revert a specific commit?\nAssistant:\n```sh\ngit revert {commit_id}\n```\n\nUser: How do I commit in git?\nAssistant:\n```sh\ngit commit -m "{message}"\n```'];switch(LRe(t)||e.push("User: go to the foo dir\nAssistant:\n```sh\ncd foo\n```"),t){case"ps1":case"pwsh":case"powershell":{e.push("User: go to the foo dir\nAssistant:\n```pwsh\ncd .\\foo\\\n```\n\nUser: How do I delete a directory?\nAssistant:\n```pwsh\nRemove-Item {dir_name}\n```\n\nUser: create a file called foo\nAssistant:\n```pwsh\nNew-Item -ItemType File -Name foo\n```");break}case"bash":{e.push("User: Print all files starting with \"pre\"\n```bash\nfind . -type f -name 'pre*'\n```");break}default:{e.push("\nUser: How do I print all files recursively within a directory?\nAssistant:\n```sh\nls -lR\n```");break}}return e.join(`

`)}function LRe(t){return t==="ps1"||t==="pwsh"||t==="powershell"}var HF=class t{constructor(){this.locations=[2];this.id=t.ID;this.description=ORe.t("Ask how to do something in the terminal");this.commandInfo=void 0}static{this.ID="terminal"}get intentDetectionInput(){let e="terminal_questions";return{functionName:e,sampleQuestion:"How do I list files in the terminal",functionCallingBlurb:`If the user's message is about how to do something in the terminal, you should use the '${e}' function.`}}async invoke(e,r){let n=r.location,o=e.get(Le),s=await Mn(o,n);return new lZ(e,this,s,n)}},lZ=class{constructor(e,r,n,o){this.accessor=e;this.intent=r;this.endpoint=n;this.location=o}async buildPrompt(e,r,n,o,s){let a=this.accessor.get(Pt).OS,c=this.accessor.get(lo).terminalShellType,l=e.getLatestTurn().request.message,d=e.turns.length>1?e.turns.slice(0,-1):[];return await new Xe(this.endpoint,qF,{query:l,chatVariables:r,history:d,osName:a,shellType:c},this.accessor.get(ve).acquireTokenizer(this.endpoint.family),this.accessor).render(n,s)}async followUps(e){let r="Explain the suggested command",n=!1,o=e.response?.message;if(o){let a=Ws(o);if(a.length===0)return[];a.length===1?r=`Explain this command:

${s(a[0])}`:(n=!0,r=`Explain these commands:${a.map(c=>`

${s(c)}`).join("")}`)}return[{prompt:r,label:n?"Explain the suggested commands":"Explain the suggested command"}];function s(a){return`${a.startMarkup}${a.language}
${a.code.trim()}
${a.startMarkup}`}}};var HRe=W(Tr());var nT={location:"sameFolder",prefix:"test_",suffixes:[".test",".spec","_test","Test","_spec","_test","Tests",".Tests","Spec"]},iT={csharp:{suffixes:["Test"],location:"testFolder"},dart:{suffixes:["_test"],location:"testFolder"},go:{suffixes:["_test"],location:"sameFolder"},java:{suffixes:["Test"],location:"testFolder"},javascript:{suffixes:[".test",".spec"],location:"sameFolder"},javascriptreact:{suffixes:[".test",".spec"],location:"sameFolder"},kotlin:{suffixes:["Test"],location:"testFolder"},php:{suffixes:["Test"],location:"testFolder"},powershell:{suffixes:[".Tests"],location:"testFolder"},python:{prefix:"test_",location:"testFolder"},ruby:{suffixes:["_test","_spec"],location:"testFolder"},rust:{suffixes:[""],location:"testFolder"},swift:{suffixes:["Tests"],location:"testFolder"},typescript:{suffixes:[".test",".spec"],location:"sameFolder"},typescriptreact:{suffixes:[".test",".spec"],location:"sameFolder"}},ztt={cs:"csharp",dart:"dart",go:"go",java:"java",js:"javascriptreact",kt:"kotlin",php:"php",ps1:"powershell",py:"python",rb:"ruby",rs:"rust",swift:"swift",ts:"typescript",tsx:"typescriptreact"},Gtt=function(){let t={};for(let[e,r]of Object.entries(ztt))t[e]=iT[r];return t}(),oT=class{constructor(e,r){this._search=e;this._tabs=r}_findTabMatchingPattern(e){return this._tabs.tabs.find(n=>n.uri&&n.uri.scheme!==nn.untitled&&$6(n.uri,e))?.uri}async findTestFileForSourceFile(e,r){if(e.isUntitled)return;let n=Uc(e.uri),o=uc(e.uri),s=iT[e.languageId]??nT,a=[];if(s.prefix&&a.push(s.prefix+n),s.suffixes)for(let l of s.suffixes??[]){let d=n.replace(`${o}`,`${l}${o}`);a.push(d)}let c=a.length===1?`**/${a[0]}`:`**/{${a.join(",")}}`,u=this._findTabMatchingPattern(c);return u||(u=await this._search.findFilesWithDefaultExcludes(c,1,r)),u}async findAnyTestFileForSourceFile(e,r){let n=iT[e.languageId]??nT,o=[];if(n.prefix&&o.push(`${n.prefix}*`),n.suffixes){let c=uc(e.uri);for(let u of n.suffixes??[])o.push(`*${u}${c}`)}let s=o.length===1?`**/${o[0]}`:`**/{${o.join(",")}}`,a=this._findTabMatchingPattern(s);return a||(a=await this._search.findFilesWithDefaultExcludes(s,1,r)),a}async findFileForTestFile(e,r){let n=iT[e.languageId]??nT,o=Uc(e.uri),s=[];n.suffixes&&s.splice(0,0,...n.suffixes),n.prefix&&s.splice(0,0,n.prefix);for(let a of s){let c=o.replace(a,"");if(c!==o){let u=`**/${c}`,l=this._findTabMatchingPattern(u);if(l||(l=await this._search.findFilesWithDefaultExcludes(u,1,r)),l)return l}}}};function sT(t){let e;lt.isUri(t)||(e=iT[t.languageId],t=t.uri);let r=Uc(t),n=uc(t);return e??=Gtt[n.replace(".","")],e?!(e.suffixes&&!e.suffixes.some(s=>r.endsWith(s+n))||e.prefix&&!r.startsWith(e.prefix)):!!(nT.suffixes.some(s=>r.endsWith(s+n))||r.startsWith(nT.prefix))}function MRe(t){let e=iT[t.languageId]??nT,r=Uc(t.uri);if(e.prefix)return e.prefix+r;let n=uc(t.uri),o=e.suffixes&&e.suffixes.length>0?e.suffixes[0]:".test";return r.replace(`${n}`,`${o}${n}`)}var rA=W(ct());var dZ=W(ct()),FRe=W(require("assert"));var eA=class extends rc{constructor(r){super();this.uri=r}},aT=class extends Y{constructor(r,n,o,s,a,c,u){super(r,n);this.searchService=o;this.tabsAndEditorsService=s;this.parserService=a;this.ignoreService=c;this.workspaceService=u}async prepare(r,n,o){let{documentContext:s}=this.props,a=this.ignoreService;if(sT(s.document)||await a.isCopilotIgnored(s.document.uri))return;let c=new oT(this.searchService,this.tabsAndEditorsService),u,l=await c.findTestFileForSourceFile(s.document,o??Fr.None);if(l!==void 0)u="candidateTestFile";else{let f=await c.findAnyTestFileForSourceFile(s.document,o??Fr.None);u="anyTestFile",l=f}if(l===void 0||await a.isCopilotIgnored(l))return;let d;try{d=await this.workspaceService.openTextDocument(l)}catch{return}let p=await M8(this.parserService,d,void 0,new ze(0,0,0,0),r.tokenBudget);if(u==="anyTestFile")return{kind:u,doc:l,codeExcerpt:p,promptReferences:[new Eo.PromptReference(l)]};if(u==="candidateTestFile")return{kind:u,doc:l,codeExcerpt:p,promptReferences:[new Eo.PromptReference(l)],candidateTestFile:l};(0,FRe.default)(!1,"impossible: unexpected kind")}render(r,n){if(r!==void 0)switch(r.kind){case"candidateTestFile":return vscpp(dZ.UserMessage,null,vscpp("meta",{value:new eA(r.candidateTestFile)}),vscpp("references",{value:r.promptReferences}),"Excerpt of the existing test file:",vscpp("br",null),vscpp(Oe,{uri:r.doc,code:r.codeExcerpt.text,languageId:r.codeExcerpt.languageId}),vscpp("br",null),"Because a test file exists: ",vscpp("br",null),"- Do not generate preambles, like imports, copyright headers etc.",vscpp("br",null),"- Do generate code that can be appended to the existing test file.");case"anyTestFile":return vscpp(dZ.UserMessage,null,"This is a sample test file:",vscpp("br",null),vscpp(Oe,{uri:r.doc,code:r.codeExcerpt.text,languageId:r.codeExcerpt.languageId}))}}};aT=B([T(2,Aa),T(3,Tt),T(4,_t),T(5,De),T(6,Ze)],aT);var URe=require("util");var jF=se("ITestDepsResolver"),cT=class{constructor(e,r){this._searchService=e;this._fileSystemService=r;this._perLanguageTestDepsFinder=new Map;this._cachedResults=new Map,this._textDecoder=new URe.TextDecoder}async getTestDeps(e){let r=this._cachedResults.get(e);if(r!==void 0)return r;let n=this.getTestDepsFinder(e);if(n===void 0)return[];let o=await n.findTestDeps();return this._cachedResults.set(e,o),o}getTestDepsFinder(e){let r=this._perLanguageTestDepsFinder.get(e);if(r===void 0)switch(e){case"javascript":case"javascriptreact":case"typescript":case"typescriptreact":{r=new pZ(this._searchService,this._fileSystemService,this._textDecoder);break}case"python":{r=new fZ(this._searchService,this._fileSystemService,this._textDecoder);break}case"java":{r=new mZ(this._searchService,this._fileSystemService,this._textDecoder);break}}return r!==void 0&&this._perLanguageTestDepsFinder.set(e,r),r}};cT=B([T(0,Aa),T(1,on)],cT);var pZ=class{constructor(e,r,n){this._searchService=e;this._fileSystemService=r;this._textDecoder=n;this._jsTsTestDeps=new Set(["mocha","jest","chai","ava","jasmine","qunit","tape","cypress","puppeteer","enzyme","testing-library","sinon","supertest","happy-dom"])}async findTestDeps(){let e=await this._searchService.findFiles("**/package.json",{exclude:"**/node_modules/**",useDefaultExcludes:!0});return(await Promise.allSettled(e.map(async n=>{let o=await this._fileSystemService.readFile(n),s=JSON.parse(this._textDecoder.decode(o)),a=s.dependencies||{},c=s.devDependencies||{};return[a,c].flatMap(l=>Object.keys(l).filter(d=>this._jsTsTestDeps.has(d)))}))).flatMap(n=>n.status==="fulfilled"?n.value:[])}},fZ=class{constructor(e,r,n){this._searchService=e;this._fileSystemService=r;this._textDecoder=n;this._pyTestDeps=["pytest","nose","unittest","tox","doctest","hypothesis","mock","coverage","behave","robotframework"]}async findTestDeps(){let e=new Set,r=["pyproject.toml","setup.py","requirements.txt","tox.ini"],n=await this._searchService.findFiles(`**/{${r.join(",")}}`);return await Promise.all(n.map(async o=>{let s=await this._fileSystemService.readFile(o),a=this._textDecoder.decode(s);o.path.endsWith("pyproject.toml")?this._getPyProjectTomlDeps(a).forEach(u=>e.add(u)):o.path.endsWith("setup.py")?this._getSetupPyDeps(a).forEach(u=>e.add(u)):o.path.endsWith("requirements.txt")?this._getRequirementsTxtDeps(a).forEach(u=>e.add(u)):o.path.endsWith("tox.ini")&&e.add("tox")})),Array.from(e)}_getPyProjectTomlDeps(e){return this._pyTestDeps.filter(r=>e.includes(r))}_getSetupPyDeps(e){return this._pyTestDeps.filter(r=>e.includes(r))}_getRequirementsTxtDeps(e){return this._pyTestDeps.filter(r=>e.includes(r))}},mZ=class{constructor(e,r,n){this._searchService=e;this._fileSystemService=r;this._textDecoder=n;this._javaTestDeps=["junit","testng","mockito","assertj","hamcrest","powermock","spock","cucumber","arquillian","selenium","rest-assured","wiremock","pitest"]}async findTestDeps(){let e=new Set,r=["pom.xml","build.gradle","build.gradle.kts"],n=await this._searchService.findFiles(`**/{${r.join(",")}}`);return await Promise.all(n.map(async o=>{let s=await this._fileSystemService.readFile(o),a=this._textDecoder.decode(s);this._javaTestDeps.filter(c=>a.includes(c)).forEach(c=>e.add(c))})),Array.from(e)}};var zF=class{constructor(e,r,n,o,s){this.intent=e;this.endpoint=r;this.location=n;this.accessor=o;this.documentContext=s;this.createReplyInterpreter=DI.createFactory(async(e,r)=>{let n=Ws(e);if(n.length===0)return r.markdown(e),{type:"conversational"};let o=n[0],a=e.split(`
`).slice(0,o.startLine).join(`
`).trimEnd();r.markdown(a);let c=o.code,u=this.documentContext.document,l=this.existingTestFile;if(l){let m=await this.accessor.get(Ze).openTextDocument(l),h=new zm;return h.set(l,[On.insert(new Xr(m.lineCount,0),c)]),{type:"workspaceEdit",workspaceEdit:h}}let d=MRe(u),p=pn.joinPath(u.uri,`../${d}`).with({scheme:nn.untitled}),f=new zm;return f.createFile(p,{ignoreIfExists:!0}),f.replace(p,new ze(0,0,0,0),c),{type:"workspaceEdit",workspaceEdit:f}})}get selectionContextMetadata(){return uP(this._selectionContextMetadata!==void 0,"not undefined"),this._selectionContextMetadata}get existingTestFile(){return this._existingTestFile}async buildPrompt(e,r,n,o,s){let a=e.getLatestTurn()?.request.message,c=e.turns.at(-2)?.request.message,u=new Xe(this.endpoint,tA,{history:c,context:this.documentContext,endpoint:this.endpoint,userQuery:a??"",location:this.location},this.accessor.get(ve).acquireTokenizer(this.endpoint.family),this.accessor),l=await u.render(n,s),d=u.getMeta(eA);return d&&(this._existingTestFile=d.uri),this._selectionContextMetadata=u.getMeta(Ss),l}},tA=class extends Y{constructor(r,n,o,s){super(r,n);this.parserService=o;this.testDepsResolver=s}async prepare(r,n,o){let{context:s}=this.props,a=this.parserService.getTreeSitterAST(s.document),c=s.selection,u,l;if(a!==void 0){let m=await a.getNodeToDocument(Xi(s.selection,s.document));c=Ps(s.document,m.nodeToDocument),u=m.nodeIdentifier,l=m.nodeToDocument.type}let d=["typescript","typescriptreact"].includes(s.document.languageId)&&l!==void 0&&["class_declaration","method_definition"].includes(l)?{costFnOverride:(m,h)=>m.kind==="constructor"||m.kind==="method_definition"?0:h}:void 0,p=await M8(this.parserService,s.document,s.fileIndentInfo,c,r.tokenBudget/2,d);return{testFrameworks:await this.testDepsResolver.getTestDeps(this.props.context.document.languageId),identifier:u,summarization:p}}render(r,n){let{history:o,context:s,endpoint:a,userQuery:c,location:u}=this.props,l=r.summarization,d=s.language.languageId,p=r.identifier?`\`${r.identifier}\``:"my code";return vscpp(vscppf,null,vscpp(rA.SystemMessage,null,"You are an AI programming assistant.",vscpp("br",null),vscpp($r,null),vscpp("br",null),vscpp(ir,null),vscpp("br",null),u===1?vscpp(vscppf,null,"The user has a ",d," file opened in a code editor.",vscpp("br",null),"The user includes some code snippets from the file.",vscpp("br",null),"Answer with a single ",d," code block."):u===2?vscpp(vscppf,null,"First think step-by-step - describe your plan for what to build in pseudocode, written out in great detail.",vscpp("br",null),"Then output the code in a single code block.",vscpp("br",null),"Minimize any other prose.",vscpp("br",null),"Use Markdown formatting in your answers.",vscpp("br",null),"Make sure to include the programming language name at the start of the Markdown code blocks.",vscpp("br",null),"Avoid wrapping the whole response in triple backticks.",vscpp("br",null),"The user works in an IDE called Visual Studio Code which has a concept for editors with open files, integrated unit test support, an output pane that shows the output of running the code as well as an integrated terminal.",vscpp("br",null),"The active document is the source code the user is looking at right now.",vscpp("br",null),"You can only give one reply for each conversation turn."):void 0,r.testFrameworks.length>0&&vscpp(vscppf,null,vscpp("br",null),"The project has following testing dependencies: ",r.testFrameworks.join(", "),".")),o!==void 0&&o.length>0&&vscpp(rA.UserMessage,null,o),vscpp(aT,{documentContext:s,endpointInfo:a}),vscpp(rA.UserMessage,null,"Here is the current file at `",s.document.uri.path,"`:",vscpp("br",null),vscpp("br",null),vscpp(Oe,{uri:s.document.uri,languageId:s.document.languageId,code:l.text}),vscpp("br",null),vscpp("br",null),`Please, generate tests for ${p}. ${c}`.trim()))}};tA=B([T(2,_t),T(3,jF)],tA);var lT=W(ct());var BRe=W(ct()),qRe=require("util");var uT=class extends Y{constructor(r,n,o,s,a,c,u){super(r,n);this.searchService=o;this.tabsAndEditorsService=s;this.fileSystemService=a;this.ignoreService=c;this.workspaceService=u}async prepare(r,n,o){let{documentContext:s,endpointInfo:a}=this.props;if(!sT(s.document))return;let u=await new oT(this.searchService,this.tabsAndEditorsService).findFileForTestFile(s.document,o??Fr.None);if(u===void 0||await this.ignoreService.isCopilotIgnored(u))return;let l=a.modelMaxPromptTokens*4/3;function d(f,m,h=l){return`${Ks.forUri(s.language,f)}

${m.substring(0,h)}`}let p;try{let f=await this.workspaceService.openTextDocument(u),m=f.getText(),h=await xTe(this.accessor,f,100),{outlineAbove:g,outlineBelow:v}=GTe(m,h,{startOffset:m.length,endOffset:m.length},""),y=`${g}
${v}`;p=new Bc(`
This is an excerpt of the file that this test is covering:

`),p.appendCodeblock(d(u,y),s.document.languageId)}catch{}if(!p){p=new Bc(`
This is an excerpt of the file that this test is covering:

`);let m=await this.fileSystemService.readFile(u),h=new qRe.TextDecoder().decode(m),g=d(u,h);p.appendCodeblock(g,s.document.languageId)}return{message:p,references:[new Eo.PromptReference(u)]}}render(r,n){if(r!==void 0)return vscpp(BRe.UserMessage,null,vscpp("references",{value:r.references}),r.message.value)}};uT=B([T(2,Aa),T(3,Tt),T(4,on),T(5,De),T(6,Ze)],uT);var GF=class{constructor(e,r,n,o,s){this.intent=e;this.endpoint=r;this.location=n;this.accessor=o;this.context=s;this.responseProcessor={processResponse:async(e,r,n,o,s)=>{let a="";try{let c=[xs.begin(this.context.language),xs.end(this.context.language),Ks.forLanguage(this.context.language)];for await(let u of RTe(Oo.map(n,l=>l.delta.text))){if(s.isCancellationRequested)break;u.kind===1&&c.some(l=>u.value.startsWith(l))||(o.markdown(u.value),a+=u.value)}return a}catch(c){console.error(c)}return""}};this.replyInterpreterFactory=null}async buildPrompt(e,r,n,o,s){let a=e.getLatestTurn()?.request.message,c=e.turns.at(-2)?.request.message,u=this.context,l=new Xe(this.endpoint,hZ,{history:c,context:u,endpoint:this.endpoint,userQuery:a??""},this.accessor.get(ve).acquireTokenizer(this.endpoint.family),this.accessor),d=await l.render(n,s);return this.replyInterpreterFactory=l.getMeta(ei)?.factory??null,this.selectionContextMetadata=l.getMeta(Ss),d}createReplyInterpreter(){if(this.replyInterpreterFactory)return this.replyInterpreterFactory();if(!this.selectionContextMetadata)throw new Error("Could not create reply interpreter without selection context metadata");return new D8(this.accessor,this.selectionContextMetadata,this.context,4,!1)}},hZ=class extends Y{render(e,r){let{history:n,context:o,endpoint:s,userQuery:a}=this.props;return vscpp(vscppf,null,vscpp(lT.SystemMessage,null,"You are an AI programming assistant.",vscpp("br",null),vscpp($r,null),vscpp("br",null),"The user has a ",o.language.languageId," file opened in a code editor.",vscpp("br",null),"The user includes some code snippets from the file.",vscpp("br",null),"Answer with a single ",o.language.languageId," code block.",vscpp("br",null),"Your expertise is strictly limited to software development topics.",vscpp("br",null),vscpp(ir,null)),n!==void 0&&n.length>0&&vscpp(lT.UserMessage,null,n),vscpp(uT,{documentContext:o,endpointInfo:s}),$t(o.document.uri)?vscpp(jI,{documentContext:o}):vscpp(nA,{documentContext:o}),vscpp(lT.UserMessage,null,`Please, generate more tests, taking into account existing tests. ${a}`.trim()))}},nA=class extends Y{constructor(r,n,o,s){super(r,n);this.parserService=o;this.experimentationService=s}async prepare(r,n,o){let{documentContext:s}=this.props,a=await this.accessor.get(De).isCopilotIgnored(s.document.uri),c=s.document.validateRange(s.wholeRange);return{summarizedDocument:await Au(this.parserService,this.experimentationService,s.document,s.fileIndentInfo,s.language,c,r.endpoint.modelMaxPromptTokens/3),isIgnored:a}}render(r,n){if($t(this.props.documentContext.document.uri))throw Ar("InlineChatEditCodePrompt should not be used with a notebook!");if(r.isIgnored)return;let{uri:o,languageId:s}=r.summarizedDocument,a=r.summarizedDocument.splitAroundAdjustedSelection(),{codeAbove:c,codeSelected:u,codeBelow:l,hasCodeWithoutSelection:d}=a,p=`${c}$SELECTION_PLACEHOLDER$${l}`,f=a.createReplyInterpreterFactory(0,1,a.replaceSelectionStreaming,Ro.createCodeBlockClassifier(),m=>m.value.trim()!=="$SELECTION_PLACEHOLDER$");return vscpp(lT.UserMessage,null,vscpp("meta",{value:new ei(f)}),"I have the following code in a file called `",vscpp(ga,{value:o,mode:1}),"`:",d&&vscpp(vscppf,null,vscpp(Oe,{uri:o,languageId:s,code:p,shouldTrim:!1}),vscpp("br",null)),d&&vscpp(vscppf,null,"The $SELECTION_PLACEHOLDER$ code is:",vscpp("br",null)),vscpp(Oe,{uri:o,languageId:s,code:u,shouldTrim:!1}))}};nA=B([T(2,_t),T(3,Lt)],nA);var VF=class{constructor(){this.id="tests";this.locations=[2,1];this.description=HRe.t("Generate unit tests for the selected code");this.commandInfo=void 0}static{this.ID="tests"}get intentDetectionInput(){let e="generate_test_for_code";return{functionName:e,sampleQuestion:"Write a set of detailed unit test functions for the code above.",functionCallingBlurb:`If the user's message is related to generating tests, you should use the '${e}' function.`}}async invoke(e,r){let n=r.documentContext;if(!n)throw new Error("Open a file to generate tests.");if(await e.get(De).isCopilotIgnored(n.document.uri))throw new Error("Copilot is disabled for this file.");let s=r.location,a=e.get(Le),c=await Mn(a,s);return sT(n.document)?new GF(this,c,s,e,n):new zF(this,c,s,e,n)}};var $F=W(Tr());function jRe(t,e){let r=Ws(e);for(let n of r){if(n.language!=="json"&&n.language!=="")return[{command:void 0,showCodeBlock:!0,failedValidation:!1}];let o;try{o=LC(n.code)}catch{}if(!o)return[];let s=o.hasOwnProperty("type")&&o.type==="setting",a=o.hasOwnProperty("type")&&o.type==="command";if(s){let c=[],u=o.settings;if(!u)return c;let l="",d=!1;for(let p of Object.keys(u))c.some(f=>f.command?.arguments&&f.command.arguments[0].includes(`@id:${p}`))||(l+=`@id:${p} `,t.hasSetting(p)||(d=!0));return l=l.trimEnd(),l&&c.push({command:{command:"workbench.action.openSettings",arguments:[l],title:Ki.t("Show in Settings Editor")},showCodeBlock:!0,failedValidation:d,codeBlock:"```json\n"+JSON.stringify(u,null,2)+"\n```"}),c}else if(a){let c=o.commands.command;if(!c)return[{command:void 0,showCodeBlock:!0,failedValidation:!1}];let u=o.commands.args,l=[];if(c==="workbench.extensions.search"||c==="workbench.extensions.installExtension"){let d=(Array.isArray(u)?u:[u]).filter(p=>typeof p=="string");if(d.length===1){let p=["featured","popular","recentlyPublished","recommended","updates","builtin","enabled","disabled","installed","workspaceUnsupported"];d[0].includes(":")&&!d[0].startsWith("@")?d[0]=`@${d[0]}`:p.includes(d[0])&&(d[0]=`@${d[0]}`)}return l.push({command:{command:"workbench.extensions.search",arguments:d,title:Ki.t("Search Extension Marketplace")},showCodeBlock:!1,failedValidation:!1}),l}else{let d=t.getCommand(c);if(!d)continue;return l.push({command:{command:"workbench.action.quickOpen",arguments:[`>${d.originalLabel??""}`],title:l.length>1?Ki.t('Show "{0}"',d.originalLabel??""):Ki.t("Show in Command Palette")},showCodeBlock:!1,failedValidation:!1}),l}}else return[{command:void 0,showCodeBlock:!0,failedValidation:!1}]}return[]}var gZ=class extends Yo{constructor(r,n,o,s){super(n,o,s);this.accessor=r;this.linkification={disable:!0};this.responseProcessor=new vZ(r.get(Ku),r.get(qp))}async createRenderer(r,n,o,s,a,c){let l=r.getLatestTurn().request.message,d=r.turns.length>1?r.turns.slice(0,-1):[];return new Xe(n,OC,{chatVariables:o,query:l,history:d},this.accessor.get(ve).acquireTokenizer(n.family),this.accessor)}},vZ=class{constructor(e,r){this.combinedIndex=e;this.workbechService=r;this.stagedTextToApply="";this.appliedText="";this._incodeblock=!1}async processResponse(e,r,n,o,s){for await(let{delta:a}of n){if(s.isCancellationRequested)break;await this.applyDelta(a.text,o)}return this.appliedText}async processNonReporting(e,r){let n=jRe(this.combinedIndex,e);for(let o of n)if(o.showCodeBlock&&r.markdown(o.codeBlock?o.codeBlock:e),o.command&&r.button(o.command),o.failedValidation){if((await this.workbechService.getAllCommands()).map(c=>c.command).includes(o.command.command))return;let a=o.showCodeBlock?$F.t("To apply this setting, an additional extension installation is needed."):$F.t("To execute this command, an additional extension installation is needed.");r.warning(a)}}async applyDelta(e,r){this.appliedText+=e,e=this.stagedTextToApply+e;let n=e.indexOf("```");if(this._incodeblock){let o=e.indexOf("```");o===-1?this.stagedTextToApply=e:(this._incodeblock=!1,e="\n```"+e.substring(0,o)+"```\n",await this.processNonReporting(e,r),this.stagedTextToApply="")}else if(n!==-1){this._incodeblock=!0;let o=e.indexOf("```",n+3);if(o!==-1)this._incodeblock=!1,r.markdown(e.substring(0,n)),await this.processNonReporting(e,r),r.markdown(e.substring(o+3));else{let s=e.substring(0,n);r.markdown(s)}}else r.markdown(e)}},WF=class t{constructor(){this.id=t.ID;this.locations=[2];this.description=$F.t("Ask questions about VS Code");this.commandInfo={allowsEmptyArgs:!1}}static{this.ID="vscode"}get intentDetectionInput(){let e="vscode_questions";return{functionName:e,sampleQuestion:"What is the command to open the integrated terminal?",modelDescription:"Looks up information about VS Code via commands, settings, and documentation to accomplish the given editor-specific task.",functionCallingBlurb:`If the user's message is related to commands or settings in Visual Studio Code, you should use the '${e}' function.`}}async invoke(e,r){let n=r.location,o=e.get(Le),s=await Mn(o,n);return new gZ(e,this,n,s)}};Hi.registerIntent(new Ue(Ub));Hi.registerIntent(new Ue(_v));Hi.registerIntent(new Ue(UF));Hi.registerIntent(new Ue(EM));Hi.registerIntent(new Ue(VF));Hi.registerIntent(new Ue(tT));Hi.registerIntent(new Ue(_M));Hi.registerIntent(new Ue(OF));Hi.registerIntent(new Ue(HF));Hi.registerIntent(new Ue(Hb));Hi.registerIntent(new Ue(Rl));Hi.registerIntent(new Ue(xv));Hi.registerIntent(new Ue(BF));Hi.registerIntent(new Ue(NF));Hi.registerIntent(new Ue(dF));Hi.registerIntent(new Ue(MM));Hi.registerIntent(new Ue(WF));Hi.registerIntent(new Ue(eT));var zRe=W(require("fs")),GRe=W(require("os")),br=W(require("vscode"));var Vtt="```",iA,dT=class extends St{constructor(r){super();this.configurationService=r;this.notebookDocIsOpen=!1;this.updateScheduler=this._register(new hP(()=>this.writeNotebook(),100)),this.logUri,this._register(br.workspace.onDidOpenNotebookDocument(n=>{n.uri.toString()===this.logUri?.toString()&&(this.notebookDocIsOpen=!0,this.updateScheduler.schedule())})),this._register(br.workspace.onDidCloseNotebookDocument(n=>{n.uri.toString()===this.logUri?.toString()&&(this.notebookDocIsOpen=!1)}))}get logUri(){if(!this.configurationService.getConfig(ge.ConversationLoggingEnabled)||!this.configurationService.getConfig(ge.NotebookLoggingEnabled)){this.mdLogPath=void 0,iA=void 0;return}if(!this.mdLogPath){let r=Math.random().toString(36).substring(2,10);this.mdLogPath=pn.joinPath(pn.file(GRe.tmpdir()),`copilot-chat-log-${r}.ipynb`),iA=this.mdLogPath,zRe.promises.writeFile(this.mdLogPath.fsPath,""),console.log("Logging .ipynb file to "+this.mdLogPath.fsPath)}return this.mdLogPath}logRequest(r,n){this.logUri&&(this.currentLogModel={request:r,endpoint:n,isDone:!1},this.updateScheduler.schedule())}logMessages(r){!this.currentLogModel||this.currentLogModel.isDone||(this.currentLogModel.messages=r,this.updateScheduler.schedule())}getNotebookData(){let r=this.currentLogModel?[new br.NotebookCellData(br.NotebookCellKind.Code,JSON.stringify(this.currentLogModel.request,void 0,4),"json"),new br.NotebookCellData(br.NotebookCellKind.Code,`// Endpoint:
`+JSON.stringify(this.currentLogModel.endpoint,void 0,4),"json")]:[],n=this.currentLogModel?.messages?.map(u=>{if(u.name||u.copilot_confirmations||u.copilot_references){let l=`Role: ${u.role}
`;return u.name&&(l+=`Name: ${u.name}
`),u.copilot_confirmations&&(l+=`Confirmations: ${u.copilot_confirmations}
`),u.copilot_references&&(l+=`References: ${u.copilot_references}
`),l+=`${u.content}
${Vtt}

`,new br.NotebookCellData(br.NotebookCellKind.Code,l,"markdown")}else return new br.NotebookCellData(br.NotebookCellKind.Code,`${u.role}: ${u.content}`,"markdown")})??[],o=this.currentLogModel?.progressParts?.map(u=>u instanceof br.ChatResponseMarkdownPart?typeof u.value=="string"?u.value:u.value.value:JSON.stringify(u)+`
`)??[],s=new br.NotebookCellData(br.NotebookCellKind.Code,o.join(""),"markdown"),a=this.currentLogModel?.streamChoices?.map(u=>{let l={...u};return delete l.index,delete l.content_filter_offsets,delete l.content_filter_results,l.delta&&!l.delta.role&&delete l.delta.role,JSON.stringify(l)})??[],c=new br.NotebookCellData(br.NotebookCellKind.Code,a.join(`
`)??"","json");return new br.NotebookData([new br.NotebookCellData(br.NotebookCellKind.Markup,"## Request","markdown"),...r,new br.NotebookCellData(br.NotebookCellKind.Markup,"## Messages","markdown"),...n,new br.NotebookCellData(br.NotebookCellKind.Markup,"## Response","markdown"),s,new br.NotebookCellData(br.NotebookCellKind.Markup,"## Raw Stream","markdown"),c])}async writeNotebook(){if(this.logUri&&this.notebookDocIsOpen){let r=this.getNotebookData(),n=new br.WorkspaceEdit;n.set(this.logUri,[new br.NotebookEdit(new br.NotebookRange(0,1e6),r.cells)]),await br.workspace.applyEdit(n)||console.error("Failed to write log notebook")}}logProgress(r){!this.currentLogModel||this.currentLogModel.isDone||(this.currentLogModel.progressParts=this.currentLogModel.progressParts||[],this.currentLogModel.progressParts.push(r),this.updateScheduler.schedule())}logRawStreamChoice(r){!this.currentLogModel||this.currentLogModel.isDone||(this.currentLogModel.streamChoices=this.currentLogModel.streamChoices||[],this.currentLogModel.streamChoices.push(r),this.updateScheduler.schedule())}logResult(r){!this.currentLogModel||this.currentLogModel.isDone||(this.currentLogModel.result=r,this.currentLogModel.isDone=!0)}};dT=B([T(0,be)],dT);var $tt=[{max_token_sequence_length:1,last_tokens_to_consider:10},{max_token_sequence_length:10,last_tokens_to_consider:30},{max_token_sequence_length:20,last_tokens_to_consider:45},{max_token_sequence_length:30,last_tokens_to_consider:60}];function $Re(t,e="client"){if(e==="proxy")return!1;let r=t.slice();return r.reverse(),VRe(r)||VRe(r.filter(n=>n.trim().length>0))}function VRe(t){let e=Wtt(t);for(let r of $tt){if(t.length<r.last_tokens_to_consider)continue;if(r.last_tokens_to_consider-1-e[r.last_tokens_to_consider-1]<=r.max_token_sequence_length)return!0}return!1}function Wtt(t){let e=Array(t.length).fill(0);e[0]=-1;let r=-1;for(let n=1;n<t.length;n++){for(;r>=0&&t[r+1]!==t[n];)r=e[r];t[r+1]===t[n]&&r++,e[n]=r}return e}var Hv=class{},Ktt=30*1e3;function WRe(t,e,r,n,o,s,a,c,u,l,d,p){let f=typeof s=="string"?{modelMaxPromptTokens:0,url:s,family:"",name:"",version:""}:s,m={Authorization:`Bearer ${a}`,"X-Request-Id":l,"X-GitHub-Api-Version":"2023-07-07","Openai-Organization":"github-copilot","Copilot-Integration-Id":e.isProduction()?"vscode-chat":"vscode-chat-dev","VScode-SessionId":e.sessionId,"VScode-MachineId":e.machineId,...e.getEditorVersionHeaders(),...f.getExtraHeaders?f.getExtraHeaders():{}};if(f.interceptBody&&f.interceptBody(d),u&&(m["OpenAI-Intent"]=u),!e.isProduction()&&f.url.includes(n.capiBaseURL)){if(!c)throw new Error("HMAC must be provided for non-production requests");m["Request-Hmac"]=c}let h={method:o,headers:m,json:d,timeout:Ktt},g=t;if(p){let y=g.makeAbortController();p.onCancellationRequested(()=>{r.sendGHTelemetryEvent("networking.cancelRequest",{headerRequestId:l}),y.abort()}),h.signal=y.signal}return g.fetch(f.url,h).catch(y=>{if(y.code==="ECONNRESET"||y.code==="ETIMEDOUT"||y.code==="ERR_HTTP2_INVALID_SESSION"||y.message==="ERR_HTTP2_GOAWAY_SESSION")return r.sendGHTelemetryEvent("networking.disconnectAll"),g.disconnectAll().then(()=>g.fetch(f.url,h));throw g.isAbortError(y)?new ns:y})}function pT(t,e,r,n,o,s,a,c,u,l,d){return WRe(t,e,r,n,"POST",o,s,a,c,u,l,d)}function yZ(t,e,r,n,o,s,a,c,u,l,d){return WRe(t,e,r,n,"GET",o,s,a,c,u,l,d)}var KRe=se("headerContributors"),KF=class{constructor(){this.contributors=[]}add(e){this.contributors.push(e)}remove(e){let r=this.contributors.indexOf(e);r!==-1&&this.contributors.splice(r,1)}contributeHeaders(e){for(let r of this.contributors)r.contributeHeaderValues(e)}size(){return this.contributors.length}};var YF=class{constructor(){this.logprobs=[];this.top_logprobs=[];this.text=[];this.newText=[];this.tokens=[];this.text_offset=[]}append(e){e.text&&(this.text.push(e.text),this.newText.push(e.text)),e.delta?.content&&(this.text.push(e.delta.content),this.newText.push(e.delta.content)),e.delta?.function_call&&(this.text.push(e.delta.function_call.arguments),this.newText.push(e.delta.function_call.arguments)),e.logprobs&&(this.tokens.push(e.logprobs.tokens??[]),this.text_offset.push(e.logprobs.text_offset??[]),this.logprobs.push(e.logprobs.token_logprobs??[]),this.top_logprobs.push(e.logprobs.top_logprobs??[]))}flush(){let e=this.newText.join("");return this.newText=[],e}};function Qtt(t){let e=t.split(`
`),r=e.pop();return[e.filter(n=>n!==""),r]}var QF=class t{constructor(e,r,n,o,s,a){this.telemetryService=r;this.expectedNumChoices=n;this.response=o;this.body=s;this.cancellationToken=a;this.requestId=c2(this.response);this.stats=new bZ(this.expectedNumChoices);this.solutions={};this.completedFunctionCallIdxs=new Map;this.functionCalls={};this.functionCallName=void 0;this.logger=e.getLogger("streamChoices"),this.responseLogger=e.getPromptResponseLogger2()}static async create(e,r,n,o,s){let a=await o.body();return a.setEncoding("utf8"),new t(e,r,n,o,a,s)}async*processSSE(e=async()=>{}){try{yield*this.processSSEInner(e)}finally{this.cancel(),this.logger.info(`request done: requestId: [${this.requestId.headerRequestId}] model deployment ID: [${this.requestId.deploymentId}]`),this.logger.debug(`request stats: ${this.stats}`)}}async*processSSEInner(e){let r="",n=!1;e:for await(let o of this.body){if(this.maybeCancel("after awaiting body chunk"))return;this.logger.debug("chunk",o.toString());let[s,a]=Qtt(r+o.toString());r=a;let c=!1;for(let u of s){let l=u.slice(5).trim();if(l==="[DONE]"){yield*this.finishSolutions();return}let d;try{d=JSON.parse(l)}catch{this.logger.error(`Error parsing JSON stream data for request id ${this.requestId.headerRequestId}:`,u),mm(this.telemetryService,`Error parsing JSON stream data for request id ${this.requestId.headerRequestId}:`,u);continue}if(d.copilot_confirmation&&Xtt(d.copilot_confirmation)&&await e("",0,{text:"",copilotConfirmation:d.copilot_confirmation}),!d.choices){!d.copilot_references&&!d.copilot_confirmation&&(d.error!==void 0?(this.logger.error(`Error in response for request id ${this.requestId.headerRequestId}:`,d.error.message),mm(this.telemetryService,`Error in response for request id ${this.requestId.headerRequestId}:`,d.error.message)):(this.logger.error(`Unexpected response with no choices or error for request id ${this.requestId.headerRequestId}`),mm(this.telemetryService,`Unexpected response with no choices or error for request id ${this.requestId.headerRequestId}`))),d.copilot_errors&&await e("",0,{text:"",copilotErrors:d.copilot_errors});continue}if(this.requestId.created===0&&(this.requestId=c2(this.response,d),this.requestId.created===0&&d.choices?.length&&(this.logger.error(`Request id invalid, should have "completionId" and "created": ${JSON.stringify(this.requestId)}`,this.requestId),mm(this.telemetryService,`Request id invalid, should have "completionId" and "created": ${JSON.stringify(this.requestId)}`,this.requestId))),this.allSolutionsDone())break e;for(let p=0;p<d.choices.length;p++){let f=d.choices[p];this.logger.debug("choice",f),this.responseLogger.logRawStreamChoice(f),this.stats.add(f.index),f.index in this.solutions||(this.solutions[f.index]=new YF);let m=this.solutions[f.index];if(m===null)continue;let h,g=async(y,_,b,S)=>(y&&(!Array.isArray(y)||!y.every(I=>dTe(I)))&&(y=void 0),h=await e(m.text.join(""),f.index,{text:m.flush(),codeVulnAnnotations:y,copilotReferences:_,copilotFunctionCalls:b,copilotErrors:S}),h!==void 0&&(n=!0),this.maybeCancel("after awaiting finishedCb"));if(f.delta?.annotations?.CodeVulnerability){if(await g()||!n&&(m.append(f),await g(f.delta.annotations.CodeVulnerability)))continue}else if(f.delta?.role==="function"){if(f.delta.content)try{let y=JSON.parse(f.delta.content);if(Array.isArray(y)&&await g(void 0,y))continue}catch(y){this.logger.error(`Error parsing function references: ${JSON.stringify(y)}`)}}else if(f.delta?.function_call)c=!0,this.functionCallName??=f.delta.function_call.name,this.functionCalls[this.functionCallName]??=new YF,this.functionCalls[this.functionCallName].append(f);else if((f.finish_reason==="function_call"||f.finish_reason==="stop")&&this.functionCallName){let y=this.functionCalls[this.functionCallName],_={name:this.functionCallName,arguments:y.flush()};f.finish_reason==="function_call"&&this.completedFunctionCallIdxs.set(f.index,_);try{if(await g(void 0,void 0,[_]))continue}catch{}this.functionCalls[this.functionCallName]=null,this.functionCallName=void 0;continue}else if(m.append(f),await g())continue;if(f.finish_reason||h!==void 0){if(this.stats.markYielded(f.index),yield{solution:m,finishOffset:h,reason:f.finish_reason??"client-trimmed",filterReason:Jtt(f),requestId:this.requestId,index:f.index},this.maybeCancel("after yielding finished choice"))return;c||(this.solutions[f.index]=null)}}}}for(let[o,s]of Object.entries(this.solutions)){let a=Number(o);if(s!==null&&(this.stats.markYielded(a),yield{solution:s,finishOffset:void 0,reason:"Iteration Done",requestId:this.requestId,index:a},this.maybeCancel("after yielding after iteration done")))return}if(r.length>0&&!n)try{let o=JSON.parse(r);o.error!==void 0&&(this.logger.error(`Error in response: ${o.error.message}`,o.error),mm(this.telemetryService,`Error in response: ${o.error.message}`,o.error))}catch{this.logger.error(`Error parsing extraData for request id ${this.requestId.headerRequestId}: ${r}`),mm(this.telemetryService,`Error parsing extraData for request id ${this.requestId.headerRequestId}: ${r}`)}}async*finishSolutions(){for(let[e,r]of Object.entries(this.solutions)){let n=Number(e);if(r!==null){if(this.completedFunctionCallIdxs.has(n)){yield{solution:r,finishOffset:void 0,reason:"function_call",requestId:this.requestId,index:n};continue}if(this.stats.markYielded(n),yield{solution:r,finishOffset:void 0,reason:"DONE",requestId:this.requestId,index:n},this.maybeCancel("after yielding on DONE"))return}}}maybeCancel(e){return this.cancellationToken?.isCancellationRequested?(this.logger.debug("Cancelled: "+e),this.cancel(),!0):!1}cancel(){this.body.destroy()}allSolutionsDone(){let e=Object.values(this.solutions);return e.length===this.expectedNumChoices&&e.every(r=>r===null)}};function Xtt(t){return typeof t.title=="string"&&typeof t.message=="string"&&!!t.confirmation}function YRe(t){let r={text:t.text.join(""),tokens:t.text};if(t.logprobs.length===0)return r;let n=t.logprobs.reduce((c,u)=>c.concat(u),[]),o=t.top_logprobs.reduce((c,u)=>c.concat(u),[]),s=t.text_offset.reduce((c,u)=>c.concat(u),[]),a=t.tokens.reduce((c,u)=>c.concat(u),[]);return{...r,logprobs:{token_logprobs:n,top_logprobs:o,text_offset:s,tokens:a}}}function Jtt(t){if(t.finish_reason!=="content_filter")return;if(!!t.delta?.annotations?.TextCopyright)return"snippy";if(t.content_filter_results){for(let r of Object.keys(t.content_filter_results))if(t.content_filter_results[r]?.filtered)return r}}var bZ=class{constructor(e){this.choices=new Map;for(let r=0;r<e;r++)this.choices.set(r,new oA)}add(e){let r=this.choices.get(e)??new oA;r.increment(),this.choices.set(e,r)}markYielded(e){let r=this.choices.get(e)??new oA;r.markYielded(),this.choices.set(e,r)}toString(){return Array.from(this.choices.entries()).map(([e,r])=>`${e}: ${r.yieldedTokens} -> ${r.seenTokens}`).join(", ")}},oA=class{constructor(){this.yieldedTokens=-1;this.seenTokens=0}increment(){this.seenTokens++}markYielded(){this.yieldedTokens=this.seenTokens}};function mm(t,e,r){let n=[e,r],o=n.length>0?JSON.stringify(n):"no msg",s=Vn.createAndMarkAsIssued({context:"fetch",level:yE[3],message:o});t.sendRestrictedGHTelemetryErrorEvent("log",s.properties,s.measurements);let a=Vn.createAndMarkAsIssued({context:"fetch",level:yE[3],message:"[redacted]"});t.sendGHTelemetryErrorEvent("log",a.properties,a.measurements)}function _Z(t,e,r){let n=r.extendedBy({messagesJson:JSON.stringify(e)});t.sendRestrictedGHTelemetryEvent("engine.messages",n.properties,n.measurements)}function Ztt(t,e,r,n,o,s,a,c,u){return _Z(t,[e],u),{message:e,choiceIndex:n,requestId:o,blockFinished:s,finishReason:a,filterReason:c,tokens:r.tokens,numTokens:r.tokens.length,telemetryData:u}}function QRe(t,e,r,n){let o=e.getLogger("streamMessages"),s=r.solution.text.join(""),a=!1;r.finishOffset!==void 0&&(o.debug(`message ${r.index}: early finish at offset ${r.finishOffset}`),s=s.substring(0,r.finishOffset),a=!0),o.info(`message ${r.index} returned. finish reason: [${r.reason}]`),o.debug(`message ${r.index} details: finishOffset: [${r.finishOffset}] completionId: [{${r.requestId.completionId}}] created: [{${r.requestId.created}}]`);let c=YRe(r.solution),u={role:"assistant",content:s};return Ztt(t,u,c,r.index,r.requestId,a,r.reason,r.filterReason,n)}async function hm(t){if(!t)return;let e=await crypto.subtle.importKey("raw",new TextEncoder().encode(t),{name:"HMAC",hash:"SHA-256"},!1,["sign"]),r=Math.floor(Date.now()/1e3).toString(),o=new TextEncoder().encode(r),s=await crypto.subtle.sign("HMAC",e,o),c=Array.from(new Uint8Array(s)).map(u=>u.toString(16).padStart(2,"0")).join("");return`${r}.${c}`}function XRe(t){if(t!==void 0&&t!==0&&t.hostname==="github.com")return t.owner+"/"+t.repo}async function JRe(t,e,r,n,o,s,a){let c=t.get(ce).getLogger("chat fetch"),u=t.get(ce).getPromptResponseLogger("chat fetch"),l=trt(t,r);if(s?.isCancellationRequested)return{type:"canceled",reason:"before fetch request"};u.info(`url ${e.url}`),u.info(`modelMaxPromptTokens ${e.modelMaxPromptTokens}`),u.info(`modelMaxResponseTokens ${l.max_tokens??2048}`),u.info(`chat model ${r.model}`);let d=r.secretKey??(await t.get(Nn).getCopilotToken()).token;if(!d)return c.error(`Failed to send request to ${e.url} due to missing key`),mm(t.get(me),`Failed to send request to ${e.url} due to missing key`),{type:"failed",failKind:"tokenExpiredOrInvalid",reason:"key is missing"};let p=await nrt(t,e,r.ourRequestId,l,d,r.location,s,a);if(s?.isCancellationRequested){let v=await p.body();try{v.destroy()}catch(y){c.exception(y,"Error destroying stream"),t.get(me).sendGHTelemetryException(y,"Error destroying stream")}return{type:"canceled",reason:"after fetch request"}}if(p.status!==200){let v=ert(e,t,r.location,r.ourRequestId);return c.info("Request ID for failed request: ",r.ourRequestId),rrt(t,v,p)}let f=t.get(me),m=t.get(ce),h=r.postOptions?.n??1;return{type:"success",chatCompletions:await e.processResponseFromChatEndpoint(f,m,p,h,o,n,s),getProcessingTime:()=>lTe(p)}}function ert(t,e,r,n){return Vn.createAndMarkAsIssued({endpoint:"completions",engineName:"chat",uiKind:mt.toString(r),headerRequestId:n})}function trt(t,e){let r={messages:e.messages,model:e.model};e.postOptions&&Object.assign(r,e.postOptions);let n=XRe(e.repoInfo);return n!==void 0&&(r.nwo=n),e.intent&&(r.intent=e.intent,e.intent_model&&(r.intent_model=e.intent_model),e.intent_tokenizer&&(r.intent_tokenizer=e.intent_tokenizer),e.intent_threshold&&(r.intent_threshold=e.intent_threshold)),r}async function rrt(t,e,r){let n=t.get(ce).getLogger("chat fetch"),o=t.get(me);e.properties.error=`Response status was ${r.status}`,e.properties.status=String(r.status),o.sendGHTelemetryEvent("request.shownWarning",e.properties,e.measurements);let s=await r.text();if(r.status===401&&s.includes("authorize_url"))try{let a=JSON.parse(s);return{type:"failed",failKind:"unauthorized",reason:r.statusText||r.statusText,data:a}}catch{}if(r.status===401||r.status===403)return t.get(Nn).resetCopilotToken(r.status),{type:"failed",failKind:"tokenExpiredOrInvalid",reason:`token expired or invalid: ${r.status}`};if(r.status===499)return n.info("Cancelled by server"),{type:"failed",failKind:"serverCanceled",reason:"canceled by server"};if(r.status===466)return n.info(s),{type:"failed",failKind:"clientNotSupported",reason:`client not supported: ${s}`};if(r.status===400&&s.includes("off_topic"))return{type:"failed",failKind:"offTopic",reason:"filtered as off_topic by intent classifier: message was not programming related"};if(r.status===424)return{type:"failed",failKind:"failedDependency",reason:s};if(r.status===429){if(s.includes("extension_blocked"))try{let a=JSON.parse(s);if(a.error&&(a=a.error),a.code==="extension_blocked"&&a.type==="rate_limit_error")return{type:"failed",failKind:"extensionBlocked",reason:a.reason??a.code,data:{...a.message,retryAfter:r.headers.get("retry-after")}}}catch{}return{type:"failed",failKind:"rateLimited",reason:s}}return r.status>=500&&r.status<600?{type:"failed",failKind:"serverError",reason:`${r.status} ${s}`}:r.status===422?{type:"failed",failKind:"contentFilter",reason:"Filtered by Responsible AI Service"}:(n.error("Unhandled status from server:",r.status,s),mm(t.get(me),"Unhandled status from server: "+r.status,s),{type:"failed",failKind:"unknown",reason:`unhandled status from server: ${r.status} ${s}`})}async function nrt(t,e,r,n,o,s,a,c){let u=t.get(ce).getLogger("chat fetch"),l=t.get(me),d=Vn.createAndMarkAsIssued({endpoint:"completions",engineName:"chat",uiKind:mt.toString(s),...c},{maxTokenWindow:e.modelMaxPromptTokens});for(let[m,h]of Object.entries(n))m!=="messages"&&(d.properties[`request.option.${m}`]=JSON.stringify(h)??"undefined");d.properties.headerRequestId=r,l.sendGHTelemetryEvent("request.sent",d.properties,d.measurements);let p=Date.now(),f=irt(s);return pT(t.get(Ur),t.get(Pt),t.get(me),t.get(Ln),e,o,await hm(process.env.HMAC_SECRET),f,r,n,a).then(m=>{let h=c2(m,void 0);d.extendWithRequestId(h);let g=Date.now()-p;return d.measurements.totalTimeMs=g,u.info(`request.response: [${e.url}], took ${g} ms`),u.debug("request.response properties",d.properties),u.debug("request.response measurements",d.measurements),u.debug(`messages: ${JSON.stringify(n.messages)}`),l.sendGHTelemetryEvent("request.response",d.properties,d.measurements),m}).catch(m=>{if(t.get(Ur).isAbortError(m))throw m;let g=d.extendedBy({error:"Network exception"});l.sendGHTelemetryEvent("request.shownWarning",g.properties,g.measurements),d.properties.code=String(m.code??""),d.properties.errno=String(m.errno??""),d.properties.message=String(m.message??""),d.properties.type=String(m.type??"");let v=Date.now()-p;throw d.measurements.totalTimeMs=v,u.debug(`request.response: [${e.url}] took ${v} ms`),u.debug("request.error properties",d.properties),u.debug("request.error measurements",d.measurements),l.sendGHTelemetryEvent("request.error",d.properties,d.measurements),m}).finally(()=>{_Z(l,n.messages,d)})}function irt(t){switch(t){case 2:return"conversation-panel";case 1:return"conversation-inline"}}var xZ=class{constructor(){this._onDidMakeChatMLRequest=new Ht;this.onDidMakeChatMLRequest=this._onDidMakeChatMLRequest.event}async fetchOne(e,r,n,o,s,a,c,u,l){let d=await this.fetchMany(e,r,n,o,s,a,{...c,n:1},u,l);return d.type==="success"?{...d,value:d.value[0]}:d}},jv=class extends xZ{constructor(r){super();this.accessor=r;this.logger=r.get(ce).getPromptResponseLogger("ChatMLFetcher")}async fetchMany(r,n,o,s,a,c,u,l,d){let p=l?.requestId??l?.messageId??Br(),f=dC(this.accessor.get(ve).acquireTokenizer(a.family),r.map(_=>({role:_.role,content:_.content,..._.name?{name:_.name}:void 0}))),m=Math.min(a.modelMaxPromptTokens-f+2048,4096);u={max_tokens:m,...u};let h=jv.preparePostOptions(u),g=a.model;d&&(d.intent_model=await this.getOffTopicModelName(),d.intent_tokenizer=await this.getOffTopicModelTokenizer(),d.intent_threshold=await this.getOffTopicModelThreshold());let v={messages:r,model:g,repoInfo:void 0,ourRequestId:p,location:s,postOptions:h,secretKey:u.secretKey,...d},y=Vn.createAndMarkAsIssued({...l,uiKind:mt.toString(s)});try{let _,b=ort(v);if(!b.isValid)_={type:"failed",failKind:"validationFailed",reason:`Prompt failed validation with the reason: ${b.reason}. Please file an issue.`};else{_=await JRe(this.accessor,a,v,y,n||(async()=>{}),o,l);let w=c?.extensionId??Rb,O=c?.agent&&w===Rb&&lne.includes(c.agent)?F_(c.agent):c?.agent;this._onDidMakeChatMLRequest.fire({messages:r,model:a.model,source:{extensionId:w,agent:O},tokenCount:f})}let S=Date.now()-y.issuedTime,I;switch(_.type){case"success":return await this.processSuccessfulResponse(_,v.ourRequestId,m,f,S,y,a);case"canceled":return this.accessor.get(me).sendMSFTTelemetryEvent("response.cancelled",{source:l?.messageSource??"unknown",requestId:v.ourRequestId,model:a.model},{totalTokenMax:a.modelMaxPromptTokens??-1,promptTokenCount:f,tokenCountMax:m,timeToFirstToken:S,timeToCancelled:y?Date.now()-y.issuedTime:-1}),this.processCanceledResponse(_,v.ourRequestId);case"failed":return I=this.processFailedResponse(_,v.ourRequestId),this._sendResponseErrorTelemetry(I,l,v,a,f,m,S),I}}catch(_){let b=Date.now()-y.issuedTime,S=this.processError(_,v.ourRequestId);return this._sendResponseErrorTelemetry(S,l,v,a,f,m,b),S}}_sendResponseErrorTelemetry(r,n,o,s,a,c,u){this.accessor.get(me).sendMSFTTelemetryEvent("response.error",{type:r.type,reason:r.reason,source:n?.messageSource??"unknown",requestId:o.ourRequestId,model:s.model},{totalTokenMax:s.modelMaxPromptTokens??-1,promptTokenCount:a,tokenCountMax:c,timeToFirstToken:u})}static preparePostOptions(r){return{...r,stream:!0}}async processSuccessfulResponse(r,n,o,s,a,c,u){let l=[];for await(let m of r.chatCompletions)this.accessor.get(me).sendMSFTTelemetryEvent("response.success",{reason:m.finishReason,filterReason:m.filterReason,source:c?.properties.messageSource??"unknown",model:u?.model,requestId:n},{totalTokenMax:u?.modelMaxPromptTokens??-1,tokenCountMax:o,promptTokenCount:s,tokenCount:m.numTokens,timeToFirstToken:a,timeToComplete:c?Date.now()-c.issuedTime:-1}),this.isRepetitive(m,c?.properties)||l.push(m);this.logger.debug(`Received choices: ${JSON.stringify(l,null,2)}`);let d=new Set(["stop","client-trimmed","function_call"]),p=l.filter(m=>d.has(m.finishReason));if(p.length>=1)return{type:"success",value:p.map(m=>m.message.content),requestId:n};let f=l[0];switch(f?.finishReason){case"content_filter":return{type:"filtered",category:f.filterReason??"snippy",reason:"Response got filtered.",requestId:n};case"length":return{type:"length",reason:"Response too long.",requestId:n,truncatedValue:f.message.content}}return{type:"unknown",reason:"Response contained no choices.",requestId:n}}async getOffTopicModelName(){let r=this.accessor.get(be).getConfig(ge.DebugOverrideChatOffTopicModel);return r||""}async getOffTopicModelTokenizer(){let r=this.accessor.get(be).getConfig(ge.DebugOverrideChatOffTopicModelTokenizer);return r||""}async getOffTopicModelThreshold(){let r=this.accessor.get(be).getConfig(ge.DebugOverrideChatOffTopicModelThreshold);return r!==0?r:0}isRepetitive(r,n){let o=$Re(r.tokens);if(o){let s=Vn.createAndMarkAsIssued();s.extendWithRequestId(r.requestId);let a=s.extendedBy(n);this.accessor.get(me).sendRestrictedGHTelemetryEvent("conversation.repetition.detected",a.properties,a.measurements),this.logger.info("Filtered out repetitive conversation result")}return o}processCanceledResponse(r,n){return this.logger.debug("Cancelled after awaiting fetchConversation"),{type:"canceled",reason:r.reason,requestId:n}}processFailedResponse(r,n){if(r.failKind==="rateLimited")return{type:"rateLimited",reason:r.reason,requestId:n};if(r.failKind==="offTopic")return{type:"offTopic",reason:r.reason,requestId:n};if(r.failKind==="tokenExpiredOrInvalid"||r.failKind==="clientNotSupported"||r.reason.includes("Bad request: "))return{type:"badRequest",reason:r.reason,requestId:n};if(r.failKind==="serverError")return{type:"failed",reason:r.reason,requestId:n};if(r.failKind==="contentFilter")return{type:"filtered",reason:r.reason,category:"prompt",requestId:n};if(r.failKind==="unauthorized")return{type:"agent_unauthorized",reason:r.reason,authorizationUrl:r.data.authorize_url,requestId:n};if(r.failKind==="failedDependency")return{type:"agent_failed_dependency",reason:r.reason,requestId:n};if(r.failKind==="extensionBlocked"){let o=typeof r.data?.retryAfter=="number"?r.data.retryAfter:300;return{type:"extensionBlocked",reason:r.reason,requestId:n,retryAfter:o,learnMoreLink:r.data?.learnMoreLink??""}}return{type:"failed",reason:r.reason,requestId:n}}processError(r,n){let o=this.accessor.get(Ur);return o.isAbortError(r)?{type:"canceled",reason:"network request aborted",requestId:n}:kp(r)?{type:"canceled",reason:"Got a cancellation error",requestId:n}:(this.accessor.get(ce).defaultLogger.exception(r,"Error on conversation request"),this.accessor.get(me).sendGHTelemetryException(r,"Error on conversation request"),o.isDNSLookupFailedError(r)?{type:"failed",reason:"It appears you're not connected to the internet, please check your network connection and try again.",requestId:n}:o.isFetcherError(r)?{type:"failed",reason:o.getUserMessageForFetcherError(r),requestId:n}:{type:"failed",reason:"Error on conversation request. Check the log for more details.",requestId:n})}};jv=B([T(0,rt)],jv);function ort(t){return t.messages.length===0?{isValid:!1,reason:"No messages provided"}:t?.postOptions?.max_tokens&&t?.postOptions?.max_tokens<1?{isValid:!1,reason:"Invalid response token parameter"}:t.messages[t.messages.length-1].role!=="user"?{isValid:!1,reason:"Last message must be from user"}:{isValid:!0,reason:""}}var XF=se("IPromptVariablesService");var ZRe=W(require("path")),eke=W(require("vscode"));var ZF=W(ct());var JF=class extends Y{render(){return vscpp(vscppf,null,vscpp(ZF.SystemMessage,null,vscpp(SZ,null),vscpp(fi,null)),vscpp(ZF.UserMessage,null,vscpp(IZ,{templates:this.props.templates,features:this.props.features,filenames:this.props.filenames})))}},SZ=class extends Y{render(){return vscpp(vscppf,null,"You are an AI programming assistant.",vscpp("br",null),"You are helping a software developer to configure a Dev Container by picking a configuration template and features.")}},IZ=class extends Y{render(){return vscpp(vscppf,null,"This is a partial list of workspace files:",vscpp("br",null),this.props.filenames.map(e=>`- ${e}
`).join(""),vscpp("br",null),"Based on the workspace files, please suggest the best template from the list of templates below.",vscpp("br",null),"First identify the relevant files ignoring common files, then pick the best template and reply with the best template's id.",vscpp("br",null),"This is the list of available templates:",vscpp("br",null),this.props.templates.map(e=>`- ${e.id}: ${e.name||e.id}: ${e.description||e.name||e.id}
`).join(""),vscpp("br",null),"Also based on the workspace files, please suggest all relevant features from the list of features below.",vscpp("br",null),"First identify the relevant files ignoring common files, then pick all relevant features and reply with the relevant features' ids.",vscpp("br",null),"This is the list of available features:",vscpp("br",null),this.props.features.map(e=>`- ${e.id}: ${e.name||e.id}: ${e.description||e.name||e.id}
`).join(""),vscpp("br",null))}};var srt=["alpine","debian","docker-existing-docker-compose","docker-existing-dockerfile","docker-in-docker","docker-outside-of-docker","docker-outside-of-docker-compose","ubuntu","universal"].map(t=>`ghcr.io/devcontainers/templates/${t}`),art=["common-utils","git"].map(t=>`ghcr.io/devcontainers/features/${t}`),e9=class{constructor(e){this.accessor=e;this.telemetryService=e.get(me),this.logger=e.get(ce).getPromptResponseLogger("Dev Container Configuration Generator"),this.options=e.get($n)}async generate(e,r,n){if(!r.length)return{type:"success",template:void 0,features:[]};let o=Date.now(),s=await this.accessor.get(Le).getChatEndpoint("gpt-3.5-turbo"),a=Math.floor(s.modelMaxPromptTokens*4/3),c=this.processFilenames(r,a),u=e.templates.filter(g=>!srt.includes(g.id)),l=(e.features||[]).filter(g=>!art.includes(g.id)),p=await new Xe(s,JF,{filenames:c,templates:u,features:l},this.accessor.get(ve).acquireTokenizer(s.family),this.accessor).render(),f=Date.now(),m=await this.accessor.get(jt).fetchOne(p.messages,void 0,n,3,s,void 0,{temperature:this.options.temperature,top_p:this.options.topP},{messageSource:"command.generateDevContainerConfigPrompt"});this.logger.logResponse(m);let h=m.type==="success"?this.processGeneratedConfig(m.value,u,l):void 0;return this.telemetryService.sendMSFTTelemetryEvent("devcontainer.generateConfig",{model:s.model,requestId:m.requestId,responseType:m.type,templateId:h?.template,featureIds:h?.features.join(",")},{originalFilenameCount:r.length,originalFilenameLength:r.join("").length,processedFilenameCount:c.length,processedFilenameLength:c.join("").length,timeToRequest:f-o,timeToComplete:Date.now()-o}),{type:"success",template:h?.template,features:h?.features||[]}}processFilenames(e,r){let n=[...e],o=Math.floor(r*.9),s=n.join(`
`).length;if(s>o)for(;s>o&&n.length>0;){let a=n.pop();s-=a.length}return n}processGeneratedConfig(e,r,n){let o=r.find(s=>new RegExp(`\\b${c0(s.id)}\\b`).test(e))?.id;return o==="ghcr.io/devcontainers/templates/javascript-node"&&(o="ghcr.io/devcontainers/templates/typescript-node"),{template:o,features:n.filter(s=>new RegExp(`\\b${c0(s.id)}\\b`).test(e)).map(s=>s.id)}}};var fT=class{constructor(e){this.accessor=e}async generateConfiguration(e,r){if(r.isCancellationRequested)return{type:"cancelled"};let n=this.accessor.get(Aa),o=(await Promise.all(["*","*/*","*/*/*"].map(a=>n.findFilesWithDefaultExcludes(new eke.RelativePattern(e.rootUri,a),1e3,r)))).flat().map(a=>ZRe.posix.relative(e.rootUri.path,a.path));return new e9(this.accessor).generate(e.index,o,r)}};fT=B([T(0,rt)],fT);var sA=W(require("path")),ba=require("vscode");var Wb=W(ct());var t9=class extends Y{render(){return vscpp(vscppf,null,vscpp(Wb.SystemMessage,null,vscpp(CZ,null),vscpp(ir,null),vscpp(lr,null)),vscpp(Wb.UserMessage,{priority:700,name:"changes"},"# CODE CHANGES:",vscpp("br",null),this.props.diff.map(e=>vscpp(Oe,{uri:null,code:e}))),this.props.recentCommitMessages.user.length>0&&vscpp(Wb.UserMessage,{priority:600,name:"user-commits"},"# RECENT USER COMMITS:",vscpp("br",null),this.props.recentCommitMessages.user.map(e=>vscpp(Oe,{uri:null,languageId:"text",code:e}))),this.props.recentCommitMessages.repository.length>0&&vscpp(Wb.UserMessage,{priority:500,name:"recent-commits"},"# RECENT REPOSITORY COMMITS:",vscpp("br",null),this.props.recentCommitMessages.repository.map(e=>vscpp(Oe,{uri:null,languageId:"text",code:e}))),vscpp(Wb.UserMessage,null,"Remember to ONLY return a single markdown ```text code block with the suggested commit message. NO OTHER PROSE! If you write more than the commit message, your commit message gets lost.",vscpp("br",null),"Example:",vscpp("br",null),vscpp(Oe,{uri:null,languageId:"text",code:"commit message goes here"})))}},CZ=class extends Y{render(){return vscpp(vscppf,null,"You are an AI programming assistant, helping a software developer to come with the best git commit message for their code changes.",vscpp("br",null),"You excel in interpreting the purpose behind code changes to craft succinct, clear commit messages that adhere to the repository's guidelines.",vscpp("br",null),"# Examples of commit messages:",vscpp("br",null),vscpp(Oe,{uri:null,languageId:"text",code:"feat: improve page load with lazy loading for images"}),vscpp(Oe,{uri:null,languageId:"text",code:"Fix bug preventing submitting the signup form"}),vscpp(Oe,{uri:null,languageId:"text",code:"chore: update npm dependency to latest stable version"}),vscpp(Oe,{uri:null,languageId:"text",code:"Update landing page banner color per client request"}),vscpp("br",null),vscpp("br",null),"# First, think step-by-step:",vscpp("br",null),"1. Analyze the CODE CHANGES thoroughly to understand what's been modified.",vscpp("br",null),"2. Identify the purpose of the changes to answer the *why* for the commit messages, also considering the optionally provided RECENT USER COMMITS.",vscpp("br",null),"3. Review the provided RECENT REPOSITORY COMMITS to identify established commit message conventions. Focus on the format and style, ignoring commit-specific details like refs, tags, and authors.",vscpp("br",null),"4. Generate a thoughtful and succinct commit message for the given CODE CHANGES. It MUST follow the the established writing conventions. 5. Remove any meta information like issue references, tags, or author names from the commit message. The developer will add them.",vscpp("br",null),"6. Now only show your message, wrapped with a single markdown ```text codeblock! Do not provide any explanations or details",vscpp("br",null))}};var r9=class{constructor(e){this.accessor=e;this.telemetryService=e.get(me),this.logger=e.get(ce).getPromptResponseLogger("git commit message generator"),this.options=e.get($n)}async generateGitCommitMessage(e,r,n,o){let s=Date.now(),a=await this.accessor.get(Le).getChatEndpoint("gpt-3.5-turbo"),c=Math.floor(a.modelMaxPromptTokens*4/3),u=this.processDiff(e,c),d=await new Xe(a,t9,{diff:u,recentCommitMessages:r},this.accessor.get(ve).acquireTokenizer(a.family),this.accessor).render(void 0,void 0),p=Math.min(this.options.temperature*(1+n),2),f=Date.now(),m=await this.accessor.get(jt).fetchOne(d.messages,void 0,o,3,a,{agent:"git-commit"},{temperature:p,top_p:this.options.topP},{messageSource:"command.generateGitCommitMessagePrompt"});if(this.logger.logResponse(m),this.telemetryService.sendMSFTTelemetryEvent("git.generateCommitMessage",{model:a.model,requestId:m.requestId,responseType:m.type},{attemptCount:n+1,originalDiffFileCount:e.length,originalDiffLength:e.join("").length,processedDiffFileCount:u.length,processedDiffLength:u.join("").length,timeToRequest:f-s,timeToComplete:Date.now()-s}),m.type!=="success")return;let[h,g]=this.processGeneratedCommitMessage(m.value);return h!=="oneTextCodeBlock"&&this.telemetryService.sendMSFTTelemetryEvent("git.generateCommitMessageIncorrectResponseFormat",{requestId:m.requestId,responseFormat:h}),g}processDiff(e,r){let n=[...e],o=r-Math.floor(r*.2),s=n.join(`

`).length;if(s>o)for(n.sort((a,c)=>a.length-c.length);s>o&&n.length>0;){let a=n.pop();s-=a.length}return n}processGeneratedCommitMessage(e){let n=/^```text\s*([\s\S]+?)\s*```$/m.exec(e);return n===null?["noTextCodeBlock",e]:n.length!==2?["multipleTextCodeBlocks",e]:["oneTextCodeBlock",n[1]]}};var mT=class{constructor(e){this.accessor=e;this._commitMessages=new Map;this._disposables=new Nt;this._repositoryDisposables=new m_;this._logger=e.get(ce).getLogger("GitCommitMessageService");let r=()=>{this._disposables.add(this._gitExtensionApi.onDidOpenRepository(this._onDidOpenRepository,this)),this._disposables.add(this._gitExtensionApi.onDidCloseRepository(this._onDidCloseRepository,this));for(let o of this._gitExtensionApi.repositories)this._onDidOpenRepository(o)},n=this.accessor.get(ka);this._gitExtensionApi=n.getExtensionApi(),this._gitExtensionApi?r():this._disposables.add(n.onDidChange(o=>{o.enabled&&(this._gitExtensionApi=n.getExtensionApi(),r())}))}async generateCommitMessage(e,r=Fr.None){if(!r.isCancellationRequested)return ba.window.withProgress({location:ba.ProgressLocation.SourceControl},async()=>{let n=await this._getChanges(e);if(this._logger.info(`Changes (before context exclusion): ${n.length} file(s)`),n.length===0){ba.window.showInformationMessage(ba.l10n.t("Cannot generate a commit message because there are no changes."));return}let o=await this._applyContentExclusion(n);if(this._logger.info(`Changes (after context exclusion): ${o.length} file(s)`),o.length===0){ba.window.showInformationMessage(ba.l10n.t("Cannot generate a commit message because the changes were excluded from the context due to content exclusion rules."));return}let s=this._getAttemptCount(e,o),a=await this._getRecentCommitMessages(e),u=await new r9(this.accessor).generateGitCommitMessage(o,a,s,r);if(u&&e.state.HEAD&&e.state.HEAD.commit){let l=this._commitMessages.get(e.rootUri.toString())??new Map;l.set(e.state.HEAD.commit,{attemptCount:s,changes:o,message:u}),this._commitMessages.set(e.rootUri.toString(),l)}return u})}getRepository(e){return this._gitExtensionApi?this._gitExtensionApi.repositories.length===1?this._gitExtensionApi.repositories[0]:(e=e??ba.window.activeTextEditor?.document.uri,e?this._gitExtensionApi.getRepository(e):null):null}async _applyContentExclusion(e){let r=[],n=this.accessor.get(De);for(let o of e){if(o.originalUri===void 0&&o.modifiedUri===void 0){this._logger.info("Ignoring change due to missing originalUri and modifiedUri.");continue}if(o.originalUri&&await n.isCopilotIgnored(o.originalUri)){this._logger.info(`Ignoring change due to content exclusion rule based on originalUri: ${o.originalUri.toString()}`);continue}if(o.modifiedUri&&o.modifiedUri!==o.originalUri&&await n.isCopilotIgnored(o.modifiedUri)){this._logger.info(`Ignoring change due to content exclusion rule based on modifiedUri: ${o.modifiedUri.toString()}`);continue}r.push(o.diff)}return r}_getAttemptCount(e,r){let o=this._commitMessages.get(e.rootUri.toString())?.get(e.state.HEAD?.commit??"");if(!o||o.changes.length!==r.length)return 0;for(let s=0;s<r.length;s++)if(o.changes[s]!==r[s])return 0;return o.attemptCount+1}async _getChanges(e){let r=await e.diff(!0);if(r!=="")return this._parseGitDiff(e,r);let n=await e.diff(),o=this._parseGitDiff(e,n);return o.push(...await this._getUntrackedChanges(e)),o}async _getRecentCommitMessages(e){let r=[],n=[];try{let o=await e.log({maxEntries:10});r.push(...o.map(c=>c.message));let s=await e.getConfig("user.name")??await e.getGlobalConfig("user.name"),a=await e.log({maxEntries:10,author:s});n.push(...a.map(c=>c.message))}catch{}return{repository:r,user:n}}async _getUntrackedChanges(e){let r=[];for(let n of e.state.workingTreeChanges.filter(o=>o.status===7))r.push({modifiedUri:n.uri,diff:await this._getUntrackedChangePatch(e,n.uri)});for(let n of e.state.untrackedChanges??[])r.push({modifiedUri:n.uri,diff:await this._getUntrackedChangePatch(e,n.uri)});return r}async _getUntrackedChangePatch(e,r){this._logger.info(`Generating patch file for untracked file: ${r.toString()}`);let n=[];try{let o=await ba.workspace.fs.readFile(r),s=sA.relative(e.rootUri.fsPath,r.fsPath);n.push(`diff --git a/${s} b/${s}`),n.push("--- /dev/null",`+++ b/${s}`),n.push(`@@ -0,0 +1,${o.length} @@`),n.push(...o.toString().split(`
`).map(a=>`+${a}`))}catch(o){this._logger.error(`Failed to generate patch file for untracked file: ${r.toString()}`,o)}return n.join(`
`)}_parseGitDiff(e,r){let n=[],o=u=>{let l=/^---\s(.*)\n\+\+\+\s(.*)$/m.exec(u);if(!l||l.length!==3)return{originalUri:void 0,modifiedUri:void 0};let d=l[1]==="/dev/null"?void 0:ba.Uri.file(sA.join(e.rootUri.fsPath,l[1].substring(2))),p=l[2]==="/dev/null"?void 0:ba.Uri.file(sA.join(e.rootUri.fsPath,l[2].substring(2)));return{originalUri:d,modifiedUri:p}},s=0,a,c=/^diff --git a\/(.+?) b\/(.+?)$/gm;do{if(a=c.exec(r),a===null)break;if(s<a.index){let u=r.substring(s,a.index),{originalUri:l,modifiedUri:d}=o(u);n.push({diff:u,originalUri:l,modifiedUri:d})}s=a.index}while(!0);if(s<r.length){let u=r.substring(s),{originalUri:l,modifiedUri:d}=o(u);n.push({diff:u,originalUri:l,modifiedUri:d})}return n}_onDidOpenRepository(e){typeof e.onDidCommit!==void 0&&this._repositoryDisposables.set(e,e.onDidCommit(()=>this._onDidCommit(e),this))}_onDidCloseRepository(e){this._repositoryDisposables.deleteAndDispose(e),this._commitMessages.delete(e.rootUri.toString())}async _onDidCommit(e){let r=e.state.HEAD;if(!r?.commit)return;let n=this._commitMessages.get(e.rootUri.toString());if(!n)return;let o=await e.getCommit(r.commit),s=o.parents.length>0?o.parents[0]:"",a=n.get(s);if(!a)return;let c=S2(o.message,a.message);this.accessor.get(me).sendMSFTTelemetryEvent("git.generateCommitMessageSurvival",void 0,{attemptCount:a.attemptCount,survivalRateFourGram:c}),n.delete(s),this._commitMessages.set(e.rootUri.toString(),n)}dispose(){this._repositoryDisposables.dispose(),this._disposables.dispose()}};mT=B([T(0,rt)],mT);var tke=require("vscode");var zv=se("ChatVariableService"),hT=class{constructor(e){this._variableEnablements=e.getConfigMixedWithDefaults(ge.ConversationVariablesEnablements)}isVariableEnabled(e){return typeof this._variableEnablements[e.name]=="boolean"?this._variableEnablements[e.name]:typeof e.defaultEnablement=="boolean"?e.defaultEnablement:!!this._variableEnablements["*"]}getVariables(){let e=[];for(let r of en.contextResolvers)r.variableInfo&&this.isVariableEnabled(r.variableInfo)&&e.push({name:r.variableInfo.name,fullName:r.variableInfo.fullName,icon:r.variableInfo.icon,kind:r.kind,description:r.variableInfo.description,resolve:r.resolveContext.bind(r)});return e}getVariable(e){return this.getVariables().find(r=>r.name===e)}};hT=B([T(0,be)],hT);var gT=class{constructor(e,r){this._chatVariableService=e,this._fsService=r}async resolveVariablesInPrompt(e,r){let n=[];for(let o of r){let s=o.value;if(s instanceof tke.Uri){let c=(await this._fsService.readFile(s)).toString().replace(/\r/g,"");s=ki("",c)}let a=this._chatVariableService.getVariable(o.name);n.push({kind:a?.kind??"variable",userMessages:[crt(o.name)+s]}),o.range&&(e=e.slice(0,o.range[0])+`[#${o.name}](#${o.name}-context)`+e.slice(o.range[1]))}return{parts:n,message:e}}};gT=B([T(0,zv),T(1,on)],gT);function crt(t){return`# ${t.toUpperCase()} CONTEXT
`}var urt=[];function vT(t){return{create(e){return e.get(or).createInstance(t)}}}var rke=urt;var OZ={};dn(OZ,{create:()=>drt});var TZ=W(Tr());var aA=class{constructor(e){this.kind="workspace";let r,n,o,s;e.getConfig(ge.WorkspaceUseFilesVariable)?(r="files",n=TZ.t("Searches through the files in the workspace and pulls out relevant information for the query.")):(r="codebase",o="Codebase",s="folder",n=TZ.t("Searches through the codebase and pulls out relevant information for the query.")),this.variableInfo={name:r,fullName:o,icon:s,description:n,defaultEnablement:lc||void 0}}async resolveContext(e,r,n,o){if(!r.message)return;let{messages:s,references:a,usedContext:c}=await _s(e,r.endpoint,RC,{chatVariables:[],conversation:r.conversation??new Pc,query:this.turnQueryIntoWorkspaceQuery(r.message),include:{workspaceChunks:!0}},e.get(ve).acquireTokenizer(r.endpoint.family),o,n);if(s.length>0)return{kind:this.kind,userMessages:s.map(u=>u.content),usedContext:c,references:a}}turnQueryIntoWorkspaceQuery(e){let r=e;return r.startsWith("@")&&(r=r.replace(/@\w+\s*/,"")),r=r.replaceAll(/\#files/gi,"files"),r}};aA=B([T(0,be)],aA);en.register(aA);var lrt=require("path"),EZ=class{constructor(){this.kind="current-editor";this.variableInfo={name:"editor",description:"The visible source code in the active editor",defaultEnablement:!0};this.metaContextResolverInfo={description:"Source code in the active document."}}async resolveContext(e,r){let n=e.get(Tt).activeTextEditor,o=n?.visibleRanges[0];if(o){let s="";n.selection.isSingleLine&&(s=`The cursor is on line: ${n.selection.start.line}`);let a=[`Excerpt from active file ${lrt.basename(n.document.uri.path)}, lines ${o.start.line+1} to ${o.end.line+1}:`,ki(n.document.languageId,n.document.getText(o),!1),"",s].join(`
`),c=[{uri:n.document.uri,version:n.document.version,ranges:[o]}];return{kind:this.kind,userMessages:[a],usedContext:c,references:[new Eo.PromptReference({uri:n.document.uri,range:o})]}}}},BDr=en.register(new EZ);var wZ=class{constructor(){this.kind="current-selection-implementations";this.metaContextResolverInfo={description:"Relevant implementations referenced in active selection."}}async resolveContext(e,r,n,o){let{references:s,messages:a,usedContext:c}=await _s(e,r.endpoint,Nu,{},e.get(ve).acquireTokenizer(r.endpoint.family));return{kind:this.kind,references:s,userMessages:a.map(u=>u.content),usedContext:c}}},$Dr=en.register(new wZ);var RZ=class{constructor(){this.kind="debug-console-output";this.variableInfo={name:"debugConsole",description:"The output in the debug console",defaultEnablement:!1};this.metaContextResolverInfo={description:"Debug console output."}}async resolveContext(e){return{kind:this.kind,userMessages:[`Debug console output:
`+e.get(z_).consoleOutput]}}},XDr=en.register(new RZ);var kZ=class{constructor(){this.kind="diagnostics";this.metaContextResolverInfo={description:"Diagnostics in the active editor."}}async resolveContext(e,r,n){let o=r.documentContext;if(!o)return;let s=Uv(e.get(ho),o.document.uri,o.selection,r.message),{messages:a,usedContext:c}=await _s(e,r.endpoint,hp,{documentContext:o,diagnostics:s},e.get(ve).acquireTokenizer(r.endpoint.family));return{kind:this.kind,userMessages:a.map(u=>u.content),usedContext:c}}},sNr=en.register(new kZ);var nke=W(require("path"));var AZ=class{constructor(){this.kind="git-metadata";this.variableInfo={name:"git",description:"Information about the current git repository",defaultEnablement:!1};this.metaContextResolverInfo={description:"Metadata about the current git repository."}}async resolveContext(e,r,n){let o=e.get(Ze),a=e.get(Fo).repositories,c=o.getWorkspaceFolders();if(a.length===0||!c)return;if(c.length>1){let l=r.documentContext?.document.uri??e.get(Tt).activeTextEditor?.document.uri;if(l){let d=o.getWorkspaceFolder(l);if(d){let p=c.findIndex(f=>f.toString()===d.toString());p!==-1&&(a=[a[p]],c=[c[p]])}}}let u=[];for(let l=0;l<a.length;l++){if(n.isCancellationRequested)return;let d=a[l],p=c[l];if(!d)continue;let f=[];f.push(`Workspace Folder: ${nke.basename(p.path)}`),f.push("```"),d.headBranchName?(f.push(`Current Branch name: ${d.headBranchName}`),f.push(`Upstream: ${d.upstreamBranchName?d.upstreamBranchName:"none"}`)):f.push("Detached HEAD?: yes"),f.push(`Is currently rebasing?: ${d.isRebasing?"yes":"no"}`),f.push(`Remotes: ${(d.remotes??[]).join(", ")}`),f.push("```"),u.push(f.join(`
`))}return{kind:this.kind,userMessages:[`Metadata about the current git repository:
`+u.join(`
`)]}}},fNr=en.register(new AZ);var PZ=class{constructor(){this.kind="terminal-buffer";this.variableInfo={name:"terminalBuffer",description:"The active terminal's buffer",defaultEnablement:!1};this.metaContextResolverInfo={description:"The active terminal's buffer."}}async resolveContext(e){let r=e.get(lo).terminalBuffer;return{kind:this.kind,userMessages:[`The active terminal's buffer:
`+r]}}},yNr=en.register(new PZ);var DZ=class{constructor(){this.kind="terminal-last-command";this.variableInfo={name:"terminalLastCommand",description:"The active terminal's last run command",defaultEnablement:!0};this.metaContextResolverInfo={description:"The active terminal's last run command."}}async resolveContext(e){let r=e.get(lo).terminalLastCommand;if(!r)return;let n=[];r.commandLine&&(n.push("The following is the last command run in the terminal:"),n.push(r.commandLine)),r.cwd&&(n.push("It was run in the directory:"),n.push(typeof r.cwd=="object"?r.cwd.toString():r.cwd)),r.output&&(n.push("It has the following output:"),n.push(r.output));let o=n.join(`
`);return{kind:this.kind,userMessages:[`The active terminal's last run command:
`+o]}}},INr=en.register(new DZ);var NZ=class{constructor(){this.kind="terminal-selection";this.variableInfo={name:"terminalSelection",icon:"terminal",fullName:"Terminal Selection",description:"The active terminal's selection",defaultEnablement:!0};this.metaContextResolverInfo={description:"The active terminal's selection."}}async resolveContext(e){let r=e.get(lo).terminalSelection;return{kind:this.kind,userMessages:[`The active terminal's selection:
`+r]}}},RNr=en.register(new NZ);var LZ=class{constructor(){this.kind="terminal-shell-type"}async resolveContext(e){let r=e.get(lo).terminalShellType;return{kind:this.kind,userMessages:[`The active terminal's shell type:
`+r]}}},NNr=en.register(new LZ);function drt(){}var MZ={};dn(MZ,{create:()=>prt});function prt(t){let e=new Nt;return e.add(en.initialize(t.get(or))),e}var FZ={};dn(FZ,{create:()=>frt});async function frt(t){await t.get(Ze).ensureWorkspaceIsFullyLoaded()}var mrt=[...rke,FZ,OZ,MZ],ike=mrt;var HZ={};dn(HZ,{create:()=>hrt});var yT=require("vscode");var ic=require("vscode");async function n9(t,e,r){let n=t?.repositories;if(!n)return r.debug("No git repositories found"),!1;let o=n.map($_).filter(a=>a);return(await Promise.all(o.map(a=>{let[c,u]=a.split("/");return e.isAvailable(c,u)}))).every(a=>a)}var oke="github.copilotChat.signIn",ske="github.copilotChat.signInGHE",ake="github.copilotChat.signInChoose";async function cke(t,e){let r=t.get(Fo),n=t.get(zc),o=t.get(fn),s=t.get(ce).getLogger("authSignInCommand");if(await n9(r,n,s)){await o.getAnyGitHubSession(e?{forceNewSession:!0}:{createIfNone:!0});return}await o.getPermissiveGitHubSession({forceNewSession:{learnMore:lt.parse("https://aka.ms/copilotRepoScope")}})}async function UZ(t,e){let r=t.get(be);if(r.getConfig(ge.AuthProvider)!=="github")try{await r.setConfig(ge.AuthProvider,"github")}catch(o){console.error(o)}await cke(t,e)}async function BZ(t,e){let r=t.get(be);if(r.getConfig(ge.AuthProvider)!=="github-enterprise")try{await r.setConfig(ge.AuthProvider,"github-enterprise")}catch(a){console.error(a)}let o=ic.workspace.getConfiguration("github-enterprise");if(!o.get("uri")){let a=!1,c=await ic.window.showInputBox({prompt:"What is your GHE.com instance?",placeHolder:'i.e. "octocat" or "https://octocat.ghe.com"...',validateInput(l){if(a=!1,!!l){if(/^[a-zA-Z\-_]+$/.test(l))return a=!0,{message:`Will resolve to https://${l}.ghe.com`,severity:ic.InputBoxValidationSeverity.Info};if(!/^(https:\/\/)?([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+\.ghe\.com$/.test(l))return{message:'Please enter a valid GHE.com instance (i.e. "octocat" or "https://octocat.ghe.com")',severity:ic.InputBoxValidationSeverity.Error}}}});if(!c)return;let u=c;a?u=`https://${u}.ghe.com`:c.toLowerCase().startsWith("https://")||(u="https://"+c),await o.update("uri",u,ic.ConfigurationTarget.Global)}await cke(t,e)}async function uke(t,e){let r=await ic.window.showQuickPick([{label:ic.l10n.t("Sign in to GitHub.com"),providerId:"github"},{label:ic.l10n.t("Sign in to GHE.com"),providerId:"github-enterprise"}],{placeHolder:ic.l10n.t("Sign in to...")});r&&(r.providerId==="github"?await UZ(t,e):await BZ(t,e))}var i9=require("vscode");async function lke(t){let e=new qZ(t);return await e.run(),e}var qZ=class{constructor(e){this.accessor=e;this.authenticationService=this.accessor.get(fn);this.logger=this.accessor.get(ce).getLogger("auth");this.ghRepoService=this.accessor.get(zc);this.gitService=this.accessor.safeGet(Fo);this.vscodeExtensionContext=this.accessor.get(zt);this.disposables=new Nt}async run(){await this.waitForChatEnabled(),!(!this.gitService||await n9(this.gitService,this.ghRepoService,this.logger)||(this.registerListeners(),await this.authenticationService.getPermissiveGitHubSession({silent:!0})))&&await this.showPrompt()}async waitForChatEnabled(){try{if((await this.authenticationService.getCopilotToken()).isChatEnabled())return}catch(e){this.logger.debug("Failed to get copilot token",e)}await Vu.toPromise(Vu.filter(this.authenticationService.onDidAuthenticationChange,()=>this.authenticationService.copilotToken?.isChatEnabled()??!1))}registerListeners(){this.disposables.add(this.authenticationService.onDidAuthenticationChange(async()=>{if(!this.authenticationService.permissiveGitHubSession)if(this.authenticationService.anyGitHubSession)await this.showPrompt();else{this.vscodeExtensionContext.globalState.update("copilot.shownPermissiveTokenModal",!1);return}}))}async showPrompt(){try{let e=this.vscodeExtensionContext.globalState.get("copilot.shownPermissiveTokenModal",!1),r={};e||(r.forceNewSession={detail:i9.l10n.t("To show you more relevant Copilot Chat results, we need permission to read the contents of your repository on GitHub."),learnMore:i9.Uri.parse("https://aka.ms/copilotRepoScope")},this.vscodeExtensionContext.globalState.update("copilot.shownPermissiveTokenModal",!0)),await this.authenticationService.getPermissiveGitHubSession(r)&&this.logger.debug("Got permissive GitHub token")}catch(e){this.logger.debug("Failed to get permissive GitHub token",e),await this.authenticationService.getPermissiveGitHubSession({})}}dispose(){this.disposables.dispose()}};async function hrt(t){let e=t.get(rt);return yT.Disposable.from(yT.commands.registerCommand(oke,r=>UZ(e,r)),yT.commands.registerCommand(ske,r=>BZ(e,r)),yT.commands.registerCommand(ake,r=>uke(e,r)),await lke(e))}var $Z={};dn($Z,{create:()=>brt});var bn=W(require("vscode"));var GZ="vscode-chat-code-block",VZ="vscode-copilot-chat-code-block",grt=[/^\n```(typescript|javascript)\S*\nany\n```\n$/i],cA=class{constructor(e,r){this.parserService=e;this.telemetryService=r}async provideDefinition(e,r,n){return this.goTo("vscode.executeDefinitionProvider",e,r,n)}async provideImplementation(e,r,n){return this.goTo("vscode.executeImplementationProvider",e,r,n)}async provideTypeDefinition(e,r,n){return this.goTo("vscode.executeTypeDefinitionProvider",e,r,n)}async provideHover(e,r,n){let o=uA(e.uri);if(!o)return;let s=await this.execHover(o,r),a=this.filterOutGenericHovers(s);if(a?.length)return this.convertHover(a);if(n.isCancellationRequested)return;let c=await this.getReferencesContext(e,r,n);if(!(!c||n.isCancellationRequested)){for(let u of c.wordMatches){let l=await this.execHover(u.uri,u.range.start);if(n.isCancellationRequested)return;if(l?.length)return this.convertHover(l)}return this.convertHover(s)}}async execHover(e,r){return bn.commands.executeCommand("vscode.executeHoverProvider",e,r)}convertHover(e){return e.length?new bn.Hover(e.flatMap(r=>r.contents),e[0].range):void 0}filterOutGenericHovers(e){return e.filter(r=>r.contents.some(n=>{if(typeof n=="string")return n.length;if(!n.value.length)return!1;for(let o of grt)if(o.test(n.value))return!1;return!0}))}async goTo(e,r,n,o){this.telemetryService.sendMSFTTelemetryEvent("codeBlock.action.goTo",{languageId:r.languageId,command:e});let s=await this.executeGoToInChatBlocks(e,r,n);if(s?.length)return s;if(!o.isCancellationRequested)return this.executeGoToInChatReferences(e,r,n,o)}async executeGoToInChatBlocks(e,r,n){let o=uA(r.uri);return o?(await this.executeGoTo(e,o,n))?.map(a=>"uri"in a?{targetRange:a.range,targetUri:jZ(a.uri)??a.uri}:{...a,targetUri:jZ(a.targetUri)??a.targetUri}):void 0}async executeGoTo(e,r,n){return bn.commands.executeCommand(e,r,n)}async executeGoToInChatReferences(e,r,n,o){let s=await this.getReferencesContext(r,n,o);if(!(!s||o.isCancellationRequested))for(let a of s.wordMatches){let c=await this.executeGoTo(e,a.uri,a.range.start);if(o.isCancellationRequested)return;if(c)return c.map(u=>"uri"in u?{targetRange:u.range,targetUri:u.uri,originSelectionRange:s.wordRange}:{targetSelectionRange:u.targetSelectionRange,targetRange:u.targetRange,targetUri:u.targetUri,originSelectionRange:s.wordRange})}}async getReferencesContext(e,r,n){let o=this.getReferences(e);if(!o?.length)return;let s=e.getWordRangeAtPosition(r);if(!s)return;let a=e.getText(s),c=await this.findWordInReferences(a,o,n);return{wordRange:s,wordMatches:c}}getReferences(e){try{let r=decodeURIComponent(e.uri.fragment);return JSON.parse(r).references.map(o=>"range"in o?new Eo.PromptReference(new yi(pn.from(o.uri),new ze(o.range.startLineNumber-1,o.range.startColumn-1,o.range.endLineNumber-1,o.range.endColumn-1))):new Eo.PromptReference(pn.from(o.uri)))}catch{return[]}}async findWordInReferences(e,r,n){return Kt(await Promise.all(r.map(o=>{if(u0(o.anchor))return this.findWordInDoc(e,o.anchor,new bn.Range(0,0,Number.MAX_SAFE_INTEGER,0),n);if("uri"in o.anchor)return this.findWordInDoc(e,o.anchor.uri,o.anchor.range,n)})))}async findWordInDoc(e,r,n,o){let s=await bn.workspace.openTextDocument(r);if(o.isCancellationRequested)return;let a=await this.getSymbolsInRange(s,n,o);if(o.isCancellationRequested)return;for(let l of a)if(l.identifier===e){let d=s.positionAt(l.startIndex);return new bn.Location(r,d)}let c=s.getText(n),u=s.offsetAt(n.start);for(let l of c.matchAll(new RegExp(vrt(e),"g")))if(l.index){let d=s.positionAt(u+l.index),p=s.getText(s.getWordRangeAtPosition(d));if(e===p)return new bn.Location(r,d)}}async getSymbolsInRange(e,r,n){let o=this.parserService.getTreeSitterAST(e);return o?o.getSymbols({startIndex:e.offsetAt(r.start),endIndex:e.offsetAt(r.end)}):[]}};cA=B([T(0,_t),T(1,me)],cA);function vrt(t){return t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}function uA(t){return t.scheme===GZ?t.with({scheme:VZ}):void 0}function jZ(t){return t.scheme===VZ?t.with({scheme:GZ}):void 0}var zZ=class extends St{constructor(){super();this._onDidChange=this._register(new Qre);this.onDidChange=this._onDidChange.event;this._register(bn.workspace.registerTextDocumentContentProvider(VZ,this)),bn.workspace.textDocuments.forEach(r),this._register(bn.workspace.onDidOpenTextDocument(r)),this._register(bn.workspace.onDidChangeTextDocument(n=>{let o=uA(n.document.uri);o&&this._onDidChange.fire(o)})),this._register(bn.workspace.onDidCloseTextDocument(n=>{let o=uA(n.uri);o&&this._onDidChange.fire(o)}));async function r(n){let o=uA(n.uri);if(!o)return;let s=await bn.workspace.openTextDocument(o);await bn.languages.setTextDocumentLanguage(s,n.languageId)}}provideTextDocumentContent(r,n){let o=jZ(r);return o?bn.workspace.textDocuments.find(a=>a.uri.toString()===o.toString())?.getText():void 0}};function dke(t){let e=t.get(or).createInstance(cA),r={scheme:GZ,exclusive:!0};return bn.Disposable.from(new zZ,bn.languages.registerDefinitionProvider(r,e),bn.languages.registerTypeDefinitionProvider(r,e),bn.languages.registerImplementationProvider(r,e),bn.languages.registerHoverProvider(r,e))}async function brt(t){return dke(t)}var WZ={};dn(WZ,{create:()=>_rt});var Oc=require("vscode");function _rt(t){let e=t.get(Le),r=t.get(zv),n=t.get(rt),o=new Nt;for(let s of r.getVariables())o.add(Oc.chat.registerChatVariableResolver(`copilot.${s.name}`,s.name,s.description??"",void 0,s.name==="codebase",{async resolve(a,c,u){return[]},resolve2:async(a,c,u,l)=>{let d={endpoint:await e.getChatEndpoint("gpt-3.5-turbo"),message:c.prompt},p={report(m){u.push(m)}},f=await s.resolve(n,d,l,p);return f?(f.references?.forEach(m=>{"variableName"in m.anchor||u.reference(m.anchor)}),[{level:Oc.ChatVariableLevel.Full,value:f.userMessages.join(`

`),description:""}]):[]}},s.fullName,s.icon?new Oc.ThemeIcon(s.icon):void 0));return o.add(xrt(t)),o}function xrt(t){return Oc.Disposable.from(Oc.commands.registerCommand("github.copilot.chat.attachSelection",()=>{Oc.commands.executeCommand("workbench.action.chat.attachSelection")}),Oc.commands.registerCommand("github.copilot.chat.attachFile",()=>{Oc.commands.executeCommand("workbench.action.chat.attachFile")}))}var o9=require("vscode");var Kb={Activated:"github.copilot-chat.activated",Offline:"github.copilot.offline",IndividualDisabled:"github.copilot.interactiveSession.individual.disabled",IndividualExpired:"github.copilot.interactiveSession.individual.expired",ContactSupport:"github.copilot.interactiveSession.contactSupport",EnterpriseDisabled:"github.copilot.interactiveSession.enterprise.disabled"},bT=class extends St{constructor(r,n,o,s){super();this._authenticationService=r;this._telemetryService=n;this._fetcherService=o;this._logger=s.getLogger("ContextKeysContribution"),this._inspectContext().catch(console.error),this._register(r.onDidAuthenticationChange(async()=>await this._inspectContext())),this._register(o9.commands.registerCommand("github.copilot.offline",async()=>await this._inspectContext()))}async _inspectContext(){let r=Object.values(Kb),n,o;try{await this._authenticationService.getCopilotToken(),o=Kb.Activated}catch(s){n=s;let a=s.message||s,c=Vn.createAndMarkAsIssued({reason:a});this._telemetryService.sendGHTelemetryErrorEvent("activationFailed",c.properties,c.measurements);let u=a==="GitHubLoginFailed"?sne:`GitHub Copilot could not connect to server. Extension activation failed: "${a}"`;this._logger.error(u)}this._fetcherService.isDNSLookupFailedError(n)?o=Kb.Offline:n instanceof IE?o=Kb.IndividualDisabled:n instanceof CE?o=Kb.IndividualExpired:n instanceof EE?o=Kb.EnterpriseDisabled:n instanceof TE&&(o=Kb.ContactSupport),o&&o9.commands.executeCommand("setContext",o,!0);for(let s of r)s!==o&&o9.commands.executeCommand("setContext",s,!1)}};bT=B([T(0,fn),T(1,me),T(2,Ur),T(3,ce)],bT);var hke=require("crypto"),QZ=W(require("path")),a9=W(require("util")),ft=require("vscode");async function pke(t,e){let n=(await t.get(Nn).getCopilotToken()).isInternal?t.get(be).getConfig(ge.DebugOverrideChatMaxTokenNum):0,o=-3;if(n>0)return o+=n,o;switch(e){case"gpt-3.5-turbo":o+=7168;break;case"gpt-4":o+=3072;break;default:o+=3072}return o}async function Srt(t,e,r,n,o,s,a){let u=(await QF.create(e,t,n,r,a)).processSSE(o);return Oo.map(u,d=>{let p=d.reason??"client-trimmed",f=s.extendedBy({completionChoiceFinishReason:p});return t.sendGHTelemetryEvent("completion.finishReason",f.properties,f.measurements),QRe(t,e,d,s)})}var _T=class{constructor(e,r,n,o){this.url=e;this.disableSnippy=o;this._maxTokens=n,this.model=r.id,this.name=r.name,this.version=r.version,this.family=r.capabilities.family}get modelMaxPromptTokens(){return this._maxTokens}interceptBody(e){e&&this.disableSnippy&&(e.snippy={enabled:!1},Object.keys(e).forEach(r=>{r.startsWith("intent")&&delete e[r]}))}getExtraHeaders(){let e={};return this.disableSnippy&&(e["Editor-Plugin-Version"]="simulation-tests-plugin/2",e["Editor-Version"]="simulation-tests-editor/1.85"),e}async processResponseFromChatEndpoint(e,r,n,o,s,a,c){return Srt(e,r,n,o,s,a,c)}};var xT=new Map,lA=class{constructor(e){this.label=e;this.iconPath=new ft.ThemeIcon("lock")}},KZ="github",s9="platform",fke={web:"bing-search",kb:"kb-search"},YZ="kb:",mke="github.copilot.chat.selectKnowledgeBase",ST=class{constructor(e,r,n,o,s,a,c,u,l,d,p,f,m,h){this.logService=e;this.fetcherService=r;this.envService=n;this.promptVariablesService=o;this.workspaceService=s;this.tabsAndEditorsService=a;this.ignoreService=c;this.gitService=u;this.githubRepositoryService=l;this.chatMLFetcher=d;this.telemetryService=p;this.vscodeExtensionContext=f;this.authenticationService=m;this.domainService=h;this.disposables=new Nt;this.knowledgeBases=null;this.organizationsMissingSSO=!1;this.logger=this.logService.getLogger("RemoteAgents");this.disposables.add(new ft.Disposable(()=>xT.forEach(g=>g.dispose()))),this.disposables.add(ft.commands.registerCommand(mke,async()=>{let g=ft.window.createQuickPick();g.placeholder=ft.l10n.t("Select a knowledge base"),g.busy=!0,g.show(),g.items=await this.getKnowledgeBaseAutocompleteQuickPickItems(),g.busy=!1;let v=await new Promise((y,_)=>{g.canSelectMany=!1;let b=!1;g.onDidAccept(async()=>{if(g.selectedItems[0]instanceof lA){g.busy=!0;let S=await this.authenticationService.getPermissiveGitHubSession({forceNewSession:!0});if(!S){this.logger.error("Failed to get a new auth session for knowledge base selection"),y(void 0),g.hide();return}if(b=!0,this.organizationsMissingSSO=!1,this.knowledgeBases?.clear(),g.items=await this.getKnowledgeBaseAutocompleteQuickPickItems(S.accessToken),g.items.length===1&&g.items[0]instanceof lA){this.logger.error("Failed to fetch new knowledge bases after fetching new auth session"),y(void 0),g.hide();return}g.busy=!1,g.show()}else y(g.selectedItems[0]),g.hide()}),g.onDidHide(()=>{b||y(void 0)})});return g.dispose(),v?.insertText})),this.refreshRemoteAgents(),this.disposables.add(this.authenticationService.onDidAuthenticationChange(()=>{this.refreshRemoteAgents()}))}dispose(){this.disposables.dispose()}async refreshRemoteAgents(){return this.refreshRemoteAgentsP||(this.refreshRemoteAgentsP=this._doRefreshRemoteAgents()),this.refreshRemoteAgentsP.finally(()=>this.refreshRemoteAgentsP=void 0)}async _doRefreshRemoteAgents(){let e=this.logService.getLogger("RemoteAgents"),r=new Set(xT.keys());try{let n=this.authenticationService.anyGitHubSession?.accessToken;if(!n){e.warn("Unable to fetch remote agents because user is not signed in.");return}(await this.authenticationService.getCopilotToken()).sku?.startsWith("copilot_enterprise")&&(r.delete(s9)||xT.set(s9,this.registerAgent(e,null,this.domainService.remoteAgentsURL)));let a=await(await this.fetcherService.fetch(this.domainService.remoteAgentsURL,{method:"GET",headers:{Authorization:a9.format("Bearer %s",n),...this.envService.getEditorVersionHeaders()}})).text(),c;try{if(c=JSON.parse(a).agents,!Array.isArray(c))throw new Error("Expected 'agents' to be an array")}catch(u){a.includes("access denied")||e.warn(`Invalid remote agent response: ${a} (${u})`);return}for(let u of c)r.delete(u.slug)||xT.set(u.slug,this.registerAgent(e,u,this.domainService.remoteAgentsURL))}catch(n){e.error("Failed to load remote slash commands",n)}for(let n of r)xT.get(n).dispose(),xT.delete(n)}registerAgent(e,r,n){let o=new Nt,s=`github.copilot-dynamic.${r?.slug??s9}`,a=r?.slug??KZ,c=r?.description??"Get answers grounded in web search, code search, and your enterprise's knowledge bases",u={name:a,description:c,publisherName:r?.owner_login??"GitHub",fullName:r?.name??"GitHub"},l=o.add(ft.chat.createDynamicChatParticipant(s,u,async(d,p,f,m)=>{let h=Trt(p),g=Br(),v=Br(),y={sessionId:h,modelMessageId:v,responseId:g,agentId:s,command:d.command};try{let _=new _T(r?`${n}/${r.slug}?chat`:`${n}/chat`,{capabilities:{type:"chat",family:"remote"},id:"gpt-3.5-turbo",name:"Remote Agents",version:"1.0"},4096),b=await this.promptVariablesService.resolveVariablesInPrompt(d.prompt,d.references),S=[],{copilot_skills:I,copilot_references:w}=await this.resolveCopilotSkills(a,d);w&&S.push(...w);let O=!1;try{let E=await this.prepareClientPlatformReferences([...d.references]);O=E.hasIgnoredFiles,E.clientReferences&&S.push(...E.clientReferences);for(let P of E.vscodeReferences)f.reference(P)}catch(E){return E instanceof Error&&E.message.includes("File seems to be binary and cannot be opened as text")?(f.markdown(ft.l10n.t("Sorry, binary files are not currently supported.")),{metadata:y}):{errorDetails:{message:E.message},metadata:y}}let U=new Map,z=Irt(d),M,re,ee=!1,N=await this.chatMLFetcher.fetchMany([...Crt(s,p),{role:"user",content:d.acceptedConfirmationData?.length||d.rejectedConfirmationData?.length?"":b.message,...S.length?{copilot_references:S}:void 0,copilot_confirmations:z?.length?z:void 0}],async(E,P,q)=>{if(q.copilotReferences){let Z=(ue,te)=>{let Q="url"in ue?ue.url:"url"in ue.data?ue.data.url:void 0;if(Q&&typeof Q=="string"&&!U.has(Q)){let je;if(pTe(ue)){let ne=pn.joinPath(this.vscodeExtensionContext.extensionUri,"assets","bing.svg");je={light:ne,dark:ne}}else new URL(Q).hostname==="github.com"&&(je=new ft.ThemeIcon("github"));M?M?.report(new ft.ChatResponseReferencePart(pn.parse(Q),je)):f.reference(pn.parse(Q),je),U.set(Q,te??ue)}};for(let ue of q.copilotReferences)Array.isArray(ue.data.results)?ue.data.results.forEach(te=>{Z(te,ue)}):"url"in ue.data&&typeof ue.data.url=="string"&&Z(ue)}let F=(Z,ue)=>{re?.deferred.complete(re.resolvedMessage),M=Z;let te=new Np;return re={deferred:te,resolvedMessage:ue},te.p};if(q.copilotFunctionCalls)for(let Z of q.copilotFunctionCalls)switch(Z.name){case"bing-search":{try{let ue=JSON.parse(Z.arguments);f.progress(ft.l10n.t('Searching Bing for "{0}"...',ue.query),async te=>F(te,ft.l10n.t('Bing search results for "{0}"',ue.query)))}catch{}break}case"kb-search":{try{let ue=JSON.parse(Z.arguments);f.progress(ft.l10n.t('Searching knowledge base for "{0}"...',ue.query),async te=>F(te,ft.l10n.t('Knowledge base results for "{0}"',ue.query)))}catch{}break}case"codesearch":{try{let ue=JSON.parse(Z.arguments);f.progress(ft.l10n.t('Searching {0} for "{1}"...',ue.scopingQuery,ue.query),async te=>F(te,ft.l10n.t('Code search results for "{0}" in {1}',ue.query,ue.scopingQuery)))}catch{}break}}if(q.copilotErrors&&typeof f.warning=="function"){ee=!0;for(let Z of q.copilotErrors)M?M?.report(new ft.ChatResponseWarningPart(Z.message)):f.warning(Z.message)}if(q.copilotConfirmation){ee=!0;let Z=q.copilotConfirmation;f.confirmation(Z.title,Z.message,Z.confirmation)}if(q.text){re?.deferred.complete(re.resolvedMessage);let Z=new ft.MarkdownString(q.text);Z.supportHtml=!0,f.markdown(Z)}},m,2,_,void 0,{secretKey:this.authenticationService.anyGitHubSession?.accessToken,copilot_thread_id:h,...I?{copilot_skills:I}:void 0},{messageSource:`serverAgent.${r?.slug??s9}`});if(y.copilot_references=[...new Set(U.values()).values()],N.type==="success"&&O&&f.markdown(ft.l10n.t(pD)),N.type!=="success"){if(e.warn(`Bad response from /agents/${a}: ${N.type} ${N.reason}`),N.reason.includes("400 no docs found"))return{errorDetails:{message:"No docs found"},metadata:y};if(N.type==="agent_unauthorized"){f.markdown(ft.l10n.t("Please authorize usage of this agent and resend your question."));let E=pn.parse(N.authorizationUrl),P=new URL(N.authorizationUrl);f.button({command:"vscode.open",title:ft.l10n.t("Authorize on {0}",P.hostname),arguments:[E]})}else{if(N.type==="agent_failed_dependency")return{errorDetails:{message:ft.l10n.t("Sorry, an error occurred: {0}",N.reason)},metadata:y};if(N.type!=="unknown"||!ee)return{errorDetails:{message:N.reason},metadata:y}}}return{metadata:y}}catch(_){return e.warn(`/agents/${a} failed: ${_}`),{metadata:y}}}));return l.iconPath=r?pn.parse(r.avatar_url):new ft.ThemeIcon("github"),a===KZ&&(l.participantVariableProvider={triggerCharacters:["#"],provider:{provideCompletionItems:async(d,p)=>(await this.getPlatformAgentSkills()).map(m=>{let h=new ft.ChatCompletionItem(`copilot.${m.name}`,"#"+m.name,[{value:m.insertText,level:ft.ChatVariableLevel.Full,description:m.description}]);return h.command=m.command,h.detail=m.description,h.fullName=m.fullName,h.icon=m.icon,h})}}),o.add(l.onDidReceiveFeedback(d=>cM(this.telemetryService,d,s))),o}async prepareClientPlatformReferences(e){let r=[],n=[],o=!1;for(let a of e)if(a.value instanceof pn){if(await this.ignoreService.isCopilotIgnored(a.value)){o=!0;continue}let c=await this.workspaceService.openTextDocument(a.value);r.push({type:"client.file",data:{language:c.languageId,content:c.getText()},id:QZ.basename(a.value.path)}),n.push({variableName:a.name,value:a.value})}else if(a.name==="selection"){let{activeTextEditor:c}=this.tabsAndEditorsService;if(!c)throw new Error(ft.l10n.t({message:"Please open a text editor to use the `#selection` variable.",comment:"{Locked='`#selection`'}"}));if(await this.ignoreService.isCopilotIgnored(c.document.uri)){o=!0;continue}let u=c.selection.start.line,l=c.selection.isEmpty?new ft.Range(new ft.Position(u,0),new ft.Position(u+1,0)):c.selection;r.push({type:"client.selection",data:{start:{line:l.start.line,col:l.start.character},end:{line:l.end.line,col:l.end.character},content:c.document.getText(l)},id:QZ.basename(c.document.uri.path)}),n.push({variableName:a.name,value:new ft.Location(c.document.uri,l)})}this.gitService.isInitialized||await this.gitService.initialize();let s=this.gitService.repositories;for(let a of s){let c=$_(a);if(!c)continue;let[u,l]=c?.split("/");r.push({type:"github.repository",id:c,data:{type:"repository",name:l,ownerLogin:u,id:(await this.githubRepositoryService.getRepositoryInfo(u,l)).id}})}return{clientReferences:r,vscodeReferences:n,hasIgnoredFiles:o}}async listEnabledSkills(e){if(!this.enabledSkillsPromise){let r=await this.fetcherService.fetch(this.domainService.listSkillsURL,{method:"GET",headers:{Authorization:a9.format("Bearer %s",e),...this.envService.getEditorVersionHeaders()}});this.enabledSkillsPromise=r.json().then(n=>n?.skills.reduce((o,s)=>o.add(s.slug),new Set))}return this.enabledSkillsPromise}async resolveCopilotSkills(e,r){if(e===KZ){let n=new Set,o=new Set;for(let s of r.references)if(fke[s.name])n.add(fke[s.name]);else if(s.name.startsWith(YZ)){n.add("kb-search"),await this.getKnowledgeBases();let a=this.knowledgeBases?.get(s.name.slice(YZ.length));a&&o.add(a)}return{copilot_skills:[...n],copilot_references:[...o]}}return{copilot_skills:[]}}async getKnowledgeBases(e){if(this.knowledgeBases?.size)return{knowledgeBases:[...this.knowledgeBases.values()],organizationsMissingSSO:this.organizationsMissingSSO};let r=e??this.authenticationService.permissiveGitHubSession?.accessToken;if(!r)return this.logger.debug("No auth token available to fetch knowledge bases"),{knowledgeBases:[],organizationsMissingSSO:!0};let n=await this.listKnowledgeBases(r),o=await n.text();if(n.headers.get("X-GitHub-SSO")){let s=n.headers.get("X-GitHub-SSO")?.split("partial-results; organizations=")[1];s&&(this.organizationsMissingSSO=!0,this.logger.debug(`Missing knowledge bases SSO for organizations: ${s}`))}try{let s=JSON.parse(o);this.knowledgeBases=new Map;let a=s.map(c=>({label:c.name,organization:c.owner.login,iconPath:new ft.ThemeIcon("github"),insertText:c.name,name:c.name,description:c.description,type:"github.knowledge-base",id:(0,hke.randomUUID)(),data:{type:"knowledge-base",id:c.id}}));for(let c of a)this.knowledgeBases.set(c.name,c);return{knowledgeBases:[...this.knowledgeBases.values()],organizationsMissingSSO:this.organizationsMissingSSO}}catch(s){return this.logger.error(s),{knowledgeBases:[],organizationsMissingSSO:this.organizationsMissingSSO}}}async listKnowledgeBases(e){return this.fetcherService.fetch("https://api.github.com/user/knowledge-bases",{method:"GET",headers:{Authorization:a9.format("Bearer %s",e),...this.envService.getEditorVersionHeaders()}})}async getKnowledgeBaseAutocompleteQuickPickItems(e){let{knowledgeBases:r,organizationsMissingSSO:n}=await this.getKnowledgeBases(e),o=[];if(n){let a=ft.l10n.t("Single-sign on to see knowledge bases from additional organizations");o.push(new lA(a)),o.push({kind:ft.QuickPickItemKind.Separator,label:""})}let s=new Map;for(let a of r){let c=a.organization;s.has(c)||s.set(c,[]),s.get(c)?.push(a)}for(let a of[...s.keys()].sort()){let c=s.get(a);c?.length&&(o.push({kind:ft.QuickPickItemKind.Separator,label:a}),o.push(...c.sort((u,l)=>u.label.localeCompare(l.label))))}return o}async getPlatformAgentSkills(){let e=this.authenticationService.anyGitHubSession?.accessToken;if(!e)return[];let r=await this.listEnabledSkills(e);return[{name:"web",insertText:"#web",description:"Search Bing for real-time context",kind:"bing-search",command:void 0},{name:"kb",insertText:`#${YZ}`,icon:new ft.ThemeIcon("book"),fullName:"Knowledge Bases",description:"Search your enterprises' knowledge bases",kind:"kb-search",command:{title:"",command:mke}}].filter(n=>r.has(n.kind))}};ST=B([T(0,ce),T(1,Ur),T(2,Pt),T(3,XF),T(4,Ze),T(5,Tt),T(6,De),T(7,Fo),T(8,zc),T(9,jt),T(10,me),T(11,zt),T(12,fn),T(13,Ln)],ST);function Irt(t){return[...t.acceptedConfirmationData?.map(r=>({state:"accepted",confirmation:r}))??[],...t.rejectedConfirmationData?.map(r=>({state:"dismissed",confirmation:r}))??[]]}function Crt(t,e){let r=[];for(let n of e.history)if(n.participant===t&&(n instanceof ft.ChatRequestTurn&&r.push({role:"user",content:n.prompt}),n instanceof ft.ChatResponseTurn)){let o=n.result.metadata?.copilot_references,s=n.response.map(a=>a instanceof ft.ChatResponseMarkdownPart?a.value.value:"content"in a?a.content:null).filter(a=>!!a).join("");r.push({role:"assistant",content:s,...o?{copilot_references:o}:void 0})}return r}function Trt(t){let e;for(let r of t.history)if(r instanceof ft.ChatResponseTurn){let n=r.result.metadata?.sessionId;if(typeof n=="string"){e=n;break}}return e??Br()}var XZ=W(require("vscode"));var IT=class{constructor(e,r,n){r.subscriptions.push(XZ.lm.registerTool("copilot_codebase",e.createInstance(pA)));let o=["selection","terminalLastCommand","editor","terminalSelection"];n.getVariables().forEach(s=>{o.includes(s.name)&&r.subscriptions.push(XZ.lm.registerTool("copilot_"+s.name,e.createInstance(dA,s)))})}};IT=B([T(0,or),T(1,zt),T(2,zv)],IT);var dA=class{constructor(e,r,n){this.variable=e;this.endpointProvider=r;this.accessor=n}async invoke(e,r){let n=await Mn(this.endpointProvider,2),o=await this.variable.resolve(this.accessor,{endpoint:n},r,{report:()=>{}});return o?o.userMessages.join(`

`):""}};dA=B([T(1,Le),T(2,rt)],dA);var pA=class{constructor(e,r){this.endpointProvider=e;this.accessor=r}async invoke(e,r){let n=await Mn(this.endpointProvider,2),{messages:o}=await _s(this.accessor,n,RC,{chatVariables:[],conversation:new Pc,query:e.query,include:{workspaceChunks:!0}},this.accessor.get(ve).acquireTokenizer(n.family),void 0,r);return o.map(s=>s.content).join(`

`)}};pA=B([T(0,Le),T(1,rt)],pA);var Ert=[...ike,HZ,$Z,WZ,vT(ST),vT(bT),vT(IT)],gke=Ert;var vke=W(require("path"));var Do=class t{static fromRange(e){return new t(e.startLineNumber,e.endLineNumber)}static fromRangeInclusive(e){return new t(e.startLineNumber,e.endLineNumber+1)}static subtract(e,r){return r?e.startLineNumber<r.startLineNumber&&r.endLineNumberExclusive<e.endLineNumberExclusive?[new t(e.startLineNumber,r.startLineNumber),new t(r.endLineNumberExclusive,e.endLineNumberExclusive)]:r.startLineNumber<=e.startLineNumber&&e.endLineNumberExclusive<=r.endLineNumberExclusive?[]:r.endLineNumberExclusive<e.endLineNumberExclusive?[new t(Math.max(r.endLineNumberExclusive,e.startLineNumber),e.endLineNumberExclusive)]:[new t(e.startLineNumber,Math.min(r.startLineNumber,e.endLineNumberExclusive))]:[e]}static joinMany(e){if(e.length===0)return[];let r=new c9(e[0].slice());for(let n=1;n<e.length;n++)r=r.getUnion(new c9(e[n].slice()));return r.ranges}static join(e){if(e.length===0)throw new Qr("lineRanges cannot be empty");let r=e[0].startLineNumber,n=e[0].endLineNumberExclusive;for(let o=1;o<e.length;o++)r=Math.min(r,e[o].startLineNumber),n=Math.max(n,e[o].endLineNumberExclusive);return new t(r,n)}static ofLength(e,r){return new t(e,e+r)}static deserialize(e){return new t(e[0],e[1])}constructor(e,r){if(e>r)throw new Qr(`startLineNumber ${e} cannot be after endLineNumberExclusive ${r}`);this.startLineNumber=e,this.endLineNumberExclusive=r}contains(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}get isEmpty(){return this.startLineNumber===this.endLineNumberExclusive}delta(e){return new t(this.startLineNumber+e,this.endLineNumberExclusive+e)}deltaLength(e){return new t(this.startLineNumber,this.endLineNumberExclusive+e)}get length(){return this.endLineNumberExclusive-this.startLineNumber}join(e){return new t(Math.min(this.startLineNumber,e.startLineNumber),Math.max(this.endLineNumberExclusive,e.endLineNumberExclusive))}toString(){return`[${this.startLineNumber},${this.endLineNumberExclusive})`}intersect(e){let r=Math.max(this.startLineNumber,e.startLineNumber),n=Math.min(this.endLineNumberExclusive,e.endLineNumberExclusive);if(r<=n)return new t(r,n)}intersectsStrict(e){return this.startLineNumber<e.endLineNumberExclusive&&e.startLineNumber<this.endLineNumberExclusive}overlapOrTouch(e){return this.startLineNumber<=e.endLineNumberExclusive&&e.startLineNumber<=this.endLineNumberExclusive}equals(e){return this.startLineNumber===e.startLineNumber&&this.endLineNumberExclusive===e.endLineNumberExclusive}toInclusiveRange(){return this.isEmpty?null:new gt(this.startLineNumber,1,this.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER)}toExclusiveRange(){return new gt(this.startLineNumber,1,this.endLineNumberExclusive,1)}mapToLineArray(e){let r=[];for(let n=this.startLineNumber;n<this.endLineNumberExclusive;n++)r.push(e(n));return r}forEach(e){for(let r=this.startLineNumber;r<this.endLineNumberExclusive;r++)e(r)}serialize(){return[this.startLineNumber,this.endLineNumberExclusive]}includes(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}toOffsetRange(){return new Xt(this.startLineNumber-1,this.endLineNumberExclusive-1)}},c9=class t{constructor(e=[]){this._normalizedRanges=e}get ranges(){return this._normalizedRanges}addRange(e){if(e.length===0)return;let r=p_(this._normalizedRanges,o=>o.endLineNumberExclusive>=e.startLineNumber),n=Bl(this._normalizedRanges,o=>o.startLineNumber<=e.endLineNumberExclusive)+1;if(r===n)this._normalizedRanges.splice(r,0,e);else if(r===n-1){let o=this._normalizedRanges[r];this._normalizedRanges[r]=o.join(e)}else{let o=this._normalizedRanges[r].join(this._normalizedRanges[n-1]).join(e);this._normalizedRanges.splice(r,n-r,o)}}contains(e){let r=P7(this._normalizedRanges,n=>n.startLineNumber<=e);return!!r&&r.endLineNumberExclusive>e}intersects(e){let r=P7(this._normalizedRanges,n=>n.startLineNumber<e.endLineNumberExclusive);return!!r&&r.endLineNumberExclusive>e.startLineNumber}getUnion(e){if(this._normalizedRanges.length===0)return e;if(e._normalizedRanges.length===0)return this;let r=[],n=0,o=0,s=null;for(;n<this._normalizedRanges.length||o<e._normalizedRanges.length;){let a=null;if(n<this._normalizedRanges.length&&o<e._normalizedRanges.length){let c=this._normalizedRanges[n],u=e._normalizedRanges[o];c.startLineNumber<u.startLineNumber?(a=c,n++):(a=u,o++)}else n<this._normalizedRanges.length?(a=this._normalizedRanges[n],n++):(a=e._normalizedRanges[o],o++);s===null?s=a:s.endLineNumberExclusive>=a.startLineNumber?s=new Do(s.startLineNumber,Math.max(s.endLineNumberExclusive,a.endLineNumberExclusive)):(r.push(s),s=a)}return s!==null&&r.push(s),new t(r)}subtractFrom(e){let r=p_(this._normalizedRanges,a=>a.endLineNumberExclusive>=e.startLineNumber),n=Bl(this._normalizedRanges,a=>a.startLineNumber<=e.endLineNumberExclusive)+1;if(r===n)return new t([e]);let o=[],s=e.startLineNumber;for(let a=r;a<n;a++){let c=this._normalizedRanges[a];c.startLineNumber>s&&o.push(new Do(s,c.startLineNumber)),s=c.endLineNumberExclusive}return s<e.endLineNumberExclusive&&o.push(new Do(s,e.endLineNumberExclusive)),new t(o)}toString(){return this._normalizedRanges.map(e=>e.toString()).join(", ")}getIntersection(e){let r=[],n=0,o=0;for(;n<this._normalizedRanges.length&&o<e._normalizedRanges.length;){let s=this._normalizedRanges[n],a=e._normalizedRanges[o],c=s.intersect(a);c&&!c.isEmpty&&r.push(c),s.endLineNumberExclusive<a.endLineNumberExclusive?n++:o++}return new t(r)}getWithDelta(e){return new t(this._normalizedRanges.map(r=>r.delta(e)))}};var u9=class t{constructor(e,r){this.lineRangeMapping=e,this.changes=r}flip(){return new t(this.lineRangeMapping.flip(),this.changes.map(e=>e.flip()))}};var l9=class t{constructor(e,r){this.lineCount=e;this.columnCount=r}static{this.zero=new t(0,0)}static lengthDiffNonNegative(e,r){return r.isLessThan(e)?t.zero:e.lineCount===r.lineCount?new t(0,r.columnCount-e.columnCount):new t(r.lineCount-e.lineCount,r.columnCount)}static betweenPositions(e,r){return e.lineNumber===r.lineNumber?new t(0,r.column-e.column):new t(r.lineNumber-e.lineNumber,r.column-1)}static ofRange(e){return t.betweenPositions(e.getStartPosition(),e.getEndPosition())}static ofText(e){let r=0,n=0;for(let o of e)o===`
`?(r++,n=0):n++;return new t(r,n)}isZero(){return this.lineCount===0&&this.columnCount===0}isLessThan(e){return this.lineCount!==e.lineCount?this.lineCount<e.lineCount:this.columnCount<e.columnCount}isGreaterThan(e){return this.lineCount!==e.lineCount?this.lineCount>e.lineCount:this.columnCount>e.columnCount}isGreaterThanOrEqualTo(e){return this.lineCount!==e.lineCount?this.lineCount>e.lineCount:this.columnCount>=e.columnCount}equals(e){return this.lineCount===e.lineCount&&this.columnCount===e.columnCount}compare(e){return this.lineCount!==e.lineCount?this.lineCount-e.lineCount:this.columnCount-e.columnCount}add(e){return e.lineCount===0?new t(this.lineCount,this.columnCount+e.columnCount):new t(this.lineCount+e.lineCount,e.columnCount)}createRange(e){return this.lineCount===0?new gt(e.lineNumber,e.column,e.lineNumber,e.column+this.columnCount):new gt(e.lineNumber,e.column,e.lineNumber+this.lineCount,this.columnCount+1)}toRange(){return new gt(1,1,this.lineCount+1,this.columnCount+1)}addToPosition(e){return this.lineCount===0?new qr(e.lineNumber,e.column+this.columnCount):new qr(e.lineNumber+this.lineCount,this.columnCount+1)}toString(){return`${this.lineCount},${this.columnCount}`}};var d9=class{constructor(e,r){this.range=e;this.text=r}get isEmpty(){return this.range.isEmpty()&&this.text.length===0}static equals(e,r){return e.range.equalsRange(r.range)&&e.text===r.text}toSingleEditOperation(){return{range:this.range,text:this.text}}};var fA=class t{static inverse(e,r,n){let o=[],s=1,a=1;for(let u of e){let l=new t(new Do(s,u.original.startLineNumber),new Do(a,u.modified.startLineNumber));l.modified.isEmpty||o.push(l),s=u.original.endLineNumberExclusive,a=u.modified.endLineNumberExclusive}let c=new t(new Do(s,r+1),new Do(a,n+1));return c.modified.isEmpty||o.push(c),o}static clip(e,r,n){let o=[];for(let s of e){let a=s.original.intersect(r),c=s.modified.intersect(n);a&&!a.isEmpty&&c&&!c.isEmpty&&o.push(new t(a,c))}return o}constructor(e,r){this.original=e,this.modified=r}toString(){return`{${this.original.toString()}->${this.modified.toString()}}`}flip(){return new t(this.modified,this.original)}join(e){return new t(this.original.join(e.original),this.modified.join(e.modified))}get changedLineCount(){return Math.max(this.original.length,this.modified.length)}toRangeMapping(){let e=this.original.toInclusiveRange(),r=this.modified.toInclusiveRange();if(e&&r)return new Yb(e,r);if(this.original.startLineNumber===1||this.modified.startLineNumber===1){if(!(this.modified.startLineNumber===1&&this.original.startLineNumber===1))throw new Qr("not a valid diff");return new Yb(new gt(this.original.startLineNumber,1,this.original.endLineNumberExclusive,1),new gt(this.modified.startLineNumber,1,this.modified.endLineNumberExclusive,1))}else return new Yb(new gt(this.original.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),new gt(this.modified.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER))}},p9=class t extends fA{static fromRangeMappings(e){let r=Do.join(e.map(o=>Do.fromRangeInclusive(o.originalRange))),n=Do.join(e.map(o=>Do.fromRangeInclusive(o.modifiedRange)));return new t(r,n,e)}constructor(e,r,n){super(e,r),this.innerChanges=n}flip(){return new t(this.modified,this.original,this.innerChanges?.map(e=>e.flip()))}withInnerChangesFromLineRanges(){return new t(this.original,this.modified,[this.toRangeMapping()])}},Yb=class t{constructor(e,r){this.originalRange=e,this.modifiedRange=r}toString(){return`{${this.originalRange.toString()}->${this.modifiedRange.toString()}}`}flip(){return new t(this.modifiedRange,this.originalRange)}toTextEdit(e){let r=e.getValueOfRange(this.modifiedRange);return new d9(this.originalRange,r)}};var wrt=vke.join(__dirname,"diffWorker.js"),f9=class{constructor(e=wrt){this._worker=new Lo(()=>new ih(e,{name:"Diff worker"}))}dispose(){this._worker.rawValue?.terminate()}async computeDiff(e,r,n){let o=await this._worker.value.proxy.computeDiff(e,r,n);return{identical:o.identical,quitEarly:o.quitEarly,changes:a(o.changes),moves:o.moves.map(c=>new u9(new fA(new Do(c[0],c[1]),new Do(c[2],c[3])),a(c[4])))};function a(c){return c.map(u=>new p9(new Do(u[0],u[1]),new Do(u[2],u[3]),u[4]?.map(l=>new Yb(new gt(l[0],l[1],l[2],l[3]),new gt(l[4],l[5],l[6],l[7])))))}}};var CT=class{constructor(e,r,n,o,s,a){this._tokenManager=e;this._tokenizerProvider=r;this._telemetryService=n;this._domainService=o;this._envService=s;this._fetcherService=a}async computeEmbeddings(e,r,n,o){let s=e.maxBatchSize,a=e.modelMaxPromptTokens-1;return this.fetchResponseWithBatches(e,r,o,a,s,n?.parallelism)}async fetchResponseWithBatches(e,r,n,o,s,a=1){for(let d of r)if(this._tokenizerProvider.acquireTokenizer(e.family).tokenLength(d)>o)return;let c=[],u=[],l=new E_(a);try{for(let d=0;d<r.length;d+=s){let p=r.slice(d,d+s);u.push(l.queue(async()=>{if(n?.isCancellationRequested)return;let f=await this.rawEmbeddingsFetchWithTelemetry(e,Br(),p,n);if(f.type==="failed")throw new Error("Embeddings request failed "+f.reason);return f}))}c=(await Promise.all(u)).flatMap(d=>d?.embeddings??[])}catch{return[]}finally{l.dispose()}if(!n?.isCancellationRequested)return c.length===0?void 0:c}async rawEmbeddingsFetchWithTelemetry(e,r,n,o){let s=Date.now(),a=await this.rawEmbeddingsFetch(e,r,n,o);return a.type==="failed"?(this._telemetryService.sendMSFTTelemetryErrorEvent("embedding.error",{type:a.type,reason:a.reason}),a):(this._telemetryService.sendMSFTTelemetryEvent("embedding.success",{},{batchSize:n.length,inputTokenCount:n.reduce((c,u)=>c+this._tokenizerProvider.acquireTokenizer(e.family).tokenLength(u),0),timeToComplete:Date.now()-s}),a)}async rawEmbeddingsFetch(e,r,n,o){try{let s=this._tokenManager instanceof SE?await this._tokenManager.getEmbeddingsToken():await this._tokenManager.getCopilotToken(),a={input:n,model:e.model};e.interceptBody?.(a);let c=await pT(this._fetcherService,this._envService,this._telemetryService,this._domainService,e,s.token,await hm(process.env.HMAC_SECRET),"copilot-panel",r,a,o),u=c.status===200?await c.json():await c.text();return c.status===200&&u.data?{type:"success",embeddings:u.data.map(l=>l.embedding)}:{type:"failed",reason:u.error}}catch(s){let a=s?.message??"Unknown error";return a.match(/Unexpected.*JSON/i)&&(a="timeout"),{type:"failed",reason:a}}}};CT=B([T(0,Nn),T(1,ve),T(2,me),T(3,Ln),T(4,Pt),T(5,Ur)],CT);var yke="github-enterprise.uri",TT=class extends St{constructor(r,n){super();this._configurationService=r;this._tokenStore=n;this._onDidChangeDomains=this._register(new Ht);this.onDidChangeDomains=this._onDidChangeDomains.event;this._telemetryBaseUrl="https://copilot-telemetry.githubusercontent.com";this._register(this._configurationService.onDidChangeConfiguration(s=>this._onDidConfigChangeHandler(s))),this._dotcomAPIUrl=this._getDotComAPIUrl();let o=this._configurationService.getConfig(ge.DebugOverrideCAPIUrl);o.endsWith("/")&&(o=o.slice(0,-1)),this._capiBaseUrl=o,this._capiBaseUrl==="https://api.githubcopilot.com"&&(this._processCopilotToken(this._tokenStore.copilotToken),this._register(this._tokenStore.onDidStoreUpdate(()=>this._processCopilotToken(this._tokenStore.copilotToken))))}_onDidConfigChangeHandler(r){if(r.affectsConfiguration(`${Bm}.advanced`)||r.affectsConfiguration(yke)){let n=this._getDotComAPIUrl();this._dotcomAPIUrl!==n&&(this._dotcomAPIUrl=n,this._onDidChangeDomains.fire({capiUrlChanged:!1,telemeryUrlChanged:!1,dotcomUrlChanged:!0}))}}_getDotComAPIUrl(){let r=this._configurationService.getNonExtensionConfig(yke),n=this._configurationService.getConfig(ge.AuthProvider)==="github-enterprise";if(r&&n){let o=lt.parse(r);return`${o.scheme}://api.${o.authority}`}return"https://api.github.com"}_processCopilotToken(r){let n=this._capiBaseUrl,o=this._telemetryBaseUrl;r?(this._capiBaseUrl=r.endpoints.api,this._telemetryBaseUrl=r.endpoints.telemetry):(this._capiBaseUrl="https://api.githubcopilot.com",this._telemetryBaseUrl="https://copilot-telemetry.githubusercontent.com"),(n!==this._capiBaseUrl||o!==this._telemetryBaseUrl)&&this._onDidChangeDomains.fire({capiUrlChanged:n!==this._capiBaseUrl,telemeryUrlChanged:o!==this._telemetryBaseUrl,dotcomUrlChanged:!1})}get capiBaseURL(){return this._capiBaseUrl}get capiChatURL(){return`${this._capiBaseUrl}/chat/completions`}get capiEmbeddingsURL(){return`${this._capiBaseUrl}/embeddings`}get capiModelsURL(){return`${this._capiBaseUrl}/models`}get telemetryURL(){return`${this._telemetryBaseUrl}/telemetry`}get remoteAgentsURL(){return`${this._capiBaseUrl}/agents`}get listSkillsURL(){return`${this._capiBaseUrl}/skills`}get searchSkillURL(){return`${this._capiBaseUrl}/search`}get tokenURL(){return this._dotcomAPIUrl+"/copilot_internal/v2/token"}get dotComAPIURL(){return this._dotcomAPIUrl}};TT=B([T(0,be),T(1,$m)],TT);var ET=W(require("vscode"));var m9=class{get sessionId(){return ET.env.sessionId}get machineId(){return ET.env.machineId}get OS(){switch(_re){case 3:return"Windows";case 1:return"Mac";case 2:return"Linux";default:return"Linux"}}get language(){return ET.env.language}isProduction(){return xP}isPreRelease(){return lc}getBuildType(){return Ra.buildType}getVersion(){return Ra.version}getBuild(){return Ra.build}getName(){return Ra.name}getEditorInfo(){return new vE("vscode",ET.version)}getEditorPluginInfo(){return new vE("copilot-chat",Ra.version)}getEditorVersionHeaders(){return{"Editor-Version":this.getEditorInfo().format(),"Editor-Plugin-Version":this.getEditorPluginInfo().format()}}};var h9=class extends _C{constructor(){super()}async readFile(e){return super.readFile(e)}};var mA=se("ICertificateReaderCache"),g9=class{constructor(){this.cache=new Map}get(e){return this.cache.get(e)}set(e,r){this.cache.set(e,r)}};var qAe=W(require("fs"));var X9=se("IRootCertificateReader"),HAe=(t,e=process.platform)=>new ite(t.get(Vi),fst(e,t),new pte),ite=class{constructor(e,r,n){this.realReader=r;this.noopReader=n;this.delegate=r,e.onCopilotToken(o=>{this.delegate=o.token.getTokenValue("ssc")==="1"?this.realReader:this.noopReader})}getAllRootCAs(){return this.delegate.getAllRootCAs()}},fst=(t,e)=>{let r=e.get(mA).get(t);if(r)return r;let n=mst(t,e),o=new ate(n),s=new ste(o),a=new ote(e,s);return e.get(mA).set(t,a),a},mst=(t,e)=>{switch(t){case"linux":return new cte;case"darwin":return new ute;case"win32":return new lte(e);default:return new dte}},ote=class{constructor(e,r){this.accessor=e;this.delegate=r}async getAllRootCAs(){try{return await this.delegate.getAllRootCAs()}catch(e){return this.accessor.get(ce).getLogger("certificates").warn(`Failed to read root certificates: ${e}`),[]}}},ste=class{constructor(e){this.delegate=e}async getAllRootCAs(){return this.certificates||(this.certificates=await this.delegate.getAllRootCAs()),this.certificates}},ate=class{constructor(e){this.delegate=e}async getAllRootCAs(){let e=await this.delegate.getAllRootCAs(),r=process.env.NODE_EXTRA_CA_CERTS;if(!r)return e;let n=await jAe(r);return e.concat(n)}},cte=class{async getAllRootCAs(){let e=[];for(let r of["/etc/ssl/certs/ca-certificates.crt","/etc/ssl/certs/ca-bundle.crt"]){let n=await jAe(r);e=e.concat(n)}return e}},ute=class{async getAllRootCAs(){let e=BAe();return e.all(e.der2.pem).filter(r=>r!==void 0)}},lte=class{constructor(e){this.accessor=e}async getAllRootCAs(){return await this.accessor.get(gD).loadCaCerts()||[]}},dte=class{async getAllRootCAs(){throw new Error("No certificate reader available for unsupported platform")}},pte=class{async getAllRootCAs(){return[]}};async function jAe(t){try{let n=(await qAe.promises.readFile(t,{encoding:"utf8"})).split(/(?=-----BEGIN CERTIFICATE-----)/g).filter(s=>s.length>0),o=new Set(n);return Array.from(o)}catch(e){if(e?.code!=="ENOENT")throw e}return[]}var zAe=W(require("http"));var hst=407,J9=se("IProxySocketFactory"),_m=class extends Error{constructor(r,n,o){super(r);this.cause=n;this.responseStatus=o}};function GAe(t){return new fte(t,new mte(t))}var fte=class{constructor(e,r,n=process.platform){this.accessor=e;this.delegate=r;this.platform=n;this.successfullyAuthorized=new km(20);this.logger=e.get(ce).getLogger("proxy-socket-factory")}async createSocket(e,r){this.successfullyAuthorized.get(this.getProxyCacheKey(r))&&(this.logger.debug("Proxy authorization already successful once, skipping 407 rountrip"),await this.reauthorize(e,r));try{return await this.delegate.createSocket(e,r)}catch(n){if(n instanceof _m&&n.responseStatus===hst){this.logger.debug("Proxy authorization required, trying to authorize first time");let o=await this.authorizeAndCreateSocket(e,r);if(o)return this.logger.debug("Proxy authorization successful, caching result"),this.successfullyAuthorized.set(this.getProxyCacheKey(r),!0),o}throw n}}async reauthorize(e,r){let n=await this.authorize(r);n&&(this.logger.debug("Proxy re-authorization successful, received token"),e.headers["Proxy-Authorization"]="Negotiate "+n)}async authorizeAndCreateSocket(e,r){let n=await this.authorize(r);if(this.logger.debug("Proxy authorization successful, received token"),n)return this.logger.debug("Trying to create socket with proxy authorization"),e.headers["Proxy-Authorization"]="Negotiate "+n,await this.delegate.createSocket(e,r)}async authorize(e){this.logger.debug("Loading kerberos module");let r=await gst(this.accessor);if(!r){this.logger.debug("Could not load kerberos module");return}let n=this.computeSpn(e);this.logger.debug("Initializing kerberos client using spn",n);let o=await r.initializeClient(n);this.logger.debug("Perform client side kerberos step");let s=await o.step("");return this.logger.debug("Received kerberos server response"),s}computeSpn(e){let o=this.accessor.get(be).getConfig(ge.KerberosServicePrincipal)??e.kerberosServicePrincipal;if(o)return this.logger.debug("Using configured kerberos spn",o),o;let s=this.platform==="win32"?`HTTP/${e.host}`:`HTTP@${e.host}`;return this.logger.debug("Using default kerberos spn",s),s}getProxyCacheKey(e){return e.host+":"+e.port}},mte=class{constructor(e){this.logger=e.get(ce).getLogger("proxy-socket-factory")}async createSocket(e,r){let n=this.createConnectRequestOptions(e,r);return new Promise((o,s)=>{this.logger.debug("Attempting to establish connection to proxy");let a=zAe.request(n);a.useChunkedEncodingByDefault=!1,a.once("connect",(c,u,l)=>{this.logger.debug("Socket Connect returned status code",c.statusCode),a.removeAllListeners(),u.removeAllListeners(),c.statusCode!==200?(u.destroy(),s(new _m("tunneling socket could not be established",void 0,c.statusCode))):l.length>0?(u.destroy(),s(new _m("got illegal response body from proxy"))):(this.logger.debug("Successfully established tunneling connection to proxy"),o(u))}),a.once("error",c=>{if(!c.message&&c instanceof AggregateError){let u=c.stack;c=new AggregateError(c.errors,`Aggregate error:${c.errors.map(l=>`
- ${l.message}`).join("")}`),c.stack=u}this.logger.debug("Proxy socket connection error",c.message),a.removeAllListeners(),s(new _m("tunneling socket could not be established",c))}),a.on("timeout",()=>{this.logger.debug("Proxy socket connection timeout"),s(new _m(`tunneling socket could not be established, proxy socket connection timeout while connecting to ${n.host}:${n.port}`))}),a.end()})}createConnectRequestOptions(e,r){let n={...r,method:"CONNECT",path:e.host+":"+e.port,agent:!1,headers:{host:e.host+":"+e.port,"Proxy-Connection":"keep-alive"},timeout:e.timeout};return e.localAddress&&(n.localAddress=e.localAddress),this.configureProxyAuthorization(n,e),n}configureProxyAuthorization(e,r){e.headers["Proxy-Authorization"]=[],e.proxyAuth&&e.headers["Proxy-Authorization"].push("Basic "+Buffer.from(e.proxyAuth).toString("base64")),r.headers&&r.headers["Proxy-Authorization"]&&e.headers["Proxy-Authorization"].push(r.headers["Proxy-Authorization"])}};async function gst(t){try{return t.get(hD).loadKerberos()}catch{return}}var vst=W(require("http")),yst=W(require("https"));var zT=class extends Hv{constructor(r){super();this._envService=r}fetch(r,n){let o=n.headers||{};o["User-Agent"]=`GitHubCopilotChat/${this._envService.getVersion()}`;let s=n.body;if(n.json){if(n.body)throw new Error("Illegal arguments! Cannot pass in both 'body' and 'json'!");o["Content-Type"]="application/json",s=JSON.stringify(n.json)}let a=n.method||"GET";if(a!=="GET"&&a!=="POST")throw new Error("Illegal arguments! 'method' must be either 'GET' or 'POST'!");let c=n.signal??new AbortController().signal;if(c&&!(c instanceof AbortSignal))throw new Error("Illegal arguments! 'signal' must be an instance of AbortSignal!");return this._fetch(r,a,o,s,c)}_fetch(r,n,o,s,a){return new Promise((c,u)=>{let d=(r.startsWith("https:")?yst:vst).request(r,{method:n,headers:o},p=>{if(a.aborted){p.destroy(),d.destroy(),u(hte(a));return}let f=new gte(d,p,a);c(new Hm(p.statusCode||0,p.statusMessage||"",f.headers,async()=>f.text(),async()=>f.json(),async()=>f.body()))});d.setTimeout(60*1e3),d.on("error",u),s&&d.write(s),d.end()})}async disconnectAll(){}makeAbortController(){return new AbortController}isAbortError(r){return bst(r)}isDNSLookupFailedError(r){return r&&r.code==="ENOTFOUND"}isFetcherError(r){return r&&["EADDRINUSE","ECONNREFUSED","ECONNRESET","ENOTFOUND","EPIPE","ETIMEDOUT"].includes(r.code)}getUserMessageForFetcherError(r){return`Please check your firewall rules and network connection then try again. Error Code: ${r.code}.`}};function hte(t){return t.reason}function bst(t){return t&&t.name==="AbortError"}var gte=class{constructor(e,r,n){this.req=e;this.res=r;this.signal=n;this.headers=new class{get(o){let s=r.headers[o];return Array.isArray(s)?s[0]:s??null}[Symbol.iterator](){let o=Object.keys(r.headers),s=0;return{next:()=>{if(s>=o.length)return{done:!0,value:void 0};let a=o[s++];return{done:!1,value:[a,this.get(a)]}}}}}}text(){return new Promise((e,r)=>{let n=[];this.res.on("data",o=>n.push(o)),this.res.on("end",()=>e(Buffer.concat(n).toString())),this.res.on("error",r),this.signal.addEventListener("abort",()=>{this.res.destroy(),this.req.destroy(),r(hte(this.signal))})})}async json(){let e=await this.text();return JSON.parse(e)}async body(){return this.signal.addEventListener("abort",()=>{this.res.emit("error",hte(this.signal)),this.res.destroy(),this.req.destroy()}),this.res}};var vte=require("stream");var GT=class t extends Hv{constructor(r,n){super();this._net=r;this._envService=n}static create(r){let n=_st();return n?new t(n,r):null}async fetch(r,n){let o=n.headers||{};o["User-Agent"]=`GitHubCopilotChat/${this._envService.getVersion()}`;let s=n.body;if(n.json){if(n.body)throw new Error("Illegal arguments! Cannot pass in both 'body' and 'json'!");o["Content-Type"]="application/json",s=JSON.stringify(n.json)}let a=n.method||"GET";if(a!=="GET"&&a!=="POST")throw new Error("Illegal arguments! 'method' must be either 'GET' or 'POST'!");let c=n.signal??new AbortController().signal;if(c&&!(c instanceof AbortSignal))throw new Error("Illegal arguments! 'signal' must be an instance of AbortSignal!");return this._fetch(r,a,o,s,c)}async _fetch(r,n,o,s,a){let c=await this._net.fetch(r,{method:n,headers:o,body:s,signal:a});return new Hm(c.status,c.statusText,c.headers,()=>c.text(),()=>c.json(),async()=>{if(!c.body)return vte.Readable.from([]);let u=c.body[Symbol.asyncIterator]();return vte.Readable.from(u)})}async disconnectAll(){}makeAbortController(){return new AbortController}isAbortError(r){return r&&r.name==="AbortError"}isDNSLookupFailedError(r){return r?.message==="net::ERR_INTERNET_DISCONNECTED"}isFetcherError(r){return r&&r.message&&r.message.startsWith("net::")}getUserMessageForFetcherError(r){return`Please check your firewall rules and network connection then try again. Error Code: ${r.message}.`}};function _st(){try{return require("electron").net}catch{}}var YT=W(KPe(),1),b6r={ALPN_HTTP2:YT.default.ALPN_HTTP2,ALPN_HTTP2C:YT.default.ALPN_HTTP2C,ALPN_HTTP1_1:YT.default.ALPN_HTTP1_1,ALPN_HTTP1_0:YT.default.ALPN_HTTP1_0},{fetch:_6r,context:YPe,reset:x6r,noCache:S6r,h1:I6r,keepAlive:C6r,h1NoCache:T6r,keepAliveNoCache:E6r,cacheStats:w6r,clearCache:R6r,offPush:k6r,onPush:A6r,createUrl:P6r,timeoutSignal:D6r,Body:N6r,Headers:L6r,Request:O6r,Response:M6r,AbortController:QPe,AbortError:XPe,AbortSignal:F6r,FetchBaseError:U6r,FetchError:$te,ALPN_HTTP2:B6r,ALPN_HTTP2C:q6r,ALPN_HTTP1_1:H6r,ALPN_HTTP1_0:j6r}=YT.default;var JPe=W(require("tls"));var h7=class{constructor(e){this._certificateReader=e.get(X9)}async enhanceProxySettings(e){let r=await this.getCertificates();return{...e,ca:r}}async getCertificates(){let e=await this._certificateReader.getAllRootCAs();if(e.length!==0)return e}async applyToRequestOptions(e){let r=await this._certificateReader.getAllRootCAs(),n={_vscodeAdditionalCaCerts:r};e.secureContext=JPe.createSecureContext(n),e.ca=r,e.cert=r,r.map(o=>{e.secureContext.context.addCACert(o)})}};var g7=class extends Hv{constructor(r){super();this.accessor=r;this.createSocketFactory=(r,n)=>async o=>{o.rejectUnauthorized=n,o.timeout=r.connectionTimeoutInMs,await this.certificateConfigurator.applyToRequestOptions(o);let s=await this.certificateConfigurator.enhanceProxySettings(r);try{return await this.proxySocketFactory.createSocket(o,s)}catch(a){throw a instanceof _m&&a.cause?new Error(`${a.message}, cause=${a.cause.message}`):new Error(a.message)}};this.fetchApi=this.createFetchApi(r),this.certificateConfigurator=new h7(r),this.proxySocketFactory=r.get(J9)}set proxySettings(r){this._proxySettings=r,this.fetchApi=this.createFetchApi(this.accessor)}get proxySettings(){return this._proxySettings}set rejectUnauthorized(r){this._rejectUnauthorized=r,this.fetchApi=this.createFetchApi(this.accessor)}get rejectUnauthorized(){return this._rejectUnauthorized}createFetchApi(r){let n=r.get(Pt);return YPe({userAgent:`GitHubCopilotChat/${n.getVersion()}`,socketFactory:this._proxySettings?this.createSocketFactory(this._proxySettings,this.rejectUnauthorized):void 0,rejectUnauthorized:this.rejectUnauthorized})}async fetch(r,n){let o={...n,body:n.body?n.body:n.json,signal:n.signal};await this.certificateConfigurator.applyToRequestOptions(o);let s=await this.certificateConfigurator.getCertificates();this.fetchApi.setCA(s);let a=await this.fetchApi.fetch(r,o);return new Hm(a.status,a.statusText,a.headers,()=>a.text(),()=>a.json(),async()=>a.body)}disconnectAll(){return this.fetchApi.reset()}makeAbortController(){return new QPe}isAbortError(r){return r instanceof XPe}isDNSLookupFailedError(r){return r instanceof $te&&r.code==="ENOTFOUND"}isFetcherError(r){return r instanceof $te}getUserMessageForFetcherError(r){return`Please check your firewall rules and network connection then try again. Error Code: ${r.code}.`}};var eDe=require("net"),tDe=require("url"),QT=require("vscode");function Gct(t){return t.HTTPS_PROXY||t.https_proxy||t.HTTP_PROXY||t.http_proxy||null}function rDe(t,e){let r=QT.workspace.onDidChangeConfiguration(n=>{let o=n.affectsConfiguration("http.proxy");(n.affectsConfiguration("http.proxyStrictSSL")||n.affectsConfiguration("http.proxyAuthorization")||n.affectsConfiguration("http.proxyKerberosServicePrincipal")||o)&&ZPe(t,e,o)});return ZPe(t,e),r}var ZPe=(t,e,r)=>{let o=QT.workspace.getConfiguration("http").get("proxy")||Gct(e);if(o){let s={},a=QT.workspace.getConfiguration("http").get("proxyAuthorization"),c=QT.workspace.getConfiguration("http").get("proxyStrictSSL",!0);a&&(s["Proxy-Authorization"]=a);let u=o,l=o.split(":");if(l.length>2){if(o.includes("[")){let y=o.indexOf("["),_=o.indexOf("]");u=o.substring(y+1,_)}}else u=l[0];let d=(0,eDe.isIP)(u);d===4?o=`https://${o}`:d===6&&(o.includes("[")?o.startsWith("https://")||(o=`https://${o}`):o=`https://[${o}]`);let{hostname:p,port:f,username:m,password:h}=Vct(o),g=m&&h&&`${decodeURIComponent(m)}:${decodeURIComponent(h)}`;t.proxySettings={host:p,port:parseInt(f),proxyAuth:g,headers:s};let v=QT.workspace.getConfiguration("http").get("proxyKerberosServicePrincipal");v&&(t.proxySettings.kerberosServicePrincipal=v),t.rejectUnauthorized=c}else r&&!o&&(t.proxySettings=void 0)};function Vct(t){try{return new tDe.URL(t)}catch{throw new Error(`Invalid proxy URL: '${t}'`)}}var XT=class extends g7{constructor(r){super(r);this._store=new Nt;this._store.add(rDe(this,process.env))}dispose(){this._store.dispose()}};var JT=class{constructor(e,r,n,o){this._logger=e.getLogger("FetcherService"),this._fetcher=this._getFetcher(o,n,r)}_getFetcher(e,r,n){if(r.getConfig(ge.DebugUseElectronFetcher)){let a=GT.create(n);if(a)return this._logger.info("Using the Electron fetcher."),a;this._logger.info("Can't use the Electron fetcher in this environment.")}return r.getConfig(ge.DebugUseNodeFetcher)?(this._logger.info("Using the Node fetcher."),new zT(n)):(this._logger.info("Using the Helix fetcher."),new XT(e))}fetch(e,r){return this._fetcher.fetch(e,r)}disconnectAll(){return this._fetcher.disconnectAll()}makeAbortController(){return this._fetcher.makeAbortController()}isAbortError(e){return this._fetcher.isAbortError(e)}isDNSLookupFailedError(e){return this._fetcher.isDNSLookupFailedError(e)}isFetcherError(e){return this._fetcher.isFetcherError(e)}getUserMessageForFetcherError(e){return this._fetcher.getUserMessageForFetcherError(e)}};JT=B([T(0,ce),T(1,Pt),T(2,be),T(3,rt)],JT);var y7=W(require("vscode")),v7=class{async open(e){await y7.commands.executeCommand("vscode.open",y7.Uri.parse(e))}};function nDe(t){let r=[`(repo:${(Array.isArray(t.repo)?t.repo:[t.repo]).join(" OR repo:")})`];return t.lang&&r.push(`(lang:${t.lang.join(" OR lang:")})`),t.notLang&&r.push(`NOT (lang:${t.notLang.join(" OR lang:")})`),t.path&&r.push(`(path:${t.path.join(" OR path:")})`),t.notPath&&r.push(`NOT (path:${t.notPath.join(" OR path:")})`),r.join(" ")}var b7=class extends Error{constructor(r,n){super(n);this.status=r}},$ct=6,Wct=.766,u_=class{constructor(e,r,n,o,s,a){this._domainService=e;this._telemetryService=r;this._authenticationService=n;this._fetcherService=o;this._envService=s;this._logger=a.getLogger("CodeOrDocsSearchClient")}async search(e,r,n={},o){let s;if(Array.isArray(r.repo)&&!r.repo.length)throw new Error("No repos specified");try{s=await this.postCodeOrDocsSearchRequestWithRetry(e,r,n,o)}catch(c){throw this._telemetryService.sendGHTelemetryException(c,`${this.slug} search failed`),c}let a=s.errors?.map(gCe)??[];if(!Array.isArray(r.repo)){if(a.length)throw a.length>1?new AggregateError(a):a[0];return s.results}return{results:s.results,errors:a}}async postCodeOrDocsSearchRequestWithRetry(e,r,n,o){let s=this._authenticationService.permissiveGitHubSession?.accessToken??this._authenticationService.anyGitHubSession?.accessToken;if(o?.isCancellationRequested)return{results:[]};let a=`${this._domainService.searchSkillURL}/${this.slug}`,c=5,u=0,l=new Set,d;for(;u<c;){if(o?.isCancellationRequested)return{results:[]};try{try{return await this.postCodeOrDocsSearchRequest(a,s,e,r,n,o)}catch(p){if(p instanceof b7)throw p;d=p;break}}catch(p){u++;let f=u*1e3;l.add(`Error fetching ${this.slug} search. ${p.message??p}`),this._logger.warn(`[repo:${r.repo}] Error fetching ${this.slug} search. Retrying in ${u} seconds. Query: ${e}`),await new Promise(m=>setTimeout(m,f))}}if(o?.isCancellationRequested)return{results:[]};throw u>=c&&(this._logger.warn(`[repo:${r.repo}] Max Retry Error thrown while querying '${e}'`),d=PQ({error:"ERROR_TYPE_MAX_RETRIES_EXCEEDED",message:`${this.slug} search timed out after ${c} retries. ${Array.from(l).join(`
`)}`})),d}async postCodeOrDocsSearchRequest(e,r,n,o,s,a){let c=s.limit??$ct,u=s.similarity??Wct,l=s.rawChunks??!1,d={url:e,family:"Code Or Doc Search",name:"Code Or Doc Search",version:"2023-12-12-preview",modelMaxPromptTokens:0,getExtraHeaders(){let h={Accept:"application/json","X-GitHub-Api-Version":"2023-12-12-preview"};return l&&(h["X-Experiment-blackbird_snippet_mode"]="raw"),h}},p=await pT(this._fetcherService,this._envService,this._telemetryService,this._domainService,d,r??"",await hm(process.env.HMAC_SECRET),void 0,Br(),{query:n,scopingQuery:nDe(o),similarity:u,limit:c},a),f=await p.text();if(p.status===404||p.status===400&&f.includes("unknown integration"))throw this._logger.debug(`${this.slug} search endpoint not available for this user.`),PQ({error:"ERROR_TYPE_NO_ACCESS_TO_ENDPOINT",message:`${this.slug}: ${f}`});let m;try{m=JSON.parse(f)}catch{throw new b7(p.status,f)}return m}};B([bi(e=>e._logger)],u_.prototype,"search",1),u_=B([T(0,Ln),T(1,me),T(2,fn),T(3,Ur),T(4,Pt),T(5,ce)],u_);var _7=class extends u_{constructor(){super(...arguments);this.slug="code"}},x7=class extends u_{constructor(){super(...arguments);this.slug="docs"}};var FA=W(require("vscode")),S7=class{getAllExtensions(){return FA.extensions.all}async getAllCommands(){return FA.commands.executeCommand("_getAllCommands")}async getAllSettings(){return FA.commands.executeCommand("_getAllSettings")}};function Kct(t){switch(t){case"text-embedding-ada-002":case"copilot-preview-ada-centralus":case"copilot-preview-babbage-centralus":return{maxBatchSize:16,maxTokens:8192};default:throw new Error(`Unknown model ${t}`)}}var I7=class{constructor(e,r){this._modelInfo=e;this.url=r;this.name=this._modelInfo.name;this.version=this._modelInfo.version;this.model=this._modelInfo.id;this.family=this._modelInfo.capabilities.family;let n=Kct(this._modelInfo.id);this.maxBatchSize=n.maxBatchSize,this.modelMaxPromptTokens=n.maxTokens}};var UA=class{constructor(e,r,n,o,s,a,c){this._fetcher=e;this._domainService=r;this._expService=n;this._envService=o;this._authService=s;this._telemetryService=a;this._familyMap=new Map;this._lastFetchTime=0;this._logger=c.getLogger("ModelMetadataFetcher")}async getAllChatModels(){await this._fetchModels();let e=[];for(let[,r]of this._familyMap)for(let n of r)xU(n)&&e.push(n);return e}async getChatModel(e){await this._fetchModels();let r;if(e==="gpt-4"?r=this._familyMap.get("gpt-4o")?.[0]??this._familyMap.get("gpt-4-turbo")?.[0]??this._familyMap.get("gpt-4")?.[0]:r=this._familyMap.get(e)?.[0],r=r?await this._findExpOverride(r):void 0,!r||!xU(r))throw this._lastFetchError||new Error(`Unable to resolve chat model with family selection: ${e}`);return r}async getEmbeddingsModel(e){await this._fetchModels();let r=this._familyMap.get(e)?.[0];if(r=r?await this._findExpOverride(r):void 0,!r||!Rne(r))throw this._lastFetchError||new Error(`Unable to resolve embeddings model with family selection: ${e}`);return r}_shouldRefreshModels(){if(this._familyMap.size===0)return!0;let e=10*60*1e3,r=Date.now();return this._lastFetchTime?r-this._lastFetchTime>e:!0}async _fetchModels(e){if(!e&&!this._shouldRefreshModels())return;let r=(await this._authService.getCopilotToken()).token;try{let n=await yZ(this._fetcher,this._envService,this._telemetryService,this._domainService,this._domainService.capiModelsURL,r,await hm(process.env.HMAC_SECRET),"model-access",Br());this._lastFetchTime=Date.now(),this._familyMap.clear();let o=(await n.json()).data;for(let s of o){let a=s.capabilities.family;this._familyMap.has(a)||this._familyMap.set(a,[]),this._familyMap.get(a)?.push(s)}this._lastFetchError=void 0}catch(n){this._logger.error("Failed to fetch models",n),this._lastFetchError=n,this._lastFetchTime=0}}async _fetchModel(e){let r=(await this._authService.getCopilotToken()).token;try{let o=await(await yZ(this._fetcher,this._envService,this._telemetryService,this._domainService,`${this._domainService.capiModelsURL}/${e}`,r,await hm(process.env.HMAC_SECRET),"model-access",Br())).json();return this._familyMap.has(o.capabilities.family)?this._familyMap.get(o.capabilities.family)?.push(o):this._familyMap.set(o.capabilities.family,[o]),o}catch{return}}async _findExpOverride(e){let r={},n=await this._expService.getTreatmentVariableAsync("vscode","copilotchat.modelOverrides",!0);try{r=JSON.parse(n||"{}")}catch{}if(r[e.id]){for(let[,s]of this._familyMap){let a=s.find(c=>c.id===r[e.id]);if(a)return a}e=await this._fetchModel(r[e.id])??e}return e}};UA=B([T(0,Ur),T(1,Ln),T(2,Lt),T(3,Pt),T(4,fn),T(5,me),T(6,ce)],UA);var ZT=class{constructor(e){this.accessor=e;this._chatEndpoints=new Map;this._embeddingEndpoints=new Map;this.accessor.get(Vi).onCopilotToken(r=>{let n=this.accessor.get(be).getConfig(ge.DebugOverrideChatEngine),o=this.accessor.get(be).getConfig(ge.DebugOverrideEmbeddingsModel);r.token.isInternal&&n&&(this._overridenChatModel=n),r.token.isInternal&&o&&(this._overridenEmbeddingsModel=o)}),this._modelFetcher=new UA(e.get(Ur),e.get(Ln),e.get(Lt),e.get(Pt),e.get(fn),e.get(me),e.get(ce))}async shouldDisableSnippy(){let e=await this.accessor.get(Nn).getCopilotToken(),r=this.accessor.get(zt).extensionMode===qc.Development;return e.isInternal&&r}async getOrCreateChatEndpointInstance(e){let r=e.id,n=this._chatEndpoints.get(r);if(!n){let o=this.accessor.get(Ln).capiChatURL,s=await pke(this.accessor,r),a=await this.shouldDisableSnippy();n=new _T(o,e,s,a),this._chatEndpoints.set(r,n)}return n}async getOrCreateEmbeddingEndpointInstance(e){let r=e.id,n=this._embeddingEndpoints.get(r);if(!n){let o=this.accessor.get(Ln).capiEmbeddingsURL;n=new I7(e,o),this._embeddingEndpoints.set(r,n)}return n}async getChatEndpoint(e){if(this._overridenChatModel)return this.getOrCreateChatEndpointInstance({id:this._overridenChatModel,name:"Custom Overriden Chat Model",version:"1.0.0",capabilities:{family:"custom",type:"chat"}});let r=await this._modelFetcher.getChatModel(e);return this.getOrCreateChatEndpointInstance(r)}async getEmbeddingsEndpoint(e){if(this._overridenEmbeddingsModel)return this.getOrCreateEmbeddingEndpointInstance({id:this._overridenEmbeddingsModel,name:"Custom Overriden Embeddings Model",version:"1.0.0",capabilities:{family:"custom",type:"embeddings"}});let r=await this._modelFetcher.getEmbeddingsModel(e==="ada"?"text-embedding-ada-002":"text-embedding-3-small");return this.getOrCreateEmbeddingEndpointInstance(r)}async getAllChatEndpoints(){let e=await this._modelFetcher.getAllChatModels(),r=[];for(let n of e){let o=await this.getOrCreateChatEndpointInstance(n);r.push(o)}return r}};ZT=B([T(0,rt)],ZT);function iDe(t){t.define(Vi,new _P),t.define(Pt,new m9),t.define(yI,new f9),t.define(mA,new g9),t.define(X9,HAe(t)),t.define(J9,GAe(t)),t.define(Ur,new Ue(JT)),t.define(Le,new Ue(ZT)),t.define(Ln,new Ue(TT)),t.define(De,new Ue(Fb)),t.define(LP,new Ue(D_)),t.define(KRe,new KF),t.define(Vm,new Ue(P_)),t.define(A_,new v7),t.define(on,new h9),t.define(Mo,new Ue(CT)),t.define(Wu,new Ue(Jm)),t.define(Tl,new Ue(aI)),t.define(Sv,new Ue(eC)),t.define(zv,new Ue(hT)),t.define(W6,new Ue(_7)),t.define(K6,new Ue(x7)),t.define(qp,new S7)}var zu=W(require("vscode")),oDe=W(require("dns")),sDe=W(require("util"));var eE=class{constructor(e,r,n,o){this._context=e;this.envService=r;this.configurationService=n;this.accessor=o;this._context.subscriptions.push(zu.commands.registerCommand("github.copilot.debug.showNotebookLog",async()=>{if(!iA)return;let s=await zu.workspace.openNotebookDocument(iA);await zu.window.showNotebookDocument(s)})),this._context.subscriptions.push(zu.commands.registerCommand("github.copilot.debug.collectDiagnostics",async()=>{let s=await zu.workspace.openTextDocument({language:"markdown"}),a=await zu.window.showTextDocument(s),c="api.githubcopilot.com",u=`https://${c}/_ping`,l=10;await Ep(a,`## GitHub Copilot Chat

- Extension Version: ${this.envService.getVersion()} (${this.envService.getBuildType()})
- VS Code: ${this.envService.getEditorInfo().format()}
- OS: ${this.envService.OS}${zu.env.remoteName?`
- Remote Name: ${zu.env.remoteName}`:""}

## Network

User Settings:
\`\`\`json
  "github.copilot.advanced": {
    "debug.useElectronFetcher": ${this.configurationService.getConfig(ge.DebugUseElectronFetcher)},
    "debug.useNodeFetcher": ${this.configurationService.getConfig(ge.DebugUseNodeFetcher)}
  }
\`\`\`

DNS Lookup ${c}: `);try{let h=sDe.promisify(oDe.lookup),g=await Promise.race([h(c),w_(l*1e3)]);g?await Ep(a,`${g.address}
`):await Ep(a,`timed out after ${l} seconds
`)}catch(h){await Ep(a,`Error: ${h?.message}
`)}await Ep(a,`
Fetching ${u}:
`);let d=GT.create(this.envService),p=!!d&&this.configurationService.getConfig(ge.DebugUseElectronFetcher),f=!p&&this.configurationService.getConfig(ge.DebugUseNodeFetcher),m={Electron:{fetcher:d,current:p},Node:{fetcher:new zT(this.envService),current:f},Helix:{fetcher:new XT(this.accessor),current:!p&&!f}};for(let[h,g]of Object.entries(m))if(await Ep(a,`- ${h} Fetcher${g.current?" (configured)":""}: `),g.fetcher)try{let v=await Promise.race([g.fetcher.fetch(u,{}),w_(l*1e3)]);v?await Ep(a,`HTTP ${v.status}
`):await Ep(a,`timed out after ${l} seconds
`)}catch(v){await Ep(a,`Error: ${v?.message}
`)}else await Ep(a,`Unavailable
`)}))}};eE=B([T(0,zt),T(1,Pt),T(2,be),T(3,rt)],eE);async function Ep(t,e){await t.edit(r=>{r.insert(t.document.lineAt(t.document.lineCount-1).range.end,e)})}var lDe=mo.window.createOutputChannel("GitHub Copilot Chat",{log:!0});async function Yct(t,e){if(t.extensionMode===mo.ExtensionMode.Test&&!e)return t;if(mo.l10n.bundle&&tE.config({contents:mo.l10n.bundle}),t.subscriptions.push(lDe),mo.chat._version!==1){await mo.window.showErrorMessage(tE.t("{0} is not compatible with this version of {1}. Please make sure that you have the latest versions of the extension and {1} installed.","GitHub Copilot Chat","VS Code"),tE.t("Show Extension"))&&await mo.commands.executeCommand("workbench.extensions.action.showExtensionsWithIds",["GitHub.copilot-chat"]);return}let r=await dDe(t);t.subscriptions.push(pDe(r));let n=r.get(me);return r.get(Pt).isProduction()||Qct(),cDe(r,t,[vT(eE)]),await sRe(r),cDe(r,t),n.sendGHTelemetryEvent("extension.activate"),mo.ExtensionMode.Test===t.extensionMode?r:{getAPI(s){if(s>n2.version)throw new Error("Invalid Copilot Chat extension API version. Please upgrade Copilot Chat.");return new n2(r)}}}function Qct(){try{require("source-map-support").install(),require("dotenv").config({path:[uDe.resolve(__dirname,"../.env")]})}catch(t){console.error(t)}}async function dDe(t){let e=new bP;t.subscriptions.push(e),e.define(be,new Ue(tD)),e.define(ce,new Ue(Op,[[new CP,new TP(lDe)]])),e.define(qm,new Ue(dT)),e.define(RD,new Ue(wD)),e.define(_t,new Ue(Z_,[!0])),e.define($m,new Ue(NP)),e.define(nc,new Ue(ZI)),e.define(ve,new $P),iDe(e),e.define(zt,t),e.define(Wu,new Ue(Jm)),e.define(nv,new Ue(Jf)),e.define(Aa,new Ue(S0)),e.define(jF,new Ue(cT)),e.define(Tt,new PD),e.define(sh,new Ue(tx)),e.define(ka,new Ue(W_)),e.define(lD,new Ue(mT)),e.define(Fo,new Ue(Yu)),e.define(zc,new Ue(Y_)),e.define(dD,new Ue(K_)),e.define(nD,new Ue(fT)),e.define(os,new Ue(ex)),e.define(ho,new Ue(fD)),e.define(Di,new Ue(mD)),e.define(iD,new oD),e.define(hD,new vD),e.define(gD,new yD),e.define(lo,new p6),e.define(b0,new Ue(H_)),e.define(z_,new rD),e.define(Rc,new g6),e.define(BP,new Ue(bC)),e.define(ov,new g8),e.define(DP,new xD),e.define(lC,new Ue(uC)),e.define(UE,new Ue(AD));let r=t.extension.packageJSON.internalAIKey??"",n=t.extension.packageJSON.ariaKey??"";return t.extensionMode===mo.ExtensionMode.Test?(await aDe(e,t,r,n,"copilot-test",!0),e.define(Nn,ine(e.get(be),e.get(ce),e.get(me),e.get(Vi),e.get(Ln),e.get(Ur),e.get(Pt),e.get(Vm))),e.define(A_,new PP)):(await aDe(e,t,r,n,t.extension.packageJSON.name,mo.env.isTelemetryEnabled),e.define(Nn,new Ue(O_))),e.define(fn,new Ue(M_)),e.define(jt,new Ue(jv)),e.define(pC,new Ue(JC)),e.define($n,{_serviceBrand:void 0,maxResponseTokens:void 0,temperature:.1,topP:1,additionalPromptContext:e.get(be).getConfig(ge.ConversationAdditionalPromptContext),rejectionMessage:tE.t("Sorry, but I can only assist with programming related questions.")}),e.define(X_,new _D),e.define(Ze,new Ue(XS)),e.define(Ku,new Ue(V_)),e.define(o2,new Ue(mI)),e.define(iv,new Ue(tm,[void 0])),e.define(HM,new Ue(zC)),e.define(mp,new Ue(QC)),e.define(qJ,new Ue(XC)),e.define(XF,new Ue(gT)),e.define(h8,new Ue(hI)),e.define(cD,new Ue(G_)),e.define(UP,new Ue(FP)),e.get(De).init(),e.get(qJ),e.seal(),e}async function Xct(t,e){if(mo.ExtensionMode.Production===e.extensionMode){let r=t.get(me),n=await eye(e,r,t.get(Pt).isPreRelease());t.define(Lt,n)}else t.define(Lt,new DD)}async function aDe(t,e,r,n,o,s){mo.ExtensionMode.Production===e.extensionMode?t.define(me,new Ue(QS,[e.extension.packageJSON.name,r,n,O0e,M0e])):t.define(me,new ND),Xct(t,e)}function pDe(t){return{dispose:async()=>{t.get(me).sendGHTelemetryEvent("extension.deactivate")}}}async function cDe(t,e,r=gke){let n=t.get(ce).getLogger("contributions"),o=a=>{n.error(`Error while loading contribution: ${a} ${a.stack}`)},s=a=>{a instanceof mo.Disposable&&e.subscriptions.push(a)};for(let a of r){let c;try{c=a.create(t)}catch(u){o(u)}s(c),c instanceof Promise&&c.then(s).catch(o)}}0&&(module.exports={activate,createExtensionContext,onDeactivate});
//!!! DO NOT modify, this file was COPIED from 'microsoft/vscode'
/*! Bundled license information:

@microsoft/applicationinsights-web-snippet/dist/esm/applicationinsights-web-snippet.js:
  (*!
   * Application Insights JavaScript SDK - Web Snippet, 1.0.1
   * Copyright (c) Microsoft and contributors. All rights reserved.
   *)

mime-db/index.js:
  (*!
   * mime-db
   * Copyright(c) 2014 Jonathan Ong
   * Copyright(c) 2015-2022 Douglas Christopher Wilson
   * MIT Licensed
   *)

mime-types/index.js:
  (*!
   * mime-types
   * Copyright(c) 2014 Jonathan Ong
   * Copyright(c) 2015 Douglas Christopher Wilson
   * MIT Licensed
   *)

@vscode/prompt-tsx/dist/base/util/arrays.js:
  (*!!! DO NOT modify, this file was COPIED from 'microsoft/vscode' *)
*/
